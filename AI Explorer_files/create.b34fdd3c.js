webpackJsonp([0],[,,,,,,,,function(e,t,n){e.exports={METADATA_EXAMPLE_VIEW:"EXAMPLE_VIEW",METADATA_PLAIN_TEXT:"PLAIN_TEXT",STATUS_WAITING:"waiting",STATUS_RUNNING:"running",STATUS_SUCCESS:"success",STATUS_MEDIUM:"medium",STATUS_STOP:"stop",STATUS_FAIL:"fail",STATUS_WARNING:"warning",STATUS_EMPTY:"empty",STATUS_WAIT_RESOURCE:"wait resource",EXEC_TYPE_ALL:"all",EXEC_TYPE_START:"start",EXEC_TYPE_STOP:"stop",EXEC_TYPE_FIX:"fix",EXEC_TYPE_CURRENT:"current",PORT_INPUT_TYPE:"import",PORT_OUTPUT_TYPE:"export",TIME_ACCURACY:["year","month","day","hour"],REPORT_OPERATORS:["LineChart","ScatterChart","HistogramChart","AuRoc","ConfusionMatrix","RegressionEvaluation","CdfChart","BoxChart","PieChart","HeatMapChart","Scatter3DChart","QQPlotChart","RadarChart","MultiScatterChart","PdfChart","WebGisVisual","AnomalyDetectionLineChart","BarChart","TreeChart","NormalProbabilityPlotChart"],OPTIMIZER_OPERATOR:"OptimizerResult",OPERATOR_TYPE_GIS:"WebGisVisual",OPERATOR_TYPE_SPARK:"SPARK",OPERATOR_TYPE_PYTHON:"Python",OPERATOR_TYPE_NoEXECUTEFRAME:"NoExecuteFrame",OPERATOR_TYPE_MULTI_INSTANCES:"multi-instances",OPERATOR_TYPE_ZAIP:"zaip",ENCYPT_OPERATORS:["SqlTool","CustomizedPythonOperator"],TABLE_TYPE:"spark_table",OP_CHANGE_LIMIT_NUM:5,OP_CHANGE_LIMIT_TIME:6e5,ZAIP_INPUT_PARAM:{type:"Image",channels:"Auto",dataFormat:"channels-first",normalization:!1},ZAIP_OUTPUT_PARAM:{type:"Categorical",classify_type:"ClassifyNum",class:10},SETTIMEOUT_TIME:5e3,ZAIPPREDICTION:"multi-instances",ZAIPENTRANCE:"zaip",ZAIPDATA:"zaip-data"}},function(e,t,n){!function(t,n){e.exports=n()}(0,function(){"use strict";function classTest(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}function removeChildren(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function removeChildrenAndAdd(e,t){return removeChildren(e).appendChild(t)}function elt(e,t,n,i){var r=document.createElement(e);if(n&&(r.className=n),i&&(r.style.cssText=i),"string"==typeof t)r.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)r.appendChild(t[o]);return r}function eltP(e,t,n,i){var r=elt(e,t,n,i);return r.setAttribute("role","presentation"),r}function contains(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do{if(11==t.nodeType&&(t=t.host),t==e)return!0}while(t=t.parentNode)}function activeElt(){var e;try{e=document.activeElement}catch(t){e=document.body||null}for(;e&&e.shadowRoot&&e.shadowRoot.activeElement;)e=e.shadowRoot.activeElement;return e}function addClass(e,t){var n=e.className;classTest(t).test(n)||(e.className+=(n?" ":"")+t)}function joinClasses(e,t){for(var n=e.split(" "),i=0;i<n.length;i++)n[i]&&!classTest(n[i]).test(t)&&(t+=" "+n[i]);return t}function bind(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function copyObj(e,t,n){t||(t={});for(var i in e)!e.hasOwnProperty(i)||!1===n&&t.hasOwnProperty(i)||(t[i]=e[i]);return t}function countColumn(e,t,n,i,r){null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length);for(var o=i||0,a=r||0;;){var s=e.indexOf("\t",o);if(s<0||s>=t)return a+(t-o);a+=s-o,a+=n-a%n,o=s+1}}function indexOf(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return n;return-1}function findColumn(e,t,n){for(var i=0,r=0;;){var o=e.indexOf("\t",i);-1==o&&(o=e.length);var a=o-i;if(o==e.length||r+a>=t)return i+Math.min(a,t-r);if(r+=o-i,r+=n-r%n,i=o+1,r>=t)return i}}function spaceStr(e){for(;O.length<=e;)O.push(lst(O)+" ");return O[e]}function lst(e){return e[e.length-1]}function map(e,t){for(var n=[],i=0;i<e.length;i++)n[i]=t(e[i],i);return n}function insertSorted(e,t,n){for(var i=0,r=n(t);i<e.length&&n(e[i])<=r;)i++;e.splice(i,0,t)}function nothing(){}function createObj(e,t){var n;return Object.create?n=Object.create(e):(nothing.prototype=e,n=new nothing),t&&copyObj(t,n),n}function isWordCharBasic(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||R.test(e))}function isWordChar(e,t){return t?!!(t.source.indexOf("\\w")>-1&&isWordCharBasic(e))||t.test(e):isWordCharBasic(e)}function isEmpty(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}function isExtendingChar(e){return e.charCodeAt(0)>=768&&z.test(e)}function skipExtendingChars(e,t,n){for(;(n<0?t>0:t<e.length)&&isExtendingChar(e.charAt(t));)t+=n;return t}function findFirst(e,t,n){for(;;){if(Math.abs(t-n)<=1)return e(t)?t:n;var i=Math.floor((t+n)/2);e(i)?n=i:t=i}}function Display(e,t,i){var r=this;this.input=i,r.scrollbarFiller=elt("div",null,"CodeMirror-scrollbar-filler"),r.scrollbarFiller.setAttribute("cm-not-content","true"),r.gutterFiller=elt("div",null,"CodeMirror-gutter-filler"),r.gutterFiller.setAttribute("cm-not-content","true"),r.lineDiv=eltP("div",null,"CodeMirror-code"),r.selectionDiv=elt("div",null,null,"position: relative; z-index: 1"),r.cursorDiv=elt("div",null,"CodeMirror-cursors"),r.measure=elt("div",null,"CodeMirror-measure"),r.lineMeasure=elt("div",null,"CodeMirror-measure"),r.lineSpace=eltP("div",[r.measure,r.lineMeasure,r.selectionDiv,r.cursorDiv,r.lineDiv],null,"position: relative; outline: none");var o=eltP("div",[r.lineSpace],"CodeMirror-lines");r.mover=elt("div",[o],null,"position: relative"),r.sizer=elt("div",[r.mover],"CodeMirror-sizer"),r.sizerWidth=null,r.heightForcer=elt("div",null,null,"position: absolute; height: "+D+"px; width: 1px;"),r.gutters=elt("div",null,"CodeMirror-gutters"),r.lineGutter=null,r.scroller=elt("div",[r.sizer,r.heightForcer,r.gutters],"CodeMirror-scroll"),r.scroller.setAttribute("tabIndex","-1"),r.wrapper=elt("div",[r.scrollbarFiller,r.gutterFiller,r.scroller],"CodeMirror"),a&&s<8&&(r.gutters.style.zIndex=-1,r.scroller.style.paddingRight=0),l||n&&v||(r.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(r.wrapper):e(r.wrapper)),r.viewFrom=r.viewTo=t.first,r.reportedViewFrom=r.reportedViewTo=t.first,r.view=[],r.renderedView=null,r.externalMeasured=null,r.viewOffset=0,r.lastWrapHeight=r.lastWrapWidth=0,r.updateLineNumbers=null,r.nativeBarWidth=r.barHeight=r.barWidth=0,r.scrollbarsClipped=!1,r.lineNumWidth=r.lineNumInnerWidth=r.lineNumChars=null,r.alignWidgets=!1,r.cachedCharWidth=r.cachedTextHeight=r.cachedPaddingH=null,r.maxLine=null,r.maxLineLength=0,r.maxLineChanged=!1,r.wheelDX=r.wheelDY=r.wheelStartX=r.wheelStartY=null,r.shift=!1,r.selForContextMenu=null,r.activeTouch=null,i.init(r)}function getLine(e,t){if((t-=e.first)<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var n=e;!n.lines;)for(var i=0;;++i){var r=n.children[i],o=r.chunkSize();if(t<o){n=r;break}t-=o}return n.lines[t]}function getBetween(e,t,n){var i=[],r=t.line;return e.iter(t.line,n.line+1,function(e){var o=e.text;r==n.line&&(o=o.slice(0,n.ch)),r==t.line&&(o=o.slice(t.ch)),i.push(o),++r}),i}function getLines(e,t,n){var i=[];return e.iter(t,n,function(e){i.push(e.text)}),i}function updateLineHeight(e,t){var n=t-e.height;if(n)for(var i=e;i;i=i.parent)i.height+=n}function lineNo(e){if(null==e.parent)return null;for(var t=e.parent,n=indexOf(t.lines,e),i=t.parent;i;t=i,i=i.parent)for(var r=0;i.children[r]!=t;++r)n+=i.children[r].chunkSize();return n+t.first}function lineAtHeight(e,t){var n=e.first;e:do{for(var i=0;i<e.children.length;++i){var r=e.children[i],o=r.height;if(t<o){e=r;continue e}t-=o,n+=r.chunkSize()}return n}while(!e.lines);for(var a=0;a<e.lines.length;++a){var s=e.lines[a],l=s.height;if(t<l)break;t-=l}return n+a}function isLine(e,t){return t>=e.first&&t<e.first+e.size}function lineNumberFor(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function Pos(e,t,n){if(void 0===n&&(n=null),!(this instanceof Pos))return new Pos(e,t,n);this.line=e,this.ch=t,this.sticky=n}function cmp(e,t){return e.line-t.line||e.ch-t.ch}function equalCursorPos(e,t){return e.sticky==t.sticky&&0==cmp(e,t)}function copyPos(e){return Pos(e.line,e.ch)}function maxPos(e,t){return cmp(e,t)<0?t:e}function minPos(e,t){return cmp(e,t)<0?e:t}function clipLine(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function clipPos(e,t){if(t.line<e.first)return Pos(e.first,0);var n=e.first+e.size-1;return t.line>n?Pos(n,getLine(e,n).text.length):clipToLen(t,getLine(e,t.line).text.length)}function clipToLen(e,t){var n=e.ch;return null==n||n>t?Pos(e.line,t):n<0?Pos(e.line,0):e}function clipPosArray(e,t){for(var n=[],i=0;i<t.length;i++)n[i]=clipPos(e,t[i]);return n}function seeReadOnlySpans(){F=!0}function seeCollapsedSpans(){B=!0}function MarkedSpan(e,t,n){this.marker=e,this.from=t,this.to=n}function getMarkedSpanFor(e,t){if(e)for(var n=0;n<e.length;++n){var i=e[n];if(i.marker==t)return i}}function removeMarkedSpan(e,t){for(var n,i=0;i<e.length;++i)e[i]!=t&&(n||(n=[])).push(e[i]);return n}function addMarkedSpan(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}function markedSpansBefore(e,t,n){var i;if(e)for(var r=0;r<e.length;++r){var o=e[r],a=o.marker,s=null==o.from||(a.inclusiveLeft?o.from<=t:o.from<t);if(s||o.from==t&&"bookmark"==a.type&&(!n||!o.marker.insertLeft)){var l=null==o.to||(a.inclusiveRight?o.to>=t:o.to>t);(i||(i=[])).push(new MarkedSpan(a,o.from,l?null:o.to))}}return i}function markedSpansAfter(e,t,n){var i;if(e)for(var r=0;r<e.length;++r){var o=e[r],a=o.marker,s=null==o.to||(a.inclusiveRight?o.to>=t:o.to>t);if(s||o.from==t&&"bookmark"==a.type&&(!n||o.marker.insertLeft)){var l=null==o.from||(a.inclusiveLeft?o.from<=t:o.from<t);(i||(i=[])).push(new MarkedSpan(a,l?null:o.from-t,null==o.to?null:o.to-t))}}return i}function stretchSpansOverChange(e,t){if(t.full)return null;var n=isLine(e,t.from.line)&&getLine(e,t.from.line).markedSpans,i=isLine(e,t.to.line)&&getLine(e,t.to.line).markedSpans;if(!n&&!i)return null;var r=t.from.ch,o=t.to.ch,a=0==cmp(t.from,t.to),s=markedSpansBefore(n,r,a),l=markedSpansAfter(i,o,a),c=1==t.text.length,u=lst(t.text).length+(c?r:0);if(s)for(var d=0;d<s.length;++d){var h=s[d];if(null==h.to){var p=getMarkedSpanFor(l,h.marker);p?c&&(h.to=null==p.to?null:p.to+u):h.to=r}}if(l)for(var f=0;f<l.length;++f){var g=l[f];if(null!=g.to&&(g.to+=u),null==g.from){var m=getMarkedSpanFor(s,g.marker);m||(g.from=u,c&&(s||(s=[])).push(g))}else g.from+=u,c&&(s||(s=[])).push(g)}s&&(s=clearEmptySpans(s)),l&&l!=s&&(l=clearEmptySpans(l));var v=[s];if(!c){var _,y=t.text.length-2;if(y>0&&s)for(var x=0;x<s.length;++x)null==s[x].to&&(_||(_=[])).push(new MarkedSpan(s[x].marker,null,null));for(var b=0;b<y;++b)v.push(_);v.push(l)}return v}function clearEmptySpans(e){for(var t=0;t<e.length;++t){var n=e[t];null!=n.from&&n.from==n.to&&!1!==n.marker.clearWhenEmpty&&e.splice(t--,1)}return e.length?e:null}function removeReadOnlyRanges(e,t,n){var i=null;if(e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;!n.readOnly||i&&-1!=indexOf(i,n)||(i||(i=[])).push(n)}}),!i)return null;for(var r=[{from:t,to:n}],o=0;o<i.length;++o)for(var a=i[o],s=a.find(0),l=0;l<r.length;++l){var c=r[l];if(!(cmp(c.to,s.from)<0||cmp(c.from,s.to)>0)){var u=[l,1],d=cmp(c.from,s.from),h=cmp(c.to,s.to);(d<0||!a.inclusiveLeft&&!d)&&u.push({from:c.from,to:s.from}),(h>0||!a.inclusiveRight&&!h)&&u.push({from:s.to,to:c.to}),r.splice.apply(r,u),l+=u.length-3}}return r}function detachMarkedSpans(e){var t=e.markedSpans;if(t){for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}}function attachMarkedSpans(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}}function extraLeft(e){return e.inclusiveLeft?-1:0}function extraRight(e){return e.inclusiveRight?1:0}function compareCollapsedMarkers(e,t){var n=e.lines.length-t.lines.length;if(0!=n)return n;var i=e.find(),r=t.find(),o=cmp(i.from,r.from)||extraLeft(e)-extraLeft(t);if(o)return-o;var a=cmp(i.to,r.to)||extraRight(e)-extraRight(t);return a||t.id-e.id}function collapsedSpanAtSide(e,t){var n,i=B&&e.markedSpans;if(i)for(var r=void 0,o=0;o<i.length;++o)r=i[o],r.marker.collapsed&&null==(t?r.from:r.to)&&(!n||compareCollapsedMarkers(n,r.marker)<0)&&(n=r.marker);return n}function collapsedSpanAtStart(e){return collapsedSpanAtSide(e,!0)}function collapsedSpanAtEnd(e){return collapsedSpanAtSide(e,!1)}function conflictingCollapsedRange(e,t,n,i,r){var o=getLine(e,t),a=B&&o.markedSpans;if(a)for(var s=0;s<a.length;++s){var l=a[s];if(l.marker.collapsed){var c=l.marker.find(0),u=cmp(c.from,n)||extraLeft(l.marker)-extraLeft(r),d=cmp(c.to,i)||extraRight(l.marker)-extraRight(r);if(!(u>=0&&d<=0||u<=0&&d>=0)&&(u<=0&&(l.marker.inclusiveRight&&r.inclusiveLeft?cmp(c.to,n)>=0:cmp(c.to,n)>0)||u>=0&&(l.marker.inclusiveRight&&r.inclusiveLeft?cmp(c.from,i)<=0:cmp(c.from,i)<0)))return!0}}}function visualLine(e){for(var t;t=collapsedSpanAtStart(e);)e=t.find(-1,!0).line;return e}function visualLineEnd(e){for(var t;t=collapsedSpanAtEnd(e);)e=t.find(1,!0).line;return e}function visualLineContinued(e){for(var t,n;t=collapsedSpanAtEnd(e);)e=t.find(1,!0).line,(n||(n=[])).push(e);return n}function visualLineNo(e,t){var n=getLine(e,t),i=visualLine(n);return n==i?t:lineNo(i)}function visualLineEndNo(e,t){if(t>e.lastLine())return t;var n,i=getLine(e,t);if(!lineIsHidden(e,i))return t;for(;n=collapsedSpanAtEnd(i);)i=n.find(1,!0).line;return lineNo(i)+1}function lineIsHidden(e,t){var n=B&&t.markedSpans;if(n)for(var i=void 0,r=0;r<n.length;++r)if(i=n[r],i.marker.collapsed){if(null==i.from)return!0;if(!i.marker.widgetNode&&0==i.from&&i.marker.inclusiveLeft&&lineIsHiddenInner(e,t,i))return!0}}function lineIsHiddenInner(e,t,n){if(null==n.to){var i=n.marker.find(1,!0);return lineIsHiddenInner(e,i.line,getMarkedSpanFor(i.line.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==t.text.length)return!0;for(var r=void 0,o=0;o<t.markedSpans.length;++o)if(r=t.markedSpans[o],r.marker.collapsed&&!r.marker.widgetNode&&r.from==n.to&&(null==r.to||r.to!=n.from)&&(r.marker.inclusiveLeft||n.marker.inclusiveRight)&&lineIsHiddenInner(e,t,r))return!0}function heightAtLine(e){e=visualLine(e);for(var t=0,n=e.parent,i=0;i<n.lines.length;++i){var r=n.lines[i];if(r==e)break;t+=r.height}for(var o=n.parent;o;n=o,o=n.parent)for(var a=0;a<o.children.length;++a){var s=o.children[a];if(s==n)break;t+=s.height}return t}function lineLength(e){if(0==e.height)return 0;for(var t,n=e.text.length,i=e;t=collapsedSpanAtStart(i);){var r=t.find(0,!0);i=r.from.line,n+=r.from.ch-r.to.ch}for(i=e;t=collapsedSpanAtEnd(i);){var o=t.find(0,!0);n-=i.text.length-o.from.ch,i=o.to.line,n+=i.text.length-o.to.ch}return n}function findMaxLine(e){var t=e.display,n=e.doc;t.maxLine=getLine(n,n.first),t.maxLineLength=lineLength(t.maxLine),t.maxLineChanged=!0,n.iter(function(e){var n=lineLength(e);n>t.maxLineLength&&(t.maxLineLength=n,t.maxLine=e)})}function iterateBidiSections(e,t,n,i){if(!e)return i(t,n,"ltr");for(var r=!1,o=0;o<e.length;++o){var a=e[o];(a.from<n&&a.to>t||t==n&&a.to==t)&&(i(Math.max(a.from,t),Math.min(a.to,n),1==a.level?"rtl":"ltr"),r=!0)}r||i(t,n,"ltr")}function getBidiPartAt(e,t,n){var i;H=null;for(var r=0;r<e.length;++r){var o=e[r];if(o.from<t&&o.to>t)return r;o.to==t&&(o.from!=o.to&&"before"==n?i=r:H=r),o.from==t&&(o.from!=o.to&&"before"!=n?i=r:H=r)}return null!=i?i:H}function getOrder(e,t){var n=e.order;return null==n&&(n=e.order=V(e.text,t)),n}function moveCharLogically(e,t,n){var i=skipExtendingChars(e.text,t+n,n);return i<0||i>e.text.length?null:i}function moveLogically(e,t,n){var i=moveCharLogically(e,t.ch,n);return null==i?null:new Pos(t.line,i,n<0?"after":"before")}function endOfLine(e,t,n,i,r){if(e){var o=getOrder(n,t.doc.direction);if(o){var a,s=r<0?lst(o):o[0],l=r<0==(1==s.level),c=l?"after":"before";if(s.level>0){var u=prepareMeasureForLine(t,n);a=r<0?n.text.length-1:0;var d=measureCharPrepared(t,u,a).top;a=findFirst(function(e){return measureCharPrepared(t,u,e).top==d},r<0==(1==s.level)?s.from:s.to-1,a),"before"==c&&(a=moveCharLogically(n,a,1))}else a=r<0?s.to:s.from;return new Pos(i,a,c)}}return new Pos(i,r<0?n.text.length:0,r<0?"before":"after")}function moveVisually(e,t,n,i){var r=getOrder(t,e.doc.direction);if(!r)return moveLogically(t,n,i);n.ch>=t.text.length?(n.ch=t.text.length,n.sticky="before"):n.ch<=0&&(n.ch=0,n.sticky="after");var o=getBidiPartAt(r,n.ch,n.sticky),a=r[o];if("ltr"==e.doc.direction&&a.level%2==0&&(i>0?a.to>n.ch:a.from<n.ch))return moveLogically(t,n,i);var s,l=function(e,n){return moveCharLogically(t,e instanceof Pos?e.ch:e,n)},c=function(n){return e.options.lineWrapping?(s=s||prepareMeasureForLine(e,t),wrappedLineExtentChar(e,t,s,n)):{begin:0,end:t.text.length}},u=c("before"==n.sticky?l(n,-1):n.ch);if("rtl"==e.doc.direction||1==a.level){var d=1==a.level==i<0,h=l(n,d?1:-1);if(null!=h&&(d?h<=a.to&&h<=u.end:h>=a.from&&h>=u.begin)){var p=d?"before":"after";return new Pos(n.line,h,p)}}var f=function(e,t,i){for(var o=function(e,t){return t?new Pos(n.line,l(e,1),"before"):new Pos(n.line,e,"after")};e>=0&&e<r.length;e+=t){var a=r[e],s=t>0==(1!=a.level),c=s?i.begin:l(i.end,-1);if(a.from<=c&&c<a.to)return o(c,s);if(c=s?a.from:l(a.to,-1),i.begin<=c&&c<i.end)return o(c,s)}},g=f(o+i,i,u);if(g)return g;var m=i>0?u.end:l(u.begin,-1);return null==m||i>0&&m==t.text.length||!(g=f(i>0?0:r.length-1,i,c(m)))?null:g}function getHandlers(e,t){return e._handlers&&e._handlers[t]||W}function off(e,t,n){if(e.removeEventListener)e.removeEventListener(t,n,!1);else if(e.detachEvent)e.detachEvent("on"+t,n);else{var i=e._handlers,r=i&&i[t];if(r){var o=indexOf(r,n);o>-1&&(i[t]=r.slice(0,o).concat(r.slice(o+1)))}}}function signal(e,t){var n=getHandlers(e,t);if(n.length)for(var i=Array.prototype.slice.call(arguments,2),r=0;r<n.length;++r)n[r].apply(null,i)}function signalDOMEvent(e,t,n){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),signal(e,n||t.type,e,t),e_defaultPrevented(t)||t.codemirrorIgnore}function signalCursorActivity(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var n=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),i=0;i<t.length;++i)-1==indexOf(n,t[i])&&n.push(t[i])}function hasHandler(e,t){return getHandlers(e,t).length>0}function eventMixin(e){e.prototype.on=function(e,t){U(this,e,t)},e.prototype.off=function(e,t){off(this,e,t)}}function e_preventDefault(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function e_stopPropagation(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function e_defaultPrevented(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function e_stop(e){e_preventDefault(e),e_stopPropagation(e)}function e_target(e){return e.target||e.srcElement}function e_button(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),_&&e.ctrlKey&&1==t&&(t=3),t}function zeroWidthElement(e){if(null==E){var t=elt("span","​");removeChildrenAndAdd(e,elt("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(E=t.offsetWidth<=1&&t.offsetHeight>2&&!(a&&s<8))}var n=E?elt("span","​"):elt("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return n.setAttribute("cm-text",""),n}function hasBadBidiRects(e){if(null!=I)return I;var t=removeChildrenAndAdd(e,document.createTextNode("AخA")),n=w(t,0,1).getBoundingClientRect(),i=w(t,1,2).getBoundingClientRect();return removeChildren(e),!(!n||n.left==n.right)&&(I=i.right-n.right<3)}function hasBadZoomedRects(e){if(null!=Y)return Y;var t=removeChildrenAndAdd(e,elt("span","x")),n=t.getBoundingClientRect(),i=w(t,0,1).getBoundingClientRect();return Y=Math.abs(n.left-i.left)>1}function defineMode(e,t){arguments.length>2&&(t.dependencies=Array.prototype.slice.call(arguments,2)),X[e]=t}function defineMIME(e,t){Z[e]=t}function resolveMode(e){if("string"==typeof e&&Z.hasOwnProperty(e))e=Z[e];else if(e&&"string"==typeof e.name&&Z.hasOwnProperty(e.name)){var t=Z[e.name];"string"==typeof t&&(t={name:t}),e=createObj(t,e),e.name=t.name}else{if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return resolveMode("application/xml");if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return resolveMode("application/json")}return"string"==typeof e?{name:e}:e||{name:"null"}}function getMode(e,t){t=resolveMode(t);var n=X[t.name];if(!n)return getMode(e,"text/plain");var i=n(e,t);if(K.hasOwnProperty(t.name)){var r=K[t.name];for(var o in r)r.hasOwnProperty(o)&&(i.hasOwnProperty(o)&&(i["_"+o]=i[o]),i[o]=r[o])}if(i.name=t.name,t.helperType&&(i.helperType=t.helperType),t.modeProps)for(var a in t.modeProps)i[a]=t.modeProps[a];return i}function extendMode(e,t){copyObj(t,K.hasOwnProperty(e)?K[e]:K[e]={})}function copyState(e,t){if(!0===t)return t;if(e.copyState)return e.copyState(t);var n={};for(var i in t){var r=t[i];r instanceof Array&&(r=r.concat([])),n[i]=r}return n}function innerMode(e,t){for(var n;e.innerMode&&(n=e.innerMode(t))&&n.mode!=e;)t=n.state,e=n.mode;return n||{mode:e,state:t}}function startState(e,t,n){return!e.startState||e.startState(t,n)}function highlightLine(e,t,n,i){var r=[e.state.modeGen],o={};runMode(e,t.text,e.doc.mode,n,function(e,t){return r.push(e,t)},o,i);for(var a=n.state,s=0;s<e.state.overlays.length;++s)!function(i){var a=e.state.overlays[i],s=1,l=0;n.state=!0,runMode(e,t.text,a.mode,n,function(e,t){for(var n=s;l<e;){var i=r[s];i>e&&r.splice(s,1,e,r[s+1],i),s+=2,l=Math.min(e,i)}if(t)if(a.opaque)r.splice(n,s-n,e,"overlay "+t),s=n+2;else for(;n<s;n+=2){var o=r[n+1];r[n+1]=(o?o+" ":"")+"overlay "+t}},o)}(s);return n.state=a,{styles:r,classes:o.bgClass||o.textClass?o:null}}function getLineStyles(e,t,n){if(!t.styles||t.styles[0]!=e.state.modeGen){var i=getContextBefore(e,lineNo(t)),r=t.text.length>e.options.maxHighlightLength&&copyState(e.doc.mode,i.state),o=highlightLine(e,t,i);r&&(i.state=r),t.stateAfter=i.save(!r),t.styles=o.styles,o.classes?t.styleClasses=o.classes:t.styleClasses&&(t.styleClasses=null),n===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))}return t.styles}function getContextBefore(e,t,n){var i=e.doc,r=e.display;if(!i.mode.startState)return new ee(i,!0,t);var o=findStartLine(e,t,n),a=o>i.first&&getLine(i,o-1).stateAfter,s=a?ee.fromSaved(i,a,o):new ee(i,startState(i.mode),o);return i.iter(o,t,function(n){processLine(e,n.text,s);var i=s.line;n.stateAfter=i==t-1||i%5==0||i>=r.viewFrom&&i<r.viewTo?s.save():null,s.nextLine()}),n&&(i.modeFrontier=s.line),s}function processLine(e,t,n,i){var r=e.doc.mode,o=new J(t,e.options.tabSize,n);for(o.start=o.pos=i||0,""==t&&callBlankLine(r,n.state);!o.eol();)readToken(r,o,n.state),o.start=o.pos}function callBlankLine(e,t){if(e.blankLine)return e.blankLine(t);if(e.innerMode){var n=innerMode(e,t);return n.mode.blankLine?n.mode.blankLine(n.state):void 0}}function readToken(e,t,n,i){for(var r=0;r<10;r++){i&&(i[0]=innerMode(e,n).mode);var o=e.token(t,n);if(t.pos>t.start)return o}throw new Error("Mode "+e.name+" failed to advance stream.")}function takeToken(e,t,n,i){var r,o=e.doc,a=o.mode;t=clipPos(o,t);var s,l=getLine(o,t.line),c=getContextBefore(e,t.line,n),u=new J(l.text,e.options.tabSize,c);for(i&&(s=[]);(i||u.pos<t.ch)&&!u.eol();)u.start=u.pos,r=readToken(a,u,c.state),i&&s.push(new te(u,r,copyState(o.mode,c.state)));return i?s:new te(u,r,c.state)}function extractLineClasses(e,t){if(e)for(;;){var n=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;e=e.slice(0,n.index)+e.slice(n.index+n[0].length);var i=n[1]?"bgClass":"textClass";null==t[i]?t[i]=n[2]:new RegExp("(?:^|s)"+n[2]+"(?:$|s)").test(t[i])||(t[i]+=" "+n[2])}return e}function runMode(e,t,n,i,r,o,a){var s=n.flattenSpans;null==s&&(s=e.options.flattenSpans);var l,c=0,u=null,d=new J(t,e.options.tabSize,i),h=e.options.addModeClass&&[null];for(""==t&&extractLineClasses(callBlankLine(n,i.state),o);!d.eol();){if(d.pos>e.options.maxHighlightLength?(s=!1,a&&processLine(e,t,i,d.pos),d.pos=t.length,l=null):l=extractLineClasses(readToken(n,d,i.state,h),o),h){var p=h[0].name;p&&(l="m-"+(l?p+" "+l:p))}if(!s||u!=l){for(;c<d.start;)c=Math.min(d.start,c+5e3),r(c,u);u=l}d.start=d.pos}for(;c<d.pos;){var f=Math.min(d.pos,c+5e3);r(f,u),c=f}}function findStartLine(e,t,n){for(var i,r,o=e.doc,a=n?-1:t-(e.doc.mode.innerMode?1e3:100),s=t;s>a;--s){if(s<=o.first)return o.first;var l=getLine(o,s-1),c=l.stateAfter;if(c&&(!n||s+(c instanceof Q?c.lookAhead:0)<=o.modeFrontier))return s;var u=countColumn(l.text,null,e.options.tabSize);(null==r||i>u)&&(r=s-1,i=u)}return r}function retreatFrontier(e,t){if(e.modeFrontier=Math.min(e.modeFrontier,t),!(e.highlightFrontier<t-10)){for(var n=e.first,i=t-1;i>n;i--){var r=getLine(e,i).stateAfter;if(r&&(!(r instanceof Q)||i+r.lookAhead<t)){n=i+1;break}}e.highlightFrontier=Math.min(e.highlightFrontier,n)}}function updateLine(e,t,n,i){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),detachMarkedSpans(e),attachMarkedSpans(e,n);var r=i?i(e):1;r!=e.height&&updateLineHeight(e,r)}function cleanUpLine(e){e.parent=null,detachMarkedSpans(e)}function interpretTokenStyle(e,t){if(!e||/^\s*$/.test(e))return null;var n=t.addModeClass?oe:re;return n[e]||(n[e]=e.replace(/\S+/g,"cm-$&"))}function buildLineContent(e,t){var n=eltP("span",null,null,l?"padding-right: .1px":null),i={pre:eltP("pre",[n],"CodeMirror-line"),content:n,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:(a||l)&&e.getOption("lineWrapping")};t.measure={};for(var r=0;r<=(t.rest?t.rest.length:0);r++){var o=r?t.rest[r-1]:t.line,s=void 0;i.pos=0,i.addToken=buildToken,hasBadBidiRects(e.display.measure)&&(s=getOrder(o,e.doc.direction))&&(i.addToken=buildTokenBadBidi(i.addToken,s)),i.map=[];insertLineContent(o,i,getLineStyles(e,o,t!=e.display.externalMeasured&&lineNo(o))),o.styleClasses&&(o.styleClasses.bgClass&&(i.bgClass=joinClasses(o.styleClasses.bgClass,i.bgClass||"")),o.styleClasses.textClass&&(i.textClass=joinClasses(o.styleClasses.textClass,i.textClass||""))),0==i.map.length&&i.map.push(0,0,i.content.appendChild(zeroWidthElement(e.display.measure))),0==r?(t.measure.map=i.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(i.map),(t.measure.caches||(t.measure.caches=[])).push({}))}if(l){var c=i.content.lastChild;(/\bcm-tab\b/.test(c.className)||c.querySelector&&c.querySelector(".cm-tab"))&&(i.content.className="cm-tab-wrap-hack")}return signal(e,"renderLine",e,t.line,i.pre),i.pre.className&&(i.textClass=joinClasses(i.pre.className,i.textClass||"")),i}function defaultSpecialCharPlaceholder(e){var t=elt("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function buildToken(e,t,n,i,r,o,l){if(t){var c,u=e.splitSpaces?splitSpaces(t,e.trailingSpace):t,d=e.cm.state.specialChars,h=!1;if(d.test(t)){c=document.createDocumentFragment();for(var p=0;;){d.lastIndex=p;var f=d.exec(t),g=f?f.index-p:t.length-p;if(g){var m=document.createTextNode(u.slice(p,p+g));a&&s<9?c.appendChild(elt("span",[m])):c.appendChild(m),e.map.push(e.pos,e.pos+g,m),e.col+=g,e.pos+=g}if(!f)break;p+=g+1;var v=void 0;if("\t"==f[0]){var _=e.cm.options.tabSize,y=_-e.col%_;v=c.appendChild(elt("span",spaceStr(y),"cm-tab")),v.setAttribute("role","presentation"),v.setAttribute("cm-text","\t"),e.col+=y}else"\r"==f[0]||"\n"==f[0]?(v=c.appendChild(elt("span","\r"==f[0]?"␍":"␤","cm-invalidchar")),v.setAttribute("cm-text",f[0]),e.col+=1):(v=e.cm.options.specialCharPlaceholder(f[0]),v.setAttribute("cm-text",f[0]),a&&s<9?c.appendChild(elt("span",[v])):c.appendChild(v),e.col+=1);e.map.push(e.pos,e.pos+1,v),e.pos++}}else e.col+=t.length,c=document.createTextNode(u),e.map.push(e.pos,e.pos+t.length,c),a&&s<9&&(h=!0),e.pos+=t.length;if(e.trailingSpace=32==u.charCodeAt(t.length-1),n||i||r||h||l){var x=n||"";i&&(x+=i),r&&(x+=r);var b=elt("span",[c],x,l);return o&&(b.title=o),e.content.appendChild(b)}e.content.appendChild(c)}}function splitSpaces(e,t){if(e.length>1&&!/  /.test(e))return e;for(var n=t,i="",r=0;r<e.length;r++){var o=e.charAt(r);" "!=o||!n||r!=e.length-1&&32!=e.charCodeAt(r+1)||(o=" "),i+=o,n=" "==o}return i}function buildTokenBadBidi(e,t){return function(n,i,r,o,a,s,l){r=r?r+" cm-force-border":"cm-force-border";for(var c=n.pos,u=c+i.length;;){for(var d=void 0,h=0;h<t.length&&(d=t[h],!(d.to>c&&d.from<=c));h++);if(d.to>=u)return e(n,i,r,o,a,s,l);e(n,i.slice(0,d.to-c),r,o,null,s,l),o=null,i=i.slice(d.to-c),c=d.to}}}function buildCollapsedSpan(e,t,n,i){var r=!i&&n.widgetNode;r&&e.map.push(e.pos,e.pos+t,r),!i&&e.cm.display.input.needsContentAttribute&&(r||(r=e.content.appendChild(document.createElement("span"))),r.setAttribute("cm-marker",n.id)),r&&(e.cm.display.input.setUneditable(r),e.content.appendChild(r)),e.pos+=t,e.trailingSpace=!1}function insertLineContent(e,t,n){var i=e.markedSpans,r=e.text,o=0;if(i)for(var a,s,l,c,u,d,h,p=r.length,f=0,g=1,m="",v=0;;){if(v==f){l=c=u=d=s="",h=null,v=1/0;for(var _=[],y=void 0,x=0;x<i.length;++x){var b=i[x],w=b.marker;"bookmark"==w.type&&b.from==f&&w.widgetNode?_.push(w):b.from<=f&&(null==b.to||b.to>f||w.collapsed&&b.to==f&&b.from==f)?(null!=b.to&&b.to!=f&&v>b.to&&(v=b.to,c=""),w.className&&(l+=" "+w.className),w.css&&(s=(s?s+";":"")+w.css),w.startStyle&&b.from==f&&(u+=" "+w.startStyle),w.endStyle&&b.to==v&&(y||(y=[])).push(w.endStyle,b.to),w.title&&!d&&(d=w.title),w.collapsed&&(!h||compareCollapsedMarkers(h.marker,w)<0)&&(h=b)):b.from>f&&v>b.from&&(v=b.from)}if(y)for(var C=0;C<y.length;C+=2)y[C+1]==v&&(c+=" "+y[C]);if(!h||h.from==f)for(var S=0;S<_.length;++S)buildCollapsedSpan(t,0,_[S]);if(h&&(h.from||0)==f){if(buildCollapsedSpan(t,(null==h.to?p+1:h.to)-f,h.marker,null==h.from),null==h.to)return;h.to==f&&(h=!1)}}if(f>=p)break;for(var T=Math.min(p,v);;){if(m){var A=f+m.length;if(!h){var M=A>T?m.slice(0,T-f):m;t.addToken(t,M,a?a+l:l,u,f+M.length==v?c:"",d,s)}if(A>=T){m=m.slice(T-f),f=T;break}f=A,u=""}m=r.slice(o,o=n[g++]),a=interpretTokenStyle(n[g++],t.cm.options)}}else for(var E=1;E<n.length;E+=2)t.addToken(t,r.slice(o,o=n[E]),interpretTokenStyle(n[E+1],t.cm.options))}function LineView(e,t,n){this.line=t,this.rest=visualLineContinued(t),this.size=this.rest?lineNo(lst(this.rest))-n+1:1,this.node=this.text=null,this.hidden=lineIsHidden(e,t)}function buildViewArray(e,t,n){for(var i,r=[],o=t;o<n;o=i){var a=new LineView(e.doc,getLine(e.doc,o),o);i=o+a.size,r.push(a)}return r}function pushOperation(e){ae?ae.ops.push(e):e.ownsGroup=ae={ops:[e],delayedCallbacks:[]}}function fireCallbacksForOps(e){var t=e.delayedCallbacks,n=0;do{for(;n<t.length;n++)t[n].call(null);for(var i=0;i<e.ops.length;i++){var r=e.ops[i];if(r.cursorActivityHandlers)for(;r.cursorActivityCalled<r.cursorActivityHandlers.length;)r.cursorActivityHandlers[r.cursorActivityCalled++].call(null,r.cm)}}while(n<t.length)}function finishOperation(e,t){var n=e.ownsGroup;if(n)try{fireCallbacksForOps(n)}finally{ae=null,t(n)}}function signalLater(e,t){var n=getHandlers(e,t);if(n.length){var i,r=Array.prototype.slice.call(arguments,2);ae?i=ae.delayedCallbacks:se?i=se:(i=se=[],setTimeout(fireOrphanDelayed,0));for(var o=0;o<n.length;++o)!function(e){i.push(function(){return n[e].apply(null,r)})}(o)}}function fireOrphanDelayed(){var e=se;se=null;for(var t=0;t<e.length;++t)e[t]()}function updateLineForChanges(e,t,n,i){for(var r=0;r<t.changes.length;r++){var o=t.changes[r];"text"==o?updateLineText(e,t):"gutter"==o?updateLineGutter(e,t,n,i):"class"==o?updateLineClasses(e,t):"widget"==o&&updateLineWidgets(e,t,i)}t.changes=null}function ensureLineWrapped(e){return e.node==e.text&&(e.node=elt("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),a&&s<8&&(e.node.style.zIndex=2)),e.node}function updateLineBackground(e,t){var n=t.bgClass?t.bgClass+" "+(t.line.bgClass||""):t.line.bgClass;if(n&&(n+=" CodeMirror-linebackground"),t.background)n?t.background.className=n:(t.background.parentNode.removeChild(t.background),t.background=null);else if(n){var i=ensureLineWrapped(t);t.background=i.insertBefore(elt("div",null,n),i.firstChild),e.display.input.setUneditable(t.background)}}function getLineContent(e,t){var n=e.display.externalMeasured;return n&&n.line==t.line?(e.display.externalMeasured=null,t.measure=n.measure,n.built):buildLineContent(e,t)}function updateLineText(e,t){var n=t.text.className,i=getLineContent(e,t);t.text==t.node&&(t.node=i.pre),t.text.parentNode.replaceChild(i.pre,t.text),t.text=i.pre,i.bgClass!=t.bgClass||i.textClass!=t.textClass?(t.bgClass=i.bgClass,t.textClass=i.textClass,updateLineClasses(e,t)):n&&(t.text.className=n)}function updateLineClasses(e,t){updateLineBackground(e,t),t.line.wrapClass?ensureLineWrapped(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var n=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=n||""}function updateLineGutter(e,t,n,i){if(t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass){var r=ensureLineWrapped(t);t.gutterBackground=elt("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px; width: "+i.gutterTotalWidth+"px"),e.display.input.setUneditable(t.gutterBackground),r.insertBefore(t.gutterBackground,t.text)}var o=t.line.gutterMarkers;if(e.options.lineNumbers||o){var a=ensureLineWrapped(t),s=t.gutter=elt("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px");if(e.display.input.setUneditable(s),a.insertBefore(s,t.text),t.line.gutterClass&&(s.className+=" "+t.line.gutterClass),!e.options.lineNumbers||o&&o["CodeMirror-linenumbers"]||(t.lineNumber=s.appendChild(elt("div",lineNumberFor(e.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+i.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),o)for(var l=0;l<e.options.gutters.length;++l){var c=e.options.gutters[l],u=o.hasOwnProperty(c)&&o[c];u&&s.appendChild(elt("div",[u],"CodeMirror-gutter-elt","left: "+i.gutterLeft[c]+"px; width: "+i.gutterWidth[c]+"px"))}}}function updateLineWidgets(e,t,n){t.alignable&&(t.alignable=null);for(var i=t.node.firstChild,r=void 0;i;i=r)r=i.nextSibling,"CodeMirror-linewidget"==i.className&&t.node.removeChild(i);insertLineWidgets(e,t,n)}function buildLineElement(e,t,n,i){var r=getLineContent(e,t);return t.text=t.node=r.pre,r.bgClass&&(t.bgClass=r.bgClass),r.textClass&&(t.textClass=r.textClass),updateLineClasses(e,t),updateLineGutter(e,t,n,i),insertLineWidgets(e,t,i),t.node}function insertLineWidgets(e,t,n){if(insertLineWidgetsFor(e,t.line,t,n,!0),t.rest)for(var i=0;i<t.rest.length;i++)insertLineWidgetsFor(e,t.rest[i],t,n,!1)}function insertLineWidgetsFor(e,t,n,i,r){if(t.widgets)for(var o=ensureLineWrapped(n),a=0,s=t.widgets;a<s.length;++a){var l=s[a],c=elt("div",[l.node],"CodeMirror-linewidget");l.handleMouseEvents||c.setAttribute("cm-ignore-events","true"),positionLineWidget(l,c,n,i),e.display.input.setUneditable(c),r&&l.above?o.insertBefore(c,n.gutter||n.text):o.appendChild(c),signalLater(l,"redraw")}}function positionLineWidget(e,t,n,i){if(e.noHScroll){(n.alignable||(n.alignable=[])).push(t);var r=i.wrapperWidth;t.style.left=i.fixedPos+"px",e.coverGutter||(r-=i.gutterTotalWidth,t.style.paddingLeft=i.gutterTotalWidth+"px"),t.style.width=r+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-i.gutterTotalWidth+"px"))}function widgetHeight(e){if(null!=e.height)return e.height;var t=e.doc.cm;if(!t)return 0;if(!contains(document.body,e.node)){var n="position: relative;";e.coverGutter&&(n+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(n+="width: "+t.display.wrapper.clientWidth+"px;"),removeChildrenAndAdd(t.display.measure,elt("div",[e.node],null,n))}return e.height=e.node.parentNode.offsetHeight}function eventInWidget(e,t){for(var n=e_target(t);n!=e.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==e.sizer&&n!=e.mover)return!0}function paddingTop(e){return e.lineSpace.offsetTop}function paddingVert(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function paddingH(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=removeChildrenAndAdd(e.measure,elt("pre","x")),n=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,i={left:parseInt(n.paddingLeft),right:parseInt(n.paddingRight)};return isNaN(i.left)||isNaN(i.right)||(e.cachedPaddingH=i),i}function scrollGap(e){return D-e.display.nativeBarWidth}function displayWidth(e){return e.display.scroller.clientWidth-scrollGap(e)-e.display.barWidth}function displayHeight(e){return e.display.scroller.clientHeight-scrollGap(e)-e.display.barHeight}function ensureLineHeights(e,t,n){var i=e.options.lineWrapping,r=i&&displayWidth(e);if(!t.measure.heights||i&&t.measure.width!=r){var o=t.measure.heights=[];if(i){t.measure.width=r;for(var a=t.text.firstChild.getClientRects(),s=0;s<a.length-1;s++){var l=a[s],c=a[s+1];Math.abs(l.bottom-c.bottom)>2&&o.push((l.bottom+c.top)/2-n.top)}}o.push(n.bottom-n.top)}}function mapFromLineView(e,t,n){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var i=0;i<e.rest.length;i++)if(e.rest[i]==t)return{map:e.measure.maps[i],cache:e.measure.caches[i]};for(var r=0;r<e.rest.length;r++)if(lineNo(e.rest[r])>n)return{map:e.measure.maps[r],cache:e.measure.caches[r],before:!0}}function updateExternalMeasurement(e,t){t=visualLine(t);var n=lineNo(t),i=e.display.externalMeasured=new LineView(e.doc,t,n);i.lineN=n;var r=i.built=buildLineContent(e,i);return i.text=r.pre,removeChildrenAndAdd(e.display.lineMeasure,r.pre),i}function measureChar(e,t,n,i){return measureCharPrepared(e,prepareMeasureForLine(e,t),n,i)}function findViewForLine(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[findViewIndex(e,t)];var n=e.display.externalMeasured;return n&&t>=n.lineN&&t<n.lineN+n.size?n:void 0}function prepareMeasureForLine(e,t){var n=lineNo(t),i=findViewForLine(e,n);i&&!i.text?i=null:i&&i.changes&&(updateLineForChanges(e,i,n,getDimensions(e)),e.curOp.forceUpdate=!0),i||(i=updateExternalMeasurement(e,t));var r=mapFromLineView(i,t,n);return{line:t,view:i,rect:null,map:r.map,cache:r.cache,before:r.before,hasHeights:!1}}function measureCharPrepared(e,t,n,i,r){t.before&&(n=-1);var o,a=n+(i||"");return t.cache.hasOwnProperty(a)?o=t.cache[a]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(ensureLineHeights(e,t.view,t.rect),t.hasHeights=!0),o=measureCharInner(e,t,n,i),o.bogus||(t.cache[a]=o)),{left:o.left,right:o.right,top:r?o.rtop:o.top,bottom:r?o.rbottom:o.bottom}}function nodeAndOffsetInLineMap(e,t,n){for(var i,r,o,a,s,l,c=0;c<e.length;c+=3)if(s=e[c],l=e[c+1],t<s?(r=0,o=1,a="left"):t<l?(r=t-s,o=r+1):(c==e.length-3||t==l&&e[c+3]>t)&&(o=l-s,r=o-1,t>=l&&(a="right")),null!=r){if(i=e[c+2],s==l&&n==(i.insertLeft?"left":"right")&&(a=n),"left"==n&&0==r)for(;c&&e[c-2]==e[c-3]&&e[c-1].insertLeft;)i=e[2+(c-=3)],a="left";if("right"==n&&r==l-s)for(;c<e.length-3&&e[c+3]==e[c+4]&&!e[c+5].insertLeft;)i=e[(c+=3)+2],a="right";break}return{node:i,start:r,end:o,collapse:a,coverStart:s,coverEnd:l}}function getUsefulRect(e,t){var n=le;if("left"==t)for(var i=0;i<e.length&&(n=e[i]).left==n.right;i++);else for(var r=e.length-1;r>=0&&(n=e[r]).left==n.right;r--);return n}function measureCharInner(e,t,n,i){var r,o=nodeAndOffsetInLineMap(t.map,n,i),l=o.node,c=o.start,u=o.end,d=o.collapse;if(3==l.nodeType){for(var h=0;h<4;h++){for(;c&&isExtendingChar(t.line.text.charAt(o.coverStart+c));)--c;for(;o.coverStart+u<o.coverEnd&&isExtendingChar(t.line.text.charAt(o.coverStart+u));)++u;if(r=a&&s<9&&0==c&&u==o.coverEnd-o.coverStart?l.parentNode.getBoundingClientRect():getUsefulRect(w(l,c,u).getClientRects(),i),r.left||r.right||0==c)break;u=c,c-=1,d="right"}a&&s<11&&(r=maybeUpdateRectForZooming(e.display.measure,r))}else{c>0&&(d=i="right");var p;r=e.options.lineWrapping&&(p=l.getClientRects()).length>1?p["right"==i?p.length-1:0]:l.getBoundingClientRect()}if(a&&s<9&&!c&&(!r||!r.left&&!r.right)){var f=l.parentNode.getClientRects()[0];r=f?{left:f.left,right:f.left+charWidth(e.display),top:f.top,bottom:f.bottom}:le}for(var g=r.top-t.rect.top,m=r.bottom-t.rect.top,v=(g+m)/2,_=t.view.measure.heights,y=0;y<_.length-1&&!(v<_[y]);y++);var x=y?_[y-1]:0,b=_[y],C={left:("right"==d?r.right:r.left)-t.rect.left,right:("left"==d?r.left:r.right)-t.rect.left,top:x,bottom:b};return r.left||r.right||(C.bogus=!0),e.options.singleCursorHeightPerLine||(C.rtop=g,C.rbottom=m),C}function maybeUpdateRectForZooming(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!hasBadZoomedRects(e))return t;var n=screen.logicalXDPI/screen.deviceXDPI,i=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*n,right:t.right*n,top:t.top*i,bottom:t.bottom*i}}function clearLineMeasurementCacheFor(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function clearLineMeasurementCache(e){e.display.externalMeasure=null,removeChildren(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)clearLineMeasurementCacheFor(e.display.view[t])}function clearCaches(e){clearLineMeasurementCache(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function pageScrollX(){return u&&m?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function pageScrollY(){return u&&m?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function intoCoordSystem(e,t,n,i,r){if(!r&&t.widgets)for(var o=0;o<t.widgets.length;++o)if(t.widgets[o].above){var a=widgetHeight(t.widgets[o]);n.top+=a,n.bottom+=a}if("line"==i)return n;i||(i="local");var s=heightAtLine(t);if("local"==i?s+=paddingTop(e.display):s-=e.display.viewOffset,"page"==i||"window"==i){var l=e.display.lineSpace.getBoundingClientRect();s+=l.top+("window"==i?0:pageScrollY());var c=l.left+("window"==i?0:pageScrollX());n.left+=c,n.right+=c}return n.top+=s,n.bottom+=s,n}function fromCoordSystem(e,t,n){if("div"==n)return t;var i=t.left,r=t.top;if("page"==n)i-=pageScrollX(),r-=pageScrollY();else if("local"==n||!n){var o=e.display.sizer.getBoundingClientRect();i+=o.left,r+=o.top}var a=e.display.lineSpace.getBoundingClientRect();return{left:i-a.left,top:r-a.top}}function charCoords(e,t,n,i,r){return i||(i=getLine(e.doc,t.line)),intoCoordSystem(e,i,measureChar(e,i,t.ch,r),n)}function cursorCoords(e,t,n,i,r,o){function get(t,a){var s=measureCharPrepared(e,r,t,a?"right":"left",o);return a?s.left=s.right:s.right=s.left,intoCoordSystem(e,i,s,n)}function getBidi(e,t,n){var i=a[t],r=i.level%2!=0;return get(n?e-1:e,r!=n)}i=i||getLine(e.doc,t.line),r||(r=prepareMeasureForLine(e,i));var a=getOrder(i,e.doc.direction),s=t.ch,l=t.sticky;if(s>=i.text.length?(s=i.text.length,l="before"):s<=0&&(s=0,l="after"),!a)return get("before"==l?s-1:s,"before"==l);var c=getBidiPartAt(a,s,l),u=H,d=getBidi(s,c,"before"==l);return null!=u&&(d.other=getBidi(s,u,"before"!=l)),d}function estimateCoords(e,t){var n=0;t=clipPos(e.doc,t),e.options.lineWrapping||(n=charWidth(e.display)*t.ch);var i=getLine(e.doc,t.line),r=heightAtLine(i)+paddingTop(e.display);return{left:n,right:n,top:r,bottom:r+i.height}}function PosWithInfo(e,t,n,i,r){var o=Pos(e,t,n);return o.xRel=r,i&&(o.outside=!0),o}function coordsChar(e,t,n){var i=e.doc;if((n+=e.display.viewOffset)<0)return PosWithInfo(i.first,0,null,!0,-1);var r=lineAtHeight(i,n),o=i.first+i.size-1;if(r>o)return PosWithInfo(i.first+i.size-1,getLine(i,o).text.length,null,!0,1);t<0&&(t=0);for(var a=getLine(i,r);;){var s=coordsCharInner(e,a,r,t,n),l=collapsedSpanAtEnd(a),c=l&&l.find(0,!0);if(!l||!(s.ch>c.from.ch||s.ch==c.from.ch&&s.xRel>0))return s;r=lineNo(a=c.to.line)}}function wrappedLineExtent(e,t,n,i){var r=function(i){return intoCoordSystem(e,t,measureCharPrepared(e,n,i),"line")},o=t.text.length,a=findFirst(function(e){return r(e-1).bottom<=i},o,0);return o=findFirst(function(e){return r(e).top>i},a,o),{begin:a,end:o}}function wrappedLineExtentChar(e,t,n,i){return wrappedLineExtent(e,t,n,intoCoordSystem(e,t,measureCharPrepared(e,n,i),"line").top)}function coordsCharInner(e,t,n,i,r){r-=heightAtLine(t);var o,a=0,s=t.text.length,l=prepareMeasureForLine(e,t);if(getOrder(t,e.doc.direction)){if(e.options.lineWrapping){var c;c=wrappedLineExtent(e,t,l,r),a=c.begin,s=c.end}o=new Pos(n,Math.floor(a+(s-a)/2));var u,d,h=cursorCoords(e,o,"line",t,l).left,p=h<i?1:-1,f=h-i,g=Math.ceil((s-a)/4);e:do{u=f,d=o;for(var m=0;m<g;++m){var v=o;if(null==(o=moveVisually(e,t,o,p))||o.ch<a||s<=("before"==o.sticky?o.ch-1:o.ch)){o=v;break e}}if(f=cursorCoords(e,o,"line",t,l).left-i,g>1){var _=Math.abs(f-u)/g;g=Math.min(g,Math.ceil(Math.abs(f)/_)),p=f<0?1:-1}}while(0!=f&&(g>1||p<0!=f<0&&Math.abs(f)<=Math.abs(u)));if(Math.abs(f)>Math.abs(u)){if(f<0==u<0)throw new Error("Broke out of infinite loop in coordsCharInner");o=d}}else{var y=findFirst(function(n){var o=intoCoordSystem(e,t,measureCharPrepared(e,l,n),"line");return o.top>r?(s=Math.min(n,s),!0):!(o.bottom<=r)&&(o.left>i||!(o.right<i)&&i-o.left<o.right-i)},a,s);y=skipExtendingChars(t.text,y,1),o=new Pos(n,y,y==s?"before":"after")}var x=cursorCoords(e,o,"line",t,l);return(r<x.top||x.bottom<r)&&(o.outside=!0),o.xRel=i<x.left?-1:i>x.right?1:0,o}function textHeight(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==ie){ie=elt("pre");for(var t=0;t<49;++t)ie.appendChild(document.createTextNode("x")),ie.appendChild(elt("br"));ie.appendChild(document.createTextNode("x"))}removeChildrenAndAdd(e.measure,ie);var n=ie.offsetHeight/50;return n>3&&(e.cachedTextHeight=n),removeChildren(e.measure),n||1}function charWidth(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=elt("span","xxxxxxxxxx"),n=elt("pre",[t]);removeChildrenAndAdd(e.measure,n);var i=t.getBoundingClientRect(),r=(i.right-i.left)/10;return r>2&&(e.cachedCharWidth=r),r||10}function getDimensions(e){for(var t=e.display,n={},i={},r=t.gutters.clientLeft,o=t.gutters.firstChild,a=0;o;o=o.nextSibling,++a)n[e.options.gutters[a]]=o.offsetLeft+o.clientLeft+r,i[e.options.gutters[a]]=o.clientWidth;return{fixedPos:compensateForHScroll(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:i,wrapperWidth:t.wrapper.clientWidth}}function compensateForHScroll(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function estimateHeight(e){var t=textHeight(e.display),n=e.options.lineWrapping,i=n&&Math.max(5,e.display.scroller.clientWidth/charWidth(e.display)-3);return function(r){if(lineIsHidden(e.doc,r))return 0;var o=0;if(r.widgets)for(var a=0;a<r.widgets.length;a++)r.widgets[a].height&&(o+=r.widgets[a].height);return n?o+(Math.ceil(r.text.length/i)||1)*t:o+t}}function estimateLineHeights(e){var t=e.doc,n=estimateHeight(e);t.iter(function(e){var t=n(e);t!=e.height&&updateLineHeight(e,t)})}function posFromMouse(e,t,n,i){var r=e.display;if(!n&&"true"==e_target(t).getAttribute("cm-not-content"))return null;var o,a,s=r.lineSpace.getBoundingClientRect();try{o=t.clientX-s.left,a=t.clientY-s.top}catch(t){return null}var l,c=coordsChar(e,o,a);if(i&&1==c.xRel&&(l=getLine(e.doc,c.line).text).length==c.ch){var u=countColumn(l,l.length,e.options.tabSize)-l.length;c=Pos(c.line,Math.max(0,Math.round((o-paddingH(e.display).left)/charWidth(e.display))-u))}return c}function findViewIndex(e,t){if(t>=e.display.viewTo)return null;if((t-=e.display.viewFrom)<0)return null;for(var n=e.display.view,i=0;i<n.length;i++)if((t-=n[i].size)<0)return i}function updateSelection(e){e.display.input.showSelection(e.display.input.prepareSelection())}function prepareSelection(e,t){for(var n=e.doc,i={},r=i.cursors=document.createDocumentFragment(),o=i.selection=document.createDocumentFragment(),a=0;a<n.sel.ranges.length;a++)if(!1!==t||a!=n.sel.primIndex){var s=n.sel.ranges[a];if(!(s.from().line>=e.display.viewTo||s.to().line<e.display.viewFrom)){var l=s.empty();(l||e.options.showCursorWhenSelecting)&&drawSelectionCursor(e,s.head,r),l||drawSelectionRange(e,s,o)}}return i}function drawSelectionCursor(e,t,n){var i=cursorCoords(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),r=n.appendChild(elt("div"," ","CodeMirror-cursor"));if(r.style.left=i.left+"px",r.style.top=i.top+"px",r.style.height=Math.max(0,i.bottom-i.top)*e.options.cursorHeight+"px",i.other){var o=n.appendChild(elt("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));o.style.display="",o.style.left=i.other.left+"px",o.style.top=i.other.top+"px",o.style.height=.85*(i.other.bottom-i.other.top)+"px"}}function drawSelectionRange(e,t,n){function add(e,t,n,i){t<0&&(t=0),t=Math.round(t),i=Math.round(i),o.appendChild(elt("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px;\n                             top: "+t+"px; width: "+(null==n?l-e:n)+"px;\n                             height: "+(i-t)+"px"))}function drawForLine(t,n,i){function coords(n,i){return charCoords(e,Pos(t,n),"div",c,i)}var o,a,c=getLine(r,t),u=c.text.length;return iterateBidiSections(getOrder(c,r.direction),n||0,null==i?u:i,function(e,t,r){var c,d,h,p=coords(e,"left");if(e==t)c=p,d=h=p.left;else{if(c=coords(t-1,"right"),"rtl"==r){var f=p;p=c,c=f}d=p.left,h=c.right}null==n&&0==e&&(d=s),c.top-p.top>3&&(add(d,p.top,null,p.bottom),d=s,p.bottom<c.top&&add(d,p.bottom,null,c.top)),null==i&&t==u&&(h=l),(!o||p.top<o.top||p.top==o.top&&p.left<o.left)&&(o=p),(!a||c.bottom>a.bottom||c.bottom==a.bottom&&c.right>a.right)&&(a=c),d<s+1&&(d=s),add(d,c.top,h-d,c.bottom)}),{start:o,end:a}}var i=e.display,r=e.doc,o=document.createDocumentFragment(),a=paddingH(e.display),s=a.left,l=Math.max(i.sizerWidth,displayWidth(e)-i.sizer.offsetLeft)-a.right,c=t.from(),u=t.to();if(c.line==u.line)drawForLine(c.line,c.ch,u.ch);else{var d=getLine(r,c.line),h=getLine(r,u.line),p=visualLine(d)==visualLine(h),f=drawForLine(c.line,c.ch,p?d.text.length+1:null).end,g=drawForLine(u.line,p?0:null,u.ch).start;p&&(f.top<g.top-2?(add(f.right,f.top,null,f.bottom),add(s,g.top,g.left,g.bottom)):add(f.right,f.top,g.left-f.right,f.bottom)),f.bottom<g.top&&add(s,f.bottom,null,g.top)}n.appendChild(o)}function restartBlink(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var n=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(function(){return t.cursorDiv.style.visibility=(n=!n)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function ensureFocus(e){e.state.focused||(e.display.input.focus(),onFocus(e))}function delayBlurEvent(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,onBlur(e))},100)}function onFocus(e,t){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(signal(e,"focus",e,t),e.state.focused=!0,addClass(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),l&&setTimeout(function(){return e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),restartBlink(e))}function onBlur(e,t){e.state.delayingBlurEvent||(e.state.focused&&(signal(e,"blur",e,t),e.state.focused=!1,T(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function updateHeightsInViewport(e){for(var t=e.display,n=t.lineDiv.offsetTop,i=0;i<t.view.length;i++){var r=t.view[i],o=void 0;if(!r.hidden){if(a&&s<8){var l=r.node.offsetTop+r.node.offsetHeight;o=l-n,n=l}else{var c=r.node.getBoundingClientRect();o=c.bottom-c.top}var u=r.line.height-o;if(o<2&&(o=textHeight(t)),(u>.005||u<-.005)&&(updateLineHeight(r.line,o),updateWidgetHeight(r.line),r.rest))for(var d=0;d<r.rest.length;d++)updateWidgetHeight(r.rest[d])}}}function updateWidgetHeight(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t)e.widgets[t].height=e.widgets[t].node.parentNode.offsetHeight}function visibleLines(e,t,n){var i=n&&null!=n.top?Math.max(0,n.top):e.scroller.scrollTop;i=Math.floor(i-paddingTop(e));var r=n&&null!=n.bottom?n.bottom:i+e.wrapper.clientHeight,o=lineAtHeight(t,i),a=lineAtHeight(t,r);if(n&&n.ensure){var s=n.ensure.from.line,l=n.ensure.to.line;s<o?(o=s,a=lineAtHeight(t,heightAtLine(getLine(t,s))+e.wrapper.clientHeight)):Math.min(l,t.lastLine())>=a&&(o=lineAtHeight(t,heightAtLine(getLine(t,l))-e.wrapper.clientHeight),a=l)}return{from:o,to:Math.max(a,o+1)}}function alignHorizontally(e){var t=e.display,n=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var i=compensateForHScroll(t)-t.scroller.scrollLeft+e.doc.scrollLeft,r=t.gutters.offsetWidth,o=i+"px",a=0;a<n.length;a++)if(!n[a].hidden){e.options.fixedGutter&&(n[a].gutter&&(n[a].gutter.style.left=o),n[a].gutterBackground&&(n[a].gutterBackground.style.left=o));var s=n[a].alignable;if(s)for(var l=0;l<s.length;l++)s[l].style.left=o}e.options.fixedGutter&&(t.gutters.style.left=i+r+"px")}}function maybeUpdateLineNumberWidth(e){if(!e.options.lineNumbers)return!1;var t=e.doc,n=lineNumberFor(e.options,t.first+t.size-1),i=e.display;if(n.length!=i.lineNumChars){var r=i.measure.appendChild(elt("div",[elt("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),o=r.firstChild.offsetWidth,a=r.offsetWidth-o;return i.lineGutter.style.width="",i.lineNumInnerWidth=Math.max(o,i.lineGutter.offsetWidth-a)+1,i.lineNumWidth=i.lineNumInnerWidth+a,i.lineNumChars=i.lineNumInnerWidth?n.length:-1,i.lineGutter.style.width=i.lineNumWidth+"px",updateGutterSpace(e),!0}return!1}function maybeScrollWindow(e,t){if(!signalDOMEvent(e,"scrollCursorIntoView")){var n=e.display,i=n.sizer.getBoundingClientRect(),r=null;if(t.top+i.top<0?r=!0:t.bottom+i.top>(window.innerHeight||document.documentElement.clientHeight)&&(r=!1),null!=r&&!f){var o=elt("div","​",null,"position: absolute;\n                         top: "+(t.top-n.viewOffset-paddingTop(e.display))+"px;\n                         height: "+(t.bottom-t.top+scrollGap(e)+n.barHeight)+"px;\n                         left: "+t.left+"px; width: "+Math.max(2,t.right-t.left)+"px;");e.display.lineSpace.appendChild(o),o.scrollIntoView(r),e.display.lineSpace.removeChild(o)}}}function scrollPosIntoView(e,t,n,i){null==i&&(i=0);var r;e.options.lineWrapping||t!=n||(t=t.ch?Pos(t.line,"before"==t.sticky?t.ch-1:t.ch,"after"):t,n="before"==t.sticky?Pos(t.line,t.ch+1,"before"):t);for(var o=0;o<5;o++){var a=!1,s=cursorCoords(e,t),l=n&&n!=t?cursorCoords(e,n):s;r={left:Math.min(s.left,l.left),top:Math.min(s.top,l.top)-i,right:Math.max(s.left,l.left),bottom:Math.max(s.bottom,l.bottom)+i};var c=calculateScrollPos(e,r),u=e.doc.scrollTop,d=e.doc.scrollLeft;if(null!=c.scrollTop&&(updateScrollTop(e,c.scrollTop),Math.abs(e.doc.scrollTop-u)>1&&(a=!0)),null!=c.scrollLeft&&(setScrollLeft(e,c.scrollLeft),Math.abs(e.doc.scrollLeft-d)>1&&(a=!0)),!a)break}return r}function scrollIntoView(e,t){var n=calculateScrollPos(e,t);null!=n.scrollTop&&updateScrollTop(e,n.scrollTop),null!=n.scrollLeft&&setScrollLeft(e,n.scrollLeft)}function calculateScrollPos(e,t){var n=e.display,i=textHeight(e.display);t.top<0&&(t.top=0);var r=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:n.scroller.scrollTop,o=displayHeight(e),a={};t.bottom-t.top>o&&(t.bottom=t.top+o);var s=e.doc.height+paddingVert(n),l=t.top<i,c=t.bottom>s-i;if(t.top<r)a.scrollTop=l?0:t.top;else if(t.bottom>r+o){var u=Math.min(t.top,(c?s:t.bottom)-o);u!=r&&(a.scrollTop=u)}var d=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:n.scroller.scrollLeft,h=displayWidth(e)-(e.options.fixedGutter?n.gutters.offsetWidth:0),p=t.right-t.left>h;return p&&(t.right=t.left+h),t.left<10?a.scrollLeft=0:t.left<d?a.scrollLeft=Math.max(0,t.left-(p?0:10)):t.right>h+d-3&&(a.scrollLeft=t.right+(p?0:10)-h),a}function addToScrollTop(e,t){null!=t&&(resolveScrollToPos(e),e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+t)}function ensureCursorVisible(e){resolveScrollToPos(e);var t=e.getCursor();e.curOp.scrollToPos={from:t,to:t,margin:e.options.cursorScrollMargin}}function scrollToCoords(e,t,n){null==t&&null==n||resolveScrollToPos(e),null!=t&&(e.curOp.scrollLeft=t),null!=n&&(e.curOp.scrollTop=n)}function scrollToRange(e,t){resolveScrollToPos(e),e.curOp.scrollToPos=t}function resolveScrollToPos(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;scrollToCoordsRange(e,estimateCoords(e,t.from),estimateCoords(e,t.to),t.margin)}}function scrollToCoordsRange(e,t,n,i){var r=calculateScrollPos(e,{left:Math.min(t.left,n.left),top:Math.min(t.top,n.top)-i,right:Math.max(t.right,n.right),bottom:Math.max(t.bottom,n.bottom)+i});scrollToCoords(e,r.scrollLeft,r.scrollTop)}function updateScrollTop(e,t){Math.abs(e.doc.scrollTop-t)<2||(n||updateDisplaySimple(e,{top:t}),setScrollTop(e,t,!0),n&&updateDisplaySimple(e),startWorker(e,100))}function setScrollTop(e,t,n){t=Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,t),(e.display.scroller.scrollTop!=t||n)&&(e.doc.scrollTop=t,e.display.scrollbars.setScrollTop(t),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t))}function setScrollLeft(e,t,n,i){t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),(n?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)&&!i||(e.doc.scrollLeft=t,alignHorizontally(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function measureForScrollbars(e){var t=e.display,n=t.gutters.offsetWidth,i=Math.round(e.doc.height+paddingVert(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?n:0,docHeight:i,scrollHeight:i+scrollGap(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:n}}function updateScrollbars(e,t){t||(t=measureForScrollbars(e));var n=e.display.barWidth,i=e.display.barHeight;updateScrollbarsInner(e,t);for(var r=0;r<4&&n!=e.display.barWidth||i!=e.display.barHeight;r++)n!=e.display.barWidth&&e.options.lineWrapping&&updateHeightsInViewport(e),updateScrollbarsInner(e,measureForScrollbars(e)),n=e.display.barWidth,i=e.display.barHeight}function updateScrollbarsInner(e,t){var n=e.display,i=n.scrollbars.update(t);n.sizer.style.paddingRight=(n.barWidth=i.right)+"px",n.sizer.style.paddingBottom=(n.barHeight=i.bottom)+"px",n.heightForcer.style.borderBottom=i.bottom+"px solid transparent",i.right&&i.bottom?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=i.bottom+"px",n.scrollbarFiller.style.width=i.right+"px"):n.scrollbarFiller.style.display="",i.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=i.bottom+"px",n.gutterFiller.style.width=t.gutterWidth+"px"):n.gutterFiller.style.display=""}function initScrollbars(e){e.display.scrollbars&&(e.display.scrollbars.clear(),e.display.scrollbars.addClass&&T(e.display.wrapper,e.display.scrollbars.addClass)),e.display.scrollbars=new de[e.options.scrollbarStyle](function(t){e.display.wrapper.insertBefore(t,e.display.scrollbarFiller),U(t,"mousedown",function(){e.state.focused&&setTimeout(function(){return e.display.input.focus()},0)}),t.setAttribute("cm-not-content","true")},function(t,n){"horizontal"==n?setScrollLeft(e,t):updateScrollTop(e,t)},e),e.display.scrollbars.addClass&&addClass(e.display.wrapper,e.display.scrollbars.addClass)}function startOperation(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++he},pushOperation(e.curOp)}function endOperation(e){finishOperation(e.curOp,function(e){for(var t=0;t<e.ops.length;t++)e.ops[t].cm.curOp=null;endOperations(e)})}function endOperations(e){for(var t=e.ops,n=0;n<t.length;n++)endOperation_R1(t[n]);for(var i=0;i<t.length;i++)endOperation_W1(t[i]);for(var r=0;r<t.length;r++)endOperation_R2(t[r]);for(var o=0;o<t.length;o++)endOperation_W2(t[o]);for(var a=0;a<t.length;a++)endOperation_finish(t[a])}function endOperation_R1(e){var t=e.cm,n=t.display;maybeClipScrollbars(t),e.updateMaxLine&&findMaxLine(t),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<n.viewFrom||e.scrollToPos.to.line>=n.viewTo)||n.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new pe(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function endOperation_W1(e){e.updatedDisplay=e.mustUpdate&&updateDisplayIfNeeded(e.cm,e.update)}function endOperation_R2(e){var t=e.cm,n=t.display;e.updatedDisplay&&updateHeightsInViewport(t),e.barMeasure=measureForScrollbars(t),n.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=measureChar(t,n.maxLine,n.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(n.scroller.clientWidth,n.sizer.offsetLeft+e.adjustWidthTo+scrollGap(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,n.sizer.offsetLeft+e.adjustWidthTo-displayWidth(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=n.input.prepareSelection(e.focus))}function endOperation_W2(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&setScrollLeft(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1);var n=e.focus&&e.focus==activeElt()&&(!document.hasFocus||document.hasFocus());e.preparedSelection&&t.display.input.showSelection(e.preparedSelection,n),(e.updatedDisplay||e.startHeight!=t.doc.height)&&updateScrollbars(t,e.barMeasure),e.updatedDisplay&&setDocumentHeight(t,e.barMeasure),e.selectionChanged&&restartBlink(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),n&&ensureFocus(e.cm)}function endOperation_finish(e){var t=e.cm,n=t.display,i=t.doc;if(e.updatedDisplay&&postUpdateDisplay(t,e.update),null==n.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(n.wheelStartX=n.wheelStartY=null),null!=e.scrollTop&&setScrollTop(t,e.scrollTop,e.forceScroll),null!=e.scrollLeft&&setScrollLeft(t,e.scrollLeft,!0,!0),e.scrollToPos){maybeScrollWindow(t,scrollPosIntoView(t,clipPos(i,e.scrollToPos.from),clipPos(i,e.scrollToPos.to),e.scrollToPos.margin))}var r=e.maybeHiddenMarkers,o=e.maybeUnhiddenMarkers;if(r)for(var a=0;a<r.length;++a)r[a].lines.length||signal(r[a],"hide");if(o)for(var s=0;s<o.length;++s)o[s].lines.length&&signal(o[s],"unhide");n.wrapper.offsetHeight&&(i.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&signal(t,"changes",t,e.changeObjs),e.update&&e.update.finish()}function runInOp(e,t){if(e.curOp)return t();startOperation(e);try{return t()}finally{endOperation(e)}}function operation(e,t){return function(){if(e.curOp)return t.apply(e,arguments);startOperation(e);try{return t.apply(e,arguments)}finally{endOperation(e)}}}function methodOp(e){return function(){if(this.curOp)return e.apply(this,arguments);startOperation(this);try{return e.apply(this,arguments)}finally{endOperation(this)}}}function docMethodOp(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);startOperation(t);try{return e.apply(this,arguments)}finally{endOperation(t)}}}function regChange(e,t,n,i){null==t&&(t=e.doc.first),null==n&&(n=e.doc.first+e.doc.size),i||(i=0);var r=e.display;if(i&&n<r.viewTo&&(null==r.updateLineNumbers||r.updateLineNumbers>t)&&(r.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=r.viewTo)B&&visualLineNo(e.doc,t)<r.viewTo&&resetView(e);else if(n<=r.viewFrom)B&&visualLineEndNo(e.doc,n+i)>r.viewFrom?resetView(e):(r.viewFrom+=i,r.viewTo+=i);else if(t<=r.viewFrom&&n>=r.viewTo)resetView(e);else if(t<=r.viewFrom){var o=viewCuttingPoint(e,n,n+i,1);o?(r.view=r.view.slice(o.index),r.viewFrom=o.lineN,r.viewTo+=i):resetView(e)}else if(n>=r.viewTo){var a=viewCuttingPoint(e,t,t,-1);a?(r.view=r.view.slice(0,a.index),r.viewTo=a.lineN):resetView(e)}else{var s=viewCuttingPoint(e,t,t,-1),l=viewCuttingPoint(e,n,n+i,1);s&&l?(r.view=r.view.slice(0,s.index).concat(buildViewArray(e,s.lineN,l.lineN)).concat(r.view.slice(l.index)),r.viewTo+=i):resetView(e)}var c=r.externalMeasured;c&&(n<c.lineN?c.lineN+=i:t<c.lineN+c.size&&(r.externalMeasured=null))}function regLineChange(e,t,n){e.curOp.viewChanged=!0;var i=e.display,r=e.display.externalMeasured;if(r&&t>=r.lineN&&t<r.lineN+r.size&&(i.externalMeasured=null),!(t<i.viewFrom||t>=i.viewTo)){var o=i.view[findViewIndex(e,t)];if(null!=o.node){var a=o.changes||(o.changes=[]);-1==indexOf(a,n)&&a.push(n)}}}function resetView(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function viewCuttingPoint(e,t,n,i){var r,o=findViewIndex(e,t),a=e.display.view;if(!B||n==e.doc.first+e.doc.size)return{index:o,lineN:n};for(var s=e.display.viewFrom,l=0;l<o;l++)s+=a[l].size;if(s!=t){if(i>0){if(o==a.length-1)return null;r=s+a[o].size-t,o++}else r=s-t;t+=r,n+=r}for(;visualLineNo(e.doc,n)!=n;){if(o==(i<0?0:a.length-1))return null;n+=i*a[o-(i<0?1:0)].size,o+=i}return{index:o,lineN:n}}function adjustView(e,t,n){var i=e.display;0==i.view.length||t>=i.viewTo||n<=i.viewFrom?(i.view=buildViewArray(e,t,n),i.viewFrom=t):(i.viewFrom>t?i.view=buildViewArray(e,t,i.viewFrom).concat(i.view):i.viewFrom<t&&(i.view=i.view.slice(findViewIndex(e,t))),i.viewFrom=t,i.viewTo<n?i.view=i.view.concat(buildViewArray(e,i.viewTo,n)):i.viewTo>n&&(i.view=i.view.slice(0,findViewIndex(e,n)))),i.viewTo=n}function countDirtyView(e){for(var t=e.display.view,n=0,i=0;i<t.length;i++){var r=t[i];r.hidden||r.node&&!r.changes||++n}return n}function startWorker(e,t){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(t,bind(highlightWorker,e))}function highlightWorker(e){var t=e.doc;if(!(t.highlightFrontier>=e.display.viewTo)){var n=+new Date+e.options.workTime,i=getContextBefore(e,t.highlightFrontier),r=[];t.iter(i.line,Math.min(t.first+t.size,e.display.viewTo+500),function(o){if(i.line>=e.display.viewFrom){var a=o.styles,s=o.text.length>e.options.maxHighlightLength?copyState(t.mode,i.state):null,l=highlightLine(e,o,i,!0);s&&(i.state=s),o.styles=l.styles;var c=o.styleClasses,u=l.classes;u?o.styleClasses=u:c&&(o.styleClasses=null);for(var d=!a||a.length!=o.styles.length||c!=u&&(!c||!u||c.bgClass!=u.bgClass||c.textClass!=u.textClass),h=0;!d&&h<a.length;++h)d=a[h]!=o.styles[h];d&&r.push(i.line),o.stateAfter=i.save(),i.nextLine()}else o.text.length<=e.options.maxHighlightLength&&processLine(e,o.text,i),o.stateAfter=i.line%5==0?i.save():null,i.nextLine();if(+new Date>n)return startWorker(e,e.options.workDelay),!0}),t.highlightFrontier=i.line,t.modeFrontier=Math.max(t.modeFrontier,i.line),r.length&&runInOp(e,function(){for(var t=0;t<r.length;t++)regLineChange(e,r[t],"text")})}}function maybeClipScrollbars(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=scrollGap(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=scrollGap(e)+"px",t.scrollbarsClipped=!0)}function selectionSnapshot(e){if(e.hasFocus())return null;var t=activeElt();if(!t||!contains(e.display.lineDiv,t))return null;var n={activeElt:t};if(window.getSelection){var i=window.getSelection();i.anchorNode&&i.extend&&contains(e.display.lineDiv,i.anchorNode)&&(n.anchorNode=i.anchorNode,n.anchorOffset=i.anchorOffset,n.focusNode=i.focusNode,n.focusOffset=i.focusOffset)}return n}function restoreSelection(e){if(e&&e.activeElt&&e.activeElt!=activeElt()&&(e.activeElt.focus(),e.anchorNode&&contains(document.body,e.anchorNode)&&contains(document.body,e.focusNode))){var t=window.getSelection(),n=document.createRange();n.setEnd(e.anchorNode,e.anchorOffset),n.collapse(!1),t.removeAllRanges(),t.addRange(n),t.extend(e.focusNode,e.focusOffset)}}function updateDisplayIfNeeded(e,t){var n=e.display,i=e.doc;if(t.editorIsHidden)return resetView(e),!1;if(!t.force&&t.visible.from>=n.viewFrom&&t.visible.to<=n.viewTo&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo)&&n.renderedView==n.view&&0==countDirtyView(e))return!1;maybeUpdateLineNumberWidth(e)&&(resetView(e),t.dims=getDimensions(e));var r=i.first+i.size,o=Math.max(t.visible.from-e.options.viewportMargin,i.first),a=Math.min(r,t.visible.to+e.options.viewportMargin);n.viewFrom<o&&o-n.viewFrom<20&&(o=Math.max(i.first,n.viewFrom)),n.viewTo>a&&n.viewTo-a<20&&(a=Math.min(r,n.viewTo)),B&&(o=visualLineNo(e.doc,o),a=visualLineEndNo(e.doc,a));var s=o!=n.viewFrom||a!=n.viewTo||n.lastWrapHeight!=t.wrapperHeight||n.lastWrapWidth!=t.wrapperWidth;adjustView(e,o,a),n.viewOffset=heightAtLine(getLine(e.doc,n.viewFrom)),e.display.mover.style.top=n.viewOffset+"px";var l=countDirtyView(e);if(!s&&0==l&&!t.force&&n.renderedView==n.view&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo))return!1;var c=selectionSnapshot(e);return l>4&&(n.lineDiv.style.display="none"),patchDisplay(e,n.updateLineNumbers,t.dims),l>4&&(n.lineDiv.style.display=""),n.renderedView=n.view,restoreSelection(c),removeChildren(n.cursorDiv),removeChildren(n.selectionDiv),n.gutters.style.height=n.sizer.style.minHeight=0,s&&(n.lastWrapHeight=t.wrapperHeight,n.lastWrapWidth=t.wrapperWidth,startWorker(e,400)),n.updateLineNumbers=null,!0}function postUpdateDisplay(e,t){for(var n=t.viewport,i=!0;(i&&e.options.lineWrapping&&t.oldDisplayWidth!=displayWidth(e)||(n&&null!=n.top&&(n={top:Math.min(e.doc.height+paddingVert(e.display)-displayHeight(e),n.top)}),t.visible=visibleLines(e.display,e.doc,n),!(t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)))&&updateDisplayIfNeeded(e,t);i=!1){updateHeightsInViewport(e);var r=measureForScrollbars(e);updateSelection(e),updateScrollbars(e,r),setDocumentHeight(e,r),t.force=!1}t.signal(e,"update",e),e.display.viewFrom==e.display.reportedViewFrom&&e.display.viewTo==e.display.reportedViewTo||(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function updateDisplaySimple(e,t){var n=new pe(e,t);if(updateDisplayIfNeeded(e,n)){updateHeightsInViewport(e),postUpdateDisplay(e,n);var i=measureForScrollbars(e);updateSelection(e),updateScrollbars(e,i),setDocumentHeight(e,i),n.finish()}}function patchDisplay(e,t,n){function rm(t){var n=t.nextSibling;return l&&_&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),n}for(var i=e.display,r=e.options.lineNumbers,o=i.lineDiv,a=o.firstChild,s=i.view,c=i.viewFrom,u=0;u<s.length;u++){var d=s[u];if(d.hidden);else if(d.node&&d.node.parentNode==o){for(;a!=d.node;)a=rm(a);var h=r&&null!=t&&t<=c&&d.lineNumber;d.changes&&(indexOf(d.changes,"gutter")>-1&&(h=!1),updateLineForChanges(e,d,c,n)),h&&(removeChildren(d.lineNumber),d.lineNumber.appendChild(document.createTextNode(lineNumberFor(e.options,c)))),a=d.node.nextSibling}else{var p=buildLineElement(e,d,c,n);o.insertBefore(p,a)}c+=d.size}for(;a;)a=rm(a)}function updateGutterSpace(e){var t=e.display.gutters.offsetWidth;e.display.sizer.style.marginLeft=t+"px"}function setDocumentHeight(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+scrollGap(e)+"px"}function updateGutters(e){var t=e.display.gutters,n=e.options.gutters;removeChildren(t);for(var i=0;i<n.length;++i){var r=n[i],o=t.appendChild(elt("div",null,"CodeMirror-gutter "+r));"CodeMirror-linenumbers"==r&&(e.display.lineGutter=o,o.style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=i?"":"none",updateGutterSpace(e)}function setGuttersForLineNumbers(e){var t=indexOf(e.gutters,"CodeMirror-linenumbers");-1==t&&e.lineNumbers?e.gutters=e.gutters.concat(["CodeMirror-linenumbers"]):t>-1&&!e.lineNumbers&&(e.gutters=e.gutters.slice(0),e.gutters.splice(t,1))}function wheelEventDelta(e){var t=e.wheelDeltaX,n=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==n&&e.detail&&e.axis==e.VERTICAL_AXIS?n=e.detail:null==n&&(n=e.wheelDelta),{x:t,y:n}}function wheelEventPixels(e){var t=wheelEventDelta(e);return t.x*=ge,t.y*=ge,t}function onScrollWheel(e,t){var i=wheelEventDelta(t),r=i.x,o=i.y,a=e.display,s=a.scroller,c=s.scrollWidth>s.clientWidth,u=s.scrollHeight>s.clientHeight;if(r&&c||o&&u){if(o&&_&&l)e:for(var h=t.target,p=a.view;h!=s;h=h.parentNode)for(var f=0;f<p.length;f++)if(p[f].node==h){e.display.currentWheelTarget=h;break e}if(r&&!n&&!d&&null!=ge)return o&&u&&updateScrollTop(e,Math.max(0,s.scrollTop+o*ge)),setScrollLeft(e,Math.max(0,s.scrollLeft+r*ge)),(!o||o&&u)&&e_preventDefault(t),void(a.wheelStartX=null);if(o&&null!=ge){var g=o*ge,m=e.doc.scrollTop,v=m+a.wrapper.clientHeight;g<0?m=Math.max(0,m+g-50):v=Math.min(e.doc.height,v+g+50),updateDisplaySimple(e,{top:m,bottom:v})}fe<20&&(null==a.wheelStartX?(a.wheelStartX=s.scrollLeft,a.wheelStartY=s.scrollTop,a.wheelDX=r,a.wheelDY=o,setTimeout(function(){if(null!=a.wheelStartX){var e=s.scrollLeft-a.wheelStartX,t=s.scrollTop-a.wheelStartY,n=t&&a.wheelDY&&t/a.wheelDY||e&&a.wheelDX&&e/a.wheelDX;a.wheelStartX=a.wheelStartY=null,n&&(ge=(ge*fe+n)/(fe+1),++fe)}},200)):(a.wheelDX+=r,a.wheelDY+=o))}}function normalizeSelection(e,t){var n=e[t];e.sort(function(e,t){return cmp(e.from(),t.from())}),t=indexOf(e,n);for(var i=1;i<e.length;i++){var r=e[i],o=e[i-1];if(cmp(o.to(),r.from())>=0){var a=minPos(o.from(),r.from()),s=maxPos(o.to(),r.to()),l=o.empty()?r.from()==r.head:o.from()==o.head;i<=t&&--t,e.splice(--i,2,new ve(l?s:a,l?a:s))}}return new me(e,t)}function simpleSelection(e,t){return new me([new ve(e,t||e)],0)}function changeEnd(e){return e.text?Pos(e.from.line+e.text.length-1,lst(e.text).length+(1==e.text.length?e.from.ch:0)):e.to}function adjustForChange(e,t){if(cmp(e,t.from)<0)return e;if(cmp(e,t.to)<=0)return changeEnd(t);var n=e.line+t.text.length-(t.to.line-t.from.line)-1,i=e.ch;return e.line==t.to.line&&(i+=changeEnd(t).ch-t.to.ch),Pos(n,i)}function computeSelAfterChange(e,t){for(var n=[],i=0;i<e.sel.ranges.length;i++){var r=e.sel.ranges[i];n.push(new ve(adjustForChange(r.anchor,t),adjustForChange(r.head,t)))}return normalizeSelection(n,e.sel.primIndex)}function offsetPos(e,t,n){return e.line==t.line?Pos(n.line,e.ch-t.ch+n.ch):Pos(n.line+(e.line-t.line),e.ch)}function computeReplacedSel(e,t,n){for(var i=[],r=Pos(e.first,0),o=r,a=0;a<t.length;a++){var s=t[a],l=offsetPos(s.from,r,o),c=offsetPos(changeEnd(s),r,o);if(r=s.to,o=c,"around"==n){var u=e.sel.ranges[a],d=cmp(u.head,u.anchor)<0;i[a]=new ve(d?c:l,d?l:c)}else i[a]=new ve(l,l)}return new me(i,e.sel.primIndex)}function loadMode(e){e.doc.mode=getMode(e.options,e.doc.modeOption),resetModeState(e)}function resetModeState(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,startWorker(e,100),e.state.modeGen++,e.curOp&&regChange(e)}function isWholeLineUpdate(e,t){return 0==t.from.ch&&0==t.to.ch&&""==lst(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function updateDoc(e,t,n,i){function spansFor(e){return n?n[e]:null}function update(e,n,r){updateLine(e,n,r,i),signalLater(e,"change",e,t)}function linesFor(e,t){for(var n=[],r=e;r<t;++r)n.push(new ne(a[r],spansFor(r),i));return n}var r=t.from,o=t.to,a=t.text,s=getLine(e,r.line),l=getLine(e,o.line),c=lst(a),u=spansFor(a.length-1),d=o.line-r.line;if(t.full)e.insert(0,linesFor(0,a.length)),e.remove(a.length,e.size-a.length);else if(isWholeLineUpdate(e,t)){var h=linesFor(0,a.length-1);update(l,l.text,u),d&&e.remove(r.line,d),h.length&&e.insert(r.line,h)}else if(s==l)if(1==a.length)update(s,s.text.slice(0,r.ch)+c+s.text.slice(o.ch),u);else{var p=linesFor(1,a.length-1);p.push(new ne(c+s.text.slice(o.ch),u,i)),update(s,s.text.slice(0,r.ch)+a[0],spansFor(0)),e.insert(r.line+1,p)}else if(1==a.length)update(s,s.text.slice(0,r.ch)+a[0]+l.text.slice(o.ch),spansFor(0)),e.remove(r.line+1,d);else{update(s,s.text.slice(0,r.ch)+a[0],spansFor(0)),update(l,c+l.text.slice(o.ch),u);var f=linesFor(1,a.length-1);d>1&&e.remove(r.line+1,d-1),e.insert(r.line+1,f)}signalLater(e,"change",e,t)}function linkedDocs(e,t,n){function propagate(e,i,r){if(e.linked)for(var o=0;o<e.linked.length;++o){var a=e.linked[o];if(a.doc!=i){var s=r&&a.sharedHist;n&&!s||(t(a.doc,s),propagate(a.doc,e,s))}}}propagate(e,null,!0)}function attachDoc(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,estimateLineHeights(e),loadMode(e),setDirectionClass(e),e.options.lineWrapping||findMaxLine(e),e.options.mode=t.modeOption,regChange(e)}function setDirectionClass(e){("rtl"==e.doc.direction?addClass:T)(e.display.lineDiv,"CodeMirror-rtl")}function directionChanged(e){runInOp(e,function(){setDirectionClass(e),regChange(e)})}function History(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function historyChangeFromChange(e,t){var n={from:copyPos(t.from),to:changeEnd(t),text:getBetween(e,t.from,t.to)};return attachLocalSpans(e,n,t.from.line,t.to.line+1),linkedDocs(e,function(e){return attachLocalSpans(e,n,t.from.line,t.to.line+1)},!0),n}function clearSelectionEvents(e){for(;e.length;){if(!lst(e).ranges)break;e.pop()}}function lastChangeEvent(e,t){return t?(clearSelectionEvents(e.done),lst(e.done)):e.done.length&&!lst(e.done).ranges?lst(e.done):e.done.length>1&&!e.done[e.done.length-2].ranges?(e.done.pop(),lst(e.done)):void 0}function addChangeToHistory(e,t,n,i){var r=e.history;r.undone.length=0;var o,a,s=+new Date;if((r.lastOp==i||r.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&e.cm&&r.lastModTime>s-e.cm.options.historyEventDelay||"*"==t.origin.charAt(0)))&&(o=lastChangeEvent(r,r.lastOp==i)))a=lst(o.changes),0==cmp(t.from,t.to)&&0==cmp(t.from,a.to)?a.to=changeEnd(t):o.changes.push(historyChangeFromChange(e,t));else{var l=lst(r.done);for(l&&l.ranges||pushSelectionToHistory(e.sel,r.done),o={changes:[historyChangeFromChange(e,t)],generation:r.generation},r.done.push(o);r.done.length>r.undoDepth;)r.done.shift(),r.done[0].ranges||r.done.shift()}r.done.push(n),r.generation=++r.maxGeneration,r.lastModTime=r.lastSelTime=s,r.lastOp=r.lastSelOp=i,r.lastOrigin=r.lastSelOrigin=t.origin,a||signal(e,"historyAdded")}function selectionEventCanBeMerged(e,t,n,i){var r=t.charAt(0);return"*"==r||"+"==r&&n.ranges.length==i.ranges.length&&n.somethingSelected()==i.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function addSelectionToHistory(e,t,n,i){var r=e.history,o=i&&i.origin;n==r.lastSelOp||o&&r.lastSelOrigin==o&&(r.lastModTime==r.lastSelTime&&r.lastOrigin==o||selectionEventCanBeMerged(e,o,lst(r.done),t))?r.done[r.done.length-1]=t:pushSelectionToHistory(t,r.done),r.lastSelTime=+new Date,r.lastSelOrigin=o,r.lastSelOp=n,i&&!1!==i.clearRedo&&clearSelectionEvents(r.undone)}function pushSelectionToHistory(e,t){var n=lst(t);n&&n.ranges&&n.equals(e)||t.push(e)}function attachLocalSpans(e,t,n,i){var r=t["spans_"+e.id],o=0;e.iter(Math.max(e.first,n),Math.min(e.first+e.size,i),function(n){n.markedSpans&&((r||(r=t["spans_"+e.id]={}))[o]=n.markedSpans),++o})}function removeClearedSpans(e){if(!e)return null;for(var t,n=0;n<e.length;++n)e[n].marker.explicitlyCleared?t||(t=e.slice(0,n)):t&&t.push(e[n]);return t?t.length?t:null:e}function getOldSpans(e,t){var n=t["spans_"+e.id];if(!n)return null;for(var i=[],r=0;r<t.text.length;++r)i.push(removeClearedSpans(n[r]));return i}function mergeOldSpans(e,t){var n=getOldSpans(e,t),i=stretchSpansOverChange(e,t);if(!n)return i;if(!i)return n;for(var r=0;r<n.length;++r){var o=n[r],a=i[r];if(o&&a)e:for(var s=0;s<a.length;++s){for(var l=a[s],c=0;c<o.length;++c)if(o[c].marker==l.marker)continue e;o.push(l)}else a&&(n[r]=a)}return n}function copyHistoryArray(e,t,n){for(var i=[],r=0;r<e.length;++r){var o=e[r];if(o.ranges)i.push(n?me.prototype.deepCopy.call(o):o);else{var a=o.changes,s=[];i.push({changes:s});for(var l=0;l<a.length;++l){var c=a[l],u=void 0;if(s.push({from:c.from,to:c.to,text:c.text}),t)for(var d in c)(u=d.match(/^spans_(\d+)$/))&&indexOf(t,Number(u[1]))>-1&&(lst(s)[d]=c[d],delete c[d])}}}return i}function extendRange(e,t,n,i){if(i){var r=e.anchor;if(n){var o=cmp(t,r)<0;o!=cmp(n,r)<0?(r=t,t=n):o!=cmp(t,n)<0&&(t=n)}return new ve(r,t)}return new ve(n||t,t)}function extendSelection(e,t,n,i,r){null==r&&(r=e.cm&&(e.cm.display.shift||e.extend)),setSelection(e,new me([extendRange(e.sel.primary(),t,n,r)],0),i)}function extendSelections(e,t,n){for(var i=[],r=e.cm&&(e.cm.display.shift||e.extend),o=0;o<e.sel.ranges.length;o++)i[o]=extendRange(e.sel.ranges[o],t[o],null,r);setSelection(e,normalizeSelection(i,e.sel.primIndex),n)}function replaceOneSelection(e,t,n,i){var r=e.sel.ranges.slice(0);r[t]=n,setSelection(e,normalizeSelection(r,e.sel.primIndex),i)}function setSimpleSelection(e,t,n,i){setSelection(e,simpleSelection(t,n),i)}function filterSelectionChange(e,t,n){var i={ranges:t.ranges,update:function(t){var n=this;this.ranges=[];for(var i=0;i<t.length;i++)n.ranges[i]=new ve(clipPos(e,t[i].anchor),clipPos(e,t[i].head))},origin:n&&n.origin};return signal(e,"beforeSelectionChange",e,i),e.cm&&signal(e.cm,"beforeSelectionChange",e.cm,i),i.ranges!=t.ranges?normalizeSelection(i.ranges,i.ranges.length-1):t}function setSelectionReplaceHistory(e,t,n){var i=e.history.done,r=lst(i);r&&r.ranges?(i[i.length-1]=t,setSelectionNoUndo(e,t,n)):setSelection(e,t,n)}function setSelection(e,t,n){setSelectionNoUndo(e,t,n),addSelectionToHistory(e,e.sel,e.cm?e.cm.curOp.id:NaN,n)}function setSelectionNoUndo(e,t,n){(hasHandler(e,"beforeSelectionChange")||e.cm&&hasHandler(e.cm,"beforeSelectionChange"))&&(t=filterSelectionChange(e,t,n)),setSelectionInner(e,skipAtomicInSelection(e,t,n&&n.bias||(cmp(t.primary().head,e.sel.primary().head)<0?-1:1),!0)),n&&!1===n.scroll||!e.cm||ensureCursorVisible(e.cm)}function setSelectionInner(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0,signalCursorActivity(e.cm)),signalLater(e,"cursorActivity",e))}function reCheckSelection(e){setSelectionInner(e,skipAtomicInSelection(e,e.sel,null,!1))}function skipAtomicInSelection(e,t,n,i){for(var r,o=0;o<t.ranges.length;o++){var a=t.ranges[o],s=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[o],l=skipAtomic(e,a.anchor,s&&s.anchor,n,i),c=skipAtomic(e,a.head,s&&s.head,n,i);(r||l!=a.anchor||c!=a.head)&&(r||(r=t.ranges.slice(0,o)),r[o]=new ve(l,c))}return r?normalizeSelection(r,t.primIndex):t}function skipAtomicInner(e,t,n,i,r){var o=getLine(e,t.line);if(o.markedSpans)for(var a=0;a<o.markedSpans.length;++a){var s=o.markedSpans[a],l=s.marker;if((null==s.from||(l.inclusiveLeft?s.from<=t.ch:s.from<t.ch))&&(null==s.to||(l.inclusiveRight?s.to>=t.ch:s.to>t.ch))){if(r&&(signal(l,"beforeCursorEnter"),l.explicitlyCleared)){if(o.markedSpans){--a;continue}break}if(!l.atomic)continue;if(n){var c=l.find(i<0?1:-1),u=void 0;if((i<0?l.inclusiveRight:l.inclusiveLeft)&&(c=movePos(e,c,-i,c&&c.line==t.line?o:null)),c&&c.line==t.line&&(u=cmp(c,n))&&(i<0?u<0:u>0))return skipAtomicInner(e,c,t,i,r)}var d=l.find(i<0?-1:1);return(i<0?l.inclusiveLeft:l.inclusiveRight)&&(d=movePos(e,d,i,d.line==t.line?o:null)),d?skipAtomicInner(e,d,t,i,r):null}}return t}function skipAtomic(e,t,n,i,r){var o=i||1,a=skipAtomicInner(e,t,n,o,r)||!r&&skipAtomicInner(e,t,n,o,!0)||skipAtomicInner(e,t,n,-o,r)||!r&&skipAtomicInner(e,t,n,-o,!0);return a||(e.cantEdit=!0,Pos(e.first,0))}function movePos(e,t,n,i){return n<0&&0==t.ch?t.line>e.first?clipPos(e,Pos(t.line-1)):null:n>0&&t.ch==(i||getLine(e,t.line)).text.length?t.line<e.first+e.size-1?Pos(t.line+1,0):null:new Pos(t.line,t.ch+n)}function selectAll(e){e.setSelection(Pos(e.firstLine(),0),Pos(e.lastLine()),L)}function filterChange(e,t,n){var i={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){return i.canceled=!0}};return n&&(i.update=function(t,n,r,o){t&&(i.from=clipPos(e,t)),n&&(i.to=clipPos(e,n)),r&&(i.text=r),void 0!==o&&(i.origin=o)}),signal(e,"beforeChange",e,i),e.cm&&signal(e.cm,"beforeChange",e.cm,i),i.canceled?null:{from:i.from,to:i.to,text:i.text,origin:i.origin}}function makeChange(e,t,n){if(e.cm){if(!e.cm.curOp)return operation(e.cm,makeChange)(e,t,n);if(e.cm.state.suppressEdits)return}if(!(hasHandler(e,"beforeChange")||e.cm&&hasHandler(e.cm,"beforeChange"))||(t=filterChange(e,t,!0))){var i=F&&!n&&removeReadOnlyRanges(e,t.from,t.to);if(i)for(var r=i.length-1;r>=0;--r)makeChangeInner(e,{from:i[r].from,to:i[r].to,text:r?[""]:t.text,origin:t.origin});else makeChangeInner(e,t)}}function makeChangeInner(e,t){if(1!=t.text.length||""!=t.text[0]||0!=cmp(t.from,t.to)){var n=computeSelAfterChange(e,t);addChangeToHistory(e,t,n,e.cm?e.cm.curOp.id:NaN),makeChangeSingleDoc(e,t,n,stretchSpansOverChange(e,t));var i=[];linkedDocs(e,function(e,n){n||-1!=indexOf(i,e.history)||(rebaseHist(e.history,t),i.push(e.history)),makeChangeSingleDoc(e,t,null,stretchSpansOverChange(e,t))})}}function makeChangeFromHistory(e,t,n){if(!e.cm||!e.cm.state.suppressEdits||n){for(var i,r=e.history,o=e.sel,a="undo"==t?r.done:r.undone,s="undo"==t?r.undone:r.done,l=0;l<a.length&&(i=a[l],n?!i.ranges||i.equals(e.sel):i.ranges);l++);if(l!=a.length){for(r.lastOrigin=r.lastSelOrigin=null;i=a.pop(),i.ranges;){if(pushSelectionToHistory(i,s),n&&!i.equals(e.sel))return void setSelection(e,i,{clearRedo:!1});o=i}var c=[];pushSelectionToHistory(o,s),s.push({changes:c,generation:r.generation}),r.generation=i.generation||++r.maxGeneration;for(var u=hasHandler(e,"beforeChange")||e.cm&&hasHandler(e.cm,"beforeChange"),d=i.changes.length-1;d>=0;--d){var h=function(n){var r=i.changes[n];if(r.origin=t,u&&!filterChange(e,r,!1))return a.length=0,{};c.push(historyChangeFromChange(e,r));var o=n?computeSelAfterChange(e,r):lst(a);makeChangeSingleDoc(e,r,o,mergeOldSpans(e,r)),!n&&e.cm&&e.cm.scrollIntoView({from:r.from,to:changeEnd(r)});var s=[];linkedDocs(e,function(e,t){t||-1!=indexOf(s,e.history)||(rebaseHist(e.history,r),s.push(e.history)),makeChangeSingleDoc(e,r,null,mergeOldSpans(e,r))})}(d);if(h)return h.v}}}}function shiftDoc(e,t){if(0!=t&&(e.first+=t,e.sel=new me(map(e.sel.ranges,function(e){return new ve(Pos(e.anchor.line+t,e.anchor.ch),Pos(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){regChange(e.cm,e.first,e.first-t,t);for(var n=e.cm.display,i=n.viewFrom;i<n.viewTo;i++)regLineChange(e.cm,i,"gutter")}}function makeChangeSingleDoc(e,t,n,i){if(e.cm&&!e.cm.curOp)return operation(e.cm,makeChangeSingleDoc)(e,t,n,i);if(t.to.line<e.first)return void shiftDoc(e,t.text.length-1-(t.to.line-t.from.line));if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var r=t.text.length-1-(e.first-t.from.line);shiftDoc(e,r),t={from:Pos(e.first,0),to:Pos(t.to.line+r,t.to.ch),text:[lst(t.text)],origin:t.origin}}var o=e.lastLine();t.to.line>o&&(t={from:t.from,to:Pos(o,getLine(e,o).text.length),text:[t.text[0]],origin:t.origin}),t.removed=getBetween(e,t.from,t.to),n||(n=computeSelAfterChange(e,t)),e.cm?makeChangeSingleDocInEditor(e.cm,t,i):updateDoc(e,t,i),setSelectionNoUndo(e,n,L)}}function makeChangeSingleDocInEditor(e,t,n){var i=e.doc,r=e.display,o=t.from,a=t.to,s=!1,l=o.line;e.options.lineWrapping||(l=lineNo(visualLine(getLine(i,o.line))),i.iter(l,a.line+1,function(e){if(e==r.maxLine)return s=!0,!0})),i.sel.contains(t.from,t.to)>-1&&signalCursorActivity(e),updateDoc(i,t,n,estimateHeight(e)),e.options.lineWrapping||(i.iter(l,o.line+t.text.length,function(e){var t=lineLength(e);t>r.maxLineLength&&(r.maxLine=e,r.maxLineLength=t,r.maxLineChanged=!0,s=!1)}),s&&(e.curOp.updateMaxLine=!0)),retreatFrontier(i,o.line),startWorker(e,400);var c=t.text.length-(a.line-o.line)-1;t.full?regChange(e):o.line!=a.line||1!=t.text.length||isWholeLineUpdate(e.doc,t)?regChange(e,o.line,a.line+1,c):regLineChange(e,o.line,"text");var u=hasHandler(e,"changes"),d=hasHandler(e,"change");if(d||u){var h={from:o,to:a,text:t.text,removed:t.removed,origin:t.origin};d&&signalLater(e,"change",e,h),u&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(h)}e.display.selForContextMenu=null}function replaceRange(e,t,n,i,r){if(i||(i=n),cmp(i,n)<0){var o=i;i=n,n=o}"string"==typeof t&&(t=e.splitLines(t)),makeChange(e,{from:n,to:i,text:t,origin:r})}function rebaseHistSelSingle(e,t,n,i){n<e.line?e.line+=i:t<e.line&&(e.line=t,e.ch=0)}function rebaseHistArray(e,t,n,i){for(var r=0;r<e.length;++r){var o=e[r],a=!0;if(o.ranges){o.copied||(o=e[r]=o.deepCopy(),o.copied=!0);for(var s=0;s<o.ranges.length;s++)rebaseHistSelSingle(o.ranges[s].anchor,t,n,i),rebaseHistSelSingle(o.ranges[s].head,t,n,i)}else{for(var l=0;l<o.changes.length;++l){var c=o.changes[l];if(n<c.from.line)c.from=Pos(c.from.line+i,c.from.ch),c.to=Pos(c.to.line+i,c.to.ch);else if(t<=c.to.line){a=!1;break}}a||(e.splice(0,r+1),r=0)}}}function rebaseHist(e,t){var n=t.from.line,i=t.to.line,r=t.text.length-(i-n)-1;rebaseHistArray(e.done,n,i,r),rebaseHistArray(e.undone,n,i,r)}function changeLine(e,t,n,i){var r=t,o=t;return"number"==typeof t?o=getLine(e,clipLine(e,t)):r=lineNo(t),null==r?null:(i(o,r)&&e.cm&&regLineChange(e.cm,r,n),o)}function LeafChunk(e){var t=this;this.lines=e,this.parent=null;for(var n=0,i=0;i<e.length;++i)e[i].parent=t,n+=e[i].height;this.height=n}function BranchChunk(e){var t=this;this.children=e;for(var n=0,i=0,r=0;r<e.length;++r){var o=e[r];n+=o.chunkSize(),i+=o.height,o.parent=t}this.size=n,this.height=i,this.parent=null}function adjustScrollWhenAboveVisible(e,t,n){heightAtLine(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&addToScrollTop(e,n)}function addLineWidget(e,t,n,i){var r=new _e(e,n,i),o=e.cm;return o&&r.noHScroll&&(o.display.alignWidgets=!0),changeLine(e,t,"widget",function(t){var n=t.widgets||(t.widgets=[]);if(null==r.insertAt?n.push(r):n.splice(Math.min(n.length-1,Math.max(0,r.insertAt)),0,r),r.line=t,o&&!lineIsHidden(e,t)){var i=heightAtLine(t)<e.scrollTop;updateLineHeight(t,t.height+widgetHeight(r)),i&&addToScrollTop(o,r.height),o.curOp.forceUpdate=!0}return!0}),signalLater(o,"lineWidgetAdded",o,r,"number"==typeof t?t:lineNo(t)),r}function markText(e,t,n,i,r){if(i&&i.shared)return markTextShared(e,t,n,i,r);if(e.cm&&!e.cm.curOp)return operation(e.cm,markText)(e,t,n,i,r);var o=new xe(e,r),a=cmp(t,n);if(i&&copyObj(i,o,!1),a>0||0==a&&!1!==o.clearWhenEmpty)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=eltP("span",[o.replacedWith],"CodeMirror-widget"),i.handleMouseEvents||o.widgetNode.setAttribute("cm-ignore-events","true"),i.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if(conflictingCollapsedRange(e,t.line,t,n,o)||t.line!=n.line&&conflictingCollapsedRange(e,n.line,t,n,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");seeCollapsedSpans()}o.addToHistory&&addChangeToHistory(e,{from:t,to:n,origin:"markText"},e.sel,NaN);var s,l=t.line,c=e.cm;if(e.iter(l,n.line+1,function(e){c&&o.collapsed&&!c.options.lineWrapping&&visualLine(e)==c.display.maxLine&&(s=!0),o.collapsed&&l!=t.line&&updateLineHeight(e,0),addMarkedSpan(e,new MarkedSpan(o,l==t.line?t.ch:null,l==n.line?n.ch:null)),++l}),o.collapsed&&e.iter(t.line,n.line+1,function(t){lineIsHidden(e,t)&&updateLineHeight(t,0)}),o.clearOnEnter&&U(o,"beforeCursorEnter",function(){return o.clear()}),o.readOnly&&(seeReadOnlySpans(),(e.history.done.length||e.history.undone.length)&&e.clearHistory()),o.collapsed&&(o.id=++ye,o.atomic=!0),c){if(s&&(c.curOp.updateMaxLine=!0),o.collapsed)regChange(c,t.line,n.line+1);else if(o.className||o.title||o.startStyle||o.endStyle||o.css)for(var u=t.line;u<=n.line;u++)regLineChange(c,u,"text");o.atomic&&reCheckSelection(c.doc),signalLater(c,"markerAdded",c,o)}return o}function markTextShared(e,t,n,i,r){i=copyObj(i),i.shared=!1;var o=[markText(e,t,n,i,r)],a=o[0],s=i.widgetNode;return linkedDocs(e,function(e){s&&(i.widgetNode=s.cloneNode(!0)),o.push(markText(e,clipPos(e,t),clipPos(e,n),i,r));for(var l=0;l<e.linked.length;++l)if(e.linked[l].isParent)return;a=lst(o)}),new be(o,a)}function findSharedMarkers(e){return e.findMarks(Pos(e.first,0),e.clipPos(Pos(e.lastLine())),function(e){return e.parent})}function copySharedMarkers(e,t){for(var n=0;n<t.length;n++){var i=t[n],r=i.find(),o=e.clipPos(r.from),a=e.clipPos(r.to);if(cmp(o,a)){var s=markText(e,o,a,i.primary,i.primary.type);i.markers.push(s),s.parent=i}}}function detachSharedMarkers(e){for(var t=0;t<e.length;t++)!function(t){var n=e[t],i=[n.primary.doc];linkedDocs(n.primary.doc,function(e){return i.push(e)});for(var r=0;r<n.markers.length;r++){var o=n.markers[r];-1==indexOf(i,o.doc)&&(o.parent=null,n.markers.splice(r--,1))}}(t)}function onDrop(e){var t=this;if(clearDragCursor(t),!signalDOMEvent(t,e)&&!eventInWidget(t.display,e)){e_preventDefault(e),a&&(Se=+new Date);var n=posFromMouse(t,e,!0),i=e.dataTransfer.files;if(n&&!t.isReadOnly())if(i&&i.length&&window.FileReader&&window.File)for(var r=i.length,o=Array(r),s=0,l=0;l<r;++l)!function(e,i){if(!t.options.allowDropFileTypes||-1!=indexOf(t.options.allowDropFileTypes,e.type)){var a=new FileReader;a.onload=operation(t,function(){var e=a.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(e)&&(e=""),o[i]=e,++s==r){n=clipPos(t.doc,n);var l={from:n,to:n,text:t.doc.splitLines(o.join(t.doc.lineSeparator())),origin:"paste"};makeChange(t.doc,l),setSelectionReplaceHistory(t.doc,simpleSelection(n,changeEnd(l)))}}),a.readAsText(e)}}(i[l],l);else{if(t.state.draggingText&&t.doc.sel.contains(n)>-1)return t.state.draggingText(e),void setTimeout(function(){return t.display.input.focus()},20);try{var c=e.dataTransfer.getData("Text");if(c){var u;if(t.state.draggingText&&!t.state.draggingText.copy&&(u=t.listSelections()),setSelectionNoUndo(t.doc,simpleSelection(n,n)),u)for(var d=0;d<u.length;++d)replaceRange(t.doc,"",u[d].anchor,u[d].head,"drag");t.replaceSelection(c,"around","paste"),t.display.input.focus()}}catch(e){}}}}function onDragStart(e,t){if(a&&(!e.state.draggingText||+new Date-Se<100))return void e_stop(t);if(!signalDOMEvent(e,t)&&!eventInWidget(e.display,t)&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setDragImage&&!h)){var n=elt("img",null,null,"position: fixed; left: 0; top: 0;");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",d&&(n.width=n.height=1,e.display.wrapper.appendChild(n),n._top=n.offsetTop),t.dataTransfer.setDragImage(n,0,0),d&&n.parentNode.removeChild(n)}}function onDragOver(e,t){var n=posFromMouse(e,t);if(n){var i=document.createDocumentFragment();drawSelectionCursor(e,n,i),e.display.dragCursor||(e.display.dragCursor=elt("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),removeChildrenAndAdd(e.display.dragCursor,i)}}function clearDragCursor(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function forEachCodeMirror(e){if(document.getElementsByClassName)for(var t=document.getElementsByClassName("CodeMirror"),n=0;n<t.length;n++){var i=t[n].CodeMirror;i&&e(i)}}function ensureGlobalHandlers(){Te||(registerGlobalHandlers(),Te=!0)}function registerGlobalHandlers(){var e;U(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,forEachCodeMirror(onResize)},100))}),U(window,"blur",function(){return forEachCodeMirror(onBlur)})}function onResize(e){var t=e.display;t.lastWrapHeight==t.wrapper.clientHeight&&t.lastWrapWidth==t.wrapper.clientWidth||(t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize())}function normalizeKeyName(e){var t=e.split(/-(?!$)/);e=t[t.length-1];for(var n,i,r,o,a=0;a<t.length-1;a++){var s=t[a];if(/^(cmd|meta|m)$/i.test(s))o=!0;else if(/^a(lt)?$/i.test(s))n=!0;else if(/^(c|ctrl|control)$/i.test(s))i=!0;else{if(!/^s(hift)?$/i.test(s))throw new Error("Unrecognized modifier name: "+s);r=!0}}return n&&(e="Alt-"+e),i&&(e="Ctrl-"+e),o&&(e="Cmd-"+e),r&&(e="Shift-"+e),e}function normalizeKeyMap(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];if(/^(name|fallthrough|(de|at)tach)$/.test(n))continue;if("..."==i){delete e[n];continue}for(var r=map(n.split(" "),normalizeKeyName),o=0;o<r.length;o++){var a=void 0,s=void 0;o==r.length-1?(s=r.join(" "),a=i):(s=r.slice(0,o+1).join(" "),a="...");var l=t[s];if(l){if(l!=a)throw new Error("Inconsistent bindings for "+s)}else t[s]=a}delete e[n]}for(var c in t)e[c]=t[c];return e}function lookupKey(e,t,n,i){t=getKeyMap(t);var r=t.call?t.call(e,i):t[e];if(!1===r)return"nothing";if("..."===r)return"multi";if(null!=r&&n(r))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return lookupKey(e,t.fallthrough,n,i);for(var o=0;o<t.fallthrough.length;o++){var a=lookupKey(e,t.fallthrough[o],n,i);if(a)return a}}}function isModifierKey(e){var t="string"==typeof e?e:Ae[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t}function addModifierNames(e,t,n){var i=e;return t.altKey&&"Alt"!=i&&(e="Alt-"+e),(C?t.metaKey:t.ctrlKey)&&"Ctrl"!=i&&(e="Ctrl-"+e),(C?t.ctrlKey:t.metaKey)&&"Cmd"!=i&&(e="Cmd-"+e),!n&&t.shiftKey&&"Shift"!=i&&(e="Shift-"+e),e}function keyName(e,t){if(d&&34==e.keyCode&&e.char)return!1;var n=Ae[e.keyCode];return null!=n&&!e.altGraphKey&&addModifierNames(n,e,t)}function getKeyMap(e){return"string"==typeof e?De[e]:e}function deleteNearSelection(e,t){for(var n=e.doc.sel.ranges,i=[],r=0;r<n.length;r++){for(var o=t(n[r]);i.length&&cmp(o.from,lst(i).to)<=0;){var a=i.pop();if(cmp(a.from,o.from)<0){o.from=a.from;break}}i.push(o)}runInOp(e,function(){for(var t=i.length-1;t>=0;t--)replaceRange(e.doc,"",i[t].from,i[t].to,"+delete");ensureCursorVisible(e)})}function lineStart(e,t){var n=getLine(e.doc,t),i=visualLine(n);return i!=n&&(t=lineNo(i)),endOfLine(!0,e,i,t,1)}function lineEnd(e,t){var n=getLine(e.doc,t),i=visualLineEnd(n);return i!=n&&(t=lineNo(i)),endOfLine(!0,e,n,t,-1)}function lineStartSmart(e,t){var n=lineStart(e,t.line),i=getLine(e.doc,n.line),r=getOrder(i,e.doc.direction);if(!r||0==r[0].level){var o=Math.max(0,i.text.search(/\S/)),a=t.line==n.line&&t.ch<=o&&t.ch;return Pos(n.line,a?0:o,n.sticky)}return n}function doHandleBinding(e,t,n){if("string"==typeof t&&!(t=ke[t]))return!1;e.display.input.ensurePolled();var i=e.display.shift,r=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),n&&(e.display.shift=!1),r=t(e)!=k}finally{e.display.shift=i,e.state.suppressEdits=!1}return r}function lookupKeyForEditor(e,t,n){for(var i=0;i<e.state.keyMaps.length;i++){var r=lookupKey(t,e.state.keyMaps[i],n,e);if(r)return r}return e.options.extraKeys&&lookupKey(t,e.options.extraKeys,n,e)||lookupKey(t,e.options.keyMap,n,e)}function dispatchKey(e,t,n,i){var r=e.state.keySeq;if(r){if(isModifierKey(t))return"handled";Le.set(50,function(){e.state.keySeq==r&&(e.state.keySeq=null,e.display.input.reset())}),t=r+" "+t}var o=lookupKeyForEditor(e,t,i);return"multi"==o&&(e.state.keySeq=t),"handled"==o&&signalLater(e,"keyHandled",e,t,n),"handled"!=o&&"multi"!=o||(e_preventDefault(n),restartBlink(e)),r&&!o&&/\'$/.test(t)?(e_preventDefault(n),!0):!!o}function handleKeyBinding(e,t){var n=keyName(t,!0);return!!n&&(t.shiftKey&&!e.state.keySeq?dispatchKey(e,"Shift-"+n,t,function(t){return doHandleBinding(e,t,!0)})||dispatchKey(e,n,t,function(t){if("string"==typeof t?/^go[A-Z]/.test(t):t.motion)return doHandleBinding(e,t)}):dispatchKey(e,n,t,function(t){return doHandleBinding(e,t)}))}function handleCharBinding(e,t,n){return dispatchKey(e,"'"+n+"'",t,function(t){return doHandleBinding(e,t,!0)})}function onKeyDown(e){var t=this;if(t.curOp.focus=activeElt(),!signalDOMEvent(t,e)){a&&s<11&&27==e.keyCode&&(e.returnValue=!1);var n=e.keyCode;t.display.shift=16==n||e.shiftKey;var i=handleKeyBinding(t,e);d&&(Ne=i?n:null,!i&&88==n&&!j&&(_?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),18!=n||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||showCrossHair(t)}}function showCrossHair(e){function up(e){18!=e.keyCode&&e.altKey||(T(t,"CodeMirror-crosshair"),off(document,"keyup",up),off(document,"mouseover",up))}var t=e.display.lineDiv;addClass(t,"CodeMirror-crosshair"),U(document,"keyup",up),U(document,"mouseover",up)}function onKeyUp(e){16==e.keyCode&&(this.doc.sel.shift=!1),signalDOMEvent(this,e)}function onKeyPress(e){var t=this;if(!(eventInWidget(t.display,e)||signalDOMEvent(t,e)||e.ctrlKey&&!e.altKey||_&&e.metaKey)){var n=e.keyCode,i=e.charCode;if(d&&n==Ne)return Ne=null,void e_preventDefault(e);if(!d||e.which&&!(e.which<10)||!handleKeyBinding(t,e)){var r=String.fromCharCode(null==i?n:i);"\b"!=r&&(handleCharBinding(t,e,r)||t.display.input.onKeyPress(e))}}}function clickRepeat(e,t){var n=+new Date;return Re&&Re.compare(n,e,t)?(Oe=Re=null,"triple"):Oe&&Oe.compare(n,e,t)?(Re=new Pe(n,e,t),Oe=null,"double"):(Oe=new Pe(n,e,t),Re=null,"single")}function onMouseDown(e){var t=this,n=t.display;if(!(signalDOMEvent(t,e)||n.activeTouch&&n.input.supportsTouch())){if(n.input.ensurePolled(),n.shift=e.shiftKey,eventInWidget(n,e))return void(l||(n.scroller.draggable=!1,setTimeout(function(){return n.scroller.draggable=!0},100)));if(!clickInGutter(t,e)){var i=posFromMouse(t,e),r=e_button(e),o=i?clickRepeat(i,r):"single";window.focus(),1==r&&t.state.selectingText&&t.state.selectingText(e),i&&handleMappedButton(t,r,i,o,e)||(1==r?i?leftButtonDown(t,i,o,e):e_target(e)==n.scroller&&e_preventDefault(e):2==r?(i&&extendSelection(t.doc,i),setTimeout(function(){return n.input.focus()},20)):3==r&&(S?onContextMenu(t,e):delayBlurEvent(t)))}}}function handleMappedButton(e,t,n,i,r){var o="Click";return"double"==i?o="Double"+o:"triple"==i&&(o="Triple"+o),o=(1==t?"Left":2==t?"Middle":"Right")+o,dispatchKey(e,addModifierNames(o,r),r,function(t){if("string"==typeof t&&(t=ke[t]),!t)return!1;var i=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),i=t(e,n)!=k}finally{e.state.suppressEdits=!1}return i})}function configureMouse(e,t,n){var i=e.getOption("configureMouse"),r=i?i(e,t,n):{};if(null==r.unit){var o=y?n.shiftKey&&n.metaKey:n.altKey;r.unit=o?"rectangle":"single"==t?"char":"double"==t?"word":"line"}return(null==r.extend||e.doc.extend)&&(r.extend=e.doc.extend||n.shiftKey),null==r.addNew&&(r.addNew=_?n.metaKey:n.ctrlKey),null==r.moveOnDrag&&(r.moveOnDrag=!(_?n.altKey:n.ctrlKey)),r}function leftButtonDown(e,t,n,i){a?setTimeout(bind(ensureFocus,e),0):e.curOp.focus=activeElt();var r,o=configureMouse(e,n,i),s=e.doc.sel;e.options.dragDrop&&$&&!e.isReadOnly()&&"single"==n&&(r=s.contains(t))>-1&&(cmp((r=s.ranges[r]).from(),t)<0||t.xRel>0)&&(cmp(r.to(),t)>0||t.xRel<0)?leftButtonStartDrag(e,i,t,o):leftButtonSelect(e,i,t,o)}function leftButtonStartDrag(e,t,n,i){var r=e.display,o=!1,c=operation(e,function(t){l&&(r.scroller.draggable=!1),e.state.draggingText=!1,off(document,"mouseup",c),off(document,"mousemove",u),off(r.scroller,"dragstart",d),off(r.scroller,"drop",c),o||(e_preventDefault(t),i.addNew||extendSelection(e.doc,n,null,null,i.extend),l||a&&9==s?setTimeout(function(){document.body.focus(),r.input.focus()},20):r.input.focus())}),u=function(e){o=o||Math.abs(t.clientX-e.clientX)+Math.abs(t.clientY-e.clientY)>=10},d=function(){return o=!0};l&&(r.scroller.draggable=!0),e.state.draggingText=c,c.copy=!i.moveOnDrag,r.scroller.dragDrop&&r.scroller.dragDrop(),U(document,"mouseup",c),U(document,"mousemove",u),U(r.scroller,"dragstart",d),U(r.scroller,"drop",c),delayBlurEvent(e),setTimeout(function(){return r.input.focus()},20)}function rangeForUnit(e,t,n){if("char"==n)return new ve(t,t);if("word"==n)return e.findWordAt(t);if("line"==n)return new ve(Pos(t.line,0),clipPos(e.doc,Pos(t.line+1,0)));var i=n(e,t);return new ve(i.from,i.to)}function leftButtonSelect(e,t,n,i){function extendTo(t){if(0!=cmp(d,t))if(d=t,"rectangle"==i.unit){for(var r=[],c=e.options.tabSize,u=countColumn(getLine(o,n.line).text,n.ch,c),h=countColumn(getLine(o,t.line).text,t.ch,c),p=Math.min(u,h),f=Math.max(u,h),g=Math.min(n.line,t.line),m=Math.min(e.lastLine(),Math.max(n.line,t.line));g<=m;g++){var v=getLine(o,g).text,_=findColumn(v,p,c);p==f?r.push(new ve(Pos(g,_),Pos(g,_))):v.length>_&&r.push(new ve(Pos(g,_),Pos(g,findColumn(v,f,c))))}r.length||r.push(new ve(n,n)),setSelection(o,normalizeSelection(l.ranges.slice(0,s).concat(r),s),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var y,x=a,b=rangeForUnit(e,t,i.unit),w=x.anchor;cmp(b.anchor,w)>0?(y=b.head,w=minPos(x.from(),b.anchor)):(y=b.anchor,w=maxPos(x.to(),b.head));var C=l.ranges.slice(0);C[s]=new ve(clipPos(o,w),y),setSelection(o,normalizeSelection(C,s),N)}}function extend(t){var n=++p,a=posFromMouse(e,t,!0,"rectangle"==i.unit);if(a)if(0!=cmp(a,d)){e.curOp.focus=activeElt(),extendTo(a);var s=visibleLines(r,o);(a.line>=s.to||a.line<s.from)&&setTimeout(operation(e,function(){p==n&&extend(t)}),150)}else{var l=t.clientY<h.top?-20:t.clientY>h.bottom?20:0;l&&setTimeout(operation(e,function(){p==n&&(r.scroller.scrollTop+=l,extend(t))}),50)}}function done(t){e.state.selectingText=!1,p=1/0,e_preventDefault(t),r.input.focus(),off(document,"mousemove",f),off(document,"mouseup",g),o.history.lastSelOrigin=null}var r=e.display,o=e.doc;e_preventDefault(t);var a,s,l=o.sel,c=l.ranges;if(i.addNew&&!i.extend?(s=o.sel.contains(n),a=s>-1?c[s]:new ve(n,n)):(a=o.sel.primary(),s=o.sel.primIndex),"rectangle"==i.unit)i.addNew||(a=new ve(n,n)),n=posFromMouse(e,t,!0,!0),s=-1;else{var u=rangeForUnit(e,n,i.unit);a=i.extend?extendRange(a,u.anchor,u.head,i.extend):u}i.addNew?-1==s?(s=c.length,setSelection(o,normalizeSelection(c.concat([a]),s),{scroll:!1,origin:"*mouse"})):c.length>1&&c[s].empty()&&"char"==i.unit&&!i.extend?(setSelection(o,normalizeSelection(c.slice(0,s).concat(c.slice(s+1)),0),{scroll:!1,origin:"*mouse"}),l=o.sel):replaceOneSelection(o,s,a,N):(s=0,setSelection(o,new me([a],0),N),l=o.sel);var d=n,h=r.wrapper.getBoundingClientRect(),p=0,f=operation(e,function(e){e_button(e)?extend(e):done(e)}),g=operation(e,done);e.state.selectingText=g,U(document,"mousemove",f),U(document,"mouseup",g)}function gutterEvent(e,t,n,i){var r,o;try{r=t.clientX,o=t.clientY}catch(t){return!1}if(r>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;i&&e_preventDefault(t);var a=e.display,s=a.lineDiv.getBoundingClientRect();if(o>s.bottom||!hasHandler(e,n))return e_defaultPrevented(t);o-=s.top-a.viewOffset;for(var l=0;l<e.options.gutters.length;++l){var c=a.gutters.childNodes[l];if(c&&c.getBoundingClientRect().right>=r){return signal(e,n,e,lineAtHeight(e.doc,o),e.options.gutters[l],t),e_defaultPrevented(t)}}}function clickInGutter(e,t){return gutterEvent(e,t,"gutterClick",!0)}function onContextMenu(e,t){eventInWidget(e.display,t)||contextMenuInGutter(e,t)||signalDOMEvent(e,t,"contextmenu")||e.display.input.onContextMenu(t)}function contextMenuInGutter(e,t){return!!hasHandler(e,"gutterContextMenu")&&gutterEvent(e,t,"gutterContextMenu",!1)}function themeChanged(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),clearCaches(e)}function guttersChanged(e){updateGutters(e),regChange(e),alignHorizontally(e)}function dragDropChanged(e,t,n){if(!t!=!(n&&n!=ze)){var i=e.display.dragFunctions,r=t?U:off;r(e.display.scroller,"dragstart",i.start),r(e.display.scroller,"dragenter",i.enter),r(e.display.scroller,"dragover",i.over),r(e.display.scroller,"dragleave",i.leave),r(e.display.scroller,"drop",i.drop)}}function wrappingChanged(e){e.options.lineWrapping?(addClass(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(T(e.display.wrapper,"CodeMirror-wrap"),findMaxLine(e)),estimateLineHeights(e),regChange(e),clearCaches(e),setTimeout(function(){return updateScrollbars(e)},100)}function CodeMirror$1(e,t){var n=this;if(!(this instanceof CodeMirror$1))return new CodeMirror$1(e,t);this.options=t=t?copyObj(t):{},copyObj(Fe,t,!1),setGuttersForLineNumbers(t);var i=t.value;"string"==typeof i&&(i=new Ce(i,t.mode,null,t.lineSeparator,t.direction)),this.doc=i;var r=new CodeMirror$1.inputStyles[t.inputStyle](this),o=this.display=new Display(e,i,r);o.wrapper.CodeMirror=this,updateGutters(this),themeChanged(this),t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),initScrollbars(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new M,keySeq:null,specialChars:null},t.autofocus&&!v&&o.input.focus(),a&&s<11&&setTimeout(function(){return n.display.input.reset(!0)},20),registerEventHandlers(this),ensureGlobalHandlers(),startOperation(this),this.curOp.forceUpdate=!0,attachDoc(this,i),t.autofocus&&!v||this.hasFocus()?setTimeout(bind(onFocus,this),20):onBlur(this);for(var c in Be)Be.hasOwnProperty(c)&&Be[c](n,t[c],ze);maybeUpdateLineNumberWidth(this),t.finishInit&&t.finishInit(this);for(var u=0;u<He.length;++u)He[u](n);endOperation(this),l&&t.lineWrapping&&"optimizelegibility"==getComputedStyle(o.lineDiv).textRendering&&(o.lineDiv.style.textRendering="auto")}function registerEventHandlers(e){function finishTouch(){t.activeTouch&&(n=setTimeout(function(){return t.activeTouch=null},1e3),i=t.activeTouch,i.end=+new Date)}function isMouseLikeTouchEvent(e){if(1!=e.touches.length)return!1;var t=e.touches[0];return t.radiusX<=1&&t.radiusY<=1}function farAway(e,t){if(null==t.left)return!0;var n=t.left-e.left,i=t.top-e.top;return n*n+i*i>400}var t=e.display;U(t.scroller,"mousedown",operation(e,onMouseDown)),a&&s<11?U(t.scroller,"dblclick",operation(e,function(t){if(!signalDOMEvent(e,t)){var n=posFromMouse(e,t);if(n&&!clickInGutter(e,t)&&!eventInWidget(e.display,t)){e_preventDefault(t);var i=e.findWordAt(n);extendSelection(e.doc,i.anchor,i.head)}}})):U(t.scroller,"dblclick",function(t){return signalDOMEvent(e,t)||e_preventDefault(t)}),S||U(t.scroller,"contextmenu",function(t){return onContextMenu(e,t)});var n,i={end:0};U(t.scroller,"touchstart",function(r){if(!signalDOMEvent(e,r)&&!isMouseLikeTouchEvent(r)){t.input.ensurePolled(),clearTimeout(n);var o=+new Date;t.activeTouch={start:o,moved:!1,prev:o-i.end<=300?i:null},1==r.touches.length&&(t.activeTouch.left=r.touches[0].pageX,t.activeTouch.top=r.touches[0].pageY)}}),U(t.scroller,"touchmove",function(){t.activeTouch&&(t.activeTouch.moved=!0)}),U(t.scroller,"touchend",function(n){var i=t.activeTouch;if(i&&!eventInWidget(t,n)&&null!=i.left&&!i.moved&&new Date-i.start<300){var r,o=e.coordsChar(t.activeTouch,"page");r=!i.prev||farAway(i,i.prev)?new ve(o,o):!i.prev.prev||farAway(i,i.prev.prev)?e.findWordAt(o):new ve(Pos(o.line,0),clipPos(e.doc,Pos(o.line+1,0))),e.setSelection(r.anchor,r.head),e.focus(),e_preventDefault(n)}finishTouch()}),U(t.scroller,"touchcancel",finishTouch),U(t.scroller,"scroll",function(){t.scroller.clientHeight&&(updateScrollTop(e,t.scroller.scrollTop),setScrollLeft(e,t.scroller.scrollLeft,!0),signal(e,"scroll",e))}),U(t.scroller,"mousewheel",function(t){return onScrollWheel(e,t)}),U(t.scroller,"DOMMouseScroll",function(t){return onScrollWheel(e,t)}),U(t.wrapper,"scroll",function(){return t.wrapper.scrollTop=t.wrapper.scrollLeft=0}),t.dragFunctions={enter:function(t){signalDOMEvent(e,t)||e_stop(t)},over:function(t){signalDOMEvent(e,t)||(onDragOver(e,t),e_stop(t))},start:function(t){return onDragStart(e,t)},drop:operation(e,onDrop),leave:function(t){signalDOMEvent(e,t)||clearDragCursor(e)}};var r=t.input.getField();U(r,"keyup",function(t){return onKeyUp.call(e,t)}),U(r,"keydown",operation(e,onKeyDown)),U(r,"keypress",operation(e,onKeyPress)),U(r,"focus",function(t){return onFocus(e,t)}),U(r,"blur",function(t){return onBlur(e,t)})}function indentLine(e,t,n,i){var r,o=e.doc;null==n&&(n="add"),"smart"==n&&(o.mode.indent?r=getContextBefore(e,t).state:n="prev");var a=e.options.tabSize,s=getLine(o,t),l=countColumn(s.text,null,a);s.stateAfter&&(s.stateAfter=null);var c,u=s.text.match(/^\s*/)[0];if(i||/\S/.test(s.text)){if("smart"==n&&((c=o.mode.indent(r,s.text.slice(u.length),s.text))==k||c>150)){if(!i)return;n="prev"}}else c=0,n="not";"prev"==n?c=t>o.first?countColumn(getLine(o,t-1).text,null,a):0:"add"==n?c=l+e.options.indentUnit:"subtract"==n?c=l-e.options.indentUnit:"number"==typeof n&&(c=l+n),c=Math.max(0,c);var d="",h=0;if(e.options.indentWithTabs)for(var p=Math.floor(c/a);p;--p)h+=a,d+="\t";if(h<c&&(d+=spaceStr(c-h)),d!=u)return replaceRange(o,d,Pos(t,0),Pos(t,u.length),"+input"),s.stateAfter=null,!0;for(var f=0;f<o.sel.ranges.length;f++){var g=o.sel.ranges[f];if(g.head.line==t&&g.head.ch<u.length){var m=Pos(t,u.length);replaceOneSelection(o,f,new ve(m,m));break}}}function setLastCopied(e){Ve=e}function applyTextInput(e,t,n,i,r){var o=e.doc;e.display.shift=!1,i||(i=o.sel);var a=e.state.pasteIncoming||"paste"==r,s=G(t),l=null;if(a&&i.ranges.length>1)if(Ve&&Ve.text.join("\n")==t){if(i.ranges.length%Ve.text.length==0){l=[];for(var c=0;c<Ve.text.length;c++)l.push(o.splitLines(Ve.text[c]))}}else s.length==i.ranges.length&&e.options.pasteLinesPerSelection&&(l=map(s,function(e){return[e]}));for(var u,d=i.ranges.length-1;d>=0;d--){var h=i.ranges[d],p=h.from(),f=h.to();h.empty()&&(n&&n>0?p=Pos(p.line,p.ch-n):e.state.overwrite&&!a?f=Pos(f.line,Math.min(getLine(o,f.line).text.length,f.ch+lst(s).length)):Ve&&Ve.lineWise&&Ve.text.join("\n")==t&&(p=f=Pos(p.line,0))),u=e.curOp.updateInput;var g={from:p,to:f,text:l?l[d%l.length]:s,origin:r||(a?"paste":e.state.cutIncoming?"cut":"+input")};makeChange(e.doc,g),signalLater(e,"inputRead",e,g)}t&&!a&&triggerElectric(e,t),ensureCursorVisible(e),e.curOp.updateInput=u,e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=!1}function handlePaste(e,t){var n=e.clipboardData&&e.clipboardData.getData("Text");if(n)return e.preventDefault(),t.isReadOnly()||t.options.disableInput||runInOp(t,function(){return applyTextInput(t,n,0,null,"paste")}),!0}function triggerElectric(e,t){if(e.options.electricChars&&e.options.smartIndent)for(var n=e.doc.sel,i=n.ranges.length-1;i>=0;i--){var r=n.ranges[i];if(!(r.head.ch>100||i&&n.ranges[i-1].head.line==r.head.line)){var o=e.getModeAt(r.head),a=!1;if(o.electricChars){for(var s=0;s<o.electricChars.length;s++)if(t.indexOf(o.electricChars.charAt(s))>-1){a=indentLine(e,r.head.line,"smart");break}}else o.electricInput&&o.electricInput.test(getLine(e.doc,r.head.line).text.slice(0,r.head.ch))&&(a=indentLine(e,r.head.line,"smart"));a&&signalLater(e,"electricInput",e,r.head.line)}}}function copyableRanges(e){for(var t=[],n=[],i=0;i<e.doc.sel.ranges.length;i++){var r=e.doc.sel.ranges[i].head.line,o={anchor:Pos(r,0),head:Pos(r+1,0)};n.push(o),t.push(e.getRange(o.anchor,o.head))}return{text:t,ranges:n}}function disableBrowserMagic(e,t){e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("spellcheck",!!t)}function hiddenTextarea(){var e=elt("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),t=elt("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return l?e.style.width="1000px":e.setAttribute("wrap","off"),g&&(e.style.border="1px solid black"),disableBrowserMagic(e),t}function findPosH(e,t,n,i,r){function findNextLine(){var i=t.line+n;return!(i<e.first||i>=e.first+e.size)&&(t=new Pos(i,t.ch,t.sticky),s=getLine(e,i))}function moveOnce(i){var o;if(null==(o=r?moveVisually(e.cm,s,t,n):moveLogically(s,t,n))){if(i||!findNextLine())return!1;t=endOfLine(r,e.cm,s,t.line,n)}else t=o;return!0}var o=t,a=n,s=getLine(e,t.line);if("char"==i)moveOnce();else if("column"==i)moveOnce(!0);else if("word"==i||"group"==i)for(var l=null,c="group"==i,u=e.cm&&e.cm.getHelper(t,"wordChars"),d=!0;!(n<0)||moveOnce(!d);d=!1){var h=s.text.charAt(t.ch)||"\n",p=isWordChar(h,u)?"w":c&&"\n"==h?"n":!c||/\s/.test(h)?null:"p";if(!c||d||p||(p="s"),l&&l!=p){n<0&&(n=1,moveOnce(),t.sticky="after");break}if(p&&(l=p),n>0&&!moveOnce(!d))break}var f=skipAtomic(e,t,o,a,!0);return equalCursorPos(o,f)&&(f.hitSide=!0),f}function findPosV(e,t,n,i){var r,o=e.doc,a=t.left;if("page"==i){var s=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),l=Math.max(s-.5*textHeight(e.display),3);r=(n>0?t.bottom:t.top)+n*l}else"line"==i&&(r=n>0?t.bottom+3:t.top-3);for(var c;c=coordsChar(e,a,r),c.outside;){if(n<0?r<=0:r>=o.height){c.hitSide=!0;break}r+=5*n}return c}function posToDOM(e,t){var n=findViewForLine(e,t.line);if(!n||n.hidden)return null;var i=getLine(e.doc,t.line),r=mapFromLineView(n,i,t.line),o=getOrder(i,e.doc.direction),a="left";if(o){a=getBidiPartAt(o,t.ch)%2?"right":"left"}var s=nodeAndOffsetInLineMap(r.map,t.ch,a);return s.offset="right"==s.collapse?s.end:s.start,s}function isInGutter(e){for(var t=e;t;t=t.parentNode)if(/CodeMirror-gutter-wrapper/.test(t.className))return!0;return!1}function badPos(e,t){return t&&(e.bad=!0),e}function domTextBetween(e,t,n,i,r){function recognizeMarker(e){return function(t){return t.id==e}}function close(){a&&(o+=s,a=!1)}function addText(e){e&&(close(),o+=e)}function walk(t){if(1==t.nodeType){var n=t.getAttribute("cm-text");if(null!=n)return void addText(n||t.textContent.replace(/\u200b/g,""));var o,l=t.getAttribute("cm-marker");if(l){var c=e.findMarks(Pos(i,0),Pos(r+1,0),recognizeMarker(+l));return void(c.length&&(o=c[0].find(0))&&addText(getBetween(e.doc,o.from,o.to).join(s)))}if("false"==t.getAttribute("contenteditable"))return;var u=/^(pre|div|p)$/i.test(t.nodeName);u&&close();for(var d=0;d<t.childNodes.length;d++)walk(t.childNodes[d]);u&&(a=!0)}else 3==t.nodeType&&addText(t.nodeValue)}for(var o="",a=!1,s=e.doc.lineSeparator();walk(t),t!=n;)t=t.nextSibling;return o}function domToPos(e,t,n){var i;if(t==e.display.lineDiv){if(!(i=e.display.lineDiv.childNodes[n]))return badPos(e.clipPos(Pos(e.display.viewTo-1)),!0);t=null,n=0}else for(i=t;;i=i.parentNode){if(!i||i==e.display.lineDiv)return null;if(i.parentNode&&i.parentNode==e.display.lineDiv)break}for(var r=0;r<e.display.view.length;r++){var o=e.display.view[r];if(o.node==i)return locateNodeInLineView(o,t,n)}}function locateNodeInLineView(e,t,n){function find(t,n,i){for(var r=-1;r<(c?c.length:0);r++)for(var o=r<0?l.map:c[r],a=0;a<o.length;a+=3){var s=o[a+2];if(s==t||s==n){var u=lineNo(r<0?e.line:e.rest[r]),d=o[a]+i;return(i<0||s!=t)&&(d=o[a+(i?1:0)]),Pos(u,d)}}}var i=e.text.firstChild,r=!1;if(!t||!contains(i,t))return badPos(Pos(lineNo(e.line),0),!0);if(t==i&&(r=!0,t=i.childNodes[n],n=0,!t)){var o=e.rest?lst(e.rest):e.line;return badPos(Pos(lineNo(o),o.text.length),r)}var a=3==t.nodeType?t:null,s=t;for(a||1!=t.childNodes.length||3!=t.firstChild.nodeType||(a=t.firstChild,n&&(n=a.nodeValue.length));s.parentNode!=i;)s=s.parentNode;var l=e.measure,c=l.maps,u=find(a,s,n);if(u)return badPos(u,r);for(var d=s.nextSibling,h=a?a.nodeValue.length-n:0;d;d=d.nextSibling){if(u=find(d,d.firstChild,0))return badPos(Pos(u.line,u.ch-h),r);h+=d.textContent.length}for(var p=s.previousSibling,f=n;p;p=p.previousSibling){if(u=find(p,p.firstChild,-1))return badPos(Pos(u.line,u.ch+f),r);f+=p.textContent.length}}function fromTextArea(e,t){function save(){e.value=a.getValue()}if(t=t?copyObj(t):{},t.value=e.value,!t.tabindex&&e.tabIndex&&(t.tabindex=e.tabIndex),!t.placeholder&&e.placeholder&&(t.placeholder=e.placeholder),null==t.autofocus){var n=activeElt();t.autofocus=n==e||null!=e.getAttribute("autofocus")&&n==document.body}var i;if(e.form&&(U(e.form,"submit",save),!t.leaveSubmitMethodAlone)){var r=e.form;i=r.submit;try{var o=r.submit=function(){save(),r.submit=i,r.submit(),r.submit=o}}catch(e){}}t.finishInit=function(t){t.save=save,t.getTextArea=function(){return e},t.toTextArea=function(){t.toTextArea=isNaN,save(),e.parentNode.removeChild(t.getWrapperElement()),e.style.display="",e.form&&(off(e.form,"submit",save),"function"==typeof e.form.submit&&(e.form.submit=i))}},e.style.display="none";var a=CodeMirror$1(function(t){return e.parentNode.insertBefore(t,e.nextSibling)},t);return a}var e=navigator.userAgent,t=navigator.platform,n=/gecko\/\d/i.test(e),i=/MSIE \d/.test(e),r=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(e),o=/Edge\/(\d+)/.exec(e),a=i||r||o,s=a&&(i?document.documentMode||6:+(o||r)[1]),l=!o&&/WebKit\//.test(e),c=l&&/Qt\/\d+\.\d+/.test(e),u=!o&&/Chrome\//.test(e),d=/Opera\//.test(e),h=/Apple Computer/.test(navigator.vendor),p=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(e),f=/PhantomJS/.test(e),g=!o&&/AppleWebKit/.test(e)&&/Mobile\/\w+/.test(e),m=/Android/.test(e),v=g||m||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(e),_=g||/Mac/.test(t),y=/\bCrOS\b/.test(e),x=/win/i.test(t),b=d&&e.match(/Version\/(\d*\.\d*)/);b&&(b=Number(b[1])),b&&b>=15&&(d=!1,l=!0);var w,C=_&&(c||d&&(null==b||b<12.11)),S=n||a&&s>=9,T=function(e,t){var n=e.className,i=classTest(t).exec(n);if(i){var r=n.slice(i.index+i[0].length);e.className=n.slice(0,i.index)+(r?i[1]+r:"")}};w=document.createRange?function(e,t,n,i){var r=document.createRange();return r.setEnd(i||e,n),r.setStart(e,t),r}:function(e,t,n){var i=document.body.createTextRange();try{i.moveToElementText(e.parentNode)}catch(e){return i}return i.collapse(!0),i.moveEnd("character",n),i.moveStart("character",t),i};var A=function(e){e.select()};g?A=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:a&&(A=function(e){try{e.select()}catch(e){}});var M=function(){this.id=null};M.prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)};var E,I,D=30,k={toString:function(){return"CodeMirror.Pass"}},L={scroll:!1},N={origin:"*mouse"},P={origin:"+move"},O=[""],R=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,z=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/,F=!1,B=!1,H=null,V=function(){function charType(n){return n<=247?e.charAt(n):1424<=n&&n<=1524?"R":1536<=n&&n<=1785?t.charAt(n-1536):1774<=n&&n<=2220?"r":8192<=n&&n<=8203?"w":8204==n?"b":"L"}function BidiSpan(e,t,n){this.level=e,this.from=t,this.to=n}var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",t="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111",n=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,i=/[stwN]/,r=/[LRr]/,o=/[Lb1n]/,a=/[1n]/;return function(e,t){var s="ltr"==t?"L":"R";if(0==e.length||"ltr"==t&&!n.test(e))return!1;for(var l=e.length,c=[],u=0;u<l;++u)c.push(charType(e.charCodeAt(u)));for(var d=0,h=s;d<l;++d){var p=c[d];"m"==p?c[d]=h:h=p}for(var f=0,g=s;f<l;++f){var m=c[f];"1"==m&&"r"==g?c[f]="n":r.test(m)&&(g=m,"r"==m&&(c[f]="R"))}for(var v=1,_=c[0];v<l-1;++v){var y=c[v];"+"==y&&"1"==_&&"1"==c[v+1]?c[v]="1":","!=y||_!=c[v+1]||"1"!=_&&"n"!=_||(c[v]=_),_=y}for(var x=0;x<l;++x){var b=c[x];if(","==b)c[x]="N";else if("%"==b){var w=void 0;for(w=x+1;w<l&&"%"==c[w];++w);for(var C=x&&"!"==c[x-1]||w<l&&"1"==c[w]?"1":"N",S=x;S<w;++S)c[S]=C;x=w-1}}for(var T=0,A=s;T<l;++T){var M=c[T];"L"==A&&"1"==M?c[T]="L":r.test(M)&&(A=M)}for(var E=0;E<l;++E)if(i.test(c[E])){var I=void 0;for(I=E+1;I<l&&i.test(c[I]);++I);for(var D="L"==(E?c[E-1]:s),k="L"==(I<l?c[I]:s),L=D==k?D?"L":"R":s,N=E;N<I;++N)c[N]=L;E=I-1}for(var P,O=[],R=0;R<l;)if(o.test(c[R])){var z=R;for(++R;R<l&&o.test(c[R]);++R);O.push(new BidiSpan(0,z,R))}else{var F=R,B=O.length;for(++R;R<l&&"L"!=c[R];++R);for(var H=F;H<R;)if(a.test(c[H])){F<H&&O.splice(B,0,new BidiSpan(1,F,H));var V=H;for(++H;H<R&&a.test(c[H]);++H);O.splice(B,0,new BidiSpan(2,V,H)),F=H}else++H;F<R&&O.splice(B,0,new BidiSpan(1,F,R))}return 1==O[0].level&&(P=e.match(/^\s+/))&&(O[0].from=P[0].length,O.unshift(new BidiSpan(0,0,P[0].length))),1==lst(O).level&&(P=e.match(/\s+$/))&&(lst(O).to-=P[0].length,O.push(new BidiSpan(0,l-P[0].length,l))),"rtl"==t?O.reverse():O}}(),W=[],U=function(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent)e.attachEvent("on"+t,n);else{var i=e._handlers||(e._handlers={});i[t]=(i[t]||W).concat(n)}},$=function(){if(a&&s<9)return!1;var e=elt("div");return"draggable"in e||"dragDrop"in e}(),G=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,n=[],i=e.length;t<=i;){var r=e.indexOf("\n",t);-1==r&&(r=e.length);var o=e.slice(t,"\r"==e.charAt(r-1)?r-1:r),a=o.indexOf("\r");-1!=a?(n.push(o.slice(0,a)),t+=a+1):(n.push(o),t=r+1)}return n}:function(e){return e.split(/\r\n?|\n/)},q=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(e){return!1}}:function(e){var t;try{t=e.ownerDocument.selection.createRange()}catch(e){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)},j=function(){var e=elt("div");return"oncopy"in e||(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),Y=null,X={},Z={},K={},J=function(e,t,n){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=n};J.prototype.eol=function(){return this.pos>=this.string.length},J.prototype.sol=function(){return this.pos==this.lineStart},J.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},J.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},J.prototype.eat=function(e){var t=this.string.charAt(this.pos);if("string"==typeof e?t==e:t&&(e.test?e.test(t):e(t)))return++this.pos,t},J.prototype.eatWhile=function(e){for(var t=this.pos;this.eat(e););return this.pos>t},J.prototype.eatSpace=function(){for(var e=this,t=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++e.pos;return this.pos>t},J.prototype.skipToEnd=function(){this.pos=this.string.length},J.prototype.skipTo=function(e){var t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0},J.prototype.backUp=function(e){this.pos-=e},J.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)},J.prototype.indentation=function(){return countColumn(this.string,null,this.tabSize)-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)},J.prototype.match=function(e,t,n){if("string"!=typeof e){var i=this.string.slice(this.pos).match(e);return i&&i.index>0?null:(i&&!1!==t&&(this.pos+=i[0].length),i)}var r=function(e){return n?e.toLowerCase():e};if(r(this.string.substr(this.pos,e.length))==r(e))return!1!==t&&(this.pos+=e.length),!0},J.prototype.current=function(){return this.string.slice(this.start,this.pos)},J.prototype.hideFirstChars=function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}},J.prototype.lookAhead=function(e){var t=this.lineOracle;return t&&t.lookAhead(e)};var Q=function(e,t){this.state=e,this.lookAhead=t},ee=function(e,t,n,i){this.state=t,this.doc=e,this.line=n,this.maxLookAhead=i||0};ee.prototype.lookAhead=function(e){var t=this.doc.getLine(this.line+e);return null!=t&&e>this.maxLookAhead&&(this.maxLookAhead=e),t},ee.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},ee.fromSaved=function(e,t,n){return t instanceof Q?new ee(e,copyState(e.mode,t.state),n,t.lookAhead):new ee(e,copyState(e.mode,t),n)},ee.prototype.save=function(e){var t=!1!==e?copyState(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new Q(t,this.maxLookAhead):t};var te=function(e,t,n){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=t||null,this.state=n},ne=function(e,t,n){this.text=e,attachMarkedSpans(this,t),this.height=n?n(this):1};ne.prototype.lineNo=function(){return lineNo(this)},eventMixin(ne);var ie,re={},oe={},ae=null,se=null,le={left:0,right:0,top:0,bottom:0},ce=function(e,t,n){this.cm=n;var i=this.vert=elt("div",[elt("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),r=this.horiz=elt("div",[elt("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");e(i),e(r),U(i,"scroll",function(){i.clientHeight&&t(i.scrollTop,"vertical")}),U(r,"scroll",function(){r.clientWidth&&t(r.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,a&&s<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};ce.prototype.update=function(e){var t=e.scrollWidth>e.clientWidth+1,n=e.scrollHeight>e.clientHeight+1,i=e.nativeBarWidth;if(n){this.vert.style.display="block",this.vert.style.bottom=t?i+"px":"0";var r=e.viewHeight-(t?i:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+r)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=n?i+"px":"0",this.horiz.style.left=e.barLeft+"px";var o=e.viewWidth-e.barLeft-(n?i:0);this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+o)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(0==i&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:n?i:0,bottom:t?i:0}},ce.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},ce.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},ce.prototype.zeroWidthHack=function(){var e=_&&!p?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new M,this.disableVert=new M},ce.prototype.enableZeroWidthBar=function(e,t,n){function maybeDisable(){var i=e.getBoundingClientRect();("vert"==n?document.elementFromPoint(i.right-1,(i.top+i.bottom)/2):document.elementFromPoint((i.right+i.left)/2,i.bottom-1))!=e?e.style.pointerEvents="none":t.set(1e3,maybeDisable)}e.style.pointerEvents="auto",t.set(1e3,maybeDisable)},ce.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)};var ue=function(){};ue.prototype.update=function(){return{bottom:0,right:0}},ue.prototype.setScrollLeft=function(){},ue.prototype.setScrollTop=function(){},ue.prototype.clear=function(){};var de={native:ce,null:ue},he=0,pe=function(e,t,n){var i=e.display;this.viewport=t,this.visible=visibleLines(i,e.doc,t),this.editorIsHidden=!i.wrapper.offsetWidth,this.wrapperHeight=i.wrapper.clientHeight,this.wrapperWidth=i.wrapper.clientWidth,this.oldDisplayWidth=displayWidth(e),this.force=n,this.dims=getDimensions(e),this.events=[]};pe.prototype.signal=function(e,t){hasHandler(e,t)&&this.events.push(arguments)},pe.prototype.finish=function(){for(var e=this,t=0;t<this.events.length;t++)signal.apply(null,e.events[t])};var fe=0,ge=null;a?ge=-.53:n?ge=15:u?ge=-.7:h&&(ge=-1/3);var me=function(e,t){this.ranges=e,this.primIndex=t};me.prototype.primary=function(){return this.ranges[this.primIndex]},me.prototype.equals=function(e){var t=this;if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var n=0;n<this.ranges.length;n++){var i=t.ranges[n],r=e.ranges[n];if(!equalCursorPos(i.anchor,r.anchor)||!equalCursorPos(i.head,r.head))return!1}return!0},me.prototype.deepCopy=function(){for(var e=this,t=[],n=0;n<this.ranges.length;n++)t[n]=new ve(copyPos(e.ranges[n].anchor),copyPos(e.ranges[n].head));return new me(t,this.primIndex)},me.prototype.somethingSelected=function(){for(var e=this,t=0;t<this.ranges.length;t++)if(!e.ranges[t].empty())return!0;return!1},me.prototype.contains=function(e,t){var n=this;t||(t=e);for(var i=0;i<this.ranges.length;i++){var r=n.ranges[i];if(cmp(t,r.from())>=0&&cmp(e,r.to())<=0)return i}return-1};var ve=function(e,t){this.anchor=e,this.head=t};ve.prototype.from=function(){return minPos(this.anchor,this.head)},ve.prototype.to=function(){return maxPos(this.anchor,this.head)},ve.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},LeafChunk.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n=this,i=e,r=e+t;i<r;++i){var o=n.lines[i];n.height-=o.height,cleanUpLine(o),signalLater(o,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,n){var i=this;this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var r=0;r<t.length;++r)t[r].parent=i},iterN:function(e,t,n){for(var i=this,r=e+t;e<r;++e)if(n(i.lines[e]))return!0}},BranchChunk.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){var n=this;this.size-=t;for(var i=0;i<this.children.length;++i){var r=n.children[i],o=r.chunkSize();if(e<o){var a=Math.min(t,o-e),s=r.height;if(r.removeInner(e,a),n.height-=s-r.height,o==a&&(n.children.splice(i--,1),r.parent=null),0==(t-=a))break;e=0}else e-=o}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof LeafChunk))){var l=[];this.collapse(l),this.children=[new LeafChunk(l)],this.children[0].parent=this}},collapse:function(e){for(var t=this,n=0;n<this.children.length;++n)t.children[n].collapse(e)},insertInner:function(e,t,n){var i=this;this.size+=t.length,this.height+=n;for(var r=0;r<this.children.length;++r){var o=i.children[r],a=o.chunkSize();if(e<=a){if(o.insertInner(e,t,n),o.lines&&o.lines.length>50){for(var s=o.lines.length%25+25,l=s;l<o.lines.length;){var c=new LeafChunk(o.lines.slice(l,l+=25));o.height-=c.height,i.children.splice(++r,0,c),c.parent=i}o.lines=o.lines.slice(0,s),i.maybeSpill()}break}e-=a}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=e.children.splice(e.children.length-5,5),n=new BranchChunk(t);if(e.parent){e.size-=n.size,e.height-=n.height;var i=indexOf(e.parent.children,e);e.parent.children.splice(i+1,0,n)}else{var r=new BranchChunk(e.children);r.parent=e,e.children=[r,n],e=r}n.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,n){for(var i=this,r=0;r<this.children.length;++r){var o=i.children[r],a=o.chunkSize();if(e<a){var s=Math.min(t,a-e);if(o.iterN(e,s,n))return!0;if(0==(t-=s))break;e=0}else e-=a}}};var _e=function(e,t,n){var i=this;if(n)for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r]);this.doc=e,this.node=t};_e.prototype.clear=function(){var e=this,t=this.doc.cm,n=this.line.widgets,i=this.line,r=lineNo(i);if(null!=r&&n){for(var o=0;o<n.length;++o)n[o]==e&&n.splice(o--,1);n.length||(i.widgets=null);var a=widgetHeight(this);updateLineHeight(i,Math.max(0,i.height-a)),t&&(runInOp(t,function(){adjustScrollWhenAboveVisible(t,i,-a),regLineChange(t,r,"widget")}),signalLater(t,"lineWidgetCleared",t,this,r))}},_e.prototype.changed=function(){var e=this,t=this.height,n=this.doc.cm,i=this.line;this.height=null;var r=widgetHeight(this)-t;r&&(updateLineHeight(i,i.height+r),n&&runInOp(n,function(){n.curOp.forceUpdate=!0,adjustScrollWhenAboveVisible(n,i,r),signalLater(n,"lineWidgetChanged",n,e,lineNo(i))}))},eventMixin(_e);var ye=0,xe=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++ye};xe.prototype.clear=function(){var e=this;if(!this.explicitlyCleared){var t=this.doc.cm,n=t&&!t.curOp;if(n&&startOperation(t),hasHandler(this,"clear")){var i=this.find();i&&signalLater(this,"clear",i.from,i.to)}for(var r=null,o=null,a=0;a<this.lines.length;++a){var s=e.lines[a],l=getMarkedSpanFor(s.markedSpans,e);t&&!e.collapsed?regLineChange(t,lineNo(s),"text"):t&&(null!=l.to&&(o=lineNo(s)),null!=l.from&&(r=lineNo(s))),s.markedSpans=removeMarkedSpan(s.markedSpans,l),null==l.from&&e.collapsed&&!lineIsHidden(e.doc,s)&&t&&updateLineHeight(s,textHeight(t.display))}if(t&&this.collapsed&&!t.options.lineWrapping)for(var c=0;c<this.lines.length;++c){var u=visualLine(e.lines[c]),d=lineLength(u);d>t.display.maxLineLength&&(t.display.maxLine=u,t.display.maxLineLength=d,t.display.maxLineChanged=!0)}null!=r&&t&&this.collapsed&&regChange(t,r,o+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,t&&reCheckSelection(t.doc)),t&&signalLater(t,"markerCleared",t,this,r,o),n&&endOperation(t),this.parent&&this.parent.clear()}},xe.prototype.find=function(e,t){var n=this;null==e&&"bookmark"==this.type&&(e=1);for(var i,r,o=0;o<this.lines.length;++o){var a=n.lines[o],s=getMarkedSpanFor(a.markedSpans,n);if(null!=s.from&&(i=Pos(t?a:lineNo(a),s.from),-1==e))return i;if(null!=s.to&&(r=Pos(t?a:lineNo(a),s.to),1==e))return r}return i&&{from:i,to:r}},xe.prototype.changed=function(){var e=this,t=this.find(-1,!0),n=this,i=this.doc.cm;t&&i&&runInOp(i,function(){var r=t.line,o=lineNo(t.line),a=findViewForLine(i,o);if(a&&(clearLineMeasurementCacheFor(a),i.curOp.selectionChanged=i.curOp.forceUpdate=!0),i.curOp.updateMaxLine=!0,!lineIsHidden(n.doc,r)&&null!=n.height){var s=n.height;n.height=null;var l=widgetHeight(n)-s;l&&updateLineHeight(r,r.height+l)}signalLater(i,"markerChanged",i,e)})},xe.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=indexOf(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},xe.prototype.detachLine=function(e){if(this.lines.splice(indexOf(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}},eventMixin(xe);var be=function(e,t){var n=this;this.markers=e,this.primary=t;for(var i=0;i<e.length;++i)e[i].parent=n};be.prototype.clear=function(){var e=this;if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var t=0;t<this.markers.length;++t)e.markers[t].clear();signalLater(this,"clear")}},be.prototype.find=function(e,t){return this.primary.find(e,t)},eventMixin(be);var we=0,Ce=function(e,t,n,i,r){if(!(this instanceof Ce))return new Ce(e,t,n,i,r);null==n&&(n=0),BranchChunk.call(this,[new LeafChunk([new ne("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=n;var o=Pos(n,0);this.sel=simpleSelection(o),this.history=new History(null),this.id=++we,this.modeOption=t,this.lineSep=i,this.direction="rtl"==r?"rtl":"ltr",this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),updateDoc(this,{from:o,to:o,text:e}),setSelection(this,simpleSelection(o),L)};Ce.prototype=createObj(BranchChunk.prototype,{constructor:Ce,iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var n=0,i=0;i<t.length;++i)n+=t[i].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=getLines(this,this.first,this.first+this.size);return!1===e?t:t.join(e||this.lineSeparator())},setValue:docMethodOp(function(e){var t=Pos(this.first,0),n=this.first+this.size-1;makeChange(this,{from:t,to:Pos(n,getLine(this,n).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&scrollToCoords(this.cm,0,0),setSelection(this,simpleSelection(t),L)}),replaceRange:function(e,t,n,i){t=clipPos(this,t),n=n?clipPos(this,n):t,replaceRange(this,e,t,n,i)},getRange:function(e,t,n){var i=getBetween(this,clipPos(this,e),clipPos(this,t));return!1===n?i:i.join(n||this.lineSeparator())},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){if(isLine(this,e))return getLine(this,e)},getLineNumber:function(e){return lineNo(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=getLine(this,e)),visualLine(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return clipPos(this,e)},getCursor:function(e){var t=this.sel.primary();return null==e||"head"==e?t.head:"anchor"==e?t.anchor:"end"==e||"to"==e||!1===e?t.to():t.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:docMethodOp(function(e,t,n){setSimpleSelection(this,clipPos(this,"number"==typeof e?Pos(e,t||0):e),null,n)}),setSelection:docMethodOp(function(e,t,n){setSimpleSelection(this,clipPos(this,e),clipPos(this,t||e),n)}),extendSelection:docMethodOp(function(e,t,n){extendSelection(this,clipPos(this,e),t&&clipPos(this,t),n)}),extendSelections:docMethodOp(function(e,t){extendSelections(this,clipPosArray(this,e),t)}),extendSelectionsBy:docMethodOp(function(e,t){extendSelections(this,clipPosArray(this,map(this.sel.ranges,e)),t)}),setSelections:docMethodOp(function(e,t,n){var i=this;if(e.length){for(var r=[],o=0;o<e.length;o++)r[o]=new ve(clipPos(i,e[o].anchor),clipPos(i,e[o].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),setSelection(this,normalizeSelection(r,t),n)}}),addSelection:docMethodOp(function(e,t,n){var i=this.sel.ranges.slice(0);i.push(new ve(clipPos(this,e),clipPos(this,t||e))),setSelection(this,normalizeSelection(i,i.length-1),n)}),getSelection:function(e){for(var t,n=this,i=this.sel.ranges,r=0;r<i.length;r++){var o=getBetween(n,i[r].from(),i[r].to());t=t?t.concat(o):o}return!1===e?t:t.join(e||this.lineSeparator())},getSelections:function(e){for(var t=this,n=[],i=this.sel.ranges,r=0;r<i.length;r++){var o=getBetween(t,i[r].from(),i[r].to());!1!==e&&(o=o.join(e||t.lineSeparator())),n[r]=o}return n},replaceSelection:function(e,t,n){for(var i=[],r=0;r<this.sel.ranges.length;r++)i[r]=e;this.replaceSelections(i,t,n||"+input")},replaceSelections:docMethodOp(function(e,t,n){for(var i=this,r=[],o=this.sel,a=0;a<o.ranges.length;a++){var s=o.ranges[a];r[a]={from:s.from(),to:s.to(),text:i.splitLines(e[a]),origin:n}}for(var l=t&&"end"!=t&&computeReplacedSel(this,r,t),c=r.length-1;c>=0;c--)makeChange(i,r[c]);l?setSelectionReplaceHistory(this,l):this.cm&&ensureCursorVisible(this.cm)}),undo:docMethodOp(function(){makeChangeFromHistory(this,"undo")}),redo:docMethodOp(function(){makeChangeFromHistory(this,"redo")}),undoSelection:docMethodOp(function(){makeChangeFromHistory(this,"undo",!0)}),redoSelection:docMethodOp(function(){makeChangeFromHistory(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,n=0,i=0;i<e.done.length;i++)e.done[i].ranges||++t;for(var r=0;r<e.undone.length;r++)e.undone[r].ranges||++n;return{undo:t,redo:n}},clearHistory:function(){this.history=new History(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:copyHistoryArray(this.history.done),undone:copyHistoryArray(this.history.undone)}},setHistory:function(e){var t=this.history=new History(this.history.maxGeneration);t.done=copyHistoryArray(e.done.slice(0),null,!0),t.undone=copyHistoryArray(e.undone.slice(0),null,!0)},setGutterMarker:docMethodOp(function(e,t,n){return changeLine(this,e,"gutter",function(e){var i=e.gutterMarkers||(e.gutterMarkers={});return i[t]=n,!n&&isEmpty(i)&&(e.gutterMarkers=null),!0})}),clearGutter:docMethodOp(function(e){var t=this;this.iter(function(n){n.gutterMarkers&&n.gutterMarkers[e]&&changeLine(t,n,"gutter",function(){return n.gutterMarkers[e]=null,isEmpty(n.gutterMarkers)&&(n.gutterMarkers=null),!0})})}),lineInfo:function(e){var t;if("number"==typeof e){if(!isLine(this,e))return null;if(t=e,!(e=getLine(this,e)))return null}else if(null==(t=lineNo(e)))return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:docMethodOp(function(e,t,n){return changeLine(this,e,"gutter"==t?"gutter":"class",function(e){var i="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass";if(e[i]){if(classTest(n).test(e[i]))return!1;e[i]+=" "+n}else e[i]=n;return!0})}),removeLineClass:docMethodOp(function(e,t,n){return changeLine(this,e,"gutter"==t?"gutter":"class",function(e){var i="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass",r=e[i];if(!r)return!1;if(null==n)e[i]=null;else{var o=r.match(classTest(n));if(!o)return!1;var a=o.index+o[0].length;e[i]=r.slice(0,o.index)+(o.index&&a!=r.length?" ":"")+r.slice(a)||null}return!0})}),addLineWidget:docMethodOp(function(e,t,n){return addLineWidget(this,e,t,n)}),removeLineWidget:function(e){e.clear()},markText:function(e,t,n){return markText(this,clipPos(this,e),clipPos(this,t),n,n&&n.type||"range")},setBookmark:function(e,t){var n={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return e=clipPos(this,e),markText(this,e,e,n,"bookmark")},findMarksAt:function(e){e=clipPos(this,e);var t=[],n=getLine(this,e.line).markedSpans;if(n)for(var i=0;i<n.length;++i){var r=n[i];(null==r.from||r.from<=e.ch)&&(null==r.to||r.to>=e.ch)&&t.push(r.marker.parent||r.marker)}return t},findMarks:function(e,t,n){e=clipPos(this,e),t=clipPos(this,t);var i=[],r=e.line;return this.iter(e.line,t.line+1,function(o){var a=o.markedSpans;if(a)for(var s=0;s<a.length;s++){var l=a[s];null!=l.to&&r==e.line&&e.ch>=l.to||null==l.from&&r!=e.line||null!=l.from&&r==t.line&&l.from>=t.ch||n&&!n(l.marker)||i.push(l.marker.parent||l.marker)}++r}),i},getAllMarks:function(){var e=[];return this.iter(function(t){var n=t.markedSpans;if(n)for(var i=0;i<n.length;++i)null!=n[i].from&&e.push(n[i].marker)}),e},posFromIndex:function(e){var t,n=this.first,i=this.lineSeparator().length;return this.iter(function(r){var o=r.text.length+i;if(o>e)return t=e,!0;e-=o,++n}),clipPos(this,Pos(n,t))},indexFromPos:function(e){e=clipPos(this,e);var t=e.ch;if(e.line<this.first||e.ch<0)return 0;var n=this.lineSeparator().length;return this.iter(this.first,e.line,function(e){t+=e.text.length+n}),t},copy:function(e){var t=new Ce(getLines(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,n=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<n&&(n=e.to);var i=new Ce(getLines(this,t,n),e.mode||this.modeOption,t,this.lineSep,this.direction);return e.sharedHist&&(i.history=this.history),(this.linked||(this.linked=[])).push({doc:i,sharedHist:e.sharedHist}),i.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],copySharedMarkers(i,findSharedMarkers(this)),i},unlinkDoc:function(e){var t=this;if(e instanceof CodeMirror$1&&(e=e.doc),this.linked)for(var n=0;n<this.linked.length;++n){var i=t.linked[n];if(i.doc==e){t.linked.splice(n,1),e.unlinkDoc(t),detachSharedMarkers(findSharedMarkers(t));break}}if(e.history==this.history){var r=[e.id];linkedDocs(e,function(e){return r.push(e.id)},!0),e.history=new History(null),e.history.done=copyHistoryArray(this.history.done,r),e.history.undone=copyHistoryArray(this.history.undone,r)}},iterLinkedDocs:function(e){linkedDocs(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):G(e)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:docMethodOp(function(e){"rtl"!=e&&(e="ltr"),e!=this.direction&&(this.direction=e,this.iter(function(e){return e.order=null}),this.cm&&directionChanged(this.cm))})}),Ce.prototype.eachLine=Ce.prototype.iter;for(var Se=0,Te=!1,Ae={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},Me=0;Me<10;Me++)Ae[Me+48]=Ae[Me+96]=String(Me);for(var Ee=65;Ee<=90;Ee++)Ae[Ee]=String.fromCharCode(Ee);for(var Ie=1;Ie<=12;Ie++)Ae[Ie+111]=Ae[Ie+63235]="F"+Ie;var De={};De.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},De.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},De.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},De.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},De.default=_?De.macDefault:De.pcDefault;var ke={selectAll:selectAll,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),L)},killLine:function(e){return deleteNearSelection(e,function(t){if(t.empty()){var n=getLine(e.doc,t.head.line).text.length;return t.head.ch==n&&t.head.line<e.lastLine()?{from:t.head,to:Pos(t.head.line+1,0)}:{from:t.head,to:Pos(t.head.line,n)}}return{from:t.from(),to:t.to()}})},deleteLine:function(e){return deleteNearSelection(e,function(t){return{from:Pos(t.from().line,0),to:clipPos(e.doc,Pos(t.to().line+1,0))}})},delLineLeft:function(e){return deleteNearSelection(e,function(e){return{from:Pos(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(e){return deleteNearSelection(e,function(t){var n=e.charCoords(t.head,"div").top+5;return{from:e.coordsChar({left:0,top:n},"div"),to:t.from()}})},delWrappedLineRight:function(e){return deleteNearSelection(e,function(t){var n=e.charCoords(t.head,"div").top+5,i=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div");return{from:t.from(),to:i}})},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(Pos(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(Pos(e.lastLine()))},goLineStart:function(e){return e.extendSelectionsBy(function(t){return lineStart(e,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){return e.extendSelectionsBy(function(t){return lineStartSmart(e,t.head)},{origin:"+move",bias:1})},goLineEnd:function(e){return e.extendSelectionsBy(function(t){return lineEnd(e,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){return e.extendSelectionsBy(function(t){var n=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div")},P)},goLineLeft:function(e){return e.extendSelectionsBy(function(t){var n=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:n},"div")},P)},goLineLeftSmart:function(e){return e.extendSelectionsBy(function(t){var n=e.cursorCoords(t.head,"div").top+5,i=e.coordsChar({left:0,top:n},"div");return i.ch<e.getLine(i.line).search(/\S/)?lineStartSmart(e,t.head):i},P)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"char")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("\t")},insertSoftTab:function(e){for(var t=[],n=e.listSelections(),i=e.options.tabSize,r=0;r<n.length;r++){var o=n[r].from(),a=countColumn(e.getLine(o.line),o.ch,i);t.push(spaceStr(i-a%i))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){return runInOp(e,function(){for(var t=e.listSelections(),n=[],i=0;i<t.length;i++)if(t[i].empty()){var r=t[i].head,o=getLine(e.doc,r.line).text;if(o)if(r.ch==o.length&&(r=new Pos(r.line,r.ch-1)),r.ch>0)r=new Pos(r.line,r.ch+1),e.replaceRange(o.charAt(r.ch-1)+o.charAt(r.ch-2),Pos(r.line,r.ch-2),r,"+transpose");else if(r.line>e.doc.first){var a=getLine(e.doc,r.line-1).text;a&&(r=new Pos(r.line,1),e.replaceRange(o.charAt(0)+e.doc.lineSeparator()+a.charAt(a.length-1),Pos(r.line-1,a.length-1),r,"+transpose"))}n.push(new ve(r,r))}e.setSelections(n)})},newlineAndIndent:function(e){return runInOp(e,function(){for(var t=e.listSelections(),n=t.length-1;n>=0;n--)e.replaceRange(e.doc.lineSeparator(),t[n].anchor,t[n].head,"+input");t=e.listSelections();for(var i=0;i<t.length;i++)e.indentLine(t[i].from().line,null,!0);ensureCursorVisible(e)})},openLine:function(e){return e.replaceSelection("\n","start")},toggleOverwrite:function(e){return e.toggleOverwrite()}},Le=new M,Ne=null,Pe=function(e,t,n){this.time=e,this.pos=t,this.button=n};Pe.prototype.compare=function(e,t,n){return this.time+400>e&&0==cmp(t,this.pos)&&n==this.button};var Oe,Re,ze={toString:function(){return"CodeMirror.Init"}},Fe={},Be={};CodeMirror$1.defaults=Fe,CodeMirror$1.optionHandlers=Be;var He=[];CodeMirror$1.defineInitHook=function(e){return He.push(e)};var Ve=null,We=function(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new M,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};We.prototype.init=function(e){function onCopyCut(e){if(!signalDOMEvent(i,e)){if(i.somethingSelected())setLastCopied({lineWise:!1,text:i.getSelections()}),"cut"==e.type&&i.replaceSelection("",null,"cut");else{if(!i.options.lineWiseCopyCut)return;var t=copyableRanges(i);setLastCopied({lineWise:!0,text:t.text}),"cut"==e.type&&i.operation(function(){i.setSelections(t.ranges,0,L),i.replaceSelection("",null,"cut")})}if(e.clipboardData){e.clipboardData.clearData();var o=Ve.text.join("\n");if(e.clipboardData.setData("Text",o),e.clipboardData.getData("Text")==o)return void e.preventDefault()}var a=hiddenTextarea(),s=a.firstChild;i.display.lineSpace.insertBefore(a,i.display.lineSpace.firstChild),s.value=Ve.text.join("\n");var l=document.activeElement;A(s),setTimeout(function(){i.display.lineSpace.removeChild(a),l.focus(),l==r&&n.showPrimarySelection()},50)}}var t=this,n=this,i=n.cm,r=n.div=e.lineDiv;disableBrowserMagic(r,i.options.spellcheck),U(r,"paste",function(e){signalDOMEvent(i,e)||handlePaste(e,i)||s<=11&&setTimeout(operation(i,function(){return t.updateFromDOM()}),20)}),U(r,"compositionstart",function(e){t.composing={data:e.data,done:!1}}),U(r,"compositionupdate",function(e){t.composing||(t.composing={data:e.data,done:!1})}),U(r,"compositionend",function(e){t.composing&&(e.data!=t.composing.data&&t.readFromDOMSoon(),t.composing.done=!0)}),U(r,"touchstart",function(){return n.forceCompositionEnd()}),U(r,"input",function(){t.composing||t.readFromDOMSoon()}),U(r,"copy",onCopyCut),U(r,"cut",onCopyCut)},We.prototype.prepareSelection=function(){var e=prepareSelection(this.cm,!1);return e.focus=this.cm.state.focused,e},We.prototype.showSelection=function(e,t){e&&this.cm.display.view.length&&((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))},We.prototype.showPrimarySelection=function(){var e=window.getSelection(),t=this.cm,i=t.doc.sel.primary(),r=i.from(),o=i.to();if(t.display.viewTo==t.display.viewFrom||r.line>=t.display.viewTo||o.line<t.display.viewFrom)return void e.removeAllRanges();var a=domToPos(t,e.anchorNode,e.anchorOffset),s=domToPos(t,e.focusNode,e.focusOffset);if(!a||a.bad||!s||s.bad||0!=cmp(minPos(a,s),r)||0!=cmp(maxPos(a,s),o)){var l=t.display.view,c=r.line>=t.display.viewFrom&&posToDOM(t,r)||{node:l[0].measure.map[2],offset:0},u=o.line<t.display.viewTo&&posToDOM(t,o);if(!u){var d=l[l.length-1].measure,h=d.maps?d.maps[d.maps.length-1]:d.map;u={node:h[h.length-1],offset:h[h.length-2]-h[h.length-3]}}if(!c||!u)return void e.removeAllRanges();var p,f=e.rangeCount&&e.getRangeAt(0);try{p=w(c.node,c.offset,u.offset,u.node)}catch(e){}p&&(!n&&t.state.focused?(e.collapse(c.node,c.offset),p.collapsed||(e.removeAllRanges(),e.addRange(p))):(e.removeAllRanges(),e.addRange(p)),f&&null==e.anchorNode?e.addRange(f):n&&this.startGracePeriod()),this.rememberSelection()}},We.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){return e.cm.curOp.selectionChanged=!0})},20)},We.prototype.showMultipleSelections=function(e){removeChildrenAndAdd(this.cm.display.cursorDiv,e.cursors),removeChildrenAndAdd(this.cm.display.selectionDiv,e.selection)},We.prototype.rememberSelection=function(){var e=window.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},We.prototype.selectionInEditor=function(){var e=window.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return contains(this.div,t)},We.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()||this.showSelection(this.prepareSelection(),!0),this.div.focus())},We.prototype.blur=function(){this.div.blur()},We.prototype.getField=function(){return this.div},We.prototype.supportsTouch=function(){return!0},We.prototype.receivedFocus=function(){function poll(){e.cm.state.focused&&(e.pollSelection(),e.polling.set(e.cm.options.pollInterval,poll))}var e=this;this.selectionInEditor()?this.pollSelection():runInOp(this.cm,function(){return e.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,poll)},We.prototype.selectionChanged=function(){var e=window.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},We.prototype.pollSelection=function(){if(null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){var e=window.getSelection(),t=this.cm;if(m&&u&&this.cm.options.gutters.length&&isInGutter(e.anchorNode))return this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),void this.focus();if(!this.composing){this.rememberSelection();var n=domToPos(t,e.anchorNode,e.anchorOffset),i=domToPos(t,e.focusNode,e.focusOffset);n&&i&&runInOp(t,function(){setSelection(t.doc,simpleSelection(n,i),L),(n.bad||i.bad)&&(t.curOp.selectionChanged=!0)})}}},We.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e=this.cm,t=e.display,n=e.doc.sel.primary(),i=n.from(),r=n.to();if(0==i.ch&&i.line>e.firstLine()&&(i=Pos(i.line-1,getLine(e.doc,i.line-1).length)),r.ch==getLine(e.doc,r.line).text.length&&r.line<e.lastLine()&&(r=Pos(r.line+1,0)),i.line<t.viewFrom||r.line>t.viewTo-1)return!1;var o,a,s;i.line==t.viewFrom||0==(o=findViewIndex(e,i.line))?(a=lineNo(t.view[0].line),s=t.view[0].node):(a=lineNo(t.view[o].line),s=t.view[o-1].node.nextSibling);var l,c,u=findViewIndex(e,r.line);if(u==t.view.length-1?(l=t.viewTo-1,c=t.lineDiv.lastChild):(l=lineNo(t.view[u+1].line)-1,c=t.view[u+1].node.previousSibling),!s)return!1;for(var d=e.doc.splitLines(domTextBetween(e,s,c,a,l)),h=getBetween(e.doc,Pos(a,0),Pos(l,getLine(e.doc,l).text.length));d.length>1&&h.length>1;)if(lst(d)==lst(h))d.pop(),h.pop(),l--;else{if(d[0]!=h[0])break;d.shift(),h.shift(),a++}for(var p=0,f=0,g=d[0],m=h[0],v=Math.min(g.length,m.length);p<v&&g.charCodeAt(p)==m.charCodeAt(p);)++p;for(var _=lst(d),y=lst(h),x=Math.min(_.length-(1==d.length?p:0),y.length-(1==h.length?p:0));f<x&&_.charCodeAt(_.length-f-1)==y.charCodeAt(y.length-f-1);)++f;if(1==d.length&&1==h.length&&a==i.line)for(;p&&p>i.ch&&_.charCodeAt(_.length-f-1)==y.charCodeAt(y.length-f-1);)p--,f++;d[d.length-1]=_.slice(0,_.length-f).replace(/^\u200b+/,""),d[0]=d[0].slice(p).replace(/\u200b+$/,"");var b=Pos(a,p),w=Pos(l,h.length?lst(h).length-f:0);return d.length>1||d[0]||cmp(b,w)?(replaceRange(e.doc,d,b,w,"+input"),!0):void 0},We.prototype.ensurePolled=function(){this.forceCompositionEnd()},We.prototype.reset=function(){this.forceCompositionEnd()},We.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},We.prototype.readFromDOMSoon=function(){var e=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(function(){if(e.readDOMTimeout=null,e.composing){if(!e.composing.done)return;e.composing=null}e.updateFromDOM()},80))},We.prototype.updateFromDOM=function(){var e=this;!this.cm.isReadOnly()&&this.pollContent()||runInOp(this.cm,function(){return regChange(e.cm)})},We.prototype.setUneditable=function(e){e.contentEditable="false"},We.prototype.onKeyPress=function(e){0!=e.charCode&&(e.preventDefault(),this.cm.isReadOnly()||operation(this.cm,applyTextInput)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0))},We.prototype.readOnlyChanged=function(e){this.div.contentEditable=String("nocursor"!=e)},We.prototype.onContextMenu=function(){},We.prototype.resetPosition=function(){},We.prototype.needsContentAttribute=!0;var Ue=function(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new M,this.hasSelection=!1,this.composing=null};Ue.prototype.init=function(e){function prepareCopyCut(e){if(!signalDOMEvent(i,e)){if(i.somethingSelected())setLastCopied({lineWise:!1,text:i.getSelections()});else{if(!i.options.lineWiseCopyCut)return;var t=copyableRanges(i);setLastCopied({lineWise:!0,text:t.text}),"cut"==e.type?i.setSelections(t.ranges,null,L):(n.prevInput="",o.value=t.text.join("\n"),A(o))}"cut"==e.type&&(i.state.cutIncoming=!0)}}var t=this,n=this,i=this.cm,r=this.wrapper=hiddenTextarea(),o=this.textarea=r.firstChild;e.wrapper.insertBefore(r,e.wrapper.firstChild),g&&(o.style.width="0px"),U(o,"input",function(){a&&s>=9&&t.hasSelection&&(t.hasSelection=null),n.poll()}),U(o,"paste",function(e){signalDOMEvent(i,e)||handlePaste(e,i)||(i.state.pasteIncoming=!0,n.fastPoll())}),U(o,"cut",prepareCopyCut),U(o,"copy",prepareCopyCut),U(e.scroller,"paste",function(t){eventInWidget(e,t)||signalDOMEvent(i,t)||(i.state.pasteIncoming=!0,n.focus())}),U(e.lineSpace,"selectstart",function(t){eventInWidget(e,t)||e_preventDefault(t)}),U(o,"compositionstart",function(){var e=i.getCursor("from");n.composing&&n.composing.range.clear(),n.composing={start:e,range:i.markText(e,i.getCursor("to"),{className:"CodeMirror-composing"})}}),U(o,"compositionend",function(){n.composing&&(n.poll(),n.composing.range.clear(),n.composing=null)})},Ue.prototype.prepareSelection=function(){var e=this.cm,t=e.display,n=e.doc,i=prepareSelection(e);if(e.options.moveInputWithCursor){var r=cursorCoords(e,n.sel.primary().head,"div"),o=t.wrapper.getBoundingClientRect(),a=t.lineDiv.getBoundingClientRect();i.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,r.top+a.top-o.top)),i.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,r.left+a.left-o.left))}return i},Ue.prototype.showSelection=function(e){var t=this.cm,n=t.display;removeChildrenAndAdd(n.cursorDiv,e.cursors),removeChildrenAndAdd(n.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},Ue.prototype.reset=function(e){if(!this.contextMenuPending&&!this.composing){var t=this.cm;if(t.somethingSelected()){this.prevInput="";var n=t.getSelection();this.textarea.value=n,t.state.focused&&A(this.textarea),a&&s>=9&&(this.hasSelection=n)}else e||(this.prevInput=this.textarea.value="",a&&s>=9&&(this.hasSelection=null))}},Ue.prototype.getField=function(){return this.textarea},Ue.prototype.supportsTouch=function(){return!1},Ue.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!v||activeElt()!=this.textarea))try{this.textarea.focus()}catch(e){}},Ue.prototype.blur=function(){this.textarea.blur()},Ue.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},Ue.prototype.receivedFocus=function(){this.slowPoll()},Ue.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},Ue.prototype.fastPoll=function(){function p(){t.poll()||e?(t.pollingFast=!1,t.slowPoll()):(e=!0,t.polling.set(60,p))}var e=!1,t=this;t.pollingFast=!0,t.polling.set(20,p)},Ue.prototype.poll=function(){var e=this,t=this.cm,n=this.textarea,i=this.prevInput;if(this.contextMenuPending||!t.state.focused||q(n)&&!i&&!this.composing||t.isReadOnly()||t.options.disableInput||t.state.keySeq)return!1;var r=n.value;if(r==i&&!t.somethingSelected())return!1;if(a&&s>=9&&this.hasSelection===r||_&&/[\uf700-\uf7ff]/.test(r))return t.display.input.reset(),!1;if(t.doc.sel==t.display.selForContextMenu){var o=r.charCodeAt(0);if(8203!=o||i||(i="​"),8666==o)return this.reset(),this.cm.execCommand("undo")}for(var l=0,c=Math.min(i.length,r.length);l<c&&i.charCodeAt(l)==r.charCodeAt(l);)++l;return runInOp(t,function(){applyTextInput(t,r.slice(l),i.length-l,null,e.composing?"*compose":null),r.length>1e3||r.indexOf("\n")>-1?n.value=e.prevInput="":e.prevInput=r,e.composing&&(e.composing.range.clear(),e.composing.range=t.markText(e.composing.start,t.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},Ue.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},Ue.prototype.onKeyPress=function(){a&&s>=9&&(this.hasSelection=null),this.fastPoll()},Ue.prototype.onContextMenu=function(e){function prepareSelectAllHack(){if(null!=r.selectionStart){var e=n.somethingSelected(),o="​"+(e?r.value:"");r.value="⇚",r.value=o,t.prevInput=e?"":"​",r.selectionStart=1,r.selectionEnd=o.length,i.selForContextMenu=n.doc.sel}}function rehide(){if(t.contextMenuPending=!1,t.wrapper.style.cssText=h,r.style.cssText=u,a&&s<9&&i.scrollbars.setScrollTop(i.scroller.scrollTop=c),null!=r.selectionStart){(!a||a&&s<9)&&prepareSelectAllHack();var e=0,o=function(){i.selForContextMenu==n.doc.sel&&0==r.selectionStart&&r.selectionEnd>0&&"​"==t.prevInput?operation(n,selectAll)(n):e++<10?i.detectingSelectAll=setTimeout(o,500):(i.selForContextMenu=null,i.input.reset())};i.detectingSelectAll=setTimeout(o,200)}}var t=this,n=t.cm,i=n.display,r=t.textarea,o=posFromMouse(n,e),c=i.scroller.scrollTop;if(o&&!d){n.options.resetSelectionOnContextMenu&&-1==n.doc.sel.contains(o)&&operation(n,setSelection)(n.doc,simpleSelection(o),L);var u=r.style.cssText,h=t.wrapper.style.cssText;t.wrapper.style.cssText="position: absolute";var p=t.wrapper.getBoundingClientRect();r.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(e.clientY-p.top-5)+"px; left: "+(e.clientX-p.left-5)+"px;\n      z-index: 1000; background: "+(a?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";var f;if(l&&(f=window.scrollY),i.input.focus(),l&&window.scrollTo(null,f),i.input.reset(),n.somethingSelected()||(r.value=t.prevInput=" "),t.contextMenuPending=!0,i.selForContextMenu=n.doc.sel,clearTimeout(i.detectingSelectAll),a&&s>=9&&prepareSelectAllHack(),S){e_stop(e);var g=function(){off(window,"mouseup",g),setTimeout(rehide,20)};U(window,"mouseup",g)}else setTimeout(rehide,50)}},Ue.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled="nocursor"==e},Ue.prototype.setUneditable=function(){},Ue.prototype.needsContentAttribute=!1,function(e){function option(n,i,r,o){e.defaults[n]=i,r&&(t[n]=o?function(e,t,n){n!=ze&&r(e,t,n)}:r)}var t=e.optionHandlers;e.defineOption=option,e.Init=ze,option("value","",function(e,t){return e.setValue(t)},!0),option("mode",null,function(e,t){e.doc.modeOption=t,loadMode(e)},!0),option("indentUnit",2,loadMode,!0),option("indentWithTabs",!1),option("smartIndent",!0),option("tabSize",4,function(e){resetModeState(e),clearCaches(e),regChange(e)},!0),option("lineSeparator",null,function(e,t){if(e.doc.lineSep=t,t){var n=[],i=e.doc.first;e.doc.iter(function(e){for(var r=0;;){var o=e.text.indexOf(t,r);if(-1==o)break;r=o+t.length,n.push(Pos(i,o))}i++});for(var r=n.length-1;r>=0;r--)replaceRange(e.doc,t,n[r],Pos(n[r].line,n[r].ch+t.length))}}),option("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff]/g,function(e,t,n){e.state.specialChars=new RegExp(t.source+(t.test("\t")?"":"|\t"),"g"),n!=ze&&e.refresh()}),option("specialCharPlaceholder",defaultSpecialCharPlaceholder,function(e){return e.refresh()},!0),option("electricChars",!0),option("inputStyle",v?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),option("spellcheck",!1,function(e,t){return e.getInputField().spellcheck=t},!0),option("rtlMoveVisually",!x),option("wholeLineUpdateBefore",!0),option("theme","default",function(e){themeChanged(e),guttersChanged(e)},!0),option("keyMap","default",function(e,t,n){var i=getKeyMap(t),r=n!=ze&&getKeyMap(n);r&&r.detach&&r.detach(e,i),i.attach&&i.attach(e,r||null)}),option("extraKeys",null),option("configureMouse",null),option("lineWrapping",!1,wrappingChanged,!0),option("gutters",[],function(e){setGuttersForLineNumbers(e.options),guttersChanged(e)},!0),option("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?compensateForHScroll(e.display)+"px":"0",e.refresh()},!0),option("coverGutterNextToScrollbar",!1,function(e){return updateScrollbars(e)},!0),option("scrollbarStyle","native",function(e){initScrollbars(e),updateScrollbars(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),option("lineNumbers",!1,function(e){setGuttersForLineNumbers(e.options),guttersChanged(e)},!0),option("firstLineNumber",1,guttersChanged,!0),option("lineNumberFormatter",function(e){return e},guttersChanged,!0),option("showCursorWhenSelecting",!1,updateSelection,!0),option("resetSelectionOnContextMenu",!0),option("lineWiseCopyCut",!0),option("pasteLinesPerSelection",!0),option("readOnly",!1,function(e,t){"nocursor"==t&&(onBlur(e),e.display.input.blur()),e.display.input.readOnlyChanged(t)}),option("disableInput",!1,function(e,t){t||e.display.input.reset()},!0),option("dragDrop",!0,dragDropChanged),option("allowDropFileTypes",null),option("cursorBlinkRate",530),option("cursorScrollMargin",0),option("cursorHeight",1,updateSelection,!0),option("singleCursorHeightPerLine",!0,updateSelection,!0),option("workTime",100),option("workDelay",100),option("flattenSpans",!0,resetModeState,!0),option("addModeClass",!1,resetModeState,!0),option("pollInterval",100),option("undoDepth",200,function(e,t){return e.doc.history.undoDepth=t}),option("historyEventDelay",1250),option("viewportMargin",10,function(e){return e.refresh()},!0),option("maxHighlightLength",1e4,resetModeState,!0),option("moveInputWithCursor",!0,function(e,t){t||e.display.input.resetPosition()}),option("tabindex",null,function(e,t){return e.display.input.getField().tabIndex=t||""}),option("autofocus",null),option("direction","ltr",function(e,t){return e.doc.setDirection(t)},!0)}(CodeMirror$1),function(e){var t=e.optionHandlers,n=e.helpers={};e.prototype={constructor:e,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,n){var i=this.options,r=i[e];i[e]==n&&"mode"!=e||(i[e]=n,t.hasOwnProperty(e)&&operation(this,t[e])(this,n,r),signal(this,"optionChange",this,e))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](getKeyMap(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,n=0;n<t.length;++n)if(t[n]==e||t[n].name==e)return t.splice(n,1),!0},addOverlay:methodOp(function(t,n){var i=t.token?t:e.getMode(this.options,t);if(i.startState)throw new Error("Overlays may not be stateful.");insertSorted(this.state.overlays,{mode:i,modeSpec:t,opaque:n&&n.opaque,priority:n&&n.priority||0},function(e){return e.priority}),this.state.modeGen++,regChange(this)}),removeOverlay:methodOp(function(e){for(var t=this,n=this.state.overlays,i=0;i<n.length;++i){var r=n[i].modeSpec;if(r==e||"string"==typeof e&&r.name==e)return n.splice(i,1),t.state.modeGen++,void regChange(t)}}),indentLine:methodOp(function(e,t,n){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),isLine(this.doc,e)&&indentLine(this,e,t,n)}),indentSelection:methodOp(function(e){for(var t=this,n=this.doc.sel.ranges,i=-1,r=0;r<n.length;r++){var o=n[r];if(o.empty())o.head.line>i&&(indentLine(t,o.head.line,e,!0),i=o.head.line,r==t.doc.sel.primIndex&&ensureCursorVisible(t));else{var a=o.from(),s=o.to(),l=Math.max(i,a.line);i=Math.min(t.lastLine(),s.line-(s.ch?0:1))+1;for(var c=l;c<i;++c)indentLine(t,c,e);var u=t.doc.sel.ranges;0==a.ch&&n.length==u.length&&u[r].from().ch>0&&replaceOneSelection(t.doc,r,new ve(a,u[r].to()),L)}}}),getTokenAt:function(e,t){return takeToken(this,e,t)},getLineTokens:function(e,t){return takeToken(this,Pos(e),t,!0)},getTokenTypeAt:function(e){e=clipPos(this.doc,e);var t,n=getLineStyles(this,getLine(this.doc,e.line)),i=0,r=(n.length-1)/2,o=e.ch;if(0==o)t=n[2];else for(;;){var a=i+r>>1;if((a?n[2*a-1]:0)>=o)r=a;else{if(!(n[2*a+1]<o)){t=n[2*a+2];break}i=a+1}}var s=t?t.indexOf("overlay "):-1;return s<0?t:0==s?null:t.slice(0,s-1)},getModeAt:function(t){var n=this.doc.mode;return n.innerMode?e.innerMode(n,this.getTokenAt(t).state).mode:n},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var i=this,r=[];if(!n.hasOwnProperty(t))return r;var o=n[t],a=this.getModeAt(e);if("string"==typeof a[t])o[a[t]]&&r.push(o[a[t]]);else if(a[t])for(var s=0;s<a[t].length;s++){var l=o[a[t][s]];l&&r.push(l)}else a.helperType&&o[a.helperType]?r.push(o[a.helperType]):o[a.name]&&r.push(o[a.name]);for(var c=0;c<o._global.length;c++){var u=o._global[c];u.pred(a,i)&&-1==indexOf(r,u.val)&&r.push(u.val)}return r},getStateAfter:function(e,t){var n=this.doc;return e=clipLine(n,null==e?n.first+n.size-1:e),getContextBefore(this,e+1,t).state},cursorCoords:function(e,t){var n,i=this.doc.sel.primary();return n=null==e?i.head:"object"==typeof e?clipPos(this.doc,e):e?i.from():i.to(),cursorCoords(this,n,t||"page")},charCoords:function(e,t){return charCoords(this,clipPos(this.doc,e),t||"page")},coordsChar:function(e,t){return e=fromCoordSystem(this,e,t||"page"),coordsChar(this,e.left,e.top)},lineAtHeight:function(e,t){return e=fromCoordSystem(this,{top:e,left:0},t||"page").top,lineAtHeight(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t,n){var i,r=!1;if("number"==typeof e){var o=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>o&&(e=o,r=!0),i=getLine(this.doc,e)}else i=e;return intoCoordSystem(this,i,{top:0,left:0},t||"page",n||r).top+(r?this.doc.height-heightAtLine(i):0)},defaultTextHeight:function(){return textHeight(this.display)},defaultCharWidth:function(){return charWidth(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,n,i,r){var o=this.display;e=cursorCoords(this,clipPos(this.doc,e));var a=e.bottom,s=e.left;if(t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),o.sizer.appendChild(t),"over"==i)a=e.top;else if("above"==i||"near"==i){var l=Math.max(o.wrapper.clientHeight,this.doc.height),c=Math.max(o.sizer.clientWidth,o.lineSpace.clientWidth);("above"==i||e.bottom+t.offsetHeight>l)&&e.top>t.offsetHeight?a=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=l&&(a=e.bottom),s+t.offsetWidth>c&&(s=c-t.offsetWidth)}t.style.top=a+"px",t.style.left=t.style.right="","right"==r?(s=o.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==r?s=0:"middle"==r&&(s=(o.sizer.clientWidth-t.offsetWidth)/2),t.style.left=s+"px"),n&&scrollIntoView(this,{left:s,top:a,right:s+t.offsetWidth,bottom:a+t.offsetHeight})},triggerOnKeyDown:methodOp(onKeyDown),triggerOnKeyPress:methodOp(onKeyPress),triggerOnKeyUp:onKeyUp,triggerOnMouseDown:methodOp(onMouseDown),execCommand:function(e){if(ke.hasOwnProperty(e))return ke[e].call(null,this)},triggerElectric:methodOp(function(e){triggerElectric(this,e)}),findPosH:function(e,t,n,i){var r=this,o=1;t<0&&(o=-1,t=-t);for(var a=clipPos(this.doc,e),s=0;s<t&&(a=findPosH(r.doc,a,o,n,i),!a.hitSide);++s);return a},moveH:methodOp(function(e,t){var n=this;this.extendSelectionsBy(function(i){return n.display.shift||n.doc.extend||i.empty()?findPosH(n.doc,i.head,e,t,n.options.rtlMoveVisually):e<0?i.from():i.to()},P)}),deleteH:methodOp(function(e,t){var n=this.doc.sel,i=this.doc;n.somethingSelected()?i.replaceSelection("",null,"+delete"):deleteNearSelection(this,function(n){var r=findPosH(i,n.head,e,t,!1);return e<0?{from:r,to:n.head}:{from:n.head,to:r}})}),findPosV:function(e,t,n,i){var r=this,o=1,a=i;t<0&&(o=-1,t=-t);for(var s=clipPos(this.doc,e),l=0;l<t;++l){var c=cursorCoords(r,s,"div");if(null==a?a=c.left:c.left=a,s=findPosV(r,c,o,n),s.hitSide)break}return s},moveV:methodOp(function(e,t){var n=this,i=this.doc,r=[],o=!this.display.shift&&!i.extend&&i.sel.somethingSelected();if(i.extendSelectionsBy(function(a){if(o)return e<0?a.from():a.to();var s=cursorCoords(n,a.head,"div");null!=a.goalColumn&&(s.left=a.goalColumn),r.push(s.left);var l=findPosV(n,s,e,t);return"page"==t&&a==i.sel.primary()&&addToScrollTop(n,charCoords(n,l,"div").top-s.top),l},P),r.length)for(var a=0;a<i.sel.ranges.length;a++)i.sel.ranges[a].goalColumn=r[a]}),findWordAt:function(e){var t=this.doc,n=getLine(t,e.line).text,i=e.ch,r=e.ch;if(n){var o=this.getHelper(e,"wordChars");"before"!=e.sticky&&r!=n.length||!i?++r:--i;for(var a=n.charAt(i),s=isWordChar(a,o)?function(e){return isWordChar(e,o)}:/\s/.test(a)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!isWordChar(e)};i>0&&s(n.charAt(i-1));)--i;for(;r<n.length&&s(n.charAt(r));)++r}return new ve(Pos(e.line,i),Pos(e.line,r))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?addClass(this.display.cursorDiv,"CodeMirror-overwrite"):T(this.display.cursorDiv,"CodeMirror-overwrite"),signal(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==activeElt()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:methodOp(function(e,t){scrollToCoords(this,e,t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-scrollGap(this)-this.display.barHeight,width:e.scrollWidth-scrollGap(this)-this.display.barWidth,clientHeight:displayHeight(this),clientWidth:displayWidth(this)}},scrollIntoView:methodOp(function(e,t){null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:Pos(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line?scrollToRange(this,e):scrollToCoordsRange(this,e.from,e.to,e.margin)}),setSize:methodOp(function(e,t){var n=this,i=function(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e};null!=e&&(this.display.wrapper.style.width=i(e)),null!=t&&(this.display.wrapper.style.height=i(t)),this.options.lineWrapping&&clearLineMeasurementCache(this);var r=this.display.viewFrom;this.doc.iter(r,this.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){regLineChange(n,r,"widget");break}++r}),this.curOp.forceUpdate=!0,signal(this,"refresh",this)}),operation:function(e){return runInOp(this,e)},startOperation:function(){return startOperation(this)},endOperation:function(){return endOperation(this)},refresh:methodOp(function(){var e=this.display.cachedTextHeight;regChange(this),this.curOp.forceUpdate=!0,clearCaches(this),scrollToCoords(this,this.doc.scrollLeft,this.doc.scrollTop),updateGutterSpace(this),(null==e||Math.abs(e-textHeight(this.display))>.5)&&estimateLineHeights(this),signal(this,"refresh",this)}),swapDoc:methodOp(function(e){var t=this.doc;return t.cm=null,attachDoc(this,e),clearCaches(this),this.display.input.reset(),scrollToCoords(this,e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,signalLater(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},eventMixin(e),e.registerHelper=function(t,i,r){n.hasOwnProperty(t)||(n[t]=e[t]={_global:[]}),n[t][i]=r},e.registerGlobalHelper=function(t,i,r,o){e.registerHelper(t,i,o),n[t]._global.push({pred:r,val:o})}}(CodeMirror$1);var $e="iter insert remove copy getEditor constructor".split(" ");for(var Ge in Ce.prototype)Ce.prototype.hasOwnProperty(Ge)&&indexOf($e,Ge)<0&&(CodeMirror$1.prototype[Ge]=function(e){return function(){return e.apply(this.doc,arguments)}}(Ce.prototype[Ge]));return eventMixin(Ce),CodeMirror$1.inputStyles={textarea:Ue,contenteditable:We},CodeMirror$1.defineMode=function(e){CodeMirror$1.defaults.mode||"null"==e||(CodeMirror$1.defaults.mode=e),defineMode.apply(this,arguments)},CodeMirror$1.defineMIME=defineMIME,CodeMirror$1.defineMode("null",function(){return{token:function(e){return e.skipToEnd()}}}),CodeMirror$1.defineMIME("text/plain","null"),CodeMirror$1.defineExtension=function(e,t){CodeMirror$1.prototype[e]=t},CodeMirror$1.defineDocExtension=function(e,t){Ce.prototype[e]=t},CodeMirror$1.fromTextArea=fromTextArea,function(e){e.off=off,e.on=U,e.wheelEventPixels=wheelEventPixels,e.Doc=Ce,e.splitLines=G,e.countColumn=countColumn,e.findColumn=findColumn,e.isWordChar=isWordCharBasic,e.Pass=k,e.signal=signal,e.Line=ne,e.changeEnd=changeEnd,e.scrollbarModel=de,e.Pos=Pos,e.cmpPos=cmp,e.modes=X,e.mimeModes=Z,e.resolveMode=resolveMode,e.getMode=getMode,e.modeExtensions=K,e.extendMode=extendMode,e.copyState=copyState,e.startState=startState,e.innerMode=innerMode,e.commands=ke,e.keyMap=De,e.keyName=keyName,e.isModifierKey=isModifierKey,e.lookupKey=lookupKey,e.normalizeKeyMap=normalizeKeyMap,e.StringStream=J,e.SharedTextMarker=be,e.TextMarker=xe,e.LineWidget=_e,e.e_preventDefault=e_preventDefault,e.e_stopPropagation=e_stopPropagation,e.e_stop=e_stop,e.addClass=addClass,e.contains=contains,e.rmClass=T,e.keyNames=Ae}(CodeMirror$1),CodeMirror$1.version="5.29.0",CodeMirror$1})},,,,function(e,t,n){(function(i){function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r,o;r=[n(1)],void 0!==(o=function(e){return function(){function Dialog(e,t,n,r,o){var a=this;_classCallCheck(this,Dialog),this.processManager=n,this.graphManager=r,this.zaip=o,this.title=i.i18n.prop("ict_oneminer_dialog_confirm"),this.closeText=i.i18n.prop("ict_oneminer_button_close"),this.resizable=!1,this.autoOpen=!1,this.width=e||600,this.height=t||"auto",this.modal=!0,this.buttons=[{text:i.i18n.prop("ict_oneminer_dialog_confirm"),click:function(){a.confirm()}},{text:i.i18n.prop("ict_oneminer_dialog_cancel"),click:function(){a.cancel(),a._close()}}],this.open=function(e){a.el=e.target,i(a.el).html(a.render()),a.init()},this.close=function(){i(this).dialog("destroy")},this.hooks={},this.setProperties()}return Dialog.getInstance=function(e,t,n,i,r){return this.instance||(this.instance=new this(e,t,n,i,r))},Dialog.prototype.init=function(){},Dialog.prototype.show=function(){i("<div/>").dialog(this).dialog("open"),e.doNiceScroll(i(this.el))},Dialog.prototype._close=function(){i(this.el).dialog("close")},Dialog.prototype.registerHook=function(e,t){return this.hooks[e]=t,this},Dialog.prototype.triggerHook=function(e){if(this.hooks[e]){for(var t,n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];(t=this.hooks[e]).call.apply(t,[this].concat(i))}return this},Dialog.prototype.setProperties=function(){},Dialog.prototype.confirm=function(){},Dialog.prototype.cancel=function(){},Dialog.prototype.render=function(){throw new Error("implements render func...")},Dialog}()}.apply(t,r))&&(e.exports=o)}).call(t,n(0))},function(e,t,n){(function(Fv){!function(e,n){n(t)}(0,function(Hv){"use strict";function e(e,t){i_[e]=t}function i(e){if(null==e||"object"!=typeof e)return e;var t=e,n=Zv.call(e);if("[object Array]"===n){t=[];for(var r=0,o=e.length;r<o;r++)t[r]=i(e[r])}else if(Xv[n]){var a=e.constructor;if(e.constructor.from)t=a.from(e);else{t=new a(e.length);for(var r=0,o=e.length;r<o;r++)t[r]=i(e[r])}}else if(!Yv[n]&&!P(e)&&!S(e)){t={};for(var s in e)e.hasOwnProperty(s)&&(t[s]=i(e[s]))}return t}function n(e,t,r){if(!b(t)||!b(e))return r?i(t):e;for(var o in t)if(t.hasOwnProperty(o)){var a=e[o],s=t[o];!b(s)||!b(a)||y(s)||y(a)||S(s)||S(a)||w(s)||w(a)||P(s)||P(a)?!r&&o in e||(e[o]=i(t[o],!0)):n(a,s,r)}return e}function o(e,t){for(var i=e[0],r=1,o=e.length;r<o;r++)i=n(i,e[r],t);return i}function a(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function r(e,t,n){for(var i in t)t.hasOwnProperty(i)&&(n?null!=t[i]:null==e[i])&&(e[i]=t[i]);return e}function s(){return o_||(o_=r_().getContext("2d")),o_}function l(e,t){if(e){if(e.indexOf)return e.indexOf(t);for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n}return-1}function h(e,t){function i(){}var n=e.prototype;i.prototype=t.prototype,e.prototype=new i;for(var r in n)e.prototype[r]=n[r];e.prototype.constructor=e,e.superClass=t}function u(e,t,n){r(e="prototype"in e?e.prototype:e,t="prototype"in t?t.prototype:t,n)}function c(e){if(e)return"string"!=typeof e&&"number"==typeof e.length}function d(e,t,n){if(e&&t)if(e.forEach&&e.forEach===Jv)e.forEach(t,n);else if(e.length===+e.length)for(var i=0,r=e.length;i<r;i++)t.call(n,e[i],i,e);else for(var o in e)e.hasOwnProperty(o)&&t.call(n,e[o],o,e)}function f(e,t,n){if(e&&t){if(e.map&&e.map===t_)return e.map(t,n);for(var i=[],r=0,o=e.length;r<o;r++)i.push(t.call(n,e[r],r,e));return i}}function p(e,t,n,i){if(e&&t){if(e.reduce&&e.reduce===n_)return e.reduce(t,n,i);for(var r=0,o=e.length;r<o;r++)n=t.call(i,n,e[r],r,e);return n}}function g(e,t,n){if(e&&t){if(e.filter&&e.filter===Qv)return e.filter(t,n);for(var i=[],r=0,o=e.length;r<o;r++)t.call(n,e[r],r,e)&&i.push(e[r]);return i}}function m(e,t){var n=e_.call(arguments,2);return function(){return e.apply(t,n.concat(e_.call(arguments)))}}function v(e){var t=e_.call(arguments,1);return function(){return e.apply(this,t.concat(e_.call(arguments)))}}function y(e){return"[object Array]"===Zv.call(e)}function x(e){return"function"==typeof e}function _(e){return"[object String]"===Zv.call(e)}function b(e){var t=typeof e;return"function"===t||!!e&&"object"==t}function w(e){return!!Yv[Zv.call(e)]}function S(e){return"object"==typeof e&&"number"==typeof e.nodeType&&"object"==typeof e.ownerDocument}function M(e){return e!==e}function I(e){for(var t=0,n=arguments.length;t<n;t++)if(null!=arguments[t])return arguments[t]}function T(e,t){return null!=e?e:t}function A(e,t,n){return null!=e?e:null!=t?t:n}function C(){return Function.call.apply(e_,arguments)}function D(e){if("number"==typeof e)return[e,e,e,e];var t=e.length;return 2===t?[e[0],e[1],e[0],e[1]]:3===t?[e[0],e[1],e[2],e[1]]:e}function L(e,t){if(!e)throw new Error(t)}function k(e){e[a_]=!0}function P(e){return e[a_]}function O(e){e&&d(e,function(e,t){this.set(t,e)},this)}function z(e){return new O(e)}function N(){}function E(e,t){var n=new l_(2);return null==e&&(e=0),null==t&&(t=0),n[0]=e,n[1]=t,n}function R(e,t){return e[0]=t[0],e[1]=t[1],e}function V(e){var t=new l_(2);return t[0]=e[0],t[1]=e[1],t}function B(e,t,n){return e[0]=t,e[1]=n,e}function G(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function W(e,t,n,i){return e[0]=t[0]+n[0]*i,e[1]=t[1]+n[1]*i,e}function H(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}function F(e){return Math.sqrt(Z(e))}function Z(e){return e[0]*e[0]+e[1]*e[1]}function U(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}function X(e,t){var n=F(t);return 0===n?(e[0]=0,e[1]=0):(e[0]=t[0]/n,e[1]=t[1]/n),e}function j(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}function q(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])}function Y(e,t,n,i){return e[0]=t[0]+i*(n[0]-t[0]),e[1]=t[1]+i*(n[1]-t[1]),e}function $(e,t,n){var i=t[0],r=t[1];return e[0]=n[0]*i+n[2]*r+n[4],e[1]=n[1]*i+n[3]*r+n[5],e}function K(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e}function J(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e}function Q(){this.on("mousedown",this._dragStart,this),this.on("mousemove",this._drag,this),this.on("mouseup",this._dragEnd,this),this.on("globalout",this._dragEnd,this)}function tt(e,t){return{target:e,topTarget:t&&t.topTarget}}function et(e,t,n){return{type:e,event:n,target:t.target,topTarget:t.topTarget,cancelBubble:!1,offsetX:n.zrX,offsetY:n.zrY,gestureEvent:n.gestureEvent,pinchX:n.pinchX,pinchY:n.pinchY,pinchScale:n.pinchScale,wheelDelta:n.zrDelta,zrByTouch:n.zrByTouch,which:n.which}}function it(){}function nt(e,t,n){if(e[e.rectHover?"rectContain":"contain"](t,n)){for(var i,r=e;r;){if(r.clipPath&&!r.clipPath.contain(t,n))return!1;r.silent&&(i=!0),r=r.parent}return!i||m_}return!1}function ot(){var e=new y_(6);return at(e),e}function at(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function rt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function st(e,t,n){var i=t[0]*n[0]+t[2]*n[1],r=t[1]*n[0]+t[3]*n[1],o=t[0]*n[2]+t[2]*n[3],a=t[1]*n[2]+t[3]*n[3],s=t[0]*n[4]+t[2]*n[5]+t[4],l=t[1]*n[4]+t[3]*n[5]+t[5];return e[0]=i,e[1]=r,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e}function lt(e,t,n){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4]+n[0],e[5]=t[5]+n[1],e}function ht(e,t,n){var i=t[0],r=t[2],o=t[4],a=t[1],s=t[3],l=t[5],c=Math.sin(n),u=Math.cos(n);return e[0]=i*u+a*c,e[1]=-i*c+a*u,e[2]=r*u+s*c,e[3]=-r*c+u*s,e[4]=u*o+c*l,e[5]=u*l-c*o,e}function ut(e,t,n){var i=n[0],r=n[1];return e[0]=t[0]*i,e[1]=t[1]*r,e[2]=t[2]*i,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*r,e}function ct(e,t){var n=t[0],i=t[2],r=t[4],o=t[1],a=t[3],s=t[5],l=n*a-o*i;return l?(l=1/l,e[0]=a*l,e[1]=-o*l,e[2]=-i*l,e[3]=n*l,e[4]=(i*s-a*r)*l,e[5]=(o*r-n*s)*l,e):null}function dt(e){return e>w_||e<-w_}function ft(e){this._target=e.target,this._life=e.life||1e3,this._delay=e.delay||0,this._initialized=!1,this.loop=null!=e.loop&&e.loop,this.gap=e.gap||0,this.easing=e.easing||"Linear",this.onframe=e.onframe,this.ondestroy=e.ondestroy,this.onrestart=e.onrestart,this._pausedTime=0,this._paused=!1}function pt(e){return(e=Math.round(e))<0?0:e>255?255:e}function gt(e){return(e=Math.round(e))<0?0:e>360?360:e}function mt(e){return e<0?0:e>1?1:e}function vt(e){return pt(e.length&&"%"===e.charAt(e.length-1)?parseFloat(e)/100*255:parseInt(e,10))}function yt(e){return mt(e.length&&"%"===e.charAt(e.length-1)?parseFloat(e)/100:parseFloat(e))}function xt(e,t,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?e+(t-e)*n*6:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}function _t(e,t,n){return e+(t-e)*n}function bt(e,t,n,i,r){return e[0]=t,e[1]=n,e[2]=i,e[3]=r,e}function wt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function St(e,t){P_&&wt(P_,t),P_=N_.put(e,P_||t.slice())}function Mt(e,t){if(e){t=t||[];var n=N_.get(e);if(n)return wt(t,n);var i=(e+="").replace(/ /g,"").toLowerCase();if(i in L_)return wt(t,L_[i]),St(e,t),t;if("#"!==i.charAt(0)){var r=i.indexOf("("),o=i.indexOf(")");if(-1!==r&&o+1===i.length){var a=i.substr(0,r),s=i.substr(r+1,o-(r+1)).split(","),l=1;switch(a){case"rgba":if(4!==s.length)return void bt(t,0,0,0,1);l=yt(s.pop());case"rgb":return 3!==s.length?void bt(t,0,0,0,1):(bt(t,vt(s[0]),vt(s[1]),vt(s[2]),l),St(e,t),t);case"hsla":return 4!==s.length?void bt(t,0,0,0,1):(s[3]=yt(s[3]),It(s,t),St(e,t),t);case"hsl":return 3!==s.length?void bt(t,0,0,0,1):(It(s,t),St(e,t),t);default:return}}bt(t,0,0,0,1)}else{if(4===i.length)return(c=parseInt(i.substr(1),16))>=0&&c<=4095?(bt(t,(3840&c)>>4|(3840&c)>>8,240&c|(240&c)>>4,15&c|(15&c)<<4,1),St(e,t),t):void bt(t,0,0,0,1);if(7===i.length){var c=parseInt(i.substr(1),16);return c>=0&&c<=16777215?(bt(t,(16711680&c)>>16,(65280&c)>>8,255&c,1),St(e,t),t):void bt(t,0,0,0,1)}}}}function It(e,t){var n=(parseFloat(e[0])%360+360)%360/360,i=yt(e[1]),r=yt(e[2]),o=r<=.5?r*(i+1):r+i-r*i,a=2*r-o;return t=t||[],bt(t,pt(255*xt(a,o,n+1/3)),pt(255*xt(a,o,n)),pt(255*xt(a,o,n-1/3)),1),4===e.length&&(t[3]=e[3]),t}function Tt(e){if(e){var t,n,i=e[0]/255,r=e[1]/255,o=e[2]/255,a=Math.min(i,r,o),s=Math.max(i,r,o),l=s-a,c=(s+a)/2;if(0===l)t=0,n=0;else{n=c<.5?l/(s+a):l/(2-s-a);var u=((s-i)/6+l/2)/l,d=((s-r)/6+l/2)/l,h=((s-o)/6+l/2)/l;i===s?t=h-d:r===s?t=1/3+u-h:o===s&&(t=2/3+d-u),t<0&&(t+=1),t>1&&(t-=1)}var p=[360*t,n,c];return null!=e[3]&&p.push(e[3]),p}}function At(e,t){var n=Mt(e);if(n){for(var i=0;i<3;i++)n[i]=t<0?n[i]*(1-t)|0:(255-n[i])*t+n[i]|0;return Ot(n,4===n.length?"rgba":"rgb")}}function Ct(e){var t=Mt(e);if(t)return((1<<24)+(t[0]<<16)+(t[1]<<8)+ +t[2]).toString(16).slice(1)}function Dt(e,t,n){if(t&&t.length&&e>=0&&e<=1){n=n||[];var i=e*(t.length-1),r=Math.floor(i),o=Math.ceil(i),a=t[r],s=t[o],l=i-r;return n[0]=pt(_t(a[0],s[0],l)),n[1]=pt(_t(a[1],s[1],l)),n[2]=pt(_t(a[2],s[2],l)),n[3]=mt(_t(a[3],s[3],l)),n}}function Lt(e,t,n){if(t&&t.length&&e>=0&&e<=1){var i=e*(t.length-1),r=Math.floor(i),o=Math.ceil(i),a=Mt(t[r]),s=Mt(t[o]),l=i-r,c=Ot([pt(_t(a[0],s[0],l)),pt(_t(a[1],s[1],l)),pt(_t(a[2],s[2],l)),mt(_t(a[3],s[3],l))],"rgba");return n?{color:c,leftIndex:r,rightIndex:o,value:i}:c}}function kt(e,t,n,i){if(e=Mt(e))return e=Tt(e),null!=t&&(e[0]=gt(t)),null!=n&&(e[1]=yt(n)),null!=i&&(e[2]=yt(i)),Ot(It(e),"rgba")}function Pt(e,t){if((e=Mt(e))&&null!=t)return e[3]=mt(t),Ot(e,"rgba")}function Ot(e,t){if(e&&e.length){var n=e[0]+","+e[1]+","+e[2];return"rgba"!==t&&"hsva"!==t&&"hsla"!==t||(n+=","+e[3]),t+"("+n+")"}}function zt(e,t){return e[t]}function Nt(e,t,n){e[t]=n}function Et(e,t,n){return(t-e)*n+e}function Rt(e,t,n){return n>.5?t:e}function Vt(e,t,n,i,r){var o=e.length;if(1==r)for(s=0;s<o;s++)i[s]=Et(e[s],t[s],n);else for(var a=o&&e[0].length,s=0;s<o;s++)for(var l=0;l<a;l++)i[s][l]=Et(e[s][l],t[s][l],n)}function Bt(e,t,n){var i=e.length,r=t.length;if(i!==r)if(i>r)e.length=r;else for(a=i;a<r;a++)e.push(1===n?t[a]:F_.call(t[a]));for(var o=e[0]&&e[0].length,a=0;a<e.length;a++)if(1===n)isNaN(e[a])&&(e[a]=t[a]);else for(var s=0;s<o;s++)isNaN(e[a][s])&&(e[a][s]=t[a][s])}function Gt(e,t,n){if(e===t)return!0;var i=e.length;if(i!==t.length)return!1;if(1===n){for(o=0;o<i;o++)if(e[o]!==t[o])return!1}else for(var r=e[0].length,o=0;o<i;o++)for(var a=0;a<r;a++)if(e[o][a]!==t[o][a])return!1;return!0}function Wt(e,t,n,i,r,o,a,s,l){var c=e.length;if(1==l)for(d=0;d<c;d++)s[d]=Ht(e[d],t[d],n[d],i[d],r,o,a);else for(var u=e[0].length,d=0;d<c;d++)for(var h=0;h<u;h++)s[d][h]=Ht(e[d][h],t[d][h],n[d][h],i[d][h],r,o,a)}function Ht(e,t,n,i,r,o,a){var s=.5*(n-e),l=.5*(i-t);return(2*(t-n)+s+l)*a+(-3*(t-n)-2*s-l)*o+s*r+t}function Ft(e){if(c(e)){var t=e.length;if(c(e[0])){for(var n=[],i=0;i<t;i++)n.push(F_.call(e[i]));return n}return F_.call(e)}return e}function Zt(e){return e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.floor(e[2]),"rgba("+e.join(",")+")"}function Ut(e){var t=e[e.length-1].value;return c(t&&t[0])?2:1}function Xt(e,t,n,i,r,o){var a=e._getter,s=e._setter,l="spline"===t,u=i.length;if(u){var d,h=c(i[0].value),p=!1,f=!1,g=h?Ut(i):0;i.sort(function(e,t){return e.time-t.time}),d=i[u-1].time;for(var m=[],v=[],_=i[0].value,y=!0,x=0;x<u;x++){m.push(i[x].time/d);var b=i[x].value;if(h&&Gt(b,_,g)||!h&&b===_||(y=!1),_=b,"string"==typeof b){var w=Mt(b);w?(b=w,p=!0):f=!0}v.push(b)}if(o||!y){for(var C=v[u-1],x=0;x<u-1;x++)h?Bt(v[x],C,g):!isNaN(v[x])||isNaN(C)||f||p||(v[x]=C);h&&Bt(a(e._target,r),C,g);var S,T,A,M,E,I,D=0,k=0;if(p)var L=[0,0,0,0];var N=new ft({target:e._target,life:d,loop:e._loop,delay:e._delay,onframe:function(e,t){var n;if(t<0)n=0;else if(t<k){for(n=S=Math.min(D+1,u-1);n>=0&&!(m[n]<=t);n--);n=Math.min(n,u-2)}else{for(n=D;n<u&&!(m[n]>t);n++);n=Math.min(n-1,u-2)}D=n,k=t;var i=m[n+1]-m[n];if(0!==i)if(T=(t-m[n])/i,l)if(M=v[n],A=v[0===n?n:n-1],E=v[n>u-2?u-1:n+1],I=v[n>u-3?u-1:n+2],h)Wt(A,M,E,I,T,T*T,T*T*T,a(e,r),g);else{if(p)o=Wt(A,M,E,I,T,T*T,T*T*T,L,1),o=Zt(L);else{if(f)return Rt(M,E,T);o=Ht(A,M,E,I,T,T*T,T*T*T)}s(e,r,o)}else if(h)Vt(v[n],v[n+1],T,a(e,r),g);else{var o;if(p)Vt(v[n],v[n+1],T,L,1),o=Zt(L);else{if(f)return Rt(v[n],v[n+1],T);o=Et(v[n],v[n+1],T)}s(e,r,o)}},ondestroy:n});return t&&"spline"!==t&&(N.easing=t),N}}}function jt(e,t,n,i){n<0&&(e+=n,n=-n),i<0&&(t+=i,i=-i),this.x=e,this.y=t,this.width=n,this.height=i}function qt(e){for(var t=0;e>=Z_;)t|=1&e,e>>=1;return e+t}function Yt(e,t,n,i){var r=t+1;if(r===n)return 1;if(i(e[r++],e[t])<0){for(;r<n&&i(e[r],e[r-1])<0;)r++;$t(e,t,r)}else for(;r<n&&i(e[r],e[r-1])>=0;)r++;return r-t}function $t(e,t,n){for(n--;t<n;){var i=e[t];e[t++]=e[n],e[n--]=i}}function Kt(e,t,n,i,r){for(i===t&&i++;i<n;i++){for(var o,a=e[i],s=t,l=i;s<l;)r(a,e[o=s+l>>>1])<0?l=o:s=o+1;var c=i-s;switch(c){case 3:e[s+3]=e[s+2];case 2:e[s+2]=e[s+1];case 1:e[s+1]=e[s];break;default:for(;c>0;)e[s+c]=e[s+c-1],c--}e[s]=a}}function Jt(e,t,n,i,r,o){var a=0,s=0,l=1;if(o(e,t[n+r])>0){for(s=i-r;l<s&&o(e,t[n+r+l])>0;)a=l,(l=1+(l<<1))<=0&&(l=s);l>s&&(l=s),a+=r,l+=r}else{for(s=r+1;l<s&&o(e,t[n+r-l])<=0;)a=l,(l=1+(l<<1))<=0&&(l=s);l>s&&(l=s);var c=a;a=r-l,l=r-c}for(a++;a<l;){var u=a+(l-a>>>1);o(e,t[n+u])>0?a=u+1:l=u}return l}function Qt(e,t,n,i,r,o){var a=0,s=0,l=1;if(o(e,t[n+r])<0){for(s=r+1;l<s&&o(e,t[n+r-l])<0;)a=l,(l=1+(l<<1))<=0&&(l=s);l>s&&(l=s);var c=a;a=r-l,l=r-c}else{for(s=i-r;l<s&&o(e,t[n+r+l])>=0;)a=l,(l=1+(l<<1))<=0&&(l=s);l>s&&(l=s),a+=r,l+=r}for(a++;a<l;){var u=a+(l-a>>>1);o(e,t[n+u])<0?l=u:a=u+1}return l}function te(e,t){function i(i){var s=r[i],c=a[i],u=r[i+1],d=a[i+1];a[i]=c+d,i===l-3&&(r[i+1]=r[i+2],a[i+1]=a[i+2]),l--;var h=Qt(e[u],e,s,c,0,t);s+=h,0!=(c-=h)&&0!==(d=Jt(e[s+c-1],e,u,d,d-1,t))&&(c<=d?n(s,c,u,d):o(s,c,u,d))}function n(n,i,r,o){var a=0;for(a=0;a<i;a++)c[a]=e[n+a];var l=0,u=r,d=n;if(e[d++]=e[u++],0!=--o)if(1!==i){for(var h,p,f,g=s;;){h=0,p=0,f=!1;do{if(t(e[u],c[l])<0){if(e[d++]=e[u++],p++,h=0,0==--o){f=!0;break}}else if(e[d++]=c[l++],h++,p=0,1==--i){f=!0;break}}while((h|p)<g);if(f)break;do{if(0!==(h=Qt(e[u],c,l,i,0,t))){for(a=0;a<h;a++)e[d+a]=c[l+a];if(d+=h,l+=h,(i-=h)<=1){f=!0;break}}if(e[d++]=e[u++],0==--o){f=!0;break}if(0!==(p=Jt(c[l],e,u,o,0,t))){for(a=0;a<p;a++)e[d+a]=e[u+a];if(d+=p,u+=p,0==(o-=p)){f=!0;break}}if(e[d++]=c[l++],1==--i){f=!0;break}g--}while(h>=K_||p>=K_);if(f)break;g<0&&(g=0),g+=2}if((s=g)<1&&(s=1),1===i){for(a=0;a<o;a++)e[d+a]=e[u+a];e[d+o]=c[l]}else{if(0===i)throw new Error;for(a=0;a<i;a++)e[d+a]=c[l+a]}}else{for(a=0;a<o;a++)e[d+a]=e[u+a];e[d+o]=c[l]}else for(a=0;a<i;a++)e[d+a]=c[l+a]}function o(n,i,r,o){var a=0;for(a=0;a<o;a++)c[a]=e[r+a];var l=n+i-1,u=o-1,d=r+o-1,h=0,p=0;if(e[d--]=e[l--],0!=--i)if(1!==o){for(var f=s;;){var g=0,m=0,v=!1;do{if(t(c[u],e[l])<0){if(e[d--]=e[l--],g++,m=0,0==--i){v=!0;break}}else if(e[d--]=c[u--],m++,g=0,1==--o){v=!0;break}}while((g|m)<f);if(v)break;do{if(0!=(g=i-Qt(c[u],e,n,i,i-1,t))){for(i-=g,p=1+(d-=g),h=1+(l-=g),a=g-1;a>=0;a--)e[p+a]=e[h+a];if(0===i){v=!0;break}}if(e[d--]=c[u--],1==--o){v=!0;break}if(0!=(m=o-Jt(e[l],c,0,o,o-1,t))){for(o-=m,p=1+(d-=m),h=1+(u-=m),a=0;a<m;a++)e[p+a]=c[h+a];if(o<=1){v=!0;break}}if(e[d--]=e[l--],0==--i){v=!0;break}f--}while(g>=K_||m>=K_);if(v)break;f<0&&(f=0),f+=2}if((s=f)<1&&(s=1),1===o){for(p=1+(d-=i),h=1+(l-=i),a=i-1;a>=0;a--)e[p+a]=e[h+a];e[d]=c[u]}else{if(0===o)throw new Error;for(h=d-(o-1),a=0;a<o;a++)e[h+a]=c[a]}}else{for(p=1+(d-=i),h=1+(l-=i),a=i-1;a>=0;a--)e[p+a]=e[h+a];e[d]=c[u]}else for(h=d-(o-1),a=0;a<o;a++)e[h+a]=c[a]}var r,a,s=K_,l=0,c=[];r=[],a=[],this.mergeRuns=function(){for(;l>1;){var e=l-2;if(e>=1&&a[e-1]<=a[e]+a[e+1]||e>=2&&a[e-2]<=a[e]+a[e-1])a[e-1]<a[e+1]&&e--;else if(a[e]>a[e+1])break;i(e)}},this.forceMergeRuns=function(){for(;l>1;){var e=l-2;e>0&&a[e-1]<a[e+1]&&e--,i(e)}},this.pushRun=function(e,t){r[l]=e,a[l]=t,l+=1}}function ee(e,t,n,i){n||(n=0),i||(i=e.length);var r=i-n;if(!(r<2)){var o=0;if(r<Z_)return o=Yt(e,n,i,t),void Kt(e,n,i,n+o,t);var a=new te(e,t),s=qt(r);do{if((o=Yt(e,n,i,t))<s){var l=r;l>s&&(l=s),Kt(e,n,n+l,n+o,t),o=l}a.pushRun(n,o),a.mergeRuns(),r-=o,n+=o}while(0!==r);a.forceMergeRuns()}}function ie(e,t){return e.zlevel===t.zlevel?e.z===t.z?e.z2-t.z2:e.z-t.z:e.zlevel-t.zlevel}function ne(e,t,n){var i=null==t.x?0:t.x,r=null==t.x2?1:t.x2,o=null==t.y?0:t.y,a=null==t.y2?0:t.y2;return t.global||(i=i*n.width+n.x,r=r*n.width+n.x,o=o*n.height+n.y,a=a*n.height+n.y),e.createLinearGradient(i,o,r,a)}function oe(e,t,n){var i=n.width,r=n.height,o=Math.min(i,r),a=null==t.x?.5:t.x,s=null==t.y?.5:t.y,l=null==t.r?.5:t.r;return t.global||(a=a*i+n.x,s=s*r+n.y,l*=o),e.createRadialGradient(a,s,0,a,s,l)}function ae(){return!1}function re(e,t,n){var i=r_(),r=t.getWidth(),o=t.getHeight(),a=i.style;return a.position="absolute",a.left=0,a.top=0,a.width=r+"px",a.height=o+"px",i.width=r*n,i.height=o*n,i.setAttribute("data-zr-dom-id",e),i}function se(e){if("string"==typeof e){var t=sy.get(e);return t&&t.image}return e}function le(e,t,n,i,r){if(e){if("string"==typeof e){if(t&&t.__zrImageSrc===e||!n)return t;var o=sy.get(e),a={hostEl:n,cb:i,cbPayload:r};return o?!ue(t=o.image)&&o.pending.push(a):(!t&&(t=new Image),t.onload=he,sy.put(e,t.__cachedImgObj={image:t,pending:[a]}),t.src=t.__zrImageSrc=e),t}return e}return t}function he(){var e=this.__cachedImgObj;this.onload=this.__cachedImgObj=null;for(var t=0;t<e.pending.length;t++){var n=e.pending[t],i=n.cb;i&&i(this,n.cbPayload),n.hostEl.dirty()}e.pending.length=0}function ue(e){return e&&e.width&&e.height}function ce(e,t){var n=e+":"+(t=t||hy);if(ly[n])return ly[n];for(var i=(e+"").split("\n"),r=0,o=0,a=i.length;o<a;o++)r=Math.max(Se(i[o],t).width,r);return cy>uy&&(cy=0,ly={}),cy++,ly[n]=r,r}function de(e,t,n,i,r,o,a){return o?pe(e,t,n,i,r,o,a):fe(e,t,n,i,r,a)}function fe(e,t,n,i,r,o){var a=Me(e,t,r,o),s=ce(e,t);r&&(s+=r[1]+r[3]);var l=a.outerHeight,c=new jt(ge(0,s,n),me(0,l,i),s,l);return c.lineHeight=a.lineHeight,c}function pe(e,t,n,i,r,o,a){var s=Ie(e,{rich:o,truncate:a,font:t,textAlign:n,textPadding:r}),l=s.outerWidth,c=s.outerHeight;return new jt(ge(0,l,n),me(0,c,i),l,c)}function ge(e,t,n){return"right"===n?e-=t:"center"===n&&(e-=t/2),e}function me(e,t,n){return"middle"===n?e-=t/2:"bottom"===n&&(e-=t),e}function ve(e,t,n){var i=t.x,r=t.y,o=t.height,a=t.width,s=o/2,l="left",c="top";switch(e){case"left":i-=n,r+=s,l="right",c="middle";break;case"right":i+=n+a,r+=s,c="middle";break;case"top":i+=a/2,r-=n,l="center",c="bottom";break;case"bottom":i+=a/2,r+=o+n,l="center";break;case"inside":i+=a/2,r+=s,l="center",c="middle";break;case"insideLeft":i+=n,r+=s,c="middle";break;case"insideRight":i+=a-n,r+=s,l="right",c="middle";break;case"insideTop":i+=a/2,r+=n,l="center";break;case"insideBottom":i+=a/2,r+=o-n,l="center",c="bottom";break;case"insideTopLeft":i+=n,r+=n;break;case"insideTopRight":i+=a-n,r+=n,l="right";break;case"insideBottomLeft":i+=n,r+=o-n,c="bottom";break;case"insideBottomRight":i+=a-n,r+=o-n,l="right",c="bottom"}return{x:i,y:r,textAlign:l,textVerticalAlign:c}}function ye(e,t,n,i,r){if(!t)return"";var o=(e+"").split("\n");r=xe(t,n,i,r);for(var a=0,s=o.length;a<s;a++)o[a]=_e(o[a],r);return o.join("\n")}function xe(e,t,n,i){(i=a({},i)).font=t;var n=T(n,"...");i.maxIterations=T(i.maxIterations,2);var r=i.minChar=T(i.minChar,0);i.cnCharWidth=ce("国",t);var o=i.ascCharWidth=ce("a",t);i.placeholder=T(i.placeholder,"");for(var s=e=Math.max(0,e-1),l=0;l<r&&s>=o;l++)s-=o;var c=ce(n);return c>s&&(n="",c=0),s=e-c,i.ellipsis=n,i.ellipsisWidth=c,i.contentWidth=s,i.containerWidth=e,i}function _e(e,t){var n=t.containerWidth,i=t.font,r=t.contentWidth;if(!n)return"";var o=ce(e,i);if(o<=n)return e;for(var a=0;;a++){if(o<=r||a>=t.maxIterations){e+=t.ellipsis;break}var s=0===a?be(e,r,t.ascCharWidth,t.cnCharWidth):o>0?Math.floor(e.length*r/o):0;o=ce(e=e.substr(0,s),i)}return""===e&&(e=t.placeholder),e}function be(e,t,n,i){for(var r=0,o=0,a=e.length;o<a&&r<t;o++){var s=e.charCodeAt(o);r+=0<=s&&s<=127?n:i}return o}function we(e){return ce("国",e)}function Se(e,t){return py.measureText(e,t)}function Me(e,t,n,i){null!=e&&(e+="");var r=we(t),o=e?e.split("\n"):[],a=o.length*r,s=a;if(n&&(s+=n[0]+n[2]),e&&i){var l=i.outerHeight,c=i.outerWidth;if(null!=l&&s>l)e="",o=[];else if(null!=c)for(var u=xe(c-(n?n[1]+n[3]:0),t,i.ellipsis,{minChar:i.minChar,placeholder:i.placeholder}),d=0,h=o.length;d<h;d++)o[d]=_e(o[d],u)}return{lines:o,height:a,outerHeight:s,lineHeight:r}}function Ie(e,t){var n={lines:[],width:0,height:0};if(null!=e&&(e+=""),!e)return n;for(var i,r=dy.lastIndex=0;null!=(i=dy.exec(e));){var o=i.index;o>r&&Te(n,e.substring(r,o)),Te(n,i[2],i[1]),r=dy.lastIndex}r<e.length&&Te(n,e.substring(r,e.length));var a=n.lines,s=0,l=0,c=[],u=t.textPadding,d=t.truncate,h=d&&d.outerWidth,p=d&&d.outerHeight;for(u&&(null!=h&&(h-=u[1]+u[3]),null!=p&&(p-=u[0]+u[2])),D=0;D<a.length;D++){for(var f=a[D],g=0,m=0,v=0;v<f.tokens.length;v++){var _=(k=f.tokens[v]).styleName&&t.rich[k.styleName]||{},y=k.textPadding=_.textPadding,x=k.font=_.font||t.font,b=k.textHeight=T(_.textHeight,we(x));if(y&&(b+=y[0]+y[2]),k.height=b,k.lineHeight=A(_.textLineHeight,t.textLineHeight,b),k.textAlign=_&&_.textAlign||t.textAlign,k.textVerticalAlign=_&&_.textVerticalAlign||"middle",null!=p&&s+k.lineHeight>p)return{lines:[],width:0,height:0};k.textWidth=ce(k.text,x);var w=_.textWidth,C=null==w||"auto"===w;if("string"==typeof w&&"%"===w.charAt(w.length-1))k.percentWidth=w,c.push(k),w=0;else{if(C){w=k.textWidth;var S=_.textBackgroundColor,M=S&&S.image;M&&ue(M=se(M))&&(w=Math.max(w,M.width*b/M.height))}var E=y?y[1]+y[3]:0;w+=E;var I=null!=h?h-m:null;null!=I&&I<w&&(!C||I<E?(k.text="",k.textWidth=w=0):(k.text=ye(k.text,I-E,x,d.ellipsis,{minChar:d.minChar}),k.textWidth=ce(k.text,x),w=k.textWidth+E))}m+=k.width=w,_&&(g=Math.max(g,k.lineHeight))}f.width=m,f.lineHeight=g,s+=g,l=Math.max(l,m)}n.outerWidth=n.width=T(t.textWidth,l),n.outerHeight=n.height=T(t.textHeight,s),u&&(n.outerWidth+=u[1]+u[3],n.outerHeight+=u[0]+u[2]);for(var D=0;D<c.length;D++){var k=c[D],L=k.percentWidth;k.width=parseInt(L,10)/100*l}return n}function Te(e,t,n){for(var i=""===t,r=t.split("\n"),o=e.lines,a=0;a<r.length;a++){var s=r[a],l={styleName:n,text:s,isLineHolder:!s&&!i};if(a)o.push({tokens:[l]});else{var c=(o[o.length-1]||(o[0]={tokens:[]})).tokens,u=c.length;1===u&&c[0].isLineHolder?c[0]=l:(s||!u||i)&&c.push(l)}}}function Ae(e){return(e.fontSize||e.fontFamily)&&[e.fontStyle,e.fontWeight,(e.fontSize||12)+"px",e.fontFamily||"sans-serif"].join(" ")||e.textFont||e.font}function Ce(e,t){var n,i,r,o,a=t.x,s=t.y,l=t.width,c=t.height,u=t.r;l<0&&(a+=l,l=-l),c<0&&(s+=c,c=-c),"number"==typeof u?n=i=r=o=u:u instanceof Array?1===u.length?n=i=r=o=u[0]:2===u.length?(n=r=u[0],i=o=u[1]):3===u.length?(n=u[0],i=o=u[1],r=u[2]):(n=u[0],i=u[1],r=u[2],o=u[3]):n=i=r=o=0;var d;n+i>l&&(n*=l/(d=n+i),i*=l/d),r+o>l&&(r*=l/(d=r+o),o*=l/d),i+r>c&&(i*=c/(d=i+r),r*=c/d),n+o>c&&(n*=c/(d=n+o),o*=c/d),e.moveTo(a+n,s),e.lineTo(a+l-i,s),0!==i&&e.quadraticCurveTo(a+l,s,a+l,s+i),e.lineTo(a+l,s+c-r),0!==r&&e.quadraticCurveTo(a+l,s+c,a+l-r,s+c),e.lineTo(a+o,s+c),0!==o&&e.quadraticCurveTo(a,s+c,a,s+c-o),e.lineTo(a,s+n),0!==n&&e.quadraticCurveTo(a,s,a+n,s)}function De(e){return Le(e),d(e.rich,Le),e}function Le(e){if(e){e.font=Ae(e);var t=e.textAlign;"middle"===t&&(t="center"),e.textAlign=null==t||fy[t]?t:"left";var n=e.textVerticalAlign||e.textBaseline;"center"===n&&(n="middle"),e.textVerticalAlign=null==n||gy[n]?n:"top",e.textPadding&&(e.textPadding=D(e.textPadding))}}function ke(e,t,n,i,r){i.rich?Oe(e,t,n,i,r):Pe(e,t,n,i,r)}function Pe(e,t,n,i,r){var o=We(t,"font",i.font||hy),a=i.textPadding,s=e.__textCotentBlock;s&&!e.__dirty||(s=e.__textCotentBlock=Me(n,o,a,i.truncate));var l=s.outerHeight,c=s.lines,u=s.lineHeight,d=Ge(l,i,r),h=d.baseX,p=d.baseY,f=d.textAlign,g=d.textVerticalAlign;Ne(t,i,r,h,p);var m=me(p,l,g),v=h,_=m,y=Re(i);if(y||a){var x=ce(n,o);a&&(x+=a[1]+a[3]);var b=ge(h,x,f);y&&Ve(e,t,i,b,m,x,l),a&&(v=Ue(h,f,a),_+=a[0])}We(t,"textAlign",f||"left"),We(t,"textBaseline","middle"),We(t,"shadowBlur",i.textShadowBlur||0),We(t,"shadowColor",i.textShadowColor||"transparent"),We(t,"shadowOffsetX",i.textShadowOffsetX||0),We(t,"shadowOffsetY",i.textShadowOffsetY||0),_+=u/2;var w=i.textStrokeWidth,C=He(i.textStroke,w),S=Fe(i.textFill);C&&(We(t,"lineWidth",w),We(t,"strokeStyle",C)),S&&We(t,"fillStyle",S);for(var T=0;T<c.length;T++)C&&t.strokeText(c[T],v,_),S&&t.fillText(c[T],v,_),_+=u}function Oe(e,t,n,i,r){var o=e.__textCotentBlock;o&&!e.__dirty||(o=e.__textCotentBlock=Ie(n,i)),ze(e,t,o,i,r)}function ze(e,t,n,i,r){var o=n.width,a=n.outerWidth,s=n.outerHeight,l=i.textPadding,c=Ge(s,i,r),u=c.baseX,d=c.baseY,h=c.textAlign,p=c.textVerticalAlign;Ne(t,i,r,u,d);var f=ge(u,a,h),g=me(d,s,p),m=f,v=g;l&&(m+=l[3],v+=l[0]);var _=m+o;Re(i)&&Ve(e,t,i,f,g,a,s);for(var y=0;y<n.lines.length;y++){for(var x,b=n.lines[y],w=b.tokens,C=w.length,S=b.lineHeight,T=b.width,A=0,M=m,E=_,I=C-1;A<C&&(!(x=w[A]).textAlign||"left"===x.textAlign);)Ee(e,t,x,i,S,v,M,"left"),T-=x.width,M+=x.width,A++;for(;I>=0&&"right"===(x=w[I]).textAlign;)Ee(e,t,x,i,S,v,E,"right"),T-=x.width,E-=x.width,I--;for(M+=(o-(M-m)-(_-E)-T)/2;A<=I;)Ee(e,t,x=w[A],i,S,v,M+x.width/2,"center"),M+=x.width,A++;v+=S}}function Ne(e,t,n,i,r){if(n&&t.textRotation){var o=t.textOrigin;"center"===o?(i=n.width/2+n.x,r=n.height/2+n.y):o&&(i=o[0]+n.x,r=o[1]+n.y),e.translate(i,r),e.rotate(-t.textRotation),e.translate(-i,-r)}}function Ee(e,t,n,i,r,o,a,s){var l=i.rich[n.styleName]||{},c=n.textVerticalAlign,u=o+r/2;"top"===c?u=o+n.height/2:"bottom"===c&&(u=o+r-n.height/2),!n.isLineHolder&&Re(l)&&Ve(e,t,l,"right"===s?a-n.width:"center"===s?a-n.width/2:a,u-n.height/2,n.width,n.height);var d=n.textPadding;d&&(a=Ue(a,s,d),u-=n.height/2-d[2]-n.textHeight/2),We(t,"shadowBlur",A(l.textShadowBlur,i.textShadowBlur,0)),We(t,"shadowColor",l.textShadowColor||i.textShadowColor||"transparent"),We(t,"shadowOffsetX",A(l.textShadowOffsetX,i.textShadowOffsetX,0)),We(t,"shadowOffsetY",A(l.textShadowOffsetY,i.textShadowOffsetY,0)),We(t,"textAlign",s),We(t,"textBaseline","middle"),We(t,"font",n.font||hy);var h=He(l.textStroke||i.textStroke,f),p=Fe(l.textFill||i.textFill),f=T(l.textStrokeWidth,i.textStrokeWidth);h&&(We(t,"lineWidth",f),We(t,"strokeStyle",h),t.strokeText(n.text,a,u)),p&&(We(t,"fillStyle",p),t.fillText(n.text,a,u))}function Re(e){return e.textBackgroundColor||e.textBorderWidth&&e.textBorderColor}function Ve(e,t,n,i,r,o,a){var s=n.textBackgroundColor,l=n.textBorderWidth,c=n.textBorderColor,u=_(s);if(We(t,"shadowBlur",n.textBoxShadowBlur||0),We(t,"shadowColor",n.textBoxShadowColor||"transparent"),We(t,"shadowOffsetX",n.textBoxShadowOffsetX||0),We(t,"shadowOffsetY",n.textBoxShadowOffsetY||0),u||l&&c){t.beginPath();var d=n.textBorderRadius;d?Ce(t,{x:i,y:r,width:o,height:a,r:d}):t.rect(i,r,o,a),t.closePath()}if(u)We(t,"fillStyle",s),t.fill();else if(b(s)){var h=s.image;(h=le(h,null,e,Be,s))&&ue(h)&&t.drawImage(h,i,r,o,a)}l&&c&&(We(t,"lineWidth",l),We(t,"strokeStyle",c),t.stroke())}function Be(e,t){t.image=e}function Ge(e,t,n){var i=t.x||0,r=t.y||0,o=t.textAlign,a=t.textVerticalAlign;if(n){var s=t.textPosition;if(s instanceof Array)i=n.x+Ze(s[0],n.width),r=n.y+Ze(s[1],n.height);else{var l=ve(s,n,t.textDistance);i=l.x,r=l.y,o=o||l.textAlign,a=a||l.textVerticalAlign}var c=t.textOffset;c&&(i+=c[0],r+=c[1])}return{baseX:i,baseY:r,textAlign:o,textVerticalAlign:a}}function We(e,t,n){return e[t]=n,e[t]}function He(e,t){return null==e||t<=0||"transparent"===e||"none"===e?null:e.image||e.colorStops?"#000":e}function Fe(e){return null==e||"none"===e?null:e.image||e.colorStops?"#000":e}function Ze(e,t){return"string"==typeof e?e.lastIndexOf("%")>=0?parseFloat(e)/100*t:parseFloat(e):e}function Ue(e,t,n){return"right"===t?e-n[1]:"center"===t?e+n[3]/2-n[1]/2:e+n[3]}function Xe(e,t){return null!=e&&(e||t.textBackgroundColor||t.textBorderWidth&&t.textBorderColor||t.textPadding)}function je(e){e=e||{},G_.call(this,e);for(var t in e)e.hasOwnProperty(t)&&"style"!==t&&(this[t]=e[t]);this.style=new ey(e.style,this),this._rect=null,this.__clipPaths=[]}function qe(e){je.call(this,e)}function Ye(e){return parseInt(e,10)}function $e(e){return!!e&&(!!e.__builtin__||"function"==typeof e.resize&&"function"==typeof e.refresh)}function Ke(e){e.__unusedCount++}function Je(e){1==e.__unusedCount&&e.clear()}function Qe(e,t,n){return _y.copy(e.getBoundingRect()),e.transform&&_y.applyTransform(e.transform),yy.width=t,yy.height=n,!_y.intersect(yy)}function ti(e,t){if(e==t)return!1;if(!e||!t||e.length!==t.length)return!0;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!0}function ei(e,t){for(var n=0;n<e.length;n++){var i=e[n];i.setTransform(t),t.beginPath(),i.buildPath(t,i.shape),t.clip(),i.restoreTransform(t)}}function ii(e,t){var n=document.createElement("div");return n.style.cssText=["position:relative","overflow:hidden","width:"+e+"px","height:"+t+"px","padding:0","margin:0","border-width:0"].join(";")+";",n}function ni(e){return e.getBoundingClientRect?e.getBoundingClientRect():{left:0,top:0}}function oi(e,t,n,i){return n=n||{},i||!jv.canvasSupported?ai(e,t,n):jv.browser.firefox&&null!=t.layerX&&t.layerX!==t.offsetX?(n.zrX=t.layerX,n.zrY=t.layerY):null!=t.offsetX?(n.zrX=t.offsetX,n.zrY=t.offsetY):ai(e,t,n),n}function ai(e,t,n){var i=ni(e);n.zrX=t.clientX-i.left,n.zrY=t.clientY-i.top}function ri(e,t,n){if(null!=(t=t||window.event).zrX)return t;var i=t.type;if(i&&i.indexOf("touch")>=0){var r="touchend"!=i?t.targetTouches[0]:t.changedTouches[0];r&&oi(e,r,t,n)}else oi(e,t,t,n),t.zrDelta=t.wheelDelta?t.wheelDelta/120:-(t.detail||0)/3;var o=t.button;return null==t.which&&void 0!==o&&wy.test(t.type)&&(t.which=1&o?1:2&o?3:4&o?2:0),t}function si(e,t,n){by?e.addEventListener(t,n):e.attachEvent("on"+t,n)}function li(e,t,n){by?e.removeEventListener(t,n):e.detachEvent("on"+t,n)}function hi(e){return e.which>1}function ui(e){var t=e[1][0]-e[0][0],n=e[1][1]-e[0][1];return Math.sqrt(t*t+n*n)}function ci(e){return[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2]}function di(e){return"mousewheel"===e&&jv.browser.firefox?"DOMMouseScroll":e}function fi(e,t,n){var i=e._gestureMgr;"start"===n&&i.clear();var r=i.recognize(t,e.handler.findHover(t.zrX,t.zrY,null).target,e.dom);if("end"===n&&i.clear(),r){var o=r.type;t.gestureEvent=o,e.handler.dispatchToElement({target:r.target},o,r.event)}}function pi(e){e._touching=!0,clearTimeout(e._touchTimer),e._touchTimer=setTimeout(function(){e._touching=!1},700)}function gi(e){var t=e.pointerType;return"pen"===t||"touch"===t}function mi(t){function e(e,t){return function(){if(!t._touching)return e.apply(t,arguments)}}d(Ey,function(e){t._handlers[e]=m(ky[e],t)}),d(Dy,function(e){t._handlers[e]=m(ky[e],t)}),d(My,function(n){t._handlers[n]=e(ky[n],t)})}function vi(t){function e(e,n){d(e,function(e){si(t,di(e),n._handlers[e])},n)}g_.call(this),this.dom=t,this._touching=!1,this._touchTimer,this._gestureMgr=new Ty,this._handlers={},mi(this),jv.pointerEventsSupported?e(Dy,this):(jv.touchEventsSupported&&e(Ey,this),e(My,this))}function yi(e,t){var n=new Ry($v(),e,t);return Oy[n.id]=n,n}function xi(e,t){Py[e]=t}function _i(e){delete Oy[e]}function bi(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}function wi(e,t,n,i){var r=t[1]-t[0],o=n[1]-n[0];if(0===r)return 0===o?n[0]:(n[0]+n[1])/2;if(i)if(r>0){if(e<=t[0])return n[0];if(e>=t[1])return n[1]}else{if(e>=t[0])return n[0];if(e<=t[1])return n[1]}else{if(e===t[0])return n[0];if(e===t[1])return n[1]}return(e-t[0])/r*o+n[0]}function Si(e,t){switch(e){case"center":case"middle":e="50%";break;case"left":case"top":e="0%";break;case"right":case"bottom":e="100%"}return"string"==typeof e?bi(e).match(/%$/)?parseFloat(e)/100*t:parseFloat(e):null==e?NaN:+e}function Mi(e,t,n){return null==t&&(t=10),t=Math.min(Math.max(0,t),20),e=(+e).toFixed(t),n?e:+e}function Ii(e){return e.sort(function(e,t){return e-t}),e}function Ti(e){if(e=+e,isNaN(e))return 0;for(var t=1,n=0;Math.round(e*t)/t!==e;)t*=10,n++;return n}function Ai(e){var t=e.toString(),n=t.indexOf("e");if(n>0){var i=+t.slice(n+1);return i<0?-i:0}var r=t.indexOf(".");return r<0?0:t.length-1-r}function Ci(e,t){var n=Math.log,i=Math.LN10,r=Math.floor(n(e[1]-e[0])/i),o=Math.round(n(Math.abs(t[1]-t[0]))/i),a=Math.min(Math.max(-r+o,0),20);return isFinite(a)?a:20}function Di(e,t,n){if(!e[t])return 0;var i=p(e,function(e,t){return e+(isNaN(t)?0:t)},0);if(0===i)return 0;for(var r=Math.pow(10,n),o=f(e,function(e){return(isNaN(e)?0:e)/i*r*100}),a=100*r,s=f(o,function(e){return Math.floor(e)}),l=p(s,function(e,t){return e+t},0),c=f(o,function(e,t){return e-s[t]});l<a;){for(var u=Number.NEGATIVE_INFINITY,d=null,h=0,g=c.length;h<g;++h)c[h]>u&&(u=c[h],d=h);++s[d],c[d]=0,++l}return s[t]/r}function Li(e){var t=2*Math.PI;return(e%t+t)%t}function ki(e){return e>-Fy&&e<Fy}function Pi(e){if(e instanceof Date)return e;if("string"==typeof e){var t=Hy.exec(e);if(!t)return new Date(NaN);if(t[8]){var n=+t[4]||0;return"Z"!==t[8].toUpperCase()&&(n-=t[8].slice(0,3)),new Date(Date.UTC(+t[1],+(t[2]||1)-1,+t[3]||1,n,+(t[5]||0),+t[6]||0,+t[7]||0))}return new Date(+t[1],+(t[2]||1)-1,+t[3]||1,+t[4]||0,+(t[5]||0),+t[6]||0,+t[7]||0)}return null==e?new Date(NaN):new Date(Math.round(e))}function Oi(e){return Math.pow(10,zi(e))}function zi(e){return Math.floor(Math.log(e)/Math.LN10)}function Ni(e,t){var n,i=zi(e),r=Math.pow(10,i),o=e/r;return n=t?o<1.5?1:o<2.5?2:o<4?3:o<7?5:10:o<1?1:o<2?2:o<3?3:o<5?5:10,e=n*r,i>=-20?+e.toFixed(i<0?-i:0):e}function Ei(t){function e(t,n,i){return t.interval[i]<n.interval[i]||t.interval[i]===n.interval[i]&&(t.close[i]-n.close[i]==(i?-1:1)||!i&&e(t,n,1))}t.sort(function(t,n){return e(t,n,0)?-1:1});for(var n=-1/0,i=1,r=0;r<t.length;){for(var o=t[r].interval,a=t[r].close,s=0;s<2;s++)o[s]<=n&&(o[s]=n,a[s]=s?1:1-i),n=o[s],i=a[s];o[0]===o[1]&&a[0]*a[1]!=1?t.splice(r,1):r++}return t}function Ri(e){return e-parseFloat(e)>=0}function Vi(e){return isNaN(e)?"-":(e=(e+"").split("."))[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(e.length>1?"."+e[1]:"")}function Bi(e,t){return e=(e||"").toLowerCase().replace(/-(.)/g,function(e,t){return t.toUpperCase()}),t&&e&&(e=e.charAt(0).toUpperCase()+e.slice(1)),e}function Gi(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Wi(e,t,n){y(t)||(t=[t]);var i=t.length;if(!i)return"";for(var r=t[0].$vars||[],o=0;o<r.length;o++){var a=Uy[o],s=$y(a,0);e=e.replace($y(a),n?Gi(s):s)}for(var l=0;l<i;l++)for(var c=0;c<r.length;c++)s=t[l][r[c]],e=e.replace($y(Uy[c],l),n?Gi(s):s);return e}function Hi(e,t,n){return d(t,function(t,i){e=e.replace("{"+i+"}",n?Gi(t):t)}),e}function Fi(e,t){return e?'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:'+Gi(e)+";"+(t||"")+'"></span>':""}function Zi(e,t,n){"week"!==e&&"month"!==e&&"quarter"!==e&&"half-year"!==e&&"year"!==e||(e="MM-dd\nyyyy");var i=Pi(t),r=n?"UTC":"",o=i["get"+r+"FullYear"](),a=i["get"+r+"Month"]()+1,s=i["get"+r+"Date"](),l=i["get"+r+"Hours"](),c=i["get"+r+"Minutes"](),u=i["get"+r+"Seconds"]();return e=e.replace("MM",Gy(a)).replace("M",a).replace("yyyy",o).replace("yy",o%100).replace("dd",Gy(s)).replace("d",s).replace("hh",Gy(l)).replace("h",l).replace("mm",Gy(c)).replace("m",c).replace("ss",Gy(u)).replace("s",u)}function Ui(e){return e?e.charAt(0).toUpperCase()+e.substr(1):e}function Xi(e,t,n){return e[Ky+t]=n}function ji(e,t){return e[Ky+t]}function qi(e,t){return e.hasOwnProperty(Ky+t)}function Yi(e){var t={main:"",sub:""};return e&&(e=e.split(Xy),t.main=e[0]||"",t.sub=e[1]||""),t}function $i(e){L(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(e),'componentType "'+e+'" illegal')}function Ki(e,t){e.$constructor=e,e.extend=function(e){var t=this,n=function(){e.$constructor?e.$constructor.apply(this,arguments):t.apply(this,arguments)};return a(n.prototype,e),n.extend=this.extend,n.superCall=Ji,n.superApply=Qi,h(n,this),n.superClass=t,n}}function Ji(e,t){var n=C(arguments,2);return this.superClass.prototype[t].apply(e,n)}function Qi(e,t,n){return this.superClass.prototype[t].apply(e,n)}function tn(e,t){function i(e){var t=n[e.main];return t&&t[Zy]||((t=n[e.main]={})[Zy]=!0),t}t=t||{};var n={};if(e.registerClass=function(e,t){return t&&($i(t),(t=Yi(t)).sub?t.sub!==Zy&&(i(t)[t.sub]=e):n[t.main]=e),e},e.getClass=function(e,t,i){var r=n[e];if(r&&r[Zy]&&(r=t?r[t]:null),i&&!r)throw new Error(t?"Component "+e+"."+(t||"")+" not exists. Load it first.":e+".type should be specified.");return r},e.getClassesByMainType=function(e){e=Yi(e);var t=[],i=n[e.main];return i&&i[Zy]?d(i,function(e,n){n!==Zy&&t.push(e)}):t.push(i),t},e.hasClass=function(e){return e=Yi(e),!!n[e.main]},e.getAllClassMainTypes=function(){var e=[];return d(n,function(t,n){e.push(n)}),e},e.hasSubTypes=function(e){e=Yi(e);var t=n[e.main];return t&&t[Zy]},e.parseClassType=Yi,t.registerWhenExtend){var r=e.extend;r&&(e.extend=function(t){var n=r.call(this,t);return e.registerClass(n,t.type)})}return e}function en(e){return e>-ox&&e<ox}function nn(e){return e>ox||e<-ox}function on(e,t,n,i,r){var o=1-r;return o*o*(o*e+3*r*t)+r*r*(r*i+3*o*n)}function an(e,t,n,i,r){var o=1-r;return 3*(((t-e)*o+2*(n-t)*r)*o+(i-n)*r*r)}function rn(e,t,n,i,r,o){var a=i+3*(t-n)-e,s=3*(n-2*t+e),l=3*(t-e),c=e-r,u=s*s-3*a*l,d=s*l-9*a*c,h=l*l-3*s*c,p=0;if(en(u)&&en(d))en(s)?o[0]=0:(S=-l/s)>=0&&S<=1&&(o[p++]=S);else{var f=d*d-4*u*h;if(en(f)){var g=d/u,m=-g/2;(S=-s/a+g)>=0&&S<=1&&(o[p++]=S),m>=0&&m<=1&&(o[p++]=m)}else if(f>0){var v=rx(f),_=u*s+1.5*a*(-d+v),y=u*s+1.5*a*(-d-v);(S=(-s-((_=_<0?-ix(-_,lx):ix(_,lx))+(y=y<0?-ix(-y,lx):ix(y,lx))))/(3*a))>=0&&S<=1&&(o[p++]=S)}else{var x=(2*u*s-3*a*d)/(2*rx(u*u*u)),b=Math.acos(x)/3,w=rx(u),C=Math.cos(b),S=(-s-2*w*C)/(3*a),m=(-s+w*(C+sx*Math.sin(b)))/(3*a),T=(-s+w*(C-sx*Math.sin(b)))/(3*a);S>=0&&S<=1&&(o[p++]=S),m>=0&&m<=1&&(o[p++]=m),T>=0&&T<=1&&(o[p++]=T)}}return p}function sn(e,t,n,i,r){var o=6*n-12*t+6*e,a=9*t+3*i-3*e-9*n,s=3*t-3*e,l=0;if(en(a))nn(o)&&(d=-s/o)>=0&&d<=1&&(r[l++]=d);else{var c=o*o-4*a*s;if(en(c))r[0]=-o/(2*a);else if(c>0){var u=rx(c),d=(-o+u)/(2*a),h=(-o-u)/(2*a);d>=0&&d<=1&&(r[l++]=d),h>=0&&h<=1&&(r[l++]=h)}}return l}function ln(e,t,n,i,r,o){var a=(t-e)*r+e,s=(n-t)*r+t,l=(i-n)*r+n,c=(s-a)*r+a,u=(l-s)*r+s,d=(u-c)*r+c;o[0]=e,o[1]=a,o[2]=c,o[3]=d,o[4]=d,o[5]=u,o[6]=l,o[7]=i}function hn(e,t,n,i,r,o,a,s,l,c,u){var d,h,p,f,g,m=.005,v=1/0;cx[0]=l,cx[1]=c;for(var _=0;_<1;_+=.05)ux[0]=on(e,n,r,a,_),ux[1]=on(t,i,o,s,_),(f=h_(cx,ux))<v&&(d=_,v=f);v=1/0;for(var y=0;y<32&&!(m<ax);y++)h=d-m,p=d+m,ux[0]=on(e,n,r,a,h),ux[1]=on(t,i,o,s,h),f=h_(ux,cx),h>=0&&f<v?(d=h,v=f):(dx[0]=on(e,n,r,a,p),dx[1]=on(t,i,o,s,p),g=h_(dx,cx),p<=1&&g<v?(d=p,v=g):m*=.5);return u&&(u[0]=on(e,n,r,a,d),u[1]=on(t,i,o,s,d)),rx(v)}function un(e,t,n,i){var r=1-i;return r*(r*e+2*i*t)+i*i*n}function cn(e,t,n,i){return 2*((1-i)*(t-e)+i*(n-t))}function dn(e,t,n,i,r){var o=e-2*t+n,a=2*(t-e),s=e-i,l=0;if(en(o))nn(a)&&(d=-s/a)>=0&&d<=1&&(r[l++]=d);else{var c=a*a-4*o*s;if(en(c))(d=-a/(2*o))>=0&&d<=1&&(r[l++]=d);else if(c>0){var u=rx(c),d=(-a+u)/(2*o),h=(-a-u)/(2*o);d>=0&&d<=1&&(r[l++]=d),h>=0&&h<=1&&(r[l++]=h)}}return l}function fn(e,t,n){var i=e+n-2*t;return 0===i?.5:(e-t)/i}function pn(e,t,n,i,r){var o=(t-e)*i+e,a=(n-t)*i+t,s=(a-o)*i+o;r[0]=e,r[1]=o,r[2]=s,r[3]=s,r[4]=a,r[5]=n}function gn(e,t,n,i,r,o,a,s,l){var c,u=.005,d=1/0;cx[0]=a,cx[1]=s;for(var h=0;h<1;h+=.05)ux[0]=un(e,n,r,h),ux[1]=un(t,i,o,h),(m=h_(cx,ux))<d&&(c=h,d=m);d=1/0;for(var p=0;p<32&&!(u<ax);p++){var f=c-u,g=c+u;ux[0]=un(e,n,r,f),ux[1]=un(t,i,o,f);var m=h_(ux,cx);if(f>=0&&m<d)c=f,d=m;else{dx[0]=un(e,n,r,g),dx[1]=un(t,i,o,g);var v=h_(dx,cx);g<=1&&v<d?(c=g,d=v):u*=.5}}return l&&(l[0]=un(e,n,r,c),l[1]=un(t,i,o,c)),rx(d)}function mn(e,t,n){if(0!==e.length){var i,r=e[0],o=r[0],a=r[0],s=r[1],l=r[1];for(i=1;i<e.length;i++)r=e[i],o=hx(o,r[0]),a=px(a,r[0]),s=hx(s,r[1]),l=px(l,r[1]);t[0]=o,t[1]=s,n[0]=a,n[1]=l}}function vn(e,t,n,i,r,o){r[0]=hx(e,n),r[1]=hx(t,i),o[0]=px(e,n),o[1]=px(t,i)}function yn(e,t,n,i,r,o,a,s,l,c){var u,d=sn,h=on,p=d(e,n,r,a,xx);for(l[0]=1/0,l[1]=1/0,c[0]=-1/0,c[1]=-1/0,u=0;u<p;u++){var f=h(e,n,r,a,xx[u]);l[0]=hx(f,l[0]),c[0]=px(f,c[0])}for(p=d(t,i,o,s,bx),u=0;u<p;u++){var g=h(t,i,o,s,bx[u]);l[1]=hx(g,l[1]),c[1]=px(g,c[1])}l[0]=hx(e,l[0]),c[0]=px(e,c[0]),l[0]=hx(a,l[0]),c[0]=px(a,c[0]),l[1]=hx(t,l[1]),c[1]=px(t,c[1]),l[1]=hx(s,l[1]),c[1]=px(s,c[1])}function xn(e,t,n,i,r,o,a,s){var l=fn,c=un,u=px(hx(l(e,n,r),1),0),d=px(hx(l(t,i,o),1),0),h=c(e,n,r,u),p=c(t,i,o,d);a[0]=hx(e,r,h),a[1]=hx(t,o,p),s[0]=px(e,r,h),s[1]=px(t,o,p)}function _n(e,t,n,i,r,o,a,s,l){var c=K,u=J,d=Math.abs(r-o);if(d%mx<1e-4&&d>1e-4)return s[0]=e-n,s[1]=t-i,l[0]=e+n,void(l[1]=t+i);if(vx[0]=gx(r)*n+e,vx[1]=fx(r)*i+t,_x[0]=gx(o)*n+e,_x[1]=fx(o)*i+t,c(s,vx,_x),u(l,vx,_x),(r%=mx)<0&&(r+=mx),(o%=mx)<0&&(o+=mx),r>o&&!a?o+=mx:r<o&&a&&(r+=mx),a){var h=o;o=r,r=h}for(var p=0;p<o;p+=Math.PI/2)p>r&&(yx[0]=gx(p)*n+e,yx[1]=fx(p)*i+t,c(s,yx,s),u(l,yx,l))}function bn(e,t,n,i,r,o,a){if(0===r)return!1;var s=r,l=0,c=e;if(a>t+s&&a>i+s||a<t-s&&a<i-s||o>e+s&&o>n+s||o<e-s&&o<n-s)return!1;if(e===n)return Math.abs(o-e)<=s/2;var u=(l=(t-i)/(e-n))*o-a+(c=(e*i-n*t)/(e-n));return u*u/(l*l+1)<=s/2*s/2}function wn(e,t,n,i,r,o,a,s,l,c,u){if(0===l)return!1;var d=l;return!(u>t+d&&u>i+d&&u>o+d&&u>s+d||u<t-d&&u<i-d&&u<o-d&&u<s-d||c>e+d&&c>n+d&&c>r+d&&c>a+d||c<e-d&&c<n-d&&c<r-d&&c<a-d)&&hn(e,t,n,i,r,o,a,s,c,u,null)<=d/2}function Sn(e,t,n,i,r,o,a,s,l){if(0===a)return!1;var c=a;return!(l>t+c&&l>i+c&&l>o+c||l<t-c&&l<i-c&&l<o-c||s>e+c&&s>n+c&&s>r+c||s<e-c&&s<n-c&&s<r-c)&&gn(e,t,n,i,r,o,s,l,null)<=c/2}function Mn(e){return(e%=Ox)<0&&(e+=Ox),e}function In(e,t,n,i,r,o,a,s,l){if(0===a)return!1;var c=a;s-=e,l-=t;var u=Math.sqrt(s*s+l*l);if(u-c>n||u+c<n)return!1;if(Math.abs(i-r)%Rx<1e-4)return!0;if(o){var d=i;i=Mn(r),r=Mn(d)}else i=Mn(i),r=Mn(r);i>r&&(r+=Rx);var h=Math.atan2(l,s);return h<0&&(h+=Rx),h>=i&&h<=r||h+Rx>=i&&h+Rx<=r}function Tn(e,t,n,i,r,o){if(o>t&&o>i||o<t&&o<i)return 0;if(i===t)return 0;var a=i<t?1:-1,s=(o-t)/(i-t);return 1!==s&&0!==s||(a=i<t?.5:-.5),s*(n-e)+e>r?a:0}function An(e,t){return Math.abs(e-t)<Bx}function Cn(){var e=Vx[0];Vx[0]=Vx[1],Vx[1]=e}function Dn(e,t,n,i,r,o,a,s,l,c){if(c>t&&c>i&&c>o&&c>s||c<t&&c<i&&c<o&&c<s)return 0;var u=rn(t,i,o,s,c,Hx);if(0===u)return 0;for(var d,h,p=0,f=-1,g=0;g<u;g++){var m=Hx[g],v=0===m||1===m?.5:1;on(e,n,r,a,m)<l||(f<0&&(f=sn(t,i,o,s,Vx),Vx[1]<Vx[0]&&f>1&&Cn(),d=on(t,i,o,s,Vx[0]),f>1&&(h=on(t,i,o,s,Vx[1]))),2==f?m<Vx[0]?p+=d<t?v:-v:m<Vx[1]?p+=h<d?v:-v:p+=s<h?v:-v:m<Vx[0]?p+=d<t?v:-v:p+=s<d?v:-v)}return p}function Ln(e,t,n,i,r,o,a,s){if(s>t&&s>i&&s>o||s<t&&s<i&&s<o)return 0;var l=dn(t,i,o,s,Hx);if(0===l)return 0;var c=fn(t,i,o);if(c>=0&&c<=1){for(var u=0,d=un(t,i,o,c),h=0;h<l;h++)p=0===Hx[h]||1===Hx[h]?.5:1,(f=un(e,n,r,Hx[h]))<a||(Hx[h]<c?u+=d<t?p:-p:u+=o<d?p:-p);return u}var p=0===Hx[0]||1===Hx[0]?.5:1,f=un(e,n,r,Hx[0]);return f<a?0:o<t?p:-p}function kn(e,t,n,i,r,o,a,s){if((s-=t)>n||s<-n)return 0;c=Math.sqrt(n*n-s*s),Hx[0]=-c,Hx[1]=c;var l=Math.abs(i-r);if(l<1e-4)return 0;if(l%Fx<1e-4)return i=0,r=Fx,f=o?1:-1,a>=Hx[0]+e&&a<=Hx[1]+e?f:0;if(o){var c=i;i=Mn(r),r=Mn(c)}else i=Mn(i),r=Mn(r);i>r&&(r+=Fx);for(var u=0,d=0;d<2;d++){var h=Hx[d];if(h+e>a){var p=Math.atan2(s,h),f=o?1:-1;p<0&&(p=Fx+p),(p>=i&&p<=r||p+Fx>=i&&p+Fx<=r)&&(p>Math.PI/2&&p<1.5*Math.PI&&(f=-f),u+=f)}}return u}function Pn(e,t,n,i,r){for(var o=0,a=0,s=0,l=0,c=0,u=0;u<e.length;){var d=e[u++];switch(d===zx.M&&u>1&&(n||(o+=Tn(a,s,l,c,i,r))),1==u&&(l=a=e[u],c=s=e[u+1]),d){case zx.M:a=l=e[u++],s=c=e[u++];break;case zx.L:if(n){if(bn(a,s,e[u],e[u+1],t,i,r))return!0}else o+=Tn(a,s,e[u],e[u+1],i,r)||0;a=e[u++],s=e[u++];break;case zx.C:if(n){if(wn(a,s,e[u++],e[u++],e[u++],e[u++],e[u],e[u+1],t,i,r))return!0}else o+=Dn(a,s,e[u++],e[u++],e[u++],e[u++],e[u],e[u+1],i,r)||0;a=e[u++],s=e[u++];break;case zx.Q:if(n){if(Sn(a,s,e[u++],e[u++],e[u],e[u+1],t,i,r))return!0}else o+=Ln(a,s,e[u++],e[u++],e[u],e[u+1],i,r)||0;a=e[u++],s=e[u++];break;case zx.A:var h=e[u++],p=e[u++],f=e[u++],g=e[u++],m=e[u++],v=e[u++],_=(e[u++],1-e[u++]),y=Math.cos(m)*f+h,x=Math.sin(m)*g+p;u>1?o+=Tn(a,s,y,x,i,r):(l=y,c=x);var b=(i-h)*g/f+h;if(n){if(In(h,p,g,m,m+v,_,t,b,r))return!0}else o+=kn(h,p,g,m,m+v,_,b,r);a=Math.cos(m+v)*f+h,s=Math.sin(m+v)*g+p;break;case zx.R:l=a=e[u++],c=s=e[u++];var y=l+e[u++],x=c+e[u++];if(n){if(bn(l,c,y,c,t,i,r)||bn(y,c,y,x,t,i,r)||bn(y,x,l,x,t,i,r)||bn(l,x,l,c,t,i,r))return!0}else o+=Tn(y,c,y,x,i,r),o+=Tn(l,x,l,c,i,r);break;case zx.Z:if(n){if(bn(a,s,l,c,t,i,r))return!0}else o+=Tn(a,s,l,c,i,r);a=l,s=c}}return n||An(s,c)||(o+=Tn(a,s,l,c,i,r)||0),0!==o}function On(e,t,n){return Pn(e,0,!1,t,n)}function zn(e,t,n,i){return Pn(e,t,!0,n,i)}function Nn(e){je.call(this,e),this.path=null}function En(e,t,n,i,r,o,a,s,l,c,u){var d=l*(eb/180),h=Qx(d)*(e-n)/2+Jx(d)*(t-i)/2,p=-1*Jx(d)*(e-n)/2+Qx(d)*(t-i)/2,f=h*h/(a*a)+p*p/(s*s);f>1&&(a*=Kx(f),s*=Kx(f));var g=(r===o?-1:1)*Kx((a*a*(s*s)-a*a*(p*p)-s*s*(h*h))/(a*a*(p*p)+s*s*(h*h)))||0,m=g*a*p/s,v=g*-s*h/a,_=(e+n)/2+Qx(d)*m-Jx(d)*v,y=(t+i)/2+Jx(d)*m+Qx(d)*v,x=ib([1,0],[(h-m)/a,(p-v)/s]),b=[(h-m)/a,(p-v)/s],w=[(-1*h-m)/a,(-1*p-v)/s],C=ib(b,w);nb(b,w)<=-1&&(C=eb),nb(b,w)>=1&&(C=0),0===o&&C>0&&(C-=2*eb),1===o&&C<0&&(C+=2*eb),u.addData(c,_,y,a,s,x,C,d,o)}function Rn(e){if(!e)return[];var t,n=e.replace(/-/g," -").replace(/  /g," ").replace(/ /g,",").replace(/,,/g,",");for(t=0;t<Zx.length;t++)n=n.replace(new RegExp(Zx[t],"g"),"|"+Zx[t]);var i,r=n.split("|"),o=0,a=0,s=new Px,l=Px.CMD;for(t=1;t<r.length;t++){var c,u=r[t],d=u.charAt(0),h=0,p=u.slice(1).replace(/e,-/g,"e-").split(",");p.length>0&&""===p[0]&&p.shift();for(var f=0;f<p.length;f++)p[f]=parseFloat(p[f]);for(;h<p.length&&!isNaN(p[h])&&!isNaN(p[0]);){var g,m,v,_,y,x,b,w=o,C=a;switch(d){case"l":o+=p[h++],a+=p[h++],c=l.L,s.addData(c,o,a);break;case"L":o=p[h++],a=p[h++],c=l.L,s.addData(c,o,a);break;case"m":o+=p[h++],a+=p[h++],c=l.M,s.addData(c,o,a),d="l";break;case"M":o=p[h++],a=p[h++],c=l.M,s.addData(c,o,a),d="L";break;case"h":o+=p[h++],c=l.L,s.addData(c,o,a);break;case"H":o=p[h++],c=l.L,s.addData(c,o,a);break;case"v":a+=p[h++],c=l.L,s.addData(c,o,a);break;case"V":a=p[h++],c=l.L,s.addData(c,o,a);break;case"C":c=l.C,s.addData(c,p[h++],p[h++],p[h++],p[h++],p[h++],p[h++]),o=p[h-2],a=p[h-1];break;case"c":c=l.C,s.addData(c,p[h++]+o,p[h++]+a,p[h++]+o,p[h++]+a,p[h++]+o,p[h++]+a),o+=p[h-2],a+=p[h-1];break;case"S":g=o,m=a;var S=s.len(),T=s.data;i===l.C&&(g+=o-T[S-4],m+=a-T[S-3]),c=l.C,w=p[h++],C=p[h++],o=p[h++],a=p[h++],s.addData(c,g,m,w,C,o,a);break;case"s":g=o,m=a;var S=s.len(),T=s.data;i===l.C&&(g+=o-T[S-4],m+=a-T[S-3]),c=l.C,w=o+p[h++],C=a+p[h++],o+=p[h++],a+=p[h++],s.addData(c,g,m,w,C,o,a);break;case"Q":w=p[h++],C=p[h++],o=p[h++],a=p[h++],c=l.Q,s.addData(c,w,C,o,a);break;case"q":w=p[h++]+o,C=p[h++]+a,o+=p[h++],a+=p[h++],c=l.Q,s.addData(c,w,C,o,a);break;case"T":g=o,m=a;var S=s.len(),T=s.data;i===l.Q&&(g+=o-T[S-4],m+=a-T[S-3]),o=p[h++],a=p[h++],c=l.Q,s.addData(c,g,m,o,a);break;case"t":g=o,m=a;var S=s.len(),T=s.data;i===l.Q&&(g+=o-T[S-4],m+=a-T[S-3]),o+=p[h++],a+=p[h++],c=l.Q,s.addData(c,g,m,o,a);break;case"A":v=p[h++],_=p[h++],y=p[h++],x=p[h++],b=p[h++],En(w=o,C=a,o=p[h++],a=p[h++],x,b,v,_,y,c=l.A,s);break;case"a":v=p[h++],_=p[h++],y=p[h++],x=p[h++],b=p[h++],En(w=o,C=a,o+=p[h++],a+=p[h++],x,b,v,_,y,c=l.A,s)}}"z"!==d&&"Z"!==d||(c=l.Z,s.addData(c)),i=c}return s.toStatic(),s}function Vn(e,t){var n=Rn(e);return t=t||{},t.buildPath=function(e){if(e.setData)e.setData(n.data),(t=e.getContext())&&e.rebuildPath(t);else{var t=e;n.rebuildPath(t)}},t.applyTransform=function(e){Xx(n,e),this.dirty(!0)},t}function Bn(e,t){return new Nn(Vn(e,t))}function Gn(e,t){return Nn.extend(Vn(e,t))}function Wn(e,t,n,i,r,o,a){var s=.5*(n-e),l=.5*(i-t);return(2*(t-n)+s+l)*a+(-3*(t-n)-2*s-l)*o+s*r+t}function Hn(e,t,n){var i=t.points,r=t.smooth;if(i&&i.length>=2){if(r&&"spline"!==r){var o=db(i,r,n,t.smoothConstraint);e.moveTo(i[0][0],i[0][1]);for(var a=i.length,s=0;s<(n?a:a-1);s++){var l=o[2*s],c=o[2*s+1],u=i[(s+1)%a];e.bezierCurveTo(l[0],l[1],c[0],c[1],u[0],u[1])}}else{"spline"===r&&(i=ub(i,n)),e.moveTo(i[0][0],i[0][1]);for(var s=1,d=i.length;s<d;s++)e.lineTo(i[s][0],i[s][1])}n&&e.closePath()}}function Fn(e,t,n){var i=e.cpx2,r=e.cpy2;return null===i||null===r?[(n?an:on)(e.x1,e.cpx1,e.cpx2,e.x2,t),(n?an:on)(e.y1,e.cpy1,e.cpy2,e.y2,t)]:[(n?cn:un)(e.x1,e.cpx1,e.x2,t),(n?cn:un)(e.y1,e.cpy1,e.y2,t)]}function Zn(e){return Nn.extend(e)}function Un(e,t,n,i){var r=Bn(e,t),o=r.getBoundingRect();return n&&("center"===i&&(n=jn(n,o)),qn(r,n)),r}function Xn(e,t,n){var i=new qe({style:{image:e,x:t.x,y:t.y,width:t.width,height:t.height},onload:function(e){if("center"===n){var r={width:e.width,height:e.height};i.setStyle(jn(t,r))}}});return i}function jn(e,t){var n,i=t.width/t.height,r=e.height*i;return n=r<=e.width?e.height:(r=e.width)/i,{x:e.x+e.width/2-r/2,y:e.y+e.height/2-n/2,width:r,height:n}}function qn(e,t){if(e.applyTransform){var n=e.getBoundingRect().calculateTransform(t);e.applyTransform(n)}}function Yn(e){var t=e.shape,n=e.style.lineWidth;return Cb(2*t.x1)===Cb(2*t.x2)&&(t.x1=t.x2=Kn(t.x1,n,!0)),Cb(2*t.y1)===Cb(2*t.y2)&&(t.y1=t.y2=Kn(t.y1,n,!0)),e}function $n(e){var t=e.shape,n=e.style.lineWidth,i=t.x,r=t.y,o=t.width,a=t.height;return t.x=Kn(t.x,n,!0),t.y=Kn(t.y,n,!0),t.width=Math.max(Kn(i+o,n,!1)-t.x,0===o?0:1),t.height=Math.max(Kn(r+a,n,!1)-t.y,0===a?0:1),e}function Kn(e,t,n){var i=Cb(2*e);return(i+Cb(t))%2==0?i/2:(i+(n?1:-1))/2}function Jn(e){return null!=e&&"none"!=e}function Qn(e){return"string"==typeof e?At(e,-.1):e}function to(e){if(e.__hoverStlDirty){var t=e.style.stroke,n=e.style.fill,i=e.__hoverStl;i.fill=i.fill||(Jn(n)?Qn(n):null),i.stroke=i.stroke||(Jn(t)?Qn(t):null);var r={};for(var o in i)null!=i[o]&&(r[o]=e.style[o]);e.__normalStl=r,e.__hoverStlDirty=!1}}function eo(e){if(!e.__isHover){if(to(e),e.useHoverLayer)e.__zr&&e.__zr.addHover(e,e.__hoverStl);else{var t=e.style,n=t.insideRollbackOpt;n&&xo(t),t.extendFrom(e.__hoverStl),n&&(yo(t,t.insideOriginalTextPosition,n),null==t.textFill&&(t.textFill=n.autoColor)),e.dirty(!1),e.z2+=1}e.__isHover=!0}}function io(e){if(e.__isHover){var t=e.__normalStl;e.useHoverLayer?e.__zr&&e.__zr.removeHover(e):(t&&e.setStyle(t),e.z2-=1),e.__isHover=!1}}function no(e){"group"===e.type?e.traverse(function(e){"group"!==e.type&&eo(e)}):eo(e)}function oo(e){"group"===e.type?e.traverse(function(e){"group"!==e.type&&io(e)}):io(e)}function ao(e,t){e.__hoverStl=e.hoverStyle||t||{},e.__hoverStlDirty=!0,e.__isHover&&to(e)}function ro(e){this.__hoverSilentOnTouch&&e.zrByTouch||!this.__isEmphasis&&no(this)}function so(e){this.__hoverSilentOnTouch&&e.zrByTouch||!this.__isEmphasis&&oo(this)}function lo(){this.__isEmphasis=!0,no(this)}function ho(){this.__isEmphasis=!1,oo(this)}function uo(e,t,n){e.__hoverSilentOnTouch=n&&n.hoverSilentOnTouch,"group"===e.type?e.traverse(function(e){"group"!==e.type&&ao(e,t)}):ao(e,t),e.on("mouseover",ro).on("mouseout",so),e.on("emphasis",lo).on("normal",ho)}function co(e,t,n,i,r,o,a){var s=(r=r||Ab).labelFetcher,l=r.labelDataIndex,c=r.labelDimIndex,u=n.getShallow("show"),d=i.getShallow("show"),h=u||d?T(s?s.getFormattedLabel(l,"normal",null,c):null,r.defaultText):null,p=u?h:null,f=d?T(s?s.getFormattedLabel(l,"emphasis",null,c):null,h):null;null==p&&null==f||(fo(e,n,o,r),fo(t,i,a,r,!0)),e.text=p,t.text=f}function fo(e,t,n,i,r){return po(e,t,i,r),n&&a(e,n),e.host&&e.host.dirty&&e.host.dirty(!1),e}function po(e,t,n,i){if((n=n||Ab).isRectText){var r=t.getShallow("position")||(i?null:"inside");"outside"===r&&(r="top"),e.textPosition=r,e.textOffset=t.getShallow("offset");var o=t.getShallow("rotate");null!=o&&(o*=Math.PI/180),e.textRotation=o,e.textDistance=T(t.getShallow("distance"),i?null:5)}var a,s=t.ecModel,l=s&&s.option.textStyle,c=go(t);if(c){a={};for(var u in c)if(c.hasOwnProperty(u)){var d=t.getModel(["rich",u]);mo(a[u]={},d,l,n,i)}}return e.rich=a,mo(e,t,l,n,i,!0),n.forceRich&&!n.textStyle&&(n.textStyle={}),e}function go(e){for(var t;e&&e!==e.ecModel;){var n=(e.option||Ab).rich;if(n){t=t||{};for(var i in n)n.hasOwnProperty(i)&&(t[i]=1)}e=e.parentModel}return t}function mo(e,t,n,i,r,o){if(n=!r&&n||Ab,e.textFill=vo(t.getShallow("color"),i)||n.color,e.textStroke=vo(t.getShallow("textBorderColor"),i)||n.textBorderColor,e.textStrokeWidth=T(t.getShallow("textBorderWidth"),n.textBorderWidth),!r){if(o){var a=e.textPosition;e.insideRollback=yo(e,a,i),e.insideOriginalTextPosition=a,e.insideRollbackOpt=i}null==e.textFill&&(e.textFill=i.autoColor)}e.fontStyle=t.getShallow("fontStyle")||n.fontStyle,e.fontWeight=t.getShallow("fontWeight")||n.fontWeight,e.fontSize=t.getShallow("fontSize")||n.fontSize,e.fontFamily=t.getShallow("fontFamily")||n.fontFamily,e.textAlign=t.getShallow("align"),e.textVerticalAlign=t.getShallow("verticalAlign")||t.getShallow("baseline"),e.textLineHeight=t.getShallow("lineHeight"),e.textWidth=t.getShallow("width"),e.textHeight=t.getShallow("height"),e.textTag=t.getShallow("tag"),o&&i.disableBox||(e.textBackgroundColor=vo(t.getShallow("backgroundColor"),i),e.textPadding=t.getShallow("padding"),e.textBorderColor=vo(t.getShallow("borderColor"),i),e.textBorderWidth=t.getShallow("borderWidth"),e.textBorderRadius=t.getShallow("borderRadius"),e.textBoxShadowColor=t.getShallow("shadowColor"),e.textBoxShadowBlur=t.getShallow("shadowBlur"),e.textBoxShadowOffsetX=t.getShallow("shadowOffsetX"),e.textBoxShadowOffsetY=t.getShallow("shadowOffsetY")),e.textShadowColor=t.getShallow("textShadowColor")||n.textShadowColor,e.textShadowBlur=t.getShallow("textShadowBlur")||n.textShadowBlur,e.textShadowOffsetX=t.getShallow("textShadowOffsetX")||n.textShadowOffsetX,e.textShadowOffsetY=t.getShallow("textShadowOffsetY")||n.textShadowOffsetY}function vo(e,t){return"auto"!==e?e:t&&t.autoColor?t.autoColor:null}function yo(e,t,n){var i,r=n.useInsideStyle;return null==e.textFill&&!1!==r&&(!0===r||n.isRectText&&t&&"string"==typeof t&&t.indexOf("inside")>=0)&&(i={textFill:null,textStroke:e.textStroke,textStrokeWidth:e.textStrokeWidth},e.textFill="#fff",null==e.textStroke&&(e.textStroke=n.autoColor,null==e.textStrokeWidth&&(e.textStrokeWidth=2))),i}function xo(e){var t=e.insideRollback;t&&(e.textFill=t.textFill,e.textStroke=t.textStroke,e.textStrokeWidth=t.textStrokeWidth)}function _o(e,t){var n=t||t.getModel("textStyle");return[e.fontStyle||n&&n.getShallow("fontStyle")||"",e.fontWeight||n&&n.getShallow("fontWeight")||"",(e.fontSize||n&&n.getShallow("fontSize")||12)+"px",e.fontFamily||n&&n.getShallow("fontFamily")||"sans-serif"].join(" ")}function bo(e,t,n,i,r,o){if("function"==typeof r&&(o=r,r=null),i&&i.isAnimationEnabled()){var a=e?"Update":"",s=i.getShallow("animationDuration"+a),l=i.getShallow("animationEasing"+a),c=i.getShallow("animationDelay"+a);"function"==typeof c&&(c=c(r,i.getAnimationDelayParams?i.getAnimationDelayParams(t,r):null)),"function"==typeof s&&(s=s(r)),s>0?t.animateTo(n,s,c||0,l,o,!!o):(t.stopAnimation(),t.attr(n),o&&o())}else t.stopAnimation(),t.attr(n),o&&o()}function wo(e,t,n,i,r){bo(!0,e,t,n,i,r)}function So(e,t,n,i,r){bo(!1,e,t,n,i,r)}function Mo(e,t){for(var n=at([]);e&&e!==t;)st(n,e.getLocalTransform(),n),e=e.parent;return n}function Io(e,t,n){return t&&!c(t)&&(t=C_.getLocalTransform(t)),n&&(t=ct([],t)),$([],e,t)}function To(e,t,n){var i=0===t[4]||0===t[5]||0===t[0]?1:Math.abs(2*t[4]/t[0]),r=0===t[4]||0===t[5]||0===t[2]?1:Math.abs(2*t[4]/t[2]),o=["left"===e?-i:"right"===e?i:0,"top"===e?-r:"bottom"===e?r:0];return o=Io(o,t,n),Math.abs(o[0])>Math.abs(o[1])?o[0]>0?"right":"left":o[1]>0?"bottom":"top"}function Ao(e,t,n,i){function o(e){var t={position:V(e.position),rotation:e.rotation};return e.shape&&(t.shape=a({},e.shape)),t}if(e&&t){var r=function(e){var t={};return e.traverse(function(e){!e.isGroup&&e.anid&&(t[e.anid]=e)}),t}(e);t.traverse(function(e){if(!e.isGroup&&e.anid){var t=r[e.anid];if(t){var i=o(e);e.attr(o(t)),wo(e,i,n,e.dataIndex)}}})}}function Co(e,t){return f(e,function(e){var n=e[0];n=Sb(n,t.x),n=Tb(n,t.x+t.width);var i=e[1];return i=Sb(i,t.y),i=Tb(i,t.y+t.height),[n,i]})}function Do(e,t,n){var i=(t=a({rectHover:!0},t)).style={strokeNoScale:!0};if(n=n||{x:-1,y:-1,width:2,height:2},e)return 0===e.indexOf("image://")?(i.image=e.slice(8),r(i,n),new qe(t)):Un(e.replace("path://",""),t,n,"center")}function Lo(e,t,n){this.parentModel=t,this.ecModel=n,this.option=e}function ko(e,t,n){for(var i=0;i<t.length&&(!t[i]||null!=(e=e&&"object"==typeof e?e[t[i]]:null));i++);return null==e&&n&&(e=n.get(t)),e}function Po(e,t){var n=ji(e,"getParent");return n?n.call(e,t):e.parentModel}function Oo(e){return e instanceof Array?e:null==e?[]:[e]}function zo(e,t){if(e)for(var n=e.emphasis=e.emphasis||{},i=e.normal=e.normal||{},r=0,o=t.length;r<o;r++){var a=t[r];!n.hasOwnProperty(a)&&i.hasOwnProperty(a)&&(n[a]=i[a])}}function No(e){return e&&(null==e.value?e:e.value)}function Eo(e){return Ob(e)&&!(e instanceof Array)}function Ro(e,t){var n=t&&t.type;return"ordinal"===n?e:("time"===n&&"number"!=typeof e&&null!=e&&"-"!==e&&(e=+Pi(e)),null==e||""===e?NaN:+e)}function Vo(e,t){t=(t||[]).slice();var n=f(e||[],function(e,t){return{exist:e}});return Pb(t,function(e,i){if(Ob(e)){for(r=0;r<n.length;r++)if(!n[r].option&&null!=e.id&&n[r].exist.id===e.id+"")return n[r].option=e,void(t[i]=null);for(var r=0;r<n.length;r++){var o=n[r].exist;if(!(n[r].option||null!=o.id&&null!=e.id||null==e.name||Go(e)||Go(o)||o.name!==e.name+""))return n[r].option=e,void(t[i]=null)}}}),Pb(t,function(e,t){if(Ob(e)){for(var i=0;i<n.length;i++){var r=n[i].exist;if(!n[i].option&&!Go(r)&&null==e.id){n[i].option=e;break}}i>=n.length&&n.push({option:e})}}),n}function Bo(e){var t=z();Pb(e,function(e,n){var i=e.exist;i&&t.set(i.id,e)}),Pb(e,function(e,n){var i=e.option;L(!i||null==i.id||!t.get(i.id)||t.get(i.id)===e,"id duplicates: "+(i&&i.id)),i&&null!=i.id&&t.set(i.id,e),!e.keyInfo&&(e.keyInfo={})}),Pb(e,function(e,n){var i=e.exist,r=e.option,o=e.keyInfo;if(Ob(r)){if(o.name=null!=r.name?r.name+"":i?i.name:"\0-",i)o.id=i.id;else if(null!=r.id)o.id=r.id+"";else{var a=0;do{o.id="\0"+o.name+"\0"+a++}while(t.get(o.id))}t.set(o.id,e)}})}function Go(e){return Ob(e)&&e.id&&0===(e.id+"").indexOf("\0_ec_\0")}function Wo(e,t){function i(e,t,n){for(var i=0,r=e.length;i<r;i++)for(var o=e[i].seriesId,a=Oo(e[i].dataIndex),s=n&&n[o],l=0,c=a.length;l<c;l++){var u=a[l];s&&s[u]?s[u]=null:(t[o]||(t[o]={}))[u]=1}}function n(e,t){var i=[];for(var r in e)if(e.hasOwnProperty(r)&&null!=e[r])if(t)i.push(+r);else{var o=n(e[r],!0);o.length&&i.push({seriesId:r,dataIndex:o})}return i}var r={},o={};return i(e||[],r),i(t||[],o,r),[n(r),n(o)]}function Ho(e,t){return null!=t.dataIndexInside?t.dataIndexInside:null!=t.dataIndex?y(t.dataIndex)?f(t.dataIndex,function(t){return e.indexOfRawIndex(t)}):e.indexOfRawIndex(t.dataIndex):null!=t.name?y(t.name)?f(t.name,function(t){return e.indexOfName(t)}):e.indexOfName(t.name):void 0}function Fo(e,t,n){if(_(t)){var i={};i[t+"Index"]=0,t=i}var r=n&&n.defaultMainType;!r||jo(t,r+"Index")||jo(t,r+"Id")||jo(t,r+"Name")||(t[r+"Index"]=0);var o={};return Pb(t,function(i,r){var i=t[r];if("dataIndex"!==r&&"dataIndexInside"!==r){var a=r.match(/^(\w+)(Index|Id|Name)$/)||[],s=a[1],c=(a[2]||"").toLowerCase();if(!(!s||!c||null==i||"index"===c&&"none"===i||n&&n.includeMainTypes&&l(n.includeMainTypes,s)<0)){var u={mainType:s};"index"===c&&"all"===i||(u[c]=i);var d=e.queryComponents(u);o[s+"Models"]=d,o[s+"Model"]=d[0]}}else o[r]=i}),o}function Zo(e,t){var n=e.dimensions;t=e.getDimension(t);for(var i=0;i<n.length;i++){var r=e.getDimensionInfo(n[i]);if(r.name===t)return r.coordDim}}function Uo(e,t){var n=[];return Pb(e.dimensions,function(i){var r=e.getDimensionInfo(i);r.coordDim===t&&(n[r.coordDimIndex]=r.name)}),n}function Xo(e,t){var n=[];return Pb(e.dimensions,function(i){var r=e.getDimensionInfo(i),o=r.otherDims[t];null!=o&&!1!==o&&(n[o]=r.name)}),n}function jo(e,t){return e&&e.hasOwnProperty(t)}function qo(e){return[e||"",Bb++,Math.random()].join(Hb)}function Yo(e,t,n,i,r){var o=0,a=0;null==i&&(i=1/0),null==r&&(r=1/0);var s=0;t.eachChild(function(l,c){var u,d,h=l.position,p=l.getBoundingRect(),f=t.childAt(c+1),g=f&&f.getBoundingRect();if("horizontal"===e){var m=p.width+(g?-g.x+p.x:0);(u=o+m)>i||l.newline?(o=0,u=m,a+=s+n,s=p.height):s=Math.max(s,p.height)}else{var v=p.height+(g?-g.y+p.y:0);(d=a+v)>r||l.newline?(o+=s+n,a=0,d=v,s=p.width):s=Math.max(s,p.width)}l.newline||(h[0]=o,h[1]=a,"horizontal"===e?o=u+n:a=d+n)})}function $o(e,t,n){var i=t.width,r=t.height,o=Si(e.x,i),a=Si(e.y,r),s=Si(e.x2,i),l=Si(e.y2,r);return(isNaN(o)||isNaN(parseFloat(e.x)))&&(o=0),(isNaN(s)||isNaN(parseFloat(e.x2)))&&(s=i),(isNaN(a)||isNaN(parseFloat(e.y)))&&(a=0),(isNaN(l)||isNaN(parseFloat(e.y2)))&&(l=r),n=Wy(n||0),{width:Math.max(s-o-n[1]-n[3],0),height:Math.max(l-a-n[0]-n[2],0)}}function Ko(e,t,n){n=Wy(n||0);var i=t.width,r=t.height,o=Si(e.left,i),a=Si(e.top,r),s=Si(e.right,i),l=Si(e.bottom,r),c=Si(e.width,i),u=Si(e.height,r),d=n[2]+n[0],h=n[1]+n[3],p=e.aspect;switch(isNaN(c)&&(c=i-s-h-o),isNaN(u)&&(u=r-l-d-a),null!=p&&(isNaN(c)&&isNaN(u)&&(p>i/r?c=.8*i:u=.8*r),isNaN(c)&&(c=p*u),isNaN(u)&&(u=c/p)),isNaN(o)&&(o=i-s-c-h),isNaN(a)&&(a=r-l-u-d),e.left||e.right){case"center":o=i/2-c/2-n[3];break;case"right":o=i-c-h}switch(e.top||e.bottom){case"middle":case"center":a=r/2-u/2-n[0];break;case"bottom":a=r-u-d}o=o||0,a=a||0,isNaN(c)&&(c=i-h-o-(s||0)),isNaN(u)&&(u=r-d-a-(l||0));var f=new jt(o+n[3],a+n[0],c,u);return f.margin=n,f}function Jo(e,t,n,i,o){var a=!o||!o.hv||o.hv[0],s=!o||!o.hv||o.hv[1],l=o&&o.boundingMode||"all";if(a||s){var c;if("raw"===l)c="group"===e.type?new jt(0,0,+t.width||0,+t.height||0):e.getBoundingRect();else if(c=e.getBoundingRect(),e.needLocalTransform()){var u=e.getLocalTransform();(c=c.clone()).applyTransform(u)}t=Ko(r({width:c.width,height:c.height},t),n,i);var d=e.position,h=a?t.x-c.x:0,p=s?t.y-c.y:0;e.attr("position","raw"===l?[h,p]:[d[0]+h,d[1]+p])}}function Qo(e,t){return null!=e[Ub[t][0]]||null!=e[Ub[t][1]]&&null!=e[Ub[t][2]]}function ta(e,t,i){function n(n,i){var r={},l=0,c={},u=0;if(Vb(n,function(t){c[t]=e[t]}),Vb(n,function(e){o(t,e)&&(r[e]=c[e]=t[e]),a(r,e)&&l++,a(c,e)&&u++}),s[i])return a(t,n[1])?c[n[2]]=null:a(t,n[2])&&(c[n[1]]=null),c;if(2!==u&&l){if(l>=2)return r;for(var d=0;d<n.length;d++){var h=n[d];if(!o(r,h)&&o(e,h)){r[h]=e[h];break}}return r}return c}function o(e,t){return e.hasOwnProperty(t)}function a(e,t){return null!=e[t]&&"auto"!==e[t]}function r(e,t,n){Vb(e,function(e){t[e]=n[e]})}!b(i)&&(i={});var s=i.ignoreSize;!y(s)&&(s=[s,s]);var l=n(Ub[0],0),c=n(Ub[1],1);r(Ub[0],e,l),r(Ub[1],e,c)}function ea(e){return ia({},e)}function ia(e,t){return t&&e&&Vb(Wb,function(n){t.hasOwnProperty(n)&&(e[n]=t[n])}),e}function na(e,t){d(t,function(t,r){jb.hasClass(r)||("object"==typeof t?e[r]=e[r]?n(e[r],t,!1):i(t):null==e[r]&&(e[r]=t))})}function oa(e){e=e,this.option={},this.option[iw]=1,this._componentsMap=z({series:[]}),this._seriesIndices=null,na(e,this._theme.option),n(e,Xb,!1),this.mergeOption(e)}function aa(e,t){y(t)||(t=t?[t]:[]);var n={};return Kb(t,function(t){n[t]=(e.get(t)||[]).slice()}),n}function ra(e,t,n){return t.type?t.type:n?n.subType:jb.determineSubType(e,t)}function sa(e){return Qb(e,function(e){return e.componentIndex})||[]}function la(e,t){return t.hasOwnProperty("subType")?Jb(e,function(e){return e.subType===t.subType}):e}function ha(e){d(ow,function(t){this[t]=m(e[t],e)},this)}function ua(){this._coordinateSystems=[]}function ca(e){this._api=e,this._timelineOptions=[],this._mediaList=[],this._mediaDefault,this._currentMediaIndices=[],this._optionBackup,this._newBaseOption}function da(e,t,n){var i,r,o=[],a=[],s=e.timeline;if(e.baseOption&&(r=e.baseOption),(s||e.options)&&(r=r||{},o=(e.options||[]).slice()),e.media){r=r||{};var l=e.media;sw(l,function(e){e&&e.option&&(e.query?a.push(e):i||(i=e))})}return r||(r=e),r.timeline||(r.timeline=s),sw([r].concat(o).concat(f(a,function(e){return e.option})),function(e){sw(t,function(t){t(e,n)})}),{baseOption:r,timelineOptions:o,mediaDefault:i,mediaList:a}}function fa(e,t,n){var i={width:t,height:n,aspectratio:t/n},r=!0;return d(e,function(e,t){var n=t.match(dw);if(n&&n[1]&&n[2]){var o=n[1],a=n[2].toLowerCase();pa(i[a],e,o)||(r=!1)}}),r}function pa(e,t,n){return"min"===n?e>=t:"max"===n?e<=t:e===t}function ga(e,t){return e.join(",")===t.join(",")}function ma(e,t){sw(t=t||{},function(t,n){if(null!=t){var i=e[n];if(jb.hasClass(n)){t=Oo(t);var r=Vo(i=Oo(i),t);e[n]=cw(r,function(e){return e.option&&e.exist?uw(e.exist,e.option,!0):e.exist||e.option})}else e[n]=uw(i,t,!0)}})}function va(e){var t=e&&e.itemStyle;if(t)for(var i=0,r=fw.length;i<r;i++){var o=fw[i],a=t.normal,s=t.emphasis;a&&a[o]&&(e[o]=e[o]||{},e[o].normal?n(e[o].normal,a[o]):e[o].normal=a[o],a[o]=null),s&&s[o]&&(e[o]=e[o]||{},e[o].emphasis?n(e[o].emphasis,s[o]):e[o].emphasis=s[o],s[o]=null)}}function ya(e,t){var n=pw(e)&&e[t],i=pw(n)&&n.textStyle;if(i)for(var r=0,o=Rb.length;r<o;r++){var t=Rb[r];i.hasOwnProperty(t)&&(n[t]=i[t])}}function xa(e){pw(e)&&(ya(e,"normal"),ya(e,"emphasis"))}function _a(e){if(pw(e)){va(e),xa(e.label),xa(e.upperLabel),xa(e.edgeLabel);var t=e.markPoint;va(t),xa(t&&t.label);var n=e.markLine;va(e.markLine),xa(n&&n.label);var i=e.markArea;xa(i&&i.label),ya(e,"axisLabel"),ya(e,"title"),ya(e,"detail");var r=e.data;if(r)for(a=0;a<r.length;a++)va(r[a]),xa(r[a]&&r[a].label);if((t=e.markPoint)&&t.data)for(var o=t.data,a=0;a<o.length;a++)va(o[a]),xa(o[a]&&o[a].label);if((n=e.markLine)&&n.data)for(var s=n.data,a=0;a<s.length;a++)y(s[a])?(va(s[a][0]),xa(s[a][0]&&s[a][0].label),va(s[a][1]),xa(s[a][1]&&s[a][1].label)):(va(s[a]),xa(s[a]&&s[a].label))}}function ba(e){return y(e)?e:e?[e]:[]}function wa(e){return(y(e)?e[0]:e)||{}}function Sa(e,t){t=t.split(",");for(var n=e,i=0;i<t.length&&null!=(n=n&&n[t[i]]);i++);return n}function Ma(e,t,n,i){t=t.split(",");for(var r,o=e,a=0;a<t.length-1;a++)null==o[r=t[a]]&&(o[r]={}),o=o[r];(i||null==o[t[a]])&&(o[t[a]]=n)}function Ia(e){d(mw,function(t){t[0]in e&&!(t[1]in e)&&(e[t[1]]=e[t[0]])})}function Ta(){this.group=new X_,this.uid=qo("viewChart")}function Aa(e,t){if(e&&(e.trigger(t),"group"===e.type))for(var n=0;n<e.childCount();n++)Aa(e.childAt(n),t)}function Ca(e,t,n){var i=Ho(e,t);null!=i?d(Oo(i),function(t){Aa(e.getItemGraphicEl(t),n)}):e.eachItemGraphicEl(function(e){Aa(e,n)})}function Da(e,t,i){function n(){u=(new Date).getTime(),d=null,e.apply(a,s||[])}var r,o,a,s,l,c=0,u=0,d=null;t=t||0;var h=function(){r=(new Date).getTime(),a=this,s=arguments;var e=l||t,h=l||i;l=null,o=r-(h?c:u)-e,clearTimeout(d),h?d=setTimeout(n,e):o>=0?n():d=setTimeout(n,-o),c=r};return h.clear=function(){d&&(clearTimeout(d),d=null)},h.debounceNextCall=function(e){l=e},h}function La(e,t,n,i){var r=e[t];if(r){var o=r[Sw]||r,a=r[Aw];if(r[Tw]!==n||a!==i){if(null==n||!i)return e[t]=o;(r=e[t]=Da(o,n,"debounce"===i))[Sw]=o,r[Aw]=i,r[Tw]=n}return r}}function ka(e,t){var n=e[t];n&&n[Sw]&&(e[t]=n[Sw])}function Pa(e){return function(t,n,i){t=t&&t.toLowerCase(),g_.prototype[e].call(this,t,n,i)}}function Oa(){g_.call(this)}function za(e,t,n){function o(e,t){return e.prio-t.prio}n=n||{},"string"==typeof t&&(t=jw[t]),this.id,this.group,this._dom=e;var r=this._zr=yi(e,{renderer:n.renderer||"canvas",devicePixelRatio:n.devicePixelRatio,width:n.width,height:n.height});this._throttledZrFlush=Da(m(r.flush,r),17),(t=i(t))&&yw(t,!0),this._theme=t,this._chartsViews=[],this._chartsMap={},this._componentsViews=[],this._componentsMap={},this._coordSysMgr=new ua,this._api=$a(this),g_.call(this),this._messageCenter=new Oa,this._initEvents(),this.resize=m(this.resize,this),this._pendingActions=[],ee(qw,o),ee(Uw,o),r.animation.on("frame",this._onframe,this),k(this)}function Na(e,t,n){var i,r=this._model,o=this._coordSysMgr.getCoordinateSystems();t=Fo(r,t);for(var a=0;a<o.length;a++){var s=o[a];if(s[e]&&null!=(i=s[e](r,t,n)))return i}}function Ea(e,t,n,i,r){function a(i){i&&i.__alive&&i[t]&&i[t](i.__model,o,e._api,n)}var o=e._model;if(i){var s={};s[i+"Id"]=n[i+"Id"],s[i+"Index"]=n[i+"Index"],s[i+"Name"]=n[i+"Name"];var l={mainType:i,query:s};r&&(l.subType=r),o&&o.eachComponent(l,function(t,n){a(e["series"===i?"_chartsMap":"_componentsMap"][t.__viewId])},e)}else Ew(e._componentsViews.concat(e._chartsViews),a)}function Ra(e,t){var n=e.type,i=e.escapeConnect,o=Vw[n],s=o.actionInfo,l=(s.update||"update").split(":"),c=l.pop();l=null!=l[0]&&Iw(l[0]),this[Ow]=!0;var u=[e],d=!1;e.batch&&(d=!0,u=f(e.batch,function(t){return t=r(a({},t),e),t.batch=null,t}));var h,p=[],g="highlight"===n||"downplay"===n;Ew(u,function(e){h=o.action(e,this._model,this._api),(h=h||a({},e)).type=s.event||h.type,p.push(h),g?Ea(this,c,e,"series"):l&&Ea(this,c,e,l.main,l.sub)},this),"none"===c||g||l||(this[Rw]?(Bw.prepareAndUpdate.call(this,e),this[Rw]=!1):Bw[c].call(this,e)),h=d?{type:s.event||n,escapeConnect:i,batch:p}:p[0],this[Ow]=!1,!t&&this._messageCenter.trigger(h.type,h)}function Va(e){for(var t=this._pendingActions;t.length;){var n=t.shift();Ra.call(this,n,e)}}function Ba(e){!e&&this.trigger("updated")}function Ga(e,t,n){var i=this._api;Ew(this._componentsViews,function(r){var o=r.__model;r[e](o,t,i,n),Ya(o,r)},this),t.eachSeries(function(r,o){var a=this._chartsMap[r.__viewId];a[e](r,t,i,n),Ya(r,a),qa(r,a)},this),ja(this._zr,t),Ew(Gw,function(e){e(t,i)})}function Wa(e,t){for(var n="component"===e,i=n?this._componentsViews:this._chartsViews,r=n?this._componentsMap:this._chartsMap,o=this._zr,a=0;a<i.length;a++)i[a].__alive=!1;for(t[n?"eachComponent":"eachSeries"](function(e,a){if(n){if("series"===e)return}else a=e;var s="_ec_"+a.id+"_"+a.type,l=r[s];if(!l){var c=Iw(a.type),u=n?bw.getClass(c.main,c.sub):Ta.getClass(c.sub);if(!u)return;(l=new u).init(t,this._api),r[s]=l,i.push(l),o.add(l.group)}a.__viewId=l.__id=s,l.__alive=!0,l.__model=a,l.group.__ecComponentInfo={mainType:a.mainType,index:a.componentIndex}},this),a=0;a<i.length;){var s=i[a];s.__alive?a++:(o.remove(s.group),s.dispose(t,this._api),i.splice(a,1),delete r[s.__id],s.__id=s.group.__ecComponentInfo=null)}}function Ha(e,t){Ew(Uw,function(n){n.func(e,t)})}function Fa(e){var t={};e.eachSeries(function(e){var n=e.get("stack"),i=e.getData();if(n&&"list"===i.type){var r=t[n];t.hasOwnProperty(n)&&r&&(i.stackedOn=r),t[n]=i}})}function Za(e,t){var n=this._api;Ew(qw,function(i){i.isLayout&&i.func(e,n,t)})}function Ua(e,t,n){var i=this._api;e.clearColorPalette(),e.eachSeries(function(e){e.clearColorPalette()}),Ew(qw,function(r){(!n||!r.isLayout)&&r.func(e,i,t)})}function Xa(e,t){var n=this._api;Ew(this._componentsViews,function(i){var r=i.__model;i.render(r,e,n,t),Ya(r,i)},this),Ew(this._chartsViews,function(e){e.__alive=!1},this),e.eachSeries(function(i,r){var o=this._chartsMap[i.__viewId];o.__alive=!0,o.render(i,e,n,t),o.group.silent=!!i.get("silent"),Ya(i,o),qa(i,o)},this),ja(this._zr,e),Ew(this._chartsViews,function(t){t.__alive||t.remove(e,n)},this)}function ja(e,t){var n=e.storage,i=0;n.traverse(function(e){e.isGroup||i++}),i>t.get("hoverLayerThreshold")&&!jv.node&&n.traverse(function(e){e.isGroup||(e.useHoverLayer=!0)})}function qa(e,t){var n=0;t.group.traverse(function(e){"group"===e.type||e.ignore||n++});var i=+e.get("progressive"),r=n>e.get("progressiveThreshold")&&i&&!jv.node;r&&t.group.traverse(function(e){e.isGroup||(e.progressive=r?Math.floor(n++/i):-1,r&&e.stopAnimation(!0))});var o=e.get("blendMode")||null;t.group.traverse(function(e){e.isGroup||e.setStyle("blend",o)})}function Ya(e,t){var n=e.get("z"),i=e.get("zlevel");t.group.traverse(function(e){"group"!==e.type&&(null!=n&&(e.z=n),null!=i&&(e.zlevel=i))})}function $a(e){var t=e._coordSysMgr;return a(new ha(e),{getCoordinateSystems:m(t.getCoordinateSystems,t),getComponentByElement:function(t){for(;t;){var n=t.__ecComponentInfo;if(null!=n)return e._model.getComponent(n.mainType,n.index);t=t.parent}}})}function Ka(t){function e(e,t){for(var i=0;i<e.length;i++)e[i][n]=t}var n="__connectUpdateStatus";d(Ww,function(i,r){t._messageCenter.on(r,function(i){if(Zw[t.group]&&0!==t[n]){if(i&&i.escapeConnect)return;var r=t.makeActionFromEvent(i),o=[];d(Xw,function(e){e!==t&&e.group===t.group&&o.push(e)}),e(o,0),Ew(o,function(e){1!==e[n]&&e.dispatchAction(r)}),e(o,2)}})})}function Ja(e){Zw[e]=!1}function Qa(e){var t;return t=e.getAttribute?e.getAttribute(Qw):e[Qw],Xw[t]}function tr(e){$w.push(e)}function er(e,t){"function"==typeof e&&(t=e,e=kw),Uw.push({prio:e,func:t})}function ir(e,t,n){"function"==typeof t&&(n=t,t="");var i=b(e)?e.type:[e,e={event:t}][0];e.event=(e.event||i).toLowerCase(),t=e.event,L(zw.test(i)&&zw.test(t)),Vw[i]||(Vw[i]={action:n,actionInfo:e}),Ww[t]=i}function nr(e,t){ua.register(e,t)}function or(e,t){"function"==typeof e&&(t=e,e=Lw),qw.push({prio:e,func:t,isLayout:!0})}function ar(e,t){"function"==typeof e&&(t=e,e=Nw),qw.push({prio:e,func:t})}function rr(e,t){Yw[e]=t}function sr(e){return jb.extend(e)}function lr(e){return bw.extend(e)}function hr(e){return xw.extend(e)}function ur(e){return Ta.extend(e)}function cr(e){return eC[e]}function dr(e){return e}function fr(e,t,n,i,r){this._old=e,this._new=t,this._oldKeyGetter=n||dr,this._newKeyGetter=i||dr,this.context=r}function pr(e,t,n,i,r){for(var o=0;o<e.length;o++){var a="_ec_"+r[i](e[o],o),s=t[a];null==s?(n.push(a),t[a]=o):(s.length||(t[a]=s=[s]),s.push(o))}}function gr(e,t){d(aC.concat(t.__wrappedMethods||[]),function(n){t.hasOwnProperty(n)&&(e[n]=t[n])}),e.__wrappedMethods=t.__wrappedMethods}function mr(e){this._array=e||[]}function vr(e){return y(e)||(e=[e]),e}function yr(e,t){var n=e.dimensions,i=new sC(f(n,e.getDimensionInfo,e),e.hostModel);gr(i,e);for(var r=i._storage={},o=e._storage,a=0;a<n.length;a++){var s=n[a],c=o[s];l(t,s)>=0?r[s]=new c.constructor(o[s].length):r[s]=o[s]}return i}function xr(e,t,n){function o(e,t,n){pC[t]?e.otherDims[t]=n:(e.coordDim=t,e.coordDimIndex=n,c.set(t,!0))}function a(e,t,n){if(n||null!=t.get(e)){for(var i=0;null!=t.get(e+i);)i++;e+=i}return t.set(e,!0),e}t=t||[],n=n||{},e=(e||[]).slice();var r=(n.dimsDef||[]).slice(),s=z(n.encodeDef),l=z(),c=z(),u=[],d=n.dimCount;if(null==d){var h=_r(t[0]);d=Math.max(y(h)&&h.length||1,e.length,r.length),uC(e,function(e){var t=e.dimsDef;t&&(d=Math.max(d,t.length))})}for(var p=0;p<d;p++){var f=dC(r[p])?{name:r[p]}:r[p]||{},g=f.name,m=u[p]={otherDims:{}};null!=g&&null==l.get(g)&&(m.name=m.tooltipName=g,l.set(g,p)),null!=f.type&&(m.type=f.type)}s.each(function(e,t){e=s.set(t,Oo(e).slice()),uC(e,function(n,i){dC(n)&&(n=l.get(n)),null!=n&&n<d&&(e[i]=n,o(u[n],t,i))})});var v=0;uC(e,function(e,t){var n,e,r,a;dC(e)?(n=e,e={}):(n=e.name,e=i(e),r=e.dimsDef,a=e.otherDims,e.name=e.coordDim=e.coordDimIndex=e.dimsDef=e.otherDims=null);var l=Oo(s.get(n));if(!l.length)for(var c=0;c<(r&&r.length||1);c++){for(;v<u.length&&null!=u[v].coordDim;)v++;v<u.length&&l.push(v++)}uC(l,function(t,i){var s=u[t];o(hC(s,e),n,i),null==s.name&&r&&(s.name=s.tooltipName=r[i]),a&&hC(s.otherDims,a)})});for(var _=n.extraPrefix||"value",x=0;x<d;x++)null==(m=u[x]=u[x]||{}).coordDim&&(m.coordDim=a(_,c,n.extraFromZero),m.coordDimIndex=0,m.isExtraCoord=!0),null==m.name&&(m.name=a(m.coordDim,l)),null==m.type&&fC(t,x)&&(m.type="ordinal");return u}function _r(e){return y(e)?e:b(e)?e.value:e}function br(e){for(var t=0;t<e.length&&null==e[t];)t++;return e[t]}function wr(e){var t=br(e);return null!=t&&!y(No(t))}function Sr(e,t,n){e=e||[];var i=t.get("coordinateSystem"),r=gC[i],o=ua.get(i),a={encodeDef:t.get("encode"),dimsDef:t.get("dimensions")},s=r&&r(e,t,n,a),c=s&&s.dimensions;c||(c=o&&(o.getDimensionsInfo?o.getDimensionsInfo():o.dimensions.slice())||["x","y"],c=xr(c,e,a));var u=s?s.categoryIndex:-1,d=new sC(c,t),h=Tr(s,e),p={},f=u>=0&&wr(e)?function(e,t,n,i){return Eo(e)&&(d.hasItemOption=!0),i===u?n:Ro(No(e),c[i])}:function(e,t,n,i){var r=No(e),o=Ro(r&&r[i],c[i]);Eo(e)&&(d.hasItemOption=!0);var a=s&&s.categoryAxesModels;return a&&a[t]&&"string"==typeof o&&(p[t]=p[t]||a[t].getCategories(),(o=l(p[t],o))<0&&!isNaN(o)&&(o=+o)),o};return d.hasItemOption=!1,d.initData(e,h,f),d}function Mr(e){return"category"!==e&&"time"!==e}function Ir(e){return"category"===e?"ordinal":"time"===e?"time":"float"}function Tr(e,t){var n,i=[],r=e&&e.dimensions[e.categoryIndex];if(r&&(n=e.categoryAxesModels[r.name]),n){var o=n.getCategories();if(o){var a=t.length;if(y(t[0])&&t[0].length>1){i=[];for(var s=0;s<a;s++)i[s]=o[t[s][e.categoryIndex||0]]}else i=o.slice(0)}}return i}function Ar(e){this._setting=e||{},this._extent=[1/0,-1/0],this._interval=0,this.init&&this.init.apply(this,arguments)}function Cr(e,t,n,i){var r={},o=e[1]-e[0],a=r.interval=Ni(o/t,!0);null!=n&&a<n&&(a=r.interval=n),null!=i&&a>i&&(a=r.interval=i);var s=r.intervalPrecision=Dr(a);return kr(r.niceTickExtent=[_C(Math.ceil(e[0]/a)*a,s),_C(Math.floor(e[1]/a)*a,s)],e),r}function Dr(e){return Ai(e)+2}function Lr(e,t,n){e[t]=Math.max(Math.min(e[t],n[1]),n[0])}function kr(e,t){!isFinite(e[0])&&(e[0]=t[0]),!isFinite(e[1])&&(e[1]=t[1]),Lr(e,0,t),Lr(e,1,t),e[0]>e[1]&&(e[0]=e[1])}function Pr(e,t,n,i){var r=[];if(!e)return r;t[0]<n[0]&&r.push(t[0]);for(var o=n[0];o<=n[1]&&(r.push(o),(o=_C(o+e,i))!==r[r.length-1]);)if(r.length>1e4)return[];return t[1]>(r.length?r[r.length-1]:n[1])&&r.push(t[1]),r}function Or(e,t){return DC(e,IC(t))}function zr(e,t){var n,i,r,o=e.type,a=t.getMin(),s=t.getMax(),l=null!=a,c=null!=s,u=e.getExtent();return"ordinal"===o?n=(t.get("data")||[]).length:(y(i=t.get("boundaryGap"))||(i=[i||0,i||0]),"boolean"==typeof i[0]&&(i=[0,0]),i[0]=Si(i[0],1),i[1]=Si(i[1],1),r=u[1]-u[0]||Math.abs(u[0])),null==a&&(a="ordinal"===o?n?0:NaN:u[0]-i[0]*r),null==s&&(s="ordinal"===o?n?n-1:NaN:u[1]+i[1]*r),"dataMin"===a?a=u[0]:"function"==typeof a&&(a=a({min:u[0],max:u[1]})),"dataMax"===s?s=u[1]:"function"==typeof s&&(s=s({min:u[0],max:u[1]})),(null==a||!isFinite(a))&&(a=NaN),(null==s||!isFinite(s))&&(s=NaN),e.setBlank(M(a)||M(s)),t.getNeedCrossZero()&&(a>0&&s>0&&!l&&(a=0),a<0&&s<0&&!c&&(s=0)),[a,s]}function Nr(e,t){var n=zr(e,t),i=null!=t.getMin(),r=null!=t.getMax(),o=t.get("splitNumber");"log"===e.type&&(e.base=t.get("logBase"));var a=e.type;e.setExtent(n[0],n[1]),e.niceExtent({splitNumber:o,fixMin:i,fixMax:r,minInterval:"interval"===a||"time"===a?t.get("minInterval"):null,maxInterval:"interval"===a||"time"===a?t.get("maxInterval"):null});var s=t.get("interval");null!=s&&e.setInterval&&e.setInterval(s)}function Er(e,t){if(t=t||e.get("type"))switch(t){case"category":return new vC(e.getCategories(),[1/0,-1/0]);case"value":return new xC;default:return(Ar.getClass(t)||xC).create(e)}}function Rr(e,t,n,i,r){var o,a=0,s=0,l=(i-r)/180*Math.PI,c=1;t.length>40&&(c=Math.floor(t.length/40));for(var u=0;u<e.length;u+=c){var d=e[u],h=de(t[u],n,"center","top");h.x+=d*Math.cos(l),h.y+=d*Math.sin(l),h.width*=1.3,h.height*=1.3,o?o.intersect(h)?(s++,a=Math.max(a,s)):(o.union(h),s=0):o=h.clone()}return 0===a&&c>1?c:(a+1)*c-1}function Vr(e,t){var n=e.scale,i=n.getTicksLabels(),r=n.getTicks();return"string"==typeof t?(t=function(e){return function(t){return e.replace("{value}",null!=t?t:"")}}(t),f(i,t)):"function"==typeof t?f(r,function(n,i){return t(Br(e,n),i)},this):i}function Br(e,t){return"category"===e.type?e.scale.getLabel(t):t}function Gr(e){return b(e)&&null!=e.value?e.value:e+""}function Wr(e,t){if("image"!==this.type){var n=this.style,i=this.shape;i&&"line"===i.symbolType?n.stroke=e:this.__isEmptyBrush?(n.stroke=e,n.fill=t||"#fff"):(n.fill&&(n.fill=e),n.stroke&&(n.stroke=e)),this.dirty(!1)}}function Hr(e,t,n,i,r,o,a){var s=0===e.indexOf("empty");s&&(e=e.substr(5,1).toLowerCase()+e.substr(6));var l;return l=0===e.indexOf("image://")?Xn(e.slice(8),new jt(t,n,i,r),a?"center":"cover"):0===e.indexOf("path://")?Un(e.slice(7),{},new jt(t,n,i,r),a?"center":"cover"):new UC({shape:{symbolType:e,x:t,y:n,width:i,height:r}}),l.__isEmptyBrush=s,l.setColor=Wr,l.setColor(o),l}function Fr(e,t){var n=(e[1]-e[0])/t/2;e[0]+=n,e[1]-=n}function Zr(e,t){return Math.abs(e-t)<YC}function Ur(e,t,n){var i=0,r=e[0];if(!r)return!1;for(var o=1;o<e.length;o++){var a=e[o];i+=Tn(r[0],r[1],a[0],a[1],t,n),r=a}var s=e[0];return Zr(r[0],s[0])&&Zr(r[1],s[1])||(i+=Tn(r[0],r[1],s[0],s[1],t,n)),0!==i}function Xr(e,t,n){if(this.name=e,this.geometries=t,n)n=[n[0],n[1]];else{var i=this.getBoundingRect();n=[i.x+i.width/2,i.y+i.height/2]}this.center=n}function jr(e){if(!e.UTF8Encoding)return e;var t=e.UTF8Scale;null==t&&(t=1024);for(var n=e.features,i=0;i<n.length;i++)for(var r=n[i].geometry,o=r.coordinates,a=r.encodeOffsets,s=0;s<o.length;s++){var l=o[s];if("Polygon"===r.type)o[s]=qr(l,a[s],t);else if("MultiPolygon"===r.type)for(var c=0;c<l.length;c++){var u=l[c];l[c]=qr(u,a[s][c],t)}}return e.UTF8Encoding=!1,e}function qr(e,t,n){for(var i=[],r=t[0],o=t[1],a=0;a<e.length;a+=2){var s=e.charCodeAt(a)-64,l=e.charCodeAt(a+1)-64;s=s>>1^-(1&s),l=l>>1^-(1&l),r=s+=r,o=l+=o,i.push([s/n,l/n])}return i}function Yr(e){var t,n=Xo(e,"label");if(n.length)t=n[0];else for(var i,r=e.dimensions.slice();r.length&&(t=r.pop(),"ordinal"===(i=e.getDimensionInfo(t).type)||"time"===i););return t}function $r(e,t){var n=e.getItemVisual(t,"symbolSize");return n instanceof Array?n.slice():[+n,+n]}function Kr(e){return[e[0]/2,e[1]/2]}function Jr(e,t,n){X_.call(this),this.updateData(e,t,n)}function Qr(e,t){this.parent.drift(e,t)}function ts(e){this.group=new X_,this._symbolCtor=e||Jr}function es(e,t,n){var i=e.getItemLayout(t);return i&&!isNaN(i[0])&&!isNaN(i[1])&&!(n&&n(t))&&"none"!==e.getItemVisual(t,"symbol")}function is(e){return e>=0?1:-1}function ns(e,t,n){for(var i,r=e.getBaseAxis(),o=e.getOtherAxis(r),a=r.onZero?0:o.scale.getExtent()[0],s=o.dim,l="x"===s||"radius"===s?1:0,c=t.stackedOn,u=t.get(s,n);c&&is(c.get(s,n))===is(u);){i=c;break}var d=[];return d[l]=t.get(r.dim,n),d[1-l]=i?i.get(s,n,!0):a,e.dataToPoint(d)}function os(e,t){var n=[];return t.diff(e).add(function(e){n.push({cmd:"+",idx:e})}).update(function(e,t){n.push({cmd:"=",idx:t,idx1:e})}).remove(function(e){n.push({cmd:"-",idx:e})}).execute(),n}function as(e){return isNaN(e[0])||isNaN(e[1])}function rs(e,t,n,i,r,o,a,s,l,c,u){for(var d=0,h=n,p=0;p<i;p++){var f=t[h];if(h>=r||h<0)break;if(as(f)){if(u){h+=o;continue}break}if(h===n)e[o>0?"moveTo":"lineTo"](f[0],f[1]),sS(cS,f);else if(l>0){var g=h+o,m=t[g];if(u)for(;m&&as(t[g]);)m=t[g+=o];var v=.5,_=t[d];if(!(m=t[g])||as(m))sS(uS,f);else{as(m)&&!u&&(m=f),H(lS,m,_);var y,x;if("x"===c||"y"===c){var b="x"===c?0:1;y=Math.abs(f[b]-_[b]),x=Math.abs(f[b]-m[b])}else y=d_(f,_),x=d_(f,m);aS(uS,f,lS,-l*(1-(v=x/(x+y))))}rS(cS,cS,s),oS(cS,cS,a),rS(uS,uS,s),oS(uS,uS,a),e.bezierCurveTo(cS[0],cS[1],uS[0],uS[1],f[0],f[1]),aS(cS,f,lS,l*v)}else e.lineTo(f[0],f[1]);d=h,h+=o}return p}function ss(e,t){var n=[1/0,1/0],i=[-1/0,-1/0];if(t)for(var r=0;r<e.length;r++){var o=e[r];o[0]<n[0]&&(n[0]=o[0]),o[1]<n[1]&&(n[1]=o[1]),o[0]>i[0]&&(i[0]=o[0]),o[1]>i[1]&&(i[1]=o[1])}return{min:t?n:i,max:t?i:n}}function ls(e,t){if(e.length===t.length){for(var n=0;n<e.length;n++){var i=e[n],r=t[n];if(i[0]!==r[0]||i[1]!==r[1])return}return!0}}function hs(e){return"number"==typeof e?e:e?.3:0}function us(e){var t=e.getGlobalExtent();if(e.onBand){var n=e.getBandWidth()/2-1,i=t[1]>t[0]?1:-1;t[0]+=i*n,t[1]-=i*n}return t}function cs(e){return e>=0?1:-1}function ds(e,t){var n=e.getBaseAxis(),i=e.getOtherAxis(n),r=0;if(!n.onZero){var o=i.scale.getExtent();o[0]>0?r=o[0]:o[1]<0&&(r=o[1])}var a=i.dim,s="x"===a||"radius"===a?1:0;return t.mapArray([a],function(i,o){for(var l,c=t.stackedOn;c&&cs(c.get(a,o))===cs(i);){l=c;break}var u=[];return u[s]=t.get(n.dim,o),u[1-s]=l?l.get(a,o,!0):r,e.dataToPoint(u)},!0)}function fs(e,t,n){var i=us(e.getAxis("x")),r=us(e.getAxis("y")),o=e.getBaseAxis().isHorizontal(),a=Math.min(i[0],i[1]),s=Math.min(r[0],r[1]),l=Math.max(i[0],i[1])-a,c=Math.max(r[0],r[1])-s,u=n.get("lineStyle.normal.width")||2,d=n.get("clipOverflow")?u/2:Math.max(l,c);o?(s-=d,c+=2*d):(a-=d,l+=2*d);var h=new fb({shape:{x:a,y:s,width:l,height:c}});return t&&(h.shape[o?"width":"height"]=0,So(h,{shape:{width:l,height:c}},n)),h}function ps(e,t,n){var i=e.getAngleAxis(),r=e.getRadiusAxis().getExtent(),o=i.getExtent(),a=Math.PI/180,s=new lb({shape:{cx:e.cx,cy:e.cy,r0:r[0],r:r[1],startAngle:-o[0]*a,endAngle:-o[1]*a,clockwise:i.inverse}});return t&&(s.shape.endAngle=-o[0]*a,So(s,{shape:{endAngle:-o[1]*a}},n)),s}function gs(e,t,n){return"polar"===e.type?ps(e,t,n):fs(e,t,n)}function ms(e,t,n){for(var i=t.getBaseAxis(),r="x"===i.dim||"radius"===i.dim?0:1,o=[],a=0;a<e.length-1;a++){var s=e[a+1],l=e[a];o.push(l);var c=[];switch(n){case"end":c[r]=s[r],c[1-r]=l[1-r],o.push(c);break;case"middle":var u=(l[r]+s[r])/2,d=[];c[r]=d[r]=u,c[1-r]=l[1-r],d[1-r]=s[1-r],o.push(c),o.push(d);break;default:c[r]=l[r],c[1-r]=s[1-r],o.push(c)}}return e[a]&&o.push(e[a]),o}function vs(e,t){var n=e.getVisual("visualMeta");if(n&&n.length&&e.count()){for(var i,r=n.length-1;r>=0;r--)if(n[r].dimension<2){i=n[r];break}if(i&&"cartesian2d"===t.type){var o=i.dimension,a=e.dimensions[o],s=t.getAxis(a),l=f(i.stops,function(e){return{coord:s.toGlobalCoord(s.dataToCoord(e.value)),color:e.color}}),c=l.length,u=i.outerColors.slice();c&&l[0].coord>l[c-1].coord&&(l.reverse(),u.reverse());var h=l[0].coord-10,p=l[c-1].coord+10,g=p-h;if(g<.001)return"transparent";d(l,function(e){e.offset=(e.coord-h)/g}),l.push({offset:c?l[c-1].offset:.5,color:u[1]||"transparent"}),l.unshift({offset:c?l[0].offset:.5,color:u[0]||"transparent"});var m=new bb(0,0,0,0,l,!0);return m[a]=h,m[a+"2"]=p,m}}}function ys(e){return this._axes[e]}function xs(e){vS.call(this,e)}function _s(e,t){return t.type||(t.data?"category":"value")}function bs(e,t,n){return e.getCoordSysModel()===t}function ws(e,t){var n=t*Math.PI/180,i=e.plain(),r=i.width,o=i.height,a=r*Math.cos(n)+o*Math.sin(n),s=r*Math.sin(n)+o*Math.cos(n);return new jt(i.x,i.y,a,s)}function Ss(e){var t,n=e.model,i=n.getFormattedLabels(),r=n.getModel("axisLabel"),o=1,a=i.length;a>40&&(o=Math.ceil(a/40));for(var s=0;s<a;s+=o)if(!e.isLabelIgnored(s)){var l=ws(r.getTextRect(i[s]),r.get("rotate")||0);t?t.union(l):t=l}return t}function Ms(e,t,n){this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this._initCartesian(e,t,n),this.model=e}function Is(e,t,n){var i=e[t];if(n.onZero){var r=n.onZeroAxisIndex;if(null==r){for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];if(a&&!Ts(a)){r=+o;break}}null==r&&(n.onZero=!1),n.onZeroAxisIndex=r}else(a=i[r])&&Ts(a)&&(n.onZero=!1)}}function Ts(e){return"category"===e.type||"time"===e.type||!AS(e)}function As(e,t){var n=e.getExtent(),i=n[0]+n[1];e.toGlobalCoord="x"===e.dim?function(e){return e+t}:function(e){return i-e+t},e.toLocalCoord="x"===e.dim?function(e){return e-t}:function(e){return i-e+t}}function Cs(e,t){return f(IS,function(t){return e.getReferringComponents(t)[0]})}function Ds(e){return"cartesian2d"===e.get("coordinateSystem")}function Ls(e){var t={componentType:e.mainType};return t[e.mainType+"Index"]=e.componentIndex,t}function ks(e,t,n,i){var r,o,a=Li(n-e.rotation),s=i[0]>i[1],l="start"===t&&!s||"start"!==t&&s;return ki(a-DS/2)?(o=l?"bottom":"top",r="center"):ki(a-1.5*DS)?(o=l?"top":"bottom",r="center"):(o="middle",r=a<1.5*DS&&a>DS/2?l?"left":"right":l?"right":"left"),{rotation:a,textAlign:r,textVerticalAlign:o}}function Ps(e){var t=e.get("tooltip");return e.get("silent")||!(e.get("triggerEvent")||t&&t.show)}function Os(e,t,n){var i=e.get("axisLabel.showMinLabel"),r=e.get("axisLabel.showMaxLabel");t=t||[],n=n||[];var o=t[0],a=t[1],s=t[t.length-1],l=t[t.length-2],c=n[0],u=n[1],d=n[n.length-1],h=n[n.length-2];!1===i?(zs(o),zs(c)):Ns(o,a)&&(i?(zs(a),zs(u)):(zs(o),zs(c))),!1===r?(zs(s),zs(d)):Ns(l,s)&&(r?(zs(l),zs(h)):(zs(s),zs(d)))}function zs(e){e&&(e.ignore=!0)}function Ns(e,t,n){var i=e&&e.getBoundingRect().clone(),r=t&&t.getBoundingRect().clone();if(i&&r){var o=at([]);return ht(o,o,-e.rotation),i.applyTransform(st([],o,e.getLocalTransform())),r.applyTransform(st([],o,t.getLocalTransform())),i.intersect(r)}}function Es(e){return"middle"===e||"center"===e}function Rs(e,t,n){var i=t.axis;if(t.get("axisTick.show")&&!i.scale.isBlank()){for(var o=t.getModel("axisTick"),a=o.getModel("lineStyle"),s=o.get("length"),l=OS(o,n.labelInterval),c=i.getTicksCoords(o.get("alignWithLabel")),u=i.scale.getTicks(),d=t.get("axisLabel.showMinLabel"),h=t.get("axisLabel.showMaxLabel"),p=[],f=[],g=e._transform,m=[],v=c.length,_=0;_<v;_++)if(!PS(i,_,l,v,d,h)){var y=c[_];p[0]=y,p[1]=0,f[0]=y,f[1]=n.tickDirection*s,g&&($(p,p,g),$(f,f,g));var x=new gb(Yn({anid:"tick_"+u[_],shape:{x1:p[0],y1:p[1],x2:f[0],y2:f[1]},style:r(a.getLineStyle(),{stroke:t.get("axisLine.lineStyle.color")}),z2:2,silent:!0}));e.group.add(x),m.push(x)}return m}}function Vs(e,t,n){var i=t.axis;if(I(n.axisLabelShow,t.get("axisLabel.show"))&&!i.scale.isBlank()){var r=t.getModel("axisLabel"),o=r.get("margin"),a=i.scale.getTicks(),s=t.getFormattedLabels(),l=(I(n.labelRotate,r.get("rotate"))||0)*DS/180,c=NS(n.rotation,l,n.labelDirection),u=t.get("data"),h=[],p=Ps(t),f=t.get("triggerEvent"),g=t.get("axisLabel.showMinLabel"),m=t.get("axisLabel.showMaxLabel");return d(a,function(l,d){if(!PS(i,d,n.labelInterval,a.length,g,m)){var v=r;u&&u[l]&&u[l].textStyle&&(v=new Lo(u[l].textStyle,r,t.ecModel));var _=v.getTextColor()||t.get("axisLine.lineStyle.color"),y=[i.dataToCoord(l),n.labelOffset+n.labelDirection*o],x=i.scale.getLabel(l),b=new rb({anid:"label_"+l,position:y,rotation:c.rotation,silent:p,z2:10});fo(b.style,v,{text:s[d],textAlign:v.getShallow("align",!0)||c.textAlign,textVerticalAlign:v.getShallow("verticalAlign",!0)||v.getShallow("baseline",!0)||c.textVerticalAlign,textFill:"function"==typeof _?_("category"===i.type?x:"value"===i.type?l+"":l,d):_}),f&&(b.eventData=Ls(t),b.eventData.targetType="axisLabel",b.eventData.value=x),e._dumbGroup.add(b),b.updateTransform(),h.push(b),e.group.add(b),b.decomposeTransform()}}),h}}function Bs(e,t){var n={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return Gs(n,e,t),n.seriesInvolved&&Hs(n,e),n}function Gs(e,t,n){var i=t.getComponent("tooltip"),r=t.getComponent("axisPointer"),o=r.get("link",!0)||[],a=[];RS(n.getCoordinateSystems(),function(n){function s(i,s,l){var d=l.model.getModel("axisPointer",r),h=d.get("show");if(h&&("auto"!==h||i||qs(d))){null==s&&(s=d.get("triggerTooltip"));var p=(d=i?Ws(l,u,r,t,i,s):d).get("snap"),f=Ys(l.model),g=s||p||"category"===l.type,m=e.axesInfo[f]={key:f,axis:l,coordSys:n,axisPointerModel:d,triggerTooltip:s,involveSeries:g,snap:p,useHandle:qs(d),seriesModels:[]};c[f]=m,e.seriesInvolved|=g;var v=Fs(o,l);if(null!=v){var _=a[v]||(a[v]={axesInfo:{}});_.axesInfo[f]=m,_.mapper=o[v].mapper,m.linkGroup=_}}}if(n.axisPointerEnabled){var l=Ys(n.model),c=e.coordSysAxesInfo[l]={};e.coordSysMap[l]=n;var u=n.model.getModel("tooltip",i);if(RS(n.getAxes(),zS(s,!1,null)),n.getTooltipAxes&&i&&u.get("show")){var d="axis"===u.get("trigger"),h="cross"===u.get("axisPointer.type"),p=n.getTooltipAxes(u.get("axisPointer.axis"));(d||h)&&RS(p.baseAxes,zS(s,!h||"cross",d)),h&&RS(p.otherAxes,zS(s,"cross",!1))}}})}function Ws(e,t,n,o,a,s){var l=t.getModel("axisPointer"),c={};RS(["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],function(e){c[e]=i(l.get(e))}),c.snap="category"!==e.type&&!!s,"cross"===l.get("type")&&(c.type="line");var u=c.label||(c.label={});if(null==u.show&&(u.show=!1),"cross"===a&&(u.show=!0,!s)){var d=c.lineStyle=l.get("crossStyle");d&&r(u,d.textStyle)}return e.model.getModel("axisPointer",new Lo(c,n,o))}function Hs(e,t){t.eachSeries(function(t){var n=t.coordinateSystem,i=t.get("tooltip.trigger",!0),r=t.get("tooltip.show",!0);n&&"none"!==i&&!1!==i&&"item"!==i&&!1!==r&&!1!==t.get("axisPointer.show",!0)&&RS(e.coordSysAxesInfo[Ys(n.model)],function(e){var i=e.axis;n.getAxis(i.dim)===i&&(e.seriesModels.push(t),null==e.seriesDataCount&&(e.seriesDataCount=0),e.seriesDataCount+=t.getData().count())})},this)}function Fs(e,t){for(var n=t.model,i=t.dim,r=0;r<e.length;r++){var o=e[r]||{};if(Zs(o[i+"AxisId"],n.id)||Zs(o[i+"AxisIndex"],n.componentIndex)||Zs(o[i+"AxisName"],n.name))return r}}function Zs(e,t){return"all"===e||y(e)&&l(e,t)>=0||e===t}function Us(e){var t=Xs(e);if(t){var n=t.axisPointerModel,i=t.axis.scale,r=n.option,o=n.get("status"),a=n.get("value");null!=a&&(a=i.parse(a));var s=qs(n);null==o&&(r.status=s?"show":"hide");var l=i.getExtent().slice();l[0]>l[1]&&l.reverse(),(null==a||a>l[1])&&(a=l[1]),a<l[0]&&(a=l[0]),r.value=a,s&&(r.status=t.axis.scale.isBlank()?"hide":"show")}}function Xs(e){var t=(e.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return t&&t.axesInfo[Ys(e)]}function js(e){var t=Xs(e);return t&&t.axisPointerModel}function qs(e){return!!e.get("handle.show")}function Ys(e){return e.type+"||"+e.id}function $s(e,t,n,i,r,o){var a=FS.getAxisPointerClass(e.axisPointerClass);if(a){var s=js(t);s?(e._axisPointer||(e._axisPointer=new a)).render(t,s,i,o):Ks(e,i)}}function Ks(e,t,n){var i=e._axisPointer;i&&i.dispose(t,n),e._axisPointer=null}function Js(e,t,n){n=n||{};var i=e.coordinateSystem,r=t.axis,o={},a=r.position,s=r.onZero?"onZero":a,l=r.dim,c=i.getRect(),u=[c.x,c.x+c.width,c.y,c.y+c.height],d={left:0,right:1,top:0,bottom:1,onZero:2},h=t.get("offset")||0,p="x"===l?[u[2]-h,u[3]+h]:[u[0]-h,u[1]+h];if(r.onZero){var f=i.getAxis("x"===l?"y":"x",r.onZeroAxisIndex),g=f.toGlobalCoord(f.dataToCoord(0));p[d.onZero]=Math.max(Math.min(g,p[1]),p[0])}o.position=["y"===l?p[d[s]]:u[0],"x"===l?p[d[s]]:u[3]],o.rotation=Math.PI/2*("x"===l?0:1);var m={top:-1,bottom:1,left:-1,right:1};o.labelDirection=o.tickDirection=o.nameDirection=m[a],o.labelOffset=r.onZero?p[d[a]]-p[d.onZero]:0,t.get("axisTick.inside")&&(o.tickDirection=-o.tickDirection),I(n.labelInside,t.get("axisLabel.inside"))&&(o.labelDirection=-o.labelDirection);var v=t.get("axisLabel.rotate");return o.labelRotate="top"===s?-v:v,o.labelInterval=r.getLabelInterval(),o.z2=1,o}function Qs(e){return e.get("stack")||GS+e.seriesIndex}function tl(e){return e.dim+e.index}function el(e,t){return il(f(e,function(e){var t=e.getData(),n=e.coordinateSystem.getBaseAxis(),i=n.getExtent(),r="category"===n.type?n.getBandWidth():Math.abs(i[1]-i[0])/t.count();return{bandWidth:r,barWidth:Si(e.get("barWidth"),r),barMaxWidth:Si(e.get("barMaxWidth"),r),barGap:e.get("barGap"),barCategoryGap:e.get("barCategoryGap"),axisKey:tl(n),stackId:Qs(e)}}),t)}function il(e,t){var n={};d(e,function(e,t){var i=e.axisKey,r=e.bandWidth,o=n[i]||{bandWidth:r,remainedWidth:r,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},a=o.stacks;n[i]=o;var s=e.stackId;a[s]||o.autoWidthCount++,a[s]=a[s]||{width:0,maxWidth:0};var l=e.barWidth;l&&!a[s].width&&(a[s].width=l,l=Math.min(o.remainedWidth,l),o.remainedWidth-=l);var c=e.barMaxWidth;c&&(a[s].maxWidth=c);var u=e.barGap;null!=u&&(o.gap=u);var d=e.barCategoryGap;null!=d&&(o.categoryGap=d)});var i={};return d(n,function(e,t){i[t]={};var n=e.stacks,r=e.bandWidth,o=Si(e.categoryGap,r),a=Si(e.gap,1),s=e.remainedWidth,l=e.autoWidthCount,c=(s-o)/(l+(l-1)*a);c=Math.max(c,0),d(n,function(e,t){var n=e.maxWidth;n&&n<c&&(n=Math.min(n,s),e.width&&(n=Math.min(n,e.width)),s-=n,e.width=n,l--)}),c=(s-o)/(l+(l-1)*a),c=Math.max(c,0);var u,h=0;d(n,function(e,t){e.width||(e.width=c),u=e,h+=e.width*(1+a)}),u&&(h-=u.width*a);var p=-h/2;d(n,function(e,n){i[t][n]=i[t][n]||{offset:p,width:e.width},p+=e.width*(1+a)})}),i}function nl(e,t,n){var i=el(g(t.getSeriesByType(e),function(e){return!t.isSeriesFiltered(e)&&e.coordinateSystem&&"cartesian2d"===e.coordinateSystem.type})),r={},o={};t.eachSeriesByType(e,function(e){if("cartesian2d"===e.coordinateSystem.type){var t=e.getData(),n=e.coordinateSystem,a=n.getBaseAxis(),s=Qs(e),l=i[tl(a)][s],c=l.offset,u=l.width,d=n.getOtherAxis(a),h=e.get("barMinHeight")||0,p=a.onZero?d.toGlobalCoord(d.dataToCoord(0)):d.getGlobalExtent()[0],f=[e.coordDimToDataDim("x")[0],e.coordDimToDataDim("y")[0]],g=t.mapArray(f,function(e,t){return n.dataToPoint([e,t])},!0);r[s]=r[s]||[],o[s]=o[s]||[],t.setLayout({offset:c,size:u}),t.each(e.coordDimToDataDim(d.dim)[0],function(e,n){if(!isNaN(e)){r[s][n]||(r[s][n]={p:p,n:p},o[s][n]={p:p,n:p});var i,a,l,f,m=e>=0?"p":"n",v=g[n],_=r[s][n][m],y=o[s][n][m];d.isHorizontal()?(i=_,a=v[1]+c,l=v[0]-y,f=u,o[s][n][m]+=l,Math.abs(l)<h&&(l=(l<0?-1:1)*h),r[s][n][m]+=l):(i=v[0]+c,a=_,l=u,f=v[1]-y,o[s][n][m]+=f,Math.abs(f)<h&&(f=(f<=0?-1:1)*h),r[s][n][m]+=f),t.setItemLayout(n,{x:i,y:a,width:l,height:f})}},!0)}},this)}function ol(e,t,n,i,r,o,a){co(e,t,n.getModel("label.normal"),n.getModel("label.emphasis"),{labelFetcher:r,labelDataIndex:o,defaultText:r.getRawValue(o),isRectText:!0,autoColor:i}),al(e),al(t)}function al(e,t){"outside"===e.textPosition&&(e.textPosition=t)}function rl(e,t,n){n.style.text=null,wo(n,{shape:{width:0}},t,e,function(){n.parent&&n.parent.remove(n)})}function sl(e,t,n){n.style.text=null,wo(n,{shape:{r:n.shape.r0}},t,e,function(){n.parent&&n.parent.remove(n)})}function ll(e,t,n,i,o,a,s,l){var c=t.getItemVisual(n,"color"),u=t.getItemVisual(n,"opacity"),d=i.getModel("itemStyle.normal"),h=i.getModel("itemStyle.emphasis").getBarItemStyle();l||e.setShape("r",d.get("barBorderRadius")||0),e.useStyle(r({fill:c,opacity:u},d.getBarItemStyle()));var p=i.getShallow("cursor");p&&e.attr("cursor",p);var f=s?o.height>0?"bottom":"top":o.width>0?"left":"right";l||ol(e.style,h,i,c,a,n,f),uo(e,h)}function hl(e,t){var n=e.get(XS)||0;return Math.min(n,Math.abs(t.width),Math.abs(t.height))}function ul(e,t,n,i){var r=t.getData(),o=this.dataIndex,a=r.getName(o),s=t.get("selectedOffset");i.dispatchAction({type:"pieToggleSelect",from:e,name:a,seriesId:t.id}),r.each(function(e){cl(r.getItemGraphicEl(e),r.getItemLayout(e),t.isSelected(r.getName(e)),s,n)})}function cl(e,t,n,i,r){var o=(t.startAngle+t.endAngle)/2,a=Math.cos(o),s=Math.sin(o),l=n?i:0,c=[a*l,s*l];r?e.animate().when(200,{position:c}).start("bounceOut"):e.attr("position",c)}function dl(e,t){function i(){o.ignore=o.hoverIgnore,a.ignore=a.hoverIgnore}function n(){o.ignore=o.normalIgnore,a.ignore=a.normalIgnore}X_.call(this);var r=new lb({z2:2}),o=new pb,a=new rb;this.add(r),this.add(o),this.add(a),this.updateData(e,t,!0),this.on("emphasis",i).on("normal",n).on("mouseover",i).on("mouseout",n)}function fl(e,t,n,i,r,o,a){function s(t,n){for(var i=t;i>=0&&(e[i].y-=n,!(i>0&&e[i].y>e[i-1].y+e[i-1].height));i--);}function l(e,t,n,i,r,o){for(var a=t?Number.MAX_VALUE:0,s=0,l=e.length;s<l;s++)if("center"!==e[s].position){var c=Math.abs(e[s].y-i),u=e[s].len,d=e[s].len2,h=c<r+u?Math.sqrt((r+u+d)*(r+u+d)-c*c):Math.abs(e[s].x-n);t&&h>=a&&(h=a-10),!t&&h<=a&&(h=a+10),e[s].x=n+h*o,a=h}}e.sort(function(e,t){return e.y-t.y});for(var c,u=0,d=e.length,h=[],p=[],f=0;f<d;f++)(c=e[f].y-u)<0&&function(t,n,i,r){for(var o=t;o<n;o++)if(e[o].y+=i,o>t&&o+1<n&&e[o+1].y>e[o].y+e[o].height)return void s(o,i/2);s(n-1,i/2)}(f,d,-c),u=e[f].y+e[f].height;for(a-u<0&&s(d-1,u-a),f=0;f<d;f++)e[f].y>=n?p.push(e[f]):h.push(e[f]);l(h,!1,t,n,i,r),l(p,!0,t,n,i,r)}function pl(e,t,n,i,r,o){for(var a=[],s=[],l=0;l<e.length;l++)e[l].x<t?a.push(e[l]):s.push(e[l]);for(fl(s,t,n,i,1,r,o),fl(a,t,n,i,-1,r,o),l=0;l<e.length;l++){var c=e[l].linePoints;if(c){var u=c[1][0]-c[2][0];e[l].x<t?c[2][0]=e[l].x+3:c[2][0]=e[l].x-3,c[1][1]=c[2][1]=e[l].y,c[1][0]=c[2][0]+u}}}function gl(){this.group=new X_,this._symbolEl=new sT({})}function ml(e,t,n){jC.call(this,e,t,n),this.type="value",this.angle=0,this.name="",this.model}function vl(e,t,n){this._model=e,this.dimensions=[],this._indicatorAxes=f(e.getIndicatorModels(),function(e,t){var n="indicator_"+t,i=new ml(n,new xC);return i.name=e.get("name"),i.model=e,e.axis=i,this.dimensions.push(n),i},this),this.resize(e,n),this.cx,this.cy,this.r,this.startAngle}function yl(e,t){return r({show:t},e)}function xl(e){return y(e)||(e=[+e,+e]),e}function _l(){C_.call(this)}function bl(e){this.name=e,this.zoomLimit,C_.call(this),this._roamTransform=new _l,this._viewTransform=new _l,this._center,this._zoom}function wl(e,t,n,i){var r=n.seriesModel,o=r?r.coordinateSystem:null;return o===this?o[e](i):null}function Sl(e,t,n,i,r){bl.call(this,e),this.map=t,this._nameCoordMap=z(),this.loadGeoJson(n,i,r)}function Ml(e,t,n,i){var r=n.geoModel,o=n.seriesModel,a=r?r.coordinateSystem:o?o.coordinateSystem||(o.getReferringComponents("geo")[0]||{}).coordinateSystem:null;return a===this?a[e](i):null}function Il(e,t){var n=e.get("boundingCoords");if(null!=n){var i=n[0],r=n[1];isNaN(i[0])||isNaN(i[1])||isNaN(r[0])||isNaN(r[1])||this.setBoundingRect(i[0],i[1],r[0]-i[0],r[1]-i[1])}var o,a=this.getBoundingRect(),s=e.get("layoutCenter"),l=e.get("layoutSize"),c=t.getWidth(),u=t.getHeight(),d=e.get("aspectScale")||.75,h=a.width/a.height*d,p=!1;if(s&&l&&(s=[Si(s[0],c),Si(s[1],u)],l=Si(l,Math.min(c,u)),isNaN(s[0])||isNaN(s[1])||isNaN(l)||(p=!0)),p){var f={};h>1?(f.width=l,f.height=l/h):(f.height=l,f.width=l*h),f.y=s[1]-f.height/2,f.x=s[0]-f.width/2}else(o=e.getBoxLayoutParams()).aspect=h,f=Ko(o,{width:c,height:u});this.setViewRect(f.x,f.y,f.width,f.height),this.setCenter(e.get("center")),this.setZoom(e.get("zoom"))}function Tl(e,t){d(t.get("geoCoord"),function(t,n){e.addGeoCoord(n,t)})}function Al(e,t,n){Ll(e)[t]=n}function Cl(e,t,n){var i=Ll(e);i[t]===n&&(i[t]=null)}function Dl(e,t){return!!Ll(e)[t]}function Ll(e){return e[CT]||(e[CT]={})}function kl(e){this.pointerChecker,this._zr=e,this._opt={};var t=m,n=t(Pl,this),o=t(Ol,this),a=t(zl,this),s=t(Nl,this),l=t(El,this);g_.call(this),this.setPointerChecker=function(e){this.pointerChecker=e},this.enable=function(t,c){this.disable(),this._opt=r(i(c)||{},{zoomOnMouseWheel:!0,moveOnMouseMove:!0,preventDefaultMouseMove:!0}),null==t&&(t=!0),!0!==t&&"move"!==t&&"pan"!==t||(e.on("mousedown",n),e.on("mousemove",o),e.on("mouseup",a)),!0!==t&&"scale"!==t&&"zoom"!==t||(e.on("mousewheel",s),e.on("pinch",l))},this.disable=function(){e.off("mousedown",n),e.off("mousemove",o),e.off("mouseup",a),e.off("mousewheel",s),e.off("pinch",l)},this.dispose=this.disable,this.isDragging=function(){return this._dragging},this.isPinching=function(){return this._pinching}}function Pl(e){if(!(hi(e)||e.target&&e.target.draggable)){var t=e.offsetX,n=e.offsetY;this.pointerChecker&&this.pointerChecker(e,t,n)&&(this._x=t,this._y=n,this._dragging=!0)}}function Ol(e){if(!hi(e)&&Vl(this,"moveOnMouseMove",e)&&this._dragging&&"pinch"!==e.gestureEvent&&!Dl(this._zr,"globalPan")){var t=e.offsetX,n=e.offsetY,i=this._x,r=this._y,o=t-i,a=n-r;this._x=t,this._y=n,this._opt.preventDefaultMouseMove&&Cy(e.event),this.trigger("pan",o,a,i,r,t,n)}}function zl(e){hi(e)||(this._dragging=!1)}function Nl(e){if(Vl(this,"zoomOnMouseWheel",e)&&0!==e.wheelDelta){var t=e.wheelDelta>0?1.1:1/1.1;Rl.call(this,e,t,e.offsetX,e.offsetY)}}function El(e){if(!Dl(this._zr,"globalPan")){var t=e.pinchScale>1?1.1:1/1.1;Rl.call(this,e,t,e.pinchX,e.pinchY)}}function Rl(e,t,n,i){this.pointerChecker&&this.pointerChecker(e,n,i)&&(Cy(e.event),this.trigger("zoom",t,n,i))}function Vl(e,t,n){var i=e._opt[t];return i&&(!_(i)||n.event[i+"Key"])}function Bl(e,t,n){var i=e.target,r=i.position;r[0]+=t,r[1]+=n,i.dirty()}function Gl(e,t,n,i){var r=e.target,o=e.zoomLimit,a=r.position,s=r.scale,l=e.zoom=e.zoom||1;if(l*=t,o){var c=o.min||0,u=o.max||1/0;l=Math.max(Math.min(u,l),c)}var d=l/e.zoom;e.zoom=l,a[0]-=(n-a[0])*(d-1),a[1]-=(i-a[1])*(d-1),s[0]*=d,s[1]*=d,r.dirty()}function Wl(e,t,n){var i=t.getComponentByElement(e.topTarget),r=i&&i.coordinateSystem;return i&&i!==n&&!ST[i.mainType]&&r&&r.model!==n}function Hl(e,t){var n=e.getItemStyle(),i=e.get("areaColor");return null!=i&&(n.fill=i),n}function Fl(e,t,n,i,r){n.off("click"),n.off("mousedown"),t.get("selectedMode")&&(n.on("mousedown",function(){e._mouseDownFlag=!0}),n.on("click",function(o){if(e._mouseDownFlag){e._mouseDownFlag=!1;for(var a=o.target;!a.__regions;)a=a.parent;if(a){var s={type:("geo"===t.mainType?"geo":"map")+"ToggleSelect",batch:f(a.__regions,function(e){return{name:e.name,from:r.uid}})};s[t.mainType+"Id"]=t.id,i.dispatchAction(s),Zl(t,n)}}}))}function Zl(e,t){t.eachChild(function(t){d(t.__regions,function(n){t.trigger(e.isSelected(n.name)?"emphasis":"normal")})})}function Ul(e,t){var n=new X_;this._controller=new kl(e.getZr()),this._controllerHost={target:t?n:null},this.group=n,this._updateGroup=t,this._mouseDownFlag}function Xl(e,t,n){var i=e.getZoom(),r=e.getCenter(),o=t.zoom,a=e.dataToPoint(r);if(null!=t.dx&&null!=t.dy&&(a[0]-=t.dx,a[1]-=t.dy,r=e.pointToData(a),e.setCenter(r)),null!=o){if(n){var s=n.min||0,l=n.max||1/0;o=Math.max(Math.min(i*o,l),s)/i}e.scale[0]*=o,e.scale[1]*=o;var c=e.position,u=(t.originX-c[0])*(o-1),d=(t.originY-c[1])*(o-1);c[0]-=u,c[1]-=d,e.updateTransform(),r=e.pointToData(a),e.setCenter(r),e.setZoom(o*i)}return{center:e.getCenter(),zoom:e.getZoom()}}function jl(e,t){var n={},i=["value"];return d(e,function(e){e.each(i,function(t,i){var r="ec-"+e.getName(i);n[r]=n[r]||[],isNaN(t)||n[r].push(t)})}),e[0].map(i,function(i,r){for(var o="ec-"+e[0].getName(r),a=0,s=1/0,l=-1/0,c=n[o].length,u=0;u<c;u++)s=Math.min(s,n[o][u]),l=Math.max(l,n[o][u]),a+=n[o][u];var d;return d="min"===t?s:"max"===t?l:"average"===t?a/c:a,0===c?NaN:d})}function ql(e){var t=e.mainData,n=e.datas;n||(n={main:t},e.datasAttr={main:"data"}),e.datas=e.mainData=null,th(t,n,e),TT(n,function(n){TT(t.TRANSFERABLE_METHODS,function(t){n.wrapMethod(t,v(Yl,e))})}),t.wrapMethod("cloneShallow",v(Kl,e)),TT(t.CHANGABLE_METHODS,function(n){t.wrapMethod(n,v($l,e))}),L(n[t.dataType]===t)}function Yl(e,t){if(Ql(this)){var n=a({},this[AT]);n[this.dataType]=t,th(t,n,e)}else eh(t,this.dataType,this[MT],e);return t}function $l(e,t){return e.struct&&e.struct.update(this),t}function Kl(e,t){return TT(t[AT],function(n,i){n!==t&&eh(n.cloneShallow(),i,t,e)}),t}function Jl(e){var t=this[MT];return null==e||null==t?t:t[AT][e]}function Ql(e){return e[MT]===e}function th(e,t,n){e[AT]={},TT(t,function(t,i){eh(t,i,e,n)})}function eh(e,t,n,i){n[AT][t]=e,e[MT]=n,e.dataType=t,i.struct&&(e[i.structAttr]=i.struct,i.struct[i.datasAttr[t]]=e),e.getLinkedData=Jl}function ih(e,t,n){this.root,this.data,this._nodes=[],this.hostModel=e,this.levelModels=f(t||[],function(t){return new Lo(t,e,e.ecModel)}),this.leavesModel=new Lo(n||{},e,e.ecModel)}function nh(e,t){var n=t.children;e.parentNode!==t&&(n.push(e),e.parentNode=t)}function oh(e){e.hierNode={defaultAncestor:null,ancestor:e,prelim:0,modifier:0,change:0,shift:0,i:0,thread:null};for(var t,n,i=[e];t=i.pop();)if(n=t.children,t.isExpand&&n.length)for(var r=n.length-1;r>=0;r--){var o=n[r];o.hierNode={defaultAncestor:null,ancestor:o,prelim:0,modifier:0,change:0,shift:0,i:r,thread:null},i.push(o)}}function ah(e,t){var n=e.isExpand?e.children:[],i=e.parentNode.children,r=e.hierNode.i?i[e.hierNode.i-1]:null;if(n.length){uh(e);var o=(n[0].hierNode.prelim+n[n.length-1].hierNode.prelim)/2;r?(e.hierNode.prelim=r.hierNode.prelim+t(e,r),e.hierNode.modifier=e.hierNode.prelim-o):e.hierNode.prelim=o}else r&&(e.hierNode.prelim=r.hierNode.prelim+t(e,r));e.parentNode.hierNode.defaultAncestor=ch(e,r,e.parentNode.hierNode.defaultAncestor||i[0],t)}function rh(e){var t=e.hierNode.prelim+e.parentNode.hierNode.modifier;e.setLayout({x:t},!0),e.hierNode.modifier+=e.parentNode.hierNode.modifier}function sh(e){return arguments.length?e:mh}function lh(e,t){var n={};return e-=Math.PI/2,n.x=t*Math.cos(e),n.y=t*Math.sin(e),n}function hh(e,t){return Ko(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function uh(e){for(var t=e.children,n=t.length,i=0,r=0;--n>=0;){var o=t[n];o.hierNode.prelim+=i,o.hierNode.modifier+=i,r+=o.hierNode.change,i+=o.hierNode.shift+r}}function ch(e,t,n,i){if(t){for(var r=e,o=e,a=o.parentNode.children[0],s=t,l=r.hierNode.modifier,c=o.hierNode.modifier,u=a.hierNode.modifier,d=s.hierNode.modifier;s=dh(s),o=fh(o),s&&o;){r=dh(r),a=fh(a),r.hierNode.ancestor=e;var h=s.hierNode.prelim+d-o.hierNode.prelim-c+i(s,o);h>0&&(gh(ph(s,e,n),e,h),c+=h,l+=h),d+=s.hierNode.modifier,c+=o.hierNode.modifier,l+=r.hierNode.modifier,u+=a.hierNode.modifier}s&&!dh(r)&&(r.hierNode.thread=s,r.hierNode.modifier+=d-l),o&&!fh(a)&&(a.hierNode.thread=o,a.hierNode.modifier+=c-u,n=e)}return n}function dh(e){var t=e.children;return t.length&&e.isExpand?t[t.length-1]:e.hierNode.thread}function fh(e){var t=e.children;return t.length&&e.isExpand?t[0]:e.hierNode.thread}function ph(e,t,n){return e.hierNode.ancestor.parentNode===t.parentNode?e.hierNode.ancestor:n}function gh(e,t,n){var i=n/(t.hierNode.i-e.hierNode.i);t.hierNode.change-=i,t.hierNode.shift+=n,t.hierNode.modifier+=n,t.hierNode.prelim+=n,e.hierNode.change+=i}function mh(e,t){return e.parentNode===t.parentNode?1:2}function vh(e,t){var n=e.getItemLayout(t);return n&&!isNaN(n.x)&&!isNaN(n.y)&&"none"!==e.getItemVisual(t,"symbol")}function yh(e,t,n){return n.itemModel=t,n.itemStyle=t.getModel("itemStyle.normal").getItemStyle(),n.hoverItemStyle=t.getModel("itemStyle.emphasis").getItemStyle(),n.lineStyle=t.getModel("lineStyle.normal").getLineStyle(),n.labelModel=t.getModel("label.normal"),n.hoverLabelModel=t.getModel("label.emphasis"),!1===e.isExpand&&0!==e.children.length?n.symbolInnerColor=n.itemStyle.fill:n.symbolInnerColor="#fff",n}function xh(e,t,n,i,o,a){var s=!n,l=e.tree.getNodeByDataIndex(t),a=yh(l,l.getModel(),a),c=e.tree.root,u=l.parentNode===c?l:l.parentNode||l,d=e.getItemGraphicEl(u.dataIndex),h=u.getLayout(),p=d?{x:d.position[0],y:d.position[1],rawX:d.__radialOldRawX,rawY:d.__radialOldRawY}:h,f=l.getLayout();s?(n=new Jr(e,t,a)).attr("position",[p.x,p.y]):n.updateData(e,t,a),n.__radialOldRawX=n.__radialRawX,n.__radialOldRawY=n.__radialRawY,n.__radialRawX=f.rawX,n.__radialRawY=f.rawY,i.add(n),e.setItemGraphicEl(t,n),wo(n,{position:[f.x,f.y]},o);var g=n.getSymbolPath();if("radial"===a.layout){var m,v,_=c.children[0],y=_.getLayout(),x=_.children.length;if(f.x===y.x&&!0===l.isExpand){var b={};b.x=(_.children[0].getLayout().x+_.children[x-1].getLayout().x)/2,b.y=(_.children[0].getLayout().y+_.children[x-1].getLayout().y)/2,(m=Math.atan2(b.y-y.y,b.x-y.x))<0&&(m=2*Math.PI+m),(v=b.x<y.x)&&(m-=Math.PI)}else(m=Math.atan2(f.y-y.y,f.x-y.x))<0&&(m=2*Math.PI+m),0===l.children.length||0!==l.children.length&&!1===l.isExpand?(v=f.x<y.x)&&(m-=Math.PI):(v=f.x>y.x)||(m-=Math.PI);var w=v?"left":"right";g.setStyle({textPosition:w,textRotation:-m,textOrigin:"center",verticalAlign:"middle"})}if(l.parentNode&&l.parentNode!==c){var C=n.__edge;C||(C=n.__edge=new vb({shape:bh(a,p,p),style:r({opacity:0},a.lineStyle)})),wo(C,{shape:bh(a,h,f),style:{opacity:1}},o),i.add(C)}}function _h(e,t,n,i,r,o){for(var a,s=e.tree.getNodeByDataIndex(t),l=e.tree.root,o=yh(s,s.getModel(),o),c=s.parentNode===l?s:s.parentNode||s;null==(a=c.getLayout());)c=c.parentNode===l?c:c.parentNode||c;wo(n,{position:[a.x+1,a.y+1]},r,function(){i.remove(n),e.setItemGraphicEl(t,null)}),n.fadeOut(null,{keepLabel:!0});var u=n.__edge;u&&wo(u,{shape:bh(o,a,a),style:{opacity:0}},r,function(){i.remove(u)})}function bh(e,t,n){var i,r,o,a,s=e.orient;if("radial"===e.layout){var l=t.rawX,c=t.rawY,u=n.rawX,d=n.rawY,h=lh(l,c),p=lh(l,c+(d-c)*e.curvature),f=lh(u,d+(c-d)*e.curvature),g=lh(u,d);return{x1:h.x,y1:h.y,x2:g.x,y2:g.y,cpx1:p.x,cpy1:p.y,cpx2:f.x,cpy2:f.y}}var l=t.x,c=t.y,u=n.x,d=n.y;return"horizontal"===s&&(i=l+(u-l)*e.curvature,r=c,o=u+(l-u)*e.curvature,a=d),"vertical"===s&&(i=l,r=c+(d-c)*e.curvature,o=u,a=d+(c-d)*e.curvature),{x1:l,y1:c,x2:u,y2:d,cpx1:i,cpy1:r,cpx2:o,cpy2:a}}function wh(e,t,n){for(var i,r=[e],o=[];i=r.pop();)if(o.push(i),i.isExpand){var a=i.children;if(a.length)for(var s=0;s<a.length;s++)r.push(a[s])}for(;i=o.pop();)t(i,n)}function Sh(e,t){for(var n,i=[e];n=i.pop();)if(t(n),n.isExpand){var r=n.children;if(r.length)for(var o=r.length-1;o>=0;o--)i.push(r[o])}}function Mh(e,t){if(e&&("treemapZoomToNode"===e.type||"treemapRootToNode"===e.type)){var n=t.getData().tree.root,i=e.targetNode;if(i&&n.contains(i))return{node:i};var r=e.targetNodeId;if(null!=r&&(i=n.getNodeById(r)))return{node:i}}}function Ih(e){for(var t=[];e;)(e=e.parentNode)&&t.push(e);return t.reverse()}function Th(e,t){return l(Ih(e),t)>=0}function Ah(e,t){for(var n=[];e;){var i=e.dataIndex;n.push({name:e.name,dataIndex:i,value:t.getRawValue(i)}),e=e.parentNode}return n.reverse(),n}function Ch(e){var t=0;d(e.children,function(e){Ch(e);var n=e.value;y(n)&&(n=n[0]),t+=n});var n=e.value;y(n)&&(n=n[0]),(null==n||isNaN(n))&&(n=t),n<0&&(n=0),y(e.value)?e.value[0]=n:e.value=n}function Dh(e,t){var n=t.get("color");if(n){var i;return d(e=e||[],function(e){var t=new Lo(e),n=t.get("color");(t.get("itemStyle.normal.color")||n&&"none"!==n)&&(i=!0)}),i||((e[0]||(e[0]={})).color=n.slice()),e}}function Lh(e){this.group=new X_,e.add(this.group)}function kh(e,t,n,i,r,o){var a=[[r?e:e-DT,t],[e+n,t],[e+n,t+i],[r?e:e-DT,t+i]];return!o&&a.splice(2,0,[e+n+DT,t+i/2]),!r&&a.push([e,t+i/2]),a}function Ph(e,t,n){e.eventData={componentType:"series",componentSubType:"treemap",seriesIndex:t.componentIndex,seriesName:t.name,seriesType:"treemap",selfType:"breadcrumb",nodeData:{dataIndex:n&&n.dataIndex,name:n&&n.name},treePathInfo:n&&Ah(n,t)}}function Oh(){var e,t=[],n={};return{add:function(e,i,r,o,a){return _(o)&&(a=o,o=0),!n[e.id]&&(n[e.id]=1,t.push({el:e,target:i,time:r,delay:o,easing:a}),!0)},done:function(t){return e=t,this},start:function(){for(var i=t.length,r=0,o=t.length;r<o;r++){var a=t[r];a.el.animateTo(a.target,a.time,a.delay,a.easing,function(){--i||(t.length=0,n={},e&&e())})}return this}}}function zh(e,t,n,r,o,s,l,c,u,h){function d(e,t){b?!e.invisible&&s.push(e):(t(),e.__tmWillVisible||(e.invisible=!1))}function f(t,n,r,o,a,s){var c=l.getModel(),u=I(e.getFormattedLabel(l.dataIndex,"normal",null,null,s?"upperLabel":"label"),c.get("name"));if(!s&&v.isLeafRoot){var d=e.get("drillDownIcon",!0);u=d?d+" "+u:u}var h=c.getModel(s?zT:OT),p=c.getModel(s?FT:RT),f=h.getShallow("show");co(t,n,h,p,{defaultText:f?u:null,autoColor:r,isRectText:!0}),s&&(t.textRect=i(s)),t.truncate=f&&h.get("ellipsis")?{outerWidth:o,outerHeight:a,minChar:2}:null}function p(e,i,r,a){var s=null!=C&&n[e][C],l=o[e];return s?(n[e][C]=null,g(l,s,e)):b||((s=new i({z:Nh(r,a)})).__tmDepth=r,s.__tmStorageName=e,m(l,s,e)),t[e][w]=s}function g(e,t,n){(e[w]={}).old="nodeGroup"===n?t.position.slice():a({},t.shape)}function m(e,t,n){var i=e[w]={},a=l.parentNode;if(a&&(!r||"drillDown"===r.direction)){var s=0,c=0,u=o.background[a.getRawIndex()];!r&&u&&u.old&&(s=u.old.width,c=u.old.height),i.old="nodeGroup"===n?[0,c]:{x:s,y:c,width:0,height:0}}i.fadein="nodeGroup"!==n}if(l){var v=l.getLayout();if(v&&v.isInView){var _=v.width,y=v.height,x=v.borderWidth,b=v.invisible,w=l.getRawIndex(),C=c&&c.getRawIndex(),S=l.viewChildren,T=v.upperHeight,A=S&&S.length,M=l.getModel("itemStyle.normal"),E=l.getModel("itemStyle.emphasis"),D=p("nodeGroup",LT);if(D){if(u.add(D),D.attr("position",[v.x||0,v.y||0]),D.__tmNodeWidth=_,D.__tmNodeHeight=y,v.isAboveViewRoot)return D;var k=p("background",NT,h,HT);if(k&&function(t,n,i){n.dataIndex=l.dataIndex,n.seriesIndex=e.seriesIndex,n.setShape({x:0,y:0,width:_,height:y});var r=l.getVisual("borderColor",!0),o=E.get("borderColor");d(n,function(){var e=UT(M);e.fill=r;var t=WT(E);if(t.fill=o,i){var a=_-2*x;f(e,t,r,a,T,{x:x,y:0,width:a,height:T})}else e.text=t.text=null;n.setStyle(e),uo(n,t)}),t.add(n)}(D,k,A&&v.upperHeight),!A){var L=p("content",NT,h,VT);L&&function(t,n){n.dataIndex=l.dataIndex,n.seriesIndex=e.seriesIndex;var i=Math.max(_-2*x,0),r=Math.max(y-2*x,0);n.culling=!0,n.setShape({x:x,y:x,width:i,height:r});var o=l.getVisual("color",!0);d(n,function(){var e=UT(M);e.fill=o;var t=WT(E);f(e,t,o,i,r),n.setStyle(e),uo(n,t)}),t.add(n)}(D,L)}return D}}}}function Nh(e,t){var n=e*BT+t;return(n-1)/n}function Eh(e){var t=e.pieceList;e.hasSpecialVisual=!1,d(t,function(t,n){t.originIndex=n,null!=t.visual&&(e.hasSpecialVisual=!0)})}function Rh(e){var t=e.categories,n=e.visual,i=e.categoryMap={};if(qT(t,function(e,t){i[e]=t}),!y(n)){var r=[];b(n)?qT(n,function(e,t){var n=i[t];r[null!=n?n:YT]=e}):r[YT]=n,n=Xh(e,r)}for(var o=t.length-1;o>=0;o--)null==n[o]&&(delete i[t[o]],t.pop())}function Vh(e,t){var n=e.visual,i=[];b(n)?qT(n,function(e){i.push(e)}):null!=n&&i.push(n);var r={color:1,symbol:1};t||1!==i.length||r.hasOwnProperty(e.type)||(i[1]=i[0]),Xh(e,i)}function Bh(e){return{applyVisual:function(t,n,i){t=this.mapValueToVisual(t),i("color",e(n("color"),t))},_doMap:Zh([0,1])}}function Gh(e){var t=this.option.visual;return t[Math.round(wi(e,[0,1],[0,t.length-1],!0))]||{}}function Wh(e){return function(t,n,i){i(e,this.mapValueToVisual(t))}}function Hh(e){var t=this.option.visual;return t[this.option.loop&&e!==YT?e%t.length:e]}function Fh(){return this.option.visual[0]}function Zh(e){return{linear:function(t){return wi(t,e,this.option.visual,!0)},category:Hh,piecewise:function(t,n){var i=Uh.call(this,n);return null==i&&(i=wi(t,e,this.option.visual,!0)),i},fixed:Fh}}function Uh(e){var t=this.option,n=t.pieceList;if(t.hasSpecialVisual){var i=n[XT.findPieceIndex(e,n)];if(i&&i.visual)return i.visual[this.type]}}function Xh(e,t){return e.visual=t,"color"===e.type&&(e.parsedVisual=f(t,function(e){return Mt(e)})),t}function jh(e,t,n){return e?t<=n:t<n}function qh(e,t,n,i,r,o){var a=e.getModel(),s=e.getLayout();if(s&&!s.invisible&&s.isInView){var l,c=e.getModel(QT),u=Yh(c,t,n[e.depth],i),h=c.get("borderColor"),p=c.get("borderColorSaturation");null!=p&&(h=Kh(p,l=$h(u))),e.setVisual("borderColor",h);var f=e.viewChildren;if(f&&f.length){var g=Qh(e,a,s,c,u,f);d(f,function(e,t){(e.depth>=r.length||e===r[e.depth])&&qh(e,eu(a,u,e,t,g,o),n,i,r,o)})}else l=$h(u),e.setVisual("color",l)}}function Yh(e,t,n,i){var r=a({},t);return d(["color","colorAlpha","colorSaturation"],function(o){var a=e.get(o,!0);null==a&&n&&(a=n[o]),null==a&&(a=t[o]),null==a&&(a=i.get(o)),null!=a&&(r[o]=a)}),r}function $h(e){var t=Jh(e,"color");if(t){var n=Jh(e,"colorAlpha"),i=Jh(e,"colorSaturation");return i&&(t=kt(t,null,null,i)),n&&(t=Pt(t,n)),t}}function Kh(e,t){return null!=t?kt(t,null,null,e):null}function Jh(e,t){var n=e[t];if(null!=n&&"none"!==n)return n}function Qh(e,t,n,i,r,o){if(o&&o.length){var a=tu(t,"color")||null!=r.color&&"none"!==r.color&&(tu(t,"colorAlpha")||tu(t,"colorSaturation"));if(a){var s=t.get("visualMin"),l=t.get("visualMax"),c=n.dataExtent.slice();null!=s&&s<c[0]&&(c[0]=s),null!=l&&l>c[1]&&(c[1]=l);var u=t.get("colorMappingBy"),d={type:a.name,dataExtent:c,visual:a.range};"color"!==d.type||"index"!==u&&"id"!==u?d.mappingMethod="linear":(d.mappingMethod="category",d.loop=!0);var h=new XT(d);return h.__drColorMappingBy=u,h}}}function tu(e,t){var n=e.get(t);return JT(n)&&n.length?{name:t,range:n}:null}function eu(e,t,n,i,r,o){var s=a({},t);if(r){var l=r.type,c="color"===l&&r.__drColorMappingBy,u="index"===c?i:"id"===c?o.mapIdToIndex(n.getId()):n.getValue(e.get("visualDimension"));s[l]=r.mapValueToVisual(u)}return s}function iu(e,t,n,i){var r,o;if(!e.isRemoved()){var a=e.getLayout();r=a.width,o=a.height;var s=(p=e.getModel()).get(rA),l=p.get(oA)/2,c=du(p),u=Math.max(s,c),d=s-l,h=u-l,p=e.getModel();e.setLayout({borderWidth:s,upperHeight:u,upperLabelHeight:c},!0);var f=(r=eA(r-2*d,0))*(o=eA(o-d-h,0)),g=nu(e,p,f,t,n,i);if(g.length){var m={x:d,y:h,width:r,height:o},v=tA(r,o),_=1/0,y=[];y.area=0;for(var x=0,b=g.length;x<b;){var w=g[x];y.push(w),y.area+=w.getLayout().area;var C=su(y,v,t.squareRatio);C<=_?(x++,_=C):(y.area-=y.pop().getLayout().area,lu(y,v,m,l,!1),v=tA(m.width,m.height),y.length=y.area=0,_=1/0)}if(y.length&&lu(y,v,m,l,!0),!n){var S=p.get("childrenVisibleMin");null!=S&&f<S&&(n=!0)}for(var x=0,b=g.length;x<b;x++)iu(g[x],t,n,i+1)}}}function nu(e,t,n,i,r,o){var a=e.children||[],s=i.sort;"asc"!==s&&"desc"!==s&&(s=null);var l=null!=i.leafDepth&&i.leafDepth<=o;if(r&&!l)return e.viewChildren=[];au(a=g(a,function(e){return!e.isRemoved()}),s);var c=ru(t,a,s);if(0===c.sum)return e.viewChildren=[];if(c.sum=ou(t,n,c.sum,s,a),0===c.sum)return e.viewChildren=[];for(var u=0,d=a.length;u<d;u++){var h=a[u].getValue()/c.sum*n;a[u].setLayout({area:h})}return l&&(a.length&&e.setLayout({isLeafRoot:!0},!0),a.length=0),e.viewChildren=a,e.setLayout({dataExtent:c.dataExtent},!0),a}function ou(e,t,n,i,r){if(!i)return n;for(var o=e.get("visibleMin"),a=r.length,s=a,l=a-1;l>=0;l--){var c=r["asc"===i?a-l-1:l].getValue();c/n*t<o&&(s=l,n-=c)}return"asc"===i?r.splice(0,a-s):r.splice(s,a-s),n}function au(e,t){return t&&e.sort(function(e,n){var i="asc"===t?e.getValue()-n.getValue():n.getValue()-e.getValue();return 0===i?"asc"===t?e.dataIndex-n.dataIndex:n.dataIndex-e.dataIndex:i}),e}function ru(e,t,n){for(var i=0,r=0,o=t.length;r<o;r++)i+=t[r].getValue();var a=e.get("visualDimension");if(t&&t.length)if("value"===a&&n)s=[t[t.length-1].getValue(),t[0].getValue()],"asc"===n&&s.reverse();else{var s=[1/0,-1/0];iA(t,function(e){var t=e.getValue(a);t<s[0]&&(s[0]=t),t>s[1]&&(s[1]=t)})}else s=[NaN,NaN];return{sum:i,dataExtent:s}}function su(e,t,n){for(var i,r=0,o=1/0,a=0,s=e.length;a<s;a++)(i=e[a].getLayout().area)&&(i<o&&(o=i),i>r&&(r=i));var l=e.area*e.area,c=t*t*n;return l?eA(c*r/l,l/(c*o)):1/0}function lu(e,t,n,i,r){var o=t===n.width?0:1,a=1-o,s=["x","y"],l=["width","height"],c=n[s[o]],u=t?e.area/t:0;(r||u>n[l[a]])&&(u=n[l[a]]);for(var d=0,h=e.length;d<h;d++){var p=e[d],f={},g=u?p.getLayout().area/u:0,m=f[l[a]]=eA(u-2*i,0),v=n[s[o]]+n[l[o]]-c,_=d===h-1||v<g?v:g,y=f[l[o]]=eA(_-2*i,0);f[s[a]]=n[s[a]]+tA(i,m/2),f[s[o]]=c+tA(i,y/2),c+=_,p.setLayout(f,!0)}n[s[a]]+=u,n[l[a]]-=u}function hu(e,t,n,i,r){var o=(t||{}).node,a=[i,r];if(!o||o===n)return a;for(var s,l=i*r,c=l*e.option.zoomToNodeRatio;s=o.parentNode;){for(var u=0,d=s.children,h=0,p=d.length;h<p;h++)u+=d[h].getValue();var f=o.getValue();if(0===f)return a;c*=u/f;var g=s.getModel(),m=g.get(rA);(c+=4*m*m+(3*m+Math.max(m,du(g)))*Math.pow(c,.5))>By&&(c=By),o=s}c<l&&(c=l);var v=Math.pow(c/l,.5);return[i*v,r*v]}function uu(e,t,n){if(t)return{x:t.x,y:t.y};var i={x:0,y:0};if(!n)return i;var r=n.node,o=r.getLayout();if(!o)return i;for(var a=[o.width/2,o.height/2],s=r;s;){var l=s.getLayout();a[0]+=l.x,a[1]+=l.y,s=s.parentNode}return{x:e.width/2-a[0],y:e.height/2-a[1]}}function cu(e,t,n,i,r){var o=e.getLayout(),a=n[r],s=a&&a===e;if(!(a&&!s||r===n.length&&e!==i)){e.setLayout({isInView:!0,invisible:!s&&!t.intersect(o),isAboveViewRoot:s},!0);var l=new jt(t.x-o.x,t.y-o.y,t.width,t.height);iA(e.viewChildren||[],function(e){cu(e,l,n,i,r+1)})}}function du(e){return e.get(aA)?e.get(sA):0}function fu(e){return"_EC_"+e}function pu(e,t){this.id=null==e?"":e,this.inEdges=[],this.outEdges=[],this.edges=[],this.hostGraph,this.dataIndex=null==t?-1:t}function gu(e,t,n){this.node1=e,this.node2=t,this.dataIndex=null==n?-1:n}function mu(e){return isNaN(+e.cpx1)||isNaN(+e.cpy1)}function vu(e){return"_"+e+"Type"}function yu(e,t,n){var i=t.getItemVisual(n,"color"),r=t.getItemVisual(n,e),o=t.getItemVisual(n,e+"Size");if(r&&"none"!==r){y(o)||(o=[o,o]);var a=Hr(r,-o[0]/2,-o[1]/2,o[0],o[1],i);return a.name=e,a}}function xu(e){var t=new gA({name:"line"});return _u(t.shape,e),t}function _u(e,t){var n=t[0],i=t[1],r=t[2];e.x1=n[0],e.y1=n[1],e.x2=i[0],e.y2=i[1],e.percent=1,r?(e.cpx1=r[0],e.cpy1=r[1]):(e.cpx1=NaN,e.cpy1=NaN)}function bu(e,t,n){X_.call(this),this._createLine(e,t,n)}function wu(e){return isNaN(e[0])||isNaN(e[1])}function Su(e){return!wu(e[0])&&!wu(e[1])}function Mu(e){this._ctor=e||bu,this.group=new X_}function Iu(e,t,n){for(var i,r=e[0],o=e[1],a=e[2],s=1/0,l=n*n,c=.1,u=.1;u<=.9;u+=.1)yA[0]=wA(r[0],o[0],a[0],u),yA[1]=wA(r[1],o[1],a[1],u),(p=SA(CA(yA,t)-l))<s&&(s=p,i=u);for(var d=0;d<32;d++){var h=i+c;xA[0]=wA(r[0],o[0],a[0],i),xA[1]=wA(r[1],o[1],a[1],i),bA[0]=wA(r[0],o[0],a[0],h),bA[1]=wA(r[1],o[1],a[1],h);var p=CA(xA,t)-l;if(SA(p)<.01)break;var f=CA(bA,t)-l;c/=2,p<0?f>=0?i+=c:i-=c:f>=0?i-=c:i+=c}return i}function Tu(e,t){return e.getVisual("opacity")||e.getModel().get(t)}function Au(e,t,n){var i=e.getGraphicEl(),r=Tu(e,t);null!=n&&(null==r&&(r=1),r*=n),i.downplay&&i.downplay(),i.traverse(function(e){"group"!==e.type&&e.setStyle("opacity",r)})}function Cu(e,t){var n=Tu(e,t),i=e.getGraphicEl();i.highlight&&i.highlight(),i.traverse(function(e){"group"!==e.type&&e.setStyle("opacity",n)})}function Du(e){return e instanceof Array||(e=[e,e]),e}function Lu(e){var t=e.coordinateSystem;if(!t||"view"===t.type){var n=e.getGraph();n.eachNode(function(e){var t=e.getModel();e.setLayout([+t.get("x"),+t.get("y")])}),ku(n)}}function ku(e){e.eachEdge(function(e){var t=e.getModel().get("lineStyle.normal.curveness")||0,n=V(e.node1.getLayout()),i=V(e.node2.getLayout()),r=[n,i];+t&&r.push([(n[0]+i[0])/2-(n[1]-i[1])*t,(n[1]+i[1])/2-(i[0]-n[0])*t]),e.setLayout(r)})}function Pu(e){var t=e.coordinateSystem;if(!t||"view"===t.type){var n=t.getBoundingRect(),i=e.getData(),r=i.graph,o=0,a=i.getSum("value"),s=2*Math.PI/(a||i.count()),l=n.width/2+n.x,c=n.height/2+n.y,u=Math.min(n.width,n.height)/2;r.eachNode(function(e){var t=e.getValue("value");o+=s*(a?t:1)/2,e.setLayout([u*Math.cos(o)+l,u*Math.sin(o)+c]),o+=s*(a?t:1)/2}),i.setLayout({cx:l,cy:c}),r.eachEdge(function(e){var t,n=e.getModel().get("lineStyle.normal.curveness")||0,i=V(e.node1.getLayout()),r=V(e.node2.getLayout()),o=(i[0]+r[0])/2,a=(i[1]+r[1])/2;+n&&(t=[l*(n*=3)+o*(1-n),c*n+a*(1-n)]),e.setLayout([i,r,t])})}}function Ou(e,t,n){for(var i=n.rect,r=i.width,o=i.height,a=[i.x+r/2,i.y+o/2],s=null==n.gravity?.1:n.gravity,l=0;l<e.length;l++){var c=e[l];c.p||(c.p=E(r*(Math.random()-.5)+a[0],o*(Math.random()-.5)+a[1])),c.pp=V(c.p),c.edges=null}var u=.6;return{warmUp:function(){u=.5},setFixed:function(t){e[t].fixed=!0},setUnfixed:function(t){e[t].fixed=!1},step:function(n){for(var i=[],r=e.length,o=0;o<t.length;o++){var l=t[o],c=l.n1;H(i,(f=l.n2).p,c.p);var d=F(i)-l.d,h=f.w/(c.w+f.w);isNaN(h)&&(h=0),X(i,i),!c.fixed&&EA(c.p,c.p,i,h*d*u),!f.fixed&&EA(f.p,f.p,i,-(1-h)*d*u)}for(o=0;o<r;o++)(v=e[o]).fixed||(H(i,a,v.p),EA(v.p,v.p,i,s*u));for(o=0;o<r;o++)for(var c=e[o],p=o+1;p<r;p++){var f=e[p];H(i,f.p,c.p),0===(d=F(i))&&(B(i,Math.random()-.5,Math.random()-.5),d=1);var g=(c.rep+f.rep)/d/d;!c.fixed&&EA(c.pp,c.pp,i,g),!f.fixed&&EA(f.pp,f.pp,i,-g)}for(var m=[],o=0;o<r;o++){var v=e[o];v.fixed||(H(m,v.p,v.pp),EA(v.p,v.p,m,u),R(v.pp,v.p))}u*=.992,n&&n(e,t,u<.01)}}}function zu(e,t,n){var i=e.getBoxLayoutParams();return i.aspect=n,Ko(i,{width:t.getWidth(),height:t.getHeight()})}function Nu(e,t){var n=e.get("center"),i=t.getWidth(),r=t.getHeight(),o=Math.min(i,r);return{cx:Si(n[0],t.getWidth()),cy:Si(n[1],t.getHeight()),r:Si(e.get("radius"),o/2)}}function Eu(e,t){return t&&("string"==typeof t?e=t.replace("{value}",null!=e?e:""):"function"==typeof t&&(e=t(e))),e}function Ru(e,t){function i(){o.ignore=o.hoverIgnore,a.ignore=a.hoverIgnore}function n(){o.ignore=o.normalIgnore,a.ignore=a.normalIgnore}X_.call(this);var r=new hb,o=new pb,a=new rb;this.add(r),this.add(o),this.add(a),this.updateData(e,t,!0),this.on("emphasis",i).on("normal",n).on("mouseover",i).on("mouseout",n)}function Vu(e,t){return Ko(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function Bu(e,t){for(var n=e.mapArray("value",function(e){return e}),i=[],r="ascending"===t,o=0,a=e.count();o<a;o++)i[o]=o;return"function"==typeof t?i.sort(t):"none"!==t&&i.sort(function(e,t){return r?n[e]-n[t]:n[t]-n[e]}),i}function Gu(e){e.each(function(t){var n,i,r,o,a=e.getItemModel(t),s=a.getModel("label.normal").get("position"),l=a.getModel("labelLine.normal"),c=e.getItemLayout(t),u=c.points,d="inner"===s||"inside"===s||"center"===s;if(d)n="center",o=[[i=(u[0][0]+u[1][0]+u[2][0]+u[3][0])/4,r=(u[0][1]+u[1][1]+u[2][1]+u[3][1])/4],[i,r]];else{var h,p,f,g=l.get("length");"left"===s?(h=(u[3][0]+u[0][0])/2,p=(u[3][1]+u[0][1])/2,i=(f=h-g)-5,n="right"):(h=(u[1][0]+u[2][0])/2,p=(u[1][1]+u[2][1])/2,i=(f=h+g)+5,n="left");var m=p;o=[[h,p],[f,m]],r=m}c.label={linePoints:o,x:i,y:r,verticalAlign:"middle",textAlign:n,inside:d}})}function Wu(e){if(!e.parallel){var t=!1;d(e.series,function(e){e&&"parallel"===e.type&&(t=!0)}),t&&(e.parallel=[{}])}}function Hu(e){d(Oo(e.parallelAxis),function(t){if(b(t)){var i=t.parallelIndex||0,r=Oo(e.parallel)[i];r&&r.parallelAxisDefault&&n(t,r.parallelAxisDefault,!1)}})}function Fu(e,t){var n=e[t]-e[1-t];return{span:Math.abs(n),sign:n>0?-1:n<0?1:t?-1:1}}function Zu(e,t){return Math.min(t[1],Math.max(t[0],e))}function Uu(e,t,n){this._axesMap=z(),this._axesLayout={},this.dimensions=e.dimensions,this._rect,this._model=e,this._init(e,t,n)}function Xu(e,t){return zA(FA(e,t[0]),t[1])}function ju(e,t){var n=t.layoutLength/(t.axisCount-1);return{position:n*e,axisNameAvailableWidth:n,axisLabelShow:!0}}function qu(e,t){var n,i,r=t.layoutLength,o=t.axisExpandWidth,a=t.axisCount,s=t.axisCollapseWidth,l=t.winInnerIndices,c=s,u=!1;return e<l[0]?(n=e*s,i=s):e<=l[1]?(n=t.axisExpandWindow0Pos+e*o-t.axisExpandWindow[0],c=o,u=!0):(n=r-(a-1-e)*s,i=s),{position:n,axisNameAvailableWidth:c,axisLabelShow:u,nameTruncateMaxWidth:i}}function Yu(e){g_.call(this),this._zr=e,this.group=new X_,this._brushType,this._brushOption,this._panels,this._track=[],this._dragging,this._covers=[],this._creatingCover,this._creatingPanel,this._enableGlobalPan,this._uid="brushController_"+rM++,this._handlers={},qA(oM,function(e,t){this._handlers[t]=m(e,this)},this)}function $u(e,t){var r=e._zr;e._enableGlobalPan||Al(r,eM,e._uid),qA(e._handlers,function(e,t){r.on(t,e)}),e._brushType=t.brushType,e._brushOption=n(i(iM),t,!0)}function Ku(e){var t=e._zr;Cl(t,eM,e._uid),qA(e._handlers,function(e,n){t.off(n,e)}),e._brushType=e._brushOption=null}function Ju(e,t){var n=aM[t.brushType].createCover(e,t);return n.__brushOption=t,ec(n,t),e.group.add(n),n}function Qu(e,t){var n=nc(t);return n.endCreating&&(n.endCreating(e,t),ec(t,t.__brushOption)),t}function tc(e,t){var n=t.__brushOption;nc(t).updateCoverShape(e,t,n.range,n)}function ec(e,t){var n=t.z;null==n&&(n=KA),e.traverse(function(e){e.z=n,e.z2=n})}function ic(e,t){nc(t).updateCommon(e,t),tc(e,t)}function nc(e){return aM[e.__brushOption.brushType]}function oc(e,t,n){var i=e._panels;if(!i)return!0;var r,o=e._transform;return qA(i,function(e){e.isTargetByCursor(t,n,o)&&(r=e)}),r}function ac(e,t){var n=e._panels;if(!n)return!0;var i=t.__brushOption.panelId;return null==i||n[i]}function rc(e){var t=e._covers,n=t.length;return qA(t,function(t){e.group.remove(t)},e),t.length=0,!!n}function sc(e,t){var n=jA(e._covers,function(e){var t=e.__brushOption,n=i(t.range);return{brushType:t.brushType,panelId:t.panelId,range:n}});e.trigger("brush",n,{isEnd:!!t.isEnd,removeOnClick:!!t.removeOnClick})}function lc(e){var t=e._track;if(!t.length)return!1;var n=t[t.length-1],i=t[0],r=n[0]-i[0],o=n[1]-i[1];return ZA(r*r+o*o,.5)>JA}function hc(e){var t=e.length-1;return t<0&&(t=0),[e[0],e[t]]}function uc(e,t,n,i){var r=new X_;return r.add(new fb({name:"main",style:pc(n),silent:!0,draggable:!0,cursor:"move",drift:GA(e,t,r,"nswe"),ondragend:GA(sc,t,{isEnd:!0})})),qA(i,function(n){r.add(new fb({name:n,style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:GA(e,t,r,n),ondragend:GA(sc,t,{isEnd:!0})}))}),r}function cc(e,t,n,i){var r=i.brushStyle.lineWidth||0,o=XA(r,QA),a=n[0][0],s=n[1][0],l=a-r/2,c=s-r/2,u=n[0][1],d=n[1][1],h=u-o+r/2,p=d-o+r/2,f=u-a,g=d-s,m=f+r,v=g+r;fc(e,t,"main",a,s,f,g),i.transformable&&(fc(e,t,"w",l,c,o,v),fc(e,t,"e",h,c,o,v),fc(e,t,"n",l,c,m,o),fc(e,t,"s",l,p,m,o),fc(e,t,"nw",l,c,o,o),fc(e,t,"ne",h,c,o,o),fc(e,t,"sw",l,p,o,o),fc(e,t,"se",h,p,o,o))}function dc(e,t){var n=t.__brushOption,i=n.transformable,r=t.childAt(0);r.useStyle(pc(n)),r.attr({silent:!i,cursor:i?"move":"default"}),qA(["w","e","n","s","se","sw","ne","nw"],function(n){var r=t.childOfName(n),o=vc(e,n);r&&r.attr({silent:!i,invisible:!i,cursor:i?nM[o]+"-resize":null})})}function fc(e,t,n,i,r,o,a){var s=t.childOfName(n);s&&s.setShape(wc(bc(e,t,[[i,r],[i+o,r+a]])))}function pc(e){return r({strokeNoScale:!0},e.brushStyle)}function gc(e,t,n,i){var r=[YA(e,n),YA(t,i)],o=[XA(e,n),XA(t,i)];return[[r[0],o[0]],[r[1],o[1]]]}function mc(e){return Mo(e.group)}function vc(e,t){if(t.length>1)return("e"===(i=[vc(e,(t=t.split(""))[0]),vc(e,t[1])])[0]||"w"===i[0])&&i.reverse(),i.join("");var n={left:"w",right:"e",top:"n",bottom:"s"},i=To({w:"left",e:"right",n:"top",s:"bottom"}[t],mc(e));return n[i]}function yc(e,t,n,i,r,o,a,s){var l=i.__brushOption,c=e(l.range),u=_c(n,o,a);qA(r.split(""),function(e){var t=tM[e];c[t[0]][t[1]]+=u[t[0]]}),l.range=t(gc(c[0][0],c[1][0],c[0][1],c[1][1])),ic(n,i),sc(n,{isEnd:!1})}function xc(e,t,n,i,r){var o=t.__brushOption.range,a=_c(e,n,i);qA(o,function(e){e[0]+=a[0],e[1]+=a[1]}),ic(e,t),sc(e,{isEnd:!1})}function _c(e,t,n){var i=e.group,r=i.transformCoordToLocal(t,n),o=i.transformCoordToLocal(0,0);return[r[0]-o[0],r[1]-o[1]]}function bc(e,t,n){var r=ac(e,t);return r&&!0!==r?r.clipPath(n,e._transform):i(n)}function wc(e){var t=YA(e[0][0],e[1][0]),n=YA(e[0][1],e[1][1]);return{x:t,y:n,width:XA(e[0][0],e[1][0])-t,height:XA(e[0][1],e[1][1])-n}}function Sc(e,t,n){if(e._brushType){var i=e._zr,r=e._covers,o=oc(e,t,n);if(!e._dragging)for(var a=0;a<r.length;a++){var s=r[a].__brushOption;if(o&&(!0===o||s.panelId===o.panelId)&&aM[s.brushType].contain(r[a],n[0],n[1]))return}o&&i.setCursorStyle("crosshair")}}function Mc(e){var t=e.event;t.preventDefault&&t.preventDefault()}function Ic(e,t,n){return e.childOfName("main").contain(t,n)}function Tc(e,t,n,r){var o,a=e._creatingCover,s=e._creatingPanel,l=e._brushOption;if(e._track.push(n.slice()),lc(e)||a){if(s&&!a){"single"===l.brushMode&&rc(e);var c=i(l);c.brushType=Ac(c.brushType,s),c.panelId=!0===s?null:s.panelId,a=e._creatingCover=Ju(e,c),e._covers.push(a)}if(a){var u=aM[Ac(e._brushType,s)];a.__brushOption.range=u.getCreatingRange(bc(e,a,e._track)),r&&(Qu(e,a),u.updateCommon(e,a)),tc(e,a),o={isEnd:r}}}else r&&"single"===l.brushMode&&l.removeOnClick&&oc(e,t,n)&&rc(e)&&(o={isEnd:r,removeOnClick:!0});return o}function Ac(e,t){return"auto"===e?t.defaultBrushType:e}function Cc(e){if(this._dragging){Mc(e);var t=Tc(this,e,this.group.transformCoordToLocal(e.offsetX,e.offsetY),!0);this._dragging=!1,this._track=[],this._creatingCover=null,t&&sc(this,t)}}function Dc(e){return{createCover:function(t,n){return uc(GA(yc,function(t){var n=[t,[0,100]];return e&&n.reverse(),n},function(t){return t[e]}),t,n,[["w","e"],["n","s"]][e])},getCreatingRange:function(t){var n=hc(t);return[YA(n[0][e],n[1][e]),XA(n[0][e],n[1][e])]},updateCoverShape:function(t,n,i,r){var o,a=ac(t,n);if(!0!==a&&a.getLinearBrushOtherExtent)o=a.getLinearBrushOtherExtent(e,t._transform);else{var s=t._zr;o=[0,[s.getWidth(),s.getHeight()][1-e]]}var l=[i,o];e&&l.reverse(),cc(t,n,l,r)},updateCommon:dc,contain:Ic}}function Lc(e){return e=Oc(e),function(t,n){return Co(t,e)}}function kc(e,t){return e=Oc(e),function(n){var i=null!=t?t:n,r=i?e.width:e.height,o=i?e.x:e.y;return[o,o+(r||0)]}}function Pc(e,t,n){return e=Oc(e),function(i,r,o){return e.contain(r[0],r[1])&&!Wl(i,t,n)}}function Oc(e){return jt.create(e)}function zc(e,t,n){return n&&"axisAreaSelect"===n.type&&t.findComponents({mainType:"parallelAxis",query:n})[0]===e}function Nc(e){var t=e.axis;return f(e.activeIntervals,function(e){return{brushType:"lineX",panelId:"pl",range:[t.dataToCoord(e[0],!0),t.dataToCoord(e[1],!0)]}})}function Ec(e,t){return t.getComponent("parallel",e.get("parallelIndex"))}function Rc(e,t){var n=e._model;return n.get("axisExpandable")&&n.get("axisExpandTriggerOn")===t}function Vc(e,t,n){var i=e.get("data"),r=Bc(t);i&&i.length&&d(n,function(e){if(e){var t=l(i,e[r]);e[r]=t>=0?t:NaN}})}function Bc(e){return+e.replace("dim","")}function Gc(e,t){var n=0;d(e,function(e){var t=Bc(e);t>n&&(n=t)});var i=t[0];i&&i.length-1>n&&(n=i.length-1);for(var r=[],o=0;o<=n;o++)r.push("dim"+o);return r}function Wc(e,t,n){var i=e.model,r=e.getRect(),o=new fb({shape:{x:r.x,y:r.y,width:r.width,height:r.height}}),a="horizontal"===i.get("layout")?"width":"height";return o.setShape(a,0),So(o,{shape:{width:r.width,height:r.height}},t,n),o}function Hc(e,t,n,i){for(var r=[],o=0;o<n.length;o++){var a=n[o],s=e.get(a,t);Uc(s,i.getAxis(a).type)||r.push(i.dataToPoint(s,a))}return r}function Fc(e,t,n,i,r){var o=Hc(e,n,i,r),a=new pb({shape:{points:o},silent:!0,z2:10});t.add(a),e.setItemGraphicEl(n,a)}function Zc(e,t){var n=e.hostModel.getModel("lineStyle.normal"),i=n.getLineStyle();e.eachItemGraphicEl(function(r,o){if(e.hasItemOption){var s=e.getItemModel(o).getModel("lineStyle.normal",n);i=s.getLineStyle(["color","stroke"])}r.useStyle(a(i,{fill:null,stroke:e.getItemVisual(o,"color"),opacity:e.getItemVisual(o,"opacity")})),r.shape.smooth=t})}function Uc(e,t){return"category"===t?null==e:null==e||isNaN(e)}function Xc(e,t,n){var i=new fb({shape:{x:e.x-10,y:e.y-10,width:0,height:e.height+20}});return So(i,{shape:{width:e.width+20,height:e.height+20}},t,n),i}function jc(){function t(e,i){if(i>=n.length)return e;for(var r=-1,o=e.length,a=n[i++],s={},l={};++r<o;){var c=a(e[r]),u=l[c];u?u.push(e[r]):l[c]=[e[r]]}return d(l,function(e,n){s[n]=t(e,i)}),s}function e(t,r){if(r>=n.length)return t;var o=[],a=i[r++];return d(t,function(t,n){o.push({key:n,values:e(t,r)})}),a?o.sort(function(e,t){return a(e.key,t.key)}):o}var n=[],i=[];return{key:function(e){return n.push(e),this},sortKeys:function(e){return i[n.length-1]=e,this},entries:function(n){return e(t(n,0),0)}}}function qc(e,t){return Ko(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function Yc(e,t,n,i,r,o,a){Kc(e,n,r),td(e,t,o,i,a),sd(e)}function $c(e){d(e,function(e){var t=ud(e.outEdges,pd),n=ud(e.inEdges,pd),i=Math.max(t,n);e.setLayout({value:i},!0)})}function Kc(e,t,n){for(var i=e,r=null,o=0;i.length;){r=[];for(var a=0,s=i.length;a<s;a++){var l=i[a];l.setLayout({x:o},!0),l.setLayout({dx:t},!0);for(var c=0,u=l.outEdges.length;c<u;c++)r.push(l.outEdges[c].node2)}i=r,++o}Jc(e,o),Qc(e,(n-t)/(o-1))}function Jc(e,t){d(e,function(e){e.outEdges.length||e.setLayout({x:t-1},!0)})}function Qc(e,t){d(e,function(e){var n=e.getLayout().x*t;e.setLayout({x:n},!0)})}function td(e,t,n,i,r){var o=jc().key(function(e){return e.getLayout().x}).sortKeys(fd).entries(e).map(function(e){return e.values});ed(e,o,t,n,i),id(o,i,n);for(var a=1;r>0;r--)nd(o,a*=.99),id(o,i,n),ad(o,a),id(o,i,n)}function ed(e,t,n,i,r){var o=[];d(t,function(e){var t=e.length,n=0;d(e,function(e){n+=e.getLayout().value});var a=(i-(t-1)*r)/n;o.push(a)}),o.sort(function(e,t){return e-t});var a=o[0];d(t,function(e){d(e,function(e,t){e.setLayout({y:t},!0);var n=e.getLayout().value*a;e.setLayout({dy:n},!0)})}),d(n,function(e){var t=+e.getValue()*a;e.setLayout({dy:t},!0)})}function id(e,t,n){d(e,function(e){var i,r,o,a=0,s=e.length;for(e.sort(dd),o=0;o<s;o++)i=e[o],(r=a-i.getLayout().y)>0&&(l=i.getLayout().y+r,i.setLayout({y:l},!0)),a=i.getLayout().y+i.getLayout().dy+t;if((r=a-t-n)>0){var l=i.getLayout().y-r;for(i.setLayout({y:l},!0),a=i.getLayout().y,o=s-2;o>=0;--o)(r=(i=e[o]).getLayout().y+i.getLayout().dy+t-a)>0&&(l=i.getLayout().y-r,i.setLayout({y:l},!0)),a=i.getLayout().y}})}function nd(e,t){d(e.slice().reverse(),function(e){d(e,function(e){if(e.outEdges.length){var n=ud(e.outEdges,od)/ud(e.outEdges,pd),i=e.getLayout().y+(n-cd(e))*t;e.setLayout({y:i},!0)}})})}function od(e){return cd(e.node2)*e.getValue()}function ad(e,t){d(e,function(e){d(e,function(e){if(e.inEdges.length){var n=ud(e.inEdges,rd)/ud(e.inEdges,pd),i=e.getLayout().y+(n-cd(e))*t;e.setLayout({y:i},!0)}})})}function rd(e){return cd(e.node1)*e.getValue()}function sd(e){d(e,function(e){e.outEdges.sort(ld),e.inEdges.sort(hd)}),d(e,function(e){var t=0,n=0;d(e.outEdges,function(e){e.setLayout({sy:t},!0),t+=e.getLayout().dy}),d(e.inEdges,function(e){e.setLayout({ty:n},!0),n+=e.getLayout().dy})})}function ld(e,t){return e.node2.getLayout().y-t.node2.getLayout().y}function hd(e,t){return e.node1.getLayout().y-t.node1.getLayout().y}function ud(e,t){for(var n=0,i=e.length,r=-1;++r<i;){var o=+t.call(e,e[r],r);isNaN(o)||(n+=o)}return n}function cd(e){return e.getLayout().y+e.getLayout().dy/2}function dd(e,t){return e.getLayout().y-t.getLayout().y}function fd(e,t){return e<t?-1:e>t?1:e===t?0:NaN}function pd(e){return e.getValue()}function gd(e,t,n,i){X_.call(this),this.bodyIndex,this.whiskerIndex,this.styleUpdater=n,this._createContent(e,t,i),this.updateData(e,t,i),this._seriesModel}function md(e,t,n){return f(e,function(e){return e=e.slice(),e[t]=n.initBaseline,e})}function vd(e){var t={};return d(e,function(e,n){t["ends"+n]=e}),t}function yd(e){this.group=new X_,this.styleUpdater=e}function xd(e,t,n){var i=t.getItemModel(n),r=i.getModel(_M),o=t.getItemVisual(n,"color"),a=r.getItemStyle(["borderColor"]),s=e.childAt(e.whiskerIndex);s.style.set(a),s.style.stroke=o,s.dirty();var l=e.childAt(e.bodyIndex);l.style.set(a),l.style.stroke=o,l.dirty(),uo(e,i.getModel(yM).getItemStyle())}function _d(e){var t=[],n=[];return e.eachSeriesByType("boxplot",function(e){var i=e.getBaseAxis(),r=l(n,i);r<0&&(r=n.length,n[r]=i,t[r]={axis:i,seriesModels:[]}),t[r].seriesModels.push(e)}),t}function bd(e){var t,n,i=e.axis,r=e.seriesModels,o=r.length,a=e.boxWidthList=[],s=e.boxOffsetList=[],l=[];if("category"===i.type)n=i.getBandWidth();else{var c=0;bM(r,function(e){c=Math.max(c,e.getData().count())}),t=i.getExtent(),Math.abs(t[1]-t[0])}bM(r,function(e){var t=e.get("boxWidth");y(t)||(t=[t,t]),l.push([Si(t[0],n)||0,Si(t[1],n)||0])});var u=.8*n-2,d=u/o*.3,h=(u-d*(o-1))/o,p=h/2-u/2;bM(r,function(e,t){s.push(p),p+=d+h,a.push(Math.min(Math.max(h,l[t][0]),l[t][1]))})}function wd(e,r,o){var a,s=e.coordinateSystem,l=e.getData(),c=o/2,u=e.get("layout"),h="horizontal"===u?0:1,p=1-h,f=["x","y"],g=[];d(l.dimensions,function(e){var t=l.getDimensionInfo(e).coordDim;t===f[p]?g.push(e):t===f[h]&&(a=e)}),null==a||g.length<5||l.each([a].concat(g),function(){function t(e){var t=[];t[h]=o,t[p]=e;var n;return isNaN(o)||isNaN(e)?n=[NaN,NaN]:(n=s.dataToPoint(t))[h]+=r,n}function i(e,t){var n=e.slice(),i=e.slice();n[h]+=c,i[h]-=c,t?_.push(n,i):_.push(i,n)}function n(e){var t=[e.slice(),e.slice()];t[0][h]-=c,t[1][h]+=c,v.push(t)}var e=arguments,o=e[0],a=e[g.length+1],d=t(e[3]),f=t(e[1]),m=t(e[5]),v=[[f,t(e[2])],[m,t(e[4])]];n(f),n(m),n(d);var _=[];i(v[0][1],0),i(v[1][1],1),l.setItemLayout(a,{chartLayout:u,initBaseline:d[p],median:d,bodyEnds:_,whiskerEnds:v})})}function Sd(e,t,n){var i=t.getItemModel(n),r=i.getModel(wM),o=t.getItemVisual(n,"color"),a=t.getItemVisual(n,"borderColor")||o,s=r.getItemStyle(["color","color0","borderColor","borderColor0"]),l=e.childAt(e.whiskerIndex);l.useStyle(s),l.style.stroke=a;var c=e.childAt(e.bodyIndex);c.useStyle(s),c.style.fill=o,c.style.stroke=a,uo(e,i.getModel(CM).getItemStyle())}function Md(e,t){var n,i=e.getBaseAxis(),r="category"===i.type?i.getBandWidth():(n=i.getExtent(),Math.abs(n[1]-n[0])/t.count()),o=Si(EM(e.get("barMaxWidth"),r),r),a=Si(EM(e.get("barMinWidth"),1),r),s=e.get("barWidth");return null!=s?Si(s,r):Math.max(Math.min(r/2,o),a)}function Id(e){return y(e)||(e=[+e,+e]),e}function Td(e,t){e.eachChild(function(e){e.attr({z:t.z,zlevel:t.zlevel,style:{stroke:"stroke"===t.brushType?t.color:null,fill:"fill"===t.brushType?t.color:null}})})}function Ad(e,t){X_.call(this);var n=new Jr(e,t),i=new X_;this.add(n),this.add(i),i.beforeUpdate=function(){this.attr(n.getScale())},this.updateData(e,t)}function Cd(e){var t=e.data;t&&t[0]&&t[0][0]&&t[0][0].coord&&(e.data=f(t,function(e){var t={coords:[e[0].coord,e[1].coord]};return e[0].name&&(t.fromName=e[0].name),e[1].name&&(t.toName=e[1].name),o([t,e[0],e[1]])}))}function Dd(e,t,n){X_.call(this),this.add(this.createLine(e,t,n)),this._updateEffectSymbol(e,t)}function Ld(e,t,n){X_.call(this),this._createPolyline(e,t,n)}function kd(e,t,n){Dd.call(this,e,t,n),this._lastFrame=0,this._lastFramePercent=0}function Pd(){this.group=new X_,this._lineEl=new PM}function Od(e){return e instanceof Array||(e=[e,e]),e}function zd(){var e=r_();this.canvas=e,this.blurSize=30,this.pointSize=20,this.maxOpacity=1,this.minOpacity=0,this._gradientPixels={}}function Nd(e,t,n){var i=e[1]-e[0],r=(t=f(t,function(t){return{interval:[(t.interval[0]-e[0])/i,(t.interval[1]-e[0])/i]}})).length,o=0;return function(e){for(i=o;i<r;i++)if((a=t[i].interval)[0]<=e&&e<=a[1]){o=i;break}if(i===r)for(var i=o-1;i>=0;i--){var a=t[i].interval;if(a[0]<=e&&e<=a[1]){o=i;break}}return i>=0&&i<r&&n[i]}}function Ed(e,t){var n=e[1]-e[0];return t=[(t[0]-e[0])/n,(t[1]-e[0])/n],function(e){return e>=t[0]&&e<=t[1]}}function Rd(e){var t=e.dimensions;return"lng"===t[0]&&"lat"===t[1]}function Vd(e,t,n,i){var r=e.getItemLayout(t),o=n.get("symbolRepeat"),a=n.get("symbolClip"),s=n.get("symbolPosition")||"start",l=(n.get("symbolRotate")||0)*Math.PI/180||0,c=n.get("symbolPatternSize")||2,u=n.isAnimationEnabled(),d={dataIndex:t,layout:r,itemModel:n,symbolType:e.getItemVisual(t,"symbol")||"circle",color:e.getItemVisual(t,"color"),symbolClip:a,symbolRepeat:o,symbolRepeatDirection:n.get("symbolRepeatDirection"),symbolPatternSize:c,rotation:l,animationModel:u?n:null,hoverAnimation:u&&n.get("hoverAnimation"),z2:n.getShallow("z",!0)||0};Bd(n,o,r,i,d),Wd(e,t,r,o,a,d.boundingLength,d.pxSign,c,i,d),Hd(n,d.symbolScale,l,i,d);var h=d.symbolSize,p=n.get("symbolOffset");return y(p)&&(p=[Si(p[0],h[0]),Si(p[1],h[1])]),Fd(n,h,r,o,a,p,s,d.valueLineWidth,d.boundingLength,d.repeatCutLength,i,d),d}function Bd(e,t,n,i,r){var o,a=i.valueDim,s=e.get("symbolBoundingData"),l=i.coordSys.getOtherAxis(i.coordSys.getBaseAxis()),c=l.toGlobalCoord(l.dataToCoord(0)),u=1-+(n[a.wh]<=0);if(y(s)){var d=[Gd(l,s[0])-c,Gd(l,s[1])-c];d[1]<d[0]&&d.reverse(),o=d[u]}else o=null!=s?Gd(l,s)-c:t?i.coordSysExtent[a.index][u]-c:n[a.wh];r.boundingLength=o,t&&(r.repeatCutLength=n[a.wh]),r.pxSign=o>0?1:o<0?-1:0}function Gd(e,t){return e.toGlobalCoord(e.dataToCoord(e.scale.parse(t)))}function Wd(e,t,n,i,r,o,a,s,l,c){var u=l.valueDim,d=l.categoryDim,h=Math.abs(n[d.wh]),p=e.getItemVisual(t,"symbolSize");y(p)?p=p.slice():(null==p&&(p="100%"),p=[p,p]),p[d.index]=Si(p[d.index],h),p[u.index]=Si(p[u.index],i?h:Math.abs(o)),c.symbolSize=p,(c.symbolScale=[p[0]/s,p[1]/s])[u.index]*=(l.isHorizontal?-1:1)*a}function Hd(e,t,n,i,r){var o=e.get(zM)||0;o&&(BM.attr({scale:t.slice(),rotation:n}),BM.updateTransform(),o/=BM.getLineScale(),o*=t[i.valueDim.index]),r.valueLineWidth=o}function Fd(e,t,n,i,r,o,s,l,c,u,d,h){var p=d.categoryDim,f=d.valueDim,g=h.pxSign,m=Math.max(t[f.index]+l,0),v=m;if(i){var _=Math.abs(c),y=I(e.get("symbolMargin"),"15%")+"",x=!1;y.lastIndexOf("!")===y.length-1&&(x=!0,y=y.slice(0,y.length-1)),y=Si(y,t[f.index]);var b=Math.max(m+2*y,0),w=x?0:2*y,C=Ri(i),S=C?i:sf((_+w)/b);b=m+2*(y=(_-S*m)/2/(x?S:S-1)),w=x?0:2*y,C||"fixed"===i||(S=u?sf((Math.abs(u)+w)/b):0),v=S*b-w,h.repeatTimes=S,h.symbolMargin=y}var T=g*(v/2),A=h.pathPosition=[];A[p.index]=n[p.wh]/2,A[f.index]="start"===s?T:"end"===s?c-T:c/2,o&&(A[0]+=o[0],A[1]+=o[1]);var M=h.bundlePosition=[];M[p.index]=n[p.xy],M[f.index]=n[f.xy];var E=h.barRectShape=a({},n);E[f.wh]=g*Math.max(Math.abs(n[f.wh]),Math.abs(A[f.index]+T)),E[p.wh]=n[p.wh];var D=h.clipShape={};D[p.xy]=-n[p.xy],D[p.wh]=d.ecSize[p.wh],D[f.xy]=0,D[f.wh]=n[f.wh]}function Zd(e){var t=e.symbolPatternSize,n=Hr(e.symbolType,-t/2,-t/2,t,t,e.color);return n.attr({culling:!0}),"image"!==n.type&&n.setStyle({strokeNoScale:!0}),n}function Ud(e,t,n,i){function o(e){var t=l.slice(),i=n.pxSign,r=e;return("start"===n.symbolRepeatDirection?i>0:i<0)&&(r=u-1-e),t[c.index]=h*(r-u/2+.5)+l[c.index],{position:t,scale:n.symbolScale.slice(),rotation:n.rotation}}var r=e.__pictorialBundle,a=n.symbolSize,s=n.valueLineWidth,l=n.pathPosition,c=t.valueDim,u=n.repeatTimes||0,d=0,h=a[t.valueDim.index]+s+2*n.symbolMargin;for(of(e,function(e){e.__pictorialAnimationIndex=d,e.__pictorialRepeatTimes=u,d<u?af(e,null,o(d),n,i):af(e,null,{scale:[0,0]},n,i,function(){r.remove(e)}),Jd(e,n),d++});d<u;d++){var p=Zd(n);p.__pictorialAnimationIndex=d,p.__pictorialRepeatTimes=u,r.add(p);var f=o(d);af(p,{position:f.position,scale:[0,0]},{scale:f.scale,rotation:f.rotation},n,i),p.on("mouseover",function(){of(e,function(e){e.trigger("emphasis")})}).on("mouseout",function(){of(e,function(e){e.trigger("normal")})}),Jd(p,n)}}function Xd(e,t,n,i){var r=e.__pictorialBundle,o=e.__pictorialMainPath;o?af(o,null,{position:n.pathPosition.slice(),scale:n.symbolScale.slice(),rotation:n.rotation},n,i):(o=e.__pictorialMainPath=Zd(n),r.add(o),af(o,{position:n.pathPosition.slice(),scale:[0,0],rotation:n.rotation},{scale:n.symbolScale.slice()},n,i),o.on("mouseover",function(){this.trigger("emphasis")}).on("mouseout",function(){this.trigger("normal")})),Jd(o,n)}function jd(e,t,n){var i=a({},t.barRectShape),r=e.__pictorialBarRect;r?af(r,null,{shape:i},t,n):(r=e.__pictorialBarRect=new fb({z2:2,shape:i,silent:!0,style:{stroke:"transparent",fill:"transparent",lineWidth:0}}),e.add(r))}function qd(e,t,n,i){if(n.symbolClip){var r=e.__pictorialClipPath,o=a({},n.clipShape),s=t.valueDim,l=n.animationModel,c=n.dataIndex;if(r)wo(r,{shape:o},l,c);else{o[s.wh]=0,r=new fb({shape:o}),e.__pictorialBundle.setClipPath(r),e.__pictorialClipPath=r;var u={};u[s.wh]=n.clipShape[s.wh],Eb[i?"updateProps":"initProps"](r,{shape:u},l,c)}}}function Yd(e,t){var n=e.getItemModel(t);return n.getAnimationDelayParams=$d,n.isAnimationEnabled=Kd,n}function $d(e){return{index:e.__pictorialAnimationIndex,count:e.__pictorialRepeatTimes}}function Kd(){return this.parentModel.isAnimationEnabled()&&!!this.getShallow("animation")}function Jd(e,t){e.off("emphasis").off("normal");var n=t.symbolScale.slice();t.hoverAnimation&&e.on("emphasis",function(){this.animateTo({scale:[1.1*n[0],1.1*n[1]]},400,"elasticOut")}).on("normal",function(){this.animateTo({scale:n.slice()},400,"elasticOut")})}function Qd(e,t,n,i){var r=new X_,o=new X_;return r.add(o),r.__pictorialBundle=o,o.attr("position",n.bundlePosition.slice()),n.symbolRepeat?Ud(r,t,n):Xd(r,t,n),jd(r,n,i),qd(r,t,n,i),r.__pictorialShapeStr=nf(e,n),r.__pictorialSymbolMeta=n,r}function tf(e,t,n){var i=n.animationModel,r=n.dataIndex;wo(e.__pictorialBundle,{position:n.bundlePosition.slice()},i,r),n.symbolRepeat?Ud(e,t,n,!0):Xd(e,t,n,!0),jd(e,n,!0),qd(e,t,n,!0)}function ef(e,t,n,i){var r=i.__pictorialBarRect;r&&(r.style.text=null);var o=[];of(i,function(e){o.push(e)}),i.__pictorialMainPath&&o.push(i.__pictorialMainPath),i.__pictorialClipPath&&(n=null),d(o,function(e){wo(e,{scale:[0,0]},n,t,function(){i.parent&&i.parent.remove(i)})}),e.setItemGraphicEl(t,null)}function nf(e,t){return[e.getItemVisual(t.dataIndex,"symbol")||"none",!!t.symbolRepeat,!!t.symbolClip].join(":")}function of(e,t,n){d(e.__pictorialBundle.children(),function(i){i!==e.__pictorialBarRect&&t.call(n,i)})}function af(e,t,n,i,r,o){t&&e.attr(t),i.symbolClip&&!r?n&&e.attr(n):n&&Eb[r?"updateProps":"initProps"](e,n,i.animationModel,i.dataIndex,o)}function rf(e,t,n){var i=n.color,o=n.dataIndex,a=n.itemModel,s=a.getModel("itemStyle.normal").getItemStyle(["color"]),l=a.getModel("itemStyle.emphasis").getItemStyle(),c=a.getShallow("cursor");of(e,function(e){e.setColor(i),e.setStyle(r({fill:i,opacity:n.opacity},s)),uo(e,l),c&&(e.cursor=c),e.z2=n.z2});var u={},d=t.valueDim.posDesc[+(n.boundingLength>0)],h=e.__pictorialBarRect;ol(h.style,u,a,i,t.seriesModel,o,d),uo(h,u)}function sf(e){var t=Math.round(e);return Math.abs(e-t)<1e-4?t:Math.ceil(e)}function lf(e,t,n){this.dimension="single",this.dimensions=["single"],this._axis=null,this._rect,this._init(e,t,n),this.model=e}function hf(e,t){t=t||{};var n=e.coordinateSystem,i=e.axis,r={},o=i.position,a=i.orient,s=n.getRect(),l=[s.x,s.x+s.width,s.y,s.y+s.height],c={horizontal:{top:l[2],bottom:l[3]},vertical:{left:l[0],right:l[1]}};r.position=["vertical"===a?c.vertical[o]:l[0],"horizontal"===a?c.horizontal[o]:l[3]];var u={horizontal:0,vertical:1};r.rotation=Math.PI/2*u[a];var d={top:-1,bottom:1,right:1,left:-1};r.labelDirection=r.tickDirection=r.nameDirection=d[o],e.get("axisTick.inside")&&(r.tickDirection=-r.tickDirection),I(t.labelInside,e.get("axisLabel.inside"))&&(r.labelDirection=-r.labelDirection);var h=t.rotate;return null==h&&(h=e.get("axisLabel.rotate")),r.labelRotation="top"===o?-h:h,r.labelInterval=i.getLabelInterval(),r.z2=1,r}function uf(e,t,n,i,r){var o=e.axis;if(!o.scale.isBlank()&&o.containData(t))if(e.involveSeries){var s=cf(t,e),l=s.payloadBatch,c=s.snapToValue;l[0]&&null==r.seriesIndex&&a(r,l[0]),!i&&e.snap&&o.containData(c)&&null!=c&&(t=c),n.showPointer(e,t,l,r),n.showTooltip(e,s,c)}else n.showPointer(e,t)}function cf(e,t){var n=t.axis,i=n.dim,r=e,o=[],a=Number.MAX_VALUE,s=-1;return YM(t.seriesModels,function(t,l){var c,u,d=t.coordDimToDataDim(i);if(t.getAxisTooltipData){var h=t.getAxisTooltipData(d,e,n);u=h.dataIndices,c=h.nestestValue}else{if(!(u=t.getData().indicesOfNearest(d[0],e,!1,"category"===n.type?.5:null)).length)return;c=t.getData().get(d[0],u[0])}if(null!=c&&isFinite(c)){var p=e-c,f=Math.abs(p);f<=a&&((f<a||p>=0&&s<0)&&(a=f,s=p,r=c,o.length=0),YM(u,function(e){o.push({seriesIndex:t.seriesIndex,dataIndexInside:e,dataIndex:t.getData().getRawIndex(e)})}))}}),{payloadBatch:o,snapToValue:r}}function df(e,t,n,i){e[t.key]={value:n,payloadBatch:i}}function ff(e,t,n,i){var r=n.payloadBatch,o=t.axis,a=o.model,s=t.axisPointerModel;if(t.triggerTooltip&&r.length){var l=t.coordSys.model,c=Ys(l),u=e.map[c];u||(u=e.map[c]={coordSysId:l.id,coordSysIndex:l.componentIndex,coordSysType:l.type,coordSysMainType:l.mainType,dataByAxis:[]},e.list.push(u)),u.dataByAxis.push({axisDim:o.dim,axisIndex:a.componentIndex,axisType:a.type,axisId:a.id,value:i,valueLabelOpt:{precision:s.get("label.precision"),formatter:s.get("label.formatter")},seriesDataIndices:r.slice()})}}function pf(e,t,n){var i=n.axesInfo=[];YM(t,function(t,n){var r=t.axisPointerModel.option,o=e[n];o?(!t.useHandle&&(r.status="show"),r.value=o.value,r.seriesDataIndices=(o.payloadBatch||[]).slice()):!t.useHandle&&(r.status="hide"),"show"===r.status&&i.push({axisDim:t.axis.dim,axisIndex:t.axis.model.componentIndex,value:r.value})})}function gf(e,t,n,i){if(!xf(t)&&e.list.length){var r=((e.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};i({type:"showTip",escapeConnect:!0,x:t[0],y:t[1],tooltipOption:n.tooltipOption,position:n.position,dataIndexInside:r.dataIndexInside,dataIndex:r.dataIndex,seriesIndex:r.seriesIndex,dataByCoordSys:e.list})}else i({type:"hideTip"})}function mf(e,t,n){var i=n.getZr(),r=ZM(i).axisPointerLastHighlights||{},o=ZM(i).axisPointerLastHighlights={};YM(e,function(e,t){var n=e.axisPointerModel.option;"show"===n.status&&YM(n.seriesDataIndices,function(e){var t=e.seriesIndex+" | "+e.dataIndex;o[t]=e})});var a=[],s=[];d(r,function(e,t){!o[t]&&s.push(e)}),d(o,function(e,t){!r[t]&&a.push(e)}),s.length&&n.dispatchAction({type:"downplay",escapeConnect:!0,batch:s}),a.length&&n.dispatchAction({type:"highlight",escapeConnect:!0,batch:a})}function vf(e,t){for(var n=0;n<(e||[]).length;n++){var i=e[n];if(t.axis.dim===i.axisDim&&t.axis.model.componentIndex===i.axisIndex)return i}}function yf(e){var t=e.axis.model,n={},i=n.axisDim=e.axis.dim;return n.axisIndex=n[i+"AxisIndex"]=t.componentIndex,n.axisName=n[i+"AxisName"]=t.name,n.axisId=n[i+"AxisId"]=t.id,n}function xf(e){return!e||null==e[0]||isNaN(e[0])||null==e[1]||isNaN(e[1])}function _f(e,t,n){if(!jv.node){var i=t.getZr();KM(i).records||(KM(i).records={}),bf(i,t),(KM(i).records[e]||(KM(i).records[e]={})).handler=n}}function bf(e,t){function i(n,i){e.on(n,function(n){var r=If(t);JM(KM(e).records,function(e){e&&i(e,n,r.dispatchAction)}),wf(r.pendings,t)})}KM(e).initialized||(KM(e).initialized=!0,i("click",v(Mf,"click")),i("mousemove",v(Mf,"mousemove")),i("globalout",Sf))}function wf(e,t){var n,i=e.showTip.length,r=e.hideTip.length;i?n=e.showTip[i-1]:r&&(n=e.hideTip[r-1]),n&&(n.dispatchAction=null,t.dispatchAction(n))}function Sf(e,t,n){e.handler("leave",null,n)}function Mf(e,t,n,i){t.handler(e,n,i)}function If(e){var t={showTip:[],hideTip:[]},n=function(i){var r=t[i.type];r?r.push(i):(i.dispatchAction=n,e.dispatchAction(i))};return{dispatchAction:n,pendings:t}}function Tf(e,t){if(!jv.node){var n=t.getZr();(KM(n).records||{})[e]&&(KM(n).records[e]=null)}}function Af(){}function Cf(e,t,n,i){Df(eE(n).lastProp,i)||(eE(n).lastProp=i,t?wo(n,i,e):(n.stopAnimation(),n.attr(i)))}function Df(e,t){if(b(e)&&b(t)){var n=!0;return d(t,function(t,i){n=n&&Df(e[i],t)}),!!n}return e===t}function Lf(e,t){e[t.get("label.show")?"show":"hide"]()}function kf(e){return{position:e.position.slice(),rotation:e.rotation||0}}function Pf(e,t,n){var i=t.get("z"),r=t.get("zlevel");e&&e.traverse(function(e){"group"!==e.type&&(null!=i&&(e.z=i),null!=r&&(e.zlevel=r),e.silent=n)})}function Of(e){var t,n=e.get("type"),i=e.getModel(n+"Style");return"line"===n?(t=i.getLineStyle()).fill=null:"shadow"===n&&((t=i.getAreaStyle()).stroke=null),t}function zf(e,t,n,i,r){var o=Ef(n.get("value"),t.axis,t.ecModel,n.get("seriesDataIndices"),{precision:n.get("label.precision"),formatter:n.get("label.formatter")}),a=n.getModel("label"),s=Wy(a.get("padding")||0),l=a.getFont(),c=de(o,l),u=r.position,d=c.width+s[1]+s[3],h=c.height+s[0]+s[2],p=r.align;"right"===p&&(u[0]-=d),"center"===p&&(u[0]-=d/2);var f=r.verticalAlign;"bottom"===f&&(u[1]-=h),"middle"===f&&(u[1]-=h/2),Nf(u,d,h,i);var g=a.get("backgroundColor");g&&"auto"!==g||(g=t.get("axisLine.lineStyle.color")),e.label={shape:{x:0,y:0,width:d,height:h,r:a.get("borderRadius")},position:u.slice(),style:{text:o,textFont:l,textFill:a.getTextColor(),textPosition:"inside",fill:g,stroke:a.get("borderColor")||"transparent",lineWidth:a.get("borderWidth")||0,shadowBlur:a.get("shadowBlur"),shadowColor:a.get("shadowColor"),shadowOffsetX:a.get("shadowOffsetX"),shadowOffsetY:a.get("shadowOffsetY")},z2:10}}function Nf(e,t,n,i){var r=i.getWidth(),o=i.getHeight();e[0]=Math.min(e[0]+t,r)-t,e[1]=Math.min(e[1]+n,o)-n,e[0]=Math.max(e[0],0),e[1]=Math.max(e[1],0)}function Ef(e,t,n,i,r){var o=t.scale.getLabel(e,{precision:r.precision}),a=r.formatter;if(a){var s={value:Br(t,e),seriesData:[]};d(i,function(e){var t=n.getSeriesByIndex(e.seriesIndex),i=e.dataIndexInside,r=t&&t.getDataParams(i);r&&s.seriesData.push(r)}),_(a)?o=a.replace("{value}",o):x(a)&&(o=a(s))}return o}function Rf(e,t,n){var i=ot();return ht(i,i,n.rotation),lt(i,i,n.position),Io([e.dataToCoord(t),(n.labelOffset||0)+(n.labelDirection||1)*(n.labelMargin||0)],i)}function Vf(e,t,n,i,r,o){var a=kS.innerTextLayout(n.rotation,0,n.labelDirection);n.labelMargin=r.get("label.margin"),zf(t,i,r,o,{position:Rf(i.axis,e,n),align:a.textAlign,verticalAlign:a.textVerticalAlign})}function Bf(e,t,n){return n=n||0,{x1:e[n],y1:e[1-n],x2:t[n],y2:t[1-n]}}function Gf(e,t,n){return n=n||0,{x:e[n],y:e[1-n],width:t[n],height:t[1-n]}}function Wf(e,t,n,i,r,o){return{cx:e,cy:t,r0:n,r:i,startAngle:r,endAngle:o,clockwise:!0}}function Hf(e,t){var n={};return n[t.dim+"AxisIndex"]=t.index,e.getCartesian(n)}function Ff(e){return"x"===e.dim?0:1}function Zf(e){return e.isHorizontal()?0:1}function Uf(e,t){var n=e.getRect();return[n[oE[t]],n[oE[t]]+n[aE[t]]]}function Xf(e,t,n){var i=new fb({shape:{x:e.x-10,y:e.y-10,width:0,height:e.height+20}});return So(i,{shape:{width:e.width+20,height:e.height+20}},t,n),i}function jf(e,t,n){if(e.count())for(var i,r=t.coordinateSystem,o=t.getLayerSeries(),a=f(o,function(t){return f(t.indices,function(t){var n=r.dataToPoint(e.get("time",t));return n[1]=e.get("value",t),n})}),s=qf(a),l=s.y0,c=n/s.max,u=o.length,d=o[0].indices.length,h=0;h<d;++h){i=l[h]*c,e.setItemLayout(o[0].indices[h],{layerIndex:0,x:a[0][h][0],y0:i,y:a[0][h][1]*c});for(var p=1;p<u;++p)i+=a[p-1][h][1]*c,e.setItemLayout(o[p].indices[h],{layerIndex:p,x:a[p][h][0],y0:i,y:a[p][h][1]*c})}}function qf(e){for(var t=e.length,n=e[0].length,i=[],r=[],o=0,a={},s=0;s<n;++s){for(var l=0,c=0;l<t;++l)c+=e[l][s][1];c>o&&(o=c),i.push(c)}for(var u=0;u<n;++u)r[u]=(o-i[u])/2;o=0;for(var d=0;d<n;++d){var h=i[d]+r[d];h>o&&(o=h)}return a.y0=r,a.max=o,a}function Yf(e,t){return t=t||[0,0],f(["x","y"],function(n,i){var r=this.getAxis(n),o=t[i],a=e[i]/2;return"category"===r.type?r.getBandWidth():Math.abs(r.dataToCoord(o-a)-r.dataToCoord(o+a))},this)}function $f(e,t){return t=t||[0,0],f([0,1],function(n){var i=t[n],r=e[n]/2,o=[],a=[];return o[n]=i-r,a[n]=i+r,o[1-n]=a[1-n]=t[1-n],Math.abs(this.dataToPoint(o)[n]-this.dataToPoint(a)[n])},this)}function Kf(e,t){var n=this.getAxis(),i=t instanceof Array?t[0]:t,r=(e instanceof Array?e[0]:e)/2;return"category"===n.type?n.getBandWidth():Math.abs(n.dataToCoord(i-r)-n.dataToCoord(i+r))}function Jf(e,t){return f(["Radius","Angle"],function(n,i){var r=this["get"+n+"Axis"](),o=t[i],a=e[i]/2,s="dataTo"+n,l="category"===r.type?r.getBandWidth():Math.abs(r[s](o-a)-r[s](o+a));return"Angle"===n&&(l=l*Math.PI/180),l},this)}function Qf(e){var t,n=e.type;if("path"===n){var i=e.shape;(t=Un(i.pathData,null,{x:i.x||0,y:i.y||0,width:i.width||0,height:i.height||0},"center")).__customPathData=e.pathData}else"image"===n?(t=new qe({})).__customImagePath=e.style.image:"text"===n?(t=new rb({})).__customText=e.style.text:t=new(0,Eb[n.charAt(0).toUpperCase()+n.slice(1)]);return t.__customGraphicType=n,t.name=e.name,t}function tp(e,t,n,r,o,a){var s={},l=n.style||{};if(n.shape&&(s.shape=i(n.shape)),n.position&&(s.position=n.position.slice()),n.scale&&(s.scale=n.scale.slice()),n.origin&&(s.origin=n.origin.slice()),n.rotation&&(s.rotation=n.rotation),"image"===e.type&&n.style&&(c=s.style={},d(["x","y","width","height"],function(t){ep(t,c,l,e.style,a)})),"text"===e.type&&n.style){var c=s.style={};d(["x","y"],function(t){ep(t,c,l,e.style,a)}),!l.hasOwnProperty("textFill")&&l.fill&&(l.textFill=l.fill),!l.hasOwnProperty("textStroke")&&l.stroke&&(l.textStroke=l.stroke)}if("group"!==e.type&&(e.useStyle(l),a)){e.style.opacity=0;var u=l.opacity;null==u&&(u=1),So(e,{style:{opacity:u}},r,t)}a?e.attr(s):wo(e,s,r,t),e.attr({z2:n.z2||0,silent:n.silent}),!1!==n.styleEmphasis&&uo(e,n.styleEmphasis)}function ep(e,t,n,i,r){null==n[e]||r||(t[e]=n[e],n[e]=i[e])}function ip(e,t,n,i){function o(e){null==e&&(e=u),_&&(d=t.getItemModel(e),h=d.getModel(hE),p=d.getModel(pE),f=Yr(t),g=t.getItemVisual(e,"color"),_=!1)}var s=e.get("renderItem"),l=e.coordinateSystem,c={};l&&(c=l.prepareCustoms?l.prepareCustoms():gE[l.type](l));var u,d,h,p,f,g,m=r({getWidth:i.getWidth,getHeight:i.getHeight,getZr:i.getZr,getDevicePixelRatio:i.getDevicePixelRatio,value:function(e,n){return null==n&&(n=u),t.get(t.getDimension(e||0),n)},style:function(n,i){null==i&&(i=u),o(i);var r=d.getModel(uE).getItemStyle();null!=g&&(r.fill=g);var s=t.getItemVisual(i,"opacity");return null!=s&&(r.opacity=s),null!=f&&(fo(r,h,null,{autoColor:g,isRectText:!0}),r.text=h.getShallow("show")?T(e.getFormattedLabel(i,"normal"),t.get(f,i)):null),n&&a(r,n),r},styleEmphasis:function(n,i){null==i&&(i=u),o(i);var r=d.getModel(dE).getItemStyle();return null!=f&&(fo(r,p,null,{isRectText:!0},!0),r.text=p.getShallow("show")?A(e.getFormattedLabel(i,"emphasis"),e.getFormattedLabel(i,"normal"),t.get(f,i)):null),n&&a(r,n),r},visual:function(e,n){return null==n&&(n=u),t.getItemVisual(n,e)},barLayout:function(e){if(l.getBaseAxis){var t=l.getBaseAxis();return nl.getLayoutOnAxis(r({axis:t},e),i)}},currentSeriesIndices:function(){return n.getCurrentSeriesIndices()},font:function(e){return _o(e,n)}},c.api||{}),v={context:{},seriesId:e.id,seriesName:e.name,seriesIndex:e.seriesIndex,coordSys:c.coordSys,dataInsideLength:t.count(),encode:np(e.getData())},_=!0;return function(e){return u=e,_=!0,s&&s(r({dataIndexInside:e,dataIndex:t.getRawIndex(e)},v),m)||{}}}function np(e){var t={};return d(e.dimensions,function(n,i){var r=e.getDimensionInfo(n);if(!r.isExtraCoord){var o=r.coordDim;(t[o]=t[o]||[])[r.coordDimIndex]=i}}),t}function op(e,t,n,i,r,o){(e=ap(e,t,n,i,r,o))&&o.setItemGraphicEl(t,e)}function ap(e,t,n,i,r,o){var a=n.type;if(!e||a===e.__customGraphicType||"path"===a&&n.pathData===e.__customPathData||"image"===a&&n.style.image===e.__customImagePath||"text"===a&&n.style.text===e.__customText||(r.remove(e),e=null),null!=a){var s=!e;if(!e&&(e=Qf(n)),tp(e,t,n,i,o,s),"group"===a){var l=e.children()||[],c=n.children||[];if(n.diffChildrenByName)rp({oldChildren:l,newChildren:c,dataIndex:t,animatableModel:i,group:e,data:o});else{for(var u=0;u<c.length;u++)ap(e.childAt(u),t,c[u],i,e,o);for(;u<l.length;u++)l[u]&&e.remove(l[u])}}return r.add(e),e}}function rp(e){new fr(e.oldChildren,e.newChildren,sp,sp,e).add(lp).update(lp).remove(hp).execute()}function sp(e,t){var n=e&&e.name;return null!=n?n:fE+t}function lp(e,t){var n=this.context,i=null!=e?n.newChildren[e]:null;ap(null!=t?n.oldChildren[t]:null,n.dataIndex,i,n.animatableModel,n.group,n.data)}function hp(e){var t=this.context,n=t.oldChildren[e];n&&t.group.remove(n)}function up(e,t,n,i){var r=n.type,o=new(0,Eb[r.charAt(0).toUpperCase()+r.slice(1)])(n);t.add(o),i.set(e,o),o.__ecGraphicId=e}function cp(e,t){var n=e&&e.parent;n&&("group"===e.type&&e.traverse(function(e){cp(e,t)}),t.removeKey(e.__ecGraphicId),n.remove(e))}function dp(e){return e=a({},e),d(["id","parentId","$action","hv","bounding"].concat(Wb),function(t){delete e[t]}),e}function fp(e,t){var n;return d(t,function(t){null!=e[t]&&"auto"!==e[t]&&(n=!0)}),n}function pp(e,t){var n=e.exist;if(t.id=e.keyInfo.id,!t.type&&n&&(t.type=n.type),null==t.parentId){var i=t.parentOption;i?t.parentId=i.id:n&&(t.parentId=n.parentId)}t.parentOption=null}function gp(e,t,i){var r=a({},i),o=e[t],s=i.$action||"merge";"merge"===s?o?(n(o,r,!0),ta(o,r,{ignoreSize:!0}),ia(i,o)):e[t]=r:"replace"===s?e[t]=r:"remove"===s&&o&&(e[t]=null)}function mp(e,t){e&&(e.hv=t.hv=[fp(t,["left","right"]),fp(t,["top","bottom"])],"group"===e.type&&(null==e.width&&(e.width=t.width=0),null==e.height&&(e.height=t.height=0)))}function vp(e,t,n){var i,r={},o="toggleSelected"===e;return n.eachComponent("legend",function(n){o&&null!=i?n[i?"select":"unSelect"](t.name):(n[e](t.name),i=n.isSelected(t.name)),d(n.getData(),function(e){var t=e.get("name");if("\n"!==t&&""!==t){var i=n.isSelected(t);r.hasOwnProperty(t)?r[t]=r[t]&&i:r[t]=i}})}),{name:t.name,selected:r}}function yp(e,t,n){var i=t.getBoxLayoutParams(),r=t.get("padding"),o={width:n.getWidth(),height:n.getHeight()},a=Ko(i,o,r);$b(t.get("orient"),e,t.get("itemGap"),a.width,a.height),Jo(e,i,o,r)}function xp(e,t){var n=Wy(t.get("padding")),i=t.getItemStyle(["color","opacity"]);return i.fill=t.get("backgroundColor"),e=new fb({shape:{x:e.x-n[3],y:e.y-n[0],width:e.width+n[1]+n[3],height:e.height+n[0]+n[2],r:t.get("borderRadius")},style:i,silent:!0,z2:-1})}function _p(e,t){t.dispatchAction({type:"legendToggleSelect",name:e})}function bp(e,t,n){var i=n.getZr().storage.getDisplayList()[0];i&&i.useHoverLayer||e.get("legendHoverLink")&&n.dispatchAction({type:"highlight",seriesName:e.name,name:t})}function wp(e,t,n){var i=n.getZr().storage.getDisplayList()[0];i&&i.useHoverLayer||e.get("legendHoverLink")&&n.dispatchAction({type:"downplay",seriesName:e.name,name:t})}function Sp(e,t,n){var i=[1,1];i[e.getOrient().index]=0,ta(t,n,{type:"box",ignoreSize:i})}function Mp(e){var t="left "+e+"s cubic-bezier(0.23, 1, 0.32, 1),top "+e+"s cubic-bezier(0.23, 1, 0.32, 1)";return f(IE,function(e){return e+"transition:"+t}).join(";")}function Ip(e){var t=[],n=e.get("fontSize"),i=e.getTextColor();return i&&t.push("color:"+i),t.push("font:"+e.getFont()),n&&t.push("line-height:"+Math.round(3*n/2)+"px"),ME(["decoration","align"],function(n){var i=e.get(n);i&&t.push("text-"+n+":"+i)}),t.join(";")}function Tp(e){var t=[],n=e.get("transitionDuration"),i=e.get("backgroundColor"),r=e.getModel("textStyle"),o=e.get("padding");return n&&t.push(Mp(n)),i&&(jv.canvasSupported?t.push("background-Color:"+i):(t.push("background-Color:#"+Ct(i)),t.push("filter:alpha(opacity=70)"))),ME(["width","color","radius"],function(n){var i="border-"+n,r=EE(i),o=e.get(r);null!=o&&t.push(i+":"+o+("color"===n?"":"px"))}),t.push(Ip(r)),null!=o&&t.push("padding:"+Wy(o).join("px ")+"px"),t.join(";")+";"}function Ap(e,t){var n=document.createElement("div"),i=this._zr=t.getZr();this.el=n,this._x=t.getWidth()/2,this._y=t.getHeight()/2,e.appendChild(n),this._container=e,this._show=!1,this._hideTimeout;var r=this;n.onmouseenter=function(){r._enterable&&(clearTimeout(r._hideTimeout),r._show=!0),r._inContent=!0},n.onmousemove=function(t){if(t=t||window.event,!r._enterable){var n=i.handler;ri(e,t,!0),n.dispatch("mousemove",t)}},n.onmouseleave=function(){r._enterable&&r._show&&r.hideLater(r._hideDelay),r._inContent=!1}}function Cp(e){for(var t=e.pop();e.length;){var n=e.pop();n&&(n instanceof Lo&&(n=n.get("tooltip",!0)),"string"==typeof n&&(n={formatter:n}),t=new Lo(n,t,t.ecModel))}return t}function Dp(e,t){return e.dispatchAction||m(t.dispatchAction,t)}function Lp(e,t,n,i,r,o,a){var s=Pp(n),l=s.width,c=s.height;return null!=o&&(e+l+o>i?e-=l+o:e+=o),null!=a&&(t+c+a>r?t-=c+a:t+=a),[e,t]}function kp(e,t,n,i,r){var o=Pp(n),a=o.width,s=o.height;return e=Math.min(e+a,i)-a,t=Math.min(t+s,r)-s,e=Math.max(e,0),t=Math.max(t,0),[e,t]}function Pp(e){var t=e.clientWidth,n=e.clientHeight;if(document.defaultView&&document.defaultView.getComputedStyle){var i=document.defaultView.getComputedStyle(e);i&&(t+=parseInt(i.paddingLeft,10)+parseInt(i.paddingRight,10)+parseInt(i.borderLeftWidth,10)+parseInt(i.borderRightWidth,10),n+=parseInt(i.paddingTop,10)+parseInt(i.paddingBottom,10)+parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10))}return{width:t,height:n}}function Op(e,t,n){var i=n[0],r=n[1],o=0,a=0,s=t.width,l=t.height;switch(e){case"inside":o=t.x+s/2-i/2,a=t.y+l/2-r/2;break;case"top":o=t.x+s/2-i/2,a=t.y-r-5;break;case"bottom":o=t.x+s/2-i/2,a=t.y+l+5;break;case"left":o=t.x-i-5,a=t.y+l/2-r/2;break;case"right":o=t.x+s+5,a=t.y+l/2-r/2}return[o,a]}function zp(e){return"center"===e||"middle"===e}function Np(e){return e.get("stack")||"__ec_stack_"+e.seriesIndex}function Ep(e){return e.dim}function Rp(e,t){var n={};d(e,function(e,t){var i=e.getData(),r=e.coordinateSystem.getBaseAxis(),o=r.getExtent(),a="category"===r.type?r.getBandWidth():Math.abs(o[1]-o[0])/i.count(),s=n[Ep(r)]||{bandWidth:a,remainedWidth:a,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},l=s.stacks;n[Ep(r)]=s;var c=Np(e);l[c]||s.autoWidthCount++,l[c]=l[c]||{width:0,maxWidth:0};var u=Si(e.get("barWidth"),a),d=Si(e.get("barMaxWidth"),a),h=e.get("barGap"),p=e.get("barCategoryGap");u&&!l[c].width&&(u=Math.min(s.remainedWidth,u),l[c].width=u,s.remainedWidth-=u),d&&(l[c].maxWidth=d),null!=h&&(s.gap=h),null!=p&&(s.categoryGap=p)});var i={};return d(n,function(e,t){i[t]={};var n=e.stacks,r=e.bandWidth,o=Si(e.categoryGap,r),a=Si(e.gap,1),s=e.remainedWidth,l=e.autoWidthCount,c=(s-o)/(l+(l-1)*a);c=Math.max(c,0),d(n,function(e,t){var n=e.maxWidth;n&&n<c&&(n=Math.min(n,s),e.width&&(n=Math.min(n,e.width)),s-=n,e.width=n,l--)}),c=(s-o)/(l+(l-1)*a),c=Math.max(c,0);var u,h=0;d(n,function(e,t){e.width||(e.width=c),u=e,h+=e.width*(1+a)}),u&&(h-=u.width*a);var p=-h/2;d(n,function(e,n){i[t][n]=i[t][n]||{offset:p,width:e.width},p+=e.width*(1+a)})}),i}function Vp(e,t){jC.call(this,"radius",e,t),this.type="category"}function Bp(e,t){t=t||[0,360],jC.call(this,"angle",e,t),this.type="category"}function Gp(e,t){return t.type||(t.data?"category":"value")}function Wp(e,t,n){var i=t.get("center"),r=n.getWidth(),o=n.getHeight();e.cx=Si(i[0],r),e.cy=Si(i[1],o);var a=e.getRadiusAxis(),s=Math.min(r,o)/2,l=Si(t.get("radius"),s);a.inverse?a.setExtent(l,0):a.setExtent(0,l)}function Hp(e,t){var n=this,i=n.getAngleAxis(),r=n.getRadiusAxis();if(i.scale.setExtent(1/0,-1/0),r.scale.setExtent(1/0,-1/0),e.eachSeries(function(e){if(e.coordinateSystem===n){var t=e.getData();r.scale.unionExtentFromData(t,"radius"),i.scale.unionExtentFromData(t,"angle")}}),Nr(i.scale,i.model),Nr(r.scale,r.model),"category"===i.type&&!i.onBand){var o=i.getExtent(),a=360/i.scale.count();i.inverse?o[1]+=a:o[1]-=a,i.setExtent(o[0],o[1])}}function Fp(e,t){if(e.type=t.get("type"),e.scale=Er(t),e.onBand=t.get("boundaryGap")&&"category"===e.type,e.inverse=t.get("inverse"),"angleAxis"===t.mainType){e.inverse^=t.get("clockwise");var n=t.get("startAngle");e.setExtent(n,n+(e.inverse?-360:360))}t.axis=e,e.model=t}function Zp(e,t,n){t[1]>t[0]&&(t=t.slice().reverse());var i=e.coordToPoint([t[0],n]),r=e.coordToPoint([t[1],n]);return{x1:i[0],y1:i[1],x2:r[0],y2:r[1]}}function Up(e){return e.getRadiusAxis().inverse?0:1}function Xp(e,t,n){return{position:[e.cx,e.cy],rotation:n/180*Math.PI,labelDirection:-1,tickDirection:-1,nameDirection:1,labelRotate:t.getModel("axisLabel").get("rotate"),z2:1}}function jp(e,t,n,i,r){var o=t.axis,a=o.dataToCoord(e),s=i.getAngleAxis().getExtent()[0];s=s/180*Math.PI;var l,c,u,d=i.getRadiusAxis().getExtent();if("radius"===o.dim){var h=ot();ht(h,h,s),lt(h,h,[i.cx,i.cy]),l=Io([a,-r],h);var p=t.getModel("axisLabel").get("rotate")||0,f=kS.innerTextLayout(s,p*Math.PI/180,-1);c=f.textAlign,u=f.textVerticalAlign}else{var g=d[1];l=i.coordToPoint([g+r,a]);var m=i.cx,v=i.cy;c=Math.abs(l[0]-m)/g<.3?"center":l[0]>m?"left":"right",u=Math.abs(l[1]-v)/g<.3?"middle":l[1]>v?"top":"bottom"}return{position:l,align:c,verticalAlign:u}}function qp(e,t){t.update="updateView",ir(t,function(t,n){var i={};return n.eachComponent({mainType:"geo",query:t},function(n){n[e](t.name),d(n.coordinateSystem.regions,function(e){i[e.name]=n.isSelected(e.name)||!1})}),{selected:i,name:t.name}})}function Yp(e){var t={};d(e,function(e){t[e]=1}),e.length=0,d(t,function(t,n){e.push(n)})}function $p(e){if(e)for(var t in e)if(e.hasOwnProperty(t))return!0}function Kp(e,t,n){function o(){var e=function(){};return e.prototype.__hidden=e.prototype,new e}var r={};return $E(t,function(t){var a=r[t]=o();$E(e[t],function(e,r){if(XT.isValidType(r)){var o={type:r,visual:e};n&&n(o,t),a[r]=new XT(o),"opacity"===r&&((o=i(o)).type="colorAlpha",a.__hidden.__alphaForOpacity=new XT(o))}})}),r}function Jp(e,t,n){var r;d(n,function(e){t.hasOwnProperty(e)&&$p(t[e])&&(r=!0)}),r&&d(n,function(n){t.hasOwnProperty(n)&&$p(t[n])?e[n]=i(t[n]):delete e[n]})}function Qp(e,t,n,i,o,a){function r(e){return n.getItemVisual(u,e)}function s(e,t){n.setItemVisual(u,e,t)}function l(e,l){u=null==a?e:l;var d=n.getRawDataItem(u);if(!d||!1!==d.visualMap)for(var h=i.call(o,e),p=t[h],f=c[h],g=0,m=f.length;g<m;g++){var v=f[g];p[v]&&p[v].applyVisual(e,r,s)}}var c={};d(e,function(e){var n=XT.prepareVisualTypes(t[e]);c[e]=n});var u;null==a?n.each(l,!0):n.each([a],l,!0)}function tg(e){var t=["x","y"],n=["width","height"];return{point:function(t,n,i){if(t){var r=i.range;return eg(t[e],r)}},rect:function(i,r,o){if(i){var a=o.range,s=[i[t[e]],i[t[e]]+i[n[e]]];return s[1]<s[0]&&s.reverse(),eg(s[0],a)||eg(s[1],a)||eg(a[0],s)||eg(a[1],s)}}}}function eg(e,t){return t[0]<=e&&e<=t[1]}function ig(e,t,n,i,r){for(var o=0,a=r[r.length-1];o<r.length;o++){var s=r[o];if(ng(e,t,n,i,s[0],s[1],a[0],a[1]))return!0;a=s}}function ng(e,t,n,i,r,o,a,s){var l=ag(n-e,r-a,i-t,o-s);if(og(l))return!1;var c=ag(r-e,r-a,o-t,o-s)/l;if(c<0||c>1)return!1;var u=ag(n-e,r-e,i-t,o-t)/l;return!(u<0||u>1)}function og(e){return e<=1e-6&&e>=-1e-6}function ag(e,t,n,i){return e*i-t*n}function rg(e,t,n){var i=this._targetInfoList=[],r={},o=lg(t,e);qE(JE,function(e,t){(!n||!n.include||jE(n.include,t)>=0)&&e(o,i,r)})}function sg(e){return e[0]>e[1]&&e.reverse(),e}function lg(e,t){return Fo(e,t,{includeMainTypes:ZE})}function hg(e,t,n,i){var r=n.getAxis(["x","y"][e]),o=sg(f([0,1],function(e){return t?r.coordToData(r.toLocalCoord(i[e])):r.toGlobalCoord(r.dataToCoord(i[e]))})),a=[];return a[e]=o,a[1-e]=[NaN,NaN],{values:o,xyMinMax:a}}function ug(e,t,n,i){return[t[0]-i[e]*n[0],t[1]-i[e]*n[1]]}function cg(e,t){var n=dg(e),i=dg(t),r=[n[0]/i[0],n[1]/i[1]];return isNaN(r[0])&&(r[0]=1),isNaN(r[1])&&(r[1]=1),r}function dg(e){return e?[e[0][1]-e[0][0],e[1][1]-e[1][0]]:[NaN,NaN]}function fg(e,t,n,i,r){if(r){var o=e.getZr();o[oI]||(o[rI]||(o[rI]=pg),La(o,rI,n,t)(e,i))}}function pg(e,t){if(!e.isDisposed()){var n=e.getZr();n[oI]=!0,e.dispatchAction({type:"brushSelect",batch:t}),n[oI]=!1}}function gg(e,t,n,i){for(var r=0,o=t.length;r<o;r++){var a=t[r];if(e[a.brushType](i,n,a.selectors,a))return!0}}function mg(e){var t=e.brushSelector;if(_(t)){var n=[];return d(GE,function(e,i){n[i]=function(n,i,r,o){var a=i.getItemLayout(n);return e[t](a,r,o)}}),n}if(x(t)){var i={};return d(GE,function(e,n){i[n]=t}),i}return t}function vg(e,t){var n=e.option.seriesIndex;return null!=n&&"all"!==n&&(y(n)?l(n,t)<0:t!==n)}function yg(e){var t=e.selectors={};return d(GE[e.brushType],function(n,i){t[i]=function(i){return n(i,t,e)}}),e}function xg(e){return new jt(e[0][0],e[1][0],e[0][1]-e[0][0],e[1][1]-e[1][0])}function _g(e,t){return n({brushType:e.brushType,brushMode:e.brushMode,transformable:e.transformable,brushStyle:new Lo(e.brushStyle).getItemStyle(),removeOnClick:e.removeOnClick,z:e.z},t,!0)}function bg(e,t,n,i){(!i||i.$from!==e.id)&&this._brushController.setPanels(e.brushTargetManager.makePanelOpts(n)).enableBrush(e.brushOption).updateCovers(e.areas.slice())}function wg(e,t){cI[e]=t}function Sg(e){return cI[e]}function Mg(e,t,n){this.model=e,this.ecModel=t,this.api=n,this._brushType,this._brushMode}function Ig(e,t,n){this._model=e}function Tg(e,t,n,i){var r=n.calendarModel,o=n.seriesModel,a=r?r.coordinateSystem:o?o.coordinateSystem:null;return a===this?a[e](i):null}function Ag(e,t){var n=e.cellSize;y(n)?1===n.length&&(n[1]=n[0]):n=e.cellSize=[n,n];var i=f([0,1],function(e){return Qo(t,e)&&(n[e]="auto"),null!=n[e]&&"auto"!==n[e]});ta(e,t,{type:"box",ignoreSize:i})}function Cg(e){return l(mI,e)>=0}function Dg(e,t,i){function n(e,t){return l(t.nodes,e)>=0}function o(e,n){var r=!1;return t(function(t){d(i(e,t)||[],function(e){n.records[t.name][e]&&(r=!0)})}),r}function a(e,n){n.nodes.push(e),t(function(t){d(i(e,t)||[],function(e){n.records[t.name][e]=!0})})}return function(i){var r={nodes:[],records:{}};if(t(function(e){r.records[e.name]={}}),!i)return r;a(i,r);var s;do{s=!1,e(function(e){!n(e,r)&&o(e,r)&&(a(e,r),s=!0)})}while(s);return r}}function Lg(e,t,n){var i=[1/0,-1/0];return _I(n,function(e){var n=e.getData();n&&_I(e.coordDimToDataDim(t),function(e){var t=n.getDataExtent(e);t[0]<i[0]&&(i[0]=t[0]),t[1]>i[1]&&(i[1]=t[1])})}),i[1]<i[0]&&(i=[NaN,NaN]),kg(e,i),i}function kg(e,t){var n=e.getAxisModel(),i=n.getMin(!0),r="category"===n.get("type"),o=r&&(n.get("data")||[]).length;null!=i&&"dataMin"!==i&&"function"!=typeof i?t[0]=i:r&&(t[0]=o>0?0:NaN);var a=n.getMax(!0);return null!=a&&"dataMax"!==a&&"function"!=typeof a?t[1]=a:r&&(t[1]=o>0?o-1:NaN),n.get("scale",!0)||(t[0]>0&&(t[0]=0),t[1]<0&&(t[1]=0)),t}function Pg(e,t){var n=e.getAxisModel(),i=e._percentWindow,r=e._valueWindow;if(i){var o=Ci(r,[0,500]);o=Math.min(o,20);var a=t||0===i[0]&&100===i[1];n.setRange(a?null:+r[0].toFixed(o),a?null:+r[1].toFixed(o))}}function Og(e){var t=e._minMaxSpan={},n=e._dataZoomModel;_I(["min","max"],function(i){t[i+"Span"]=n.get(i+"Span");var r=n.get(i+"ValueSpan");if(null!=r&&(t[i+"ValueSpan"]=r,null!=(r=e.getAxisModel().axis.scale.parse(r)))){var o=e._dataExtent;t[i+"Span"]=wi(o[0]+r,o,[0,100],!0)}})}function zg(e){var t={};return bI(["start","end","startValue","endValue","throttle"],function(n){e.hasOwnProperty(n)&&(t[n]=e[n])}),t}function Ng(e,t){var n=e._rangePropMode,i=e.get("rangeMode");bI([["start","startValue"],["end","endValue"]],function(e,r){var o=null!=t[e[0]],a=null!=t[e[1]];o&&!a?n[r]="percent":!o&&a?n[r]="value":i?n[r]=i[r]:o&&(n[r]="percent")})}function Eg(e){return{x:"y",y:"x",radius:"angle",angle:"radius"}[e]}function Rg(e){return"vertical"===e?"ns-resize":"ew-resize"}function Vg(e,t){var n=Hg(e),i=t.dataZoomId,r=t.coordId;d(n,function(e,n){var o=e.dataZoomInfos;o[i]&&l(t.allCoordIds,r)<0&&(delete o[i],e.count--)}),Zg(n);var o=n[r];o||((o=n[r]={coordId:r,dataZoomInfos:{},count:0}).controller=Fg(e,o),o.dispatchAction=v(qg,e)),!o.dataZoomInfos[i]&&o.count++,o.dataZoomInfos[i]=t;var a=Yg(o.dataZoomInfos);o.controller.enable(a.controlType,a.opt),o.controller.setPointerChecker(t.containsPoint),La(o,"dispatchAction",t.throttleRate,"fixRate")}function Bg(e,t){var n=Hg(e);d(n,function(e){e.controller.dispose();var n=e.dataZoomInfos;n[t]&&(delete n[t],e.count--)}),Zg(n)}function Gg(e,t){if(e&&"dataZoom"===e.type&&e.batch)for(var n=0,i=e.batch.length;n<i;n++)if(e.batch[n].dataZoomId===t)return!1;return!0}function Wg(e){return e.type+"\0_"+e.id}function Hg(e){var t=e.getZr();return t[OI]||(t[OI]={})}function Fg(e,t){var n=new kl(e.getZr());return n.on("pan",PI(Ug,t)),n.on("zoom",PI(Xg,t)),n}function Zg(e){d(e,function(t,n){t.count||(t.controller.dispose(),delete e[n])})}function Ug(e,t,n,i,r,o,a){jg(e,function(s){return s.panGetRange(e.controller,t,n,i,r,o,a)})}function Xg(e,t,n,i){jg(e,function(r){return r.zoomGetRange(e.controller,t,n,i)})}function jg(e,t){var n=[];d(e.dataZoomInfos,function(e){var i=t(e);!e.disabled&&i&&n.push({dataZoomId:e.dataZoomId,start:i[0],end:i[1]})}),e.dispatchAction(n)}function qg(e,t){e.dispatchAction({type:"dataZoom",batch:t})}function Yg(e){var t,n={},i={true:2,move:1,false:0,undefined:-1};return d(e,function(e){var r=!e.disabled&&(!e.zoomLock||"move");i[r]>i[t]&&(t=r),a(n,e.roamControllerOpt)}),{controlType:t,opt:n}}function $g(e,t,n){n.getAxisProxy(e.name,t).reset(n)}function Kg(e,t,n){n.getAxisProxy(e.name,t).filterData(n)}function Jg(e,t){return e&&e.hasOwnProperty&&e.hasOwnProperty(t)}function Qg(e,t){e.eachTargetSeries(function(t){var n=t.getData();Qp(e.stateList,e.targetVisuals,n,e.getValueState,e,e.getDataDimension(n))})}function tm(e){e.eachSeries(function(t){var n=t.getData(),i=[];e.eachComponent("visualMap",function(e){if(e.isTargetSeries(t)){var r=e.getVisualMeta(m(em,null,t,e))||{stops:[],outerColors:[]};r.dimension=e.getDataDimension(n),i.push(r)}}),t.getData().setVisual("visualMeta",i)})}function em(e,t,n,i){for(var r=t.targetVisuals[i],o=XT.prepareVisualTypes(r),a={color:e.getData().getVisual("color")},s=0,l=o.length;s<l;s++){var c=o[s],u=r["opacity"===c?"__alphaForOpacity":c];u&&u.applyVisual(n,function(e){return a[e]},function(e,t){a[e]=t})}return a.color}function im(e,t,n){if(n[0]===n[1])return n.slice();for(var i=(n[1]-n[0])/200,r=n[0],o=[],a=0;a<=200&&r<n[1];a++)o.push(r),r+=i;return o.push(n[1]),o}function nm(e,t,n){var i=e.option,r=i.align;if(null!=r&&"auto"!==r)return r;for(var o={width:t.getWidth(),height:t.getHeight()},a="horizontal"===i.orient?1:0,s=[["left","right","width"],["top","bottom","height"]],l=s[a],c=[0,null,10],u={},d=0;d<3;d++)u[s[1-a][d]]=c[d],u[l[d]]=2===d?n[0]:i[l[d]];var h=[["x","width",3],["y","height",0]][a],p=Ko(u,o,i.padding);return l[(p.margin[h[2]]||0)+p[h[0]]+.5*p[h[1]]<.5*o[h[1]]?0:1]}function om(e){return d(e||[],function(t){null!=e.dataIndex&&(e.dataIndexInside=e.dataIndex,e.dataIndex=null)}),e}function am(e,t,n,i){return new hb({shape:{points:e},draggable:!!n,cursor:t,drift:n,onmousemove:function(e){Cy(e.event)},ondragend:i})}function rm(e,t){return 0===e?[[0,0],[t,0],[t,-t]]:[[0,0],[t,0],[t,t]]}function sm(e,t,n,i){return e?[[0,-iD(t,rD(n,0))],[aD,0],[0,iD(t,rD(i-n,0))]]:[[0,0],[5,-5],[5,5]]}function lm(e,t,n){var i=oD/2,r=e.get("hoverLinkDataSize");return r&&(i=tD(r,t,n,!0)/2),i}function hm(e){var t=e.get("hoverLinkOnHandle");return!!(null==t?e.get("realtime"):t)}function um(e){return"vertical"===e?"ns-resize":"ew-resize"}function cm(e,t){var n=e.inverse;("vertical"===e.orient?!n:n)&&t.reverse()}function dm(e){zo(e.label,["show"])}function fm(e){return!(isNaN(parseFloat(e.x))&&isNaN(parseFloat(e.y)))}function pm(e){return!isNaN(parseFloat(e.x))&&!isNaN(parseFloat(e.y))}function gm(e,t,n){var i=-1;do{i=Math.max(Ti(e.get(t,n)),i),e=e.stackedOn}while(e);return i}function mm(e,t,n,i,r,o){var a=[],s=bm(t,i,e),l=t.indicesOfNearest(i,s,!0)[0];a[r]=t.get(n,l,!0),a[o]=t.get(i,l,!0);var c=gm(t,i,l);return(c=Math.min(c,20))>=0&&(a[o]=+a[o].toFixed(c)),a}function vm(e,t){var n=e.getData(),r=e.coordinateSystem;if(t&&!pm(t)&&!y(t.coord)&&r){var o=r.dimensions,a=ym(t,n,r,e);if((t=i(t)).type&&gD[t.type]&&a.baseAxis&&a.valueAxis){var s=pD(o,a.baseAxis.dim),l=pD(o,a.valueAxis.dim);t.coord=gD[t.type](n,a.baseDataDim,a.valueDataDim,s,l),t.value=t.coord[l]}else{for(var c=[null!=t.xAxis?t.xAxis:t.radiusAxis,null!=t.yAxis?t.yAxis:t.angleAxis],u=0;u<2;u++)if(gD[c[u]]){var d=e.coordDimToDataDim(o[u])[0];c[u]=bm(n,d,c[u])}t.coord=c}}return t}function ym(e,t,n,i){var r={};return null!=e.valueIndex||null!=e.valueDim?(r.valueDataDim=null!=e.valueIndex?t.getDimension(e.valueIndex):e.valueDim,r.valueAxis=n.getAxis(i.dataDimToCoordDim(r.valueDataDim)),r.baseAxis=n.getOtherAxis(r.valueAxis),r.baseDataDim=i.coordDimToDataDim(r.baseAxis.dim)[0]):(r.baseAxis=i.getBaseAxis(),r.valueAxis=n.getOtherAxis(r.baseAxis),r.baseDataDim=i.coordDimToDataDim(r.baseAxis.dim)[0],r.valueDataDim=i.coordDimToDataDim(r.valueAxis.dim)[0]),r}function xm(e,t){return!(e&&e.containData&&t.coord&&!fm(t))||e.containData(t.coord)}function _m(e,t,n,i){return i<2?e.coord&&e.coord[i]:e.value}function bm(e,t,n){if("average"===n){var i=0,r=0;return e.each(t,function(e,t){isNaN(e)||(i+=e,r++)},!0),i/r}return e.getDataExtent(t,!0)["max"===n?1:0]}function wm(e,t,n){var i=t.coordinateSystem;e.each(function(r){var o,a=e.getItemModel(r),s=Si(a.get("x"),n.getWidth()),l=Si(a.get("y"),n.getHeight());if(isNaN(s)||isNaN(l)){if(t.getMarkerPosition)o=t.getMarkerPosition(e.getValues(e.dimensions,r));else if(i){var c=e.get(i.dimensions[0],r),u=e.get(i.dimensions[1],r);o=i.dataToPoint([c,u])}}else o=[s,l];isNaN(s)||(o[0]=s),isNaN(l)||(o[1]=l),e.setItemLayout(r,o)})}function Sm(e,t,n){var i;i=e?f(e&&e.dimensions,function(e){var n=t.getData().getDimensionInfo(t.coordDimToDataDim(e)[0])||{};return n.name=e,n}):[{name:"value",type:"float"}];var r=new sC(i,n),o=f(n.get("data"),v(vm,t));return e&&(o=g(o,v(xm,e))),r.initData(o,null,e?_m:function(e){return e.value}),r}function Mm(e){return!isNaN(e)&&!isFinite(e)}function Im(e,t,n,i){var r=1-e,o=i.dimensions[e];return Mm(t[r])&&Mm(n[r])&&t[e]===n[e]&&i.getAxis(o).containData(t[e])}function Tm(e,t){if("cartesian2d"===e.type){var n=t[0].coord,i=t[1].coord;if(n&&i&&(Im(1,n,i,e)||Im(0,n,i,e)))return!0}return xm(e,t[0])&&xm(e,t[1])}function Am(e,t,n,i,r){var o,a=i.coordinateSystem,s=e.getItemModel(t),l=Si(s.get("x"),r.getWidth()),c=Si(s.get("y"),r.getHeight());if(isNaN(l)||isNaN(c)){if(i.getMarkerPosition)o=i.getMarkerPosition(e.getValues(e.dimensions,t));else{var u=a.dimensions,d=e.get(u[0],t),h=e.get(u[1],t);o=a.dataToPoint([d,h])}if("cartesian2d"===a.type){var p=a.getAxis("x"),f=a.getAxis("y"),u=a.dimensions;Mm(e.get(u[0],t))?o[0]=p.toGlobalCoord(p.getExtent()[n?0:1]):Mm(e.get(u[1],t))&&(o[1]=f.toGlobalCoord(f.getExtent()[n?0:1]))}isNaN(l)||(o[0]=l),isNaN(c)||(o[1]=c)}else o=[l,c];e.setItemLayout(t,o)}function Cm(e,t,n){var i;i=e?f(e&&e.dimensions,function(e){var n=t.getData().getDimensionInfo(t.coordDimToDataDim(e)[0])||{};return n.name=e,n}):[{name:"value",type:"float"}];var r=new sC(i,n),o=new sC(i,n),a=new sC([],n),s=f(n.get("data"),v(vD,t,e,n));e&&(s=g(s,v(Tm,e)));var l=e?_m:function(e){return e.value};return r.initData(f(s,function(e){return e[0]}),null,l),o.initData(f(s,function(e){return e[1]}),null,l),a.initData(f(s,function(e){return e[2]})),a.hasItemOption=!0,{from:r,to:o,line:a}}function Dm(e){return!isNaN(e)&&!isFinite(e)}function Lm(e,t,n,i){var r=1-e;return Dm(t[r])&&Dm(n[r])}function km(e,t){var n=t.coord[0],i=t.coord[1];return!("cartesian2d"!==e.type||!n||!i||!Lm(1,n,i,e)&&!Lm(0,n,i,e))||xm(e,{coord:n,x:t.x0,y:t.y0})||xm(e,{coord:i,x:t.x1,y:t.y1})}function Pm(e,t,n,i,r){var o,a=i.coordinateSystem,s=e.getItemModel(t),l=Si(s.get(n[0]),r.getWidth()),c=Si(s.get(n[1]),r.getHeight());if(isNaN(l)||isNaN(c)){if(i.getMarkerPosition)o=i.getMarkerPosition(e.getValues(n,t));else{var u=e.get(n[0],t),d=e.get(n[1],t);o=a.dataToPoint([u,d],!0)}if("cartesian2d"===a.type){var h=a.getAxis("x"),p=a.getAxis("y"),u=e.get(n[0],t),d=e.get(n[1],t);Dm(u)?o[0]=h.toGlobalCoord(h.getExtent()["x0"===n[0]?0:1]):Dm(d)&&(o[1]=p.toGlobalCoord(p.getExtent()["y0"===n[1]?0:1]))}isNaN(l)||(o[0]=l),isNaN(c)||(o[1]=c)}else o=[l,c];return o}function Om(e,t,n){var i,r,o=["x0","y0","x1","y1"];e?(i=f(e&&e.dimensions,function(e){var n=t.getData().getDimensionInfo(t.coordDimToDataDim(e)[0])||{};return n.name=e,n}),r=new sC(f(o,function(e,t){return{name:e,type:i[t%2].type}}),n)):r=new sC(i=[{name:"value",type:"float"}],n);var a=f(n.get("data"),v(_D,t,e,n));e&&(a=g(a,v(km,e)));var s=e?function(e,t,n,i){return e.coord[Math.floor(i/2)][i%2]}:function(e){return e.value};return r.initData(a,null,s),r.hasItemOption=!0,r}function zm(e){var t=e.type,n={number:"value",time:"time"};if(n[t]&&(e.axisType=n[t],delete e.type),Nm(e),Em(e,"controlPosition")){var i=e.controlStyle||(e.controlStyle={});Em(i,"position")||(i.position=e.controlPosition),"none"!==i.position||Em(i,"show")||(i.show=!1,delete i.position),delete e.controlPosition}d(e.data||[],function(e){b(e)&&!y(e)&&(!Em(e,"value")&&Em(e,"name")&&(e.value=e.name),Nm(e))})}function Nm(e){var t=e.itemStyle||(e.itemStyle={}),n=t.emphasis||(t.emphasis={}),i=e.label||e.label||{},r=i.normal||(i.normal={}),o={normal:1,emphasis:1};d(i,function(e,t){o[t]||Em(r,t)||(r[t]=e)}),n.label&&!Em(i,"emphasis")&&(i.emphasis=n.label,delete n.label)}function Em(e,t){return e.hasOwnProperty(t)}function Rm(e,t){return Ko(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()},e.get("padding"))}function Vm(e,t,n,r){return Un(e.get(t).replace(/^path:\/\//,""),i(r||{}),new jt(n[0],n[1],n[2],n[3]),"center")}function Bm(e,t,i,r,o,a){var s=t.get("color");o?(o.setColor(s),i.add(o),a&&a.onUpdate(o)):((o=Hr(e.get("symbol"),-1,-1,2,2,s)).setStyle("strokeNoScale",!0),i.add(o),a&&a.onCreate(o));var l=t.getItemStyle(["color","symbol","symbolSize"]);o.setStyle(l),r=n({rectHover:!0,z2:100},r,!0);var c=e.get("symbolSize");(c=c instanceof Array?c.slice():[+c,+c])[0]/=2,c[1]/=2,r.scale=c;var u=e.get("symbolOffset");if(u){var d=r.position=r.position||[0,0];d[0]+=Si(u[0],c[0]),d[1]+=Si(u[1],c[1])}var h=e.get("symbolRotate");return r.rotation=(h||0)*Math.PI/180||0,o.attr(r),o.updateTransform(),o}function Gm(e,t,n,i,r){if(!e.dragging){var o=i.getModel("checkpointStyle"),a=n.dataToCoord(i.getData().get(["value"],t));r||!o.get("animation",!0)?e.attr({position:[a,0]}):(e.stopAnimation(!0),e.animateTo({position:[a,0]},o.get("animationDuration",!0),o.get("animationEasing",!0)))}}function Wm(e){return 0===e.indexOf("my")}function Hm(e){this.model=e}function Fm(e){this.model=e}function Zm(e){var t={},n=[],i=[];return e.eachRawSeries(function(e){var r=e.coordinateSystem;if(!r||"cartesian2d"!==r.type&&"polar"!==r.type)n.push(e);else{var o=r.getBaseAxis();if("category"===o.type){var a=o.dim+"_"+o.index;t[a]||(t[a]={categoryAxis:o,valueAxis:r.getOtherAxis(o),series:[]},i.push({axisDim:o.dim,axisIndex:o.index})),t[a].series.push(e)}else n.push(e)}}),{seriesGroupByCategoryAxis:t,other:n,meta:i}}function Um(e){var t=[];return d(e,function(e,n){var i=e.categoryAxis,r=e.valueAxis.dim,o=[" "].concat(f(e.series,function(e){return e.name})),a=[i.model.getCategories()];d(e.series,function(e){a.push(e.getRawData().mapArray(r,function(e){return e}))});for(var s=[o.join(PD)],l=0;l<a[0].length;l++){for(var c=[],u=0;u<a.length;u++)c.push(a[u][l]);s.push(c.join(PD))}t.push(s.join("\n"))}),t.join("\n\n"+ND+"\n\n")}function Xm(e){return f(e,function(e){var t=e.getRawData(),n=[e.name],i=[];return t.each(t.dimensions,function(){for(var e=arguments.length,r=arguments[e-1],o=t.getName(r),a=0;a<e-1;a++)i[a]=arguments[a];n.push((o?o+PD:"")+i.join(PD))}),n.join("\n")}).join("\n\n"+ND+"\n\n")}function jm(e){var t=Zm(e);return{value:g([Um(t.seriesGroupByCategoryAxis),Xm(t.other)],function(e){return e.replace(/[\n\t\s]/g,"")}).join("\n\n"+ND+"\n\n"),meta:t.meta}}function qm(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Ym(e){if(e.slice(0,e.indexOf("\n")).indexOf(PD)>=0)return!0}function $m(e){for(var t=e.split(/\n+/g),n=[],i=f(qm(t.shift()).split(OD),function(e){return{name:e,data:[]}}),r=0;r<t.length;r++){var o=qm(t[r]).split(OD);n.push(o.shift());for(var a=0;a<o.length;a++)i[a]&&(i[a].data[r]=o[a])}return{series:i,categories:n}}function Km(e){for(var t=e.split(/\n+/g),n=qm(t.shift()),i=[],r=0;r<t.length;r++){var o,a=qm(t[r]).split(OD),s="",l=!1;isNaN(a[0])?(l=!0,s=a[0],a=a.slice(1),i[r]={name:s,value:[]},o=i[r].value):o=i[r]=[];for(var c=0;c<a.length;c++)o.push(+a[c]);1===o.length&&(l?i[r].value=o[0]:i[r]=o[0])}return{name:n,data:i}}function Jm(e,t){var n={series:[]};return d(e.split(new RegExp("\n*"+ND+"\n*","g")),function(e,i){if(Ym(e)){var r=$m(e),o=t[i],a=o.axisDim+"Axis";o&&(n[a]=n[a]||[],n[a][o.axisIndex]={data:r.categories},n.series=n.series.concat(r.series))}else r=Km(e),n.series.push(r)}),n}function Qm(e){this._dom=null,this.model=e}function tv(e,t){return f(e,function(e,n){var i=t&&t[n];return b(i)&&!y(i)?(b(e)&&!y(e)&&(e=e.value),r({value:e},i)):e})}function ev(e,t){var n=av(e);RD(t,function(t,i){for(var r=n.length-1;r>=0&&!n[r][i];r--);if(r<0){var o=e.queryComponents({mainType:"dataZoom",subType:"select",id:i})[0];if(o){var a=o.getPercentRange();n[0][i]={dataZoomId:i,start:a[0],end:a[1]}}}}),n.push(t)}function iv(e){var t=av(e),n=t[t.length-1];t.length>1&&t.pop();var i={};return RD(n,function(e,n){for(var r=t.length-1;r>=0;r--)if(e=t[r][n]){i[n]=e;break}}),i}function nv(e){e[zD]=null}function ov(e){return av(e).length}function av(e){var t=e[zD];return t||(t=e[zD]=[{}]),t}function rv(e,t,n){(this._brushController=new Yu(n.getZr())).on("brush",m(this._onBrush,this)).mount(),this._isZoomActive}function sv(e){var t={};return d(["xAxisIndex","yAxisIndex"],function(n){t[n]=e[n],null==t[n]&&(t[n]="all"),(!1===t[n]||"none"===t[n])&&(t[n]=[])}),t}function lv(e,t){e.setIconStatus("back",ov(t)>1?"emphasis":"normal")}function hv(e,t,n,i,r){var o=n._isZoomActive;i&&"takeGlobalCursor"===i.type&&(o="dataZoomSelect"===i.key&&i.dataZoomSelectActive),n._isZoomActive=o,e.setIconStatus("zoom",o?"emphasis":"normal");var a=new rg(sv(e.option),t,{include:["grid"]});n._brushController.setPanels(a.makePanelOpts(r,function(e){return e.xAxisDeclared&&!e.yAxisDeclared?"lineX":!e.xAxisDeclared&&e.yAxisDeclared?"lineY":"rect"})).enableBrush(!!o&&{brushType:"auto",brushStyle:{lineWidth:0,fill:"rgba(0,0,0,0.2)"}})}function uv(e){this.model=e}function cv(e){return $D(e)}function dv(){if(!jD&&YD){jD=!0;var e=YD.styleSheets;e.length<31?YD.createStyleSheet().addRule(".zrvml","behavior:url(#default#VML)"):e[0].addRule(".zrvml","behavior:url(#default#VML)")}}function fv(e){return parseInt(e,10)}function pv(e,t){dv(),this.root=e,this.storage=t;var n=document.createElement("div"),i=document.createElement("div");n.style.cssText="display:inline-block;overflow:hidden;position:relative;width:300px;height:150px;",i.style.cssText="position:absolute;left:0;top:0;",e.appendChild(n),this._vmlRoot=i,this._vmlViewport=n,this.resize();var r=t.delFromStorage,o=t.addToStorage;t.delFromStorage=function(e){r.call(t,e),e&&e.onRemove&&e.onRemove(i)},t.addToStorage=function(e){e.onAdd&&e.onAdd(i),o.call(t,e)},this._firstPaint=!0}function gv(e){return function(){U_('In IE8.0 VML mode painter not support method "'+e+'"')}}function mv(e){return document.createElementNS(Ek,e)}function vv(e){return Lk(1e4*e)/1e4}function yv(e){return e<Fk&&e>-Fk}function xv(e,t){var n=t?e.textFill:e.fill;return null!=n&&n!==kk}function _v(e,t){var n=t?e.textStroke:e.stroke;return null!=n&&n!==kk}function bv(e,t){t&&wv(e,"transform","matrix("+Dk.call(t,",")+")")}function wv(e,t,n){(!n||"linear"!==n.type&&"radial"!==n.type)&&e.setAttribute(t,n)}function Sv(e,t,n){e.setAttributeNS("http://www.w3.org/1999/xlink",t,n)}function Mv(e,t,n){if(xv(t,n)){var i=n?t.textFill:t.fill;i="transparent"===i?kk:i,"none"!==e.getAttribute("clip-path")&&i===kk&&(i="rgba(0, 0, 0, 0.002)"),wv(e,"fill",i),wv(e,"fill-opacity",t.opacity)}else wv(e,"fill",kk);if(_v(t,n)){var r=n?t.textStroke:t.stroke;wv(e,"stroke",r="transparent"===r?kk:r),wv(e,"stroke-width",(n?t.textStrokeWidth:t.lineWidth)/(t.strokeNoScale?t.host.getLineScale():1)),wv(e,"paint-order","stroke"),wv(e,"stroke-opacity",t.opacity),t.lineDash?(wv(e,"stroke-dasharray",t.lineDash.join(",")),wv(e,"stroke-dashoffset",Lk(t.lineDashOffset||0))):wv(e,"stroke-dasharray",""),t.lineCap&&wv(e,"stroke-linecap",t.lineCap),t.lineJoin&&wv(e,"stroke-linejoin",t.lineJoin),t.miterLimit&&wv(e,"stroke-miterlimit",t.miterLimit)}else wv(e,"stroke",kk)}function Iv(e){for(var t=[],n=e.data,i=e.len(),r=0;r<i;){var o="",a=0;switch(n[r++]){case Ik.M:o="M",a=2;break;case Ik.L:o="L",a=2;break;case Ik.Q:o="Q",a=4;break;case Ik.C:o="C",a=6;break;case Ik.A:var s=n[r++],l=n[r++],c=n[r++],u=n[r++],d=n[r++],h=n[r++],p=n[r++],f=n[r++],g=Math.abs(h),m=yv(g%Rk)&&!yv(g),v=!1;v=g>=Rk||!yv(g)&&(h>-Ok&&h<0||h>Ok)==!!f;var _=vv(s+c*Pk(d)),y=vv(l+u*Nk(d));m&&(h=f?Rk-1e-4:1e-4-Rk,v=!0,9===r&&t.push("M",_,y));var x=vv(s+c*Pk(d+h)),b=vv(l+u*Nk(d+h));t.push("A",vv(c),vv(u),Lk(p*zk),+v,+f,x,b);break;case Ik.Z:o="Z";break;case Ik.R:var x=vv(n[r++]),b=vv(n[r++]),w=vv(n[r++]),C=vv(n[r++]);t.push("M",x,b,"L",x+w,b,"L",x+w,b+C,"L",x,b+C,"L",x,b)}o&&t.push(o);for(var S=0;S<a;S++)t.push(vv(n[r++]))}return t.join(" ")}function Tv(e){return"middle"===e?"middle":"bottom"===e?"baseline":"hanging"}function Av(){}function Cv(e,t,n,i){for(var r=0,o=t.length,a=0,s=0;r<o;r++){var l=t[r];if(l.removed){for(var c=[],u=s;u<s+l.count;u++)c.push(u);l.indices=c,s+=l.count}else{for(var c=[],u=a;u<a+l.count;u++)c.push(u);l.indices=c,a+=l.count,l.added||(s+=l.count)}}return t}function Dv(e){return{newPos:e.newPos,components:e.components.slice(0)}}function Lv(e,t,n){this._svgRoot=e,this._tagNames="string"==typeof t?[t]:t,this._markLabel=n,this.nextId=0}function kv(e){Lv.call(this,e,["linearGradient","radialGradient"],"__gradient_in_use__")}function Pv(e){Lv.call(this,e,"clipPath","__clippath_in_use__")}function Ov(e){return parseInt(e,10)}function zv(e){return e instanceof Nn?Bk:e instanceof qe?Hk:e instanceof rb?Vk:Bk}function Nv(e,t){return t&&e&&t.parentNode!==e}function Ev(e,t,n){if(Nv(e,t)&&n){var i=n.nextSibling;i?e.insertBefore(t,i):e.appendChild(t)}}function Rv(e,t){if(Nv(e,t)){var n=e.firstChild;n?e.insertBefore(t,n):e.appendChild(t)}}function Vv(e,t){t&&e&&t.parentNode===e&&e.removeChild(t)}function Bv(e){return e.__textSvgEl}function Gv(e){return e.__svgEl}function Wv(e){return function(){U_('In SVG mode painter not support method "'+e+'"')}}var Uv=2311,$v=function(){return Uv++},qv={},jv=qv="undefined"==typeof navigator?{browser:{},os:{},node:!0,canvasSupported:!0,svgSupported:!0}:function(e){var t={},n={},i=e.match(/Firefox\/([\d.]+)/),r=e.match(/MSIE\s([\d.]+)/)||e.match(/Trident\/.+?rv:(([\d.]+))/),o=e.match(/Edge\/([\d.]+)/),a=/micromessenger/i.test(e);return i&&(n.firefox=!0,n.version=i[1]),r&&(n.ie=!0,n.version=r[1]),o&&(n.edge=!0,n.version=o[1]),a&&(n.weChat=!0),{browser:n,os:t,node:!1,canvasSupported:!!document.createElement("canvas").getContext,svgSupported:"undefined"!=typeof SVGRect,touchEventsSupported:"ontouchstart"in window&&!n.ie&&!n.edge,pointerEventsSupported:"onpointerdown"in window&&(n.edge||n.ie&&n.version>=11)}}(navigator.userAgent),Yv={"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1,"[object CanvasGradient]":1,"[object CanvasPattern]":1,"[object Image]":1,"[object Canvas]":1},Xv={"[object Int8Array]":1,"[object Uint8Array]":1,"[object Uint8ClampedArray]":1,"[object Int16Array]":1,"[object Uint16Array]":1,"[object Int32Array]":1,"[object Uint32Array]":1,"[object Float32Array]":1,"[object Float64Array]":1},Zv=Object.prototype.toString,Kv=Array.prototype,Jv=Kv.forEach,Qv=Kv.filter,e_=Kv.slice,t_=Kv.map,n_=Kv.reduce,i_={},r_=function(){return i_.createCanvas()};i_.createCanvas=function(){return document.createElement("canvas")};var o_,a_="__ec_primitive__";O.prototype={constructor:O,get:function(e){return this["_ec_"+e]},set:function(e,t){return this["_ec_"+e]=t,t},each:function(e,t){void 0!==t&&(e=m(e,t));for(var n in this)this.hasOwnProperty(n)&&e(this[n],n.slice(4))},removeKey:function(e){delete this["_ec_"+e]}};var s_=(Object.freeze||Object)({$override:e,clone:i,merge:n,mergeAll:o,extend:a,defaults:r,createCanvas:r_,getContext:s,indexOf:l,inherits:h,mixin:u,isArrayLike:c,each:d,map:f,reduce:p,filter:g,find:function(e,t,n){if(e&&t)for(var i=0,r=e.length;i<r;i++)if(t.call(n,e[i],i,e))return e[i]},bind:m,curry:v,isArray:y,isFunction:x,isString:_,isObject:b,isBuiltInObject:w,isDom:S,eqNaN:M,retrieve:I,retrieve2:T,retrieve3:A,slice:C,normalizeCssArray:D,assert:L,setAsPrimitive:k,isPrimitive:P,createHashMap:z,noop:N}),l_="undefined"==typeof Float32Array?Array:Float32Array,c_=F,u_=Z,d_=j,h_=q,p_=(Object.freeze||Object)({create:E,copy:R,clone:V,set:B,add:G,scaleAndAdd:W,sub:H,len:F,length:c_,lenSquare:Z,lengthSquare:u_,mul:function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e},div:function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]},scale:U,normalize:X,distance:j,dist:d_,distanceSquare:q,distSquare:h_,negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e},lerp:Y,applyTransform:$,min:K,max:J});Q.prototype={constructor:Q,_dragStart:function(e){var t=e.target;t&&t.draggable&&(this._draggingTarget=t,t.dragging=!0,this._x=e.offsetX,this._y=e.offsetY,this.dispatchToElement(tt(t,e),"dragstart",e.event))},_drag:function(e){var t=this._draggingTarget;if(t){var n=e.offsetX,i=e.offsetY,r=n-this._x,o=i-this._y;this._x=n,this._y=i,t.drift(r,o,e),this.dispatchToElement(tt(t,e),"drag",e.event);var a=this.findHover(n,i,t).target,s=this._dropTarget;this._dropTarget=a,t!==a&&(s&&a!==s&&this.dispatchToElement(tt(s,e),"dragleave",e.event),a&&a!==s&&this.dispatchToElement(tt(a,e),"dragenter",e.event))}},_dragEnd:function(e){var t=this._draggingTarget;t&&(t.dragging=!1),this.dispatchToElement(tt(t,e),"dragend",e.event),this._dropTarget&&this.dispatchToElement(tt(this._dropTarget,e),"drop",e.event),this._draggingTarget=null,this._dropTarget=null}};var f_=Array.prototype.slice,g_=function(){this._$handlers={}};g_.prototype={constructor:g_,one:function(e,t,n){var i=this._$handlers;if(!t||!e)return this;i[e]||(i[e]=[]);for(var r=0;r<i[e].length;r++)if(i[e][r].h===t)return this;return i[e].push({h:t,one:!0,ctx:n||this}),this},on:function(e,t,n){var i=this._$handlers;if(!t||!e)return this;i[e]||(i[e]=[]);for(var r=0;r<i[e].length;r++)if(i[e][r].h===t)return this;return i[e].push({h:t,one:!1,ctx:n||this}),this},isSilent:function(e){var t=this._$handlers;return t[e]&&t[e].length},off:function(e,t){var n=this._$handlers;if(!e)return this._$handlers={},this;if(t){if(n[e]){for(var i=[],r=0,o=n[e].length;r<o;r++)n[e][r].h!=t&&i.push(n[e][r]);n[e]=i}n[e]&&0===n[e].length&&delete n[e]}else delete n[e];return this},trigger:function(e){if(this._$handlers[e]){var t=arguments,n=t.length;n>3&&(t=f_.call(t,1));for(var i=this._$handlers[e],r=i.length,o=0;o<r;){switch(n){case 1:i[o].h.call(i[o].ctx);break;case 2:i[o].h.call(i[o].ctx,t[1]);break;case 3:i[o].h.call(i[o].ctx,t[1],t[2]);break;default:i[o].h.apply(i[o].ctx,t)}i[o].one?(i.splice(o,1),r--):o++}}return this},triggerWithContext:function(e){if(this._$handlers[e]){var t=arguments,n=t.length;n>4&&(t=f_.call(t,1,t.length-1));for(var i=t[t.length-1],r=this._$handlers[e],o=r.length,a=0;a<o;){switch(n){case 1:r[a].h.call(i);break;case 2:r[a].h.call(i,t[1]);break;case 3:r[a].h.call(i,t[1],t[2]);break;default:r[a].h.apply(i,t)}r[a].one?(r.splice(a,1),o--):a++}}return this}};var m_="silent";it.prototype.dispose=function(){};var v_=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],__=function(e,t,n,i){g_.call(this),this.storage=e,this.painter=t,this.painterRoot=i,n=n||new it,this.proxy=n,n.handler=this,this._hovered={},this._lastTouchMoment,this._lastX,this._lastY,Q.call(this),d(v_,function(e){n.on&&n.on(e,this[e],this)},this)};__.prototype={constructor:__,mousemove:function(e){var t=e.zrX,n=e.zrY,i=this._hovered,r=i.target;r&&!r.__zr&&(r=(i=this.findHover(i.x,i.y)).target);var o=this._hovered=this.findHover(t,n),a=o.target,s=this.proxy;s.setCursor&&s.setCursor(a?a.cursor:"default"),r&&a!==r&&this.dispatchToElement(i,"mouseout",e),this.dispatchToElement(o,"mousemove",e),a&&a!==r&&this.dispatchToElement(o,"mouseover",e)},mouseout:function(e){this.dispatchToElement(this._hovered,"mouseout",e);var t,n=e.toElement||e.relatedTarget;do{n=n&&n.parentNode}while(n&&9!=n.nodeType&&!(t=n===this.painterRoot));!t&&this.trigger("globalout",{event:e})},resize:function(e){this._hovered={}},dispatch:function(e,t){var n=this[e];n&&n.call(this,t)},dispose:function(){this.proxy.dispose(),this.storage=this.proxy=this.painter=null},setCursorStyle:function(e){var t=this.proxy;t.setCursor&&t.setCursor(e)},dispatchToElement:function(e,t,n){var i=(e=e||{}).target;if(!i||!i.silent){for(var r="on"+t,o=et(t,e,n);i&&(i[r]&&(o.cancelBubble=i[r].call(i,o)),i.trigger(t,o),i=i.parent,!o.cancelBubble););o.cancelBubble||(this.trigger(t,o),this.painter&&this.painter.eachOtherLayer(function(e){"function"==typeof e[r]&&e[r].call(e,o),e.trigger&&e.trigger(t,o)}))}},findHover:function(e,t,n){for(var i=this.storage.getDisplayList(),r={x:e,y:t},o=i.length-1;o>=0;o--){var a;if(i[o]!==n&&!i[o].ignore&&(a=nt(i[o],e,t))&&(!r.topTarget&&(r.topTarget=i[o]),a!==m_)){r.target=i[o];break}}return r}},d(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(e){__.prototype[e]=function(t){var n=this.findHover(t.zrX,t.zrY),i=n.target;if("mousedown"===e)this._downEl=i,this._downPoint=[t.zrX,t.zrY],this._upEl=i;else if("mosueup"===e)this._upEl=i;else if("click"===e){if(this._downEl!==this._upEl||!this._downPoint||d_(this._downPoint,[t.zrX,t.zrY])>4)return;this._downPoint=null}this.dispatchToElement(n,e,t)}}),u(__,g_),u(__,Q);var y_="undefined"==typeof Float32Array?Array:Float32Array,x_=(Object.freeze||Object)({create:ot,identity:at,copy:rt,mul:st,translate:lt,rotate:ht,scale:ut,invert:ct}),b_=at,w_=5e-5,C_=function(e){(e=e||{}).position||(this.position=[0,0]),null==e.rotation&&(this.rotation=0),e.scale||(this.scale=[1,1]),this.origin=this.origin||null},S_=C_.prototype;S_.transform=null,S_.needLocalTransform=function(){return dt(this.rotation)||dt(this.position[0])||dt(this.position[1])||dt(this.scale[0]-1)||dt(this.scale[1]-1)},S_.updateTransform=function(){var e=this.parent,t=e&&e.transform,n=this.needLocalTransform(),i=this.transform;n||t?(i=i||ot(),n?this.getLocalTransform(i):b_(i),t&&(n?st(i,e.transform,i):rt(i,e.transform)),this.transform=i,this.invTransform=this.invTransform||ot(),ct(this.invTransform,i)):i&&b_(i)},S_.getLocalTransform=function(e){return C_.getLocalTransform(this,e)},S_.setTransform=function(e){var t=this.transform,n=e.dpr||1;t?e.setTransform(n*t[0],n*t[1],n*t[2],n*t[3],n*t[4],n*t[5]):e.setTransform(n,0,0,n,0,0)},S_.restoreTransform=function(e){var t=e.dpr||1;e.setTransform(t,0,0,t,0,0)};var T_=[];S_.decomposeTransform=function(){if(this.transform){var e=this.parent,t=this.transform;e&&e.transform&&(st(T_,e.invTransform,t),t=T_);var n=t[0]*t[0]+t[1]*t[1],i=t[2]*t[2]+t[3]*t[3],r=this.position,o=this.scale;dt(n-1)&&(n=Math.sqrt(n)),dt(i-1)&&(i=Math.sqrt(i)),t[0]<0&&(n=-n),t[3]<0&&(i=-i),r[0]=t[4],r[1]=t[5],o[0]=n,o[1]=i,this.rotation=Math.atan2(-t[1]/i,t[0]/n)}},S_.getGlobalScale=function(){var e=this.transform;if(!e)return[1,1];var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]),n=Math.sqrt(e[2]*e[2]+e[3]*e[3]);return e[0]<0&&(t=-t),e[3]<0&&(n=-n),[t,n]},S_.transformCoordToLocal=function(e,t){var n=[e,t],i=this.invTransform;return i&&$(n,n,i),n},S_.transformCoordToGlobal=function(e,t){var n=[e,t],i=this.transform;return i&&$(n,n,i),n},C_.getLocalTransform=function(e,t){b_(t=t||[]);var n=e.origin,i=e.scale||[1,1],r=e.rotation||0,o=e.position||[0,0];return n&&(t[4]-=n[0],t[5]-=n[1]),ut(t,t,i),r&&ht(t,t,r),n&&(t[4]+=n[0],t[5]+=n[1]),t[4]+=o[0],t[5]+=o[1],t};var A_={linear:function(e){return e},quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},quarticIn:function(e){return e*e*e*e},quarticOut:function(e){return 1- --e*e*e*e},quarticInOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},quinticIn:function(e){return e*e*e*e*e},quinticOut:function(e){return--e*e*e*e*e+1},quinticInOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},sinusoidalIn:function(e){return 1-Math.cos(e*Math.PI/2)},sinusoidalOut:function(e){return Math.sin(e*Math.PI/2)},sinusoidalInOut:function(e){return.5*(1-Math.cos(Math.PI*e))},exponentialIn:function(e){return 0===e?0:Math.pow(1024,e-1)},exponentialOut:function(e){return 1===e?1:1-Math.pow(2,-10*e)},exponentialInOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))},circularIn:function(e){return 1-Math.sqrt(1-e*e)},circularOut:function(e){return Math.sqrt(1- --e*e)},circularInOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},elasticIn:function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),-n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4))},elasticOut:function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/.4)+1)},elasticInOut:function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),(e*=2)<1?n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*-.5:n*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*.5+1)},backIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},backOut:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},backInOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)},bounceIn:function(e){return 1-A_.bounceOut(1-e)},bounceOut:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},bounceInOut:function(e){return e<.5?.5*A_.bounceIn(2*e):.5*A_.bounceOut(2*e-1)+.5}};ft.prototype={constructor:ft,step:function(e,t){if(this._initialized||(this._startTime=e+this._delay,this._initialized=!0),this._paused)this._pausedTime+=t;else{var n=(e-this._startTime-this._pausedTime)/this._life;if(!(n<0)){n=Math.min(n,1);var i=this.easing,r="string"==typeof i?A_[i]:i,o="function"==typeof r?r(n):n;return this.fire("frame",o),1==n?this.loop?(this.restart(e),"restart"):(this._needsRemove=!0,"destroy"):null}}},restart:function(e){var t=(e-this._startTime-this._pausedTime)%this._life;this._startTime=e-t+this.gap,this._pausedTime=0,this._needsRemove=!1},fire:function(e,t){this[e="on"+e]&&this[e](this._target,t)},pause:function(){this._paused=!0},resume:function(){this._paused=!1}};var M_=function(){this.head=null,this.tail=null,this._len=0},E_=M_.prototype;E_.insert=function(e){var t=new I_(e);return this.insertEntry(t),t},E_.insertEntry=function(e){this.head?(this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e):this.head=this.tail=e,this._len++},E_.remove=function(e){var t=e.prev,n=e.next;t?t.next=n:this.head=n,n?n.prev=t:this.tail=t,e.next=e.prev=null,this._len--},E_.len=function(){return this._len},E_.clear=function(){this.head=this.tail=null,this._len=0};var I_=function(e){this.value=e,this.next,this.prev},D_=function(e){this._list=new M_,this._map={},this._maxSize=e||10,this._lastRemovedEntry=null},k_=D_.prototype;k_.put=function(e,t){var n=this._list,i=this._map,r=null;if(null==i[e]){var o=n.len(),a=this._lastRemovedEntry;if(o>=this._maxSize&&o>0){var s=n.head;n.remove(s),delete i[s.key],r=s.value,this._lastRemovedEntry=s}a?a.value=t:a=new I_(t),a.key=e,n.insertEntry(a),i[e]=a}return r},k_.get=function(e){var t=this._map[e],n=this._list;if(null!=t)return t!==n.tail&&(n.remove(t),n.insertEntry(t)),t.value},k_.clear=function(){this._list.clear(),this._map={}};var L_={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]},N_=new D_(20),P_=null,O_=Dt,R_=Lt,z_=(Object.freeze||Object)({parse:Mt,lift:At,toHex:Ct,fastLerp:Dt,fastMapToColor:O_,lerp:Lt,mapToColor:R_,modifyHSL:kt,modifyAlpha:Pt,stringify:Ot}),F_=Array.prototype.slice,B_=function(e,t,n,i){this._tracks={},this._target=e,this._loop=t||!1,this._getter=n||zt,this._setter=i||Nt,this._clipCount=0,this._delay=0,this._doneList=[],this._onframeList=[],this._clipList=[]};B_.prototype={when:function(e,t){var n=this._tracks;for(var i in t)if(t.hasOwnProperty(i)){if(!n[i]){n[i]=[];var r=this._getter(this._target,i);if(null==r)continue;0!==e&&n[i].push({time:0,value:Ft(r)})}n[i].push({time:e,value:t[i]})}return this},during:function(e){return this._onframeList.push(e),this},pause:function(){for(var e=0;e<this._clipList.length;e++)this._clipList[e].pause();this._paused=!0},resume:function(){for(var e=0;e<this._clipList.length;e++)this._clipList[e].resume();this._paused=!1},isPaused:function(){return!!this._paused},_doneCallback:function(){this._tracks={},this._clipList.length=0;for(var e=this._doneList,t=e.length,n=0;n<t;n++)e[n].call(this)},start:function(e,t){var n,i=this,r=0;for(var o in this._tracks)if(this._tracks.hasOwnProperty(o)){var a=Xt(this,e,function(){--r||i._doneCallback()},this._tracks[o],o,t);a&&(this._clipList.push(a),r++,this.animation&&this.animation.addClip(a),n=a)}if(n){var s=n.onframe;n.onframe=function(e,t){s(e,t);for(var n=0;n<i._onframeList.length;n++)i._onframeList[n](e,t)}}return r||this._doneCallback(),this},stop:function(e){for(var t=this._clipList,n=this.animation,i=0;i<t.length;i++){var r=t[i];e&&r.onframe(this._target,1),n&&n.removeClip(r)}t.length=0},delay:function(e){return this._delay=e,this},done:function(e){return e&&this._doneList.push(e),this},getClips:function(){return this._clipList}};var H_=1;"undefined"!=typeof window&&(H_=Math.max(window.devicePixelRatio||1,1));var V_=H_,W_=function(){},U_=W_,$_=function(){this.animators=[]};$_.prototype={constructor:$_,animate:function(e,t){var n,i=!1,r=this,o=this.__zr;if(e){var a=e.split("."),s=r;i="shape"===a[0];for(var c=0,u=a.length;c<u;c++)s&&(s=s[a[c]]);s&&(n=s)}else n=r;if(n){var d=r.animators,h=new B_(n,t);return h.during(function(e){r.dirty(i)}).done(function(){d.splice(l(d,h),1)}),d.push(h),o&&o.animation.addAnimator(h),h}U_('Property "'+e+'" is not existed in element '+r.id)},stopAnimation:function(e){for(var t=this.animators,n=t.length,i=0;i<n;i++)t[i].stop(e);return t.length=0,this},animateTo:function(e,t,n,i,r,o){_(n)?(r=i,i=n,n=0):x(i)?(r=i,i="linear",n=0):x(n)?(r=n,n=0):x(t)?(r=t,t=500):t||(t=500),this.stopAnimation(),this._animateToShallow("",this,e,t,n);var a=this.animators.slice(),s=a.length;s||r&&r();for(var l=0;l<a.length;l++)a[l].done(function(){--s||r&&r()}).start(i,o)},_animateToShallow:function(e,t,n,i,r){var o={},a=0;for(var s in n)if(n.hasOwnProperty(s))if(null!=t[s])b(n[s])&&!c(n[s])?this._animateToShallow(e?e+"."+s:s,t[s],n[s],i,r):(o[s]=n[s],a++);else if(null!=n[s])if(e){var l={};l[e]={},l[e][s]=n[s],this.attr(l)}else this.attr(s,n[s]);return a>0&&this.animate(e,!1).when(null==i?500:i,o).delay(r||0),this}};var G_=function(e){C_.call(this,e),g_.call(this,e),$_.call(this,e),this.id=e.id||$v()};G_.prototype={type:"element",name:"",__zr:null,ignore:!1,clipPath:null,drift:function(e,t){switch(this.draggable){case"horizontal":t=0;break;case"vertical":e=0}var n=this.transform;n||(n=this.transform=[1,0,0,1,0,0]),n[4]+=e,n[5]+=t,this.decomposeTransform(),this.dirty(!1)},beforeUpdate:function(){},afterUpdate:function(){},update:function(){this.updateTransform()},traverse:function(e,t){},attrKV:function(e,t){if("position"===e||"scale"===e||"origin"===e){if(t){var n=this[e];n||(n=this[e]=[]),n[0]=t[0],n[1]=t[1]}}else this[e]=t},hide:function(){this.ignore=!0,this.__zr&&this.__zr.refresh()},show:function(){this.ignore=!1,this.__zr&&this.__zr.refresh()},attr:function(e,t){if("string"==typeof e)this.attrKV(e,t);else if(b(e))for(var n in e)e.hasOwnProperty(n)&&this.attrKV(n,e[n]);return this.dirty(!1),this},setClipPath:function(e){var t=this.__zr;t&&e.addSelfToZr(t),this.clipPath&&this.clipPath!==e&&this.removeClipPath(),this.clipPath=e,e.__zr=t,e.__clipTarget=this,this.dirty(!1)},removeClipPath:function(){var e=this.clipPath;e&&(e.__zr&&e.removeSelfFromZr(e.__zr),e.__zr=null,e.__clipTarget=null,this.clipPath=null,this.dirty(!1))},addSelfToZr:function(e){this.__zr=e;var t=this.animators;if(t)for(var n=0;n<t.length;n++)e.animation.addAnimator(t[n]);this.clipPath&&this.clipPath.addSelfToZr(e)},removeSelfFromZr:function(e){this.__zr=null;var t=this.animators;if(t)for(var n=0;n<t.length;n++)e.animation.removeAnimator(t[n]);this.clipPath&&this.clipPath.removeSelfFromZr(e)}},u(G_,$_),u(G_,C_),u(G_,g_);var q_=$,j_=Math.min,Y_=Math.max;jt.prototype={constructor:jt,union:function(e){var t=j_(e.x,this.x),n=j_(e.y,this.y);this.width=Y_(e.x+e.width,this.x+this.width)-t,this.height=Y_(e.y+e.height,this.y+this.height)-n,this.x=t,this.y=n},applyTransform:function(){var e=[],t=[],n=[],i=[];return function(r){if(r){e[0]=n[0]=this.x,e[1]=i[1]=this.y,t[0]=i[0]=this.x+this.width,t[1]=n[1]=this.y+this.height,q_(e,e,r),q_(t,t,r),q_(n,n,r),q_(i,i,r),this.x=j_(e[0],t[0],n[0],i[0]),this.y=j_(e[1],t[1],n[1],i[1]);var o=Y_(e[0],t[0],n[0],i[0]),a=Y_(e[1],t[1],n[1],i[1]);this.width=o-this.x,this.height=a-this.y}}}(),calculateTransform:function(e){var t=this,n=e.width/t.width,i=e.height/t.height,r=ot();return lt(r,r,[-t.x,-t.y]),ut(r,r,[n,i]),lt(r,r,[e.x,e.y]),r},intersect:function(e){if(!e)return!1;e instanceof jt||(e=jt.create(e));var t=this,n=t.x,i=t.x+t.width,r=t.y,o=t.y+t.height,a=e.x,s=e.x+e.width,l=e.y,c=e.y+e.height;return!(i<a||s<n||o<l||c<r)},contain:function(e,t){var n=this;return e>=n.x&&e<=n.x+n.width&&t>=n.y&&t<=n.y+n.height},clone:function(){return new jt(this.x,this.y,this.width,this.height)},copy:function(e){this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height},plain:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}}},jt.create=function(e){return new jt(e.x,e.y,e.width,e.height)};var X_=function(e){e=e||{},G_.call(this,e);for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);this._children=[],this.__storage=null,this.__dirty=!0};X_.prototype={constructor:X_,isGroup:!0,type:"group",silent:!1,children:function(){return this._children.slice()},childAt:function(e){return this._children[e]},childOfName:function(e){for(var t=this._children,n=0;n<t.length;n++)if(t[n].name===e)return t[n]},childCount:function(){return this._children.length},add:function(e){return e&&e!==this&&e.parent!==this&&(this._children.push(e),this._doAdd(e)),this},addBefore:function(e,t){if(e&&e!==this&&e.parent!==this&&t&&t.parent===this){var n=this._children,i=n.indexOf(t);i>=0&&(n.splice(i,0,e),this._doAdd(e))}return this},_doAdd:function(e){e.parent&&e.parent.remove(e),e.parent=this;var t=this.__storage,n=this.__zr;t&&t!==e.__storage&&(t.addToStorage(e),e instanceof X_&&e.addChildrenToStorage(t)),n&&n.refresh()},remove:function(e){var t=this.__zr,n=this.__storage,i=this._children,r=l(i,e);return r<0?this:(i.splice(r,1),e.parent=null,n&&(n.delFromStorage(e),e instanceof X_&&e.delChildrenFromStorage(n)),t&&t.refresh(),this)},removeAll:function(){var e,t,n=this._children,i=this.__storage;for(t=0;t<n.length;t++)e=n[t],i&&(i.delFromStorage(e),e instanceof X_&&e.delChildrenFromStorage(i)),e.parent=null;return n.length=0,this},eachChild:function(e,t){for(var n=this._children,i=0;i<n.length;i++){var r=n[i];e.call(t,r,i)}return this},traverse:function(e,t){for(var n=0;n<this._children.length;n++){var i=this._children[n];e.call(t,i),"group"===i.type&&i.traverse(e,t)}return this},addChildrenToStorage:function(e){for(var t=0;t<this._children.length;t++){var n=this._children[t];e.addToStorage(n),n instanceof X_&&n.addChildrenToStorage(e)}},delChildrenFromStorage:function(e){for(var t=0;t<this._children.length;t++){var n=this._children[t];e.delFromStorage(n),n instanceof X_&&n.delChildrenFromStorage(e)}},dirty:function(){return this.__dirty=!0,this.__zr&&this.__zr.refresh(),this},getBoundingRect:function(e){for(var t=null,n=new jt(0,0,0,0),i=e||this._children,r=[],o=0;o<i.length;o++){var a=i[o];if(!a.ignore&&!a.invisible){var s=a.getBoundingRect(),l=a.getLocalTransform(r);l?(n.copy(s),n.applyTransform(l),(t=t||n.clone()).union(n)):(t=t||s.clone()).union(s)}}return t||n}},h(X_,G_);var Z_=32,K_=7,J_=function(){this._roots=[],this._displayList=[],this._displayListLen=0};J_.prototype={constructor:J_,traverse:function(e,t){for(var n=0;n<this._roots.length;n++)this._roots[n].traverse(e,t)},getDisplayList:function(e,t){return t=t||!1,e&&this.updateDisplayList(t),this._displayList},updateDisplayList:function(e){this._displayListLen=0;for(var t=this._roots,n=this._displayList,i=0,r=t.length;i<r;i++)this._updateAndAddDisplayable(t[i],null,e);n.length=this._displayListLen,jv.canvasSupported&&ee(n,ie)},_updateAndAddDisplayable:function(e,t,n){if(!e.ignore||n){e.beforeUpdate(),e.__dirty&&e.update(),e.afterUpdate();var i=e.clipPath;if(i){t=t?t.slice():[];for(var r=i,o=e;r;)r.parent=o,r.updateTransform(),t.push(r),o=r,r=r.clipPath}if(e.isGroup){for(var a=e._children,s=0;s<a.length;s++){var l=a[s];e.__dirty&&(l.__dirty=!0),this._updateAndAddDisplayable(l,t,n)}e.__dirty=!1}else e.__clipPaths=t,this._displayList[this._displayListLen++]=e}},addRoot:function(e){e.__storage!==this&&(e instanceof X_&&e.addChildrenToStorage(this),this.addToStorage(e),this._roots.push(e))},delRoot:function(e){if(null==e){for(n=0;n<this._roots.length;n++){var t=this._roots[n];t instanceof X_&&t.delChildrenFromStorage(this)}return this._roots=[],this._displayList=[],void(this._displayListLen=0)}if(e instanceof Array)for(var n=0,i=e.length;n<i;n++)this.delRoot(e[n]);else{var r=l(this._roots,e);r>=0&&(this.delFromStorage(e),this._roots.splice(r,1),e instanceof X_&&e.delChildrenFromStorage(this))}},addToStorage:function(e){return e.__storage=this,e.dirty(!1),this},delFromStorage:function(e){return e&&(e.__storage=null),this},dispose:function(){this._renderList=this._roots=null},displayableSortFunc:ie};var Q_=[["shadowBlur",0],["shadowOffsetX",0],["shadowOffsetY",0],["shadowColor","#000"],["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]],ey=function(e,t){this.extendFrom(e,!1),this.host=t};ey.prototype={constructor:ey,host:null,fill:"#000",stroke:null,opacity:1,lineDash:null,lineDashOffset:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,lineWidth:1,strokeNoScale:!1,text:null,font:null,textFont:null,fontStyle:null,fontWeight:null,fontSize:null,fontFamily:null,textTag:null,textFill:"#000",textStroke:null,textWidth:null,textHeight:null,textStrokeWidth:0,textLineHeight:null,textPosition:"inside",textRect:null,textOffset:null,textAlign:null,textVerticalAlign:null,textDistance:5,textShadowColor:"transparent",textShadowBlur:0,textShadowOffsetX:0,textShadowOffsetY:0,textBoxShadowColor:"transparent",textBoxShadowBlur:0,textBoxShadowOffsetX:0,textBoxShadowOffsetY:0,transformText:!1,textRotation:0,textOrigin:null,textBackgroundColor:null,textBorderColor:null,textBorderWidth:0,textBorderRadius:0,textPadding:null,rich:null,truncate:null,blend:null,bind:function(e,t,n){for(var i=this,r=n&&n.style,o=!r,a=0;a<Q_.length;a++){var s=Q_[a],l=s[0];(o||i[l]!==r[l])&&(e[l]=i[l]||s[1])}if((o||i.fill!==r.fill)&&(e.fillStyle=i.fill),(o||i.stroke!==r.stroke)&&(e.strokeStyle=i.stroke),(o||i.opacity!==r.opacity)&&(e.globalAlpha=null==i.opacity?1:i.opacity),(o||i.blend!==r.blend)&&(e.globalCompositeOperation=i.blend||"source-over"),this.hasStroke()){var c=i.lineWidth;e.lineWidth=c/(this.strokeNoScale&&t&&t.getLineScale?t.getLineScale():1)}},hasFill:function(){var e=this.fill;return null!=e&&"none"!==e},hasStroke:function(){var e=this.stroke;return null!=e&&"none"!==e&&this.lineWidth>0},extendFrom:function(e,t){if(e)for(var n in e)!e.hasOwnProperty(n)||!0!==t&&(!1===t?this.hasOwnProperty(n):null==e[n])||(this[n]=e[n])},set:function(e,t){"string"==typeof e?this[e]=t:this.extendFrom(e,!0)},clone:function(){var e=new this.constructor;return e.extendFrom(this,!0),e},getGradient:function(e,t,n){for(var i=("radial"===t.type?oe:ne)(e,t,n),r=t.colorStops,o=0;o<r.length;o++)i.addColorStop(r[o].offset,r[o].color);return i}};for(var ty=ey.prototype,ny=0;ny<Q_.length;ny++){var iy=Q_[ny];iy[0]in ty||(ty[iy[0]]=iy[1])}ey.getGradient=ty.getGradient;var ry=function(e,t){this.image=e,this.repeat=t,this.type="pattern"};ry.prototype.getCanvasPattern=function(e){return e.createPattern(this.image,this.repeat||"repeat")};var oy=function(e,t,n){var i;n=n||V_,"string"==typeof e?i=re(e,t,n):b(e)&&(e=(i=e).id),this.id=e,this.dom=i;var r=i.style;r&&(i.onselectstart=ae,r["-webkit-user-select"]="none",r["user-select"]="none",r["-webkit-touch-callout"]="none",r["-webkit-tap-highlight-color"]="rgba(0,0,0,0)",r.padding=0,r.margin=0,r["border-width"]=0),this.domBack=null,this.ctxBack=null,this.painter=t,this.config=null,this.clearColor=0,this.motionBlur=!1,this.lastFrameAlpha=.7,this.dpr=n};oy.prototype={constructor:oy,elCount:0,__dirty:!0,initContext:function(){this.ctx=this.dom.getContext("2d"),this.ctx.__currentValues={},this.ctx.dpr=this.dpr},createBackBuffer:function(){var e=this.dpr;this.domBack=re("back-"+this.id,this.painter,e),this.ctxBack=this.domBack.getContext("2d"),this.ctxBack.__currentValues={},1!=e&&this.ctxBack.scale(e,e)},resize:function(e,t){var n=this.dpr,i=this.dom,r=i.style,o=this.domBack;r.width=e+"px",r.height=t+"px",i.width=e*n,i.height=t*n,o&&(o.width=e*n,o.height=t*n,1!=n&&this.ctxBack.scale(n,n))},clear:function(e){var t=this.dom,n=this.ctx,i=t.width,r=t.height,o=this.clearColor,a=this.motionBlur&&!e,s=this.lastFrameAlpha,l=this.dpr;if(a&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(t,0,0,i/l,r/l)),n.clearRect(0,0,i,r),o){var c;o.colorStops?(c=o.__canvasGradient||ey.getGradient(n,o,{x:0,y:0,width:i,height:r}),o.__canvasGradient=c):o.image&&(c=ry.prototype.getCanvasPattern.call(o,n)),n.save(),n.fillStyle=c||o,n.fillRect(0,0,i,r),n.restore()}if(a){var u=this.domBack;n.save(),n.globalAlpha=s,n.drawImage(u,0,0,i,r),n.restore()}}};var ay="undefined"!=typeof window&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(e){setTimeout(e,16)},sy=new D_(50),ly={},cy=0,uy=5e3,dy=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g,hy="12px sans-serif",py={};py.measureText=function(e,t){var n=s();return n.font=t||hy,n.measureText(e)};var fy={left:1,right:1,center:1},gy={top:1,bottom:1,middle:1},my=new jt,vy=function(){};vy.prototype={constructor:vy,drawRectText:function(e,t){var n=this.style;t=n.textRect||t,this.__dirty&&De(n);var i=n.text;if(null!=i&&(i+=""),Xe(i,n)){e.save();var r=this.transform;n.transformText?this.setTransform(e):r&&(my.copy(t),my.applyTransform(r),t=my),ke(this,e,i,n,t),e.restore()}}},je.prototype={constructor:je,type:"displayable",__dirty:!0,invisible:!1,z:0,z2:0,zlevel:0,draggable:!1,dragging:!1,silent:!1,culling:!1,cursor:"pointer",rectHover:!1,progressive:-1,beforeBrush:function(e){},afterBrush:function(e){},brush:function(e,t){},getBoundingRect:function(){},contain:function(e,t){return this.rectContain(e,t)},traverse:function(e,t){e.call(t,this)},rectContain:function(e,t){var n=this.transformCoordToLocal(e,t);return this.getBoundingRect().contain(n[0],n[1])},dirty:function(){this.__dirty=!0,this._rect=null,this.__zr&&this.__zr.refresh()},animateStyle:function(e){return this.animate("style",e)},attrKV:function(e,t){"style"!==e?G_.prototype.attrKV.call(this,e,t):this.style.set(t)},setStyle:function(e,t){return this.style.set(e,t),this.dirty(!1),this},useStyle:function(e){return this.style=new ey(e,this),this.dirty(!1),this}},h(je,G_),u(je,vy),qe.prototype={constructor:qe,type:"image",brush:function(e,t){var n=this.style,i=n.image;n.bind(e,this,t);var r=this._image=le(i,this._image,this,this.onload);if(r&&ue(r)){var o=n.x||0,a=n.y||0,s=n.width,l=n.height,c=r.width/r.height;if(null==s&&null!=l?s=l*c:null==l&&null!=s?l=s/c:null==s&&null==l&&(s=r.width,l=r.height),this.setTransform(e),n.sWidth&&n.sHeight){var u=n.sx||0,d=n.sy||0;e.drawImage(r,u,d,n.sWidth,n.sHeight,o,a,s,l)}else if(n.sx&&n.sy){var h=s-(u=n.sx),p=l-(d=n.sy);e.drawImage(r,u,d,h,p,o,a,s,l)}else e.drawImage(r,o,a,s,l);this.restoreTransform(e),null!=n.text&&this.drawRectText(e,this.getBoundingRect())}},getBoundingRect:function(){var e=this.style;return this._rect||(this._rect=new jt(e.x||0,e.y||0,e.width||0,e.height||0)),this._rect}},h(qe,je);var _y=new jt(0,0,0,0),yy=new jt(0,0,0,0),xy=function(e,t,n){this.type="canvas";var i=!e.nodeName||"CANVAS"===e.nodeName.toUpperCase();this._opts=n=a({},n||{}),this.dpr=n.devicePixelRatio||V_,this._singleCanvas=i,this.root=e;var r=e.style;r&&(r["-webkit-tap-highlight-color"]="transparent",r["-webkit-user-select"]=r["user-select"]=r["-webkit-touch-callout"]="none",e.innerHTML=""),this.storage=t;var o=this._zlevelList=[],s=this._layers={};if(this._layerConfig={},i){null!=n.width&&(e.width=n.width),null!=n.height&&(e.height=n.height);var l=e.width,c=e.height;this._width=l,this._height=c;var u=new oy(e,this,1);u.initContext(),s[0]=u,o.push(0),this._domRoot=e}else{this._width=this._getSize(0),this._height=this._getSize(1);var d=this._domRoot=ii(this._width,this._height);e.appendChild(d)}this._progressiveLayers=[],this._hoverlayer,this._hoverElements=[]};xy.prototype={constructor:xy,getType:function(){return"canvas"},isSingleCanvas:function(){return this._singleCanvas},getViewportRoot:function(){return this._domRoot},getViewportRootOffset:function(){var e=this.getViewportRoot();if(e)return{offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}},refresh:function(e){var t=this.storage.getDisplayList(!0),n=this._zlevelList;this._paintList(t,e);for(var i=0;i<n.length;i++){var r=n[i],o=this._layers[r];!o.__builtin__&&o.refresh&&o.refresh()}return this.refreshHover(),this._progressiveLayers.length&&this._startProgessive(),this},addHover:function(e,t){if(!e.__hoverMir){var n=new e.constructor({style:e.style,shape:e.shape});n.__from=e,e.__hoverMir=n,n.setStyle(t),this._hoverElements.push(n)}},removeHover:function(e){var t=e.__hoverMir,n=this._hoverElements,i=l(n,t);i>=0&&n.splice(i,1),e.__hoverMir=null},clearHover:function(e){for(var t=this._hoverElements,n=0;n<t.length;n++){var i=t[n].__from;i&&(i.__hoverMir=null)}t.length=0},refreshHover:function(){var e=this._hoverElements,t=e.length,n=this._hoverlayer;if(n&&n.clear(),t){ee(e,this.storage.displayableSortFunc),n||(n=this._hoverlayer=this.getLayer(1e5));var i={};n.ctx.save();for(var r=0;r<t;){var o=e[r],a=o.__from;a&&a.__zr?(r++,a.invisible||(o.transform=a.transform,o.invTransform=a.invTransform,o.__clipPaths=a.__clipPaths,this._doPaintEl(o,n,!0,i))):(e.splice(r,1),a.__hoverMir=null,t--)}n.ctx.restore()}},_startProgessive:function(){function t(){n===e._progressiveToken&&e.storage&&(e._doPaintList(e.storage.getDisplayList()),e._furtherProgressive?(e._progress++,ay(t)):e._progressiveToken=-1)}var e=this;if(e._furtherProgressive){var n=e._progressiveToken=+new Date;e._progress++,ay(t)}},_clearProgressive:function(){this._progressiveToken=-1,this._progress=0,d(this._progressiveLayers,function(e){e.__dirty&&e.clear()})},_paintList:function(e,t){null==t&&(t=!1),this._updateLayerStatus(e),this._clearProgressive(),this.eachBuiltinLayer(Ke),this._doPaintList(e,t),this.eachBuiltinLayer(Je)},_doPaintList:function(e,t){function i(e){var t=o.dpr||1;o.save(),o.globalAlpha=1,o.shadowBlur=0,n.__dirty=!0,o.setTransform(1,0,0,1,0,0),o.drawImage(e.dom,0,0,u*t,h*t),o.restore()}for(var n,r,o,a,s,l,c=0,u=this._width,h=this._height,p=this._progress,f=0,g=e.length;f<g;f++){var m=e[f],v=this._singleCanvas?0:m.zlevel,_=m.__frame;if(_<0&&s&&(i(s),s=null),r!==v&&(o&&o.restore(),a={},r=v,(n=this.getLayer(r)).__builtin__||U_("ZLevel "+r+" has been used by unkown layer "+n.id),(o=n.ctx).save(),n.__unusedCount=0,(n.__dirty||t)&&n.clear()),n.__dirty||t){if(_>=0){if(!s){if((s=this._progressiveLayers[Math.min(c++,4)]).ctx.save(),s.renderScope={},s&&s.__progress>s.__maxProgress){f=s.__nextIdxNotProg-1;continue}l=s.__progress,s.__dirty||(p=l),s.__progress=p+1}_===p&&this._doPaintEl(m,s,!0,s.renderScope)}else this._doPaintEl(m,n,t,a);m.__dirty=!1}}s&&i(s),o&&o.restore(),this._furtherProgressive=!1,d(this._progressiveLayers,function(e){e.__maxProgress>=e.__progress&&(this._furtherProgressive=!0)},this)},_doPaintEl:function(e,t,n,i){var r=t.ctx,o=e.transform;if((t.__dirty||n)&&!e.invisible&&0!==e.style.opacity&&(!o||o[0]||o[3])&&(!e.culling||!Qe(e,this._width,this._height))){var a=e.__clipPaths;(i.prevClipLayer!==t||ti(a,i.prevElClipPaths))&&(i.prevElClipPaths&&(i.prevClipLayer.ctx.restore(),i.prevClipLayer=i.prevElClipPaths=null,i.prevEl=null),a&&(r.save(),ei(a,r),i.prevClipLayer=t,i.prevElClipPaths=a)),e.beforeBrush&&e.beforeBrush(r),e.brush(r,i.prevEl||null),i.prevEl=e,e.afterBrush&&e.afterBrush(r)}},getLayer:function(e){if(this._singleCanvas)return this._layers[0];var t=this._layers[e];return t||((t=new oy("zr_"+e,this,this.dpr)).__builtin__=!0,this._layerConfig[e]&&n(t,this._layerConfig[e],!0),this.insertLayer(e,t),t.initContext()),t},insertLayer:function(e,t){var n=this._layers,i=this._zlevelList,r=i.length,o=null,a=-1,s=this._domRoot;if(n[e])U_("ZLevel "+e+" has been used already");else if($e(t)){if(r>0&&e>i[0]){for(a=0;a<r-1&&!(i[a]<e&&i[a+1]>e);a++);o=n[i[a]]}if(i.splice(a+1,0,e),n[e]=t,!t.virtual)if(o){var l=o.dom;l.nextSibling?s.insertBefore(t.dom,l.nextSibling):s.appendChild(t.dom)}else s.firstChild?s.insertBefore(t.dom,s.firstChild):s.appendChild(t.dom)}else U_("Layer of zlevel "+e+" is not valid")},eachLayer:function(e,t){var n,i,r=this._zlevelList;for(i=0;i<r.length;i++)n=r[i],e.call(t,this._layers[n],n)},eachBuiltinLayer:function(e,t){var n,i,r,o=this._zlevelList;for(r=0;r<o.length;r++)i=o[r],(n=this._layers[i]).__builtin__&&e.call(t,n,i)},eachOtherLayer:function(e,t){var n,i,r,o=this._zlevelList;for(r=0;r<o.length;r++)i=o[r],(n=this._layers[i]).__builtin__||e.call(t,n,i)},getLayers:function(){return this._layers},_updateLayerStatus:function(e){var t=this._layers,n=this._progressiveLayers,i={},r={};this.eachBuiltinLayer(function(e,t){i[t]=e.elCount,e.elCount=0,e.__dirty=!1}),d(n,function(e,t){r[t]=e.elCount,e.elCount=0,e.__dirty=!1});for(var o,a,s=0,l=0,c=0,u=e.length;c<u;c++){var h=e[c],p=t[this._singleCanvas?0:h.zlevel],f=h.progressive;if(p&&(p.elCount++,p.__dirty=p.__dirty||h.__dirty),f>=0){a!==f&&(a=f,l++);var g=h.__frame=l-1;if(!o){var m=Math.min(s,4);(o=n[m])||(o=n[m]=new oy("progressive",this,this.dpr)).initContext(),o.__maxProgress=0}o.__dirty=o.__dirty||h.__dirty,o.elCount++,o.__maxProgress=Math.max(o.__maxProgress,g),o.__maxProgress>=o.__progress&&(p.__dirty=!0)}else h.__frame=-1,o&&(o.__nextIdxNotProg=c,s++,o=null)}o&&(s++,o.__nextIdxNotProg=c),this.eachBuiltinLayer(function(e,t){i[t]!==e.elCount&&(e.__dirty=!0)}),n.length=Math.min(s,5),d(n,function(e,t){r[t]!==e.elCount&&(h.__dirty=!0),e.__dirty&&(e.__progress=0)})},clear:function(){return this.eachBuiltinLayer(this._clearLayer),this},_clearLayer:function(e){e.clear()},configLayer:function(e,t){if(t){var i=this._layerConfig;i[e]?n(i[e],t,!0):i[e]=t;var r=this._layers[e];r&&n(r,i[e],!0)}},delLayer:function(e){var t=this._layers,n=this._zlevelList,i=t[e];i&&(i.dom.parentNode.removeChild(i.dom),delete t[e],n.splice(l(n,e),1))},resize:function(e,t){var n=this._domRoot;n.style.display="none";var i=this._opts;if(null!=e&&(i.width=e),null!=t&&(i.height=t),e=this._getSize(0),t=this._getSize(1),n.style.display="",this._width!=e||t!=this._height){n.style.width=e+"px",n.style.height=t+"px";for(var r in this._layers)this._layers.hasOwnProperty(r)&&this._layers[r].resize(e,t);d(this._progressiveLayers,function(n){n.resize(e,t)}),this.refresh(!0)}return this._width=e,this._height=t,this},clearLayer:function(e){var t=this._layers[e];t&&t.clear()},dispose:function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},getRenderedCanvas:function(t){function e(e,t){var i=a._zlevelList;null==e&&(e=-1/0);for(var r,o=0;o<i.length;o++){var s=i[o],l=a._layers[s];if(!l.__builtin__&&s>e&&s<t){r=l;break}}r&&r.renderToCanvas&&(n.ctx.save(),r.renderToCanvas(n.ctx),n.ctx.restore())}if(t=t||{},this._singleCanvas)return this._layers[0].dom;var n=new oy("image",this,t.pixelRatio||this.dpr);n.initContext(),n.clearColor=t.backgroundColor,n.clear();for(var i,r=this.storage.getDisplayList(!0),o={},a=this,s=0;s<r.length;s++){var l=r[s];l.zlevel!==i&&(e(i,l.zlevel),i=l.zlevel),this._doPaintEl(l,n,!0,o)}return e(i,1/0),n.dom},getWidth:function(){return this._width},getHeight:function(){return this._height},_getSize:function(e){var t=this._opts,n=["width","height"][e],i=["clientWidth","clientHeight"][e],r=["paddingLeft","paddingTop"][e],o=["paddingRight","paddingBottom"][e];if(null!=t[n]&&"auto"!==t[n])return parseFloat(t[n]);var a=this.root,s=document.defaultView.getComputedStyle(a);return(a[i]||Ye(s[n])||Ye(a.style[n]))-(Ye(s[r])||0)-(Ye(s[o])||0)|0},pathToImage:function(e,t){t=t||this.dpr;var n=document.createElement("canvas"),i=n.getContext("2d"),r=e.getBoundingRect(),o=e.style,a=o.shadowBlur,s=o.shadowOffsetX,l=o.shadowOffsetY,c=o.hasStroke()?o.lineWidth:0,u=Math.max(c/2,-s+a),d=Math.max(c/2,s+a),h=Math.max(c/2,-l+a),p=Math.max(c/2,l+a),f=r.width+u+d,g=r.height+h+p;n.width=f*t,n.height=g*t,i.scale(t,t),i.clearRect(0,0,f,g),i.dpr=t;var m={position:e.position,rotation:e.rotation,scale:e.scale};e.position=[u-r.x,h-r.y],e.rotation=0,e.scale=[1,1],e.updateTransform(),e&&e.brush(i);var v=new qe({style:{x:0,y:0,image:n}});return null!=m.position&&(v.position=e.position=m.position),null!=m.rotation&&(v.rotation=e.rotation=m.rotation),null!=m.scale&&(v.scale=e.scale=m.scale),v}};var by="undefined"!=typeof window&&!!window.addEventListener,wy=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Cy=by?function(e){e.preventDefault(),e.stopPropagation(),e.cancelBubble=!0}:function(e){e.returnValue=!1,e.cancelBubble=!0},Sy=function(e){e=e||{},this.stage=e.stage||{},this.onframe=e.onframe||function(){},this._clips=[],this._running=!1,this._time,this._pausedTime,this._pauseStart,this._paused=!1,g_.call(this)};Sy.prototype={constructor:Sy,addClip:function(e){this._clips.push(e)},addAnimator:function(e){e.animation=this;for(var t=e.getClips(),n=0;n<t.length;n++)this.addClip(t[n])},removeClip:function(e){var t=l(this._clips,e);t>=0&&this._clips.splice(t,1)},removeAnimator:function(e){for(var t=e.getClips(),n=0;n<t.length;n++)this.removeClip(t[n]);e.animation=null},_update:function(){for(var e=(new Date).getTime()-this._pausedTime,t=e-this._time,n=this._clips,i=n.length,r=[],o=[],a=0;a<i;a++){var s=n[a],l=s.step(e,t);l&&(r.push(l),o.push(s))}for(a=0;a<i;)n[a]._needsRemove?(n[a]=n[i-1],n.pop(),i--):a++;for(i=r.length,a=0;a<i;a++)o[a].fire(r[a]);this._time=e,this.onframe(t),this.trigger("frame",t),this.stage.update&&this.stage.update()},_startLoop:function(){function t(){e._running&&(ay(t),!e._paused&&e._update())}var e=this;this._running=!0,ay(t)},start:function(){this._time=(new Date).getTime(),this._pausedTime=0,this._startLoop()},stop:function(){this._running=!1},pause:function(){this._paused||(this._pauseStart=(new Date).getTime(),this._paused=!0)},resume:function(){this._paused&&(this._pausedTime+=(new Date).getTime()-this._pauseStart,this._paused=!1)},clear:function(){this._clips=[]},animate:function(e,t){var n=new B_(e,(t=t||{}).loop,t.getter,t.setter);return this.addAnimator(n),n}},u(Sy,g_);var Ty=function(){this._track=[]};Ty.prototype={constructor:Ty,recognize:function(e,t,n){return this._doTrack(e,t,n),this._recognize(e)},clear:function(){return this._track.length=0,this},_doTrack:function(e,t,n){var i=e.touches;if(i){for(var r={points:[],touches:[],target:t,event:e},o=0,a=i.length;o<a;o++){var s=i[o],l=oi(n,s,{});r.points.push([l.zrX,l.zrY]),r.touches.push(s)}this._track.push(r)}},_recognize:function(e){for(var t in Ay)if(Ay.hasOwnProperty(t)){var n=Ay[t](this._track,e);if(n)return n}}};var Ay={pinch:function(e,t){var n=e.length;if(n){var i=(e[n-1]||{}).points,r=(e[n-2]||{}).points||i;if(r&&r.length>1&&i&&i.length>1){var o=ui(i)/ui(r);!isFinite(o)&&(o=1),t.pinchScale=o;var a=ci(i);return t.pinchX=a[0],t.pinchY=a[1],{type:"pinch",target:e[0].target,event:t}}}}},My=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],Ey=["touchstart","touchend","touchmove"],Iy={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},Dy=f(My,function(e){var t=e.replace("mouse","pointer");return Iy[t]?t:e}),ky={mousemove:function(e){e=ri(this.dom,e),this.trigger("mousemove",e)},mouseout:function(e){var t=(e=ri(this.dom,e)).toElement||e.relatedTarget;if(t!=this.dom)for(;t&&9!=t.nodeType;){if(t===this.dom)return;t=t.parentNode}this.trigger("mouseout",e)},touchstart:function(e){(e=ri(this.dom,e)).zrByTouch=!0,this._lastTouchMoment=new Date,fi(this,e,"start"),ky.mousemove.call(this,e),ky.mousedown.call(this,e),pi(this)},touchmove:function(e){(e=ri(this.dom,e)).zrByTouch=!0,fi(this,e,"change"),ky.mousemove.call(this,e),pi(this)},touchend:function(e){(e=ri(this.dom,e)).zrByTouch=!0,fi(this,e,"end"),ky.mouseup.call(this,e),+new Date-this._lastTouchMoment<300&&ky.click.call(this,e),pi(this)},pointerdown:function(e){ky.mousedown.call(this,e)},pointermove:function(e){gi(e)||ky.mousemove.call(this,e)},pointerup:function(e){ky.mouseup.call(this,e)},pointerout:function(e){gi(e)||ky.mouseout.call(this,e)}};d(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(e){ky[e]=function(t){t=ri(this.dom,t),this.trigger(e,t)}});var Ly=vi.prototype;Ly.dispose=function(){for(var e=My.concat(Ey),t=0;t<e.length;t++){var n=e[t];li(this.dom,di(n),this._handlers[n])}},Ly.setCursor=function(e){this.dom.style.cursor=e||"default"},u(vi,g_);var Ny=!jv.canvasSupported,Py={canvas:xy},Oy={},Ry=function(e,t,n){n=n||{},this.dom=t,this.id=e;var i=this,r=new J_,o=n.renderer;if(Ny){if(!Py.vml)throw new Error("You need to require 'zrender/vml/vml' to support IE8");o="vml"}else o&&Py[o]||(o="canvas");var a=new Py[o](t,r,n);this.storage=r,this.painter=a;var s=jv.node?null:new vi(a.getViewportRoot());this.handler=new __(r,a,s,a.root),this.animation=new Sy({stage:{update:m(this.flush,this)}}),this.animation.start(),this._needsRefresh;var l=r.delFromStorage,c=r.addToStorage;r.delFromStorage=function(e){l.call(r,e),e&&e.removeSelfFromZr(i)},r.addToStorage=function(e){c.call(r,e),e.addSelfToZr(i)}};Ry.prototype={constructor:Ry,getId:function(){return this.id},add:function(e){this.storage.addRoot(e),this._needsRefresh=!0},remove:function(e){this.storage.delRoot(e),this._needsRefresh=!0},configLayer:function(e,t){this.painter.configLayer(e,t),this._needsRefresh=!0},refreshImmediately:function(){this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1},refresh:function(){this._needsRefresh=!0},flush:function(){this._needsRefresh&&this.refreshImmediately(),this._needsRefreshHover&&this.refreshHoverImmediately()},addHover:function(e,t){this.painter.addHover&&(this.painter.addHover(e,t),this.refreshHover())},removeHover:function(e){this.painter.removeHover&&(this.painter.removeHover(e),this.refreshHover())},clearHover:function(){this.painter.clearHover&&(this.painter.clearHover(),this.refreshHover())},refreshHover:function(){this._needsRefreshHover=!0},refreshHoverImmediately:function(){this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.refreshHover()},resize:function(e){e=e||{},this.painter.resize(e.width,e.height),this.handler.resize()},clearAnimation:function(){this.animation.clear()},getWidth:function(){return this.painter.getWidth()},getHeight:function(){return this.painter.getHeight()},pathToImage:function(e,t){return this.painter.pathToImage(e,t)},setCursorStyle:function(e){this.handler.setCursorStyle(e)},findHover:function(e,t){return this.handler.findHover(e,t)},on:function(e,t,n){this.handler.on(e,t,n)},off:function(e,t){this.handler.off(e,t)},trigger:function(e,t){this.handler.trigger(e,t)},clear:function(){this.storage.delRoot(),this.painter.clear()},dispose:function(){this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,_i(this.id)}};var zy=(Object.freeze||Object)({version:"3.7.4",init:yi,dispose:function(e){if(e)e.dispose();else{for(var t in Oy)Oy.hasOwnProperty(t)&&Oy[t].dispose();Oy={}}return this},getInstance:function(e){return Oy[e]},registerPainter:xi}),Fy=1e-4,By=9007199254740991,Hy=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d\d)(?::(\d\d)(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/,Vy=(Object.freeze||Object)({linearMap:wi,parsePercent:Si,round:Mi,asc:Ii,getPrecision:Ti,getPrecisionSafe:Ai,getPixelPrecision:Ci,getPercentWithPrecision:Di,MAX_SAFE_INTEGER:By,remRadian:Li,isRadianAroundZero:ki,parseDate:Pi,quantity:Oi,nice:Ni,reformIntervals:Ei,isNumeric:Ri}),Wy=D,Uy=["a","b","c","d","e","f","g"],$y=function(e,t){return"{"+e+(null==t?"":t)+"}"},Gy=function(e){return e<10?"0"+e:e},qy=ye,jy=de,Yy=(Object.freeze||Object)({addCommas:Vi,toCamelCase:Bi,normalizeCssArray:Wy,encodeHTML:Gi,formatTpl:Wi,formatTplSimple:Hi,getTooltipMarker:Fi,formatTime:Zi,capitalFirst:Ui,truncateText:qy,getTextRect:jy}),Xy=".",Zy="___EC__COMPONENT__CONTAINER___",Ky="\0ec_\0",Jy=function(e){for(var t=0;t<e.length;t++)e[t][1]||(e[t][1]=e[t][0]);return function(t,n,i){for(var r={},o=0;o<e.length;o++){var a=e[o][1];if(!(n&&l(n,a)>=0||i&&l(i,a)<0)){var s=t.getShallow(a);null!=s&&(r[e[o][0]]=s)}}return r}},Qy=Jy([["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),ex={getLineStyle:function(e){var t=Qy(this,e),n=this.getLineDash(t.lineWidth);return n&&(t.lineDash=n),t},getLineDash:function(e){null==e&&(e=1);var t=this.get("type"),n=Math.max(e,2),i=4*e;return"solid"===t||null==t?null:"dashed"===t?[i,i]:[n,n]}},tx=Jy([["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]]),nx={getAreaStyle:function(e,t){return tx(this,e,t)}},ix=Math.pow,rx=Math.sqrt,ox=1e-8,ax=1e-4,sx=rx(3),lx=1/3,cx=E(),ux=E(),dx=E(),hx=Math.min,px=Math.max,fx=Math.sin,gx=Math.cos,mx=2*Math.PI,vx=E(),_x=E(),yx=E(),xx=[],bx=[],wx={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},Cx=[],Sx=[],Tx=[],Ax=[],Mx=Math.min,Ex=Math.max,Ix=Math.cos,Dx=Math.sin,kx=Math.sqrt,Lx=Math.abs,Nx="undefined"!=typeof Float32Array,Px=function(e){this._saveData=!e,this._saveData&&(this.data=[]),this._ctx=null};Px.prototype={constructor:Px,_xi:0,_yi:0,_x0:0,_y0:0,_ux:0,_uy:0,_len:0,_lineDash:null,_dashOffset:0,_dashIdx:0,_dashSum:0,setScale:function(e,t){this._ux=Lx(1/V_/e)||0,this._uy=Lx(1/V_/t)||0},getContext:function(){return this._ctx},beginPath:function(e){return this._ctx=e,e&&e.beginPath(),e&&(this.dpr=e.dpr),this._saveData&&(this._len=0),this._lineDash&&(this._lineDash=null,this._dashOffset=0),this},moveTo:function(e,t){return this.addData(wx.M,e,t),this._ctx&&this._ctx.moveTo(e,t),this._x0=e,this._y0=t,this._xi=e,this._yi=t,this},lineTo:function(e,t){var n=Lx(e-this._xi)>this._ux||Lx(t-this._yi)>this._uy||this._len<5;return this.addData(wx.L,e,t),this._ctx&&n&&(this._needsDash()?this._dashedLineTo(e,t):this._ctx.lineTo(e,t)),n&&(this._xi=e,this._yi=t),this},bezierCurveTo:function(e,t,n,i,r,o){return this.addData(wx.C,e,t,n,i,r,o),this._ctx&&(this._needsDash()?this._dashedBezierTo(e,t,n,i,r,o):this._ctx.bezierCurveTo(e,t,n,i,r,o)),this._xi=r,this._yi=o,this},quadraticCurveTo:function(e,t,n,i){return this.addData(wx.Q,e,t,n,i),this._ctx&&(this._needsDash()?this._dashedQuadraticTo(e,t,n,i):this._ctx.quadraticCurveTo(e,t,n,i)),this._xi=n,this._yi=i,this},arc:function(e,t,n,i,r,o){return this.addData(wx.A,e,t,n,n,i,r-i,0,o?0:1),this._ctx&&this._ctx.arc(e,t,n,i,r,o),this._xi=Ix(r)*n+e,this._yi=Dx(r)*n+e,this},arcTo:function(e,t,n,i,r){return this._ctx&&this._ctx.arcTo(e,t,n,i,r),this},rect:function(e,t,n,i){return this._ctx&&this._ctx.rect(e,t,n,i),this.addData(wx.R,e,t,n,i),this},closePath:function(){this.addData(wx.Z);var e=this._ctx,t=this._x0,n=this._y0;return e&&(this._needsDash()&&this._dashedLineTo(t,n),e.closePath()),this._xi=t,this._yi=n,this},fill:function(e){e&&e.fill(),this.toStatic()},stroke:function(e){e&&e.stroke(),this.toStatic()},setLineDash:function(e){if(e instanceof Array){this._lineDash=e,this._dashIdx=0;for(var t=0,n=0;n<e.length;n++)t+=e[n];this._dashSum=t}return this},setLineDashOffset:function(e){return this._dashOffset=e,this},len:function(){return this._len},setData:function(e){var t=e.length;this.data&&this.data.length==t||!Nx||(this.data=new Float32Array(t));for(var n=0;n<t;n++)this.data[n]=e[n];this._len=t},appendPath:function(e){e instanceof Array||(e=[e]);for(var t=e.length,n=0,i=this._len,r=0;r<t;r++)n+=e[r].len();for(Nx&&this.data instanceof Float32Array&&(this.data=new Float32Array(i+n)),r=0;r<t;r++)for(var o=e[r].data,a=0;a<o.length;a++)this.data[i++]=o[a];this._len=i},addData:function(e){if(this._saveData){var t=this.data;this._len+arguments.length>t.length&&(this._expandData(),t=this.data);for(var n=0;n<arguments.length;n++)t[this._len++]=arguments[n];this._prevCmd=e}},_expandData:function(){if(!(this.data instanceof Array)){for(var e=[],t=0;t<this._len;t++)e[t]=this.data[t];this.data=e}},_needsDash:function(){return this._lineDash},_dashedLineTo:function(e,t){var n,i,r=this._dashSum,o=this._dashOffset,a=this._lineDash,s=this._ctx,l=this._xi,c=this._yi,u=e-l,d=t-c,h=kx(u*u+d*d),p=l,f=c,g=a.length;for(u/=h,d/=h,o<0&&(o=r+o),p-=(o%=r)*u,f-=o*d;u>0&&p<=e||u<0&&p>=e||0==u&&(d>0&&f<=t||d<0&&f>=t);)p+=u*(n=a[i=this._dashIdx]),f+=d*n,this._dashIdx=(i+1)%g,u>0&&p<l||u<0&&p>l||d>0&&f<c||d<0&&f>c||s[i%2?"moveTo":"lineTo"](u>=0?Mx(p,e):Ex(p,e),d>=0?Mx(f,t):Ex(f,t));u=p-e,d=f-t,this._dashOffset=-kx(u*u+d*d)},_dashedBezierTo:function(e,t,n,i,r,o){var a,s,l,c,u,d=this._dashSum,h=this._dashOffset,p=this._lineDash,f=this._ctx,g=this._xi,m=this._yi,v=on,_=0,y=this._dashIdx,x=p.length,b=0;for(h<0&&(h=d+h),h%=d,a=0;a<1;a+=.1)s=v(g,e,n,r,a+.1)-v(g,e,n,r,a),l=v(m,t,i,o,a+.1)-v(m,t,i,o,a),_+=kx(s*s+l*l);for(;y<x&&!((b+=p[y])>h);y++);for(a=(b-h)/_;a<=1;)c=v(g,e,n,r,a),u=v(m,t,i,o,a),y%2?f.moveTo(c,u):f.lineTo(c,u),a+=p[y]/_,y=(y+1)%x;y%2!=0&&f.lineTo(r,o),s=r-c,l=o-u,this._dashOffset=-kx(s*s+l*l)},_dashedQuadraticTo:function(e,t,n,i){var r=n,o=i;n=(n+2*e)/3,i=(i+2*t)/3,e=(this._xi+2*e)/3,t=(this._yi+2*t)/3,this._dashedBezierTo(e,t,n,i,r,o)},toStatic:function(){var e=this.data;e instanceof Array&&(e.length=this._len,Nx&&(this.data=new Float32Array(e)))},getBoundingRect:function(){Cx[0]=Cx[1]=Tx[0]=Tx[1]=Number.MAX_VALUE,Sx[0]=Sx[1]=Ax[0]=Ax[1]=-Number.MAX_VALUE;for(var e=this.data,t=0,n=0,i=0,r=0,o=0;o<e.length;){var a=e[o++];switch(1==o&&(i=t=e[o],r=n=e[o+1]),a){case wx.M:t=i=e[o++],n=r=e[o++],Tx[0]=i,Tx[1]=r,Ax[0]=i,Ax[1]=r;break;case wx.L:vn(t,n,e[o],e[o+1],Tx,Ax),t=e[o++],n=e[o++];break;case wx.C:yn(t,n,e[o++],e[o++],e[o++],e[o++],e[o],e[o+1],Tx,Ax),t=e[o++],n=e[o++];break;case wx.Q:xn(t,n,e[o++],e[o++],e[o],e[o+1],Tx,Ax),t=e[o++],n=e[o++];break;case wx.A:var s=e[o++],l=e[o++],c=e[o++],u=e[o++],d=e[o++],h=e[o++]+d,p=(e[o++],1-e[o++]);1==o&&(i=Ix(d)*c+s,r=Dx(d)*u+l),_n(s,l,c,u,d,h,p,Tx,Ax),t=Ix(h)*c+s,n=Dx(h)*u+l;break;case wx.R:vn(i=t=e[o++],r=n=e[o++],i+e[o++],r+e[o++],Tx,Ax);break;case wx.Z:t=i,n=r}K(Cx,Cx,Tx),J(Sx,Sx,Ax)}return 0===o&&(Cx[0]=Cx[1]=Sx[0]=Sx[1]=0),new jt(Cx[0],Cx[1],Sx[0]-Cx[0],Sx[1]-Cx[1])},rebuildPath:function(e){for(var t,n,i,r,o,a,s=this.data,l=this._ux,c=this._uy,u=this._len,d=0;d<u;){var h=s[d++];switch(1==d&&(t=i=s[d],n=r=s[d+1]),h){case wx.M:t=i=s[d++],n=r=s[d++],e.moveTo(i,r);break;case wx.L:o=s[d++],a=s[d++],(Lx(o-i)>l||Lx(a-r)>c||d===u-1)&&(e.lineTo(o,a),i=o,r=a);break;case wx.C:e.bezierCurveTo(s[d++],s[d++],s[d++],s[d++],s[d++],s[d++]),i=s[d-2],r=s[d-1];break;case wx.Q:e.quadraticCurveTo(s[d++],s[d++],s[d++],s[d++]),i=s[d-2],r=s[d-1];break;case wx.A:var p=s[d++],f=s[d++],g=s[d++],m=s[d++],v=s[d++],_=s[d++],y=s[d++],x=s[d++],b=g>m?g:m,w=g>m?1:g/m,C=g>m?m/g:1,S=v+_;Math.abs(g-m)>.001?(e.translate(p,f),e.rotate(y),e.scale(w,C),e.arc(0,0,b,v,S,1-x),e.scale(1/w,1/C),e.rotate(-y),e.translate(-p,-f)):e.arc(p,f,b,v,S,1-x),1==d&&(t=Ix(v)*g+p,n=Dx(v)*m+f),i=Ix(S)*g+p,r=Dx(S)*m+f;break;case wx.R:t=i=s[d],n=r=s[d+1],e.rect(s[d++],s[d++],s[d++],s[d++]);break;case wx.Z:e.closePath(),i=t,r=n}}}},Px.CMD=wx;var Ox=2*Math.PI,Rx=2*Math.PI,zx=Px.CMD,Fx=2*Math.PI,Bx=1e-4,Hx=[-1,-1,-1],Vx=[-1,-1],Wx=ry.prototype.getCanvasPattern,Ux=Math.abs,$x=new Px(!0);Nn.prototype={constructor:Nn,type:"path",__dirtyPath:!0,strokeContainThreshold:5,brush:function(e,t){var n=this.style,i=this.path||$x,r=n.hasStroke(),o=n.hasFill(),a=n.fill,s=n.stroke,l=o&&!!a.colorStops,c=r&&!!s.colorStops,u=o&&!!a.image,d=r&&!!s.image;if(n.bind(e,this,t),this.setTransform(e),this.__dirty){var h;l&&(h=h||this.getBoundingRect(),this._fillGradient=n.getGradient(e,a,h)),c&&(h=h||this.getBoundingRect(),this._strokeGradient=n.getGradient(e,s,h))}l?e.fillStyle=this._fillGradient:u&&(e.fillStyle=Wx.call(a,e)),c?e.strokeStyle=this._strokeGradient:d&&(e.strokeStyle=Wx.call(s,e));var p=n.lineDash,f=n.lineDashOffset,g=!!e.setLineDash,m=this.getGlobalScale();i.setScale(m[0],m[1]),this.__dirtyPath||p&&!g&&r?(i.beginPath(e),p&&!g&&(i.setLineDash(p),i.setLineDashOffset(f)),this.buildPath(i,this.shape,!1),this.path&&(this.__dirtyPath=!1)):(e.beginPath(),this.path.rebuildPath(e)),o&&i.fill(e),p&&g&&(e.setLineDash(p),e.lineDashOffset=f),r&&i.stroke(e),p&&g&&e.setLineDash([]),this.restoreTransform(e),null!=n.text&&this.drawRectText(e,this.getBoundingRect())},buildPath:function(e,t,n){},createPathProxy:function(){this.path=new Px},getBoundingRect:function(){var e=this._rect,t=this.style,n=!e;if(n){var i=this.path;i||(i=this.path=new Px),this.__dirtyPath&&(i.beginPath(),this.buildPath(i,this.shape,!1)),e=i.getBoundingRect()}if(this._rect=e,t.hasStroke()){var r=this._rectWithStroke||(this._rectWithStroke=e.clone());if(this.__dirty||n){r.copy(e);var o=t.lineWidth,a=t.strokeNoScale?this.getLineScale():1;t.hasFill()||(o=Math.max(o,this.strokeContainThreshold||4)),a>1e-10&&(r.width+=o/a,r.height+=o/a,r.x-=o/a/2,r.y-=o/a/2)}return r}return e},contain:function(e,t){var n=this.transformCoordToLocal(e,t),i=this.getBoundingRect(),r=this.style;if(e=n[0],t=n[1],i.contain(e,t)){var o=this.path.data;if(r.hasStroke()){var a=r.lineWidth,s=r.strokeNoScale?this.getLineScale():1;if(s>1e-10&&(r.hasFill()||(a=Math.max(a,this.strokeContainThreshold)),zn(o,a/s,e,t)))return!0}if(r.hasFill())return On(o,e,t)}return!1},dirty:function(e){null==e&&(e=!0),e&&(this.__dirtyPath=e,this._rect=null),this.__dirty=!0,this.__zr&&this.__zr.refresh(),this.__clipTarget&&this.__clipTarget.dirty()},animateShape:function(e){return this.animate("shape",e)},attrKV:function(e,t){"shape"===e?(this.setShape(t),this.__dirtyPath=!0,this._rect=null):je.prototype.attrKV.call(this,e,t)},setShape:function(e,t){var n=this.shape;if(n){if(b(e))for(var i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);else n[e]=t;this.dirty(!0)}return this},getLineScale:function(){var e=this.transform;return e&&Ux(e[0]-1)>1e-10&&Ux(e[3]-1)>1e-10?Math.sqrt(Ux(e[0]*e[3]-e[2]*e[1])):1}},Nn.extend=function(e){var t=function(t){Nn.call(this,t),e.style&&this.style.extendFrom(e.style,!1);var n=e.shape;if(n){this.shape=this.shape||{};var i=this.shape;for(var r in n)!i.hasOwnProperty(r)&&n.hasOwnProperty(r)&&(i[r]=n[r])}e.init&&e.init.call(this,t)};h(t,Nn);for(var n in e)"style"!==n&&"shape"!==n&&(t.prototype[n]=e[n]);return t},h(Nn,je);var Gx=Px.CMD,qx=[[],[],[]],jx=Math.sqrt,Yx=Math.atan2,Xx=function(e,t){var n,i,r,o,a,s,l=e.data,c=Gx.M,u=Gx.C,d=Gx.L,h=Gx.R,p=Gx.A,f=Gx.Q;for(r=0,o=0;r<l.length;){switch(n=l[r++],o=r,i=0,n){case c:case d:i=1;break;case u:i=3;break;case f:i=2;break;case p:var g=t[4],m=t[5],v=jx(t[0]*t[0]+t[1]*t[1]),_=jx(t[2]*t[2]+t[3]*t[3]),y=Yx(-t[1]/_,t[0]/v);l[r]*=v,l[r++]+=g,l[r]*=_,l[r++]+=m,l[r++]*=v,l[r++]*=_,l[r++]+=y,l[r++]+=y,o=r+=2;break;case h:s[0]=l[r++],s[1]=l[r++],$(s,s,t),l[o++]=s[0],l[o++]=s[1],s[0]+=l[r++],s[1]+=l[r++],$(s,s,t),l[o++]=s[0],l[o++]=s[1]}for(a=0;a<i;a++)(s=qx[a])[0]=l[r++],s[1]=l[r++],$(s,s,t),l[o++]=s[0],l[o++]=s[1]}},Zx=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"],Kx=Math.sqrt,Jx=Math.sin,Qx=Math.cos,eb=Math.PI,tb=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])},nb=function(e,t){return(e[0]*t[0]+e[1]*t[1])/(tb(e)*tb(t))},ib=function(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(nb(e,t))},rb=function(e){je.call(this,e)};rb.prototype={constructor:rb,type:"text",brush:function(e,t){var n=this.style;this.__dirty&&De(n),n.fill=n.stroke=n.shadowBlur=n.shadowColor=n.shadowOffsetX=n.shadowOffsetY=null;var i=n.text;null!=i&&(i+=""),n.bind(e,this,t),Xe(i,n)&&(this.setTransform(e),ke(this,e,i,n),this.restoreTransform(e))},getBoundingRect:function(){var e=this.style;if(this.__dirty&&De(e),!this._rect){var t=e.text;null!=t?t+="":t="";var n=de(e.text+"",e.font,e.textAlign,e.textVerticalAlign,e.textPadding,e.rich);if(n.x+=e.x||0,n.y+=e.y||0,He(e.textStroke,e.textStrokeWidth)){var i=e.textStrokeWidth;n.x-=i/2,n.y-=i/2,n.width+=i,n.height+=i}this._rect=n}return this._rect}},h(rb,je);var ob=Nn.extend({type:"circle",shape:{cx:0,cy:0,r:0},buildPath:function(e,t,n){n&&e.moveTo(t.cx+t.r,t.cy),e.arc(t.cx,t.cy,t.r,0,2*Math.PI,!0)}}),ab=[["shadowBlur",0],["shadowColor","#000"],["shadowOffsetX",0],["shadowOffsetY",0]],sb=function(e){return jv.browser.ie&&jv.browser.version>=11?function(){var t,n=this.__clipPaths,i=this.style;if(n)for(var r=0;r<n.length;r++){var o=n[r],a=o&&o.shape,s=o&&o.type;if(a&&("sector"===s&&a.startAngle===a.endAngle||"rect"===s&&(!a.width||!a.height))){for(l=0;l<ab.length;l++)ab[l][2]=i[ab[l][0]],i[ab[l][0]]=ab[l][1];t=!0;break}}if(e.apply(this,arguments),t)for(var l=0;l<ab.length;l++)i[ab[l][0]]=ab[l][2]}:e},lb=Nn.extend({type:"sector",shape:{cx:0,cy:0,r0:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},brush:sb(Nn.prototype.brush),buildPath:function(e,t){var n=t.cx,i=t.cy,r=Math.max(t.r0||0,0),o=Math.max(t.r,0),a=t.startAngle,s=t.endAngle,l=t.clockwise,c=Math.cos(a),u=Math.sin(a);e.moveTo(c*r+n,u*r+i),e.lineTo(c*o+n,u*o+i),e.arc(n,i,o,a,s,!l),e.lineTo(Math.cos(s)*r+n,Math.sin(s)*r+i),0!==r&&e.arc(n,i,r,s,a,l),e.closePath()}}),cb=Nn.extend({type:"ring",shape:{cx:0,cy:0,r:0,r0:0},buildPath:function(e,t){var n=t.cx,i=t.cy,r=2*Math.PI;e.moveTo(n+t.r,i),e.arc(n,i,t.r,0,r,!1),e.moveTo(n+t.r0,i),e.arc(n,i,t.r0,0,r,!0)}}),ub=function(e,t){for(var n=e.length,i=[],r=0,o=1;o<n;o++)r+=j(e[o-1],e[o]);var a=r/2;for(a=a<n?n:a,o=0;o<a;o++){var s,l,c,u=o/(a-1)*(t?n:n-1),d=Math.floor(u),h=u-d,p=e[d%n];t?(s=e[(d-1+n)%n],l=e[(d+1)%n],c=e[(d+2)%n]):(s=e[0===d?d:d-1],l=e[d>n-2?n-1:d+1],c=e[d>n-3?n-1:d+2]);var f=h*h,g=h*f;i.push([Wn(s[0],p[0],l[0],c[0],h,f,g),Wn(s[1],p[1],l[1],c[1],h,f,g)])}return i},db=function(e,t,n,i){var r,o,a,s,l=[],c=[],u=[],d=[];if(i){a=[1/0,1/0],s=[-1/0,-1/0];for(var h=0,p=e.length;h<p;h++)K(a,a,e[h]),J(s,s,e[h]);K(a,a,i[0]),J(s,s,i[1])}for(var h=0,p=e.length;h<p;h++){var f=e[h];if(n)r=e[h?h-1:p-1],o=e[(h+1)%p];else{if(0===h||h===p-1){l.push(V(e[h]));continue}r=e[h-1],o=e[h+1]}H(c,o,r),U(c,c,t);var g=j(f,r),m=j(f,o),v=g+m;0!==v&&(g/=v,m/=v),U(u,c,-g),U(d,c,m);var _=G([],f,u),y=G([],f,d);i&&(J(_,_,a),K(_,_,s),J(y,y,a),K(y,y,s)),l.push(_),l.push(y)}return n&&l.push(l.shift()),l},hb=Nn.extend({type:"polygon",shape:{points:null,smooth:!1,smoothConstraint:null},buildPath:function(e,t){Hn(e,t,!0)}}),pb=Nn.extend({type:"polyline",shape:{points:null,smooth:!1,smoothConstraint:null},style:{stroke:"#000",fill:null},buildPath:function(e,t){Hn(e,t,!1)}}),fb=Nn.extend({type:"rect",shape:{r:0,x:0,y:0,width:0,height:0},buildPath:function(e,t){var n=t.x,i=t.y,r=t.width,o=t.height;t.r?Ce(e,t):e.rect(n,i,r,o),e.closePath()}}),gb=Nn.extend({type:"line",shape:{x1:0,y1:0,x2:0,y2:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(e,t){var n=t.x1,i=t.y1,r=t.x2,o=t.y2,a=t.percent;0!==a&&(e.moveTo(n,i),a<1&&(r=n*(1-a)+r*a,o=i*(1-a)+o*a),e.lineTo(r,o))},pointAt:function(e){var t=this.shape;return[t.x1*(1-e)+t.x2*e,t.y1*(1-e)+t.y2*e]}}),mb=[],vb=Nn.extend({type:"bezier-curve",shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(e,t){var n=t.x1,i=t.y1,r=t.x2,o=t.y2,a=t.cpx1,s=t.cpy1,l=t.cpx2,c=t.cpy2,u=t.percent;0!==u&&(e.moveTo(n,i),null==l||null==c?(u<1&&(pn(n,a,r,u,mb),a=mb[1],r=mb[2],pn(i,s,o,u,mb),s=mb[1],o=mb[2]),e.quadraticCurveTo(a,s,r,o)):(u<1&&(ln(n,a,l,r,u,mb),a=mb[1],l=mb[2],r=mb[3],ln(i,s,c,o,u,mb),s=mb[1],c=mb[2],o=mb[3]),e.bezierCurveTo(a,s,l,c,r,o)))},pointAt:function(e){return Fn(this.shape,e,!1)},tangentAt:function(e){var t=Fn(this.shape,e,!0);return X(t,t)}}),_b=Nn.extend({type:"arc",shape:{cx:0,cy:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},style:{stroke:"#000",fill:null},buildPath:function(e,t){var n=t.cx,i=t.cy,r=Math.max(t.r,0),o=t.startAngle,a=t.endAngle,s=t.clockwise,l=Math.cos(o),c=Math.sin(o);e.moveTo(l*r+n,c*r+i),e.arc(n,i,r,o,a,!s)}}),yb=Nn.extend({type:"compound",shape:{paths:null},_updatePathDirty:function(){for(var e=this.__dirtyPath,t=this.shape.paths,n=0;n<t.length;n++)e=e||t[n].__dirtyPath;this.__dirtyPath=e,this.__dirty=this.__dirty||e},beforeBrush:function(){this._updatePathDirty();for(var e=this.shape.paths||[],t=this.getGlobalScale(),n=0;n<e.length;n++)e[n].path||e[n].createPathProxy(),e[n].path.setScale(t[0],t[1])},buildPath:function(e,t){for(var n=t.paths||[],i=0;i<n.length;i++)n[i].buildPath(e,n[i].shape,!0)},afterBrush:function(){for(var e=this.shape.paths||[],t=0;t<e.length;t++)e[t].__dirtyPath=!1},getBoundingRect:function(){return this._updatePathDirty(),Nn.prototype.getBoundingRect.call(this)}}),xb=function(e){this.colorStops=e||[]};xb.prototype={constructor:xb,addColorStop:function(e,t){this.colorStops.push({offset:e,color:t})}};var bb=function(e,t,n,i,r,o){this.x=null==e?0:e,this.y=null==t?0:t,this.x2=null==n?1:n,this.y2=null==i?0:i,this.type="linear",this.global=o||!1,xb.call(this,r)};bb.prototype={constructor:bb},h(bb,xb);var wb=function(e,t,n,i,r){this.x=null==e?.5:e,this.y=null==t?.5:t,this.r=null==n?.5:n,this.type="radial",this.global=r||!1,xb.call(this,i)};wb.prototype={constructor:wb},h(wb,xb);var Cb=Math.round,Sb=Math.max,Tb=Math.min,Ab={},Mb=function(e,t){for(var n=[],i=e.length,r=0;r<i;r++){var o=e[r];o.path||o.createPathProxy(),o.__dirtyPath&&o.buildPath(o.path,o.shape,!0),n.push(o.path)}var a=new Nn(t);return a.createPathProxy(),a.buildPath=function(e){e.appendPath(n);var t=e.getContext();t&&e.rebuildPath(t)},a},Eb=(Object.freeze||Object)({extendShape:Zn,extendPath:function(e,t){return Gn(e,t)},makePath:Un,makeImage:Xn,mergePath:Mb,resizePath:qn,subPixelOptimizeLine:Yn,subPixelOptimizeRect:$n,subPixelOptimize:Kn,setHoverStyle:uo,setLabelStyle:co,setTextStyle:fo,setText:function(e,t,n){var i,r={isRectText:!0};!1===n?i=!0:r.autoColor=n,po(e,t,r,i),e.host&&e.host.dirty&&e.host.dirty(!1)},getFont:_o,updateProps:wo,initProps:So,getTransform:Mo,applyTransform:Io,transformDirection:To,groupTransition:Ao,clipPointsByRect:Co,clipRectByRect:function(e,t){var n=Sb(e.x,t.x),i=Tb(e.x+e.width,t.x+t.width),r=Sb(e.y,t.y),o=Tb(e.y+e.height,t.y+t.height);if(i>=n&&o>=r)return{x:n,y:r,width:i-n,height:o-r}},createIcon:Do,Group:X_,Image:qe,Text:rb,Circle:ob,Sector:lb,Ring:cb,Polygon:hb,Polyline:pb,Rect:fb,Line:gb,BezierCurve:vb,Arc:_b,CompoundPath:yb,LinearGradient:bb,RadialGradient:wb,BoundingRect:jt}),Ib=["textStyle","color"],Db={getTextColor:function(e){var t=this.ecModel;return this.getShallow("color")||(!e&&t?t.get(Ib):null)},getFont:function(){return _o({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},getTextRect:function(e){return de(e,this.getFont(),this.getShallow("align"),this.getShallow("verticalAlign")||this.getShallow("baseline"),this.getShallow("padding"),this.getShallow("rich"),this.getShallow("truncateText"))}},kb=Jy([["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["textPosition"],["textAlign"]]),Lb={getItemStyle:function(e,t){var n=kb(this,e,t),i=this.getBorderLineDash();return i&&(n.lineDash=i),n},getBorderLineDash:function(){var e=this.get("borderType");return"solid"===e||null==e?null:"dashed"===e?[5,5]:[1,1]}},Nb=u;Lo.prototype={constructor:Lo,init:null,mergeOption:function(e){n(this.option,e,!0)},get:function(e,t){return null==e?this.option:ko(this.option,this.parsePath(e),!t&&Po(this,e))},getShallow:function(e,t){var n=this.option,i=null==n?n:n[e],r=!t&&Po(this,e);return null==i&&r&&(i=r.getShallow(e)),i},getModel:function(e,t){var n,i=null==e?this.option:ko(this.option,e=this.parsePath(e));return t=t||(n=Po(this,e))&&n.getModel(e),new Lo(i,t,this.ecModel)},isEmpty:function(){return null==this.option},restoreData:function(){},clone:function(){return new(0,this.constructor)(i(this.option))},setReadOnly:function(e){},parsePath:function(e){return"string"==typeof e&&(e=e.split(".")),e},customizeGetParent:function(e){Xi(this,"getParent",e)},isAnimationEnabled:function(){if(!jv.node){if(null!=this.option.animation)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}}},Ki(Lo),Nb(Lo,ex),Nb(Lo,nx),Nb(Lo,Db),Nb(Lo,Lb);var Pb=d,Ob=b,Rb=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"],zb={getDataParams:function(e,t){var n=this.getData(t),i=this.getRawValue(e,t),r=n.getRawIndex(e),o=n.getName(e,!0),a=n.getRawDataItem(e),s=n.getItemVisual(e,"color");return{componentType:this.mainType,componentSubType:this.subType,seriesType:"series"===this.mainType?this.subType:null,seriesIndex:this.seriesIndex,seriesId:this.id,seriesName:this.name,name:o,dataIndex:r,data:a,dataType:t,value:i,color:s,marker:Fi(s),$vars:["seriesName","name","value"]}},getFormattedLabel:function(e,t,n,i,r){t=t||"normal";var o=this.getData(n).getItemModel(e),a=this.getDataParams(e,n);null!=i&&a.value instanceof Array&&(a.value=a.value[i]);var s=o.get([r||"label",t,"formatter"]);return"function"==typeof s?(a.status=t,s(a)):"string"==typeof s?Wi(s,a):void 0},getRawValue:function(e,t){var n=this.getData(t).getRawDataItem(e);if(null!=n)return!Ob(n)||n instanceof Array?n:n.value},formatTooltip:N},Fb=function(){var e=0;return function(){var t="\0__ec_prop_getter_"+e++;return function(e){return e[t]||(e[t]={})}}}(),Bb=0,Hb="_",Vb=d,Wb=["left","right","top","bottom","width","height"],Ub=[["width","left","right"],["height","top","bottom"]],$b=Yo,Gb=(v(Yo,"vertical"),v(Yo,"horizontal"),{getBoxLayoutParams:function(){return{left:this.get("left"),top:this.get("top"),right:this.get("right"),bottom:this.get("bottom"),width:this.get("width"),height:this.get("height")}}}),qb=Array.prototype.push,jb=Lo.extend({type:"component",id:"",name:"",mainType:"",subType:"",componentIndex:0,defaultOption:null,ecModel:null,dependentModels:[],uid:null,layoutMode:null,$constructor:function(e,t,n,i){Lo.call(this,e,t,n,i),this.uid=qo("componentModel")},init:function(e,t,n,i){this.mergeDefaultAndTheme(e,n)},mergeDefaultAndTheme:function(e,t){var i=this.layoutMode,r=i?ea(e):{};n(e,t.getTheme().get(this.mainType)),n(e,this.getDefaultOption()),i&&ta(e,r,i)},mergeOption:function(e,t){n(this.option,e,!0);var i=this.layoutMode;i&&ta(this.option,e,i)},optionUpdated:function(e,t){},getDefaultOption:function(){if(!qi(this,"__defaultOption")){for(var e=[],t=this.constructor;t;){var i=t.prototype.defaultOption;i&&e.push(i),t=t.superClass}for(var r={},o=e.length-1;o>=0;o--)r=n(r,e[o],!0);Xi(this,"__defaultOption",r)}return ji(this,"__defaultOption")},getReferringComponents:function(e){return this.ecModel.queryComponents({mainType:e,index:this.get(e+"Index",!0),id:this.get(e+"Id",!0)})}});tn(jb,{registerWhenExtend:!0}),function(e){var t={};e.registerSubTypeDefaulter=function(e,n){e=Yi(e),t[e.main]=n},e.determineSubType=function(n,i){var r=i.type;if(!r){var o=Yi(n).main;e.hasSubTypes(n)&&t[o]&&(r=t[o](i))}return r}}(jb),function(e,t){function i(e){var i={},r=[];return d(e,function(a){var s=n(i,a),c=o(s.originalDeps=t(a),e);s.entryCount=c.length,0===s.entryCount&&r.push(a),d(c,function(e){l(s.predecessor,e)<0&&s.predecessor.push(e);var t=n(i,e);l(t.successor,e)<0&&t.successor.push(a)})}),{graph:i,noEntryList:r}}function n(e,t){return e[t]||(e[t]={predecessor:[],successor:[]}),e[t]}function o(e,t){var n=[];return d(e,function(e){l(t,e)>=0&&n.push(e)}),n}e.topologicalTravel=function(e,t,n,r){function a(e){0===--s[e].entryCount&&l.push(e)}if(e.length){var o=i(t),s=o.graph,l=o.noEntryList,c={};for(d(e,function(e){c[e]=!0});l.length;){var u=l.pop(),h=s[u],p=!!c[u];p&&(n.call(r,u,h.originalDeps.slice()),delete c[u]),d(h.successor,p?function(e){c[e]=!0,a(e)}:a)}d(c,function(){throw new Error("Circle dependency may exists")})}}}(jb,function(e){var t=[];return d(jb.getClassesByMainType(e),function(e){qb.apply(t,e.prototype.dependencies||[])}),f(t,function(e){return Yi(e).main})}),u(jb,Gb);var Yb="";"undefined"!=typeof navigator&&(Yb=navigator.platform||"");var Xb={color:["#c23531","#2f4554","#61a0a8","#d48265","#91c7ae","#749f83","#ca8622","#bda29a","#6e7074","#546570","#c4ccd3"],textStyle:{fontFamily:Yb.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,animation:"auto",animationDuration:1e3,animationDurationUpdate:300,animationEasing:"exponentialOut",animationEasingUpdate:"cubicOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1},Zb={clearColorPalette:function(){Xi(this,"colorIdx",0),Xi(this,"colorNameMap",{})},getColorFromPalette:function(e,t){var n=ji(t=t||this,"colorIdx")||0,i=ji(t,"colorNameMap")||Xi(t,"colorNameMap",{});if(i.hasOwnProperty(e))return i[e];var r=this.get("color",!0)||[];if(r.length){var o=r[n];return e&&(i[e]=o),Xi(t,"colorIdx",(n+1)%r.length),o}}},Kb=d,Jb=g,Qb=f,ew=y,tw=l,nw=b,iw="\0_ec_inner",rw=Lo.extend({constructor:rw,init:function(e,t,n,i){n=n||{},this.option=null,this._theme=new Lo(n),this._optionManager=i},setOption:function(e,t){L(!(iw in e),"please use chart.getOption()"),this._optionManager.setOption(e,t),this.resetOption(null)},resetOption:function(e){var t=!1,n=this._optionManager;if(!e||"recreate"===e){var i=n.mountOption("recreate"===e);this.option&&"recreate"!==e?(this.restoreData(),this.mergeOption(i)):oa.call(this,i),t=!0}if("timeline"!==e&&"media"!==e||this.restoreData(),!e||"recreate"===e||"timeline"===e){var r=n.getTimelineOption(this);r&&(this.mergeOption(r),t=!0)}if(!e||"recreate"===e||"media"===e){var o=n.getMediaOption(this,this._api);o.length&&Kb(o,function(e){this.mergeOption(e,t=!0)},this)}return t},mergeOption:function(e){var t=this.option,r=this._componentsMap,o=[];Kb(e,function(e,r){null!=e&&(jb.hasClass(r)?o.push(r):t[r]=null==t[r]?i(e):n(t[r],e,!0))}),jb.topologicalTravel(o,jb.getAllClassMainTypes(),function(n,i){var o=Oo(e[n]),s=Vo(r.get(n),o);Bo(s),Kb(s,function(e,t){var i=e.option;nw(i)&&(e.keyInfo.mainType=n,e.keyInfo.subType=ra(n,i,e.exist))});var l=aa(r,i);t[n]=[],r.set(n,[]),Kb(s,function(e,i){var o=e.exist,s=e.option;if(L(nw(s)||o,"Empty component definition"),s){var c=jb.getClass(n,e.keyInfo.subType,!0);if(o&&o instanceof c)o.name=e.keyInfo.name,o.mergeOption(s,this),o.optionUpdated(s,!1);else{var u=a({dependentModels:l,componentIndex:i},e.keyInfo);a(o=new c(s,this,this,u),u),o.init(s,this,this,u),o.optionUpdated(null,!0)}}else o.mergeOption({},this),o.optionUpdated({},!1);r.get(n)[i]=o,t[n][i]=o.option},this),"series"===n&&(this._seriesIndices=sa(r.get("series")))},this),this._seriesIndices=this._seriesIndices||[]},getOption:function(){var e=i(this.option);return Kb(e,function(t,n){if(jb.hasClass(n)){for(var i=(t=Oo(t)).length-1;i>=0;i--)Go(t[i])&&t.splice(i,1);e[n]=t}}),delete e[iw],e},getTheme:function(){return this._theme},getComponent:function(e,t){var n=this._componentsMap.get(e);if(n)return n[t||0]},queryComponents:function(e){var t=e.mainType;if(!t)return[];var n=e.index,i=e.id,r=e.name,o=this._componentsMap.get(t);if(!o||!o.length)return[];var a;if(null!=n)ew(n)||(n=[n]),a=Jb(Qb(n,function(e){return o[e]}),function(e){return!!e});else if(null!=i){var s=ew(i);a=Jb(o,function(e){return s&&tw(i,e.id)>=0||!s&&e.id===i})}else if(null!=r){var l=ew(r);a=Jb(o,function(e){return l&&tw(r,e.name)>=0||!l&&e.name===r})}else a=o.slice();return la(a,e)},findComponents:function(e){var t=e.query,n=e.mainType,i=function(e){var t=n+"Index",i=n+"Id",r=n+"Name";return!e||null==e[t]&&null==e[i]&&null==e[r]?null:{mainType:n,index:e[t],id:e[i],name:e[r]}}(t);return function(t){return e.filter?Jb(t,e.filter):t}(la(i?this.queryComponents(i):this._componentsMap.get(n),e))},eachComponent:function(e,t,n){var i=this._componentsMap;if("function"==typeof e)n=t,t=e,i.each(function(e,i){Kb(e,function(e,r){t.call(n,i,e,r)})});else if(_(e))Kb(i.get(e),t,n);else if(nw(e)){var r=this.findComponents(e);Kb(r,t,n)}},getSeriesByName:function(e){var t=this._componentsMap.get("series");return Jb(t,function(t){return t.name===e})},getSeriesByIndex:function(e){return this._componentsMap.get("series")[e]},getSeriesByType:function(e){var t=this._componentsMap.get("series");return Jb(t,function(t){return t.subType===e})},getSeries:function(){return this._componentsMap.get("series").slice()},eachSeries:function(e,t){Kb(this._seriesIndices,function(n){var i=this._componentsMap.get("series")[n];e.call(t,i,n)},this)},eachRawSeries:function(e,t){Kb(this._componentsMap.get("series"),e,t)},eachSeriesByType:function(e,t,n){Kb(this._seriesIndices,function(i){var r=this._componentsMap.get("series")[i];r.subType===e&&t.call(n,r,i)},this)},eachRawSeriesByType:function(e,t,n){return Kb(this.getSeriesByType(e),t,n)},isSeriesFiltered:function(e){return l(this._seriesIndices,e.componentIndex)<0},getCurrentSeriesIndices:function(){return(this._seriesIndices||[]).slice()},filterSeries:function(e,t){var n=Jb(this._componentsMap.get("series"),e,t);this._seriesIndices=sa(n)},restoreData:function(){var e=this._componentsMap;this._seriesIndices=sa(e.get("series"));var t=[];e.each(function(e,n){t.push(n)}),jb.topologicalTravel(t,jb.getAllClassMainTypes(),function(t,n){Kb(e.get(t),function(e){e.restoreData()})})}});u(rw,Zb);var ow=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isDisposed","on","off","getDataURL","getConnectedDataURL","getModel","getOption","getViewOfComponentModel","getViewOfSeriesModel"],aw={};ua.prototype={constructor:ua,create:function(e,t){var n=[];d(aw,function(i,r){var o=i.create(e,t);n=n.concat(o||[])}),this._coordinateSystems=n},update:function(e,t){d(this._coordinateSystems,function(n){n.update&&n.update(e,t)})},getCoordinateSystems:function(){return this._coordinateSystems.slice()}},ua.register=function(e,t){aw[e]=t},ua.get=function(e){return aw[e]};var sw=d,lw=i,cw=f,uw=n,dw=/^(min|max)?(.+)$/;ca.prototype={constructor:ca,setOption:function(e,t){e=lw(e,!0);var n=this._optionBackup,i=da.call(this,e,t,!n);this._newBaseOption=i.baseOption,n?(ma(n.baseOption,i.baseOption),i.timelineOptions.length&&(n.timelineOptions=i.timelineOptions),i.mediaList.length&&(n.mediaList=i.mediaList),i.mediaDefault&&(n.mediaDefault=i.mediaDefault)):this._optionBackup=i},mountOption:function(e){var t=this._optionBackup;return this._timelineOptions=cw(t.timelineOptions,lw),this._mediaList=cw(t.mediaList,lw),this._mediaDefault=lw(t.mediaDefault),this._currentMediaIndices=[],lw(e?t.baseOption:this._newBaseOption)},getTimelineOption:function(e){var t,n=this._timelineOptions;if(n.length){var i=e.getComponent("timeline");i&&(t=lw(n[i.getCurrentIndex()],!0))}return t},getMediaOption:function(e){var t=this._api.getWidth(),n=this._api.getHeight(),i=this._mediaList,r=this._mediaDefault,o=[],a=[];if(!i.length&&!r)return a;for(var s=0,l=i.length;s<l;s++)fa(i[s].query,t,n)&&o.push(s);return!o.length&&r&&(o=[-1]),o.length&&!ga(o,this._currentMediaIndices)&&(a=cw(o,function(e){return lw(-1===e?r.option:i[e].option)})),this._currentMediaIndices=o,a}};var hw=d,pw=b,fw=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"],gw=function(e,t){hw(ba(e.series),function(e){pw(e)&&_a(e)});var n=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];t&&n.push("valueAxis","categoryAxis","logAxis","timeAxis"),hw(n,function(t){hw(ba(e[t]),function(e){e&&(ya(e,"axisLabel"),ya(e.axisPointer,"label"))})}),hw(ba(e.parallel),function(e){var t=e&&e.parallelAxisDefault;ya(t,"axisLabel"),ya(t&&t.axisPointer,"label")}),hw(ba(e.calendar),function(e){ya(e,"dayLabel"),ya(e,"monthLabel"),ya(e,"yearLabel")}),hw(ba(e.radar),function(e){ya(e,"name")}),hw(ba(e.geo),function(e){pw(e)&&(xa(e.label),hw(ba(e.regions),function(e){xa(e.label)}))}),xa(wa(e.timeline).label),ya(wa(e.axisPointer),"label"),ya(wa(e.tooltip).axisPointer,"label")},mw=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],vw=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],_w=["bar","boxplot","candlestick","chord","effectScatter","funnel","gauge","lines","graph","heatmap","line","map","parallel","pie","radar","sankey","scatter","treemap"],yw=function(e,t){gw(e,t),e.series=Oo(e.series),d(e.series,function(e){if(b(e)){var t=e.type;if("pie"!==t&&"gauge"!==t||null!=e.clockWise&&(e.clockwise=e.clockWise),"gauge"===t){var n=Sa(e,"pointer.color");null!=n&&Ma(e,"itemStyle.normal.color",n)}for(var i=0;i<_w.length;i++)if(_w[i]===e.type){Ia(e);break}}}),e.dataRange&&(e.visualMap=e.dataRange),d(vw,function(t){var n=e[t];n&&(y(n)||(n=[n]),d(n,function(e){Ia(e)}))})},xw=jb.extend({type:"series.__base__",seriesIndex:0,coordinateSystem:null,defaultOption:null,legendDataProvider:null,visualColorAccessPath:"itemStyle.normal.color",layoutMode:null,init:function(e,t,n,i){this.seriesIndex=this.componentIndex,this.mergeDefaultAndTheme(e,n),Xi(this,"dataBeforeProcessed",this.getInitialData(e,n)),this.restoreData()},mergeDefaultAndTheme:function(e,t){var i=this.layoutMode,r=i?ea(e):{},o=this.subType;jb.hasClass(o)&&(o+="Series"),n(e,t.getTheme().get(this.subType)),n(e,this.getDefaultOption()),zo(e.label,["show"]),this.fillDataTextStyle(e.data),i&&ta(e,r,i)},mergeOption:function(e,t){e=n(this.option,e,!0),this.fillDataTextStyle(e.data);var i=this.layoutMode;i&&ta(this.option,e,i);var r=this.getInitialData(e,t);r&&(Xi(this,"data",r),Xi(this,"dataBeforeProcessed",r.cloneShallow()))},fillDataTextStyle:function(e){if(e)for(var t=["show"],n=0;n<e.length;n++)e[n]&&e[n].label&&zo(e[n].label,t)},getInitialData:function(){},getData:function(e){var t=ji(this,"data");return null==e?t:t.getLinkedData(e)},setData:function(e){Xi(this,"data",e)},getRawData:function(){return ji(this,"dataBeforeProcessed")},coordDimToDataDim:function(e){return Uo(this.getData(),e)},dataDimToCoordDim:function(e){return Zo(this.getData(),e)},getBaseAxis:function(){var e=this.coordinateSystem;return e&&e.getBaseAxis&&e.getBaseAxis()},formatTooltip:function(e,t,n){var i=ji(this,"data"),r=this.getRawValue(e),a=y(r)?function(n){function o(e,n){var o=i.getDimensionInfo(n);if(o&&!1!==o.otherDims.tooltip){var s=o.type,l=(r?"- "+(o.tooltipName||o.name)+": ":"")+("ordinal"===s?e+"":"time"===s?t?"":Zi("yyyy/MM/dd hh:mm:ss",e):Vi(e));l&&a.push(Gi(l))}}var r=p(n,function(e,t,n){var r=i.getDimensionInfo(n);return e|=r&&!1!==r.tooltip&&null!=r.tooltipName},0),a=[],s=Xo(i,"tooltip");return s.length?d(s,function(t){o(i.get(t,e),t)}):d(n,o),(r?"<br/>":"")+a.join(r?"<br/>":", ")}(r):Gi(Vi(r)),s=i.getName(e),l=i.getItemVisual(e,"color");b(l)&&l.colorStops&&(l=(l.colorStops[0]||{}).color);var c=Fi(l=l||"transparent"),u=this.name;return"\0-"===u&&(u=""),u=u?Gi(u)+(t?": ":"<br/>"):"",t?c+u+a:u+c+(s?Gi(s)+": "+a:a)},isAnimationEnabled:function(){if(jv.node)return!1;var e=this.getShallow("animation");return e&&this.getData().count()>this.getShallow("animationThreshold")&&(e=!1),e},restoreData:function(){Xi(this,"data",ji(this,"dataBeforeProcessed").cloneShallow())},getColorFromPalette:function(e,t){var n=this.ecModel,i=Zb.getColorFromPalette.call(this,e,t);return i||(i=n.getColorFromPalette(e,t)),i},getAxisTooltipData:null,getTooltipPosition:null});u(xw,zb),u(xw,Zb);var bw=function(){this.group=new X_,this.uid=qo("viewComponent")};bw.prototype={constructor:bw,init:function(e,t){},render:function(e,t,n,i){},dispose:function(){}};var ww=bw.prototype;ww.updateView=ww.updateLayout=ww.updateVisual=function(e,t,n,i){},Ki(bw),tn(bw,{registerWhenExtend:!0}),Ta.prototype={type:"chart",init:function(e,t){},render:function(e,t,n,i){},highlight:function(e,t,n,i){Ca(e.getData(),i,"emphasis")},downplay:function(e,t,n,i){Ca(e.getData(),i,"normal")},remove:function(e,t){this.group.removeAll()},dispose:function(){}};var Cw=Ta.prototype;Cw.updateView=Cw.updateLayout=Cw.updateVisual=function(e,t,n,i){this.render(e,t,n,i)},Ki(Ta),tn(Ta,{registerWhenExtend:!0});var Sw="\0__throttleOriginMethod",Tw="\0__throttleRate",Aw="\0__throttleType",Mw=Math.PI,Ew=d,Iw=jb.parseClassType,Dw={zrender:"3.7.4"},kw=1e3,Lw=1e3,Nw=3e3,Pw={PROCESSOR:{FILTER:kw,STATISTIC:5e3},VISUAL:{LAYOUT:Lw,GLOBAL:2e3,CHART:Nw,COMPONENT:4e3,BRUSH:5e3}},Ow="__flagInMainProcess",Rw="__optionUpdated",zw=/^[a-zA-Z0-9_]+$/;Oa.prototype.on=Pa("on"),Oa.prototype.off=Pa("off"),Oa.prototype.one=Pa("one"),u(Oa,g_);var Fw=za.prototype;Fw._onframe=function(){if(this[Rw]){var e=this[Rw].silent;this[Ow]=!0,Bw.prepareAndUpdate.call(this),this[Ow]=!1,this[Rw]=!1,Va.call(this,e),Ba.call(this,e)}},Fw.getDom=function(){return this._dom},Fw.getZr=function(){return this._zr},Fw.setOption=function(e,t,n){var i;if(b(t)&&(n=t.lazyUpdate,i=t.silent,t=t.notMerge),this[Ow]=!0,!this._model||t){var r=new ca(this._api),o=this._theme;(this._model=new rw(null,null,o,r)).init(null,null,o,r)}this._model.setOption(e,$w),n?(this[Rw]={silent:i},this[Ow]=!1):(Bw.prepareAndUpdate.call(this),this._zr.flush(),this[Rw]=!1,this[Ow]=!1,Va.call(this,i),Ba.call(this,i))},Fw.setTheme=function(){},Fw.getModel=function(){return this._model},Fw.getOption=function(){return this._model&&this._model.getOption()},Fw.getWidth=function(){return this._zr.getWidth()},Fw.getHeight=function(){return this._zr.getHeight()},Fw.getDevicePixelRatio=function(){return this._zr.painter.dpr||window.devicePixelRatio||1},Fw.getRenderedCanvas=function(e){if(jv.canvasSupported){(e=e||{}).pixelRatio=e.pixelRatio||1,e.backgroundColor=e.backgroundColor||this._model.get("backgroundColor");var t=this._zr;return d(t.storage.getDisplayList(),function(e){e.stopAnimation(!0)}),t.painter.getRenderedCanvas(e)}},Fw.getSvgDataUrl=function(){if(jv.svgSupported){var e=this._zr;return d(e.storage.getDisplayList(),function(e){e.stopAnimation(!0)}),e.painter.pathToSvg()}},Fw.getDataURL=function(e){var t=(e=e||{}).excludeComponents,n=this._model,i=[],r=this;Ew(t,function(e){n.eachComponent({mainType:e},function(e){var t=r._componentsMap[e.__viewId];t.group.ignore||(i.push(t),t.group.ignore=!0)})});var o="svg"===this._zr.painter.getType()?this.getSvgDataUrl():this.getRenderedCanvas(e).toDataURL("image/"+(e&&e.type||"png"));return Ew(i,function(e){e.group.ignore=!1}),o},Fw.getConnectedDataURL=function(e){if(jv.canvasSupported){var t=this.group,n=Math.min,r=Math.max;if(Zw[t]){var o=1/0,a=1/0,s=-1/0,l=-1/0,c=[],u=e&&e.pixelRatio||1;d(Xw,function(u,d){if(u.group===t){var h=u.getRenderedCanvas(i(e)),p=u.getDom().getBoundingClientRect();o=n(p.left,o),a=n(p.top,a),s=r(p.right,s),l=r(p.bottom,l),c.push({dom:h,left:p.left,top:p.top})}});var h=(s*=u)-(o*=u),p=(l*=u)-(a*=u),f=r_();f.width=h,f.height=p;var g=yi(f);return Ew(c,function(e){var t=new qe({style:{x:e.left*u-o,y:e.top*u-a,image:e.dom}});g.add(t)}),g.refreshImmediately(),f.toDataURL("image/"+(e&&e.type||"png"))}return this.getDataURL(e)}},Fw.convertToPixel=v(Na,"convertToPixel"),Fw.convertFromPixel=v(Na,"convertFromPixel"),Fw.containPixel=function(e,t){var n;return e=Fo(this._model,e),d(e,function(e,i){i.indexOf("Models")>=0&&d(e,function(e){var r=e.coordinateSystem;if(r&&r.containPoint)n|=!!r.containPoint(t);else if("seriesModels"===i){var o=this._chartsMap[e.__viewId];o&&o.containPoint&&(n|=o.containPoint(t,e))}},this)},this),!!n},Fw.getVisual=function(e,t){var n=(e=Fo(this._model,e,{defaultMainType:"series"})).seriesModel.getData(),i=e.hasOwnProperty("dataIndexInside")?e.dataIndexInside:e.hasOwnProperty("dataIndex")?n.indexOfRawIndex(e.dataIndex):null;return null!=i?n.getItemVisual(i,t):n.getVisual(t)},Fw.getViewOfComponentModel=function(e){return this._componentsMap[e.__viewId]},Fw.getViewOfSeriesModel=function(e){return this._chartsMap[e.__viewId]};var Bw={update:function(e){var t=this._model,n=this._api,i=this._coordSysMgr,r=this._zr;if(t){t.restoreData(),i.create(this._model,this._api),Ha.call(this,t,n),Fa.call(this,t),i.update(t,n),Ua.call(this,t,e),Xa.call(this,t,e);var o=t.get("backgroundColor")||"transparent",a=r.painter;if(a.isSingleCanvas&&a.isSingleCanvas())r.configLayer(0,{clearColor:o});else{if(!jv.canvasSupported){var s=Mt(o);o=Ot(s,"rgb"),0===s[3]&&(o="transparent")}o.colorStops||o.image?(r.configLayer(0,{clearColor:o}),this.__hasGradientOrPatternBg=!0,this._dom.style.background="transparent"):(this.__hasGradientOrPatternBg&&r.configLayer(0,{clearColor:null}),this.__hasGradientOrPatternBg=!1,this._dom.style.background=o)}Ew(Gw,function(e){e(t,n)})}},updateView:function(e){var t=this._model;t&&(t.eachSeries(function(e){e.getData().clearAllVisual()}),Ua.call(this,t,e),Ga.call(this,"updateView",t,e))},updateVisual:function(e){var t=this._model;t&&(t.eachSeries(function(e){e.getData().clearAllVisual()}),Ua.call(this,t,e,!0),Ga.call(this,"updateVisual",t,e))},updateLayout:function(e){var t=this._model;t&&(Za.call(this,t,e),Ga.call(this,"updateLayout",t,e))},prepareAndUpdate:function(e){var t=this._model;Wa.call(this,"component",t),Wa.call(this,"chart",t),Bw.update.call(this,e)}};Fw.resize=function(e){this[Ow]=!0,this._zr.resize(e);var t=this._model&&this._model.resetOption("media");Bw[t?"prepareAndUpdate":"update"].call(this),this._loadingFX&&this._loadingFX.resize(),this[Ow]=!1;var n=e&&e.silent;Va.call(this,n),Ba.call(this,n)},Fw.showLoading=function(e,t){if(b(e)&&(t=e,e=""),e=e||"default",this.hideLoading(),Yw[e]){var n=Yw[e](this._api,t),i=this._zr;this._loadingFX=n,i.add(n)}},Fw.hideLoading=function(){this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null},Fw.makeActionFromEvent=function(e){var t=a({},e);return t.type=Ww[e.type],t},Fw.dispatchAction=function(e,t){b(t)||(t={silent:!!t}),Vw[e.type]&&this._model&&(this[Ow]?this._pendingActions.push(e):(Ra.call(this,e,t.silent),t.flush?this._zr.flush(!0):!1!==t.flush&&jv.browser.weChat&&this._throttledZrFlush(),Va.call(this,t.silent),Ba.call(this,t.silent)))},Fw.on=Pa("on"),Fw.off=Pa("off"),Fw.one=Pa("one");var Hw=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];Fw._initEvents=function(){Ew(Hw,function(e){this._zr.on(e,function(t){var n,i=this.getModel(),r=t.target;if("globalout"===e)n={};else if(r&&null!=r.dataIndex){var o=r.dataModel||i.getSeriesByIndex(r.seriesIndex);n=o&&o.getDataParams(r.dataIndex,r.dataType)||{}}else r&&r.eventData&&(n=a({},r.eventData));n&&(n.event=t,n.type=e,this.trigger(e,n))},this)},this),Ew(Ww,function(e,t){this._messageCenter.on(t,function(e){this.trigger(t,e)},this)},this)},Fw.isDisposed=function(){return this._disposed},Fw.clear=function(){this.setOption({series:[]},!0)},Fw.dispose=function(){if(!this._disposed){this._disposed=!0;var e=this._api,t=this._model;Ew(this._componentsViews,function(n){n.dispose(t,e)}),Ew(this._chartsViews,function(n){n.dispose(t,e)}),this._zr.dispose(),delete Xw[this.id]}},u(za,g_);var Vw={},Ww={},Uw=[],$w=[],Gw=[],qw=[],jw={},Yw={},Xw={},Zw={},Kw=new Date-0,Jw=new Date-0,Qw="_echarts_instance_",eC={},tC=Ja;ar(2e3,function(e){e.eachRawSeries(function(t){var n=(t.visualColorAccessPath||"itemStyle.normal.color").split("."),i=t.getData(),r=t.get(n)||t.getColorFromPalette(t.get("name"));i.setVisual("color",r),e.isSeriesFiltered(t)||("function"!=typeof r||r instanceof xb||i.each(function(e){i.setItemVisual(e,"color",r(t.getDataParams(e)))}),i.each(function(e){var t=i.getItemModel(e).get(n,!0);null!=t&&i.setItemVisual(e,"color",t)}))})}),tr(yw),rr("default",function(e,t){r(t=t||{},{text:"loading",color:"#c23531",textColor:"#000",maskColor:"rgba(255, 255, 255, 0.8)",zlevel:0});var n=new fb({style:{fill:t.maskColor},zlevel:t.zlevel,z:1e4}),i=new _b({shape:{startAngle:-Mw/2,endAngle:-Mw/2+.1,r:10},style:{stroke:t.color,lineCap:"round",lineWidth:5},zlevel:t.zlevel,z:10001}),o=new fb({style:{fill:"none",text:t.text,textPosition:"right",textDistance:10,textFill:t.textColor},zlevel:t.zlevel,z:10001});i.animateShape(!0).when(1e3,{endAngle:3*Mw/2}).start("circularInOut"),i.animateShape(!0).when(1e3,{startAngle:3*Mw/2}).delay(300).start("circularInOut");var a=new X_;return a.add(i),a.add(o),a.add(n),a.resize=function(){var t=e.getWidth()/2,r=e.getHeight()/2;i.setShape({cx:t,cy:r});var a=i.shape.r;o.setShape({x:t-a,y:r-a,width:2*a,height:2*a}),n.setShape({x:0,y:0,width:e.getWidth(),height:e.getHeight()})},a.resize(),a}),ir({type:"highlight",event:"highlight",update:"highlight"},N),ir({type:"downplay",event:"downplay",update:"downplay"},N);var nC={};fr.prototype={constructor:fr,add:function(e){return this._add=e,this},update:function(e){return this._update=e,this},remove:function(e){return this._remove=e,this},execute:function(){var e=this._old,t=this._new,n={},i=[],r=[];for(pr(e,{},i,"_oldKeyGetter",this),pr(t,n,r,"_newKeyGetter",this),o=0;o<e.length;o++)null!=(s=n[a=i[o]])?((c=s.length)?(1===c&&(n[a]=null),s=s.unshift()):n[a]=null,this._update&&this._update(s,o)):this._remove&&this._remove(o);for(var o=0;o<r.length;o++){var a=r[o];if(n.hasOwnProperty(a)){var s=n[a];if(null==s)continue;if(s.length)for(var l=0,c=s.length;l<c;l++)this._add&&this._add(s[l]);else this._add&&this._add(s)}}}};var iC=b,rC="undefined"==typeof window?Fv:window,oC={float:void 0===rC.Float64Array?Array:rC.Float64Array,int:void 0===rC.Int32Array?Array:rC.Int32Array,ordinal:Array,number:Array,time:Array},aC=["stackedOn","hasItemOption","_nameList","_idList","_rawData"];mr.prototype.pure=!1,mr.prototype.count=function(){return this._array.length},mr.prototype.getItem=function(e){return this._array[e]};var sC=function(e,t){e=e||["x","y"];for(var n={},i=[],r=0;r<e.length;r++){var o,a={};"string"==typeof e[r]?a={name:o=e[r],coordDim:o,coordDimIndex:0,stackable:!1,type:"number"}:(o=(a=e[r]).name,a.type=a.type||"number",a.coordDim||(a.coordDim=o,a.coordDimIndex=0)),a.otherDims=a.otherDims||{},i.push(o),n[o]=a}this.dimensions=i,this._dimensionInfos=n,this.hostModel=t,this.dataType,this.indices=[],this._storage={},this._nameList=[],this._idList=[],this._optionModels=[],this.stackedOn=null,this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._rawData,this._extent},lC=sC.prototype;lC.type="list",lC.hasItemOption=!0,lC.getDimension=function(e){return isNaN(e)||(e=this.dimensions[e]||e),e},lC.getDimensionInfo=function(e){return i(this._dimensionInfos[this.getDimension(e)])},lC.initData=function(e,t,n){y(e=e||[])&&(e=new mr(e)),this._rawData=e;var i,r=this._storage={},o=this.indices=[],a=this.dimensions,s=this._dimensionInfos,l=e.count(),c=[],u={};for(t=t||[],v=0;v<a.length;v++){var d=s[a[v]];0===d.otherDims.itemName&&(i=v);var h=oC[d.type];r[a[v]]=new h(l)}var p=this;for(n||(p.hasItemOption=!1),n=n||function(e,t,n,i){var r=No(e);return Eo(e)&&(p.hasItemOption=!0),Ro(r instanceof Array?r[i]:r,s[t])},v=0;v<l;v++){for(var f=e.getItem(v),g=0;g<a.length;g++){var m=a[g];r[m][v]=n(f,m,v,g)}o.push(v)}for(var v=0;v<l;v++){f=e.getItem(v),!t[v]&&f&&(null!=f.name?t[v]=f.name:null!=i&&(t[v]=r[a[i]][v]));var _=t[v]||"",x=f&&f.id;!x&&_&&(u[_]=u[_]||0,x=_,u[_]>0&&(x+="__ec__"+u[_]),u[_]++),x&&(c[v]=x)}this._nameList=t,this._idList=c},lC.count=function(){return this.indices.length},lC.get=function(e,t,n){var i=this._storage,r=this.indices[t];if(null==r||!i[e])return NaN;var o=i[e][r];if(n){var a=this._dimensionInfos[e];if(a&&a.stackable)for(var s=this.stackedOn;s;){var l=s.get(e,t);(o>=0&&l>0||o<=0&&l<0)&&(o+=l),s=s.stackedOn}}return o},lC.getValues=function(e,t,n){var i=[];y(e)||(n=t,t=e,e=this.dimensions);for(var r=0,o=e.length;r<o;r++)i.push(this.get(e[r],t,n));return i},lC.hasValue=function(e){for(var t=this.dimensions,n=this._dimensionInfos,i=0,r=t.length;i<r;i++)if("ordinal"!==n[t[i]].type&&isNaN(this.get(t[i],e)))return!1;return!0},lC.getDataExtent=function(e,t,n){e=this.getDimension(e);var i=this._storage[e],r=this.getDimensionInfo(e);t=r&&r.stackable&&t;var o,a=(this._extent||(this._extent={}))[e+!!t];if(a)return a;if(i){for(var s=1/0,l=-1/0,c=0,u=this.count();c<u;c++)o=this.get(e,c,t),n&&!n(o,e,c)||(o<s&&(s=o),o>l&&(l=o));return this._extent[e+!!t]=[s,l]}return[1/0,-1/0]},lC.getSum=function(e,t){var n=0;if(this._storage[e])for(var i=0,r=this.count();i<r;i++){var o=this.get(e,i,t);isNaN(o)||(n+=o)}return n},lC.indexOf=function(e,t){var n=this._storage[e],i=this.indices;if(n)for(var r=0,o=i.length;r<o;r++)if(n[i[r]]===t)return r;return-1},lC.indexOfName=function(e){for(var t=this.indices,n=this._nameList,i=0,r=t.length;i<r;i++)if(n[t[i]]===e)return i;return-1},lC.indexOfRawIndex=function(e){var t=this.indices,n=t[e];if(null!=n&&n===e)return e;for(var i=0,r=t.length-1;i<=r;){var o=(i+r)/2|0;if(t[o]<e)i=o+1;else{if(!(t[o]>e))return o;r=o-1}}return-1},lC.indicesOfNearest=function(e,t,n,i){var r=[];if(!this._storage[e])return r;null==i&&(i=1/0);for(var o=Number.MAX_VALUE,a=-1,s=0,l=this.count();s<l;s++){var c=t-this.get(e,s,n),u=Math.abs(c);c<=i&&u<=o&&((u<o||c>=0&&a<0)&&(o=u,a=c,r.length=0),r.push(s))}return r},lC.getRawIndex=function(e){var t=this.indices[e];return null==t?-1:t},lC.getRawDataItem=function(e){return this._rawData.getItem(this.getRawIndex(e))},lC.getName=function(e){return this._nameList[this.indices[e]]||""},lC.getId=function(e){return this._idList[this.indices[e]]||this.getRawIndex(e)+""},lC.each=function(e,t,n,i){"function"==typeof e&&(i=n,n=t,t=e,e=[]);var r=[],o=(e=f(vr(e),this.getDimension,this)).length,a=this.indices;i=i||this;for(var s=0;s<a.length;s++)switch(o){case 0:t.call(i,s);break;case 1:t.call(i,this.get(e[0],s,n),s);break;case 2:t.call(i,this.get(e[0],s,n),this.get(e[1],s,n),s);break;default:for(var l=0;l<o;l++)r[l]=this.get(e[l],s,n);r[l]=s,t.apply(i,r)}},lC.filterSelf=function(e,t,n,i){"function"==typeof e&&(i=n,n=t,t=e,e=[]);var r=[],o=[],a=(e=f(vr(e),this.getDimension,this)).length,s=this.indices;i=i||this;for(var l=0;l<s.length;l++){var c;if(a)if(1===a)c=t.call(i,this.get(e[0],l,n),l);else{for(var u=0;u<a;u++)o[u]=this.get(e[u],l,n);o[u]=l,c=t.apply(i,o)}else c=t.call(i,l);c&&r.push(s[l])}return this.indices=r,this._extent={},this},lC.mapArray=function(e,t,n,i){"function"==typeof e&&(i=n,n=t,t=e,e=[]);var r=[];return this.each(e,function(){r.push(t&&t.apply(this,arguments))},n,i),r},lC.map=function(e,t,n,i){var r=yr(this,e=f(vr(e),this.getDimension,this)),o=r.indices=this.indices,a=r._storage,s=[];return this.each(e,function(){var n=arguments[arguments.length-1],i=t&&t.apply(this,arguments);if(null!=i){"number"==typeof i&&(s[0]=i,i=s);for(var r=0;r<i.length;r++){var l=e[r],c=a[l],u=o[n];c&&(c[u]=i[r])}}},n,i),r},lC.downSample=function(e,t,n,i){for(var r=yr(this,[e]),o=this._storage,a=r._storage,s=this.indices,l=r.indices=[],c=[],u=[],d=Math.floor(1/t),h=a[e],p=this.count(),f=0;f<o[e].length;f++)a[e][f]=o[e][f];for(f=0;f<p;f+=d){d>p-f&&(d=p-f,c.length=d);for(var g=0;g<d;g++){var m=s[f+g];c[g]=h[m],u[g]=m}var v=n(c);h[m=u[i(c,v)||0]]=v,l.push(m)}return r},lC.getItemModel=function(e){var t=this.hostModel;return e=this.indices[e],new Lo(this._rawData.getItem(e),t,t&&t.ecModel)},lC.diff=function(e){var t,n=this._idList,i=e&&e._idList;return new fr(e?e.indices:[],this.indices,function(e){return null!=(t=i[e])?t:"e\0\0"+e},function(e){return null!=(t=n[e])?t:"e\0\0"+e})},lC.getVisual=function(e){var t=this._visual;return t&&t[e]},lC.setVisual=function(e,t){if(iC(e))for(var n in e)e.hasOwnProperty(n)&&this.setVisual(n,e[n]);else this._visual=this._visual||{},this._visual[e]=t},lC.setLayout=function(e,t){if(iC(e))for(var n in e)e.hasOwnProperty(n)&&this.setLayout(n,e[n]);else this._layout[e]=t},lC.getLayout=function(e){return this._layout[e]},lC.getItemLayout=function(e){return this._itemLayouts[e]},lC.setItemLayout=function(e,t,n){this._itemLayouts[e]=n?a(this._itemLayouts[e]||{},t):t},lC.clearItemLayouts=function(){this._itemLayouts.length=0},lC.getItemVisual=function(e,t,n){var i=this._itemVisuals[e],r=i&&i[t];return null!=r||n?r:this.getVisual(t)},lC.setItemVisual=function(e,t,n){var i=this._itemVisuals[e]||{};if(this._itemVisuals[e]=i,iC(t))for(var r in t)t.hasOwnProperty(r)&&(i[r]=t[r]);else i[t]=n},lC.clearAllVisual=function(){this._visual={},this._itemVisuals=[]};var cC=function(e){e.seriesIndex=this.seriesIndex,e.dataIndex=this.dataIndex,e.dataType=this.dataType};lC.setItemGraphicEl=function(e,t){var n=this.hostModel;t&&(t.dataIndex=e,t.dataType=this.dataType,t.seriesIndex=n&&n.seriesIndex,"group"===t.type&&t.traverse(cC,t)),this._graphicEls[e]=t},lC.getItemGraphicEl=function(e){return this._graphicEls[e]},lC.eachItemGraphicEl=function(e,t){d(this._graphicEls,function(n,i){n&&e&&e.call(t,n,i)})},lC.cloneShallow=function(){var e=f(this.dimensions,this.getDimensionInfo,this),t=new sC(e,this.hostModel);return t._storage=this._storage,gr(t,this),t.indices=this.indices.slice(),this._extent&&(t._extent=a({},this._extent)),t},lC.wrapMethod=function(e,t){var n=this[e];"function"==typeof n&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(e),this[e]=function(){var e=n.apply(this,arguments);return t.apply(this,[e].concat(C(arguments)))})},lC.TRANSFERABLE_METHODS=["cloneShallow","downSample","map"],lC.CHANGABLE_METHODS=["filterSelf"];var uC=d,dC=_,hC=r,pC={tooltip:1,label:1,itemName:1},fC=xr.guessOrdinal=function(e,t){for(var n=0,i=e.length;n<i;n++){var r=_r(e[n]);if(!y(r))return!1;if(null!=(r=r[t])&&isFinite(r)&&""!==r)return!1;if(dC(r)&&"-"!==r)return!0}return!1},gC={cartesian2d:function(e,t,n,i){var r=f(["xAxis","yAxis"],function(e){return n.queryComponents({mainType:e,index:t.get(e+"Index"),id:t.get(e+"Id")})[0]}),o=r[0],a=r[1],s=o.get("type"),l=a.get("type"),c=[{name:"x",type:Ir(s),stackable:Mr(s)},{name:"y",type:Ir(l),stackable:Mr(l)}],u="category"===s,d="category"===l;c=xr(c,e,i);var h={};return u&&(h.x=o),d&&(h.y=a),{dimensions:c,categoryIndex:u?0:d?1:-1,categoryAxesModels:h}},singleAxis:function(e,t,n,i){var r=n.queryComponents({mainType:"singleAxis",index:t.get("singleAxisIndex"),id:t.get("singleAxisId")})[0],o=r.get("type"),a="category"===o,s=[{name:"single",type:Ir(o),stackable:Mr(o)}];s=xr(s,e,i);var l={};return a&&(l.single=r),{dimensions:s,categoryIndex:a?0:-1,categoryAxesModels:l}},polar:function(e,t,n,i){var r=n.queryComponents({mainType:"polar",index:t.get("polarIndex"),id:t.get("polarId")})[0],o=r.findAxisModel("angleAxis"),a=r.findAxisModel("radiusAxis"),s=a.get("type"),l=o.get("type"),c=[{name:"radius",type:Ir(s),stackable:Mr(s)},{name:"angle",type:Ir(l),stackable:Mr(l)}],u="category"===l,d="category"===s;c=xr(c,e,i);var h={};return d&&(h.radius=a),u&&(h.angle=o),{dimensions:c,categoryIndex:u?1:d?0:-1,categoryAxesModels:h}},geo:function(e,t,n,i){return{dimensions:xr([{name:"lng"},{name:"lat"}],e,i)}}};Ar.prototype.parse=function(e){return e},Ar.prototype.getSetting=function(e){return this._setting[e]},Ar.prototype.contain=function(e){var t=this._extent;return e>=t[0]&&e<=t[1]},Ar.prototype.normalize=function(e){var t=this._extent;return t[1]===t[0]?.5:(e-t[0])/(t[1]-t[0])},Ar.prototype.scale=function(e){var t=this._extent;return e*(t[1]-t[0])+t[0]},Ar.prototype.unionExtent=function(e){var t=this._extent;e[0]<t[0]&&(t[0]=e[0]),e[1]>t[1]&&(t[1]=e[1])},Ar.prototype.unionExtentFromData=function(e,t){this.unionExtent(e.getDataExtent(t,!0))},Ar.prototype.getExtent=function(){return this._extent.slice()},Ar.prototype.setExtent=function(e,t){var n=this._extent;isNaN(e)||(n[0]=e),isNaN(t)||(n[1]=t)},Ar.prototype.getTicksLabels=function(){for(var e=[],t=this.getTicks(),n=0;n<t.length;n++)e.push(this.getLabel(t[n]));return e},Ar.prototype.isBlank=function(){return this._isBlank},Ar.prototype.setBlank=function(e){this._isBlank=e},Ki(Ar),tn(Ar,{registerWhenExtend:!0});var mC=Ar.prototype,vC=Ar.extend({type:"ordinal",init:function(e,t){this._data=e,this._extent=t||[0,e.length-1]},parse:function(e){return"string"==typeof e?l(this._data,e):Math.round(e)},contain:function(e){return e=this.parse(e),mC.contain.call(this,e)&&null!=this._data[e]},normalize:function(e){return mC.normalize.call(this,this.parse(e))},scale:function(e){return Math.round(mC.scale.call(this,e))},getTicks:function(){for(var e=[],t=this._extent,n=t[0];n<=t[1];)e.push(n),n++;return e},getLabel:function(e){return this._data[e]},count:function(){return this._extent[1]-this._extent[0]+1},unionExtentFromData:function(e,t){this.unionExtent(e.getDataExtent(t,!1))},niceTicks:N,niceExtent:N});vC.create=function(){return new vC};var _C=Mi,yC=Mi,xC=Ar.extend({type:"interval",_interval:0,_intervalPrecision:2,setExtent:function(e,t){var n=this._extent;isNaN(e)||(n[0]=parseFloat(e)),isNaN(t)||(n[1]=parseFloat(t))},unionExtent:function(e){var t=this._extent;e[0]<t[0]&&(t[0]=e[0]),e[1]>t[1]&&(t[1]=e[1]),xC.prototype.setExtent.call(this,t[0],t[1])},getInterval:function(){return this._interval},setInterval:function(e){this._interval=e,this._niceExtent=this._extent.slice(),this._intervalPrecision=Dr(e)},getTicks:function(){return Pr(this._interval,this._extent,this._niceExtent,this._intervalPrecision)},getTicksLabels:function(){for(var e=[],t=this.getTicks(),n=0;n<t.length;n++)e.push(this.getLabel(t[n]));return e},getLabel:function(e,t){if(null==e)return"";var n=t&&t.precision;return null==n?n=Ai(e)||0:"auto"===n&&(n=this._intervalPrecision),e=yC(e,n,!0),Vi(e)},niceTicks:function(e,t,n){e=e||5;var i=this._extent,r=i[1]-i[0];if(isFinite(r)){r<0&&(r=-r,i.reverse());var o=Cr(i,e,t,n);this._intervalPrecision=o.intervalPrecision,this._interval=o.interval,this._niceExtent=o.niceTickExtent}},niceExtent:function(e){var t=this._extent;if(t[0]===t[1])if(0!==t[0]){var n=t[0];e.fixMax?t[0]-=n/2:(t[1]+=n/2,t[0]-=n/2)}else t[1]=1;var i=t[1]-t[0];isFinite(i)||(t[0]=0,t[1]=1),this.niceTicks(e.splitNumber,e.minInterval,e.maxInterval);var r=this._interval;e.fixMin||(t[0]=yC(Math.floor(t[0]/r)*r)),e.fixMax||(t[1]=yC(Math.ceil(t[1]/r)*r))}});xC.create=function(){return new xC};var bC=xC.prototype,wC=Math.ceil,CC=Math.floor,SC=function(e,t,n,i){for(;n<i;){var r=n+i>>>1;e[r][1]<t?n=r+1:i=r}return n},TC=xC.extend({type:"time",getLabel:function(e){var t=this._stepLvl,n=new Date(e);return Zi(t[0],n,this.getSetting("useUTC"))},niceExtent:function(e){var t=this._extent;if(t[0]===t[1]&&(t[0]-=864e5,t[1]+=864e5),t[1]===-1/0&&t[0]===1/0){var n=new Date;t[1]=+new Date(n.getFullYear(),n.getMonth(),n.getDate()),t[0]=t[1]-864e5}this.niceTicks(e.splitNumber,e.minInterval,e.maxInterval);var i=this._interval;e.fixMin||(t[0]=Mi(CC(t[0]/i)*i)),e.fixMax||(t[1]=Mi(wC(t[1]/i)*i))},niceTicks:function(e,t,n){e=e||10;var i=this._extent,r=i[1]-i[0],o=r/e;null!=t&&o<t&&(o=t),null!=n&&o>n&&(o=n);var a=AC.length,s=SC(AC,o,0,a),l=AC[Math.min(s,a-1)],c=l[1];"year"===l[0]&&(c*=Ni(r/c/e,!0));var u=this.getSetting("useUTC")?0:60*new Date(+i[0]||+i[1]).getTimezoneOffset()*1e3,d=[Math.round(wC((i[0]-u)/c)*c+u),Math.round(CC((i[1]-u)/c)*c+u)];kr(d,i),this._stepLvl=l,this._interval=c,this._niceExtent=d},parse:function(e){return+Pi(e)}});d(["contain","normalize"],function(e){TC.prototype[e]=function(t){return bC[e].call(this,this.parse(t))}});var AC=[["hh:mm:ss",1e3],["hh:mm:ss",5e3],["hh:mm:ss",1e4],["hh:mm:ss",15e3],["hh:mm:ss",3e4],["hh:mm\nMM-dd",6e4],["hh:mm\nMM-dd",3e5],["hh:mm\nMM-dd",6e5],["hh:mm\nMM-dd",9e5],["hh:mm\nMM-dd",18e5],["hh:mm\nMM-dd",36e5],["hh:mm\nMM-dd",72e5],["hh:mm\nMM-dd",216e5],["hh:mm\nMM-dd",432e5],["MM-dd\nyyyy",864e5],["MM-dd\nyyyy",1728e5],["MM-dd\nyyyy",2592e5],["MM-dd\nyyyy",3456e5],["MM-dd\nyyyy",432e6],["MM-dd\nyyyy",5184e5],["week",6048e5],["MM-dd\nyyyy",864e6],["week",12096e5],["week",18144e5],["month",26784e5],["week",36288e5],["month",53568e5],["week",36288e5],["quarter",8208e6],["month",107136e5],["month",13392e6],["half-year",16416e6],["month",214272e5],["month",26784e6],["year",32832e6]];TC.create=function(e){return new TC({useUTC:e.ecModel.get("useUTC")})};var MC=Ar.prototype,EC=xC.prototype,IC=Ai,DC=Mi,kC=Math.floor,LC=Math.ceil,NC=Math.pow,PC=Math.log,OC=Ar.extend({type:"log",base:10,$constructor:function(){Ar.apply(this,arguments),this._originalScale=new xC},getTicks:function(){var e=this._originalScale,t=this._extent,n=e.getExtent();return f(EC.getTicks.call(this),function(i){var r=Mi(NC(this.base,i));return r=i===t[0]&&e.__fixMin?Or(r,n[0]):r,r=i===t[1]&&e.__fixMax?Or(r,n[1]):r},this)},getLabel:EC.getLabel,scale:function(e){return e=MC.scale.call(this,e),NC(this.base,e)},setExtent:function(e,t){var n=this.base;e=PC(e)/PC(n),t=PC(t)/PC(n),EC.setExtent.call(this,e,t)},getExtent:function(){var e=this.base,t=MC.getExtent.call(this);t[0]=NC(e,t[0]),t[1]=NC(e,t[1]);var n=this._originalScale,i=n.getExtent();return n.__fixMin&&(t[0]=Or(t[0],i[0])),n.__fixMax&&(t[1]=Or(t[1],i[1])),t},unionExtent:function(e){this._originalScale.unionExtent(e);var t=this.base;e[0]=PC(e[0])/PC(t),e[1]=PC(e[1])/PC(t),MC.unionExtent.call(this,e)},unionExtentFromData:function(e,t){this.unionExtent(e.getDataExtent(t,!0,function(e){return e>0}))},niceTicks:function(e){e=e||10;var t=this._extent,n=t[1]-t[0];if(!(n===1/0||n<=0)){var i=Oi(n);for(e/n*i<=.5&&(i*=10);!isNaN(i)&&Math.abs(i)<1&&Math.abs(i)>0;)i*=10;var r=[Mi(LC(t[0]/i)*i),Mi(kC(t[1]/i)*i)];this._interval=i,this._niceExtent=r}},niceExtent:function(e){EC.niceExtent.call(this,e);var t=this._originalScale;t.__fixMin=e.fixMin,t.__fixMax=e.fixMax}});d(["contain","normalize"],function(e){OC.prototype[e]=function(t){return t=PC(t)/PC(this.base),MC[e].call(this,t)}}),OC.create=function(){return new OC};var RC={getFormattedLabels:function(){return Vr(this.axis,this.get("axisLabel.formatter"))},getCategories:function(){return"category"===this.get("type")&&f(this.get("data"),Gr)},getMin:function(e){var t=this.option,n=e||null==t.rangeStart?t.min:t.rangeStart;return this.axis&&null!=n&&"dataMin"!==n&&"function"!=typeof n&&!M(n)&&(n=this.axis.scale.parse(n)),n},getMax:function(e){var t=this.option,n=e||null==t.rangeEnd?t.max:t.rangeEnd;return this.axis&&null!=n&&"dataMax"!==n&&"function"!=typeof n&&!M(n)&&(n=this.axis.scale.parse(n)),n},getNeedCrossZero:function(){var e=this.option;return null==e.rangeStart&&null==e.rangeEnd&&!e.scale},getCoordSysModel:N,setRange:function(e,t){this.option.rangeStart=e,this.option.rangeEnd=t},resetRange:function(){this.option.rangeStart=this.option.rangeEnd=null}},zC=Zn({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(e,t){var n=t.cx,i=t.cy,r=t.width/2,o=t.height/2;e.moveTo(n,i-o),e.lineTo(n+r,i+o),e.lineTo(n-r,i+o),e.closePath()}}),FC=Zn({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(e,t){var n=t.cx,i=t.cy,r=t.width/2,o=t.height/2;e.moveTo(n,i-o),e.lineTo(n+r,i),e.lineTo(n,i+o),e.lineTo(n-r,i),e.closePath()}}),BC=Zn({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(e,t){var n=t.x,i=t.y,r=t.width/5*3,o=Math.max(r,t.height),a=r/2,s=a*a/(o-a),l=i-o+a+s,c=Math.asin(s/a),u=Math.cos(c)*a,d=Math.sin(c),h=Math.cos(c),p=.6*a,f=.7*a;e.moveTo(n-u,l+s),e.arc(n,l,a,Math.PI-c,2*Math.PI+c),e.bezierCurveTo(n+u-d*p,l+s+h*p,n,i-f,n,i),e.bezierCurveTo(n,i-f,n-u+d*p,l+s+h*p,n-u,l+s),e.closePath()}}),HC=Zn({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(e,t){var n=t.height,i=t.width,r=t.x,o=t.y,a=i/3*2;e.moveTo(r,o),e.lineTo(r+a,o+n),e.lineTo(r,o+n/4*3),e.lineTo(r-a,o+n),e.lineTo(r,o),e.closePath()}}),VC={line:function(e,t,n,i,r){r.x1=e,r.y1=t+i/2,r.x2=e+n,r.y2=t+i/2},rect:function(e,t,n,i,r){r.x=e,r.y=t,r.width=n,r.height=i},roundRect:function(e,t,n,i,r){r.x=e,r.y=t,r.width=n,r.height=i,r.r=Math.min(n,i)/4},square:function(e,t,n,i,r){var o=Math.min(n,i);r.x=e,r.y=t,r.width=o,r.height=o},circle:function(e,t,n,i,r){r.cx=e+n/2,r.cy=t+i/2,r.r=Math.min(n,i)/2},diamond:function(e,t,n,i,r){r.cx=e+n/2,r.cy=t+i/2,r.width=n,r.height=i},pin:function(e,t,n,i,r){r.x=e+n/2,r.y=t+i/2,r.width=n,r.height=i},arrow:function(e,t,n,i,r){r.x=e+n/2,r.y=t+i/2,r.width=n,r.height=i},triangle:function(e,t,n,i,r){r.cx=e+n/2,r.cy=t+i/2,r.width=n,r.height=i}},WC={};d({line:gb,rect:fb,roundRect:fb,square:fb,circle:ob,diamond:FC,pin:BC,arrow:HC,triangle:zC},function(e,t){WC[t]=new e});var UC=Zn({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},beforeBrush:function(){var e=this.style;"pin"===this.shape.symbolType&&"inside"===e.textPosition&&(e.textPosition=["50%","40%"],e.textAlign="center",e.textVerticalAlign="middle")},buildPath:function(e,t,n){var i=t.symbolType,r=WC[i];"none"!==t.symbolType&&(r||(r=WC[i="rect"]),VC[i](t.x,t.y,t.width,t.height,r.shape),r.buildPath(e,r.shape,n))}}),$C=(Object.freeze||Object)({createList:function(e){return Sr(e.get("data"),e,e.ecModel)},createScale:function(e,t){var n=t;t instanceof Lo||u(n=new Lo(t),RC);var i=Er(n);return i.setExtent(e[0],e[1]),Nr(i,n),i},mixinAxisModelCommonMethods:function(e){u(e,RC)},completeDimensions:xr,createSymbol:Hr}),GC=wi,qC=[0,1],jC=function(e,t,n){this.dim=e,this.scale=t,this._extent=n||[0,0],this.inverse=!1,this.onBand=!1,this._labelInterval};jC.prototype={constructor:jC,contain:function(e){var t=this._extent,n=Math.min(t[0],t[1]),i=Math.max(t[0],t[1]);return e>=n&&e<=i},containData:function(e){return this.contain(this.dataToCoord(e))},getExtent:function(){return this._extent.slice()},getPixelPrecision:function(e){return Ci(e||this.scale.getExtent(),this._extent)},setExtent:function(e,t){var n=this._extent;n[0]=e,n[1]=t},dataToCoord:function(e,t){var n=this._extent,i=this.scale;return e=i.normalize(e),this.onBand&&"ordinal"===i.type&&Fr(n=n.slice(),i.count()),GC(e,qC,n,t)},coordToData:function(e,t){var n=this._extent,i=this.scale;this.onBand&&"ordinal"===i.type&&Fr(n=n.slice(),i.count());var r=GC(e,n,qC,t);return this.scale.scale(r)},pointToData:function(e,t){},getTicksCoords:function(e){if(this.onBand&&!e){for(var t=this.getBands(),n=[],i=0;i<t.length;i++)n.push(t[i][0]);return t[i-1]&&n.push(t[i-1][1]),n}return f(this.scale.getTicks(),this.dataToCoord,this)},getLabelsCoords:function(){return f(this.scale.getTicks(),this.dataToCoord,this)},getBands:function(){for(var e=this.getExtent(),t=[],n=this.scale.count(),i=e[0],r=e[1]-i,o=0;o<n;o++)t.push([r*o/n+i,r*(o+1)/n+i]);return t},getBandWidth:function(){var e=this._extent,t=this.scale.getExtent(),n=t[1]-t[0]+(this.onBand?1:0);0===n&&(n=1);var i=Math.abs(e[1]-e[0]);return Math.abs(i)/n},isHorizontal:null,getRotate:null,getLabelInterval:function(){var e=this._labelInterval;if(!e){var t=this.model,n=t.getModel("axisLabel");e=n.get("interval"),"category"!==this.type||null!=e&&"auto"!==e||(e=Rr(f(this.scale.getTicks(),this.dataToCoord,this),t.getFormattedLabels(),n.getFont(),this.getRotate?this.getRotate():this.isHorizontal&&!this.isHorizontal()?90:0,n.get("rotate"))),this._labelInterval=e}return e}};var YC=1e-8;Xr.prototype={constructor:Xr,properties:null,getBoundingRect:function(){var e=this._rect;if(e)return e;for(var t=Number.MAX_VALUE,n=[t,t],i=[-t,-t],r=[],o=[],a=this.geometries,s=0;s<a.length;s++)"polygon"===a[s].type&&(mn(a[s].exterior,r,o),K(n,n,r),J(i,i,o));return 0===s&&(n[0]=n[1]=i[0]=i[1]=0),this._rect=new jt(n[0],n[1],i[0]-n[0],i[1]-n[1])},contain:function(e){var t=this.getBoundingRect(),n=this.geometries;if(!t.contain(e[0],e[1]))return!1;e:for(var i=0,r=n.length;i<r;i++)if("polygon"===n[i].type){var o=n[i].exterior,a=n[i].interiors;if(Ur(o,e[0],e[1])){for(var s=0;s<(a?a.length:0);s++)if(Ur(a[s]))continue e;return!0}}return!1},transformTo:function(e,t,n,i){var r=this.getBoundingRect(),o=r.width/r.height;n?i||(i=n/o):n=o*i;for(var a=new jt(e,t,n,i),s=r.calculateTransform(a),l=this.geometries,c=0;c<l.length;c++)if("polygon"===l[c].type){for(var u=l[c].exterior,d=l[c].interiors,h=0;h<u.length;h++)$(u[h],u[h],s);for(var p=0;p<(d?d.length:0);p++)for(h=0;h<d[p].length;h++)$(d[p][h],d[p][h],s)}(r=this._rect).copy(a),this.center=[r.x+r.width/2,r.y+r.height/2]}};var XC=function(e){return jr(e),f(g(e.features,function(e){return e.geometry&&e.properties&&e.geometry.coordinates.length>0}),function(e){var t=e.properties,n=e.geometry,i=n.coordinates,r=[];"Polygon"===n.type&&r.push({type:"polygon",exterior:i[0],interiors:i.slice(1)}),"MultiPolygon"===n.type&&d(i,function(e){e[0]&&r.push({type:"polygon",exterior:e[0],interiors:e.slice(1)})});var o=new Xr(t.name,r,t.cp);return o.properties=t,o})},ZC={};d(["map","each","filter","indexOf","inherits","reduce","filter","bind","curry","isArray","isString","isObject","isFunction","extend","defaults","clone","merge"],function(e){ZC[e]=s_[e]}),xw.extend({type:"series.line",dependencies:["grid","polar"],getInitialData:function(e,t){return Sr(e.data,this,t)},defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,clipOverflow:!0,label:{normal:{position:"top"}},lineStyle:{normal:{width:2,type:"solid"}},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:!1,connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0}});var KC=Jr.prototype;KC._createSymbol=function(e,t,n,i){this.removeAll();var r=Hr(e,-1,-1,2,2,t.getItemVisual(n,"color"));r.attr({z2:100,culling:!0,scale:Kr(i)}),r.drift=Qr,this._symbolType=e,this.add(r)},KC.stopSymbolAnimation=function(e){this.childAt(0).stopAnimation(e)},KC.getSymbolPath=function(){return this.childAt(0)},KC.getScale=function(){return this.childAt(0).scale},KC.highlight=function(){this.childAt(0).trigger("emphasis")},KC.downplay=function(){this.childAt(0).trigger("normal")},KC.setZ=function(e,t){var n=this.childAt(0);n.zlevel=e,n.z=t},KC.setDraggable=function(e){var t=this.childAt(0);t.draggable=e,t.cursor=e?"move":"pointer"},KC.updateData=function(e,t,n){this.silent=!1;var i=e.getItemVisual(t,"symbol")||"circle",r=e.hostModel,o=$r(e,t),a=i!==this._symbolType;if(a?this._createSymbol(i,e,t,o):((s=this.childAt(0)).silent=!1,wo(s,{scale:Kr(o)},r,t)),this._updateCommon(e,t,o,n),a){var s=this.childAt(0),l=n&&n.fadeIn,c={scale:s.scale.slice()};l&&(c.style={opacity:s.style.opacity}),s.scale=[0,0],l&&(s.style.opacity=0),So(s,c,r,t)}this._seriesModel=r};var JC=["itemStyle","normal"],QC=["itemStyle","emphasis"],eS=["label","normal"],tS=["label","emphasis"];KC._updateCommon=function(e,t,n,i){var r=this.childAt(0),o=e.hostModel,s=e.getItemVisual(t,"color");"image"!==r.type&&r.useStyle({strokeNoScale:!0});var l=i&&i.itemStyle,c=i&&i.hoverItemStyle,u=i&&i.symbolRotate,d=i&&i.symbolOffset,h=i&&i.labelModel,p=i&&i.hoverLabelModel,f=i&&i.hoverAnimation,g=i&&i.cursorStyle;if(!i||e.hasItemOption){var m=i&&i.itemModel?i.itemModel:e.getItemModel(t);l=m.getModel(JC).getItemStyle(["color"]),c=m.getModel(QC).getItemStyle(),u=m.getShallow("symbolRotate"),d=m.getShallow("symbolOffset"),h=m.getModel(eS),p=m.getModel(tS),f=m.getShallow("hoverAnimation"),g=m.getShallow("cursor")}else c=a({},c);var v=r.style;r.attr("rotation",(u||0)*Math.PI/180||0),d&&r.attr("position",[Si(d[0],n[0]),Si(d[1],n[1])]),g&&r.attr("cursor",g),r.setColor(s,i&&i.symbolInnerColor),r.setStyle(l);var _=e.getItemVisual(t,"opacity");null!=_&&(v.opacity=_);var y=i&&i.useNameLabel,x=!y&&Yr(e);(y||null!=x)&&co(v,c,h,p,{labelFetcher:o,labelDataIndex:t,defaultText:y?e.getName(t):e.get(x,t),isRectText:!0,autoColor:s}),r.off("mouseover").off("mouseout").off("emphasis").off("normal"),r.hoverStyle=c,uo(r);var b=Kr(n);if(f&&o.isAnimationEnabled()){var w=function(){var e=b[1]/b[0];this.animateTo({scale:[Math.max(1.1*b[0],b[0]+3),Math.max(1.1*b[1],b[1]+3*e)]},400,"elasticOut")},C=function(){this.animateTo({scale:b},400,"elasticOut")};r.on("mouseover",w).on("mouseout",C).on("emphasis",w).on("normal",C)}},KC.fadeOut=function(e,t){var n=this.childAt(0);this.silent=n.silent=!0,!(t&&t.keepLabel)&&(n.style.text=null),wo(n,{style:{opacity:0},scale:[0,0]},this._seriesModel,this.dataIndex,e)},h(Jr,X_);var nS=ts.prototype;nS.updateData=function(e,t){var n=this.group,i=e.hostModel,r=this._data,o=this._symbolCtor,a={itemStyle:i.getModel("itemStyle.normal").getItemStyle(["color"]),hoverItemStyle:i.getModel("itemStyle.emphasis").getItemStyle(),symbolRotate:i.get("symbolRotate"),symbolOffset:i.get("symbolOffset"),hoverAnimation:i.get("hoverAnimation"),labelModel:i.getModel("label.normal"),hoverLabelModel:i.getModel("label.emphasis"),cursorStyle:i.get("cursor")};e.diff(r).add(function(i){var r=e.getItemLayout(i);if(es(e,i,t)){var s=new o(e,i,a);s.attr("position",r),e.setItemGraphicEl(i,s),n.add(s)}}).update(function(s,l){var c=r.getItemGraphicEl(l),u=e.getItemLayout(s);es(e,s,t)?(c?(c.updateData(e,s,a),wo(c,{position:u},i)):(c=new o(e,s)).attr("position",u),n.add(c),e.setItemGraphicEl(s,c)):n.remove(c)}).remove(function(e){var t=r.getItemGraphicEl(e);t&&t.fadeOut(function(){n.remove(t)})}).execute(),this._data=e},nS.updateLayout=function(){var e=this._data;e&&e.eachItemGraphicEl(function(t,n){var i=e.getItemLayout(n);t.attr("position",i)})},nS.remove=function(e){var t=this.group,n=this._data;n&&(e?n.eachItemGraphicEl(function(e){e.fadeOut(function(){t.remove(e)})}):t.removeAll())};var iS=function(e,t,n,i,r,o){for(var a=os(e,t),s=[],l=[],c=[],u=[],d=[],h=[],p=[],f=o.dimensions,g=0;g<a.length;g++){var m=a[g],v=!0;switch(m.cmd){case"=":var _=e.getItemLayout(m.idx),y=t.getItemLayout(m.idx1);(isNaN(_[0])||isNaN(_[1]))&&(_=y.slice()),s.push(_),l.push(y),c.push(n[m.idx]),u.push(i[m.idx1]),p.push(t.getRawIndex(m.idx1));break;case"+":x=m.idx,s.push(r.dataToPoint([t.get(f[0],x,!0),t.get(f[1],x,!0)])),l.push(t.getItemLayout(x).slice()),c.push(ns(r,t,x)),u.push(i[x]),p.push(t.getRawIndex(x));break;case"-":var x=m.idx,b=e.getRawIndex(x);b!==x?(s.push(e.getItemLayout(x)),l.push(o.dataToPoint([e.get(f[0],x,!0),e.get(f[1],x,!0)])),c.push(n[x]),u.push(ns(o,e,x)),p.push(b)):v=!1}v&&(d.push(m),h.push(h.length))}h.sort(function(e,t){return p[e]-p[t]});for(var w=[],C=[],S=[],T=[],A=[],g=0;g<h.length;g++)x=h[g],w[g]=s[x],C[g]=l[x],S[g]=c[x],T[g]=u[x],A[g]=d[x];return{current:w,next:C,stackedOnCurrent:S,stackedOnNext:T,status:A}},rS=K,oS=J,aS=W,sS=R,lS=[],cS=[],uS=[],dS=Nn.extend({type:"ec-polyline",shape:{points:[],smooth:0,smoothConstraint:!0,smoothMonotone:null,connectNulls:!1},style:{fill:null,stroke:"#000"},brush:sb(Nn.prototype.brush),buildPath:function(e,t){var n=t.points,i=0,r=n.length,o=ss(n,t.smoothConstraint);if(t.connectNulls){for(;r>0&&as(n[r-1]);r--);for(;i<r&&as(n[i]);i++);}for(;i<r;)i+=rs(e,n,i,r,r,1,o.min,o.max,t.smooth,t.smoothMonotone,t.connectNulls)+1}}),hS=Nn.extend({type:"ec-polygon",shape:{points:[],stackedOnPoints:[],smooth:0,stackedOnSmooth:0,smoothConstraint:!0,smoothMonotone:null,connectNulls:!1},brush:sb(Nn.prototype.brush),buildPath:function(e,t){var n=t.points,i=t.stackedOnPoints,r=0,o=n.length,a=t.smoothMonotone,s=ss(n,t.smoothConstraint),l=ss(i,t.smoothConstraint);if(t.connectNulls){for(;o>0&&as(n[o-1]);o--);for(;r<o&&as(n[r]);r++);}for(;r<o;){var c=rs(e,n,r,o,o,1,s.min,s.max,t.smooth,a,t.connectNulls);rs(e,i,r+c-1,c,o,-1,l.min,l.max,t.stackedOnSmooth,a,t.connectNulls),r+=c+1,e.closePath()}}});Ta.extend({type:"line",init:function(){var e=new X_,t=new ts;this.group.add(t.group),this._symbolDraw=t,this._lineGroup=e},render:function(e,t,n){var i=e.coordinateSystem,o=this.group,a=e.getData(),s=e.getModel("lineStyle.normal"),l=e.getModel("areaStyle.normal"),c=a.mapArray(a.getItemLayout,!0),u="polar"===i.type,d=this._coordSys,h=this._symbolDraw,p=this._polyline,f=this._polygon,g=this._lineGroup,m=e.get("animation"),v=!l.isEmpty(),_=ds(i,a),y=e.get("showSymbol"),x=y&&!u&&!e.get("showAllSymbol")&&this._getSymbolIgnoreFunc(a,i),b=this._data;b&&b.eachItemGraphicEl(function(e,t){e.__temp&&(o.remove(e),b.setItemGraphicEl(t,null))}),y||h.remove(),o.add(g);var w=!u&&e.get("step");p&&d.type===i.type&&w===this._step?(v&&!f?f=this._newPolygon(c,_,i,m):f&&!v&&(g.remove(f),f=this._polygon=null),g.setClipPath(gs(i,!1,e)),y&&h.updateData(a,x),a.eachItemGraphicEl(function(e){e.stopAnimation(!0)}),ls(this._stackedOnPoints,_)&&ls(this._points,c)||(m?this._updateAnimation(a,_,i,n,w):(w&&(c=ms(c,i,w),_=ms(_,i,w)),p.setShape({points:c}),f&&f.setShape({points:c,stackedOnPoints:_})))):(y&&h.updateData(a,x),w&&(c=ms(c,i,w),_=ms(_,i,w)),p=this._newPolyline(c,i,m),v&&(f=this._newPolygon(c,_,i,m)),g.setClipPath(gs(i,!0,e)));var C=vs(a,i)||a.getVisual("color");p.useStyle(r(s.getLineStyle(),{fill:"none",stroke:C,lineJoin:"bevel"}));var S=e.get("smooth");if(S=hs(e.get("smooth")),p.setShape({smooth:S,smoothMonotone:e.get("smoothMonotone"),connectNulls:e.get("connectNulls")}),f){var T=a.stackedOn,A=0;f.useStyle(r(l.getAreaStyle(),{fill:C,opacity:.7,lineJoin:"bevel"})),T&&(A=hs(T.hostModel.get("smooth"))),f.setShape({smooth:S,stackedOnSmooth:A,smoothMonotone:e.get("smoothMonotone"),connectNulls:e.get("connectNulls")})}this._data=a,this._coordSys=i,this._stackedOnPoints=_,this._points=c,this._step=w},dispose:function(){},highlight:function(e,t,n,i){var r=e.getData(),o=Ho(r,i);if(!(o instanceof Array)&&null!=o&&o>=0){var a=r.getItemGraphicEl(o);if(!a){var s=r.getItemLayout(o);if(!s)return;(a=new Jr(r,o)).position=s,a.setZ(e.get("zlevel"),e.get("z")),a.ignore=isNaN(s[0])||isNaN(s[1]),a.__temp=!0,r.setItemGraphicEl(o,a),a.stopSymbolAnimation(!0),this.group.add(a)}a.highlight()}else Ta.prototype.highlight.call(this,e,t,n,i)},downplay:function(e,t,n,i){var r=e.getData(),o=Ho(r,i);if(null!=o&&o>=0){var a=r.getItemGraphicEl(o);a&&(a.__temp?(r.setItemGraphicEl(o,null),this.group.remove(a)):a.downplay())}else Ta.prototype.downplay.call(this,e,t,n,i)},_newPolyline:function(e){var t=this._polyline;return t&&this._lineGroup.remove(t),t=new dS({shape:{points:e},silent:!0,z2:10}),this._lineGroup.add(t),this._polyline=t,t},_newPolygon:function(e,t){var n=this._polygon;return n&&this._lineGroup.remove(n),n=new hS({shape:{points:e,stackedOnPoints:t},silent:!0}),this._lineGroup.add(n),this._polygon=n,n},_getSymbolIgnoreFunc:function(e,t){var n=t.getAxesByScale("ordinal")[0];if(n&&n.isLabelIgnored)return m(n.isLabelIgnored,n)},_updateAnimation:function(e,t,n,i,r){var o=this._polyline,a=this._polygon,s=e.hostModel,l=iS(this._data,e,this._stackedOnPoints,t,this._coordSys,n),c=l.current,u=l.stackedOnCurrent,d=l.next,h=l.stackedOnNext;r&&(c=ms(l.current,n,r),u=ms(l.stackedOnCurrent,n,r),d=ms(l.next,n,r),h=ms(l.stackedOnNext,n,r)),o.shape.__points=l.current,o.shape.points=c,wo(o,{shape:{points:d}},s),a&&(a.setShape({points:c,stackedOnPoints:u}),wo(a,{shape:{points:d,stackedOnPoints:h}},s));for(var p=[],f=l.status,g=0;g<f.length;g++)if("="===f[g].cmd){var m=e.getItemGraphicEl(f[g].idx1);m&&p.push({el:m,ptIdx:g})}o.animators&&o.animators.length&&o.animators[0].during(function(){for(var e=0;e<p.length;e++)p[e].el.attr("position",o.shape.__points[p[e].ptIdx])})},remove:function(e){var t=this.group,n=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),n&&n.eachItemGraphicEl(function(e,i){e.__temp&&(t.remove(e),n.setItemGraphicEl(i,null))}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._data=null}});var pS=function(e,t,n,i,r){i.eachRawSeriesByType(e,function(e){var r=e.getData(),o=e.get("symbol")||t,a=e.get("symbolSize");r.setVisual({legendSymbol:n||o,symbol:o,symbolSize:a}),i.isSeriesFiltered(e)||("function"==typeof a&&r.each(function(t){var n=e.getRawValue(t),i=e.getDataParams(t);r.setItemVisual(t,"symbolSize",a(n,i))}),r.each(function(e){var t=r.getItemModel(e),n=t.getShallow("symbol",!0),i=t.getShallow("symbolSize",!0);null!=n&&r.setItemVisual(e,"symbol",n),null!=i&&r.setItemVisual(e,"symbolSize",i)}))})},fS=function(e,t){t.eachSeriesByType(e,function(e){var t=e.getData(),n=e.coordinateSystem;if(n){for(var i=[],r=n.dimensions,o=0;o<r.length;o++)i.push(e.coordDimToDataDim(n.dimensions[o])[0]);1===i.length?t.each(i[0],function(e,i){t.setItemLayout(i,isNaN(e)?[NaN,NaN]:n.dataToPoint(e))}):2===i.length&&t.each(i,function(e,i,r){t.setItemLayout(r,isNaN(e)||isNaN(i)?[NaN,NaN]:n.dataToPoint([e,i]))},!0)}})},gS={average:function(e){for(var t=0,n=0,i=0;i<e.length;i++)isNaN(e[i])||(t+=e[i],n++);return 0===n?NaN:t/n},sum:function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n]||0;return t},max:function(e){for(var t=-1/0,n=0;n<e.length;n++)e[n]>t&&(t=e[n]);return t},min:function(e){for(var t=1/0,n=0;n<e.length;n++)e[n]<t&&(t=e[n]);return t},nearest:function(e){return e[0]}},mS=function(e,t){return Math.round(e.length/2)},vS=function(e){this._axes={},this._dimList=[],this.name=e||""};vS.prototype={constructor:vS,type:"cartesian",getAxis:function(e){return this._axes[e]},getAxes:function(){return f(this._dimList,ys,this)},getAxesByScale:function(e){return e=e.toLowerCase(),g(this.getAxes(),function(t){return t.scale.type===e})},addAxis:function(e){var t=e.dim;this._axes[t]=e,this._dimList.push(t)},dataToCoord:function(e){return this._dataCoordConvert(e,"dataToCoord")},coordToData:function(e){return this._dataCoordConvert(e,"coordToData")},_dataCoordConvert:function(e,t){for(var n=this._dimList,i=e instanceof Array?[]:{},r=0;r<n.length;r++){var o=n[r],a=this._axes[o];i[o]=a[t](e[o])}return i}},xs.prototype={constructor:xs,type:"cartesian2d",dimensions:["x","y"],getBaseAxis:function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},containPoint:function(e){var t=this.getAxis("x"),n=this.getAxis("y");return t.contain(t.toLocalCoord(e[0]))&&n.contain(n.toLocalCoord(e[1]))},containData:function(e){return this.getAxis("x").containData(e[0])&&this.getAxis("y").containData(e[1])},dataToPoint:function(e,t){var n=this.getAxis("x"),i=this.getAxis("y");return[n.toGlobalCoord(n.dataToCoord(e[0],t)),i.toGlobalCoord(i.dataToCoord(e[1],t))]},pointToData:function(e,t){var n=this.getAxis("x"),i=this.getAxis("y");return[n.coordToData(n.toLocalCoord(e[0]),t),i.coordToData(i.toLocalCoord(e[1]),t)]},getOtherAxis:function(e){return this.getAxis("x"===e.dim?"y":"x")}},h(xs,vS);var _S=function(e,t,n,i,r){jC.call(this,e,t,n),this.type=i||"value",this.position=r||"bottom"};_S.prototype={constructor:_S,index:0,onZero:!1,model:null,isHorizontal:function(){var e=this.position;return"top"===e||"bottom"===e},getGlobalExtent:function(e){var t=this.getExtent();return t[0]=this.toGlobalCoord(t[0]),t[1]=this.toGlobalCoord(t[1]),e&&t[0]>t[1]&&t.reverse(),t},getOtherAxis:function(){this.grid.getOtherAxis()},isLabelIgnored:function(e){if("category"===this.type){var t=this.getLabelInterval();return"function"==typeof t&&!t(e,this.scale.getLabel(e))||e%(t+1)}},pointToData:function(e,t){return this.coordToData(this.toLocalCoord(e["x"===this.dim?0:1]),t)},toLocalCoord:null,toGlobalCoord:null},h(_S,jC);var yS={show:!0,zlevel:0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#333",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,lineStyle:{color:["#ccc"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},xS={};xS.categoryAxis=n({boundaryGap:!0,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},yS),xS.valueAxis=n({boundaryGap:[0,0],splitNumber:5},yS),xS.timeAxis=r({scale:!0,min:"dataMin",max:"dataMax"},xS.valueAxis),xS.logAxis=r({scale:!0,logBase:10},xS.valueAxis);var bS=["value","category","time","log"],wS=function(e,t,i,r){d(bS,function(a){t.extend({type:e+"Axis."+a,mergeDefaultAndTheme:function(t,r){var o=this.layoutMode,s=o?ea(t):{};n(t,r.getTheme().get(a+"Axis")),n(t,this.getDefaultOption()),t.type=i(e,t),o&&ta(t,s,o)},defaultOption:o([{},xS[a+"Axis"],r],!0)})}),jb.registerSubTypeDefaulter(e+"Axis",v(i,e))},CS=jb.extend({type:"cartesian2dAxis",axis:null,init:function(){CS.superApply(this,"init",arguments),this.resetRange()},mergeOption:function(){CS.superApply(this,"mergeOption",arguments),this.resetRange()},restoreData:function(){CS.superApply(this,"restoreData",arguments),this.resetRange()},getCoordSysModel:function(){return this.ecModel.queryComponents({mainType:"grid",index:this.option.gridIndex,id:this.option.gridId})[0]}});n(CS.prototype,RC);var SS={offset:0};wS("x",CS,_s,SS),wS("y",CS,_s,SS),jb.extend({type:"grid",dependencies:["xAxis","yAxis"],layoutMode:"box",coordinateSystem:null,defaultOption:{show:!1,zlevel:0,z:0,left:"10%",top:60,right:"10%",bottom:60,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"}});var TS=d,AS=function(e){var t=e.scale.getExtent(),n=t[0],i=t[1];return!(n>0&&i>0||n<0&&i<0)},MS=Nr,ES=Ms.prototype;ES.type="grid",ES.axisPointerEnabled=!0,ES.getRect=function(){return this._rect},ES.update=function(e,t){var n=this._axesMap;this._updateScale(e,this.model),TS(n.x,function(e){MS(e.scale,e.model)}),TS(n.y,function(e){MS(e.scale,e.model)}),TS(n.x,function(e){Is(n,"y",e)}),TS(n.y,function(e){Is(n,"x",e)}),this.resize(this.model,t)},ES.resize=function(e,t,i){function n(){TS(o,function(e){var t=e.isHorizontal(),n=t?[0,r.width]:[0,r.height],i=e.inverse?1:0;e.setExtent(n[i],n[1-i]),As(e,t?r.x:r.y)})}var r=Ko(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()});this._rect=r;var o=this._axesList;n(),!i&&e.get("containLabel")&&(TS(o,function(e){if(!e.model.get("axisLabel.inside")){var t=Ss(e);if(t){var n=e.isHorizontal()?"height":"width",i=e.model.get("axisLabel.margin");r[n]-=t[n]+i,"top"===e.position?r.y+=t.height+i:"left"===e.position&&(r.x+=t.width+i)}}}),n())},ES.getAxis=function(e,t){var n=this._axesMap[e];if(null!=n){if(null==t)for(var i in n)if(n.hasOwnProperty(i))return n[i];return n[t]}},ES.getAxes=function(){return this._axesList.slice()},ES.getCartesian=function(e,t){if(null!=e&&null!=t){var n="x"+e+"y"+t;return this._coordsMap[n]}b(e)&&(t=e.yAxisIndex,e=e.xAxisIndex);for(var i=0,r=this._coordsList;i<r.length;i++)if(r[i].getAxis("x").index===e||r[i].getAxis("y").index===t)return r[i]},ES.getCartesians=function(){return this._coordsList.slice()},ES.convertToPixel=function(e,t,n){var i=this._findConvertTarget(e,t);return i.cartesian?i.cartesian.dataToPoint(n):i.axis?i.axis.toGlobalCoord(i.axis.dataToCoord(n)):null},ES.convertFromPixel=function(e,t,n){var i=this._findConvertTarget(e,t);return i.cartesian?i.cartesian.pointToData(n):i.axis?i.axis.coordToData(i.axis.toLocalCoord(n)):null},ES._findConvertTarget=function(e,t){var n,i,r=t.seriesModel,o=t.xAxisModel||r&&r.getReferringComponents("xAxis")[0],a=t.yAxisModel||r&&r.getReferringComponents("yAxis")[0],s=t.gridModel,c=this._coordsList;return r?l(c,n=r.coordinateSystem)<0&&(n=null):o&&a?n=this.getCartesian(o.componentIndex,a.componentIndex):o?i=this.getAxis("x",o.componentIndex):a?i=this.getAxis("y",a.componentIndex):s&&s.coordinateSystem===this&&(n=this._coordsList[0]),{cartesian:n,axis:i}},ES.containPoint=function(e){var t=this._coordsList[0];if(t)return t.containPoint(e)},ES._initCartesian=function(e,t,i){function n(n){return function(i,s){if(bs(i,e,t)){var l=i.get("position");"x"===n?"top"!==l&&"bottom"!==l&&r[l="bottom"]&&(l="top"===l?"bottom":"top"):"left"!==l&&"right"!==l&&r[l="left"]&&(l="left"===l?"right":"left"),r[l]=!0;var c=new _S(n,Er(i),[0,0],i.get("type"),l),u="category"===c.type;c.onBand=u&&i.get("boundaryGap"),c.inverse=i.get("inverse"),c.onZero=i.get("axisLine.onZero"),c.onZeroAxisIndex=i.get("axisLine.onZeroAxisIndex"),i.axis=c,c.model=i,c.grid=this,c.index=s,this._axesList.push(c),o[n][s]=c,a[n]++}}}var r={left:!1,right:!1,top:!1,bottom:!1},o={x:{},y:{}},a={x:0,y:0};if(t.eachComponent("xAxis",n("x"),this),t.eachComponent("yAxis",n("y"),this),!a.x||!a.y)return this._axesMap={},void(this._axesList=[]);this._axesMap=o,TS(o.x,function(t,n){TS(o.y,function(i,r){var o="x"+n+"y"+r,a=new xs(o);a.grid=this,a.model=e,this._coordsMap[o]=a,this._coordsList.push(a),a.addAxis(t),a.addAxis(i)},this)},this)},ES._updateScale=function(e,t){function i(e,t,n){TS(n.coordDimToDataDim(t.dim),function(n){t.scale.unionExtentFromData(e,n)})}d(this._axesList,function(e){e.scale.setExtent(1/0,-1/0)}),e.eachSeries(function(n){if(Ds(n)){var r=Cs(n),o=r[0],a=r[1];if(!bs(o,t,e)||!bs(a,t,e))return;var s=this.getCartesian(o.componentIndex,a.componentIndex),l=n.getData(),c=s.getAxis("x"),u=s.getAxis("y");"list"===l.type&&(i(l,c,n),i(l,u,n))}},this)},ES.getTooltipAxes=function(e){var t=[],n=[];return TS(this.getCartesians(),function(i){var r=null!=e&&"auto"!==e?i.getAxis(e):i.getBaseAxis(),o=i.getOtherAxis(r);l(t,r)<0&&t.push(r),l(n,o)<0&&n.push(o)}),{baseAxes:t,otherAxes:n}};var IS=["xAxis","yAxis"];Ms.create=function(e,t){var n=[];return e.eachComponent("grid",function(i,r){var o=new Ms(i,e,t);o.name="grid_"+r,o.resize(i,t,!0),i.coordinateSystem=o,n.push(o)}),e.eachSeries(function(e){if(Ds(e)){var t=Cs(e),n=t[0],i=t[1],r=n.getCoordSysModel().coordinateSystem;e.coordinateSystem=r.getCartesian(n.componentIndex,i.componentIndex)}}),n},Ms.dimensions=Ms.prototype.dimensions=xs.prototype.dimensions,ua.register("cartesian2d",Ms);var DS=Math.PI,kS=function(e,t){this.opt=t,this.axisModel=e,r(t,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0}),this.group=new X_;var n=new X_({position:t.position.slice(),rotation:t.rotation});n.updateTransform(),this._transform=n.transform,this._dumbGroup=n};kS.prototype={constructor:kS,hasBuilder:function(e){return!!LS[e]},add:function(e){LS[e].call(this)},getGroup:function(){return this.group}};var LS={axisLine:function(){var e=this.opt,t=this.axisModel;if(t.get("axisLine.show")){var n=this.axisModel.axis.getExtent(),i=this._transform,r=[n[0],0],o=[n[1],0];i&&($(r,r,i),$(o,o,i));var s=a({lineCap:"round"},t.getModel("axisLine.lineStyle").getLineStyle());this.group.add(new gb(Yn({anid:"line",shape:{x1:r[0],y1:r[1],x2:o[0],y2:o[1]},style:s,strokeContainThreshold:e.strokeContainThreshold||5,silent:!0,z2:1})));var l=t.get("axisLine.symbol"),c=t.get("axisLine.symbolSize");if(null!=l){"string"==typeof l&&(l=[l,l]),"string"!=typeof c&&"number"!=typeof c||(c=[c,c]);var u=c[0],h=c[1];d([[e.rotation+Math.PI/2,r],[e.rotation-Math.PI/2,o]],function(e,t){if("none"!==l[t]&&null!=l[t]){var n=Hr(l[t],-u/2,-h/2,u,h,s.stroke,!0);n.attr({rotation:e[0],position:e[1],silent:!0}),this.group.add(n)}},this)}}},axisTickLabel:function(){var e=this.axisModel,t=this.opt,n=Rs(this,e,t);Os(e,Vs(this,e,t),n)},axisName:function(){var e=this.opt,t=this.axisModel,n=I(e.axisName,t.get("name"));if(n){var i,r=t.get("nameLocation"),o=e.nameDirection,s=t.getModel("nameTextStyle"),l=t.get("nameGap")||0,c=this.axisModel.axis.getExtent(),u=c[0]>c[1]?-1:1,d=["start"===r?c[0]-u*l:"end"===r?c[1]+u*l:(c[0]+c[1])/2,Es(r)?e.labelOffset+o*l:0],h=t.get("nameRotate");null!=h&&(h=h*DS/180);var p;Es(r)?i=NS(e.rotation,null!=h?h:e.rotation,o):(i=ks(e,r,h||0,c),null!=(p=e.axisNameAvailableWidth)&&(p=Math.abs(p/Math.sin(i.rotation)),!isFinite(p)&&(p=null)));var f=s.getFont(),g=t.get("nameTruncate",!0)||{},m=g.ellipsis,v=I(e.nameTruncateMaxWidth,g.maxWidth,p),_=null!=m&&null!=v?qy(n,v,f,m,{minChar:2,placeholder:g.placeholder}):n,y=t.get("tooltip",!0),x=t.mainType,b={componentType:x,name:n,$vars:["name"]};b[x+"Index"]=t.componentIndex;var w=new rb({anid:"name",__fullText:n,__truncatedText:_,position:d,rotation:i.rotation,silent:Ps(t),z2:1,tooltip:y&&y.show?a({content:n,formatter:function(){return n},formatterParams:b},y):null});fo(w.style,s,{text:_,textFont:f,textFill:s.getTextColor()||t.get("axisLine.lineStyle.color"),textAlign:i.textAlign,textVerticalAlign:i.textVerticalAlign}),t.get("triggerEvent")&&(w.eventData=Ls(t),w.eventData.targetType="axisName",w.eventData.name=n),this._dumbGroup.add(w),w.updateTransform(),this.group.add(w),w.decomposeTransform()}}},NS=kS.innerTextLayout=function(e,t,n){var i,r,o=Li(t-e);return ki(o)?(r=n>0?"top":"bottom",i="center"):ki(o-DS)?(r=n>0?"bottom":"top",i="center"):(r="middle",i=o>0&&o<DS?n>0?"right":"left":n>0?"left":"right"),{rotation:o,textAlign:i,textVerticalAlign:r}},PS=kS.ifIgnoreOnTick=function(e,t,n,i,r,o){if(0===t&&r||t===i-1&&o)return!1;var a,s=e.scale;return"ordinal"===s.type&&("function"==typeof n?(a=s.getTicks()[t],!n(a,s.getLabel(a))):t%(n+1))},OS=kS.getInterval=function(e,t){var n=e.get("interval");return null!=n&&"auto"!=n||(n=t),n},RS=d,zS=v,FS=lr({type:"axis",_axisPointer:null,axisPointerClass:null,render:function(e,t,n,i){this.axisPointerClass&&Us(e),FS.superApply(this,"render",arguments),$s(this,e,0,n,0,!0)},updateAxisPointer:function(e,t,n,i,r){$s(this,e,0,n,0,!1)},remove:function(e,t){var n=this._axisPointer;n&&n.remove(t),FS.superApply(this,"remove",arguments)},dispose:function(e,t){Ks(this,t),FS.superApply(this,"dispose",arguments)}}),BS=[];FS.registerAxisPointerClass=function(e,t){BS[e]=t},FS.getAxisPointerClass=function(e){return e&&BS[e]};var HS=kS.ifIgnoreOnTick,VS=kS.getInterval,WS=["axisLine","axisTickLabel","axisName"],US=["splitArea","splitLine"],$S=FS.extend({type:"cartesianAxis",axisPointerClass:"CartesianAxisPointer",render:function(e,t,n,i){this.group.removeAll();var r=this._axisGroup;if(this._axisGroup=new X_,this.group.add(this._axisGroup),e.get("show")){var o=e.getCoordSysModel(),a=Js(o,e),s=new kS(e,a);d(WS,s.add,s),this._axisGroup.add(s.getGroup()),d(US,function(t){e.get(t+".show")&&this["_"+t](e,o,a.labelInterval)},this),Ao(r,this._axisGroup,e),$S.superCall(this,"render",e,t,n,i)}},_splitLine:function(e,t,n){var i=e.axis;if(!i.scale.isBlank()){var o=e.getModel("splitLine"),a=o.getModel("lineStyle"),s=a.get("color"),l=VS(o,n);s=y(s)?s:[s];for(var c=t.coordinateSystem.getRect(),u=i.isHorizontal(),d=0,h=i.getTicksCoords(),p=i.scale.getTicks(),f=e.get("axisLabel.showMinLabel"),g=e.get("axisLabel.showMaxLabel"),m=[],v=[],_=a.getLineStyle(),x=0;x<h.length;x++)if(!HS(i,x,l,h.length,f,g)){var b=i.toGlobalCoord(h[x]);u?(m[0]=b,m[1]=c.y,v[0]=b,v[1]=c.y+c.height):(m[0]=c.x,m[1]=b,v[0]=c.x+c.width,v[1]=b);var w=d++%s.length;this._axisGroup.add(new gb(Yn({anid:"line_"+p[x],shape:{x1:m[0],y1:m[1],x2:v[0],y2:v[1]},style:r({stroke:s[w]},_),silent:!0})))}}},_splitArea:function(e,t,n){var i=e.axis;if(!i.scale.isBlank()){var o=e.getModel("splitArea"),a=o.getModel("areaStyle"),s=a.get("color"),l=t.coordinateSystem.getRect(),c=i.getTicksCoords(),u=i.scale.getTicks(),d=i.toGlobalCoord(c[0]),h=i.toGlobalCoord(c[0]),p=0,f=VS(o,n),g=a.getAreaStyle();s=y(s)?s:[s];for(var m=e.get("axisLabel.showMinLabel"),v=e.get("axisLabel.showMaxLabel"),_=1;_<c.length;_++)if(!HS(i,_,f,c.length,m,v)){var x,b,w,C,S=i.toGlobalCoord(c[_]);i.isHorizontal()?(x=d,b=l.y,w=S-x,C=l.height):(x=l.x,b=h,w=l.width,C=S-b);var T=p++%s.length;this._axisGroup.add(new fb({anid:"area_"+u[_],shape:{x:x,y:b,width:w,height:C},style:r({fill:s[T]},g),silent:!0})),d=x+w,h=b+C}}}});$S.extend({type:"xAxis"}),$S.extend({type:"yAxis"}),lr({type:"grid",render:function(e,t){this.group.removeAll(),e.get("show")&&this.group.add(new fb({shape:e.coordinateSystem.getRect(),style:r({fill:e.get("backgroundColor")},e.getItemStyle()),silent:!0,z2:-1}))}}),tr(function(e){e.xAxis&&e.yAxis&&!e.grid&&(e.grid={})}),ar(v(pS,"line","circle","line")),or(v(fS,"line")),er(Pw.PROCESSOR.STATISTIC,v(function(e,t,n){t.eachSeriesByType(e,function(e){var t=e.getData(),n=e.get("sampling"),i=e.coordinateSystem;if("cartesian2d"===i.type&&n){var r=i.getBaseAxis(),o=i.getOtherAxis(r),a=r.getExtent(),s=a[1]-a[0],l=Math.round(t.count()/s);if(l>1){var c;"string"==typeof n?c=gS[n]:"function"==typeof n&&(c=n),c&&(t=t.downSample(o.dim,1/l,c,mS),e.setData(t))}}},this)},"line"));var GS="__ec_stack_";nl.getLayoutOnAxis=function(e,t){var n=[],i=e.axis;if("category"===i.type){for(var o=i.getBandWidth(),a=0;a<e.count;a++)n.push(r({bandWidth:o,axisKey:"axis0",stackId:GS+a},e));for(var s=il(n),l=[],a=0;a<e.count;a++){var c=s.axis0[GS+a];c.offsetCenter=c.offset+c.width/2,l.push(c)}return l}};var qS=xw.extend({type:"series.__base_bar__",getInitialData:function(e,t){return Sr(e.data,this,t)},getMarkerPosition:function(e){var t=this.coordinateSystem;if(t){var n=t.dataToPoint(e,!0),i=this.getData(),r=i.getLayout("offset"),o=i.getLayout("size");return n[t.getBaseAxis().isHorizontal()?0:1]+=r+o/2,n}return[NaN,NaN]},defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,itemStyle:{}}});qS.extend({type:"series.bar",dependencies:["grid","polar"],brushSelector:"rect"});var jS=Jy([["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["stroke","barBorderColor"],["lineWidth","barBorderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),YS={getBarItemStyle:function(e){var t=jS(this,e);if(this.getBorderLineDash){var n=this.getBorderLineDash();n&&(t.lineDash=n)}return t}},XS=["itemStyle","normal","barBorderWidth"];a(Lo.prototype,YS),ur({type:"bar",render:function(e,t,n){var i=e.get("coordinateSystem");return"cartesian2d"!==i&&"polar"!==i||this._render(e,t,n),this.group},dispose:N,_render:function(e,t,n){var i,r=this.group,o=e.getData(),a=this._data,s=e.coordinateSystem,l=s.getBaseAxis();"cartesian2d"===s.type?i=l.isHorizontal():"polar"===s.type&&(i="angle"===l.dim);var c=e.isAnimationEnabled()?e:null;o.diff(a).add(function(t){if(o.hasValue(t)){var n=o.getItemModel(t),a=KS[s.type](o,t,n),l=ZS[s.type](o,t,n,a,i,c);o.setItemGraphicEl(t,l),r.add(l),ll(l,o,t,n,a,e,i,"polar"===s.type)}}).update(function(t,n){var l=a.getItemGraphicEl(n);if(o.hasValue(t)){var u=o.getItemModel(t),d=KS[s.type](o,t,u);l?wo(l,{shape:d},c,t):l=ZS[s.type](o,t,u,d,i,c,!0),o.setItemGraphicEl(t,l),r.add(l),ll(l,o,t,u,d,e,i,"polar"===s.type)}else r.remove(l)}).remove(function(e){var t=a.getItemGraphicEl(e);"cartesian2d"===s.type?t&&rl(e,c,t):t&&sl(e,c,t)}).execute(),this._data=o},remove:function(e,t){var n=this.group,i=this._data;e.get("animation")?i&&i.eachItemGraphicEl(function(t){"sector"===t.type?sl(t.dataIndex,e,t):rl(t.dataIndex,e,t)}):n.removeAll()}});var ZS={cartesian2d:function(e,t,n,i,r,o,s){var l=new fb({shape:a({},i)});if(o){var c=l.shape,u=r?"height":"width",d={};c[u]=0,d[u]=i[u],Eb[s?"updateProps":"initProps"](l,{shape:d},o,t)}return l},polar:function(e,t,n,i,r,o,s){var l=new lb({shape:a({},i)});if(o){var c=l.shape,u=r?"r":"endAngle",d={};c[u]=r?0:i.startAngle,d[u]=i[u],Eb[s?"updateProps":"initProps"](l,{shape:d},o,t)}return l}},KS={cartesian2d:function(e,t,n){var i=e.getItemLayout(t),r=hl(n,i),o=i.width>0?1:-1,a=i.height>0?1:-1;return{x:i.x+o*r/2,y:i.y+a*r/2,width:i.width-o*r,height:i.height-a*r}},polar:function(e,t,n){var i=e.getItemLayout(t);return{cx:i.cx,cy:i.cy,r0:i.r0,r:i.r,startAngle:i.startAngle,endAngle:i.endAngle}}};or(v(nl,"bar")),ar(function(e){e.eachSeriesByType("bar",function(e){e.getData().setVisual("legendSymbol","roundRect")})});var JS={updateSelectedMap:function(e){this._targetList=e.slice(),this._selectTargetMap=p(e||[],function(e,t){return e.set(t.name,t),e},z())},select:function(e,t){var n=null!=t?this._targetList[t]:this._selectTargetMap.get(e);"single"===this.get("selectedMode")&&this._selectTargetMap.each(function(e){e.selected=!1}),n&&(n.selected=!0)},unSelect:function(e,t){var n=null!=t?this._targetList[t]:this._selectTargetMap.get(e);n&&(n.selected=!1)},toggleSelected:function(e,t){var n=null!=t?this._targetList[t]:this._selectTargetMap.get(e);if(null!=n)return this[n.selected?"unSelect":"select"](e,t),n.selected},isSelected:function(e,t){var n=null!=t?this._targetList[t]:this._selectTargetMap.get(e);return n&&n.selected}},QS=hr({type:"series.pie",init:function(e){QS.superApply(this,"init",arguments),this.legendDataProvider=function(){return this.getRawData()},this.updateSelectedMap(e.data),this._defaultLabelLine(e)},mergeOption:function(e){QS.superCall(this,"mergeOption",e),this.updateSelectedMap(this.option.data)},getInitialData:function(e,t){var n=xr(["value"],e.data),i=new sC(n,this);return i.initData(e.data),i},getDataParams:function(e){var t=this.getData(),n=QS.superCall(this,"getDataParams",e),i=[];return t.each("value",function(e){i.push(e)}),n.percent=Di(i,e,t.hostModel.get("percentPrecision")),n.$vars.push("percent"),n},_defaultLabelLine:function(e){zo(e.labelLine,["show"]);var t=e.labelLine.normal,n=e.labelLine.emphasis;t.show=t.show&&e.label.normal.show,n.show=n.show&&e.label.emphasis.show},defaultOption:{zlevel:0,z:2,legendHoverLink:!0,hoverAnimation:!0,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,selectedOffset:10,hoverOffset:10,avoidLabelOverlap:!0,percentPrecision:2,stillShowZeroSum:!0,label:{normal:{rotate:!1,show:!0,position:"outer"},emphasis:{}},labelLine:{normal:{show:!0,length:15,length2:15,smooth:!1,lineStyle:{width:1,type:"solid"}}},itemStyle:{normal:{borderWidth:1},emphasis:{}},animationType:"expansion",animationEasing:"cubicOut",data:[]}});u(QS,JS);var eT=dl.prototype;eT.updateData=function(e,t,i){function n(){s.stopAnimation(!0),s.animateTo({shape:{r:u.r+l.get("hoverOffset")}},300,"elasticOut")}function o(){s.stopAnimation(!0),s.animateTo({shape:{r:u.r}},300,"elasticOut")}var s=this.childAt(0),l=e.hostModel,c=e.getItemModel(t),u=e.getItemLayout(t),d=a({},u);d.label=null,i?(s.setShape(d),"scale"===l.getShallow("animationType")?(s.shape.r=u.r0,So(s,{shape:{r:u.r}},l,t)):(s.shape.endAngle=u.startAngle,wo(s,{shape:{endAngle:u.endAngle}},l,t))):wo(s,{shape:d},l,t);var h=c.getModel("itemStyle"),p=e.getItemVisual(t,"color");s.useStyle(r({lineJoin:"bevel",fill:p},h.getModel("normal").getItemStyle())),s.hoverStyle=h.getModel("emphasis").getItemStyle();var f=c.getShallow("cursor");f&&s.attr("cursor",f),cl(this,e.getItemLayout(t),c.get("selected"),l.get("selectedOffset"),l.get("animation")),s.off("mouseover").off("mouseout").off("emphasis").off("normal"),c.get("hoverAnimation")&&l.isAnimationEnabled()&&s.on("mouseover",n).on("mouseout",o).on("emphasis",n).on("normal",o),this._updateLabel(e,t),uo(this)},eT._updateLabel=function(e,t){var n=this.childAt(1),i=this.childAt(2),r=e.hostModel,o=e.getItemModel(t),a=e.getItemLayout(t).label,s=e.getItemVisual(t,"color");wo(n,{shape:{points:a.linePoints||[[a.x,a.y],[a.x,a.y],[a.x,a.y]]}},r,t),wo(i,{style:{x:a.x,y:a.y}},r,t),i.attr({rotation:a.rotation,origin:[a.x,a.y],z2:10});var l=o.getModel("label.normal"),c=o.getModel("label.emphasis"),u=o.getModel("labelLine.normal"),d=o.getModel("labelLine.emphasis"),s=e.getItemVisual(t,"color");co(i.style,i.hoverStyle={},l,c,{labelFetcher:e.hostModel,labelDataIndex:t,defaultText:e.getName(t),autoColor:s,useInsideStyle:!!a.inside},{textAlign:a.textAlign,textVerticalAlign:a.verticalAlign,opacity:e.getItemVisual(t,"opacity")}),i.ignore=i.normalIgnore=!l.get("show"),i.hoverIgnore=!c.get("show"),n.ignore=n.normalIgnore=!u.get("show"),n.hoverIgnore=!d.get("show"),n.setStyle({stroke:s,opacity:e.getItemVisual(t,"opacity")}),n.setStyle(u.getModel("lineStyle").getLineStyle()),n.hoverStyle=d.getModel("lineStyle").getLineStyle();var h=u.get("smooth");h&&!0===h&&(h=.4),n.setShape({smooth:h})},h(dl,X_),Ta.extend({type:"pie",init:function(){var e=new X_;this._sectorGroup=e},render:function(e,t,n,i){if(!i||i.from!==this.uid){var r=e.getData(),o=this._data,a=this.group,s=t.get("animation"),l=!o,c=e.get("animationType"),u=v(ul,this.uid,e,s,n),d=e.get("selectedMode");if(r.diff(o).add(function(e){var t=new dl(r,e);l&&"scale"!==c&&t.eachChild(function(e){e.stopAnimation(!0)}),d&&t.on("click",u),r.setItemGraphicEl(e,t),a.add(t)}).update(function(e,t){var n=o.getItemGraphicEl(t);n.updateData(r,e),n.off("click"),d&&n.on("click",u),a.add(n),r.setItemGraphicEl(e,n)}).remove(function(e){var t=o.getItemGraphicEl(e);a.remove(t)}).execute(),s&&l&&r.count()>0&&"scale"!==c){var h=r.getItemLayout(0),p=Math.max(n.getWidth(),n.getHeight())/2,f=m(a.removeClipPath,a);a.setClipPath(this._createClipPath(h.cx,h.cy,p,h.startAngle,h.clockwise,f,e))}this._data=r}},dispose:function(){},_createClipPath:function(e,t,n,i,r,o,a){var s=new lb({shape:{cx:e,cy:t,r0:0,r:n,startAngle:i,endAngle:i,clockwise:r}});return So(s,{shape:{endAngle:i+(r?1:-1)*Math.PI*2}},a,o),s},containPoint:function(e,t){var n=t.getData().getItemLayout(0);if(n){var i=e[0]-n.cx,r=e[1]-n.cy,o=Math.sqrt(i*i+r*r);return o<=n.r&&o>=n.r0}}});var tT=function(e,t){d(t,function(t){t.update="updateView",ir(t,function(n,i){var r={};return i.eachComponent({mainType:"series",subType:e,query:n},function(e){e[t.method]&&e[t.method](n.name,n.dataIndex);var i=e.getData();i.each(function(t){var n=i.getName(t);r[n]=e.isSelected(n)||!1})}),{name:n.name,selected:r}})})},nT=function(e,t){var n={};t.eachRawSeriesByType(e,function(e){var i=e.getRawData(),r={};if(!t.isSeriesFiltered(e)){var o=e.getData();o.each(function(e){var t=o.getRawIndex(e);r[t]=e}),i.each(function(t){var a=r[t],s=null!=a&&o.getItemVisual(a,"color",!0);if(s)i.setItemVisual(t,"color",s);else{var l=i.getItemModel(t).get("itemStyle.normal.color")||e.getColorFromPalette(i.getName(t),n);i.setItemVisual(t,"color",l),null!=a&&o.setItemVisual(a,"color",l)}})}})},iT=function(e,t,n,i){var r,o,a=e.getData(),s=[],l=!1;a.each(function(n){var i,c,u,d,h=a.getItemLayout(n),p=a.getItemModel(n),f=p.getModel("label.normal"),g=f.get("position")||p.get("label.emphasis.position"),m=p.getModel("labelLine.normal"),v=m.get("length"),_=m.get("length2"),y=(h.startAngle+h.endAngle)/2,x=Math.cos(y),b=Math.sin(y);r=h.cx,o=h.cy;var w="inside"===g||"inner"===g;if("center"===g)i=h.cx,c=h.cy,d="center";else{var C=(w?(h.r+h.r0)/2*x:h.r*x)+r,S=(w?(h.r+h.r0)/2*b:h.r*b)+o;if(i=C+3*x,c=S+3*b,!w){var T=C+x*(v+t-h.r),A=S+b*(v+t-h.r),M=T+(x<0?-1:1)*_,E=A;i=M+(x<0?-5:5),c=E,u=[[C,S],[T,A],[M,E]]}d=w?"center":x>0?"left":"right"}var I=f.getFont(),D=f.get("rotate")?x<0?-y+Math.PI:-y:0,k=de(e.getFormattedLabel(n,"normal")||a.getName(n),I,d,"top");l=!!D,h.label={x:i,y:c,position:g,height:k.height,len:v,len2:_,linePoints:u,textAlign:d,verticalAlign:"middle",rotation:D,inside:w},w||s.push(h.label)}),!l&&e.get("avoidLabelOverlap")&&pl(s,r,o,t,n,i)},rT=2*Math.PI,oT=Math.PI/180,aT=function(e,t){var n=t.findComponents({mainType:"legend"});n&&n.length&&t.eachSeriesByType(e,function(e){var t=e.getData();t.filterSelf(function(e){for(var i=t.getName(e),r=0;r<n.length;r++)if(!n[r].isSelected(i))return!1;return!0},this)},this)};tT("pie",[{type:"pieToggleSelect",event:"pieselectchanged",method:"toggleSelected"},{type:"pieSelect",event:"pieselected",method:"select"},{type:"pieUnSelect",event:"pieunselected",method:"unSelect"}]),ar(v(nT,"pie")),or(v(function(e,t,n,i){t.eachSeriesByType(e,function(e){var t=e.get("center"),i=e.get("radius");y(i)||(i=[0,i]),y(t)||(t=[t,t]);var r=n.getWidth(),o=n.getHeight(),a=Math.min(r,o),s=Si(t[0],r),l=Si(t[1],o),c=Si(i[0],a/2),u=Si(i[1],a/2),d=e.getData(),h=-e.get("startAngle")*oT,p=e.get("minAngle")*oT,f=0;d.each("value",function(e){!isNaN(e)&&f++});var g=d.getSum("value"),m=Math.PI/(g||f)*2,v=e.get("clockwise"),_=e.get("roseType"),x=e.get("stillShowZeroSum"),b=d.getDataExtent("value");b[0]=0;var w=rT,C=0,S=h,T=v?1:-1;if(d.each("value",function(e,t){var n;if(isNaN(e))d.setItemLayout(t,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:v,cx:s,cy:l,r0:c,r:_?NaN:u});else{(n="area"!==_?0===g&&x?m:e*m:rT/f)<p?(n=p,w-=p):C+=e;var i=S+T*n;d.setItemLayout(t,{angle:n,startAngle:S,endAngle:i,clockwise:v,cx:s,cy:l,r0:c,r:_?wi(e,b,[c,u]):u}),S=i}},!0),w<rT&&f)if(w<=.001){var A=rT/f;d.each("value",function(e,t){if(!isNaN(e)){var n=d.getItemLayout(t);n.angle=A,n.startAngle=h+T*t*A,n.endAngle=h+T*(t+1)*A}})}else m=w/C,S=h,d.each("value",function(e,t){if(!isNaN(e)){var n=d.getItemLayout(t),i=n.angle===p?p:e*m;n.startAngle=S,n.endAngle=S+T*i,S+=T*i}});iT(e,u,r,o)})},"pie")),er(v(aT,"pie")),xw.extend({type:"series.scatter",dependencies:["grid","polar","geo","singleAxis","calendar"],getInitialData:function(e,t){return Sr(e.data,this,t)},brushSelector:"point",defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,hoverAnimation:!0,symbolSize:10,large:!1,largeThreshold:2e3,itemStyle:{normal:{opacity:.8}}}});var sT=Zn({shape:{points:null,sizes:null},symbolProxy:null,buildPath:function(e,t){for(var n=t.points,i=t.sizes,r=this.symbolProxy,o=r.shape,a=0;a<n.length;a++){var s=n[a];if(!isNaN(s[0])&&!isNaN(s[1])){var l=i[a];l[0]<4?e.rect(s[0]-l[0]/2,s[1]-l[1]/2,l[0],l[1]):(o.x=s[0]-l[0]/2,o.y=s[1]-l[1]/2,o.width=l[0],o.height=l[1],r.buildPath(e,o,!0))}}},findDataIndex:function(e,t){for(var n=this.shape,i=n.points,r=n.sizes,o=i.length-1;o>=0;o--){var a=i[o],s=r[o],l=a[0]-s[0]/2,c=a[1]-s[1]/2;if(e>=l&&t>=c&&e<=l+s[0]&&t<=c+s[1])return o}return-1}}),lT=gl.prototype;lT.updateData=function(e){this.group.removeAll();var t=this._symbolEl,n=e.hostModel;t.setShape({points:e.mapArray(e.getItemLayout),sizes:e.mapArray(function(t){var n=e.getItemVisual(t,"symbolSize");return n instanceof Array||(n=[n,n]),n})}),t.symbolProxy=Hr(e.getVisual("symbol"),0,0,0,0),t.setColor=t.symbolProxy.setColor,t.useStyle(n.getModel("itemStyle.normal").getItemStyle(["color"]));var i=e.getVisual("color");i&&t.setColor(i),t.seriesIndex=n.seriesIndex,t.on("mousemove",function(e){t.dataIndex=null;var n=t.findDataIndex(e.offsetX,e.offsetY);n>=0&&(t.dataIndex=n)}),this.group.add(t)},lT.updateLayout=function(e){var t=e.getData();this._symbolEl.setShape({points:t.mapArray(t.getItemLayout)})},lT.remove=function(){this.group.removeAll()},ur({type:"scatter",init:function(){this._normalSymbolDraw=new ts,this._largeSymbolDraw=new gl},render:function(e,t,n){var i=e.getData(),r=this._largeSymbolDraw,o=this._normalSymbolDraw,a=this.group,s=e.get("large")&&i.count()>e.get("largeThreshold")?r:o;this._symbolDraw=s,s.updateData(i),a.add(s.group),a.remove(s===r?o.group:r.group)},updateLayout:function(e){this._symbolDraw.updateLayout(e)},remove:function(e,t){this._symbolDraw&&this._symbolDraw.remove(t,!0)},dispose:function(){}}),ar(v(pS,"scatter","circle",null)),or(v(fS,"scatter")),h(ml,jC),vl.prototype.getIndicatorAxes=function(){return this._indicatorAxes},vl.prototype.dataToPoint=function(e,t){var n=this._indicatorAxes[t];return this.coordToPoint(n.dataToCoord(e),t)},vl.prototype.coordToPoint=function(e,t){var n=this._indicatorAxes[t].angle;return[this.cx+e*Math.cos(n),this.cy-e*Math.sin(n)]},vl.prototype.pointToData=function(e){var t=e[0]-this.cx,n=e[1]-this.cy,i=Math.sqrt(t*t+n*n);t/=i,n/=i;for(var r,o=Math.atan2(-n,t),a=1/0,s=-1,l=0;l<this._indicatorAxes.length;l++){var c=this._indicatorAxes[l],u=Math.abs(o-c.angle);u<a&&(r=c,s=l,a=u)}return[s,+(r&&r.coodToData(i))]},vl.prototype.resize=function(e,t){var n=e.get("center"),i=t.getWidth(),r=t.getHeight(),o=Math.min(i,r)/2;this.cx=Si(n[0],i),this.cy=Si(n[1],r),this.startAngle=e.get("startAngle")*Math.PI/180,this.r=Si(e.get("radius"),o),d(this._indicatorAxes,function(e,t){e.setExtent(0,this.r);var n=this.startAngle+t*Math.PI*2/this._indicatorAxes.length;n=Math.atan2(Math.sin(n),Math.cos(n)),e.angle=n},this)},vl.prototype.update=function(e,t){function i(e){var t=Math.pow(10,Math.floor(Math.log(e)/Math.LN10)),n=e/t;return 2===n?n=5:n*=2,n*t}var n=this._indicatorAxes,r=this._model;d(n,function(e){e.scale.setExtent(1/0,-1/0)}),e.eachSeriesByType("radar",function(t,i){if("radar"===t.get("coordinateSystem")&&e.getComponent("radar",t.get("radarIndex"))===r){var o=t.getData();d(n,function(e){e.scale.unionExtentFromData(o,e.dim)})}},this);var o=r.get("splitNumber");d(n,function(e,t){var n=zr(e.scale,e.model);Nr(e.scale,e.model);var r=e.model,a=e.scale,s=r.getMin(),l=r.getMax(),c=a.getInterval();if(null!=s&&null!=l)a.setExtent(+s,+l),a.setInterval((l-s)/o);else if(null!=s){var u;do{u=s+c*o,a.setExtent(+s,u),a.setInterval(c),c=i(c)}while(u<n[1]&&isFinite(u)&&isFinite(n[1]))}else if(null!=l){var d;do{d=l-c*o,a.setExtent(d,+l),a.setInterval(c),c=i(c)}while(d>n[0]&&isFinite(d)&&isFinite(n[0]))}else{a.getTicks().length-1>o&&(c=i(c));var h=Math.round((n[0]+n[1])/2/c)*c,p=Math.round(o/2);a.setExtent(Mi(h-p*c),Mi(h+(o-p)*c)),a.setInterval(c)}})},vl.dimensions=[],vl.create=function(e,t){var n=[];return e.eachComponent("radar",function(i){var r=new vl(i,e,t);n.push(r),i.coordinateSystem=r}),e.eachSeriesByType("radar",function(e){"radar"===e.get("coordinateSystem")&&(e.coordinateSystem=n[e.get("radarIndex")||0])}),n},ua.register("radar",vl);var cT=xS.valueAxis,uT=(sr({type:"radar",optionUpdated:function(){var e=this.get("boundaryGap"),t=this.get("splitNumber"),o=this.get("scale"),s=this.get("axisLine"),l=this.get("axisTick"),c=this.get("axisLabel"),u=this.get("name"),d=this.get("name.show"),h=this.get("name.formatter"),p=this.get("nameGap"),g=this.get("triggerEvent"),m=f(this.get("indicator")||[],function(f){null!=f.max&&f.max>0&&!f.min?f.min=0:null!=f.min&&f.min<0&&!f.max&&(f.max=0);var m=u;if(null!=f.color&&(m=r({color:f.color},u)),f=n(i(f),{boundaryGap:e,splitNumber:t,scale:o,axisLine:s,axisTick:l,axisLabel:c,name:f.text,nameLocation:"end",nameGap:p,nameTextStyle:m,triggerEvent:g},!1),d||(f.name=""),"string"==typeof h){var v=f.name;f.name=h.replace("{value}",null!=v?v:"")}else"function"==typeof h&&(f.name=h(f.name,f));var _=a(new Lo(f,null,this.ecModel),RC);return _.mainType="radar",_.componentIndex=this.componentIndex,_},this);this.getIndicatorModels=function(){return m}},defaultOption:{zlevel:0,z:0,center:["50%","50%"],radius:"75%",startAngle:90,name:{show:!0},boundaryGap:[0,0],splitNumber:5,nameGap:15,scale:!1,shape:"polygon",axisLine:n({lineStyle:{color:"#bbb"}},cT.axisLine),axisLabel:yl(cT.axisLabel,!1),axisTick:yl(cT.axisTick,!1),splitLine:yl(cT.splitLine,!0),splitArea:yl(cT.splitArea,!0),indicator:[]}}),["axisLine","axisTickLabel","axisName"]);lr({type:"radar",render:function(e,t,n){this.group.removeAll(),this._buildAxes(e),this._buildSplitLineAndArea(e)},_buildAxes:function(e){var t=e.coordinateSystem;d(f(t.getIndicatorAxes(),function(e){return new kS(e.model,{position:[t.cx,t.cy],rotation:e.angle,labelDirection:-1,tickDirection:-1,nameDirection:1})}),function(e){d(uT,e.add,e),this.group.add(e.getGroup())},this)},_buildSplitLineAndArea:function(t){function e(e,t,n){var i=n%t.length;return e[i]=e[i]||[],i}var n=t.coordinateSystem,i=n.getIndicatorAxes();if(i.length){var o=t.get("shape"),a=t.getModel("splitLine"),s=t.getModel("splitArea"),l=a.getModel("lineStyle"),c=s.getModel("areaStyle"),u=a.get("show"),h=s.get("show"),p=l.get("color"),g=c.get("color");p=y(p)?p:[p],g=y(g)?g:[g];var m=[],v=[];if("circle"===o)for(var _=i[0].getTicksCoords(),x=n.cx,b=n.cy,w=0;w<_.length;w++)u&&m[E=e(m,p,w)].push(new ob({shape:{cx:x,cy:b,r:_[w]}})),h&&w<_.length-1&&v[E=e(v,g,w)].push(new cb({shape:{cx:x,cy:b,r0:_[w],r:_[w+1]}}));else for(var C,S=f(i,function(e,t){var i=e.getTicksCoords();return C=null==C?i.length-1:Math.min(i.length-1,C),f(i,function(e){return n.coordToPoint(e,t)})}),T=[],w=0;w<=C;w++){for(var A=[],M=0;M<i.length;M++)A.push(S[M][w]);if(A[0]&&A.push(A[0].slice()),u&&m[E=e(m,p,w)].push(new pb({shape:{points:A}})),h&&T){var E=e(v,g,w-1);v[E].push(new hb({shape:{points:A.concat(T)}}))}T=A.slice().reverse()}var I=l.getLineStyle(),D=c.getAreaStyle();d(v,function(e,t){this.group.add(Mb(e,{style:r({stroke:"none",fill:g[t%g.length]},D),silent:!0}))},this),d(m,function(e,t){this.group.add(Mb(e,{style:r({fill:"none",stroke:p[t%p.length]},I),silent:!0}))},this)}}});var dT=xw.extend({type:"series.radar",dependencies:["radar"],init:function(e){dT.superApply(this,"init",arguments),this.legendDataProvider=function(){return this.getRawData()}},getInitialData:function(e,t){var n=e.data||[],i=xr([],n,{extraPrefix:"indicator_",extraFromZero:!0}),r=new sC(i,this);return r.initData(n),r},formatTooltip:function(e){var t=this.getRawValue(e),n=this.coordinateSystem.getIndicatorAxes(),i=this.getData().getName(e);return Gi(""===i?this.name:i)+"<br/>"+f(n,function(e,n){return Gi(e.name+" : "+t[n])}).join("<br />")},defaultOption:{zlevel:0,z:2,coordinateSystem:"radar",legendHoverLink:!0,radarIndex:0,lineStyle:{normal:{width:2,type:"solid"}},label:{normal:{position:"top"}},symbol:"emptyCircle",symbolSize:4}});ur({type:"radar",render:function(e,t,l){function o(e,t){var n=e.getItemVisual(t,"symbol")||"circle",i=e.getItemVisual(t,"color");if("none"!==n){var r=xl(e.getItemVisual(t,"symbolSize")),o=Hr(n,-1,-1,2,2,i);return o.attr({style:{strokeNoScale:!0},z2:100,scale:[r[0]/2,r[1]/2]}),o}}function a(t,n,i,r,a,s){i.removeAll();for(var l=0;l<n.length-1;l++){var c=o(r,a);c&&(c.__dimIdx=l,t[l]?(c.attr("position",t[l]),Eb[s?"initProps":"updateProps"](c,{position:n[l]},e,a)):c.attr("position",n[l]),i.add(c))}}function s(e){return f(e,function(e){return[c.cx,c.cy]})}var c=e.coordinateSystem,u=this.group,d=e.getData(),h=this._data;d.diff(h).add(function(t){var n=d.getItemLayout(t);if(n){var i=new hb,r=new pb,o={shape:{points:n}};i.shape.points=s(n),r.shape.points=s(n),So(i,o,e,t),So(r,o,e,t);var l=new X_,c=new X_;l.add(r),l.add(i),l.add(c),a(r.shape.points,n,c,d,t,!0),d.setItemGraphicEl(t,l)}}).update(function(t,n){var i=h.getItemGraphicEl(n),r=i.childAt(0),o=i.childAt(1),s=i.childAt(2),l={shape:{points:d.getItemLayout(t)}};l.shape.points&&(a(r.shape.points,l.shape.points,s,d,t,!1),wo(r,l,e),wo(o,l,e),d.setItemGraphicEl(t,i))}).remove(function(e){u.remove(h.getItemGraphicEl(e))}).execute(),d.eachItemGraphicEl(function(e,t){function n(){l.attr("ignore",m)}function o(){l.attr("ignore",g)}var a=d.getItemModel(t),s=e.childAt(0),l=e.childAt(1),c=e.childAt(2),h=d.getItemVisual(t,"color");u.add(e),s.useStyle(r(a.getModel("lineStyle.normal").getLineStyle(),{fill:"none",stroke:h})),s.hoverStyle=a.getModel("lineStyle.emphasis").getLineStyle();var p=a.getModel("areaStyle.normal"),f=a.getModel("areaStyle.emphasis"),g=p.isEmpty()&&p.parentModel.isEmpty(),m=f.isEmpty()&&f.parentModel.isEmpty();m=m&&g,l.ignore=g,l.useStyle(r(p.getAreaStyle(),{fill:h,opacity:.7})),l.hoverStyle=f.getAreaStyle();var v=a.getModel("itemStyle.normal").getItemStyle(["color"]),_=a.getModel("itemStyle.emphasis").getItemStyle(),y=a.getModel("label.normal"),x=a.getModel("label.emphasis");c.eachChild(function(e){e.setStyle(v),e.hoverStyle=i(_),co(e.style,e.hoverStyle,y,x,{labelFetcher:d.hostModel,labelDataIndex:t,labelDimIndex:e.__dimIdx,defaultText:d.get(d.dimensions[e.__dimIdx],t),autoColor:h,isRectText:!0})}),e.off("mouseover").off("mouseout").off("normal").off("emphasis"),e.on("emphasis",n).on("mouseover",n).on("normal",o).on("mouseout",o),uo(e)}),this._data=d},remove:function(){this.group.removeAll(),this._data=null},dispose:function(){}}),ar(v(nT,"radar")),ar(v(pS,"radar","circle",null)),or(function(e){e.eachSeriesByType("radar",function(e){var t=e.getData(),n=[],i=e.coordinateSystem;if(i){for(var r=0;r<i.getIndicatorAxes().length;r++){var o=t.dimensions[r];t.each(o,function(e,t){n[t]=n[t]||[],n[t][r]=i.dataToPoint(e,r)})}t.each(function(e){n[e][0]&&n[e].push(n[e][0].slice()),t.setItemLayout(e,n[e])})}})}),er(v(aT,"radar")),tr(function(e){var t=e.polar;if(t){y(t)||(t=[t]);var n=[];d(t,function(t,i){t.indicator?(t.type&&!t.shape&&(t.shape=t.type),e.radar=e.radar||[],y(e.radar)||(e.radar=[e.radar]),e.radar.push(t)):n.push(t)}),e.polar=n}d(e.series,function(e){e&&"radar"===e.type&&e.polarIndex&&(e.radarIndex=e.polarIndex)})});var hT=$;u(_l,C_),bl.prototype={constructor:bl,type:"view",dimensions:["x","y"],setBoundingRect:function(e,t,n,i){return this._rect=new jt(e,t,n,i),this._rect},getBoundingRect:function(){return this._rect},setViewRect:function(e,t,n,i){this.transformTo(e,t,n,i),this._viewRect=new jt(e,t,n,i)},transformTo:function(e,t,n,i){var r=this.getBoundingRect(),o=this._viewTransform;o.transform=r.calculateTransform(new jt(e,t,n,i)),o.decomposeTransform(),this._updateTransform()},setCenter:function(e){e&&(this._center=e,this._updateCenterAndZoom())},setZoom:function(e){e=e||1;var t=this.zoomLimit;t&&(null!=t.max&&(e=Math.min(t.max,e)),null!=t.min&&(e=Math.max(t.min,e))),this._zoom=e,this._updateCenterAndZoom()},getDefaultCenter:function(){var e=this.getBoundingRect();return[e.x+e.width/2,e.y+e.height/2]},getCenter:function(){return this._center||this.getDefaultCenter()},getZoom:function(){return this._zoom||1},getRoamTransform:function(){return this._roamTransform},_updateCenterAndZoom:function(){var e=this._viewTransform.getLocalTransform(),t=this._roamTransform,n=this.getDefaultCenter(),i=this.getCenter(),r=this.getZoom();i=$([],i,e),n=$([],n,e),t.origin=i,t.position=[n[0]-i[0],n[1]-i[1]],t.scale=[r,r],this._updateTransform()},_updateTransform:function(){var e=this._roamTransform,t=this._viewTransform;t.parent=e,e.updateTransform(),t.updateTransform(),t.transform&&rt(this.transform||(this.transform=[]),t.transform),this.transform?(this.invTransform=this.invTransform||[],ct(this.invTransform,this.transform)):this.invTransform=null,this.decomposeTransform()},getViewRect:function(){return this._viewRect},getViewRectAfterRoam:function(){var e=this.getBoundingRect().clone();return e.applyTransform(this.transform),e},dataToPoint:function(e){var t=this.transform;return t?hT([],e,t):[e[0],e[1]]},pointToData:function(e){var t=this.invTransform;return t?hT([],e,t):[e[0],e[1]]},convertToPixel:v(wl,"dataToPoint"),convertFromPixel:v(wl,"pointToData"),containPoint:function(e){return this.getViewRectAfterRoam().contain(e[0],e[1])}},u(bl,C_);for(var pT=[126,25],fT=[[[0,3.5],[7,11.2],[15,11.9],[30,7],[42,.7],[52,.7],[56,7.7],[59,.7],[64,.7],[64,0],[5,0],[0,3.5]],[[13,16.1],[19,14.7],[16,21.7],[11,23.1],[13,16.1]],[[12,32.2],[14,38.5],[15,38.5],[13,32.2],[12,32.2]],[[16,47.6],[12,53.2],[13,53.2],[18,47.6],[16,47.6]],[[6,64.4],[8,70],[9,70],[8,64.4],[6,64.4]],[[23,82.6],[29,79.8],[30,79.8],[25,82.6],[23,82.6]],[[37,70.7],[43,62.3],[44,62.3],[39,70.7],[37,70.7]],[[48,51.1],[51,45.5],[53,45.5],[50,51.1],[48,51.1]],[[51,35],[51,28.7],[53,28.7],[53,35],[51,35]],[[52,22.4],[55,17.5],[56,17.5],[53,22.4],[52,22.4]],[[58,12.6],[62,7],[63,7],[60,12.6],[58,12.6]],[[0,3.5],[0,93.1],[64,93.1],[64,0],[63,0],[63,92.4],[1,92.4],[1,3.5],[0,3.5]]],gT=0;gT<fT.length;gT++)for(var mT=0;mT<fT[gT].length;mT++)fT[gT][mT][0]/=10.5,fT[gT][mT][1]/=-14,fT[gT][mT][0]+=pT[0],fT[gT][mT][1]+=pT[1];var vT={"南海诸岛":[32,80],"广东":[0,-10],"香港":[10,5],"澳门":[-10,10],"天津":[5,5]},_T={Russia:[100,60],"United States":[-99,38],"United States of America":[-99,38]},yT=[[[123.45165252685547,25.73527164402261],[123.49731445312499,25.73527164402261],[123.49731445312499,25.750734064600884],[123.45165252685547,25.750734064600884],[123.45165252685547,25.73527164402261]]],xT=[function(e){"china"===e.map&&e.regions.push(new Xr("南海诸岛",f(fT,function(e){return{type:"polygon",exterior:e}}),pT))},function(e){d(e.regions,function(e){var t=vT[e.name];if(t){var n=e.center;n[0]+=t[0]/10.5,n[1]+=-t[1]/14}})},function(e){d(e.regions,function(e){var t=_T[e.name];if(t){var n=e.center;n[0]=t[0],n[1]=t[1]}})},function(e){if("china"===e.map)for(var t=0,n=e.regions.length;t<n;++t)"台湾"===e.regions[t].name&&e.regions[t].geometries.push({type:"polygon",exterior:yT[0]})}];Sl.prototype={constructor:Sl,type:"geo",dimensions:["lng","lat"],containCoord:function(e){for(var t=this.regions,n=0;n<t.length;n++)if(t[n].contain(e))return!0;return!1},loadGeoJson:function(e,t,n){try{this.regions=e?XC(e):[]}catch(e){throw"Invalid geoJson format\n"+e.message}t=t||{},n=n||{};for(var i=this.regions,r=z(),o=0;o<i.length;o++){var a=i[o].name;a=n.hasOwnProperty(a)?n[a]:a,i[o].name=a,r.set(a,i[o]),this.addGeoCoord(a,i[o].center);var s=t[a];s&&i[o].transformTo(s.left,s.top,s.width,s.height)}this._regionsMap=r,this._rect=null,d(xT,function(e){e(this)},this)},transformTo:function(e,t,n,i){var r=this.getBoundingRect();(r=r.clone()).y=-r.y-r.height;var o=this._viewTransform;o.transform=r.calculateTransform(new jt(e,t,n,i)),o.decomposeTransform();var a=o.scale;a[1]=-a[1],o.updateTransform(),this._updateTransform()},getRegion:function(e){return this._regionsMap.get(e)},getRegionByCoord:function(e){for(var t=this.regions,n=0;n<t.length;n++)if(t[n].contain(e))return t[n]},addGeoCoord:function(e,t){this._nameCoordMap.set(e,t)},getGeoCoord:function(e){return this._nameCoordMap.get(e)},getBoundingRect:function(){if(this._rect)return this._rect;for(var e,t=this.regions,n=0;n<t.length;n++){var i=t[n].getBoundingRect();(e=e||i.clone()).union(i)}return this._rect=e||new jt(0,0,0,0)},dataToPoint:function(e){if("string"==typeof e&&(e=this.getGeoCoord(e)),e)return bl.prototype.dataToPoint.call(this,e)},convertToPixel:v(Ml,"dataToPoint"),convertFromPixel:v(Ml,"pointToData")},u(Sl,bl);var bT={dimensions:Sl.prototype.dimensions,create:function(e,t){var n=[];e.eachComponent("geo",function(e,i){var r=e.get("map"),o=cr(r),a=new Sl(r+i,r,o&&o.geoJson,o&&o.specialAreas,e.get("nameMap"));a.zoomLimit=e.get("scaleLimit"),n.push(a),Tl(a,e),e.coordinateSystem=a,a.model=e,a.resize=Il,a.resize(e,t)}),e.eachSeries(function(e){if("geo"===e.get("coordinateSystem")){var t=e.get("geoIndex")||0;e.coordinateSystem=n[t]}});var i={};return e.eachSeriesByType("map",function(e){if(!e.getHostGeoModel()){var t=e.getMapType();i[t]=i[t]||[],i[t].push(e)}}),d(i,function(e,i){var r=cr(i),a=f(e,function(e){return e.get("nameMap")}),s=new Sl(i,i,r&&r.geoJson,r&&r.specialAreas,o(a));s.zoomLimit=I.apply(null,f(e,function(e){return e.get("scaleLimit")})),n.push(s),s.resize=Il,s.resize(e[0],t),d(e,function(e){e.coordinateSystem=s,Tl(s,e)})}),n},getFilledRegions:function(e,t,n){var i=(e||[]).slice();n=n||{};var r=cr(t),o=r&&r.geoJson;if(!o)return e;for(var a=z(),s=o.features,l=0;l<i.length;l++)a.set(i[l].name,i[l]);for(l=0;l<s.length;l++){var c=s[l].properties.name;a.get(c)||(n.hasOwnProperty(c)&&(c=n[c]),i.push({name:c}))}return i}};nr("geo",bT);var wT=xw.extend({type:"series.map",dependencies:["geo"],layoutMode:"box",needsDrawMap:!1,seriesGroup:[],init:function(e){this._fillOption(e,this.getMapType()),wT.superApply(this,"init",arguments),this.updateSelectedMap(e.data)},getInitialData:function(e){var t=xr(["value"],e.data||[]),n=new sC(t,this);return n.initData(e.data),n},mergeOption:function(e){this._fillOption(e,this.getMapType()),wT.superApply(this,"mergeOption",arguments),this.updateSelectedMap(this.option.data)},getHostGeoModel:function(){var e=this.option.geoIndex;return null!=e?this.dependentModels.geo[e]:null},getMapType:function(){return(this.getHostGeoModel()||this).option.map},_fillOption:function(e,t){e.data=bT.getFilledRegions(e.data,t,e.nameMap)},getRawValue:function(e){return this.getData().get("value",e)},getRegionModel:function(e){var t=this.getData();return t.getItemModel(t.indexOfName(e))},formatTooltip:function(e){for(var t=this.getData(),n=Vi(this.getRawValue(e)),i=t.getName(e),r=this.seriesGroup,o=[],a=0;a<r.length;a++){var s=r[a].originalData.indexOfName(i);isNaN(r[a].originalData.get("value",s))||o.push(Gi(r[a].name))}return o.join(", ")+"<br />"+Gi(i+" : "+n)},getTooltipPosition:function(e){if(null!=e){var t=this.getData().getName(e),n=this.coordinateSystem,i=n.getRegion(t);return i&&n.dataToPoint(i.center)}},setZoom:function(e){this.option.zoom=e},setCenter:function(e){this.option.center=e},defaultOption:{zlevel:0,z:2,coordinateSystem:"geo",map:"",left:"center",top:"center",aspectScale:.75,showLegendSymbol:!0,dataRangeHoverLink:!0,boundingCoords:null,center:null,zoom:1,scaleLimit:null,label:{normal:{show:!1,color:"#000"},emphasis:{show:!0,color:"rgb(100,0,0)"}},itemStyle:{normal:{borderWidth:.5,borderColor:"#444",areaColor:"#eee"},emphasis:{areaColor:"rgba(255,215,0,0.8)"}}}});u(wT,JS);var CT="\0_ec_interaction_mutex";ir({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},function(){}),u(kl,g_);var ST={axisPointer:1,tooltip:1,brush:1};Ul.prototype={constructor:Ul,draw:function(e,t,n,i,r){var o="geo"===e.mainType,a=e.getData&&e.getData();o&&t.eachComponent({mainType:"series",subType:"map"},function(t){a||t.getHostGeoModel()!==e||(a=t.getData())});var s=e.coordinateSystem,l=this.group,c=s.scale,u={position:s.position,scale:c};!l.childAt(0)||r?l.attr(u):wo(l,u,e),l.removeAll();var h=["itemStyle","normal"],p=["itemStyle","emphasis"],f=["label","normal"],g=["label","emphasis"],m=z();d(s.regions,function(t){var n=m.get(t.name)||m.set(t.name,new X_),i=new yb({shape:{paths:[]}});n.add(i);var r,s=(I=e.getRegionModel(t.name)||e).getModel(h),u=I.getModel(p),v=Hl(s),_=Hl(u),y=I.getModel(f),x=I.getModel(g);if(a){r=a.indexOfName(t.name);var b=a.getItemVisual(r,"color",!0);b&&(v.fill=b)}d(t.geometries,function(e){if("polygon"===e.type){i.shape.paths.push(new hb({shape:{points:e.exterior}}));for(var t=0;t<(e.interiors?e.interiors.length:0);t++)i.shape.paths.push(new hb({shape:{points:e.interiors[t]}}))}}),i.setStyle(v),i.style.strokeNoScale=!0,i.culling=!0;var w=y.get("show"),C=x.get("show"),S=a&&isNaN(a.get("value",r)),T=a&&a.getItemLayout(r);if(o||S&&(w||C)||T&&T.showLabel){var A,M=o?t.name:r;(!a||r>=0)&&(A=e);var E=new rb({position:t.center.slice(),scale:[1/c[0],1/c[1]],z2:10,silent:!0});co(E.style,E.hoverStyle={},y,x,{labelFetcher:A,labelDataIndex:M,defaultText:t.name,useInsideStyle:!1},{textAlign:"center",textVerticalAlign:"middle"}),n.add(E)}if(a)a.setItemGraphicEl(r,n);else{var I=e.getRegionModel(t.name);i.eventData={componentType:"geo",geoIndex:e.componentIndex,name:t.name,region:I&&I.option||{}}}(n.__regions||(n.__regions=[])).push(t),uo(n,_,{hoverSilentOnTouch:!!e.get("selectedMode")}),l.add(n)}),this._updateController(e,t,n),Fl(this,e,l,n,i),Zl(e,l)},remove:function(){this.group.removeAll(),this._controller.dispose(),this._controllerHost={}},_updateController:function(e,t,i){function n(){var t={type:"geoRoam",componentType:l};return t[l+"Id"]=e.id,t}var r=e.coordinateSystem,o=this._controller,s=this._controllerHost;s.zoomLimit=e.get("scaleLimit"),s.zoom=r.getZoom(),o.enable(e.get("roam")||!1);var l=e.mainType;o.off("pan").on("pan",function(e,t){this._mouseDownFlag=!1,Bl(s,e,t),i.dispatchAction(a(n(),{dx:e,dy:t}))},this),o.off("zoom").on("zoom",function(e,t,r){if(this._mouseDownFlag=!1,Gl(s,e,t,r),i.dispatchAction(a(n(),{zoom:e,originX:t,originY:r})),this._updateGroup){var o=this.group,l=o.scale;o.traverse(function(e){"text"===e.type&&e.attr("scale",[1/l[0],1/l[1]])})}},this),o.setPointerChecker(function(t,n,o){return r.getViewRectAfterRoam().contain(n,o)&&!Wl(t,i,e)})}},ur({type:"map",render:function(e,t,n,i){if(!i||"mapToggleSelect"!==i.type||i.from!==this.uid){var r=this.group;if(r.removeAll(),!e.getHostGeoModel()){if(i&&"geoRoam"===i.type&&"series"===i.componentType&&i.seriesId===e.id)(o=this._mapDraw)&&r.add(o.group);else if(e.needsDrawMap){var o=this._mapDraw||new Ul(n,!0);r.add(o.group),o.draw(e,t,n,this,i),this._mapDraw=o}else this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;e.get("showLegendSymbol")&&t.getComponent("legend")&&this._renderSymbols(e,t,n)}}},remove:function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null,this.group.removeAll()},dispose:function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null},_renderSymbols:function(e,t,n){var i=e.originalData,r=this.group;i.each("value",function(t,n){if(!isNaN(t)){var o=i.getItemLayout(n);if(o&&o.point){var a=o.point,s=o.offset,l=new ob({style:{fill:e.getData().getVisual("color")},shape:{cx:a[0]+9*s,cy:a[1],r:3},silent:!0,z2:s?8:10});if(!s){var c=e.mainSeries.getData(),u=i.getName(n),d=c.indexOfName(u),h=i.getItemModel(n),p=h.getModel("label.normal"),f=h.getModel("label.emphasis"),g=c.getItemGraphicEl(d),m=T(e.getFormattedLabel(n,"normal"),u),v=T(e.getFormattedLabel(n,"emphasis"),m),_=function(){var e=fo({},f,{text:f.get("show")?v:null},{isRectText:!0,useInsideStyle:!1},!0);l.style.extendFrom(e),l.__mapOriginalZ2=l.z2,l.z2+=1},y=function(){fo(l.style,p,{text:p.get("show")?m:null,textPosition:p.getShallow("position")||"bottom"},{isRectText:!0,useInsideStyle:!1}),null!=l.__mapOriginalZ2&&(l.z2=l.__mapOriginalZ2,l.__mapOriginalZ2=null)};g.on("mouseover",_).on("mouseout",y).on("emphasis",_).on("normal",y),y()}r.add(l)}}})}}),ir({type:"geoRoam",event:"geoRoam",update:"updateLayout"},function(e,t){var n=e.componentType||"series";t.eachComponent({mainType:n,query:e},function(t){var i=t.coordinateSystem;if("geo"===i.type){var r=Xl(i,e,t.get("scaleLimit"));t.setCenter&&t.setCenter(r.center),t.setZoom&&t.setZoom(r.zoom),"series"===n&&d(t.seriesGroup,function(e){e.setCenter(r.center),e.setZoom(r.zoom)})}})}),or(function(e){var t={};e.eachSeriesByType("map",function(n){var i=n.getMapType();if(!n.getHostGeoModel()&&!t[i]){var r={};d(n.seriesGroup,function(t){var n=t.coordinateSystem,i=t.originalData;t.get("showLegendSymbol")&&e.getComponent("legend")&&i.each("value",function(e,t){var o=i.getName(t),a=n.getRegion(o);if(a&&!isNaN(e)){var s=r[o]||0,l=n.dataToPoint(a.center);r[o]=s+1,i.setItemLayout(t,{point:l,offset:s})}})});var o=n.getData();o.each(function(e){var t=o.getName(e),n=o.getItemLayout(e)||{};n.showLabel=!r[t],o.setItemLayout(e,n)}),t[i]=!0}})}),ar(function(e){e.eachSeriesByType("map",function(e){var t=e.get("color"),n=e.getModel("itemStyle.normal"),i=n.get("areaColor"),r=n.get("color")||t[e.seriesIndex%t.length];e.getData().setVisual({areaColor:i,color:r})})}),er(Pw.PROCESSOR.STATISTIC,function(e){var t={};e.eachSeriesByType("map",function(e){var n=e.getHostGeoModel(),i=n?"o"+n.id:"i"+e.getMapType();(t[i]=t[i]||[]).push(e)}),d(t,function(e,t){for(var n=jl(f(e,function(e){return e.getData()}),e[0].get("mapValueCalculation")),i=0;i<e.length;i++)e[i].originalData=e[i].getData();for(i=0;i<e.length;i++)e[i].seriesGroup=e,e[i].needsDrawMap=0===i&&!e[i].getHostGeoModel(),e[i].setData(n.cloneShallow()),e[i].mainSeries=e[0]})}),tr(function(e){var t=[];d(e.series,function(e){e&&"map"===e.type&&(t.push(e),e.map=e.map||e.mapType,r(e,e.mapLocation))})}),tT("map",[{type:"mapToggleSelect",event:"mapselectchanged",method:"toggleSelected"},{type:"mapSelect",event:"mapselected",method:"select"},{type:"mapUnSelect",event:"mapunselected",method:"unSelect"}]);var TT=d,AT="\0__link_datas",MT="\0__link_mainData",ET=function(e,t){this.name=e||"",this.depth=0,this.height=0,this.parentNode=null,this.dataIndex=-1,this.children=[],this.viewChildren=[],this.hostTree=t};ET.prototype={constructor:ET,isRemoved:function(){return this.dataIndex<0},eachNode:function(e,t,n){"function"==typeof e&&(n=t,t=e,e=null),_(e=e||{})&&(e={order:e});var i,r=e.order||"preorder",o=this[e.attr||"children"];"preorder"===r&&(i=t.call(n,this));for(var a=0;!i&&a<o.length;a++)o[a].eachNode(e,t,n);"postorder"===r&&t.call(n,this)},updateDepthAndHeight:function(e){var t=0;this.depth=e;for(var n=0;n<this.children.length;n++){var i=this.children[n];i.updateDepthAndHeight(e+1),i.height>t&&(t=i.height)}this.height=t+1},getNodeById:function(e){if(this.getId()===e)return this;for(var t=0,n=this.children,i=n.length;t<i;t++){var r=n[t].getNodeById(e);if(r)return r}},contains:function(e){if(e===this)return!0;for(var t=0,n=this.children,i=n.length;t<i;t++){var r=n[t].contains(e);if(r)return r}},getAncestors:function(e){for(var t=[],n=e?this:this.parentNode;n;)t.push(n),n=n.parentNode;return t.reverse(),t},getValue:function(e){var t=this.hostTree.data;return t.get(t.getDimension(e||"value"),this.dataIndex)},setLayout:function(e,t){this.dataIndex>=0&&this.hostTree.data.setItemLayout(this.dataIndex,e,t)},getLayout:function(){return this.hostTree.data.getItemLayout(this.dataIndex)},getModel:function(e){if(!(this.dataIndex<0)){var t,n=this.hostTree,i=n.data.getItemModel(this.dataIndex),r=this.getLevelModel();return r||0!==this.children.length&&(0===this.children.length||!1!==this.isExpand)||(t=this.getLeavesModel()),i.getModel(e,(r||t||n.hostModel).getModel(e))}},getLevelModel:function(){return(this.hostTree.levelModels||[])[this.depth]},getLeavesModel:function(){return this.hostTree.leavesModel},setVisual:function(e,t){this.dataIndex>=0&&this.hostTree.data.setItemVisual(this.dataIndex,e,t)},getVisual:function(e,t){return this.hostTree.data.getItemVisual(this.dataIndex,e,t)},getRawIndex:function(){return this.hostTree.data.getRawIndex(this.dataIndex)},getId:function(){return this.hostTree.data.getId(this.dataIndex)}},ih.prototype={constructor:ih,type:"tree",eachNode:function(e,t,n){this.root.eachNode(e,t,n)},getNodeByDataIndex:function(e){var t=this.data.getRawIndex(e);return this._nodes[t]},getNodeByName:function(e){return this.root.getNodeByName(e)},update:function(){for(var e=this.data,t=this._nodes,n=0,i=t.length;n<i;n++)t[n].dataIndex=-1;for(var n=0,i=e.count();n<i;n++)t[e.getRawIndex(n)].dataIndex=n},clearLayouts:function(){this.data.clearItemLayouts()}},ih.createTree=function(e,t,i){function n(e,t){var i=e.value;a=Math.max(a,y(i)?i.length:1),o.push(e);var s=new ET(e.name,r);t?nh(s,t):r.root=s,r._nodes.push(s);var l=e.children;if(l)for(var c=0;c<l.length;c++)n(l[c],s)}var r=new ih(t,i.levels,i.leaves),o=[],a=1;n(e),r.root.updateDepthAndHeight(0);var s=xr([{name:"value"}],o,{dimCount:a}),l=new sC(s,t);return l.initData(o),ql({mainData:l,struct:r,structAttr:"tree"}),r.update(),r},xw.extend({type:"series.tree",layoutInfo:null,layoutMode:"box",getInitialData:function(e){var t={name:e.name,children:e.data},n=e.leaves||{},i={};i.leaves=n;var r=ih.createTree(t,this,i),o=0;r.eachNode("preorder",function(e){e.depth>o&&(o=e.depth)});var a=e.expandAndCollapse&&e.initialTreeDepth>=0?e.initialTreeDepth:o;return r.root.eachNode("preorder",function(e){var t=e.hostTree.data.getRawDataItem(e.dataIndex);e.isExpand=t&&null!=t.collapsed?!t.collapsed:e.depth<=a}),r.data},formatTooltip:function(e){for(var t=this.getData().tree,n=t.root.children[0],i=t.getNodeByDataIndex(e),r=i.getValue(),o=i.name;i&&i!==n;)o=i.parentNode.name+"."+o,i=i.parentNode;return Gi(o+(isNaN(r)||null==r?"":" : "+r))},defaultOption:{zlevel:0,z:2,left:"12%",top:"12%",right:"12%",bottom:"12%",layout:"orthogonal",orient:"horizontal",symbol:"emptyCircle",symbolSize:7,expandAndCollapse:!0,initialTreeDepth:2,lineStyle:{normal:{color:"#ccc",width:1.5,curveness:.5}},itemStyle:{normal:{color:"lightsteelblue",borderColor:"#c23531",borderWidth:1.5}},label:{normal:{show:!0,color:"#555"}},leaves:{label:{normal:{show:!0}}},animationEasing:"linear",animationDuration:700,animationDurationUpdate:1e3}}),ur({type:"tree",init:function(e,t){this._oldTree,this._mainGroup=new X_,this.group.add(this._mainGroup)},render:function(e,t,n,i){var r=e.getData(),o=e.layoutInfo,a=this._mainGroup,s=e.get("layout");"radial"===s?a.attr("position",[o.x+o.width/2,o.y+o.height/2]):a.attr("position",[o.x,o.y]);var l=this._data,c={expandAndCollapse:e.get("expandAndCollapse"),layout:s,orient:e.get("orient"),curvature:e.get("lineStyle.normal.curveness"),symbolRotate:e.get("symbolRotate"),symbolOffset:e.get("symbolOffset"),hoverAnimation:e.get("hoverAnimation"),useNameLabel:!0,fadeIn:!0};r.diff(l).add(function(t){vh(r,t)&&xh(r,t,null,a,e,c)}).update(function(t,n){var i=l.getItemGraphicEl(n);vh(r,t)?xh(r,t,i,a,e,c):i&&_h(r,t,i,a,e,c)}).remove(function(t){var n=l.getItemGraphicEl(t);_h(r,t,n,a,e,c)}).execute(),!0===c.expandAndCollapse&&r.eachItemGraphicEl(function(t,i){t.off("click").on("click",function(){n.dispatchAction({type:"treeExpandAndCollapse",seriesId:e.id,dataIndex:i})})}),this._data=r},dispose:function(){},remove:function(){this._mainGroup.removeAll(),this._data=null}}),ir({type:"treeExpandAndCollapse",event:"treeExpandAndCollapse",update:"update"},function(e,t){t.eachComponent({mainType:"series",subType:"tree",query:e},function(t){var n=e.dataIndex,i=t.getData().tree.getNodeByDataIndex(n);i.isExpand=!i.isExpand})});var IT=function(e,t){var n=hh(e,t);e.layoutInfo=n;var i=e.get("layout"),r=0,o=0,a=null;"radial"===i?(r=2*Math.PI,o=Math.min(n.height,n.width)/2,a=sh(function(e,t){return(e.parentNode===t.parentNode?1:2)/e.depth})):(r=n.width,o=n.height,a=sh());var s=e.getData().tree.root,l=s.children[0];oh(s),wh(l,ah,a),s.hierNode.modifier=-l.hierNode.prelim,Sh(l,rh);var c=l,u=l,d=l;Sh(l,function(e){var t=e.getLayout().x;t<c.getLayout().x&&(c=e),t>u.getLayout().x&&(u=e),e.depth>d.depth&&(d=e)});var h=c===u?1:a(c,u)/2,p=h-c.getLayout().x,f=0,g=0,m=0,v=0;"radial"===i?(f=r/(u.getLayout().x+h+p),g=o/(d.depth-1||1),Sh(l,function(e){m=(e.getLayout().x+p)*f,v=(e.depth-1)*g;var t=lh(m,v);e.setLayout({x:t.x,y:t.y,rawX:m,rawY:v},!0)})):"horizontal"===e.get("orient")?(g=o/(u.getLayout().x+h+p),f=r/(d.depth-1||1),Sh(l,function(e){v=(e.getLayout().x+p)*g,m=(e.depth-1)*f,e.setLayout({x:m,y:v},!0)})):(f=r/(u.getLayout().x+h+p),g=o/(d.depth-1||1),Sh(l,function(e){m=(e.getLayout().x+p)*f,v=(e.depth-1)*g,e.setLayout({x:m,y:v},!0)}))};ar(v(pS,"tree","circle",null)),or(function(e,t){e.eachSeriesByType("tree",function(e){IT(e,t)})}),or(function(e,t){e.eachSeriesByType("tree",function(e){IT(e,t)})}),xw.extend({type:"series.treemap",layoutMode:"box",dependencies:["grid","polar"],_viewRoot:null,defaultOption:{progressive:0,hoverLayerThreshold:1/0,left:"center",top:"middle",right:null,bottom:null,width:"80%",height:"80%",sort:!0,clipWindow:"origin",squareRatio:.5*(1+Math.sqrt(5)),leafDepth:null,drillDownIcon:"▶",zoomToNodeRatio:.1024,roam:!0,nodeClick:"zoomToNode",animation:!0,animationDurationUpdate:900,animationEasing:"quinticInOut",breadcrumb:{show:!0,height:22,left:"center",top:"bottom",emptyItemWidth:25,itemStyle:{normal:{color:"rgba(0,0,0,0.7)",borderColor:"rgba(255,255,255,0.7)",borderWidth:1,shadowColor:"rgba(150,150,150,1)",shadowBlur:3,shadowOffsetX:0,shadowOffsetY:0,textStyle:{color:"#fff"}},emphasis:{textStyle:{}}}},label:{normal:{show:!0,distance:0,padding:5,position:"inside",color:"#fff",ellipsis:!0}},upperLabel:{normal:{show:!1,position:[0,"50%"],height:20,color:"#fff",ellipsis:!0,verticalAlign:"middle"},emphasis:{show:!0,position:[0,"50%"],color:"#fff",ellipsis:!0,verticalAlign:"middle"}},itemStyle:{normal:{color:null,colorAlpha:null,colorSaturation:null,borderWidth:0,gapWidth:0,borderColor:"#fff",borderColorSaturation:null},emphasis:{}},visualDimension:0,visualMin:null,visualMax:null,color:[],colorAlpha:null,colorSaturation:null,colorMappingBy:"index",visibleMin:10,childrenVisibleMin:null,levels:[]},getInitialData:function(e,t){var n={name:e.name,children:e.data};Ch(n);var i=e.levels||[];i=e.levels=Dh(i,t);var r={};return r.levels=i,ih.createTree(n,this,r).data},optionUpdated:function(){this.resetViewRoot()},formatTooltip:function(e){var t=this.getData(),n=this.getRawValue(e),i=Vi(y(n)?n[0]:n);return Gi(t.getName(e)+": "+i)},getDataParams:function(e){var t=xw.prototype.getDataParams.apply(this,arguments),n=this.getData().tree.getNodeByDataIndex(e);return t.treePathInfo=Ah(n,this),t},setLayoutInfo:function(e){this.layoutInfo=this.layoutInfo||{},a(this.layoutInfo,e)},mapIdToIndex:function(e){var t=this._idIndexMap;t||(t=this._idIndexMap=z(),this._idIndexMapCount=0);var n=t.get(e);return null==n&&t.set(e,n=this._idIndexMapCount++),n},getViewRoot:function(){return this._viewRoot},resetViewRoot:function(e){e?this._viewRoot=e:e=this._viewRoot;var t=this.getData().tree.root;e&&(e===t||t.contains(e))||(this._viewRoot=t)}});var DT=5;Lh.prototype={constructor:Lh,render:function(e,t,n,i){var r=e.getModel("breadcrumb"),o=this.group;if(o.removeAll(),r.get("show")&&n){var a=r.getModel("itemStyle.normal"),s=a.getModel("textStyle"),l={pos:{left:r.get("left"),right:r.get("right"),top:r.get("top"),bottom:r.get("bottom")},box:{width:t.getWidth(),height:t.getHeight()},emptyItemWidth:r.get("emptyItemWidth"),totalWidth:0,renderList:[]};this._prepare(n,l,s),this._renderContent(e,l,a,s,i),Jo(o,l.pos,l.box)}},_prepare:function(e,t,n){for(var i=e;i;i=i.parentNode){var r=i.getModel().get("name"),o=n.getTextRect(r),a=Math.max(o.width+16,t.emptyItemWidth);t.totalWidth+=a+8,t.renderList.push({node:i,text:r,width:a})}},_renderContent:function(e,t,n,i,o){for(var a=0,s=t.emptyItemWidth,l=e.get("breadcrumb.height"),c=$o(t.pos,t.box),u=t.totalWidth,d=t.renderList,h=d.length-1;h>=0;h--){var p=d[h],f=p.node,g=p.width,m=p.text;u>c.width&&(u-=g-s,g=s,m=null);var _=new hb({shape:{points:kh(a,0,g,l,h===d.length-1,0===h)},style:r(n.getItemStyle(),{lineJoin:"bevel",text:m,textFill:i.getTextColor(),textFont:i.getFont()}),z:10,onclick:v(o,f)});this.group.add(_),Ph(_,e,f),a+=g+8}},remove:function(){this.group.removeAll()}};var kT=m,LT=X_,NT=fb,PT=d,OT=["label","normal"],RT=["label","emphasis"],zT=["upperLabel","normal"],FT=["upperLabel","emphasis"],BT=10,HT=1,VT=2,WT=Jy([["fill","color"],["stroke","strokeColor"],["lineWidth","strokeWidth"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),UT=function(e){var t=WT(e);return t.stroke=t.fill=t.lineWidth=null,t};ur({type:"treemap",init:function(e,t){this._containerGroup,this._storage={nodeGroup:[],background:[],content:[]},this._oldTree,this._breadcrumb,this._controller,this._state="ready"},render:function(e,t,n,i){if(!(l(t.findComponents({mainType:"series",subType:"treemap",query:i}),e)<0)){this.seriesModel=e,this.api=n,this.ecModel=t;var r=Mh(i,e),o=i&&i.type,a=e.layoutInfo,s=!this._oldTree,c=this._storage,u="treemapRootToNode"===o&&r&&c?{rootNodeGroup:c.nodeGroup[r.node.getRawIndex()],direction:i.direction}:null,d=this._giveContainerGroup(a),h=this._doRender(d,e,u);s||o&&"treemapZoomToNode"!==o&&"treemapRootToNode"!==o?h.renderFinally():this._doAnimation(d,h,e,u),this._resetController(n),this._renderBreadcrumb(e,n,r)}},_giveContainerGroup:function(e){var t=this._containerGroup;return t||(t=this._containerGroup=new LT,this._initEvents(t),this.group.add(t)),t.attr("position",[e.x,e.y]),t},_doRender:function(e,t,i){function n(e,t,i,o,a){function r(e){return e.getId()}function s(r,s){var l=null!=r?e[r]:null,c=null!=s?t[s]:null,u=h(l,c,i,a);u&&n(l&&l.viewChildren||[],c&&c.viewChildren||[],u,o,a+1)}o?(t=e,PT(e,function(e,t){!e.isRemoved()&&s(t,t)})):new fr(t,e,r,r).add(s).update(s).remove(v(s,null)).execute()}var o=t.getData().tree,a=this._oldTree,l={nodeGroup:[],background:[],content:[]},c={nodeGroup:[],background:[],content:[]},u=this._storage,d=[],h=v(zh,t,c,u,i,l,d);n(o.root?[o.root]:[],a&&a.root?[a.root]:[],e,o===a||!a,0);var p=function(e){var t={nodeGroup:[],background:[],content:[]};return e&&PT(e,function(e,n){var i=t[n];PT(e,function(e){e&&(i.push(e),e.__tmWillDelete=1)})}),t}(u);return this._oldTree=o,this._storage=c,{lastsForAnimation:l,willDeleteEls:p,renderFinally:function(){PT(p,function(e){PT(e,function(e){e.parent&&e.parent.remove(e)})}),PT(d,function(e){e.invisible=!0,e.dirty()})}}},_doAnimation:function(e,t,n,i){if(n.get("animation")){var r=n.get("animationDurationUpdate"),o=n.get("animationEasing"),s=Oh();PT(t.willDeleteEls,function(e,t){PT(e,function(e,n){if(!e.invisible){var a,l=e.parent;if(i&&"drillDown"===i.direction)a=l===i.rootNodeGroup?{shape:{x:0,y:0,width:l.__tmNodeWidth,height:l.__tmNodeHeight},style:{opacity:0}}:{style:{opacity:0}};else{var c=0,u=0;l.__tmWillDelete||(c=l.__tmNodeWidth/2,u=l.__tmNodeHeight/2),a="nodeGroup"===t?{position:[c,u],style:{opacity:0}}:{shape:{x:c,y:u,width:0,height:0},style:{opacity:0}}}a&&s.add(e,a,r,o)}})}),PT(this._storage,function(e,n){PT(e,function(e,i){var l=t.lastsForAnimation[n][i],c={};l&&("nodeGroup"===n?l.old&&(c.position=e.position.slice(),e.attr("position",l.old)):(l.old&&(c.shape=a({},e.shape),e.setShape(l.old)),l.fadein?(e.setStyle("opacity",0),c.style={opacity:1}):1!==e.style.opacity&&(c.style={opacity:1})),s.add(e,c,r,o))})},this),this._state="animating",s.done(kT(function(){this._state="ready",t.renderFinally()},this)).start()}},_resetController:function(e){var t=this._controller;t||((t=this._controller=new kl(e.getZr())).enable(this.seriesModel.get("roam")),t.on("pan",kT(this._onPan,this)),t.on("zoom",kT(this._onZoom,this)));var n=new jt(0,0,e.getWidth(),e.getHeight());t.setPointerChecker(function(e,t,i){return n.contain(t,i)})},_clearController:function(){var e=this._controller;e&&(e.dispose(),e=null)},_onPan:function(e,t){if("animating"!==this._state&&(Math.abs(e)>3||Math.abs(t)>3)){var n=this.seriesModel.getData().tree.root;if(!n)return;var i=n.getLayout();if(!i)return;this.api.dispatchAction({type:"treemapMove",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:i.x+e,y:i.y+t,width:i.width,height:i.height}})}},_onZoom:function(e,t,n){if("animating"!==this._state){var i=this.seriesModel.getData().tree.root;if(!i)return;var r=i.getLayout();if(!r)return;var o=new jt(r.x,r.y,r.width,r.height),a=this.seriesModel.layoutInfo;t-=a.x,n-=a.y;var s=ot();lt(s,s,[-t,-n]),ut(s,s,[e,e]),lt(s,s,[t,n]),o.applyTransform(s),this.api.dispatchAction({type:"treemapRender",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:o.x,y:o.y,width:o.width,height:o.height}})}},_initEvents:function(e){e.on("click",function(e){if("ready"===this._state){var t=this.seriesModel.get("nodeClick",!0);if(t){var n=this.findTarget(e.offsetX,e.offsetY);if(n){var i=n.node;if(i.getLayout().isLeafRoot)this._rootToNode(n);else if("zoomToNode"===t)this._zoomToNode(n);else if("link"===t){var r=i.hostTree.data.getItemModel(i.dataIndex),o=r.get("link",!0),a=r.get("target",!0)||"blank";o&&window.open(o,a)}}}}},this)},_renderBreadcrumb:function(e,t,n){n||(n=null!=e.get("leafDepth",!0)?{node:e.getViewRoot()}:this.findTarget(t.getWidth()/2,t.getHeight()/2))||(n={node:e.getData().tree.root}),(this._breadcrumb||(this._breadcrumb=new Lh(this.group))).render(e,t,n.node,kT(function(t){"animating"!==this._state&&(Th(e.getViewRoot(),t)?this._rootToNode({node:t}):this._zoomToNode({node:t}))},this))},remove:function(){this._clearController(),this._containerGroup&&this._containerGroup.removeAll(),this._storage={nodeGroup:[],background:[],content:[]},this._state="ready",this._breadcrumb&&this._breadcrumb.remove()},dispose:function(){this._clearController()},_zoomToNode:function(e){this.api.dispatchAction({type:"treemapZoomToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:e.node})},_rootToNode:function(e){this.api.dispatchAction({type:"treemapRootToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:e.node})},findTarget:function(e,t){var n;return this.seriesModel.getViewRoot().eachNode({attr:"viewChildren",order:"preorder"},function(i){var r=this._storage.background[i.getRawIndex()];if(r){var o=r.transformCoordToLocal(e,t),a=r.shape;if(!(a.x<=o[0]&&o[0]<=a.x+a.width&&a.y<=o[1]&&o[1]<=a.y+a.height))return!1;n={node:i,offsetX:o[0],offsetY:o[1]}}},this),n}});for(var $T=["treemapZoomToNode","treemapRender","treemapMove"],GT=0;GT<$T.length;GT++)ir({type:$T[GT],update:"updateView"},function(){});ir({type:"treemapRootToNode",update:"updateView"},function(e,t){t.eachComponent({mainType:"series",subType:"treemap",query:e},function(t,n){var i=Mh(e,t);if(i){var r=t.getViewRoot();r&&(e.direction=Th(r,i.node)?"rollUp":"drillDown"),t.resetViewRoot(i.node)}})});var qT=d,jT=b,YT=-1,XT=function(e){var t=e.mappingMethod,n=e.type,r=this.option=i(e);this.type=n,this.mappingMethod=t,this._normalizeData=KT[t];var o=ZT[n];this.applyVisual=o.applyVisual,this.getColorMapper=o.getColorMapper,this._doMap=o._doMap[t],"piecewise"===t?(Vh(r),Eh(r)):"category"===t?r.categories?Rh(r):Vh(r,!0):(L("linear"!==t||r.dataExtent),Vh(r))};XT.prototype={constructor:XT,mapValueToVisual:function(e){var t=this._normalizeData(e);return this._doMap(t,e)},getNormalizer:function(){return m(this._normalizeData,this)}};var ZT=XT.visualHandlers={color:{applyVisual:Wh("color"),getColorMapper:function(){var e=this.option;return m("category"===e.mappingMethod?function(e,t){return!t&&(e=this._normalizeData(e)),Hh.call(this,e)}:function(t,n,i){var r=!!i;return!n&&(t=this._normalizeData(t)),i=Dt(t,e.parsedVisual,i),r?i:Ot(i,"rgba")},this)},_doMap:{linear:function(e){return Ot(Dt(e,this.option.parsedVisual),"rgba")},category:Hh,piecewise:function(e,t){var n=Uh.call(this,t);return null==n&&(n=Ot(Dt(e,this.option.parsedVisual),"rgba")),n},fixed:Fh}},colorHue:Bh(function(e,t){return kt(e,t)}),colorSaturation:Bh(function(e,t){return kt(e,null,t)}),colorLightness:Bh(function(e,t){return kt(e,null,null,t)}),colorAlpha:Bh(function(e,t){return Pt(e,t)}),opacity:{applyVisual:Wh("opacity"),_doMap:Zh([0,1])},symbol:{applyVisual:function(e,t,n){var i=this.mapValueToVisual(e);if(_(i))n("symbol",i);else if(jT(i))for(var r in i)i.hasOwnProperty(r)&&n(r,i[r])},_doMap:{linear:Gh,category:Hh,piecewise:function(e,t){var n=Uh.call(this,t);return null==n&&(n=Gh.call(this,e)),n},fixed:Fh}},symbolSize:{applyVisual:Wh("symbolSize"),_doMap:Zh([0,1])}},KT={linear:function(e){return wi(e,this.option.dataExtent,[0,1],!0)},piecewise:function(e){var t=this.option.pieceList,n=XT.findPieceIndex(e,t,!0);if(null!=n)return wi(n,[0,t.length-1],[0,1],!0)},category:function(e){var t=this.option.categories?this.option.categoryMap[e]:e;return null==t?YT:t},fixed:N};XT.listVisualTypes=function(){var e=[];return d(ZT,function(t,n){e.push(n)}),e},XT.addVisualHandler=function(e,t){ZT[e]=t},XT.isValidType=function(e){return ZT.hasOwnProperty(e)},XT.eachVisual=function(e,t,n){b(e)?d(e,t,n):t.call(n,e)},XT.mapVisual=function(e,t,n){var i,r=y(e)?[]:b(e)?{}:(i=!0,null);return XT.eachVisual(e,function(e,o){var a=t.call(n,e,o);i?r=a:r[o]=a}),r},XT.retrieveVisuals=function(e){var t,n={};return e&&qT(ZT,function(i,r){e.hasOwnProperty(r)&&(n[r]=e[r],t=!0)}),t?n:null},XT.prepareVisualTypes=function(e){if(jT(e)){var t=[];qT(e,function(e,n){t.push(n)}),e=t}else{if(!y(e))return[];e=e.slice()}return e.sort(function(e,t){return"color"===t&&"color"!==e&&0===e.indexOf("color")?1:-1}),e},XT.dependsOn=function(e,t){return"color"===t?!(!e||0!==e.indexOf(t)):e===t},XT.findPieceIndex=function(e,t,i){function n(t,n){var i=Math.abs(t-e);i<o&&(o=i,r=n)}for(var r,o=1/0,a=0,s=t.length;a<s;a++){var l=t[a].value;if(null!=l){if(l===e||"string"==typeof l&&l===e+"")return a;i&&n(l,a)}}for(var a=0,s=t.length;a<s;a++){var c=t[a],u=c.interval,d=c.close;if(u){if(u[0]===-1/0){if(jh(d[1],e,u[1]))return a}else if(u[1]===1/0){if(jh(d[0],u[0],e))return a}else if(jh(d[0],u[0],e)&&jh(d[1],e,u[1]))return a;i&&n(u[0],a),i&&n(u[1],a)}}if(i)return e===1/0?t.length-1:e===-1/0?0:r};var JT=y,QT="itemStyle.normal",eA=Math.max,tA=Math.min,nA=I,iA=d,rA=["itemStyle","normal","borderWidth"],oA=["itemStyle","normal","gapWidth"],aA=["upperLabel","normal","show"],sA=["upperLabel","normal","height"];ar(function(e,t,n){var i={mainType:"series",subType:"treemap",query:n};e.eachComponent(i,function(e){var t=e.getData().tree,n=t.root,i=e.getModel(QT);n.isRemoved()||qh(n,{},f(t.levelModels,function(e){return e?e.get(QT):null}),i,e.getViewRoot().getAncestors(),e)})}),or(function(e,t,n){var i={mainType:"series",subType:"treemap",query:n};e.eachComponent(i,function(e){var i=t.getWidth(),r=t.getHeight(),o=e.option,s=Ko(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()}),l=o.size||[],c=Si(nA(s.width,l[0]),i),u=Si(nA(s.height,l[1]),r),d=n&&n.type,h=Mh(n,e),p="treemapRender"===d||"treemapMove"===d?n.rootRect:null,f=e.getViewRoot(),g=Ih(f);if("treemapMove"!==d){var m="treemapZoomToNode"===d?hu(e,h,f,c,u):p?[p.width,p.height]:[c,u],v=o.sort;v&&"asc"!==v&&"desc"!==v&&(v="desc");var _={squareRatio:o.squareRatio,sort:v,leafDepth:o.leafDepth};f.hostTree.clearLayouts(),y={x:0,y:0,width:m[0],height:m[1],area:m[0]*m[1]},f.setLayout(y),iu(f,_,!1,0);var y=f.getLayout();iA(g,function(e,t){var n=(g[t+1]||f).getValue();e.setLayout(a({dataExtent:[n,n],borderWidth:0,upperHeight:0},y))})}var x=e.getData().tree.root;x.setLayout(uu(s,p,h),!0),e.setLayoutInfo(s),cu(x,new jt(-s.x,-s.y,i,r),g,f,0)})});var lA=function(e){this._directed=e||!1,this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={},this.data,this.edgeData},cA=lA.prototype;cA.type="graph",cA.isDirected=function(){return this._directed},cA.addNode=function(e,t){e=e||""+t;var n=this._nodesMap;if(!n[fu(e)]){var i=new pu(e,t);return i.hostGraph=this,this.nodes.push(i),n[fu(e)]=i,i}},cA.getNodeByIndex=function(e){var t=this.data.getRawIndex(e);return this.nodes[t]},cA.getNodeById=function(e){return this._nodesMap[fu(e)]},cA.addEdge=function(e,t,n){var i=this._nodesMap,r=this._edgesMap;if("number"==typeof e&&(e=this.nodes[e]),"number"==typeof t&&(t=this.nodes[t]),e instanceof pu||(e=i[fu(e)]),t instanceof pu||(t=i[fu(t)]),e&&t){var o=e.id+"-"+t.id;if(!r[o]){var a=new gu(e,t,n);return a.hostGraph=this,this._directed&&(e.outEdges.push(a),t.inEdges.push(a)),e.edges.push(a),e!==t&&t.edges.push(a),this.edges.push(a),r[o]=a,a}}},cA.getEdgeByIndex=function(e){var t=this.edgeData.getRawIndex(e);return this.edges[t]},cA.getEdge=function(e,t){e instanceof pu&&(e=e.id),t instanceof pu&&(t=t.id);var n=this._edgesMap;return this._directed?n[e+"-"+t]:n[e+"-"+t]||n[t+"-"+e]},cA.eachNode=function(e,t){for(var n=this.nodes,i=n.length,r=0;r<i;r++)n[r].dataIndex>=0&&e.call(t,n[r],r)},cA.eachEdge=function(e,t){for(var n=this.edges,i=n.length,r=0;r<i;r++)n[r].dataIndex>=0&&n[r].node1.dataIndex>=0&&n[r].node2.dataIndex>=0&&e.call(t,n[r],r)},cA.breadthFirstTraverse=function(e,t,n,i){if(t instanceof pu||(t=this._nodesMap[fu(t)]),t){for(var r="out"===n?"outEdges":"in"===n?"inEdges":"edges",o=0;o<this.nodes.length;o++)this.nodes[o].__visited=!1;if(!e.call(i,t,null))for(var a=[t];a.length;)for(var s=a.shift(),l=s[r],o=0;o<l.length;o++){var c=l[o],u=c.node1===s?c.node2:c.node1;if(!u.__visited){if(e.call(i,u,s))return;a.push(u),u.__visited=!0}}}},cA.update=function(){for(var e=this.data,t=this.edgeData,n=this.nodes,i=this.edges,r=0,o=n.length;r<o;r++)n[r].dataIndex=-1;for(var r=0,o=e.count();r<o;r++)n[e.getRawIndex(r)].dataIndex=r;t.filterSelf(function(e){var n=i[t.getRawIndex(e)];return n.node1.dataIndex>=0&&n.node2.dataIndex>=0});for(var r=0,o=i.length;r<o;r++)i[r].dataIndex=-1;for(var r=0,o=t.count();r<o;r++)i[t.getRawIndex(r)].dataIndex=r},cA.clone=function(){for(var e=new lA(this._directed),t=this.nodes,n=this.edges,i=0;i<t.length;i++)e.addNode(t[i].id,t[i].dataIndex);for(i=0;i<n.length;i++){var r=n[i];e.addEdge(r.node1.id,r.node2.id,r.dataIndex)}return e},pu.prototype={constructor:pu,degree:function(){return this.edges.length},inDegree:function(){return this.inEdges.length},outDegree:function(){return this.outEdges.length},getModel:function(e){if(!(this.dataIndex<0))return this.hostGraph.data.getItemModel(this.dataIndex).getModel(e)}},gu.prototype.getModel=function(e){if(!(this.dataIndex<0))return this.hostGraph.edgeData.getItemModel(this.dataIndex).getModel(e)};var uA=function(e,t){return{getValue:function(n){var i=this[e][t];return i.get(i.getDimension(n||"value"),this.dataIndex)},setVisual:function(n,i){this.dataIndex>=0&&this[e][t].setItemVisual(this.dataIndex,n,i)},getVisual:function(n,i){return this[e][t].getItemVisual(this.dataIndex,n,i)},setLayout:function(n,i){this.dataIndex>=0&&this[e][t].setItemLayout(this.dataIndex,n,i)},getLayout:function(){return this[e][t].getItemLayout(this.dataIndex)},getGraphicEl:function(){return this[e][t].getItemGraphicEl(this.dataIndex)},getRawIndex:function(){return this[e][t].getRawIndex(this.dataIndex)}}};u(pu,uA("hostGraph","data")),u(gu,uA("hostGraph","edgeData")),lA.Node=pu,lA.Edge=gu;var dA=function(e,t,n,i,r){for(var o=new lA(i),a=0;a<e.length;a++)o.addNode(I(e[a].id,e[a].name,a),a);for(var s=[],l=[],c=0,a=0;a<t.length;a++){var u=t[a],d=u.source,h=u.target;o.addEdge(d,h,c)&&(l.push(u),s.push(I(u.id,d+" > "+h)),c++)}var p,f=n.get("coordinateSystem");if("cartesian2d"===f||"polar"===f)p=Sr(e,n,n.ecModel);else{var g=ua.get(f),m=xr((g&&"view"!==g.type?g.dimensions||[]:[]).concat(["value"]),e);(p=new sC(m,n)).initData(e)}var v=new sC(["value"],n);return v.initData(l,s),r&&r(p,v),ql({mainData:p,struct:o,structAttr:"graph",datas:{node:p,edge:v},datasAttr:{node:"data",edge:"edgeData"}}),o.update(),o},hA=hr({type:"series.graph",init:function(e){hA.superApply(this,"init",arguments),this.legendDataProvider=function(){return this._categoriesData},this.fillDataTextStyle(e.edges||e.links),this._updateCategoriesData()},mergeOption:function(e){hA.superApply(this,"mergeOption",arguments),this.fillDataTextStyle(e.edges||e.links),this._updateCategoriesData()},mergeDefaultAndTheme:function(e){hA.superApply(this,"mergeDefaultAndTheme",arguments),zo(e.edgeLabel,["show"])},getInitialData:function(e,t){var i=e.edges||e.links||[],r=e.data||e.nodes||[],o=this;if(r&&i)return dA(r,i,this,!0,function(e,i){function n(e){return(e=this.parsePath(e))&&"label"===e[0]?a:this.parentModel}e.wrapMethod("getItemModel",function(e){var t=o._categoriesModels[e.getShallow("category")];return t&&(t.parentModel=e.parentModel,e.parentModel=t),e});var r=o.getModel("edgeLabel"),a=new Lo({label:r.option},r.parentModel,t);i.wrapMethod("getItemModel",function(e){return e.customizeGetParent(n),e})}).data},getGraph:function(){return this.getData().graph},getEdgeData:function(){return this.getGraph().edgeData},getCategoriesData:function(){return this._categoriesData},formatTooltip:function(e,t,n){if("edge"===n){var i=this.getData(),r=this.getDataParams(e,n),o=i.graph.getEdgeByIndex(e),a=i.getName(o.node1.dataIndex),s=i.getName(o.node2.dataIndex),l=[];return null!=a&&l.push(a),null!=s&&l.push(s),l=Gi(l.join(" > ")),r.value&&(l+=" : "+Gi(r.value)),l}return hA.superApply(this,"formatTooltip",arguments)},_updateCategoriesData:function(){var e=f(this.option.categories||[],function(e){return null!=e.value?e:a({value:0},e)}),t=new sC(["value"],this);t.initData(e),this._categoriesData=t,this._categoriesModels=t.mapArray(function(e){return t.getItemModel(e,!0)})},setZoom:function(e){this.option.zoom=e},setCenter:function(e){this.option.center=e},isAnimationEnabled:function(){return hA.superCall(this,"isAnimationEnabled")&&!("force"===this.get("layout")&&this.get("force.layoutAnimation"))},defaultOption:{zlevel:0,z:2,coordinateSystem:"view",legendHoverLink:!0,hoverAnimation:!0,layout:null,focusNodeAdjacency:!1,circular:{rotateLabel:!1},force:{initLayout:null,repulsion:[0,50],gravity:.1,edgeLength:30,layoutAnimation:!0},left:"center",top:"center",symbol:"circle",symbolSize:10,edgeSymbol:["none","none"],edgeSymbolSize:10,edgeLabel:{normal:{position:"middle"},emphasis:{}},draggable:!1,roam:!1,center:null,zoom:1,nodeScaleRatio:.6,label:{normal:{show:!1,formatter:"{b}"},emphasis:{show:!0}},itemStyle:{normal:{},emphasis:{}},lineStyle:{normal:{color:"#aaa",width:1,curveness:0,opacity:.5},emphasis:{}}}}),pA=gb.prototype,fA=vb.prototype,gA=Zn({type:"ec-line",style:{stroke:"#000",fill:null},shape:{x1:0,y1:0,x2:0,y2:0,percent:1,cpx1:null,cpy1:null},buildPath:function(e,t){(mu(t)?pA:fA).buildPath(e,t)},pointAt:function(e){return mu(this.shape)?pA.pointAt.call(this,e):fA.pointAt.call(this,e)},tangentAt:function(e){var t=this.shape,n=mu(t)?[t.x2-t.x1,t.y2-t.y1]:fA.tangentAt.call(this,e);return X(n,n)}}),mA=["fromSymbol","toSymbol"],vA=bu.prototype;vA.beforeUpdate=function(){var e=this,t=e.childOfName("fromSymbol"),n=e.childOfName("toSymbol"),i=e.childOfName("label");if(t||n||!i.ignore){for(var r=1,o=this.parent;o;)o.scale&&(r/=o.scale[0]),o=o.parent;var a=e.childOfName("line");if(this.__dirty||a.__dirty){var s=a.shape.percent,l=a.pointAt(0),c=a.pointAt(s),u=H([],c,l);if(X(u,u),t&&(t.attr("position",l),d=a.tangentAt(0),t.attr("rotation",Math.PI/2-Math.atan2(d[1],d[0])),t.attr("scale",[r*s,r*s])),n){n.attr("position",c);var d=a.tangentAt(1);n.attr("rotation",-Math.PI/2-Math.atan2(d[1],d[0])),n.attr("scale",[r*s,r*s])}if(!i.ignore){i.attr("position",c);var h,p,f,g=5*r;if("end"===i.__position)h=[u[0]*g+c[0],u[1]*g+c[1]],p=u[0]>.8?"left":u[0]<-.8?"right":"center",f=u[1]>.8?"top":u[1]<-.8?"bottom":"middle";else if("middle"===i.__position){var m=s/2,v=[(d=a.tangentAt(m))[1],-d[0]],_=a.pointAt(m);v[1]>0&&(v[0]=-v[0],v[1]=-v[1]),h=[_[0]+v[0]*g,_[1]+v[1]*g],p="center",f="bottom";var y=-Math.atan2(d[1],d[0]);c[0]<l[0]&&(y=Math.PI+y),i.attr("rotation",y)}else h=[-u[0]*g+l[0],-u[1]*g+l[1]],p=u[0]>.8?"right":u[0]<-.8?"left":"center",f=u[1]>.8?"bottom":u[1]<-.8?"top":"middle";i.attr({style:{textVerticalAlign:i.__verticalAlign||f,textAlign:i.__textAlign||p},position:h,scale:[r,r]})}}}},vA._createLine=function(e,t,n){var i=e.hostModel,r=xu(e.getItemLayout(t));r.shape.percent=0,So(r,{shape:{percent:1}},i,t),this.add(r);var o=new rb({name:"label"});this.add(o),d(mA,function(n){var i=yu(n,e,t);this.add(i),this[vu(n)]=e.getItemVisual(t,n)},this),this._updateCommonStl(e,t,n)},vA.updateData=function(e,t,n){var i=e.hostModel,r=this.childOfName("line"),o=e.getItemLayout(t),a={shape:{}};_u(a.shape,o),wo(r,a,i,t),d(mA,function(n){var i=e.getItemVisual(t,n),r=vu(n);if(this[r]!==i){this.remove(this.childOfName(n));var o=yu(n,e,t);this.add(o)}this[r]=i},this),this._updateCommonStl(e,t,n)},vA._updateCommonStl=function(e,t,n){var i=e.hostModel,o=this.childOfName("line"),a=n&&n.lineStyle,s=n&&n.hoverLineStyle,l=n&&n.labelModel,c=n&&n.hoverLabelModel;if(!n||e.hasItemOption){var u=e.getItemModel(t);a=u.getModel("lineStyle.normal").getLineStyle(),s=u.getModel("lineStyle.emphasis").getLineStyle(),l=u.getModel("label.normal"),c=u.getModel("label.emphasis")}var h=e.getItemVisual(t,"color"),p=A(e.getItemVisual(t,"opacity"),a.opacity,1);o.useStyle(r({strokeNoScale:!0,fill:"none",stroke:h,opacity:p},a)),o.hoverStyle=s,d(mA,function(e){var t=this.childOfName(e);t&&(t.setColor(h),t.setStyle({opacity:p}))},this);var f,g,m,v,_=l.getShallow("show"),y=c.getShallow("show"),x=this.childOfName("label");if(_||y){var b=i.getRawValue(t);g=null==b?g=e.getName(t):isFinite(b)?Mi(b):b,f=h||"#000",m=T(i.getFormattedLabel(t,"normal",e.dataType),g),v=T(i.getFormattedLabel(t,"emphasis",e.dataType),m)}if(_){var w=fo(x.style,l,{text:m},{autoColor:f});x.__textAlign=w.textAlign,x.__verticalAlign=w.textVerticalAlign,x.__position=l.get("position")||"middle"}else x.setStyle("text",null);x.hoverStyle=y?{text:v,textFill:c.getTextColor(!0),fontStyle:c.getShallow("fontStyle"),fontWeight:c.getShallow("fontWeight"),fontSize:c.getShallow("fontSize"),fontFamily:c.getShallow("fontFamily")}:{text:null},x.ignore=!_&&!y,uo(this)},vA.highlight=function(){this.trigger("emphasis")},vA.downplay=function(){this.trigger("normal")},vA.updateLayout=function(e,t){this.setLinePoints(e.getItemLayout(t))},vA.setLinePoints=function(e){var t=this.childOfName("line");_u(t.shape,e),t.dirty()},h(bu,X_);var _A=Mu.prototype;_A.updateData=function(e){var t=this._lineData,n=this.group,i=this._ctor,r=e.hostModel,o={lineStyle:r.getModel("lineStyle.normal").getLineStyle(),hoverLineStyle:r.getModel("lineStyle.emphasis").getLineStyle(),labelModel:r.getModel("label.normal"),hoverLabelModel:r.getModel("label.emphasis")};e.diff(t).add(function(t){if(Su(e.getItemLayout(t))){var r=new i(e,t,o);e.setItemGraphicEl(t,r),n.add(r)}}).update(function(r,a){var s=t.getItemGraphicEl(a);Su(e.getItemLayout(r))?(s?s.updateData(e,r,o):s=new i(e,r,o),e.setItemGraphicEl(r,s),n.add(s)):n.remove(s)}).remove(function(e){n.remove(t.getItemGraphicEl(e))}).execute(),this._lineData=e},_A.updateLayout=function(){var e=this._lineData;e.eachItemGraphicEl(function(t,n){t.updateLayout(e,n)},this)},_A.remove=function(){this.group.removeAll()};var yA=[],xA=[],bA=[],wA=un,CA=h_,SA=Math.abs,TA=function(e,t){function i(e){var t=e.getVisual("symbolSize");return t instanceof Array&&(t=(t[0]+t[1])/2),t}var n=[],r=pn,o=[[],[],[]],a=[[],[]],s=[];t/=2,e.eachEdge(function(e,l){var c=e.getLayout(),u=e.getVisual("fromSymbol"),d=e.getVisual("toSymbol");c.__original||(c.__original=[V(c[0]),V(c[1])],c[2]&&c.__original.push(V(c[2])));var h=c.__original;if(null!=c[2]){if(R(o[0],h[0]),R(o[1],h[2]),R(o[2],h[1]),u&&"none"!=u){var p=i(e.node1),f=Iu(o,h[0],p*t);r(o[0][0],o[1][0],o[2][0],f,n),o[0][0]=n[3],o[1][0]=n[4],r(o[0][1],o[1][1],o[2][1],f,n),o[0][1]=n[3],o[1][1]=n[4]}if(d&&"none"!=d){var p=i(e.node2),f=Iu(o,h[1],p*t);r(o[0][0],o[1][0],o[2][0],f,n),o[1][0]=n[1],o[2][0]=n[2],r(o[0][1],o[1][1],o[2][1],f,n),o[1][1]=n[1],o[2][1]=n[2]}R(c[0],o[0]),R(c[1],o[2]),R(c[2],o[1])}else R(a[0],h[0]),R(a[1],h[1]),H(s,a[1],a[0]),X(s,s),u&&"none"!=u&&(p=i(e.node1),W(a[0],a[0],s,p*t)),d&&"none"!=d&&(p=i(e.node2),W(a[1],a[1],s,-p*t)),R(c[0],a[0]),R(c[1],a[1])})},AA=["itemStyle","normal","opacity"],MA=["lineStyle","normal","opacity"];ur({type:"graph",init:function(e,t){var n=new ts,i=new Mu,r=this.group;this._controller=new kl(t.getZr()),this._controllerHost={target:r},r.add(n.group),r.add(i.group),this._symbolDraw=n,this._lineDraw=i,this._firstRender=!0},render:function(e,t,n){var i=e.coordinateSystem;this._model=e,this._nodeScaleRatio=e.get("nodeScaleRatio");var r=this._symbolDraw,o=this._lineDraw,a=this.group;if("view"===i.type){var s={position:i.position,scale:i.scale};this._firstRender?a.attr(s):wo(a,s,e)}TA(e.getGraph(),this._getNodeGlobalScale(e));var l=e.getData();r.updateData(l);var c=e.getEdgeData();o.updateData(c),this._updateNodeAndLinkScale(),this._updateController(e,t,n),clearTimeout(this._layoutTimeout);var u=e.forceLayout,d=e.get("force.layoutAnimation");u&&this._startForceLayoutIteration(u,d),l.eachItemGraphicEl(function(t,i){var r=l.getItemModel(i);t.off("drag").off("dragend");var o=l.getItemModel(i).get("draggable");o&&t.on("drag",function(){u&&(u.warmUp(),!this._layouting&&this._startForceLayoutIteration(u,d),u.setFixed(i),l.setItemLayout(i,t.position))},this).on("dragend",function(){u&&u.setUnfixed(i)},this),t.setDraggable(o&&u),t.off("mouseover",t.__focusNodeAdjacency),t.off("mouseout",t.__unfocusNodeAdjacency),r.get("focusNodeAdjacency")&&(t.on("mouseover",t.__focusNodeAdjacency=function(){n.dispatchAction({type:"focusNodeAdjacency",seriesId:e.id,dataIndex:t.dataIndex})}),t.on("mouseout",t.__unfocusNodeAdjacency=function(){n.dispatchAction({type:"unfocusNodeAdjacency",seriesId:e.id})}))},this),l.graph.eachEdge(function(t){var i=t.getGraphicEl();i.off("mouseover",i.__focusNodeAdjacency),i.off("mouseout",i.__unfocusNodeAdjacency),t.getModel().get("focusNodeAdjacency")&&(i.on("mouseover",i.__focusNodeAdjacency=function(){n.dispatchAction({type:"focusNodeAdjacency",seriesId:e.id,edgeDataIndex:t.dataIndex})}),i.on("mouseout",i.__unfocusNodeAdjacency=function(){n.dispatchAction({type:"unfocusNodeAdjacency",seriesId:e.id})}))});var h="circular"===e.get("layout")&&e.get("circular.rotateLabel"),p=l.getLayout("cx"),f=l.getLayout("cy");l.eachItemGraphicEl(function(e,t){var n=e.getSymbolPath();if(h){var i=l.getItemLayout(t),r=Math.atan2(i[1]-f,i[0]-p);r<0&&(r=2*Math.PI+r);var o=i[0]<p;o&&(r-=Math.PI);var a=o?"left":"right";n.setStyle({textRotation:-r,textPosition:a,textOrigin:"center"}),n.hoverStyle&&(n.hoverStyle.textPosition=a)}else n.setStyle({textRotation:0})}),this._firstRender=!1},dispose:function(){this._controller&&this._controller.dispose(),this._controllerHost={}},focusNodeAdjacency:function(e,t,n,i){var r=this._model.getData().graph,o=i.dataIndex,a=i.edgeDataIndex,s=r.getNodeByIndex(o),l=r.getEdgeByIndex(a);(s||l)&&(r.eachNode(function(e){Au(e,AA,.1)}),r.eachEdge(function(e){Au(e,MA,.1)}),s&&(Cu(s,AA),d(s.edges,function(e){e.dataIndex<0||(Cu(e,MA),Cu(e.node1,AA),Cu(e.node2,AA))})),l&&(Cu(l,MA),Cu(l.node1,AA),Cu(l.node2,AA)))},unfocusNodeAdjacency:function(e,t,n,i){var r=this._model.getData().graph;r.eachNode(function(e){Au(e,AA)}),r.eachEdge(function(e){Au(e,MA)})},_startForceLayoutIteration:function(e,t){var i=this;!function n(){e.step(function(e){i.updateLayout(i._model),(i._layouting=!e)&&(t?i._layoutTimeout=setTimeout(n,16):n())})}()},_updateController:function(e,t,n){var i=this._controller,r=this._controllerHost,o=this.group;i.setPointerChecker(function(t,i,r){var a=o.getBoundingRect();return a.applyTransform(o.transform),a.contain(i,r)&&!Wl(t,n,e)}),"view"===e.coordinateSystem.type?(i.enable(e.get("roam")),r.zoomLimit=e.get("scaleLimit"),r.zoom=e.coordinateSystem.getZoom(),i.off("pan").off("zoom").on("pan",function(t,i){Bl(r,t,i),n.dispatchAction({seriesId:e.id,type:"graphRoam",dx:t,dy:i})}).on("zoom",function(t,i,o){Gl(r,t,i,o),n.dispatchAction({seriesId:e.id,type:"graphRoam",zoom:t,originX:i,originY:o}),this._updateNodeAndLinkScale(),TA(e.getGraph(),this._getNodeGlobalScale(e)),this._lineDraw.updateLayout()},this)):i.disable()},_updateNodeAndLinkScale:function(){var e=this._model,t=e.getData(),n=this._getNodeGlobalScale(e),i=[n,n];t.eachItemGraphicEl(function(e,t){e.attr("scale",i)})},_getNodeGlobalScale:function(e){var t=e.coordinateSystem;if("view"!==t.type)return 1;var n=this._nodeScaleRatio,i=t.scale,r=i&&i[0]||1;return((t.getZoom()-1)*n+1)/r},updateLayout:function(e){TA(e.getGraph(),this._getNodeGlobalScale(e)),this._symbolDraw.updateLayout(),this._lineDraw.updateLayout()},remove:function(e,t){this._symbolDraw&&this._symbolDraw.remove(),this._lineDraw&&this._lineDraw.remove()}}),ir({type:"graphRoam",event:"graphRoam",update:"none"},function(e,t){t.eachComponent({mainType:"series",query:e},function(t){var n=Xl(t.coordinateSystem,e);t.setCenter&&t.setCenter(n.center),t.setZoom&&t.setZoom(n.zoom)})}),ir({type:"focusNodeAdjacency",event:"focusNodeAdjacency",update:"series.graph:focusNodeAdjacency"},function(){}),ir({type:"unfocusNodeAdjacency",event:"unfocusNodeAdjacency",update:"series.graph:unfocusNodeAdjacency"},function(){});var EA=W;er(function(e){var t=e.findComponents({mainType:"legend"});t&&t.length&&e.eachSeriesByType("graph",function(e){var n=e.getCategoriesData(),i=e.getGraph().data,r=n.mapArray(n.getName);i.filterSelf(function(e){var n=i.getItemModel(e).getShallow("category");if(null!=n){"number"==typeof n&&(n=r[n]);for(var o=0;o<t.length;o++)if(!t[o].isSelected(n))return!1}return!0})},this)}),ar(v(pS,"graph","circle",null)),ar(function(e){var t={};e.eachSeriesByType("graph",function(e){var n=e.getCategoriesData(),i=e.getData(),r={};n.each(function(i){var o=n.getName(i);r["ec-"+o]=i;var a=n.getItemModel(i).get("itemStyle.normal.color")||e.getColorFromPalette(o,t);n.setItemVisual(i,"color",a)}),n.count()&&i.each(function(e){var t=i.getItemModel(e).getShallow("category");null!=t&&("string"==typeof t&&(t=r["ec-"+t]),i.getItemVisual(e,"color",!0)||i.setItemVisual(e,"color",n.getItemVisual(t,"color")))})})}),ar(function(e){e.eachSeriesByType("graph",function(e){var t=e.getGraph(),n=e.getEdgeData(),i=Du(e.get("edgeSymbol")),r=Du(e.get("edgeSymbolSize")),o="lineStyle.normal.color".split("."),a="lineStyle.normal.opacity".split(".");n.setVisual("fromSymbol",i&&i[0]),n.setVisual("toSymbol",i&&i[1]),n.setVisual("fromSymbolSize",r&&r[0]),n.setVisual("toSymbolSize",r&&r[1]),n.setVisual("color",e.get(o)),n.setVisual("opacity",e.get(a)),n.each(function(e){var i=n.getItemModel(e),r=t.getEdgeByIndex(e),s=Du(i.getShallow("symbol",!0)),l=Du(i.getShallow("symbolSize",!0)),c=i.get(o),u=i.get(a);switch(c){case"source":c=r.node1.getVisual("color");break;case"target":c=r.node2.getVisual("color")}s[0]&&r.setVisual("fromSymbol",s[0]),s[1]&&r.setVisual("toSymbol",s[1]),l[0]&&r.setVisual("fromSymbolSize",l[0]),l[1]&&r.setVisual("toSymbolSize",l[1]),r.setVisual("color",c),r.setVisual("opacity",u)})})}),or(function(e,t){e.eachSeriesByType("graph",function(e){var t=e.get("layout"),n=e.coordinateSystem;if(n&&"view"!==n.type){var i=e.getData(),r=n.dimensions;i.each(r,function(){for(var e,t=arguments,o=[],a=0;a<r.length;a++)isNaN(t[a])||(e=!0),o.push(t[a]);var s=t[t.length-1];e?i.setItemLayout(s,n.dataToPoint(o)):i.setItemLayout(s,[NaN,NaN])}),ku(i.graph)}else t&&"none"!==t||Lu(e)})}),or(function(e){e.eachSeriesByType("graph",function(e){"circular"===e.get("layout")&&Pu(e)})}),or(function(e){e.eachSeriesByType("graph",function(e){var t=e.coordinateSystem;if(!t||"view"===t.type)if("force"===e.get("layout")){var n=e.preservedPoints||{},i=e.getGraph(),r=i.data,o=i.edgeData,a=e.getModel("force"),s=a.get("initLayout");e.preservedPoints?r.each(function(e){var t=r.getId(e);r.setItemLayout(e,n[t]||[NaN,NaN])}):s&&"none"!==s?"circular"===s&&Pu(e):Lu(e);var l=r.getDataExtent("value"),c=o.getDataExtent("value"),u=a.get("repulsion"),d=a.get("edgeLength");y(u)||(u=[u,u]),y(d)||(d=[d,d]),d=[d[1],d[0]];var h=r.mapArray("value",function(e,t){var n=r.getItemLayout(t),i=wi(e,l,u);return isNaN(i)&&(i=(u[0]+u[1])/2),{w:i,rep:i,fixed:r.getItemModel(t).get("fixed"),p:!n||isNaN(n[0])||isNaN(n[1])?null:n}}),p=o.mapArray("value",function(e,t){var n=i.getEdgeByIndex(t),r=wi(e,c,d);return isNaN(r)&&(r=(d[0]+d[1])/2),{n1:h[n.node1.dataIndex],n2:h[n.node2.dataIndex],d:r,curveness:n.getModel().get("lineStyle.normal.curveness")||0}}),f=(t=e.coordinateSystem).getBoundingRect(),g=Ou(h,p,{rect:f,gravity:a.get("gravity")}),m=g.step;g.step=function(e){for(var t=0,o=h.length;t<o;t++)h[t].fixed&&R(h[t].p,i.getNodeByIndex(t).getLayout());m(function(t,o,a){for(var s=0,l=t.length;s<l;s++)t[s].fixed||i.getNodeByIndex(s).setLayout(t[s].p),n[r.getId(s)]=t[s].p;for(var s=0,l=o.length;s<l;s++){var c=o[s],u=i.getEdgeByIndex(s),d=c.n1.p,h=c.n2.p,p=u.getLayout();(p=p?p.slice():[])[0]=p[0]||[],p[1]=p[1]||[],R(p[0],d),R(p[1],h),+c.curveness&&(p[2]=[(d[0]+h[0])/2-(d[1]-h[1])*c.curveness,(d[1]+h[1])/2-(h[0]-d[0])*c.curveness]),u.setLayout(p)}e&&e(a)})},e.forceLayout=g,e.preservedPoints=n,g.step()}else e.forceLayout=null})}),nr("graphView",{create:function(e,t){var n=[];return e.eachSeriesByType("graph",function(e){var i=e.get("coordinateSystem");if(!i||"view"===i){var r=e.getData(),o=[],a=[];mn(r.mapArray(function(e){var t=r.getItemModel(e);return[+t.get("x"),+t.get("y")]}),o,a),a[0]-o[0]==0&&(a[0]+=1,o[0]-=1),a[1]-o[1]==0&&(a[1]+=1,o[1]-=1);var s=(a[0]-o[0])/(a[1]-o[1]),l=zu(e,t,s);isNaN(s)&&(o=[l.x,l.y],a=[l.x+l.width,l.y+l.height]);var c=a[0]-o[0],u=a[1]-o[1],d=l.width,h=l.height,p=e.coordinateSystem=new bl;p.zoomLimit=e.get("scaleLimit"),p.setBoundingRect(o[0],o[1],c,u),p.setViewRect(l.x,l.y,d,h),p.setCenter(e.get("center")),p.setZoom(e.get("zoom")),n.push(p)}}),n}}),xw.extend({type:"series.gauge",getInitialData:function(e,t){var n=new sC(["value"],this),i=e.data||[];return y(i)||(i=[i]),n.initData(i),n},defaultOption:{zlevel:0,z:2,center:["50%","50%"],legendHoverLink:!0,radius:"75%",startAngle:225,endAngle:-45,clockwise:!0,min:0,max:100,splitNumber:10,axisLine:{show:!0,lineStyle:{color:[[.2,"#91c7ae"],[.8,"#63869e"],[1,"#c23531"]],width:30}},splitLine:{show:!0,length:30,lineStyle:{color:"#eee",width:2,type:"solid"}},axisTick:{show:!0,splitNumber:5,length:8,lineStyle:{color:"#eee",width:1,type:"solid"}},axisLabel:{show:!0,distance:5,color:"auto"},pointer:{show:!0,length:"80%",width:8},itemStyle:{normal:{color:"auto"}},title:{show:!0,offsetCenter:[0,"-40%"],color:"#333",fontSize:15},detail:{show:!0,backgroundColor:"rgba(0,0,0,0)",borderWidth:0,borderColor:"#ccc",width:100,height:null,padding:[5,10],offsetCenter:[0,"40%"],color:"auto",fontSize:30}}});var IA=Nn.extend({type:"echartsGaugePointer",shape:{angle:0,width:10,r:10,x:0,y:0},buildPath:function(e,t){var n=Math.cos,i=Math.sin,r=t.r,o=t.width,a=t.angle,s=t.x-n(a)*o*(o>=r/3?1:2),l=t.y-i(a)*o*(o>=r/3?1:2);a=t.angle-Math.PI/2,e.moveTo(s,l),e.lineTo(t.x+n(a)*o,t.y+i(a)*o),e.lineTo(t.x+n(t.angle)*r,t.y+i(t.angle)*r),e.lineTo(t.x-n(a)*o,t.y-i(a)*o),e.lineTo(s,l)}}),DA=2*Math.PI,kA=(Ta.extend({type:"gauge",render:function(e,t,n){this.group.removeAll();var i=e.get("axisLine.lineStyle.color"),r=Nu(e,n);this._renderMain(e,t,n,i,r)},dispose:function(){},_renderMain:function(e,t,n,i,r){for(var o=this.group,a=e.getModel("axisLine").getModel("lineStyle"),s=e.get("clockwise"),l=-e.get("startAngle")/180*Math.PI,c=-e.get("endAngle")/180*Math.PI,u=(c-l)%DA,d=l,h=a.get("width"),p=0;p<i.length;p++){var f=Math.min(Math.max(i[p][0],0),1),g=new lb({shape:{startAngle:d,endAngle:c=l+u*f,cx:r.cx,cy:r.cy,clockwise:s,r0:r.r-h,r:r.r},silent:!0});g.setStyle({fill:i[p][1]}),g.setStyle(a.getLineStyle(["color","borderWidth","borderColor"])),o.add(g),d=c}var m=function(e){if(e<=0)return i[0][1];for(var t=0;t<i.length;t++)if(i[t][0]>=e&&(0===t?0:i[t-1][0])<e)return i[t][1];return i[t-1][1]};if(!s){var v=l;l=c,c=v}this._renderTicks(e,t,n,m,r,l,c,s),this._renderPointer(e,t,n,m,r,l,c,s),this._renderTitle(e,t,n,m,r),this._renderDetail(e,t,n,m,r)},_renderTicks:function(e,t,n,i,r,o,a,s){for(var l=this.group,c=r.cx,u=r.cy,d=r.r,h=+e.get("min"),p=+e.get("max"),f=e.getModel("splitLine"),g=e.getModel("axisTick"),m=e.getModel("axisLabel"),v=e.get("splitNumber"),_=g.get("splitNumber"),y=Si(f.get("length"),d),x=Si(g.get("length"),d),b=o,w=(a-o)/v,C=w/_,S=f.getModel("lineStyle").getLineStyle(),T=g.getModel("lineStyle").getLineStyle(),A=0;A<=v;A++){var M=Math.cos(b),E=Math.sin(b);if(f.get("show")){var I=new gb({shape:{x1:M*d+c,y1:E*d+u,x2:M*(d-y)+c,y2:E*(d-y)+u},style:S,silent:!0});"auto"===S.stroke&&I.setStyle({stroke:i(A/v)}),l.add(I)}if(m.get("show")){var D=Eu(Mi(A/v*(p-h)+h),m.get("formatter")),k=m.get("distance"),L=i(A/v);l.add(new rb({style:fo({},m,{text:D,x:M*(d-y-k)+c,y:E*(d-y-k)+u,textVerticalAlign:E<-.4?"top":E>.4?"bottom":"middle",textAlign:M<-.4?"left":M>.4?"right":"center"},{autoColor:L}),silent:!0}))}if(g.get("show")&&A!==v){for(var N=0;N<=_;N++){var M=Math.cos(b),E=Math.sin(b),P=new gb({shape:{x1:M*d+c,y1:E*d+u,x2:M*(d-x)+c,y2:E*(d-x)+u},silent:!0,style:T});"auto"===T.stroke&&P.setStyle({stroke:i((A+N/_)/v)}),l.add(P),b+=C}b-=C}else b+=w}},_renderPointer:function(e,t,n,i,r,o,a,s){var l=this.group,c=this._data;if(e.get("pointer.show")){var u=[+e.get("min"),+e.get("max")],d=[o,a],h=e.getData();h.diff(c).add(function(t){var n=new IA({shape:{angle:o}});So(n,{shape:{angle:wi(h.get("value",t),u,d,!0)}},e),l.add(n),h.setItemGraphicEl(t,n)}).update(function(t,n){var i=c.getItemGraphicEl(n);wo(i,{shape:{angle:wi(h.get("value",t),u,d,!0)}},e),l.add(i),h.setItemGraphicEl(t,i)}).remove(function(e){var t=c.getItemGraphicEl(e);l.remove(t)}).execute(),h.eachItemGraphicEl(function(e,t){var n=h.getItemModel(t),o=n.getModel("pointer");e.setShape({x:r.cx,y:r.cy,width:Si(o.get("width"),r.r),r:Si(o.get("length"),r.r)}),e.useStyle(n.getModel("itemStyle.normal").getItemStyle()),"auto"===e.style.fill&&e.setStyle("fill",i(wi(h.get("value",t),u,[0,1],!0))),uo(e,n.getModel("itemStyle.emphasis").getItemStyle())}),this._data=h}else c&&c.eachItemGraphicEl(function(e){l.remove(e)})},_renderTitle:function(e,t,n,i,r){var o=e.getModel("title");if(o.get("show")){var a=o.get("offsetCenter"),s=r.cx+Si(a[0],r.r),l=r.cy+Si(a[1],r.r),c=+e.get("min"),u=+e.get("max"),d=i(wi(e.getData().get("value",0),[c,u],[0,1],!0));this.group.add(new rb({silent:!0,style:fo({},o,{x:s,y:l,text:e.getData().getName(0),textAlign:"center",textVerticalAlign:"middle"},{autoColor:d,forceRich:!0})}))}},_renderDetail:function(e,t,n,i,r){var o=e.getModel("detail"),a=+e.get("min"),s=+e.get("max");if(o.get("show")){var l=o.get("offsetCenter"),c=r.cx+Si(l[0],r.r),u=r.cy+Si(l[1],r.r),d=Si(o.get("width"),r.r),h=Si(o.get("height"),r.r),p=e.getData().get("value",0),f=i(wi(p,[a,s],[0,1],!0));this.group.add(new rb({silent:!0,style:fo({},o,{x:c,y:u,text:Eu(p,o.get("formatter")),textWidth:isNaN(d)?null:d,textHeight:isNaN(h)?null:h,textAlign:"center",textVerticalAlign:"middle"},{autoColor:f,forceRich:!0})}))}}}),hr({type:"series.funnel",init:function(e){kA.superApply(this,"init",arguments),this.legendDataProvider=function(){return this.getRawData()},this._defaultLabelLine(e)},getInitialData:function(e,t){var n=xr(["value"],e.data),i=new sC(n,this);return i.initData(e.data),i},_defaultLabelLine:function(e){zo(e.labelLine,["show"]);var t=e.labelLine.normal,n=e.labelLine.emphasis;t.show=t.show&&e.label.normal.show,n.show=n.show&&e.label.emphasis.show},getDataParams:function(e){var t=this.getData(),n=kA.superCall(this,"getDataParams",e),i=t.getSum("value");return n.percent=i?+(t.get("value",e)/i*100).toFixed(2):0,n.$vars.push("percent"),n},defaultOption:{zlevel:0,z:2,legendHoverLink:!0,left:80,top:60,right:80,bottom:60,minSize:"0%",maxSize:"100%",sort:"descending",gap:0,funnelAlign:"center",label:{normal:{show:!0,position:"outer"},emphasis:{show:!0}},labelLine:{normal:{show:!0,length:20,lineStyle:{width:1,type:"solid"}},emphasis:{}},itemStyle:{normal:{borderColor:"#fff",borderWidth:1},emphasis:{}}}})),LA=Ru.prototype,NA=["itemStyle","normal","opacity"];LA.updateData=function(e,t,n){var i=this.childAt(0),o=e.hostModel,a=e.getItemModel(t),s=e.getItemLayout(t),l=e.getItemModel(t).get(NA);l=null==l?1:l,i.useStyle({}),n?(i.setShape({points:s.points}),i.setStyle({opacity:0}),So(i,{style:{opacity:l}},o,t)):wo(i,{style:{opacity:l},shape:{points:s.points}},o,t);var c=a.getModel("itemStyle"),u=e.getItemVisual(t,"color");i.setStyle(r({lineJoin:"round",fill:u},c.getModel("normal").getItemStyle(["opacity"]))),i.hoverStyle=c.getModel("emphasis").getItemStyle(),this._updateLabel(e,t),uo(this)},LA._updateLabel=function(e,t){var n=this.childAt(1),i=this.childAt(2),r=e.hostModel,o=e.getItemModel(t),a=e.getItemLayout(t).label,s=e.getItemVisual(t,"color");wo(n,{shape:{points:a.linePoints||a.linePoints}},r,t),wo(i,{style:{x:a.x,y:a.y}},r,t),i.attr({rotation:a.rotation,origin:[a.x,a.y],z2:10});var l=o.getModel("label.normal"),c=o.getModel("label.emphasis"),u=o.getModel("labelLine.normal"),d=o.getModel("labelLine.emphasis"),s=e.getItemVisual(t,"color");co(i.style,i.hoverStyle={},l,c,{labelFetcher:e.hostModel,labelDataIndex:t,defaultText:e.getName(t),autoColor:s,useInsideStyle:!!a.inside},{textAlign:a.textAlign,textVerticalAlign:a.verticalAlign}),i.ignore=i.normalIgnore=!l.get("show"),i.hoverIgnore=!c.get("show"),n.ignore=n.normalIgnore=!u.get("show"),n.hoverIgnore=!d.get("show"),n.setStyle({stroke:s}),n.setStyle(u.getModel("lineStyle").getLineStyle()),n.hoverStyle=d.getModel("lineStyle").getLineStyle()},h(Ru,X_),Ta.extend({type:"funnel",render:function(e,t,n){var i=e.getData(),r=this._data,o=this.group;i.diff(r).add(function(e){var t=new Ru(i,e);i.setItemGraphicEl(e,t),o.add(t)}).update(function(e,t){var n=r.getItemGraphicEl(t);n.updateData(i,e),o.add(n),i.setItemGraphicEl(e,n)}).remove(function(e){var t=r.getItemGraphicEl(e);o.remove(t)}).execute(),this._data=i},remove:function(){this.group.removeAll(),this._data=null},dispose:function(){}}),ar(v(nT,"funnel")),or(function(e,t,n){e.eachSeriesByType("funnel",function(e){var n=e.getData(),i=e.get("sort"),r=Vu(e,t),o=Bu(n,i),a=[Si(e.get("minSize"),r.width),Si(e.get("maxSize"),r.width)],s=n.getDataExtent("value"),l=e.get("min"),c=e.get("max");null==l&&(l=Math.min(s[0],0)),null==c&&(c=s[1]);var u=e.get("funnelAlign"),d=e.get("gap"),h=(r.height-d*(n.count()-1))/n.count(),p=r.y,f=function(e,t){var i,o=wi(n.get("value",e)||0,[l,c],a,!0);switch(u){case"left":i=r.x;break;case"center":i=r.x+(r.width-o)/2;break;case"right":i=r.x+r.width-o}return[[i,t],[i+o,t]]};"ascending"===i&&(h=-h,d=-d,p+=r.height,o=o.reverse());for(var g=0;g<o.length;g++){var m=o[g],v=o[g+1],_=f(m,p),y=f(v,p+h);p+=h+d,n.setItemLayout(m,{points:_.concat(y.slice().reverse())})}Gu(n)})}),er(v(aT,"funnel"));var PA=function(e,t,n,i,r){jC.call(this,e,t,n),this.type=i||"value",this.axisIndex=r};PA.prototype={constructor:PA,model:null,isHorizontal:function(){return"horizontal"!==this.coordinateSystem.getModel().get("layout")}},h(PA,jC);var OA=function(e,t,n,i,r,o){t[0]=Zu(t[0],n),t[1]=Zu(t[1],n),e=e||0;var a=n[1]-n[0];null!=r&&(r=Zu(r,[0,a])),null!=o&&(o=Math.max(o,null!=r?r:0)),"all"===i&&(r=o=Math.abs(t[1]-t[0]),i=0);var s=Fu(t,i);t[i]+=e;var l=r||0,c=n.slice();s.sign<0?c[0]+=l:c[1]-=l,t[i]=Zu(t[i],c),u=Fu(t,i),null!=r&&(u.sign!==s.sign||u.span<r)&&(t[1-i]=t[i]+s.sign*r);var u=Fu(t,i);return null!=o&&u.span>o&&(t[1-i]=t[i]+u.sign*o),t},RA=d,zA=Math.min,FA=Math.max,BA=Math.floor,HA=Math.ceil,VA=Mi,WA=Math.PI;Uu.prototype={type:"parallel",constructor:Uu,_init:function(e,t,n){var i=e.dimensions,r=e.parallelAxisIndex;RA(i,function(e,n){var i=r[n],o=t.getComponent("parallelAxis",i),a=this._axesMap.set(e,new PA(e,Er(o),[0,0],o.get("type"),i)),s="category"===a.type;a.onBand=s&&o.get("boundaryGap"),a.inverse=o.get("inverse"),o.axis=a,a.model=o,a.coordinateSystem=o.coordinateSystem=this},this)},update:function(e,t){this._updateAxesFromSeries(this._model,e)},containPoint:function(e){var t=this._makeLayoutInfo(),n=t.axisBase,i=t.layoutBase,r=t.pixelDimIndex,o=e[1-r],a=e[r];return o>=n&&o<=n+t.axisLength&&a>=i&&a<=i+t.layoutLength},getModel:function(){return this._model},_updateAxesFromSeries:function(e,t){t.eachSeries(function(n){if(e.contains(n,t)){var i=n.getData();RA(this.dimensions,function(e){var t=this._axesMap.get(e);t.scale.unionExtentFromData(i,e),Nr(t.scale,t.model)},this)}},this)},resize:function(e,t){this._rect=Ko(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()}),this._layoutAxes()},getRect:function(){return this._rect},_makeLayoutInfo:function(){var e,t=this._model,n=this._rect,i=["x","y"],r=["width","height"],o=t.get("layout"),a="horizontal"===o?0:1,s=n[r[a]],l=[0,s],c=this.dimensions.length,u=Xu(t.get("axisExpandWidth"),l),d=Xu(t.get("axisExpandCount")||0,[0,c]),h=t.get("axisExpandable")&&c>3&&c>d&&d>1&&u>0&&s>0,p=t.get("axisExpandWindow");p?(e=Xu(p[1]-p[0],l),p[1]=p[0]+e):(e=Xu(u*(d-1),l),(p=[u*(t.get("axisExpandCenter")||BA(c/2))-e/2])[1]=p[0]+e);var f=(s-e)/(c-d);f<3&&(f=0);var g=[BA(VA(p[0]/u,1))+1,HA(VA(p[1]/u,1))-1],m=f/u*p[0];return{layout:o,pixelDimIndex:a,layoutBase:n[i[a]],layoutLength:s,axisBase:n[i[1-a]],axisLength:n[r[1-a]],axisExpandable:h,axisExpandWidth:u,axisCollapseWidth:f,axisExpandWindow:p,axisCount:c,winInnerIndices:g,axisExpandWindow0Pos:m}},_layoutAxes:function(){var e=this._rect,t=this._axesMap,n=this.dimensions,i=this._makeLayoutInfo(),r=i.layout;t.each(function(e){var t=[0,i.axisLength],n=e.inverse?1:0;e.setExtent(t[n],t[1-n])}),RA(n,function(n,o){var a=(i.axisExpandable?qu:ju)(o,i),s={horizontal:{x:a.position,y:i.axisLength},vertical:{x:0,y:a.position}},l={horizontal:WA/2,vertical:0},c=[s[r].x+e.x,s[r].y+e.y],u=l[r],d=ot();ht(d,d,u),lt(d,d,c),this._axesLayout[n]={position:c,rotation:u,transform:d,axisNameAvailableWidth:a.axisNameAvailableWidth,axisLabelShow:a.axisLabelShow,nameTruncateMaxWidth:a.nameTruncateMaxWidth,tickDirection:1,labelDirection:1,labelInterval:t.get(n).getLabelInterval()}},this)},getAxis:function(e){return this._axesMap.get(e)},dataToPoint:function(e,t){return this.axisCoordToPoint(this._axesMap.get(t).dataToCoord(e),t)},eachActiveState:function(e,t,n){for(var i=this.dimensions,r=this._axesMap,o=this.hasAxisBrushed(),a=0,s=e.count();a<s;a++){var l,c=e.getValues(i,a);if(o){l="active";for(var u=0,d=i.length;u<d;u++){var h=i[u];if("inactive"===r.get(h).model.getActiveState(c[u],u)){l="inactive";break}}}else l="normal";t.call(n,l,a)}},hasAxisBrushed:function(){for(var e=this.dimensions,t=this._axesMap,n=!1,i=0,r=e.length;i<r;i++)"normal"!==t.get(e[i]).model.getActiveState()&&(n=!0);return n},axisCoordToPoint:function(e,t){return Io([e,0],this._axesLayout[t].transform)},getAxisLayout:function(e){return i(this._axesLayout[e])},getSlidedAxisExpandWindow:function(e){var t=this._makeLayoutInfo(),n=t.pixelDimIndex,i=t.axisExpandWindow.slice(),r=i[1]-i[0],o=[0,t.axisExpandWidth*(t.axisCount-1)];if(!this.containPoint(e))return{behavior:"none",axisExpandWindow:i};var a,s=e[n]-t.layoutBase-t.axisExpandWindow0Pos,l="slide",c=t.axisCollapseWidth,u=this._model.get("axisExpandSlideTriggerArea"),d=null!=u[0];return c?(d&&c&&s<r*u[0]?(l="jump",a=s-r*u[2]):d&&c&&s>r*(1-u[0])?(l="jump",a=s-r*(1-u[2])):(a=s-r*u[1])>=0&&(a=s-r*(1-u[1]))<=0&&(a=0),(a*=t.axisExpandWidth/c)?OA(a,i,o,"all"):l="none"):(r=i[1]-i[0],(i=[FA(0,o[1]*s/r-r/2)])[1]=zA(o[1],i[0]+r),i[0]=i[1]-r),{axisExpandWindow:i,behavior:l}}},ua.register("parallel",{create:function(e,t){var n=[];return e.eachComponent("parallel",function(i,r){var o=new Uu(i,e,t);o.name="parallel_"+r,o.resize(i,t),i.coordinateSystem=o,o.model=i,n.push(o)}),e.eachSeries(function(t){if("parallel"===t.get("coordinateSystem")){var n=e.queryComponents({mainType:"parallel",index:t.get("parallelIndex"),id:t.get("parallelId")})[0];t.coordinateSystem=n.coordinateSystem}}),n}});var UA=jb.extend({type:"baseParallelAxis",axis:null,activeIntervals:[],getAreaSelectStyle:function(){return Jy([["fill","color"],["lineWidth","borderWidth"],["stroke","borderColor"],["width","width"],["opacity","opacity"]])(this.getModel("areaSelectStyle"))},setActiveIntervals:function(e){var t=this.activeIntervals=i(e);if(t)for(var n=t.length-1;n>=0;n--)Ii(t[n])},getActiveState:function(e){var t=this.activeIntervals;if(!t.length)return"normal";if(null==e)return"inactive";for(var n=0,i=t.length;n<i;n++)if(t[n][0]<=e&&e<=t[n][1])return"active";return"inactive"}}),$A={type:"value",dim:null,areaSelectStyle:{width:20,borderWidth:1,borderColor:"rgba(160,197,232)",color:"rgba(160,197,232)",opacity:.3},realtime:!0,z:10};n(UA.prototype,RC),wS("parallel",UA,function(e,t){return t.type||(t.data?"category":"value")},$A),jb.extend({type:"parallel",dependencies:["parallelAxis"],coordinateSystem:null,dimensions:null,parallelAxisIndex:null,layoutMode:"box",defaultOption:{zlevel:0,z:0,left:80,top:60,right:80,bottom:60,layout:"horizontal",axisExpandable:!1,axisExpandCenter:null,axisExpandCount:0,axisExpandWidth:50,axisExpandRate:17,axisExpandDebounce:50,axisExpandSlideTriggerArea:[-.15,.05,.4],axisExpandTriggerOn:"click",parallelAxisDefault:null},init:function(){jb.prototype.init.apply(this,arguments),this.mergeOption({})},mergeOption:function(e){var t=this.option;e&&n(t,e,!0),this._initDimensions()},contains:function(e,t){var n=e.get("parallelIndex");return null!=n&&t.getComponent("parallel",n)===this},setAxisExpand:function(e){d(["axisExpandable","axisExpandCenter","axisExpandCount","axisExpandWidth","axisExpandWindow"],function(t){e.hasOwnProperty(t)&&(this.option[t]=e[t])},this)},_initDimensions:function(){var e=this.dimensions=[],t=this.parallelAxisIndex=[];d(g(this.dependentModels.parallelAxis,function(e){return(e.get("parallelIndex")||0)===this.componentIndex},this),function(n){e.push("dim"+n.get("dim")),t.push(n.componentIndex)})}}),ir({type:"axisAreaSelect",event:"axisAreaSelected",update:"updateVisual"},function(e,t){t.eachComponent({mainType:"parallelAxis",query:e},function(t){t.axis.model.setActiveIntervals(e.intervals)})}),ir("parallelAxisExpand",function(e,t){t.eachComponent({mainType:"parallel",query:e},function(t){t.setAxisExpand(e)})});var GA=v,qA=d,jA=f,YA=Math.min,XA=Math.max,ZA=Math.pow,KA=1e4,JA=6,QA=6,eM="globalPan",tM={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},nM={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},iM={brushStyle:{lineWidth:2,stroke:"rgba(0,0,0,0.3)",fill:"rgba(0,0,0,0.1)"},transformable:!0,brushMode:"single",removeOnClick:!1},rM=0;Yu.prototype={constructor:Yu,enableBrush:function(e){return this._brushType&&Ku(this),e.brushType&&$u(this,e),this},setPanels:function(e){if(e&&e.length){var t=this._panels={};d(e,function(e){t[e.panelId]=i(e)})}else this._panels=null;return this},mount:function(e){e=e||{},this._enableGlobalPan=e.enableGlobalPan;var t=this.group;return this._zr.add(t),t.attr({position:e.position||[0,0],rotation:e.rotation||0,scale:e.scale||[1,1]}),this._transform=t.getLocalTransform(),this},eachCover:function(e,t){qA(this._covers,e,t)},updateCovers:function(t){function e(e,t){return(null!=e.id?e.id:r+t)+"-"+e.brushType}function o(e,n){var i=t[e];if(null!=n&&a[n]===c)s[e]=a[n];else{var r=s[e]=null!=n?(a[n].__brushOption=i,a[n]):Qu(l,Ju(l,i));ic(l,r)}}t=f(t,function(e){return n(i(iM),e,!0)});var r="\0-brush-index-",a=this._covers,s=this._covers=[],l=this,c=this._creatingCover;return new fr(a,t,function(t,n){return e(t.__brushOption,n)},e).add(o).update(o).remove(function(e){a[e]!==c&&l.group.remove(a[e])}).execute(),this},unmount:function(){return this.enableBrush(!1),rc(this),this._zr.remove(this.group),this},dispose:function(){this.unmount(),this.off()}},u(Yu,g_);var oM={mousedown:function(e){if(this._dragging)Cc.call(this,e);else if(!e.target||!e.target.draggable){Mc(e);var t=this.group.transformCoordToLocal(e.offsetX,e.offsetY);this._creatingCover=null,(this._creatingPanel=oc(this,e,t))&&(this._dragging=!0,this._track=[t.slice()])}},mousemove:function(e){var t=this.group.transformCoordToLocal(e.offsetX,e.offsetY);if(Sc(this,e,t),this._dragging){Mc(e);var n=Tc(this,e,t,!1);n&&sc(this,n)}},mouseup:Cc},aM={lineX:Dc(0),lineY:Dc(1),rect:{createCover:function(e,t){return uc(GA(yc,function(e){return e},function(e){return e}),e,t,["w","e","n","s","se","sw","ne","nw"])},getCreatingRange:function(e){var t=hc(e);return gc(t[1][0],t[1][1],t[0][0],t[0][1])},updateCoverShape:function(e,t,n,i){cc(e,t,n,i)},updateCommon:dc,contain:Ic},polygon:{createCover:function(e,t){var n=new X_;return n.add(new pb({name:"main",style:pc(t),silent:!0})),n},getCreatingRange:function(e){return e},endCreating:function(e,t){t.remove(t.childAt(0)),t.add(new hb({name:"main",draggable:!0,drift:GA(xc,e,t),ondragend:GA(sc,e,{isEnd:!0})}))},updateCoverShape:function(e,t,n,i){t.childAt(0).setShape({points:bc(e,t,n)})},updateCommon:dc,contain:Ic}},sM=["axisLine","axisTickLabel","axisName"],lM=lr({type:"parallelAxis",init:function(e,t){lM.superApply(this,"init",arguments),(this._brushController=new Yu(t.getZr())).on("brush",m(this._onBrush,this))},render:function(e,t,n,i){if(!zc(e,t,i)){this.axisModel=e,this.api=n,this.group.removeAll();var r=this._axisGroup;if(this._axisGroup=new X_,this.group.add(this._axisGroup),e.get("show")){var o=Ec(e,t),s=o.coordinateSystem,l=e.getAreaSelectStyle(),c=l.width,u=e.axis.dim,h=a({strokeContainThreshold:c},s.getAxisLayout(u)),p=new kS(e,h);d(sM,p.add,p),this._axisGroup.add(p.getGroup()),this._refreshBrushController(h,l,e,o,c,n);var f=i&&!1===i.animation?null:e;Ao(r,this._axisGroup,f)}}},updateVisual:function(e,t,n,i){this._brushController&&this._brushController.updateCovers(Nc(e))},_refreshBrushController:function(e,t,n,i,r,o){var a=n.axis.getExtent(),s=a[1]-a[0],l=Math.min(30,.1*Math.abs(s)),c=jt.create({x:a[0],y:-r/2,width:s,height:r});c.x-=l,c.width+=2*l,this._brushController.mount({enableGlobalPan:!0,rotation:e.rotation,position:e.position}).setPanels([{panelId:"pl",clipPath:Lc(c),isTargetByCursor:Pc(c,o,i),getLinearBrushOtherExtent:kc(c,0)}]).enableBrush({brushType:"lineX",brushStyle:t,removeOnClick:!0}).updateCovers(Nc(n))},_onBrush:function(e,t){var n=this.axisModel,i=n.axis,r=f(e,function(e){return[i.coordToData(e.range[0],!0),i.coordToData(e.range[1],!0)]});(!n.option.realtime===t.isEnd||t.removeOnClick)&&this.api.dispatchAction({type:"axisAreaSelect",parallelAxisId:n.id,intervals:r})},dispose:function(){this._brushController.dispose()}});lr({type:"parallel",render:function(e,t,n){this._model=e,this._api=n,this._handlers||(this._handlers={},d(cM,function(e,t){n.getZr().on(t,this._handlers[t]=m(e,this))},this)),La(this,"_throttledDispatchExpand",e.get("axisExpandRate"),"fixRate")},dispose:function(e,t){d(this._handlers,function(e,n){t.getZr().off(n,e)}),this._handlers=null},_throttledDispatchExpand:function(e){this._dispatchExpand(e)},_dispatchExpand:function(e){e&&this._api.dispatchAction(a({type:"parallelAxisExpand"},e))}});var cM={mousedown:function(e){Rc(this,"click")&&(this._mouseDownPoint=[e.offsetX,e.offsetY])},mouseup:function(e){var t=this._mouseDownPoint;if(Rc(this,"click")&&t){var n=[e.offsetX,e.offsetY];if(Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2)>5)return;var i=this._model.coordinateSystem.getSlidedAxisExpandWindow([e.offsetX,e.offsetY]);"none"!==i.behavior&&this._dispatchExpand({axisExpandWindow:i.axisExpandWindow})}this._mouseDownPoint=null},mousemove:function(e){if(!this._mouseDownPoint&&Rc(this,"mousemove")){var t=this._model,n=t.coordinateSystem.getSlidedAxisExpandWindow([e.offsetX,e.offsetY]),i=n.behavior;"jump"===i&&this._throttledDispatchExpand.debounceNextCall(t.get("axisExpandDebounce")),this._throttledDispatchExpand("none"===i?null:{axisExpandWindow:n.axisExpandWindow,animation:"jump"===i&&null})}}};tr(function(e){Wu(e),Hu(e)}),xw.extend({type:"series.parallel",dependencies:["parallel"],visualColorAccessPath:"lineStyle.normal.color",getInitialData:function(e,t){var n=t.getComponent("parallel",this.get("parallelIndex")),i=n.parallelAxisIndex,r=e.data,o=n.dimensions,a=f(Gc(o,r),function(e,n){var a=l(o,e),s=a>=0&&t.getComponent("parallelAxis",i[a]);return s&&"category"===s.get("type")?(Vc(s,e,r),{name:e,type:"ordinal"}):a<0&&xr.guessOrdinal(r,n)?{name:e,type:"ordinal"}:e}),s=new sC(a,this);return s.initData(r),this.option.progressive&&(this.option.animation=!1),s},getRawIndicesByActiveState:function(e){var t=this.coordinateSystem,n=this.getData(),i=[];return t.eachActiveState(n,function(t,r){e===t&&i.push(n.getRawIndex(r))}),i},defaultOption:{zlevel:0,z:2,coordinateSystem:"parallel",parallelIndex:0,label:{normal:{show:!1},emphasis:{show:!1}},inactiveOpacity:.05,activeOpacity:1,lineStyle:{normal:{width:1,opacity:.45,type:"solid"}},progressive:!1,smooth:!1,animationEasing:"linear"}}),Ta.extend({type:"parallel",init:function(){this._dataGroup=new X_,this.group.add(this._dataGroup),this._data},render:function(e,t,n,i){this._renderForNormal(e,i)},dispose:function(){},_renderForNormal:function(e,t){var n=this._dataGroup,i=e.getData(),r=this._data,o=e.coordinateSystem,a=o.dimensions,s=e.option.smooth?.3:null;if(i.diff(r).add(function(e){Fc(i,n,e,a,o)}).update(function(n,s){var l=r.getItemGraphicEl(s),c=Hc(i,n,a,o);i.setItemGraphicEl(n,l),wo(l,{shape:{points:c}},t&&!1===t.animation?null:e,n)}).remove(function(e){var t=r.getItemGraphicEl(e);n.remove(t)}).execute(),Zc(i,s),!this._data){var l=Wc(o,e,function(){setTimeout(function(){n.removeClipPath()})});n.setClipPath(l)}this._data=i},remove:function(){this._dataGroup&&this._dataGroup.removeAll(),this._data=null}});var uM=["lineStyle","normal","opacity"];ar(function(e){e.eachSeriesByType("parallel",function(t){var n=t.getModel("itemStyle.normal"),i=t.getModel("lineStyle.normal"),r=e.get("color"),o=i.get("color")||n.get("color")||r[t.seriesIndex%r.length],a=t.get("inactiveOpacity"),s=t.get("activeOpacity"),l=t.getModel("lineStyle.normal").getLineStyle(),c=t.coordinateSystem,u=t.getData(),d={normal:l.opacity,active:s,inactive:a};c.eachActiveState(u,function(e,t){var n=u.getItemModel(t),i=d[e];if("normal"===e){var r=n.get(uM,!0);null!=r&&(i=r)}u.setItemVisual(t,"opacity",i)}),u.setVisual("color",o)})});var dM=xw.extend({type:"series.sankey",layoutInfo:null,getInitialData:function(e){var t=e.edges||e.links,n=e.data||e.nodes;if(n&&t)return dA(n,t,this,!0).data},getGraph:function(){return this.getData().graph},getEdgeData:function(){return this.getGraph().edgeData},formatTooltip:function(e,t,n){if("edge"===n){var i=this.getDataParams(e,n),r=i.data,o=r.source+" -- "+r.target;return i.value&&(o+=" : "+i.value),Gi(o)}return dM.superCall(this,"formatTooltip",e,t)},defaultOption:{zlevel:0,z:2,coordinateSystem:"view",layout:null,left:"5%",top:"5%",right:"20%",bottom:"5%",nodeWidth:20,nodeGap:8,layoutIterations:32,label:{normal:{show:!0,position:"right",color:"#000",fontSize:12},emphasis:{show:!0}},itemStyle:{normal:{borderWidth:1,borderColor:"#333"}},lineStyle:{normal:{color:"#314656",opacity:.2,curveness:.5},emphasis:{opacity:.6}},animationEasing:"linear",animationDuration:1e3}}),hM=Zn({shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,cpx2:0,cpy2:0,extent:0},buildPath:function(e,t){var n=t.extent/2;e.moveTo(t.x1,t.y1-n),e.bezierCurveTo(t.cpx1,t.cpy1-n,t.cpx2,t.cpy2-n,t.x2,t.y2-n),e.lineTo(t.x2,t.y2+n),e.bezierCurveTo(t.cpx2,t.cpy2+n,t.cpx1,t.cpy1+n,t.x1,t.y1+n),e.closePath()}});ur({type:"sankey",_model:null,render:function(e,t,n){var i=e.getGraph(),r=this.group,o=e.layoutInfo,a=e.getData(),s=e.getData("edge");this._model=e,r.removeAll(),r.attr("position",[o.x,o.y]),i.eachEdge(function(t){var n=new hM;n.dataIndex=t.dataIndex,n.seriesIndex=e.seriesIndex,n.dataType="edge";var i=t.getModel("lineStyle.normal"),o=i.get("curveness"),a=t.node1.getLayout(),l=t.node2.getLayout(),c=t.getLayout();n.shape.extent=Math.max(1,c.dy);var u=a.x+a.dx,d=a.y+c.sy+c.dy/2,h=l.x,p=l.y+c.ty+c.dy/2,f=u*(1-o)+h*o,g=d,m=u*o+h*(1-o),v=p;switch(n.setShape({x1:u,y1:d,x2:h,y2:p,cpx1:f,cpy1:g,cpx2:m,cpy2:v}),n.setStyle(i.getItemStyle()),n.style.fill){case"source":n.style.fill=t.node1.getVisual("color");break;case"target":n.style.fill=t.node2.getVisual("color")}uo(n,t.getModel("lineStyle.emphasis").getItemStyle()),r.add(n),s.setItemGraphicEl(t.dataIndex,n)}),i.eachNode(function(t){var n=t.getLayout(),i=t.getModel(),o=i.getModel("label.normal"),s=i.getModel("label.emphasis"),l=new fb({shape:{x:n.x,y:n.y,width:t.getLayout().dx,height:t.getLayout().dy},style:i.getModel("itemStyle.normal").getItemStyle()}),c=t.getModel("itemStyle.emphasis").getItemStyle();co(l.style,c,o,s,{labelFetcher:e,labelDataIndex:t.dataIndex,defaultText:t.id,isRectText:!0}),l.setStyle("fill",t.getVisual("color")),uo(l,c),r.add(l),a.setItemGraphicEl(t.dataIndex,l),l.dataType="node"}),!this._data&&e.get("animation")&&r.setClipPath(Xc(r.getBoundingRect(),e,function(){r.removeClipPath()})),this._data=e.getData()},dispose:function(){}}),or(function(e,t,n){e.eachSeriesByType("sankey",function(e){var n=e.get("nodeWidth"),i=e.get("nodeGap"),r=qc(e,t);e.layoutInfo=r;var o=r.width,a=r.height,s=e.getGraph(),l=s.nodes,c=s.edges;$c(l),Yc(l,c,n,i,o,a,0!==g(l,function(e){return 0===e.getLayout().value}).length?0:e.get("layoutIterations"))})}),ar(function(e,t){e.eachSeriesByType("sankey",function(e){var t=e.getGraph().nodes;t.sort(function(e,t){return e.getLayout().value-t.getLayout().value});var n=t[0].getLayout().value,i=t[t.length-1].getLayout().value;d(t,function(t){var r=new XT({type:"color",mappingMethod:"linear",dataExtent:[n,i],visual:e.get("color")}).mapValueToVisual(t.getLayout().value);t.setVisual("color",r);var o=t.getModel().get("itemStyle.normal.color");null!=o&&t.setVisual("color",o)})})});var pM=Nn.extend({type:"whiskerInBox",shape:{},buildPath:function(e,t){for(var n in t)if(t.hasOwnProperty(n)&&0===n.indexOf("ends")){var i=t[n];e.moveTo(i[0][0],i[0][1]),e.lineTo(i[1][0],i[1][1])}}}),fM=gd.prototype;fM._createContent=function(e,t,n){var i=e.getItemLayout(t),r="horizontal"===i.chartLayout?1:0,o=0;this.add(new hb({shape:{points:n?md(i.bodyEnds,r,i):i.bodyEnds},style:{strokeNoScale:!0},z2:100})),this.bodyIndex=o++;var a=f(i.whiskerEnds,function(e){return n?md(e,r,i):e});this.add(new pM({shape:vd(a),style:{strokeNoScale:!0},z2:100})),this.whiskerIndex=o++},fM.updateData=function(e,t,n){var i=this._seriesModel=e.hostModel,r=e.getItemLayout(t),o=Eb[n?"initProps":"updateProps"];o(this.childAt(this.bodyIndex),{shape:{points:r.bodyEnds}},i,t),o(this.childAt(this.whiskerIndex),{shape:vd(r.whiskerEnds)},i,t),this.styleUpdater.call(null,this,e,t)},h(gd,X_);var gM=yd.prototype;gM.updateData=function(e){var t=this.group,n=this._data,i=this.styleUpdater;e.diff(n).add(function(n){if(e.hasValue(n)){var r=new gd(e,n,i,!0);e.setItemGraphicEl(n,r),t.add(r)}}).update(function(r,o){var a=n.getItemGraphicEl(o);e.hasValue(r)?(a?a.updateData(e,r):a=new gd(e,r,i),t.add(a),e.setItemGraphicEl(r,a)):t.remove(a)}).remove(function(e){var i=n.getItemGraphicEl(e);i&&t.remove(i)}).execute(),this._data=e},gM.remove=function(){var e=this.group,t=this._data;this._data=null,t&&t.eachItemGraphicEl(function(t){t&&e.remove(t)})};var mM={_baseAxisDim:null,getInitialData:function(e,t){var n,i,r=t.getComponent("xAxis",this.get("xAxisIndex")),o=t.getComponent("yAxis",this.get("yAxisIndex")),a=r.get("type"),s=o.get("type");"category"===a?(e.layout="horizontal",n=r.getCategories(),i=!0):"category"===s?(e.layout="vertical",n=o.getCategories(),i=!0):e.layout=e.layout||"horizontal";var l=["x","y"],c="horizontal"===e.layout?0:1,u=this._baseAxisDim=l[c],h=l[1-c],p=e.data;i&&d(p,function(e,t){e.value&&y(e.value)?e.value.unshift(t):y(e)&&e.unshift(t)});var f=this.defaultValueDimensions,g=[{name:u,otherDims:{tooltip:!1},dimsDef:["base"]},{name:h,dimsDef:f.slice()}];g=xr(g,p,{encodeDef:this.get("encode"),dimsDef:this.get("dimensions"),dimCount:f.length+1});var m=new sC(g,this);return m.initData(p,n?n.slice():null),m},getBaseAxis:function(){var e=this._baseAxisDim;return this.ecModel.getComponent(e+"Axis",this.get(e+"AxisIndex")).axis}},vM={init:function(){var e=this._whiskerBoxDraw=new yd(this.getStyleUpdater());this.group.add(e.group)},render:function(e,t,n){this._whiskerBoxDraw.updateData(e.getData())},remove:function(e){this._whiskerBoxDraw.remove()}};u(xw.extend({type:"series.boxplot",dependencies:["xAxis","yAxis","grid"],defaultValueDimensions:["min","Q1","median","Q3","max"],dimensions:null,defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,layout:null,boxWidth:[7,50],itemStyle:{normal:{color:"#fff",borderWidth:1},emphasis:{borderWidth:2,shadowBlur:5,shadowOffsetX:2,shadowOffsetY:2,shadowColor:"rgba(0,0,0,0.4)"}},animationEasing:"elasticOut",animationDuration:800}}),mM,!0),u(Ta.extend({type:"boxplot",getStyleUpdater:function(){return xd},dispose:N}),vM,!0);var _M=["itemStyle","normal"],yM=["itemStyle","emphasis"],xM=["itemStyle","normal","borderColor"],bM=d;ar(function(e,t){var n=e.get("color");e.eachRawSeriesByType("boxplot",function(t){var i=n[t.seriesIndex%n.length],r=t.getData();r.setVisual({legendSymbol:"roundRect",color:t.get(xM)||i}),e.isSeriesFiltered(t)||r.each(function(e){var t=r.getItemModel(e);r.setItemVisual(e,{color:t.get(xM,!0)})})})}),or(function(e){var t=_d(e);bM(t,function(e){var t=e.seriesModels;t.length&&(bd(e),bM(t,function(t,n){wd(t,e.boxOffsetList[n],e.boxWidthList[n])}))})}),u(xw.extend({type:"series.candlestick",dependencies:["xAxis","yAxis","grid"],defaultValueDimensions:["open","close","lowest","highest"],dimensions:null,defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,layout:null,itemStyle:{normal:{color:"#c23531",color0:"#314656",borderWidth:1,borderColor:"#c23531",borderColor0:"#314656"},emphasis:{borderWidth:2}},barMaxWidth:null,barMinWidth:null,barWidth:null,animationUpdate:!1,animationEasing:"linear",animationDuration:300},getShadowDim:function(){return"open"},brushSelector:function(e,t,n){var i=t.getItemLayout(e);return n.rect(i.brushRect)}}),mM,!0),u(Ta.extend({type:"candlestick",getStyleUpdater:function(){return Sd},dispose:N}),vM,!0);var wM=["itemStyle","normal"],CM=["itemStyle","emphasis"],SM=["itemStyle","normal","borderColor"],TM=["itemStyle","normal","borderColor0"],AM=["itemStyle","normal","color"],MM=["itemStyle","normal","color0"],EM=T;tr(function(e){e&&y(e.series)&&d(e.series,function(e){b(e)&&"k"===e.type&&(e.type="candlestick")})}),ar(function(e,t){e.eachRawSeriesByType("candlestick",function(t){var n=t.getData();n.setVisual({legendSymbol:"roundRect"}),e.isSeriesFiltered(t)||n.each(function(e){var t=n.getItemModel(e),i=n.getItemLayout(e).sign;n.setItemVisual(e,{color:t.get(i>0?AM:MM),borderColor:t.get(i>0?SM:TM)})})})}),or(function(e){e.eachSeriesByType("candlestick",function(n){var i,r=n.coordinateSystem,o=n.getData(),a=Md(n,o),s=n.get("layout"),c="horizontal"===s?0:1,u=1-c,h=["x","y"],p=[];if(d(o.dimensions,function(e){var t=o.getDimensionInfo(e).coordDim;t===h[u]?p.push(e):t===h[c]&&(i=e)}),!(null==i||p.length<4)){var f=0;o.each([i].concat(p),function(){function t(e){var t=[];return t[c]=i,t[u]=e,isNaN(i)||isNaN(e)?[NaN,NaN]:r.dataToPoint(t)}function e(e,t){var n=e.slice(),i=e.slice();n[c]=Kn(n[c]+a/2,1,!1),i[c]=Kn(i[c]-a/2,1,!0),t?S.push(n,i):S.push(i,n)}function l(e){return e[c]=Kn(e[c],1),e}var n=arguments,i=n[0],d=n[p.length+1],h=n[1],g=n[2],m=n[3],v=n[4],_=Math.min(h,g),y=Math.max(h,g),x=t(_),b=t(y),w=t(m),C=[[l(t(v)),l(b)],[l(w),l(x)]],S=[];e(b,0),e(x,1);var T;T=h>g?-1:h<g?1:f>0?o.getItemModel(f-1).get()[2]<=g?1:-1:1,o.setItemLayout(d,{chartLayout:s,sign:T,initBaseline:h>g?b[u]:x[u],bodyEnds:S,whiskerEnds:C,brushRect:function(){var e=t(Math.min(h,g,m,v)),n=t(Math.max(h,g,m,v));return e[c]-=a/2,n[c]-=a/2,{x:e[0],y:e[1],width:u?a:n[0]-e[0],height:u?n[1]-e[1]:a}}()}),++f},!0)}})}),xw.extend({type:"series.effectScatter",dependencies:["grid","polar"],getInitialData:function(e,t){return Sr(e.data,this,t)},brushSelector:"point",defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,effectType:"ripple",progressive:0,showEffectOn:"render",rippleEffect:{period:4,scale:2.5,brushType:"fill"},symbolSize:10}});var IM=Ad.prototype;IM.stopEffectAnimation=function(){this.childAt(1).removeAll()},IM.startEffectAnimation=function(e){for(var t=e.symbolType,n=e.color,i=this.childAt(1),r=0;r<3;r++){var o=Hr(t,-1,-1,2,2,n);o.attr({style:{strokeNoScale:!0},z2:99,silent:!0,scale:[.5,.5]});var a=-r/3*e.period+e.effectOffset;o.animate("",!0).when(e.period,{scale:[e.rippleScale/2,e.rippleScale/2]}).delay(a).start(),o.animateStyle(!0).when(e.period,{opacity:0}).delay(a).start(),i.add(o)}Td(i,e)},IM.updateEffectAnimation=function(e){for(var t=this._effectCfg,n=this.childAt(1),i=["symbolType","period","rippleScale"],r=0;r<i.length;r++){var o=i[r];if(t[o]!==e[o])return this.stopEffectAnimation(),void this.startEffectAnimation(e)}Td(n,e)},IM.highlight=function(){this.trigger("emphasis")},IM.downplay=function(){this.trigger("normal")},IM.updateData=function(e,t){var n=e.hostModel;this.childAt(0).updateData(e,t);var i=this.childAt(1),r=e.getItemModel(t),o=e.getItemVisual(t,"symbol"),a=Id(e.getItemVisual(t,"symbolSize")),s=e.getItemVisual(t,"color");i.attr("scale",a),i.traverse(function(e){e.attr({fill:s})});var l=r.getShallow("symbolOffset");if(l){var c=i.position;c[0]=Si(l[0],a[0]),c[1]=Si(l[1],a[1])}i.rotation=(r.getShallow("symbolRotate")||0)*Math.PI/180||0;var u={};if(u.showEffectOn=n.get("showEffectOn"),u.rippleScale=r.get("rippleEffect.scale"),u.brushType=r.get("rippleEffect.brushType"),u.period=1e3*r.get("rippleEffect.period"),u.effectOffset=t/e.count(),u.z=r.getShallow("z")||0,u.zlevel=r.getShallow("zlevel")||0,u.symbolType=o,u.color=s,this.off("mouseover").off("mouseout").off("emphasis").off("normal"),"render"===u.showEffectOn)this._effectCfg?this.updateEffectAnimation(u):this.startEffectAnimation(u),this._effectCfg=u;else{this._effectCfg=null,this.stopEffectAnimation();var d=this.childAt(0),h=function(){d.highlight(),"render"!==u.showEffectOn&&this.startEffectAnimation(u)},p=function(){d.downplay(),"render"!==u.showEffectOn&&this.stopEffectAnimation()};this.on("mouseover",h,this).on("mouseout",p,this).on("emphasis",h,this).on("normal",p,this)}this._effectCfg=u},IM.fadeOut=function(e){this.off("mouseover").off("mouseout").off("emphasis").off("normal"),e&&e()},h(Ad,X_),ur({type:"effectScatter",init:function(){this._symbolDraw=new ts(Ad)},render:function(e,t,n){var i=e.getData(),r=this._symbolDraw;r.updateData(i),this.group.add(r.group)},updateLayout:function(){this._symbolDraw.updateLayout()},remove:function(e,t){this._symbolDraw&&this._symbolDraw.remove(t)},dispose:function(){}}),ar(v(pS,"effectScatter","circle",null)),or(v(fS,"effectScatter"));var DM=xw.extend({type:"series.lines",dependencies:["grid","polar"],visualColorAccessPath:"lineStyle.normal.color",init:function(e){Cd(e),DM.superApply(this,"init",arguments)},mergeOption:function(e){Cd(e),DM.superApply(this,"mergeOption",arguments)},getInitialData:function(e,t){var n=new sC(["value"],this);return n.hasItemOption=!1,n.initData(e.data,[],function(e,t,i,r){if(e instanceof Array)return NaN;n.hasItemOption=!0;var o=e.value;return null!=o?o instanceof Array?o[r]:o:void 0}),n},formatTooltip:function(e){var t=this.getData().getItemModel(e),n=t.get("name");if(n)return n;var i=t.get("fromName"),r=t.get("toName"),o=[];return null!=i&&o.push(i),null!=r&&o.push(r),Gi(o.join(" > "))},defaultOption:{coordinateSystem:"geo",zlevel:0,z:2,legendHoverLink:!0,hoverAnimation:!0,xAxisIndex:0,yAxisIndex:0,symbol:["none","none"],symbolSize:[10,10],geoIndex:0,effect:{show:!1,period:4,constantSpeed:0,symbol:"circle",symbolSize:3,loop:!0,trailLength:.2},large:!1,largeThreshold:2e3,polyline:!1,label:{normal:{show:!1,position:"end"}},lineStyle:{normal:{opacity:.5}}}}),kM=Dd.prototype;kM.createLine=function(e,t,n){return new bu(e,t,n)},kM._updateEffectSymbol=function(e,t){var n=e.getItemModel(t).getModel("effect"),i=n.get("symbolSize"),r=n.get("symbol");y(i)||(i=[i,i]);var o=n.get("color")||e.getItemVisual(t,"color"),a=this.childAt(1);this._symbolType!==r&&(this.remove(a),(a=Hr(r,-.5,-.5,1,1,o)).z2=100,a.culling=!0,this.add(a)),a&&(a.setStyle("shadowColor",o),a.setStyle(n.getItemStyle(["color"])),a.attr("scale",i),a.setColor(o),a.attr("scale",i),this._symbolType=r,this._updateEffectAnimation(e,n,t))},kM._updateEffectAnimation=function(e,t,n){var i=this.childAt(1);if(i){var r=this,o=e.getItemLayout(n),a=1e3*t.get("period"),s=t.get("loop"),l=t.get("constantSpeed"),c=I(t.get("delay"),function(t){return t/e.count()*a/3}),u="function"==typeof c;if(i.ignore=!0,this.updateAnimationPoints(i,o),l>0&&(a=this.getLineLength(i)/l*1e3),a!==this._period||s!==this._loop){i.stopAnimation();var d=c;u&&(d=c(n)),i.__t>0&&(d=-a*i.__t),i.__t=0;var h=i.animate("",s).when(a,{__t:1}).delay(d).during(function(){r.updateSymbolPosition(i)});s||h.done(function(){r.remove(i)}),h.start()}this._period=a,this._loop=s}},kM.getLineLength=function(e){return d_(e.__p1,e.__cp1)+d_(e.__cp1,e.__p2)},kM.updateAnimationPoints=function(e,t){e.__p1=t[0],e.__p2=t[1],e.__cp1=t[2]||[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2]},kM.updateData=function(e,t,n){this.childAt(0).updateData(e,t,n),this._updateEffectSymbol(e,t)},kM.updateSymbolPosition=function(e){var t=e.__p1,n=e.__p2,i=e.__cp1,r=e.__t,o=e.position,a=un,s=cn;o[0]=a(t[0],i[0],n[0],r),o[1]=a(t[1],i[1],n[1],r);var l=s(t[0],i[0],n[0],r),c=s(t[1],i[1],n[1],r);e.rotation=-Math.atan2(c,l)-Math.PI/2,e.ignore=!1},kM.updateLayout=function(e,t){this.childAt(0).updateLayout(e,t);var n=e.getItemModel(t).getModel("effect");this._updateEffectAnimation(e,n,t)},h(Dd,X_);var LM=Ld.prototype;LM._createPolyline=function(e,t,n){var i=e.getItemLayout(t),r=new pb({shape:{points:i}});this.add(r),this._updateCommonStl(e,t,n)},LM.updateData=function(e,t,n){var i=e.hostModel;wo(this.childAt(0),{shape:{points:e.getItemLayout(t)}},i,t),this._updateCommonStl(e,t,n)},LM._updateCommonStl=function(e,t,n){var i=this.childAt(0),o=e.getItemModel(t),a=e.getItemVisual(t,"color"),s=n&&n.lineStyle,l=n&&n.hoverLineStyle;n&&!e.hasItemOption||(s=o.getModel("lineStyle.normal").getLineStyle(),l=o.getModel("lineStyle.emphasis").getLineStyle()),i.useStyle(r({strokeNoScale:!0,fill:"none",stroke:a},s)),i.hoverStyle=l,uo(this)},LM.updateLayout=function(e,t){this.childAt(0).setShape("points",e.getItemLayout(t))},h(Ld,X_);var NM=kd.prototype;NM.createLine=function(e,t,n){return new Ld(e,t,n)},NM.updateAnimationPoints=function(e,t){this._points=t;for(var n=[0],i=0,r=1;r<t.length;r++){var o=t[r-1],a=t[r];i+=d_(o,a),n.push(i)}if(0!==i){for(r=0;r<n.length;r++)n[r]/=i;this._offsets=n,this._length=i}},NM.getLineLength=function(e){return this._length},NM.updateSymbolPosition=function(e){var t=e.__t,n=this._points,i=this._offsets,r=n.length;if(i){var o=this._lastFrame;if(t<this._lastFramePercent){for(a=Math.min(o+1,r-1);a>=0&&!(i[a]<=t);a--);a=Math.min(a,r-2)}else{for(var a=o;a<r&&!(i[a]>t);a++);a=Math.min(a-1,r-2)}Y(e.position,n[a],n[a+1],(t-i[a])/(i[a+1]-i[a]));var s=n[a+1][0]-n[a][0],l=n[a+1][1]-n[a][1];e.rotation=-Math.atan2(l,s)-Math.PI/2,this._lastFrame=a,this._lastFramePercent=t,e.ignore=!1}},h(kd,Dd);var PM=Zn({shape:{polyline:!1,segs:[]},buildPath:function(e,t){for(var n=t.segs,i=t.polyline,r=0;r<n.length;r++){var o=n[r];if(i){e.moveTo(o[0][0],o[0][1]);for(var a=1;a<o.length;a++)e.lineTo(o[a][0],o[a][1])}else e.moveTo(o[0][0],o[0][1]),o.length>2?e.quadraticCurveTo(o[2][0],o[2][1],o[1][0],o[1][1]):e.lineTo(o[1][0],o[1][1])}},findDataIndex:function(e,t){for(var n=this.shape,i=n.segs,r=n.polyline,o=Math.max(this.style.lineWidth,1),a=0;a<i.length;a++){var s=i[a];if(r){for(var l=1;l<s.length;l++)if(bn(s[l-1][0],s[l-1][1],s[l][0],s[l][1],o,e,t))return a}else if(s.length>2){if(Sn(s[0][0],s[0][1],s[2][0],s[2][1],s[1][0],s[1][1],o,e,t))return a}else if(bn(s[0][0],s[0][1],s[1][0],s[1][1],o,e,t))return a}return-1}}),OM=Pd.prototype;OM.updateData=function(e){this.group.removeAll();var t=this._lineEl,n=e.hostModel;t.setShape({segs:e.mapArray(e.getItemLayout),polyline:n.get("polyline")}),t.useStyle(n.getModel("lineStyle.normal").getLineStyle());var i=e.getVisual("color");i&&t.setStyle("stroke",i),t.setStyle("fill"),t.seriesIndex=n.seriesIndex,t.on("mousemove",function(e){t.dataIndex=null;var n=t.findDataIndex(e.offsetX,e.offsetY);n>0&&(t.dataIndex=n)}),this.group.add(t)},OM.updateLayout=function(e){var t=e.getData();this._lineEl.setShape({segs:t.mapArray(t.getItemLayout)})},OM.remove=function(){this.group.removeAll()},ur({type:"lines",init:function(){},render:function(e,t,n){var i=e.getData(),r=this._lineDraw,o=e.get("effect.show"),a=e.get("polyline"),s=e.get("large")&&i.count()>=e.get("largeThreshold");o===this._hasEffet&&a===this._isPolyline&&s===this._isLarge||(r&&r.remove(),r=this._lineDraw=s?new Pd:new Mu(a?o?kd:Ld:o?Dd:bu),this._hasEffet=o,this._isPolyline=a,this._isLarge=s);var l=e.get("zlevel"),c=e.get("effect.trailLength"),u=n.getZr(),d="svg"===u.painter.getType();d||u.painter.getLayer(l).clear(!0),null==this._lastZlevel||d||u.configLayer(this._lastZlevel,{motionBlur:!1}),o&&c&&(d||u.configLayer(l,{motionBlur:!0,lastFrameAlpha:Math.max(Math.min(c/10+.9,1),0)})),this.group.add(r.group),r.updateData(i),this._lastZlevel=l},updateLayout:function(e,t,n){this._lineDraw.updateLayout(e);var i=n.getZr();"svg"===i.painter.getType()||i.painter.getLayer(this._lastZlevel).clear(!0)},remove:function(e,t){this._lineDraw&&this._lineDraw.remove(t,!0);var n=t.getZr();"svg"===n.painter.getType()||n.painter.getLayer(this._lastZlevel).clear(!0)},dispose:function(){}}),or(function(e){e.eachSeriesByType("lines",function(e){var t=e.coordinateSystem,n=e.getData();n.each(function(i){var r=n.getItemModel(i),o=r.option instanceof Array?r.option:r.get("coords"),a=[];if(e.get("polyline"))for(var s=0;s<o.length;s++)a.push(t.dataToPoint(o[s]));else{a[0]=t.dataToPoint(o[0]),a[1]=t.dataToPoint(o[1]);var l=r.get("lineStyle.normal.curveness");+l&&(a[2]=[(a[0][0]+a[1][0])/2-(a[0][1]-a[1][1])*l,(a[0][1]+a[1][1])/2-(a[1][0]-a[0][0])*l])}n.setItemLayout(i,a)})})}),ar(function(e){e.eachSeriesByType("lines",function(e){var t=e.getData(),n=Od(e.get("symbol")),i=Od(e.get("symbolSize")),r="lineStyle.normal.opacity".split(".");t.setVisual("fromSymbol",n&&n[0]),t.setVisual("toSymbol",n&&n[1]),t.setVisual("fromSymbolSize",i&&i[0]),t.setVisual("toSymbolSize",i&&i[1]),t.setVisual("opacity",e.get(r)),t.each(function(e){var n=t.getItemModel(e),i=Od(n.getShallow("symbol",!0)),o=Od(n.getShallow("symbolSize",!0)),a=n.get(r);i[0]&&t.setItemVisual(e,"fromSymbol",i[0]),i[1]&&t.setItemVisual(e,"toSymbol",i[1]),o[0]&&t.setItemVisual(e,"fromSymbolSize",o[0]),o[1]&&t.setItemVisual(e,"toSymbolSize",o[1]),t.setItemVisual(e,"opacity",a)})})}),xw.extend({type:"series.heatmap",getInitialData:function(e,t){return Sr(e.data,this,t)},defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,geoIndex:0,blurSize:30,pointSize:20,maxOpacity:1,minOpacity:0}}),zd.prototype={update:function(e,t,n,i,r,o){var a=this._getBrush(),s=this._getGradient(e,r,"inRange"),l=this._getGradient(e,r,"outOfRange"),c=this.pointSize+this.blurSize,u=this.canvas,d=u.getContext("2d"),h=e.length;u.width=t,u.height=n;for(var p=0;p<h;++p){var f=e[p],g=f[0],m=f[1],v=i(f[2]);d.globalAlpha=v,d.drawImage(a,g-c,m-c)}if(!u.width||!u.height)return u;for(var _=d.getImageData(0,0,u.width,u.height),y=_.data,x=0,b=y.length,w=this.minOpacity,C=this.maxOpacity-w;x<b;){var v=y[x+3]/256,S=4*Math.floor(255*v);if(v>0){var T=o(v)?s:l;v>0&&(v=v*C+w),y[x++]=T[S],y[x++]=T[S+1],y[x++]=T[S+2],y[x++]=T[S+3]*v*256}else x+=4}return d.putImageData(_,0,0),u},_getBrush:function(){var e=this._brushCanvas||(this._brushCanvas=r_()),t=this.pointSize+this.blurSize,n=2*t;e.width=n,e.height=n;var i=e.getContext("2d");return i.clearRect(0,0,n,n),i.shadowOffsetX=n,i.shadowBlur=this.blurSize,i.shadowColor="#000",i.beginPath(),i.arc(-t,t,this.pointSize,0,2*Math.PI,!0),i.closePath(),i.fill(),e},_getGradient:function(e,t,n){for(var i=this._gradientPixels,r=i[n]||(i[n]=new Uint8ClampedArray(1024)),o=[0,0,0,0],a=0,s=0;s<256;s++)t[n](s/255,!0,o),r[a++]=o[0],r[a++]=o[1],r[a++]=o[2],r[a++]=o[3];return r}},ur({type:"heatmap",render:function(e,t,n){var i;t.eachComponent("visualMap",function(t){t.eachTargetSeries(function(n){n===e&&(i=t)})}),this.group.removeAll();var r=e.coordinateSystem;"cartesian2d"===r.type||"calendar"===r.type?this._renderOnCartesianAndCalendar(r,e,n):Rd(r)&&this._renderOnGeo(r,e,i,n)},dispose:function(){},_renderOnCartesianAndCalendar:function(e,t,n){if("cartesian2d"===e.type)var i=e.getAxis("x"),r=e.getAxis("y"),o=i.getBandWidth(),s=r.getBandWidth();var l=this.group,c=t.getData(),u=t.getModel("itemStyle.normal").getItemStyle(["color"]),d=t.getModel("itemStyle.emphasis").getItemStyle(),h=t.getModel("label.normal"),p=t.getModel("label.emphasis"),f=e.type,g="cartesian2d"===f?[t.coordDimToDataDim("x")[0],t.coordDimToDataDim("y")[0],t.coordDimToDataDim("value")[0]]:[t.coordDimToDataDim("time")[0],t.coordDimToDataDim("value")[0]];c.each(function(n){var i;if("cartesian2d"===f){if(isNaN(c.get(g[2],n)))return;var r=e.dataToPoint([c.get(g[0],n),c.get(g[1],n)]);i=new fb({shape:{x:r[0]-o/2,y:r[1]-s/2,width:o,height:s},style:{fill:c.getItemVisual(n,"color"),opacity:c.getItemVisual(n,"opacity")}})}else{if(isNaN(c.get(g[1],n)))return;i=new fb({z2:1,shape:e.dataToRect([c.get(g[0],n)]).contentShape,style:{fill:c.getItemVisual(n,"color"),opacity:c.getItemVisual(n,"opacity")}})}var m=c.getItemModel(n);c.hasItemOption&&(u=m.getModel("itemStyle.normal").getItemStyle(["color"]),d=m.getModel("itemStyle.emphasis").getItemStyle(),h=m.getModel("label.normal"),p=m.getModel("label.emphasis"));var v=t.getRawValue(n),_="-";v&&null!=v[2]&&(_=v[2]),co(u,d,h,p,{labelFetcher:t,labelDataIndex:n,defaultText:_,isRectText:!0}),i.setStyle(u),uo(i,c.hasItemOption?d:a({},d)),l.add(i),c.setItemGraphicEl(n,i)})},_renderOnGeo:function(e,t,n,i){var r=n.targetVisuals.inRange,o=n.targetVisuals.outOfRange,a=t.getData(),s=this._hmLayer||this._hmLayer||new zd;s.blurSize=t.get("blurSize"),s.pointSize=t.get("pointSize"),s.minOpacity=t.get("minOpacity"),s.maxOpacity=t.get("maxOpacity");var l=e.getViewRect().clone(),c=e.getRoamTransform().transform;l.applyTransform(c);var u=Math.max(l.x,0),d=Math.max(l.y,0),h=Math.min(l.width+l.x,i.getWidth()),p=Math.min(l.height+l.y,i.getHeight()),f=h-u,g=p-d,m=a.mapArray(["lng","lat","value"],function(t,n,i){var r=e.dataToPoint([t,n]);return r[0]-=u,r[1]-=d,r.push(i),r}),v=n.getExtent(),_="visualMap.continuous"===n.type?Ed(v,n.option.range):Nd(v,n.getPieceList(),n.option.selected);s.update(m,f,g,r.color.getNormalizer(),{inRange:r.color.getColorMapper(),outOfRange:o.color.getColorMapper()},_);var y=new qe({style:{width:f,height:g,x:u,y:d,image:s.canvas},silent:!0});this.group.add(y)}});var RM=qS.extend({type:"series.pictorialBar",dependencies:["grid"],defaultOption:{symbol:"circle",symbolSize:null,symbolRotate:null,symbolPosition:null,symbolOffset:null,symbolMargin:null,symbolRepeat:!1,symbolRepeatDirection:"end",symbolClip:!1,symbolBoundingData:null,symbolPatternSize:400,barGap:"-100%",progressive:0,hoverAnimation:!1},getInitialData:function(e){return e.stack=null,RM.superApply(this,"getInitialData",arguments)}}),zM=["itemStyle","normal","borderWidth"],FM=[{xy:"x",wh:"width",index:0,posDesc:["left","right"]},{xy:"y",wh:"height",index:1,posDesc:["top","bottom"]}],BM=new ob;ur({type:"pictorialBar",render:function(e,t,n){var i=this.group,r=e.getData(),o=this._data,a=e.coordinateSystem,s=!!a.getBaseAxis().isHorizontal(),l=a.grid.getRect(),c={ecSize:{width:n.getWidth(),height:n.getHeight()},seriesModel:e,coordSys:a,coordSysExtent:[[l.x,l.x+l.width],[l.y,l.y+l.height]],isHorizontal:s,valueDim:FM[+s],categoryDim:FM[1-s]};return r.diff(o).add(function(e){if(r.hasValue(e)){var t=Yd(r,e),n=Vd(r,e,t,c),o=Qd(r,c,n);r.setItemGraphicEl(e,o),i.add(o),rf(o,c,n)}}).update(function(e,t){var n=o.getItemGraphicEl(t);if(r.hasValue(e)){var a=Yd(r,e),s=Vd(r,e,a,c),l=nf(r,s);n&&l!==n.__pictorialShapeStr&&(i.remove(n),r.setItemGraphicEl(e,null),n=null),n?tf(n,c,s):n=Qd(r,c,s,!0),r.setItemGraphicEl(e,n),n.__pictorialSymbolMeta=s,i.add(n),rf(n,c,s)}else i.remove(n)}).remove(function(e){var t=o.getItemGraphicEl(e);t&&ef(o,e,t.__pictorialSymbolMeta.animationModel,t)}).execute(),this._data=r,this.group},dispose:N,remove:function(e,t){var n=this.group,i=this._data;e.get("animation")?i&&i.eachItemGraphicEl(function(t){ef(i,t.dataIndex,e,t)}):n.removeAll()}}),or(v(nl,"pictorialBar")),ar(v(pS,"pictorialBar","roundRect",null));var HM=function(e,t,n,i,r){jC.call(this,e,t,n),this.type=i||"value",this.position=r||"bottom",this.orient=null,this._labelInterval=null};HM.prototype={constructor:HM,model:null,isHorizontal:function(){var e=this.position;return"top"===e||"bottom"===e},pointToData:function(e,t){return this.coordinateSystem.pointToData(e,t)[0]},toGlobalCoord:null,toLocalCoord:null},h(HM,jC),lf.prototype={type:"singleAxis",axisPointerEnabled:!0,constructor:lf,_init:function(e,t,n){var i=this.dimension,r=new HM(i,Er(e),[0,0],e.get("type"),e.get("position")),o="category"===r.type;r.onBand=o&&e.get("boundaryGap"),r.inverse=e.get("inverse"),r.orient=e.get("orient"),e.axis=r,r.model=e,r.coordinateSystem=this,this._axis=r},update:function(e,t){e.eachSeries(function(e){if(e.coordinateSystem===this){var t=e.getData(),n=this.dimension;this._axis.scale.unionExtentFromData(t,e.coordDimToDataDim(n)),Nr(this._axis.scale,this._axis.model)}},this)},resize:function(e,t){this._rect=Ko({left:e.get("left"),top:e.get("top"),right:e.get("right"),bottom:e.get("bottom"),width:e.get("width"),height:e.get("height")},{width:t.getWidth(),height:t.getHeight()}),this._adjustAxis()},getRect:function(){return this._rect},_adjustAxis:function(){var e=this._rect,t=this._axis,n=t.isHorizontal(),i=n?[0,e.width]:[0,e.height],r=t.reverse?1:0;t.setExtent(i[r],i[1-r]),this._updateAxisTransform(t,n?e.x:e.y)},_updateAxisTransform:function(e,t){var n=e.getExtent(),i=n[0]+n[1],r=e.isHorizontal();e.toGlobalCoord=r?function(e){return e+t}:function(e){return i-e+t},e.toLocalCoord=r?function(e){return e-t}:function(e){return i-e+t}},getAxis:function(){return this._axis},getBaseAxis:function(){return this._axis},getAxes:function(){return[this._axis]},getTooltipAxes:function(){return{baseAxes:[this.getAxis()]}},containPoint:function(e){var t=this.getRect(),n=this.getAxis();return"horizontal"===n.orient?n.contain(n.toLocalCoord(e[0]))&&e[1]>=t.y&&e[1]<=t.y+t.height:n.contain(n.toLocalCoord(e[1]))&&e[0]>=t.y&&e[0]<=t.y+t.height},pointToData:function(e){var t=this.getAxis();return[t.coordToData(t.toLocalCoord(e["horizontal"===t.orient?0:1]))]},dataToPoint:function(e){var t=this.getAxis(),n=this.getRect(),i=[],r="horizontal"===t.orient?0:1;return e instanceof Array&&(e=e[0]),i[r]=t.toGlobalCoord(t.dataToCoord(+e)),i[1-r]=0===r?n.y+n.height/2:n.x+n.width/2,i}},ua.register("single",{create:function(e,t){var n=[];return e.eachComponent("singleAxis",function(i,r){var o=new lf(i,e,t);o.name="single_"+r,o.resize(i,t),i.coordinateSystem=o,n.push(o)}),e.eachSeries(function(t){if("singleAxis"===t.get("coordinateSystem")){var n=e.queryComponents({mainType:"singleAxis",index:t.get("singleAxisIndex"),id:t.get("singleAxisId")})[0];t.coordinateSystem=n&&n.coordinateSystem}}),n},dimensions:lf.prototype.dimensions});var VM=kS.getInterval,WM=kS.ifIgnoreOnTick,UM=["axisLine","axisTickLabel","axisName"],$M=FS.extend({type:"singleAxis",axisPointerClass:"SingleAxisPointer",render:function(e,t,n,i){var r=this.group;r.removeAll();var o=hf(e),a=new kS(e,o);d(UM,a.add,a),r.add(a.getGroup()),e.get("splitLine.show")&&this._splitLine(e,o.labelInterval),$M.superCall(this,"render",e,t,n,i)},_splitLine:function(e,t){var n=e.axis;if(!n.scale.isBlank()){var i=e.getModel("splitLine"),r=i.getModel("lineStyle"),o=r.get("width"),a=r.get("color"),s=VM(i,t);a=a instanceof Array?a:[a];for(var l=e.coordinateSystem.getRect(),c=n.isHorizontal(),u=[],d=0,h=n.getTicksCoords(),p=[],f=[],g=e.get("axisLabel.showMinLabel"),m=e.get("axisLabel.showMaxLabel"),v=0;v<h.length;++v)if(!WM(n,v,s,h.length,g,m)){var _=n.toGlobalCoord(h[v]);c?(p[0]=_,p[1]=l.y,f[0]=_,f[1]=l.y+l.height):(p[0]=l.x,p[1]=_,f[0]=l.x+l.width,f[1]=_);var y=d++%a.length;u[y]=u[y]||[],u[y].push(new gb(Yn({shape:{x1:p[0],y1:p[1],x2:f[0],y2:f[1]},style:{lineWidth:o},silent:!0})))}for(v=0;v<u.length;++v)this.group.add(Mb(u[v],{style:{stroke:a[v%a.length],lineDash:r.getLineDash(o),lineWidth:o},silent:!0}))}}}),GM=jb.extend({type:"singleAxis",layoutMode:"box",axis:null,coordinateSystem:null,getCoordSysModel:function(){return this}}),qM={left:"5%",top:"5%",right:"5%",bottom:"5%",type:"value",position:"bottom",orient:"horizontal",axisLine:{show:!0,lineStyle:{width:2,type:"solid"}},tooltip:{show:!0},axisTick:{show:!0,length:6,lineStyle:{width:2}},axisLabel:{show:!0,interval:"auto"},splitLine:{show:!0,lineStyle:{type:"dashed",opacity:.2}}};n(GM.prototype,RC),wS("single",GM,function(e,t){return t.type||(t.data?"category":"value")},qM);var jM=function(e,t){var n,i=[],r=e.seriesIndex;if(null==r||!(n=t.getSeriesByIndex(r)))return{point:[]};var o=n.getData(),a=Ho(o,e);if(null==a||y(a))return{point:[]};var s=o.getItemGraphicEl(a),l=n.coordinateSystem;if(n.getTooltipPosition)i=n.getTooltipPosition(a)||[];else if(l&&l.dataToPoint)i=l.dataToPoint(o.getValues(f(l.dimensions,function(e){return n.coordDimToDataDim(e)[0]}),a,!0))||[];else if(s){var c=s.getBoundingRect().clone();c.applyTransform(s.transform),i=[c.x+c.width/2,c.y+c.height/2]}return{point:i,el:s}},YM=d,XM=v,ZM=Fb(),KM=(sr({type:"axisPointer",coordSysAxesInfo:null,defaultOption:{show:"auto",triggerOn:null,zlevel:0,z:50,type:"line",snap:!1,triggerTooltip:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#aaa",width:1,type:"solid"},shadowStyle:{color:"rgba(150,150,150,0.3)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,shadowBlur:3,shadowColor:"#aaa"},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}}}),Fb()),JM=d,QM=lr({type:"axisPointer",render:function(e,t,n){var i=t.getComponent("tooltip"),r=e.get("triggerOn")||i&&i.get("triggerOn")||"mousemove|click";_f("axisPointer",n,function(e,t,n){"none"!==r&&("leave"===e||r.indexOf(e)>=0)&&n({type:"updateAxisPointer",currTrigger:e,x:t&&t.offsetX,y:t&&t.offsetY})})},remove:function(e,t){Tf(t.getZr(),"axisPointer"),QM.superApply(this._model,"remove",arguments)},dispose:function(e,t){Tf("axisPointer",t),QM.superApply(this._model,"dispose",arguments)}}),eE=Fb(),tE=i,nE=m;(Af.prototype={_group:null,_lastGraphicKey:null,_handle:null,_dragging:!1,_lastValue:null,_lastStatus:null,_payloadInfo:null,animationThreshold:15,render:function(e,t,n,i){var r=t.get("value"),o=t.get("status");if(this._axisModel=e,this._axisPointerModel=t,this._api=n,i||this._lastValue!==r||this._lastStatus!==o){this._lastValue=r,this._lastStatus=o;var a=this._group,s=this._handle;if(!o||"hide"===o)return a&&a.hide(),void(s&&s.hide());a&&a.show(),s&&s.show();var l={};this.makeElOption(l,r,e,t,n);var c=l.graphicKey;c!==this._lastGraphicKey&&this.clear(n),this._lastGraphicKey=c;var u=this._moveAnimation=this.determineAnimation(e,t);if(a){var d=v(Cf,t,u);this.updatePointerEl(a,l,d,t),this.updateLabelEl(a,l,d,t)}else a=this._group=new X_,this.createPointerEl(a,l,e,t),this.createLabelEl(a,l,e,t),n.getZr().add(a);Pf(a,t,!0),this._renderHandle(r)}},remove:function(e){this.clear(e)},dispose:function(e){this.clear(e)},determineAnimation:function(e,t){var n=t.get("animation"),i=e.axis,r="category"===i.type,o=t.get("snap");if(!o&&!r)return!1;if("auto"===n||null==n){var a=this.animationThreshold;if(r&&i.getBandWidth()>a)return!0;if(o){var s=Xs(e).seriesDataCount,l=i.getExtent();return Math.abs(l[0]-l[1])/s>a}return!1}return!0===n},makeElOption:function(e,t,n,i,r){},createPointerEl:function(e,t,n,i){var r=t.pointer;if(r){var o=eE(e).pointerEl=new Eb[r.type](tE(t.pointer));e.add(o)}},createLabelEl:function(e,t,n,i){if(t.label){var r=eE(e).labelEl=new fb(tE(t.label));e.add(r),Lf(r,i)}},updatePointerEl:function(e,t,n){var i=eE(e).pointerEl;i&&(i.setStyle(t.pointer.style),n(i,{shape:t.pointer.shape}))},updateLabelEl:function(e,t,n,i){var r=eE(e).labelEl;r&&(r.setStyle(t.label.style),n(r,{shape:t.label.shape,position:t.label.position}),Lf(r,i))},_renderHandle:function(e){if(!this._dragging&&this.updateHandleTransform){var t=this._axisPointerModel,n=this._api.getZr(),i=this._handle,r=t.getModel("handle"),o=t.get("status");if(!r.get("show")||!o||"hide"===o)return i&&n.remove(i),void(this._handle=null);var a;this._handle||(a=!0,i=this._handle=Do(r.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(e){Cy(e.event)},onmousedown:nE(this._onHandleDragMove,this,0,0),drift:nE(this._onHandleDragMove,this),ondragend:nE(this._onHandleDragEnd,this)}),n.add(i)),Pf(i,t,!1);var s=["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];i.setStyle(r.getItemStyle(null,s));var l=r.get("size");y(l)||(l=[l,l]),i.attr("scale",[l[0]/2,l[1]/2]),La(this,"_doDispatchAxisPointer",r.get("throttle")||0,"fixRate"),this._moveHandleToValue(e,a)}},_moveHandleToValue:function(e,t){Cf(this._axisPointerModel,!t&&this._moveAnimation,this._handle,kf(this.getHandleTransform(e,this._axisModel,this._axisPointerModel)))},_onHandleDragMove:function(e,t){var n=this._handle;if(n){this._dragging=!0;var i=this.updateHandleTransform(kf(n),[e,t],this._axisModel,this._axisPointerModel);this._payloadInfo=i,n.stopAnimation(),n.attr(kf(i)),eE(n).lastProp=null,this._doDispatchAxisPointer()}},_doDispatchAxisPointer:function(){if(this._handle){var e=this._payloadInfo,t=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:e.cursorPoint[0],y:e.cursorPoint[1],tooltipOption:e.tooltipOption,axesInfo:[{axisDim:t.axis.dim,axisIndex:t.componentIndex}]})}},_onHandleDragEnd:function(e){if(this._dragging=!1,this._handle){var t=this._axisPointerModel.get("value");this._moveHandleToValue(t),this._api.dispatchAction({type:"hideTip"})}},getHandleTransform:null,updateHandleTransform:null,clear:function(e){this._lastValue=null,this._lastStatus=null;var t=e.getZr(),n=this._group,i=this._handle;t&&n&&(this._lastGraphicKey=null,n&&t.remove(n),i&&t.remove(i),this._group=null,this._handle=null,this._payloadInfo=null)},doClear:function(){},buildLabel:function(e,t,n){return n=n||0,{x:e[n],y:e[1-n],width:t[n],height:t[1-n]}}}).constructor=Af,Ki(Af);var iE=Af.extend({makeElOption:function(e,t,n,i,r){var o=n.axis,a=o.grid,s=i.get("type"),l=Hf(a,o).getOtherAxis(o).getGlobalExtent(),c=o.toGlobalCoord(o.dataToCoord(t,!0));if(s&&"none"!==s){var u=Of(i),d=rE[s](o,c,l,u);d.style=u,e.graphicKey=d.type,e.pointer=d}Vf(t,e,Js(a.model,n),n,i,r)},getHandleTransform:function(e,t,n){var i=Js(t.axis.grid.model,t,{labelInside:!1});return i.labelMargin=n.get("handle.margin"),{position:Rf(t.axis,e,i),rotation:i.rotation+(i.labelDirection<0?Math.PI:0)}},updateHandleTransform:function(e,t,n,i){var r=n.axis,o=r.grid,a=r.getGlobalExtent(!0),s=Hf(o,r).getOtherAxis(r).getGlobalExtent(),l="x"===r.dim?0:1,c=e.position;c[l]+=t[l],c[l]=Math.min(a[1],c[l]),c[l]=Math.max(a[0],c[l]);var u=(s[1]+s[0])/2,d=[u,u];d[l]=c[l];var h=[{verticalAlign:"middle"},{align:"center"}];return{position:c,rotation:e.rotation,cursorPoint:d,tooltipOption:h[l]}}}),rE={line:function(e,t,n,i){var r=Bf([t,n[0]],[t,n[1]],Ff(e));return Yn({shape:r,style:i}),{type:"Line",shape:r}},shadow:function(e,t,n,i){var r=e.getBandWidth(),o=n[1]-n[0];return{type:"Rect",shape:Gf([t-r/2,n[0]],[r,o],Ff(e))}}};FS.registerAxisPointerClass("CartesianAxisPointer",iE),tr(function(e){if(e){(!e.axisPointer||0===e.axisPointer.length)&&(e.axisPointer={});var t=e.axisPointer.link;t&&!y(t)&&(e.axisPointer.link=[t])}}),er(Pw.PROCESSOR.STATISTIC,function(e,t){e.getComponent("axisPointer").coordSysAxesInfo=Bs(e,t)}),ir({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},function(e,t,n){var i=e.currTrigger,r=[e.x,e.y],o=e,a=e.dispatchAction||m(n.dispatchAction,n),s=t.getComponent("axisPointer").coordSysAxesInfo;if(s){xf(r)&&(r=jM({seriesIndex:o.seriesIndex,dataIndex:o.dataIndex},t).point);var l=xf(r),c=o.axesInfo,u=s.axesInfo,d="leave"===i||xf(r),h={},p={},f={list:[],map:{}},g={showPointer:XM(df,p),showTooltip:XM(ff,f)};YM(s.coordSysMap,function(e,t){var n=l||e.containPoint(r);YM(s.coordSysAxesInfo[t],function(e,t){var i=e.axis,o=vf(c,e);if(!d&&n&&(!c||o)){var a=o&&o.value;null!=a||l||(a=i.pointToData(r)),null!=a&&uf(e,a,g,!1,h)}})});var v={};return YM(u,function(e,t){var n=e.linkGroup;n&&!p[t]&&YM(n.axesInfo,function(t,i){var r=p[i];if(t!==e&&r){var o=r.value;n.mapper&&(o=e.axis.scale.parse(n.mapper(o,yf(t),yf(e)))),v[e.key]=o}})}),YM(v,function(e,t){uf(u[t],e,g,!0,h)}),pf(p,u,h),gf(f,r,e,a),mf(u,0,n),h}});var oE=["x","y"],aE=["width","height"],sE=Af.extend({makeElOption:function(e,t,n,i,r){var o=n.axis,a=o.coordinateSystem,s=Uf(a,1-Zf(o)),l=a.dataToPoint(t)[0],c=i.get("type");if(c&&"none"!==c){var u=Of(i),d=lE[c](o,l,s,u);d.style=u,e.graphicKey=d.type,e.pointer=d}Vf(t,e,hf(n),n,i,r)},getHandleTransform:function(e,t,n){var i=hf(t,{labelInside:!1});return i.labelMargin=n.get("handle.margin"),{position:Rf(t.axis,e,i),rotation:i.rotation+(i.labelDirection<0?Math.PI:0)}},updateHandleTransform:function(e,t,n,i){var r=n.axis,o=r.coordinateSystem,a=Zf(r),s=Uf(o,a),l=e.position;l[a]+=t[a],l[a]=Math.min(s[1],l[a]),l[a]=Math.max(s[0],l[a]);var c=Uf(o,1-a),u=(c[1]+c[0])/2,d=[u,u];return d[a]=l[a],{position:l,rotation:e.rotation,cursorPoint:d,tooltipOption:{verticalAlign:"middle"}}}}),lE={line:function(e,t,n,i){var r=Bf([t,n[0]],[t,n[1]],Zf(e));return Yn({shape:r,style:i}),{type:"Line",shape:r}},shadow:function(e,t,n,i){var r=e.getBandWidth(),o=n[1]-n[0];return{type:"Rect",shape:Gf([t-r/2,n[0]],[r,o],Zf(e))}}};FS.registerAxisPointerClass("SingleAxisPointer",sE),lr({type:"single"});var cE=xw.extend({type:"series.themeRiver",dependencies:["singleAxis"],nameMap:null,init:function(e){cE.superApply(this,"init",arguments),this.legendDataProvider=function(){return this.getRawData()}},fixData:function(e){for(var t=e.length,n=f(jc().key(function(e){return e[2]}).entries(e),function(e){return{name:e.key,dataList:e.values}}),i=n.length,r=-1,o=-1,a=0;a<i;++a){var s=n[a].dataList.length;s>r&&(r=s,o=a)}for(var l=0;l<i;++l)if(l!==o)for(var c=n[l].name,u=0;u<r;++u){for(var d=n[o].dataList[u][0],h=n[l].dataList.length,p=-1,g=0;g<h;++g)if(n[l].dataList[g][0]===d){p=g;break}-1===p&&(e[t]=[],e[t][0]=d,e[t][1]=0,e[t][2]=c,t++)}return e},getInitialData:function(e,t){var n=[],i=t.queryComponents({mainType:"singleAxis",index:this.get("singleAxisIndex"),id:this.get("singleAxisId")})[0].get("type");n=[{name:"time",type:"category"===i?"ordinal":"time"===i?"time":"float"},{name:"value",type:"float"},{name:"name",type:"ordinal"}];for(var r=g(e.data,function(e){return void 0!==e[2]}),o=this.fixData(r||[]),a=[],s=this.nameMap=z(),l=0,c=0;c<o.length;++c)a.push(o[c][2]),s.get(o[c][2])||(s.set(o[c][2],l),l++);n=xr(n,o);var u=new sC(n,this);return u.initData(o,a),u},coordDimToDataDim:function(e){return["time"]},getLayerSeries:function(){for(var e=this.getData(),t=e.count(),n=[],i=0;i<t;++i)n[i]=i;for(var r=f(jc().key(function(t){return e.get("name",t)}).entries(n),function(e){return{name:e.key,indices:e.values}}),o=0;o<r.length;++o)r[o].indices.sort(function(t,n){return e.get("time",t)-e.get("time",n)});return r},getAxisTooltipData:function(e,t,n){y(e)||(e=e?[e]:[]);for(var i,r=this.getData(),o=this.getLayerSeries(),a=[],s=o.length,l=0;l<s;++l){for(var c=Number.MAX_VALUE,u=-1,d=o[l].indices.length,h=0;h<d;++h){var p=r.get(e[0],o[l].indices[h]),f=Math.abs(p-t);f<=c&&(i=p,c=f,u=o[l].indices[h])}a.push(u)}return{dataIndices:a,nestestValue:i}},formatTooltip:function(e){var t=this.getData(),n=t.get("name",e),i=t.get("value",e);return(isNaN(i)||null==i)&&(i="-"),Gi(n+" : "+i)},defaultOption:{zlevel:0,z:2,coordinateSystem:"singleAxis",boundaryGap:["10%","10%"],singleAxisIndex:0,animationEasing:"linear",label:{normal:{margin:4,textAlign:"right",show:!0,position:"left",color:"#000",fontSize:11},emphasis:{show:!0}}}});ur({type:"themeRiver",init:function(){this._layers=[]},render:function(e,t,i){function n(e){return e.name}function o(t,n,i){var o=this._layers;if("remove"!==t){for(var c,u=[],d=[],p=l[n].indices,f=0;f<p.length;f++){var g=r.getItemLayout(p[f]),m=g.x,v=g.y0,_=g.y;u.push([m,v]),d.push([m,v+_]),c=r.getItemVisual(p[f],"color")}var y,x,b=r.getItemLayout(p[0]),w=r.getItemModel(p[f-1]),C=w.getModel("label.normal"),S=C.get("margin");if("add"===t)T=h[n]=new X_,y=new hS({shape:{points:u,stackedOnPoints:d,smooth:.4,stackedOnSmooth:.4,smoothConstraint:!1},z2:0}),x=new rb({style:{x:b.x-S,y:b.y0+b.y/2}}),T.add(y),T.add(x),s.add(T),y.setClipPath(Xf(y.getBoundingRect(),e,function(){y.removeClipPath()}));else{var T=o[i];y=T.childAt(0),x=T.childAt(1),s.add(T),h[n]=T,wo(y,{shape:{points:u,stackedOnPoints:d}},e),wo(x,{style:{x:b.x-S,y:b.y0+b.y/2}},e)}var A=w.getModel("itemStyle.emphasis"),M=w.getModel("itemStyle.normal");fo(x.style,C,{text:C.get("show")?e.getFormattedLabel(p[f-1],"normal")||r.getName(p[f-1]):null,textVerticalAlign:"middle"}),y.setStyle(a({fill:c},M.getItemStyle(["color"]))),uo(y,A.getItemStyle())}else s.remove(o[n])}var r=e.getData(),s=this.group,l=e.getLayerSeries(),c=r.getLayout("layoutInfo"),u=c.rect,d=c.boundaryGap;s.attr("position",[0,u.y+d[0]]);var h={};new fr(this._layersSeries||[],l,n,n).add(m(o,this,"add")).update(m(o,this,"update")).remove(m(o,this,"remove")).execute(),this._layersSeries=l,this._layers=h},dispose:function(){}}),or(function(e,t){e.eachSeriesByType("themeRiver",function(e){var t=e.getData(),n=e.coordinateSystem,i={},r=n.getRect();i.rect=r;var o=e.get("boundaryGap"),a=n.getAxis();i.boundaryGap=o,"horizontal"===a.orient?(o[0]=Si(o[0],r.height),o[1]=Si(o[1],r.height),jf(t,e,r.height-o[0]-o[1])):(o[0]=Si(o[0],r.width),o[1]=Si(o[1],r.width),jf(t,e,r.width-o[0]-o[1])),t.setLayout("layoutInfo",i)})}),ar(function(e){e.eachSeriesByType("themeRiver",function(e){var t=e.getData(),n=e.getRawData(),i=e.get("color"),r=z();t.each(function(e){r.set(t.getRawIndex(e),e)}),n.each(function(o){var a=n.getName(o),s=i[(e.nameMap.get(a)-1)%i.length];n.setItemVisual(o,"color",s);var l=r.get(o);null!=l&&t.setItemVisual(l,"color",s)})})}),er(v(aT,"themeRiver"));var uE=["itemStyle","normal"],dE=["itemStyle","emphasis"],hE=["label","normal"],pE=["label","emphasis"],fE="e\0\0",gE={cartesian2d:function(e){var t=e.grid.getRect();return{coordSys:{type:"cartesian2d",x:t.x,y:t.y,width:t.width,height:t.height},api:{coord:m(e.dataToPoint,e),size:m(Yf,e)}}},geo:function(e){var t=e.getBoundingRect();return{coordSys:{type:"geo",x:t.x,y:t.y,width:t.width,height:t.height},api:{coord:m(e.dataToPoint,e),size:m($f,e)}}},singleAxis:function(e){var t=e.getRect();return{coordSys:{type:"singleAxis",x:t.x,y:t.y,width:t.width,height:t.height},api:{coord:m(e.dataToPoint,e),size:m(Kf,e)}}},polar:function(e){var t=e.getRadiusAxis(),n=e.getAngleAxis(),i=t.getExtent();return i[0]>i[1]&&i.reverse(),{coordSys:{type:"polar",cx:e.cx,cy:e.cy,r:i[1],r0:i[0]},api:{coord:m(function(i){var r=t.dataToRadius(i[0]),o=n.dataToAngle(i[1]),a=e.coordToPoint([r,o]);return a.push(r,o*Math.PI/180),a}),size:m(Jf,e)}}},calendar:function(e){var t=e.getRect(),n=e.getRangeInfo();return{coordSys:{type:"calendar",x:t.x,y:t.y,width:t.width,height:t.height,cellWidth:e.getCellWidth(),cellHeight:e.getCellHeight(),rangeInfo:{start:n.start,end:n.end,weeks:n.weeks,dayCount:n.allDay}},api:{coord:m(e.dataToPoint,e)}}}};hr({type:"series.custom",dependencies:["grid","polar","geo","singleAxis","calendar"],defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0},getInitialData:function(e,t){return Sr(e.data,this,t)}}),ur({type:"custom",_data:null,render:function(e,t,n){var i=this._data,r=e.getData(),o=this.group,a=ip(e,r,t,n);r.diff(i).add(function(t){r.hasValue(t)&&op(null,t,a(t),e,o,r)}).update(function(t,n){var s=i.getItemGraphicEl(n);r.hasValue(t)?op(s,t,a(t),e,o,r):s&&o.remove(s)}).remove(function(e){var t=i.getItemGraphicEl(e);t&&o.remove(t)}).execute(),this._data=r},dispose:N}),tr(function(e){var t=e.graphic;y(t)?t[0]&&t[0].elements?e.graphic=[e.graphic[0]]:e.graphic=[{elements:t}]:t&&!t.elements&&(e.graphic=[{elements:[t]}])});var mE=sr({type:"graphic",defaultOption:{elements:[],parentId:null},_elOptionsToUpdate:null,mergeOption:function(e){var t=this.option.elements;this.option.elements=null,mE.superApply(this,"mergeOption",arguments),this.option.elements=t},optionUpdated:function(e,t){var n=this.option,i=(t?n:e).elements,r=n.elements=t?[]:n.elements,o=[];this._flatten(i,o);var a=Vo(r,o);Bo(a);var s=this._elOptionsToUpdate=[];d(a,function(e,t){var n=e.option;n&&(s.push(n),pp(e,n),gp(r,t,n),mp(r[t],n))},this);for(var l=r.length-1;l>=0;l--)null==r[l]?r.splice(l,1):delete r[l].$action},_flatten:function(e,t,n){d(e,function(e){if(e){n&&(e.parentOption=n),t.push(e);var i=e.children;"group"===e.type&&i&&this._flatten(i,t,e),delete e.children}},this)},useElOptionsToUpdate:function(){var e=this._elOptionsToUpdate;return this._elOptionsToUpdate=null,e}});lr({type:"graphic",init:function(e,t){this._elMap=z(),this._lastGraphicModel},render:function(e,t,n){e!==this._lastGraphicModel&&this._clear(),this._lastGraphicModel=e,this._updateElements(e,n),this._relocate(e,n)},_updateElements:function(e,t){var n=e.useElOptionsToUpdate();if(n){var i=this._elMap,r=this.group;d(n,function(e){var t=e.$action,n=e.id,o=i.get(n),a=e.parentId,s=null!=a?i.get(a):r;if("text"===e.type){var l=e.style;e.hv&&e.hv[1]&&(l.textVerticalAlign=l.textBaseline=null),!l.hasOwnProperty("textFill")&&l.fill&&(l.textFill=l.fill),!l.hasOwnProperty("textStroke")&&l.stroke&&(l.textStroke=l.stroke)}var c=dp(e);t&&"merge"!==t?"replace"===t?(cp(o,i),up(n,s,c,i)):"remove"===t&&cp(o,i):o?o.attr(c):up(n,s,c,i);var u=i.get(n);u&&(u.__ecGraphicWidth=e.width,u.__ecGraphicHeight=e.height)})}},_relocate:function(e,t){for(var n=e.option.elements,i=this.group,r=this._elMap,o=n.length-1;o>=0;o--){var a=n[o],s=r.get(a.id);if(s){var l=s.parent;Jo(s,a,l===i?{width:t.getWidth(),height:t.getHeight()}:{width:l.__ecGraphicWidth||0,height:l.__ecGraphicHeight||0},null,{hv:a.hv,boundingMode:a.bounding})}}},_clear:function(){var e=this._elMap;e.each(function(t){cp(t,e)}),this._elMap=z()},dispose:function(){this._clear()}});var vE=sr({type:"legend.plain",dependencies:["series"],layoutMode:{type:"box",ignoreSize:!0},init:function(e,t,n){this.mergeDefaultAndTheme(e,n),e.selected=e.selected||{}},mergeOption:function(e){vE.superCall(this,"mergeOption",e)},optionUpdated:function(){this._updateData(this.ecModel);var e=this._data;if(e[0]&&"single"===this.get("selectedMode")){for(var t=!1,n=0;n<e.length;n++){var i=e[n].get("name");if(this.isSelected(i)){this.select(i),t=!0;break}}!t&&this.select(e[0].get("name"))}},_updateData:function(e){var t=f(this.get("data")||[],function(e){return"string"!=typeof e&&"number"!=typeof e||(e={name:e}),new Lo(e,this,this.ecModel)},this);this._data=t;var n=f(e.getSeries(),function(e){return e.name});e.eachSeries(function(e){if(e.legendDataProvider){var t=e.legendDataProvider();n=n.concat(t.mapArray(t.getName))}}),this._availableNames=n},getData:function(){return this._data},select:function(e){var t=this.option.selected;"single"===this.get("selectedMode")&&d(this._data,function(e){t[e.get("name")]=!1}),t[e]=!0},unSelect:function(e){"single"!==this.get("selectedMode")&&(this.option.selected[e]=!1)},toggleSelected:function(e){var t=this.option.selected;t.hasOwnProperty(e)||(t[e]=!0),this[t[e]?"unSelect":"select"](e)},isSelected:function(e){var t=this.option.selected;return!(t.hasOwnProperty(e)&&!t[e])&&l(this._availableNames,e)>=0},defaultOption:{zlevel:0,z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,inactiveColor:"#ccc",textStyle:{color:"#333"},selectedMode:!0,tooltip:{show:!1}}});ir("legendToggleSelect","legendselectchanged",v(vp,"toggleSelected")),ir("legendSelect","legendselected",v(vp,"select")),ir("legendUnSelect","legendunselected",v(vp,"unSelect"));var _E=v,yE=d,xE=X_,bE=lr({type:"legend.plain",newlineDisabled:!1,init:function(){this.group.add(this._contentGroup=new xE),this._backgroundEl},getContentGroup:function(){return this._contentGroup},render:function(e,t,n){if(this.resetInner(),e.get("show",!0)){var i=e.get("align");i&&"auto"!==i||(i="right"===e.get("left")&&"vertical"===e.get("orient")?"right":"left"),this.renderInner(i,e,t,n);var o=e.getBoxLayoutParams(),a={width:n.getWidth(),height:n.getHeight()},s=e.get("padding"),l=Ko(o,a,s),c=this.layoutInner(e,i,l),u=Ko(r({width:c.width,height:c.height},o),a,s);this.group.attr("position",[u.x-c.x,u.y-c.y]),this.group.add(this._backgroundEl=xp(c,e))}},resetInner:function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl)},renderInner:function(e,t,n,i){var r=this.getContentGroup(),o=z(),a=t.get("selectedMode");yE(t.getData(),function(s,l){var c=s.get("name");if(this.newlineDisabled||""!==c&&"\n"!==c){var u=n.getSeriesByName(c)[0];if(!o.get(c))if(u){var d=u.getData(),h=d.getVisual("color");"function"==typeof h&&(h=h(u.getDataParams(0)));var p=d.getVisual("legendSymbol")||"roundRect",f=d.getVisual("symbol");this._createItem(c,l,s,t,p,f,e,h,a).on("click",_E(_p,c,i)).on("mouseover",_E(bp,u,null,i)).on("mouseout",_E(wp,u,null,i)),o.set(c,!0)}else n.eachRawSeries(function(n){if(!o.get(c)&&n.legendDataProvider){var r=n.legendDataProvider(),u=r.indexOfName(c);if(u<0)return;var d=r.getItemVisual(u,"color");this._createItem(c,l,s,t,"roundRect",null,e,d,a).on("click",_E(_p,c,i)).on("mouseover",_E(bp,n,c,i)).on("mouseout",_E(wp,n,c,i)),o.set(c,!0)}},this)}else r.add(new xE({newline:!0}))},this)},_createItem:function(e,t,n,i,r,o,s,l,c){var u=i.get("itemWidth"),d=i.get("itemHeight"),h=i.get("inactiveColor"),p=i.isSelected(e),f=new xE,g=n.getModel("textStyle"),m=n.get("icon"),v=n.getModel("tooltip"),_=v.parentModel;if(r=m||r,f.add(Hr(r,0,0,u,d,p?l:h,!0)),!m&&o&&(o!==r||"none"==o)){var y=.8*d;"none"===o&&(o="circle"),f.add(Hr(o,(u-y)/2,(d-y)/2,y,y,p?l:h))}var x="left"===s?u+5:-5,b=s,w=i.get("formatter"),C=e;"string"==typeof w&&w?C=w.replace("{name}",null!=e?e:""):"function"==typeof w&&(C=w(e)),f.add(new rb({style:fo({},g,{text:C,x:x,y:d/2,textFill:p?g.getTextColor():h,textAlign:b,textVerticalAlign:"middle"})}));var S=new fb({shape:f.getBoundingRect(),invisible:!0,tooltip:v.get("show")?a({content:e,formatter:_.get("formatter",!0)||function(){return e},formatterParams:{componentType:"legend",legendIndex:i.componentIndex,name:e,$vars:["name"]}},v.option):null});return f.add(S),f.eachChild(function(e){e.silent=!0}),S.silent=!c,this.getContentGroup().add(f),uo(f),f.__legendDataIndex=t,f},layoutInner:function(e,t,n){var i=this.getContentGroup();$b(e.get("orient"),i,e.get("itemGap"),n.width,n.height);var r=i.getBoundingRect();return i.attr("position",[-r.x,-r.y]),this.group.getBoundingRect()}});er(function(e){var t=e.findComponents({mainType:"legend"});t&&t.length&&e.filterSeries(function(e){for(var n=0;n<t.length;n++)if(!t[n].isSelected(e.name))return!1;return!0})}),jb.registerSubTypeDefaulter("legend",function(){return"plain"});var wE=vE.extend({type:"legend.scroll",setScrollDataIndex:function(e){this.option.scrollDataIndex=e},defaultOption:{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800},init:function(e,t,n,i){var r=ea(e);wE.superCall(this,"init",e,t,n,i),Sp(this,e,r)},mergeOption:function(e,t){wE.superCall(this,"mergeOption",e,t),Sp(this,this.option,e)},getOrient:function(){return"vertical"===this.get("orient")?{index:1,name:"vertical"}:{index:0,name:"horizontal"}}}),CE=X_,SE=["width","height"],TE=["x","y"],AE=bE.extend({type:"legend.scroll",newlineDisabled:!0,init:function(){AE.superCall(this,"init"),this._currentIndex=0,this.group.add(this._containerGroup=new CE),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new CE),this._showController},resetInner:function(){AE.superCall(this,"resetInner"),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},renderInner:function(e,t,n,i){function o(e,n){var o=e+"DataIndex",l=Do(t.get("pageIcons",!0)[t.getOrient().name][n],{onclick:m(r._pageGo,r,o,t,i)},{x:-s[0]/2,y:-s[1]/2,width:s[0],height:s[1]});l.name=e,a.add(l)}var r=this;AE.superCall(this,"renderInner",e,t,n,i);var a=this._controllerGroup,s=t.get("pageIconSize",!0);y(s)||(s=[s,s]),o("pagePrev",0);var l=t.getModel("pageTextStyle");a.add(new rb({name:"pageText",style:{textFill:l.getTextColor(),font:l.getFont(),textVerticalAlign:"middle",textAlign:"center"},silent:!0})),o("pageNext",1)},layoutInner:function(e,t,n){var i=this.getContentGroup(),r=this._containerGroup,o=this._controllerGroup,a=e.getOrient().index,s=SE[a],l=SE[1-a],c=TE[1-a];$b(e.get("orient"),i,e.get("itemGap"),a?n.width:null,a?null:n.height),$b("horizontal",o,e.get("pageButtonItemGap",!0));var u=i.getBoundingRect(),d=o.getBoundingRect(),h=this._showController=u[s]>n[s],p=[-u.x,-u.y];p[a]=i.position[a];var f=[0,0],g=[-d.x,-d.y],m=T(e.get("pageButtonGap",!0),e.get("itemGap",!0));h&&("end"===e.get("pageButtonPosition",!0)?g[a]+=n[s]-d[s]:f[a]+=d[s]+m),g[1-a]+=u[l]/2-d[l]/2,i.attr("position",p),r.attr("position",f),o.attr("position",g);var v=this.group.getBoundingRect();if((v={x:0,y:0})[s]=h?n[s]:u[s],v[l]=Math.max(u[l],d[l]),v[c]=Math.min(0,d[c]+g[1-a]),r.__rectSize=n[s],h){var _={x:0,y:0};_[s]=Math.max(n[s]-d[s]-m,0),_[l]=v[l],r.setClipPath(new fb({shape:_})),r.__rectSize=_[s]}else o.eachChild(function(e){e.attr({invisible:!0,silent:!0})});var y=this._getPageInfo(e);return null!=y.pageIndex&&wo(i,{position:y.contentPosition},!!h&&e),this._updatePageInfoView(e,y),v},_pageGo:function(e,t,n){var i=this._getPageInfo(t)[e];null!=i&&n.dispatchAction({type:"legendScroll",scrollDataIndex:i,legendId:t.id})},_updatePageInfoView:function(e,t){var n=this._controllerGroup;d(["pagePrev","pageNext"],function(i){var r=null!=t[i+"DataIndex"],o=n.childOfName(i);o&&(o.setStyle("fill",r?e.get("pageIconColor",!0):e.get("pageIconInactiveColor",!0)),o.cursor=r?"pointer":"default")});var i=n.childOfName("pageText"),r=e.get("pageFormatter"),o=t.pageIndex,a=null!=o?o+1:0,s=t.pageCount;i&&r&&i.setStyle("text",_(r)?r.replace("{current}",a).replace("{total}",s):r({current:a,total:s}))},_getPageInfo:function(t){function e(e){var t=e.getBoundingRect().clone();return t[p]+=e.position[u],t}var n,i,r,o,a=t.get("scrollDataIndex",!0),s=this.getContentGroup(),l=s.getBoundingRect(),c=this._containerGroup.__rectSize,u=t.getOrient().index,d=SE[u],h=SE[1-u],p=TE[u],f=s.position.slice();this._showController?s.eachChild(function(e){e.__legendDataIndex===a&&(o=e)}):o=s.childAt(0);var g=c?Math.ceil(l[d]/c):0;if(o){var m=o.getBoundingRect(),v=o.position[u]+m[p];f[u]=-v-l[p],n=Math.floor(g*(v+m[p]+c/2)/l[d]),n=l[d]&&g?Math.max(0,Math.min(g-1,n)):-1;var _={x:0,y:0};_[d]=c,_[h]=l[h],_[p]=-f[u]-l[p];var y,x=s.children();if(s.eachChild(function(t,n){var i=e(t);i.intersect(_)&&(null==y&&(y=n),r=t.__legendDataIndex),n===x.length-1&&i[p]+i[d]<=_[p]+_[d]&&(r=null)}),null!=y){var b=e(x[y]);if(_[p]=b[p]+b[d]-_[d],y<=0&&b[p]>=_[p])i=null;else{for(;y>0&&e(x[y-1]).intersect(_);)y--;i=x[y].__legendDataIndex}}}return{contentPosition:f,pageIndex:n,pageCount:g,pagePrevDataIndex:i,pageNextDataIndex:r}}});ir("legendScroll","legendscroll",function(e,t){var n=e.scrollDataIndex;null!=n&&t.eachComponent({mainType:"legend",subType:"scroll",query:e},function(e){e.setScrollDataIndex(n)})}),sr({type:"tooltip",dependencies:["axisPointer"],defaultOption:{zlevel:0,z:8,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",confine:!1,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"rgba(50,50,50,0.7)",borderColor:"#333",borderRadius:4,borderWidth:0,padding:5,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#fff",fontSize:14}}});var ME=d,EE=Bi,IE=["","-webkit-","-moz-","-o-"];Ap.prototype={constructor:Ap,_enterable:!0,update:function(){var e=this._container,t=e.currentStyle||document.defaultView.getComputedStyle(e),n=e.style;"absolute"!==n.position&&"absolute"!==t.position&&(n.position="relative")},show:function(e){clearTimeout(this._hideTimeout);var t=this.el;t.style.cssText="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+Tp(e)+";left:"+this._x+"px;top:"+this._y+"px;"+(e.get("extraCssText")||""),t.style.display=t.innerHTML?"block":"none",this._show=!0},setContent:function(e){this.el.innerHTML=null==e?"":e},setEnterable:function(e){this._enterable=e},getSize:function(){var e=this.el;return[e.clientWidth,e.clientHeight]},moveTo:function(e,t){var n,i=this._zr;i&&i.painter&&(n=i.painter.getViewportRootOffset())&&(e+=n.offsetLeft,t+=n.offsetTop);var r=this.el.style;r.left=e+"px",r.top=t+"px",this._x=e,this._y=t},hide:function(){this.el.style.display="none",this._show=!1},hideLater:function(e){!this._show||this._inContent&&this._enterable||(e?(this._hideDelay=e,this._show=!1,this._hideTimeout=setTimeout(m(this.hide,this),e)):this.hide())},isShow:function(){return this._show}};var DE=m,kE=d,LE=Si,NE=new fb({shape:{x:-1,y:-1,width:2,height:2}});lr({type:"tooltip",init:function(e,t){if(!jv.node){var n=new Ap(t.getDom(),t);this._tooltipContent=n}},render:function(e,t,n){if(!jv.node){this.group.removeAll(),this._tooltipModel=e,this._ecModel=t,this._api=n,this._lastDataByCoordSys=null,this._alwaysShowContent=e.get("alwaysShowContent");var i=this._tooltipContent;i.update(),i.setEnterable(e.get("enterable")),this._initGlobalListener(),this._keepShow()}},_initGlobalListener:function(){var e=this._tooltipModel.get("triggerOn");_f("itemTooltip",this._api,DE(function(t,n,i){"none"!==e&&(e.indexOf(t)>=0?this._tryShow(n,i):"leave"===t&&this._hide(i))},this))},_keepShow:function(){var e=this._tooltipModel,t=this._ecModel,n=this._api;if(null!=this._lastX&&null!=this._lastY&&"none"!==e.get("triggerOn")){var i=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){i.manuallyShowTip(e,t,n,{x:i._lastX,y:i._lastY})})}},manuallyShowTip:function(e,t,n,i){if(i.from!==this.uid&&!jv.node){var r=Dp(i,n);this._ticket="";var o=i.dataByCoordSys;if(i.tooltip&&null!=i.x&&null!=i.y){var a=NE;a.position=[i.x,i.y],a.update(),a.tooltip=i.tooltip,this._tryShow({offsetX:i.x,offsetY:i.y,target:a},r)}else if(o)this._tryShow({offsetX:i.x,offsetY:i.y,position:i.position,event:{},dataByCoordSys:i.dataByCoordSys,tooltipOption:i.tooltipOption},r);else if(null!=i.seriesIndex){if(this._manuallyAxisShowTip(e,t,n,i))return;var s=jM(i,t),l=s.point[0],c=s.point[1];null!=l&&null!=c&&this._tryShow({offsetX:l,offsetY:c,position:i.position,target:s.el,event:{}},r)}else null!=i.x&&null!=i.y&&(n.dispatchAction({type:"updateAxisPointer",x:i.x,y:i.y}),this._tryShow({offsetX:i.x,offsetY:i.y,position:i.position,target:n.getZr().findHover(i.x,i.y).target,event:{}},r))}},manuallyHideTip:function(e,t,n,i){var r=this._tooltipContent;this._alwaysShowContent||r.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=null,i.from!==this.uid&&this._hide(Dp(i,n))},_manuallyAxisShowTip:function(e,t,n,i){var r=i.seriesIndex,o=i.dataIndex,a=t.getComponent("axisPointer").coordSysAxesInfo;if(null!=r&&null!=o&&null!=a){var s=t.getSeriesByIndex(r);if(s&&"axis"===(e=Cp([s.getData().getItemModel(o),s,(s.coordinateSystem||{}).model,e])).get("trigger"))return n.dispatchAction({type:"updateAxisPointer",seriesIndex:r,dataIndex:o,position:i.position}),!0}},_tryShow:function(e,t){var n=e.target;if(this._tooltipModel){this._lastX=e.offsetX,this._lastY=e.offsetY;var i=e.dataByCoordSys;i&&i.length?this._showAxisTooltip(i,e):n&&null!=n.dataIndex?(this._lastDataByCoordSys=null,this._showSeriesItemTooltip(e,n,t)):n&&n.tooltip?(this._lastDataByCoordSys=null,this._showComponentItemTooltip(e,n,t)):(this._lastDataByCoordSys=null,this._hide(t))}},_showOrMove:function(e,t){var n=e.get("showDelay");t=m(t,this),clearTimeout(this._showTimout),n>0?this._showTimout=setTimeout(t,n):t()},_showAxisTooltip:function(e,t){var n=this._ecModel,i=this._tooltipModel,r=[t.offsetX,t.offsetY],o=[],a=[],s=Cp([t.tooltipOption,i]);kE(e,function(e){kE(e.dataByAxis,function(e){var t=n.getComponent(e.axisDim+"Axis",e.axisIndex),i=e.value,r=[];if(t&&null!=i){var s=Ef(i,t.axis,n,e.seriesDataIndices,e.valueLabelOpt);d(e.seriesDataIndices,function(o){var l=n.getSeriesByIndex(o.seriesIndex),c=o.dataIndexInside,u=l&&l.getDataParams(c);u.axisDim=e.axisDim,u.axisIndex=e.axisIndex,u.axisType=e.axisType,u.axisId=e.axisId,u.axisValue=Br(t.axis,i),u.axisValueLabel=s,u&&(a.push(u),r.push(l.formatTooltip(c,!0)))});var l=s;o.push((l?Gi(l)+"<br />":"")+r.join("<br />"))}})},this),o.reverse(),o=o.join("<br /><br />");var l=t.position;this._showOrMove(s,function(){this._updateContentNotChangedOnAxis(e)?this._updatePosition(s,l,r[0],r[1],this._tooltipContent,a):this._showTooltipContent(s,o,a,Math.random(),r[0],r[1],l)})},_showSeriesItemTooltip:function(e,t,n){var i=this._ecModel,r=t.seriesIndex,o=i.getSeriesByIndex(r),a=t.dataModel||o,s=t.dataIndex,l=t.dataType,c=a.getData(),u=Cp([c.getItemModel(s),a,o&&(o.coordinateSystem||{}).model,this._tooltipModel]),d=u.get("trigger");if(null==d||"item"===d){var h=a.getDataParams(s,l),p=a.formatTooltip(s,!1,l),f="item_"+a.name+"_"+s;this._showOrMove(u,function(){this._showTooltipContent(u,p,h,f,e.offsetX,e.offsetY,e.position,e.target)}),n({type:"showTip",dataIndexInside:s,dataIndex:c.getRawIndex(s),seriesIndex:r,from:this.uid})}},_showComponentItemTooltip:function(e,t,n){var i=t.tooltip;if("string"==typeof i){var r=i;i={content:r,formatter:r}}var o=new Lo(i,this._tooltipModel,this._ecModel),a=o.get("content"),s=Math.random();this._showOrMove(o,function(){this._showTooltipContent(o,a,o.get("formatterParams")||{},s,e.offsetX,e.offsetY,e.position,t)}),n({type:"showTip",from:this.uid})},_showTooltipContent:function(e,t,n,i,r,o,a,s){if(this._ticket="",e.get("showContent")&&e.get("show")){var l=this._tooltipContent,c=e.get("formatter");a=a||e.get("position");var u=t;if(c&&"string"==typeof c)u=Wi(c,n,!0);else if("function"==typeof c){var d=DE(function(t,i){t===this._ticket&&(l.setContent(i),this._updatePosition(e,a,r,o,l,n,s))},this);this._ticket=i,u=c(n,i,d)}l.setContent(u),l.show(e),this._updatePosition(e,a,r,o,l,n,s)}},_updatePosition:function(e,t,n,i,r,o,a){var s=this._api.getWidth(),l=this._api.getHeight();t=t||e.get("position");var c=r.getSize(),u=e.get("align"),d=e.get("verticalAlign"),h=a&&a.getBoundingRect().clone();if(a&&h.applyTransform(a.transform),"function"==typeof t&&(t=t([n,i],o,r.el,h,{viewSize:[s,l],contentSize:c.slice()})),y(t))n=LE(t[0],s),i=LE(t[1],l);else if(b(t)){t.width=c[0],t.height=c[1];var p=Ko(t,{width:s,height:l});n=p.x,i=p.y,u=null,d=null}else"string"==typeof t&&a?(n=(f=Op(t,h,c))[0],i=f[1]):(n=(f=Lp(n,i,r.el,s,l,u?null:20,d?null:20))[0],i=f[1]);if(u&&(n-=zp(u)?c[0]/2:"right"===u?c[0]:0),d&&(i-=zp(d)?c[1]/2:"bottom"===d?c[1]:0),e.get("confine")){var f=kp(n,i,r.el,s,l);n=f[0],i=f[1]}r.moveTo(n,i)},_updateContentNotChangedOnAxis:function(e){var t=this._lastDataByCoordSys,n=!!t&&t.length===e.length;return n&&kE(t,function(t,i){var r=t.dataByAxis||{},o=(e[i]||{}).dataByAxis||[];(n&=r.length===o.length)&&kE(r,function(e,t){var i=o[t]||{},r=e.seriesDataIndices||[],a=i.seriesDataIndices||[];(n&=e.value===i.value&&e.axisType===i.axisType&&e.axisId===i.axisId&&r.length===a.length)&&kE(r,function(e,t){var i=a[t];n&=e.seriesIndex===i.seriesIndex&&e.dataIndex===i.dataIndex})})}),this._lastDataByCoordSys=e,!!n},_hide:function(e){this._lastDataByCoordSys=null,e({type:"hideTip",from:this.uid})},dispose:function(e,t){jv.node||(this._tooltipContent.hide(),Tf("itemTooltip",t))}}),ir({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},function(){}),ir({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},function(){}),Vp.prototype={constructor:Vp,pointToData:function(e,t){return this.polar.pointToData(e,t)["radius"===this.dim?0:1]},dataToRadius:jC.prototype.dataToCoord,radiusToData:jC.prototype.coordToData},h(Vp,jC),Bp.prototype={constructor:Bp,pointToData:function(e,t){return this.polar.pointToData(e,t)["radius"===this.dim?0:1]},dataToAngle:jC.prototype.dataToCoord,angleToData:jC.prototype.coordToData},h(Bp,jC);var PE=function(e){this.name=e||"",this.cx=0,this.cy=0,this._radiusAxis=new Vp,this._angleAxis=new Bp,this._radiusAxis.polar=this._angleAxis.polar=this};PE.prototype={type:"polar",axisPointerEnabled:!0,constructor:PE,dimensions:["radius","angle"],model:null,containPoint:function(e){var t=this.pointToCoord(e);return this._radiusAxis.contain(t[0])&&this._angleAxis.contain(t[1])},containData:function(e){return this._radiusAxis.containData(e[0])&&this._angleAxis.containData(e[1])},getAxis:function(e){return this["_"+e+"Axis"]},getAxes:function(){return[this._radiusAxis,this._angleAxis]},getAxesByScale:function(e){var t=[],n=this._angleAxis,i=this._radiusAxis;return n.scale.type===e&&t.push(n),i.scale.type===e&&t.push(i),t},getAngleAxis:function(){return this._angleAxis},getRadiusAxis:function(){return this._radiusAxis},getOtherAxis:function(e){var t=this._angleAxis;return e===t?this._radiusAxis:t},getBaseAxis:function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAngleAxis()},getTooltipAxes:function(e){var t=null!=e&&"auto"!==e?this.getAxis(e):this.getBaseAxis();return{baseAxes:[t],otherAxes:[this.getOtherAxis(t)]}},dataToPoint:function(e,t){return this.coordToPoint([this._radiusAxis.dataToRadius(e[0],t),this._angleAxis.dataToAngle(e[1],t)])},pointToData:function(e,t){var n=this.pointToCoord(e);return[this._radiusAxis.radiusToData(n[0],t),this._angleAxis.angleToData(n[1],t)]},pointToCoord:function(e){var t=e[0]-this.cx,n=e[1]-this.cy,i=this.getAngleAxis(),r=i.getExtent(),o=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);i.inverse?o=a-360:a=o+360;var s=Math.sqrt(t*t+n*n);t/=s,n/=s;for(var l=Math.atan2(-n,t)/Math.PI*180,c=l<o?1:-1;l<o||l>a;)l+=360*c;return[s,l]},coordToPoint:function(e){var t=e[0],n=e[1]/180*Math.PI;return[Math.cos(n)*t+this.cx,-Math.sin(n)*t+this.cy]}};var OE=jb.extend({type:"polarAxis",axis:null,getCoordSysModel:function(){return this.ecModel.queryComponents({mainType:"polar",index:this.option.polarIndex,id:this.option.polarId})[0]}});n(OE.prototype,RC);var RE={angle:{startAngle:90,clockwise:!0,splitNumber:12,axisLabel:{rotate:!1}},radius:{splitNumber:5}};wS("angle",OE,Gp,RE.angle),wS("radius",OE,Gp,RE.radius),sr({type:"polar",dependencies:["polarAxis","angleAxis"],coordinateSystem:null,findAxisModel:function(e){var t;return this.ecModel.eachComponent(e,function(e){e.getCoordSysModel()===this&&(t=e)},this),t},defaultOption:{zlevel:0,z:0,center:["50%","50%"],radius:"80%"}});var zE={dimensions:PE.prototype.dimensions,create:function(e,t){var n=[];return e.eachComponent("polar",function(e,i){var r=new PE(i);r.update=Hp;var o=r.getRadiusAxis(),a=r.getAngleAxis(),s=e.findAxisModel("radiusAxis"),l=e.findAxisModel("angleAxis");Fp(o,s),Fp(a,l),Wp(r,e,t),n.push(r),e.coordinateSystem=r,r.model=e}),e.eachSeries(function(t){if("polar"===t.get("coordinateSystem")){var n=e.queryComponents({mainType:"polar",index:t.get("polarIndex"),id:t.get("polarId")})[0];t.coordinateSystem=n.coordinateSystem}}),n}};ua.register("polar",zE);var FE=["axisLine","axisLabel","axisTick","splitLine","splitArea"];FS.extend({type:"angleAxis",axisPointerClass:"PolarAxisPointer",render:function(e,t){if(this.group.removeAll(),e.get("show")){var n=e.axis,i=n.polar,r=i.getRadiusAxis().getExtent(),o=n.getTicksCoords();"category"!==n.type&&o.pop(),d(FE,function(t){!e.get(t+".show")||n.scale.isBlank()&&"axisLine"!==t||this["_"+t](e,i,o,r)},this)}},_axisLine:function(e,t,n,i){var r=e.getModel("axisLine.lineStyle"),o=new ob({shape:{cx:t.cx,cy:t.cy,r:i[Up(t)]},style:r.getLineStyle(),z2:1,silent:!0});o.style.fill=null,this.group.add(o)},_axisTick:function(e,t,n,i){var o=e.getModel("axisTick"),a=(o.get("inside")?-1:1)*o.get("length"),s=i[Up(t)],l=f(n,function(e){return new gb({shape:Zp(t,[s,s+a],e)})});this.group.add(Mb(l,{style:r(o.getModel("lineStyle").getLineStyle(),{stroke:e.get("axisLine.lineStyle.color")})}))},_axisLabel:function(e,t,n,i){for(var r=e.axis,o=e.get("data"),a=e.getModel("axisLabel"),s=e.getFormattedLabels(),l=a.get("margin"),c=r.getLabelsCoords(),u=0;u<n.length;u++){var d=i[Up(t)],h=t.coordToPoint([d+l,c[u]]),p=t.cx,f=t.cy,g=Math.abs(h[0]-p)/d<.3?"center":h[0]>p?"left":"right",m=Math.abs(h[1]-f)/d<.3?"middle":h[1]>f?"top":"bottom";o&&o[u]&&o[u].textStyle&&(a=new Lo(o[u].textStyle,a,a.ecModel));var v=new rb({silent:!0});this.group.add(v),fo(v.style,a,{x:h[0],y:h[1],textFill:a.getTextColor()||e.get("axisLine.lineStyle.color"),text:s[u],textAlign:g,textVerticalAlign:m})}},_splitLine:function(e,t,n,i){var o=e.getModel("splitLine").getModel("lineStyle"),a=o.get("color"),s=0;a=a instanceof Array?a:[a];for(var l=[],c=0;c<n.length;c++){var u=s++%a.length;l[u]=l[u]||[],l[u].push(new gb({shape:Zp(t,i,n[c])}))}for(c=0;c<l.length;c++)this.group.add(Mb(l[c],{style:r({stroke:a[c%a.length]},o.getLineStyle()),silent:!0,z:e.get("z")}))},_splitArea:function(e,t,n,i){var o=e.getModel("splitArea").getModel("areaStyle"),a=o.get("color"),s=0;a=a instanceof Array?a:[a];for(var l=[],c=Math.PI/180,u=-n[0]*c,d=Math.min(i[0],i[1]),h=Math.max(i[0],i[1]),p=e.get("clockwise"),f=1;f<n.length;f++){var g=s++%a.length;l[g]=l[g]||[],l[g].push(new lb({shape:{cx:t.cx,cy:t.cy,r0:d,r:h,startAngle:u,endAngle:-n[f]*c,clockwise:p},silent:!0})),u=-n[f]*c}for(f=0;f<l.length;f++)this.group.add(Mb(l[f],{style:r({fill:a[f%a.length]},o.getAreaStyle()),silent:!0}))}});var BE=["axisLine","axisTickLabel","axisName"],HE=["splitLine","splitArea"];FS.extend({type:"radiusAxis",axisPointerClass:"PolarAxisPointer",render:function(e,t){if(this.group.removeAll(),e.get("show")){var n=e.axis,i=n.polar,r=i.getAngleAxis(),o=n.getTicksCoords(),a=r.getExtent()[0],s=n.getExtent(),l=Xp(i,e,a),c=new kS(e,l);d(BE,c.add,c),this.group.add(c.getGroup()),d(HE,function(t){e.get(t+".show")&&!n.scale.isBlank()&&this["_"+t](e,i,a,s,o)},this)}},_splitLine:function(e,t,n,i,o){var a=e.getModel("splitLine").getModel("lineStyle"),s=a.get("color"),l=0;s=s instanceof Array?s:[s];for(var c=[],u=0;u<o.length;u++){var d=l++%s.length;c[d]=c[d]||[],c[d].push(new ob({shape:{cx:t.cx,cy:t.cy,r:o[u]},silent:!0}))}for(u=0;u<c.length;u++)this.group.add(Mb(c[u],{style:r({stroke:s[u%s.length],fill:null},a.getLineStyle()),silent:!0}))},_splitArea:function(e,t,n,i,o){var a=e.getModel("splitArea").getModel("areaStyle"),s=a.get("color"),l=0;s=s instanceof Array?s:[s];for(var c=[],u=o[0],d=1;d<o.length;d++){var h=l++%s.length;c[h]=c[h]||[],c[h].push(new lb({shape:{cx:t.cx,cy:t.cy,r0:u,r:o[d],startAngle:0,endAngle:2*Math.PI},silent:!0})),u=o[d]}for(d=0;d<c.length;d++)this.group.add(Mb(c[d],{style:r({fill:s[d%s.length]},a.getAreaStyle()),silent:!0}))}});var VE=Af.extend({makeElOption:function(e,t,n,i,r){var o=n.axis;"angle"===o.dim&&(this.animationThreshold=Math.PI/18);var a,s=o.polar,l=s.getOtherAxis(o).getExtent();a=o["dataTo"+Ui(o.dim)](t);var c=i.get("type");if(c&&"none"!==c){var u=Of(i),d=WE[c](o,s,a,l,u);d.style=u,e.graphicKey=d.type,e.pointer=d}zf(e,n,i,r,jp(t,n,0,s,i.get("label.margin")))}}),WE={line:function(e,t,n,i,r){return"angle"===e.dim?{type:"Line",shape:Bf(t.coordToPoint([i[0],n]),t.coordToPoint([i[1],n]))}:{type:"Circle",shape:{cx:t.cx,cy:t.cy,r:n}}},shadow:function(e,t,n,i,r){var o=e.getBandWidth(),a=Math.PI/180;return"angle"===e.dim?{type:"Sector",shape:Wf(t.cx,t.cy,i[0],i[1],(-n-o/2)*a,(o/2-n)*a)}:{type:"Sector",shape:Wf(t.cx,t.cy,n-o/2,n+o/2,0,2*Math.PI)}}};FS.registerAxisPointerClass("PolarAxisPointer",VE),or(v(function(e,t,n){var i=n.getWidth(),r=n.getHeight(),o={},a={},s=Rp(g(t.getSeriesByType(e),function(e){return!t.isSeriesFiltered(e)&&e.coordinateSystem&&"polar"===e.coordinateSystem.type}));t.eachSeriesByType(e,function(e){if("polar"===e.coordinateSystem.type){var t=e.getData(),n=e.coordinateSystem,l=n.getAngleAxis(),c=n.getBaseAxis(),u=Np(e),d=s[Ep(c)][u],h=d.offset,p=d.width,f=n.getOtherAxis(c),g=e.get("center")||["50%","50%"],m=Si(g[0],i),v=Si(g[1],r),_=e.get("barMinHeight")||0,y=e.get("barMinAngle")||0,x=f.getExtent()[0],b=f.model.get("max"),w=f.model.get("min"),C=[e.coordDimToDataDim("radius")[0],e.coordDimToDataDim("angle")[0]],S=t.mapArray(C,function(e,t){return n.dataToPoint([e,t])},!0);o[u]=o[u]||[],a[u]=a[u]||[],t.each(e.coordDimToDataDim(f.dim)[0],function(e,i){if(!isNaN(e)){o[u][i]||(o[u][i]={p:x,n:x},a[u][i]={p:x,n:x});var r,s,c,d,g=e>=0?"p":"n",C=n.pointToCoord(S[i]),T=a[u][i][g];if("radius"===f.dim)r=T,s=C[0],d=(c=(-C[1]+h)*Math.PI/180)+p*Math.PI/180,Math.abs(s)<_&&(s=r+(s<0?-1:1)*_),a[u][i][g]=s;else{s=(r=C[0]+h)+p,null!=b&&(e=Math.min(e,b)),null!=w&&(e=Math.max(e,w));var A=l.dataToAngle(e);Math.abs(A-T)<y&&(A=T-(e<0?-1:1)*y),c=-T*Math.PI/180,d=-A*Math.PI/180;var M=l.getExtent(),E=A;E===M[0]&&e>0?E=M[1]:E===M[1]&&e<0&&(E=M[0]),a[u][i][g]=E}t.setItemLayout(i,{cx:m,cy:v,r0:r,r:s,startAngle:c,endAngle:d})}},!0)}},this)},"bar")),lr({type:"polar"}),u(jb.extend({type:"geo",coordinateSystem:null,layoutMode:"box",init:function(e){jb.prototype.init.apply(this,arguments),zo(e.label,["show"])},optionUpdated:function(){var e=this.option,t=this;e.regions=bT.getFilledRegions(e.regions,e.map,e.nameMap),this._optionModelMap=p(e.regions||[],function(e,n){return n.name&&e.set(n.name,new Lo(n,t)),e},z()),this.updateSelectedMap(e.regions)},defaultOption:{zlevel:0,z:0,show:!0,left:"center",top:"center",aspectScale:.75,silent:!1,map:"",boundingCoords:null,center:null,zoom:1,scaleLimit:null,label:{normal:{show:!1,color:"#000"},emphasis:{show:!0,color:"rgb(100,0,0)"}},itemStyle:{normal:{borderWidth:.5,borderColor:"#444",color:"#eee"},emphasis:{color:"rgba(255,215,0,0.8)"}},regions:[]},getRegionModel:function(e){return this._optionModelMap.get(e)||new Lo(null,this,this.ecModel)},getFormattedLabel:function(e,t){var n=this.getRegionModel(e).get("label."+t+".formatter"),i={name:e};return"function"==typeof n?(i.status=t,n(i)):"string"==typeof n?n.replace("{a}",null!=e?e:""):void 0},setZoom:function(e){this.option.zoom=e},setCenter:function(e){this.option.center=e}}),JS),lr({type:"geo",init:function(e,t){var n=new Ul(t,!0);this._mapDraw=n,this.group.add(n.group)},render:function(e,t,n,i){if(!i||"geoToggleSelect"!==i.type||i.from!==this.uid){var r=this._mapDraw;e.get("show")?r.draw(e,t,n,this,i):this._mapDraw.group.removeAll(),this.group.silent=e.get("silent")}},dispose:function(){this._mapDraw&&this._mapDraw.remove()}}),qp("toggleSelected",{type:"geoToggleSelect",event:"geoselectchanged"}),qp("select",{type:"geoSelect",event:"geoselected"}),qp("unSelect",{type:"geoUnSelect",event:"geounselected"});var UE=["rect","polygon","keep","clear"],$E=d,GE={lineX:tg(0),lineY:tg(1),rect:{point:function(e,t,n){return e&&n.boundingRect.contain(e[0],e[1])},rect:function(e,t,n){return e&&n.boundingRect.intersect(e)}},polygon:{point:function(e,t,n){return e&&n.boundingRect.contain(e[0],e[1])&&Ur(n.range,e[0],e[1])},rect:function(e,t,n){var i=n.range;if(!e||i.length<=1)return!1;var r=e.x,o=e.y,a=e.width,s=e.height,l=i[0];return!!(Ur(i,r,o)||Ur(i,r+a,o)||Ur(i,r,o+s)||Ur(i,r+a,o+s)||jt.create(e).contain(l[0],l[1])||ig(r,o,r+a,o,i)||ig(r,o,r,o+s,i)||ig(r+a,o,r+a,o+s,i)||ig(r,o+s,r+a,o+s,i))||void 0}}},qE=d,jE=l,YE=v,XE=["dataToPoint","pointToData"],ZE=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"],KE=rg.prototype;KE.setOutputRanges=function(e,t){this.matchOutputRanges(e,t,function(e,t,n){if((e.coordRanges||(e.coordRanges=[])).push(t),!e.coordRange){e.coordRange=t;var i=tI[e.brushType](0,n,t);e.__rangeOffset={offset:nI[e.brushType](i.values,e.range,[1,1]),xyMinMax:i.xyMinMax}}})},KE.matchOutputRanges=function(e,t,n){qE(e,function(e){var i=this.findTargetInfo(e,t);i&&!0!==i&&d(i.coordSyses,function(i){var r=tI[e.brushType](1,i,e.range);n(e,r.values,i,t)})},this)},KE.setInputRanges=function(e,t){qE(e,function(e){var n=this.findTargetInfo(e,t);if(e.range=e.range||[],n&&!0!==n){e.panelId=n.panelId;var i=tI[e.brushType](0,n.coordSys,e.coordRange),r=e.__rangeOffset;e.range=r?nI[e.brushType](i.values,r.offset,cg(i.xyMinMax,r.xyMinMax)):i.values}},this)},KE.makePanelOpts=function(e,t){return f(this._targetInfoList,function(n){var i=n.getPanelRect();return{panelId:n.panelId,defaultBrushType:t&&t(n),clipPath:Lc(i),isTargetByCursor:Pc(i,e,n.coordSysModel),getLinearBrushOtherExtent:kc(i)}})},KE.controlSeries=function(e,t,n){var i=this.findTargetInfo(e,n);return!0===i||i&&jE(i.coordSyses,t.coordinateSystem)>=0},KE.findTargetInfo=function(e,t){for(var n=this._targetInfoList,i=lg(t,e),r=0;r<n.length;r++){var o=n[r],a=e.panelId;if(a){if(o.panelId===a)return o}else for(r=0;r<QE.length;r++)if(QE[r](i,o))return o}return!0};var JE={grid:function(e,t){var n=e.xAxisModels,i=e.yAxisModels,r=e.gridModels,o=z(),a={},s={};(n||i||r)&&(qE(n,function(e){var t=e.axis.grid.model;o.set(t.id,t),a[t.id]=!0}),qE(i,function(e){var t=e.axis.grid.model;o.set(t.id,t),s[t.id]=!0}),qE(r,function(e){o.set(e.id,e),a[e.id]=!0,s[e.id]=!0}),o.each(function(e){var r=e.coordinateSystem,o=[];qE(r.getCartesians(),function(e,t){(jE(n,e.getAxis("x").model)>=0||jE(i,e.getAxis("y").model)>=0)&&o.push(e)}),t.push({panelId:"grid--"+e.id,gridModel:e,coordSysModel:e,coordSys:o[0],coordSyses:o,getPanelRect:eI.grid,xAxisDeclared:a[e.id],yAxisDeclared:s[e.id]})}))},geo:function(e,t){qE(e.geoModels,function(e){var n=e.coordinateSystem;t.push({panelId:"geo--"+e.id,geoModel:e,coordSysModel:e,coordSys:n,coordSyses:[n],getPanelRect:eI.geo})})}},QE=[function(e,t){var n=e.xAxisModel,i=e.yAxisModel,r=e.gridModel;return!r&&n&&(r=n.axis.grid.model),!r&&i&&(r=i.axis.grid.model),r&&r===t.gridModel},function(e,t){var n=e.geoModel;return n&&n===t.geoModel}],eI={grid:function(){return this.coordSys.grid.getRect().clone()},geo:function(){var e=this.coordSys,t=e.getBoundingRect().clone();return t.applyTransform(Mo(e)),t}},tI={lineX:YE(hg,0),lineY:YE(hg,1),rect:function(e,t,n){var i=t[XE[e]]([n[0][0],n[1][0]]),r=t[XE[e]]([n[0][1],n[1][1]]),o=[sg([i[0],r[0]]),sg([i[1],r[1]])];return{values:o,xyMinMax:o}},polygon:function(e,t,n){var i=[[1/0,-1/0],[1/0,-1/0]];return{values:f(n,function(n){var r=t[XE[e]](n);return i[0][0]=Math.min(i[0][0],r[0]),i[1][0]=Math.min(i[1][0],r[1]),i[0][1]=Math.max(i[0][1],r[0]),i[1][1]=Math.max(i[1][1],r[1]),r}),xyMinMax:i}}},nI={lineX:YE(ug,0),lineY:YE(ug,1),rect:function(e,t,n){return[[e[0][0]-n[0]*t[0][0],e[0][1]-n[0]*t[0][1]],[e[1][0]-n[1]*t[1][0],e[1][1]-n[1]*t[1][1]]]},polygon:function(e,t,n){return f(e,function(e,i){return[e[0]-n[0]*t[i][0],e[1]-n[1]*t[i][1]]})}},iI=["inBrush","outOfBrush"],rI="__ecBrushSelect",oI="__ecInBrushSelectEvent",aI=Pw.VISUAL.BRUSH;or(aI,function(e,t,n){e.eachComponent({mainType:"brush"},function(t){n&&"takeGlobalCursor"===n.type&&t.setBrushOption("brush"===n.key?n.brushOption:{brushType:!1}),(t.brushTargetManager=new rg(t.option,e)).setInputRanges(t.areas,e)})}),ar(aI,function(e,t,n){var o,a,s=[];e.eachComponent({mainType:"brush"},function(t,n){function l(e){return"all"===m||v[e]}function h(e){return!!e.length}function u(e,t){var n=e.coordinateSystem;b|=n.hasAxisBrushed(),l(t)&&n.eachActiveState(e.getData(),function(e,t){"active"===e&&(_[t]=1)})}function c(n,i,r){var o=mg(n);if(o&&!vg(t,i)&&(d(w,function(i){o[i.brushType]&&t.brushTargetManager.controlSeries(i,n,e)&&r.push(i),b|=h(r)}),l(i)&&h(r))){var a=n.getData();a.each(function(e){gg(o,r,a,e)&&(_[e]=1)})}}var p={brushId:t.id,brushIndex:n,brushName:t.name,areas:i(t.areas),selected:[]};s.push(p);var g=t.option,m=g.brushLink,v=[],_=[],x=[],b=0;n||(o=g.throttleType,a=g.throttleDelay);var w=f(t.areas,function(e){return yg(r({boundingRect:sI[e.brushType](e)},e))}),C=Kp(t.option,iI,function(e){e.mappingMethod="fixed"});y(m)&&d(m,function(e){v[e]=1}),e.eachSeries(function(e,t){var n=x[t]=[];"parallel"===e.subType?u(e,t):c(e,t,n)}),e.eachSeries(function(e,t){var n={seriesId:e.id,seriesIndex:t,seriesName:e.name,dataIndex:[]};p.selected.push(n);var i=mg(e),r=x[t],o=e.getData(),a=l(t)?function(e){return _[e]?(n.dataIndex.push(o.getRawIndex(e)),"inBrush"):"outOfBrush"}:function(e){return gg(i,r,o,e)?(n.dataIndex.push(o.getRawIndex(e)),"inBrush"):"outOfBrush"};(l(t)?b:h(r))&&Qp(iI,C,o,a)})}),fg(t,o,a,s,n)});var sI={lineX:N,lineY:N,rect:function(e){return xg(e.range)},polygon:function(e){for(var t,n=e.range,i=0,r=n.length;i<r;i++){t=t||[[1/0,-1/0],[1/0,-1/0]];var o=n[i];o[0]<t[0][0]&&(t[0][0]=o[0]),o[0]>t[0][1]&&(t[0][1]=o[0]),o[1]<t[1][0]&&(t[1][0]=o[1]),o[1]>t[1][1]&&(t[1][1]=o[1])}return t&&xg(t)}},lI=["#ddd"];sr({type:"brush",dependencies:["geo","grid","xAxis","yAxis","parallel","series"],defaultOption:{toolbox:null,brushLink:null,seriesIndex:"all",geoIndex:null,xAxisIndex:null,yAxisIndex:null,brushType:"rect",brushMode:"single",transformable:!0,brushStyle:{borderWidth:1,color:"rgba(120,140,180,0.3)",borderColor:"rgba(120,140,180,0.8)"},throttleType:"fixRate",throttleDelay:0,removeOnClick:!0,z:1e4},areas:[],brushType:null,brushOption:{},coordInfoList:[],optionUpdated:function(e,t){var n=this.option;!t&&Jp(n,e,["inBrush","outOfBrush"]),n.inBrush=n.inBrush||{},n.outOfBrush=n.outOfBrush||{color:lI}},setAreas:function(e){e&&(this.areas=f(e,function(e){return _g(this.option,e)},this))},setBrushOption:function(e){this.brushOption=_g(this.option,e),this.brushType=this.brushOption.brushType}}),lr({type:"brush",init:function(e,t){this.ecModel=e,this.api=t,this.model,(this._brushController=new Yu(t.getZr())).on("brush",m(this._onBrush,this)).mount()},render:function(e){return this.model=e,bg.apply(this,arguments)},updateView:bg,updateLayout:bg,updateVisual:bg,dispose:function(){this._brushController.dispose()},_onBrush:function(e,t){var n=this.model.id;this.model.brushTargetManager.setOutputRanges(e,this.ecModel),(!t.isEnd||t.removeOnClick)&&this.api.dispatchAction({type:"brush",brushId:n,areas:i(e),$from:n})}}),ir({type:"brush",event:"brush",update:"updateView"},function(e,t){t.eachComponent({mainType:"brush",query:e},function(t){t.setAreas(e.areas)})}),ir({type:"brushSelect",event:"brushSelected",update:"none"},function(){});var cI={},uI={toolbox:{brush:{title:{rect:"矩形选择",polygon:"圈选",lineX:"横向选择",lineY:"纵向选择",keep:"保持选择",clear:"清除选择"}},dataView:{title:"数据视图",lang:["数据视图","关闭","刷新"]},dataZoom:{title:{zoom:"区域缩放",back:"区域缩放还原"}},magicType:{title:{line:"切换为折线图",bar:"切换为柱状图",stack:"切换为堆叠",tiled:"切换为平铺"}},restore:{title:"还原"},saveAsImage:{title:"保存为图片",lang:["右键另存为图片"]}}},dI=uI.toolbox.brush;Mg.defaultOption={show:!0,type:["rect","polygon","lineX","lineY","keep","clear"],icon:{rect:"M7.3,34.7 M0.4,10V-0.2h9.8 M89.6,10V-0.2h-9.8 M0.4,60v10.2h9.8 M89.6,60v10.2h-9.8 M12.3,22.4V10.5h13.1 M33.6,10.5h7.8 M49.1,10.5h7.8 M77.5,22.4V10.5h-13 M12.3,31.1v8.2 M77.7,31.1v8.2 M12.3,47.6v11.9h13.1 M33.6,59.5h7.6 M49.1,59.5 h7.7 M77.5,47.6v11.9h-13",polygon:"M55.2,34.9c1.7,0,3.1,1.4,3.1,3.1s-1.4,3.1-3.1,3.1 s-3.1-1.4-3.1-3.1S53.5,34.9,55.2,34.9z M50.4,51c1.7,0,3.1,1.4,3.1,3.1c0,1.7-1.4,3.1-3.1,3.1c-1.7,0-3.1-1.4-3.1-3.1 C47.3,52.4,48.7,51,50.4,51z M55.6,37.1l1.5-7.8 M60.1,13.5l1.6-8.7l-7.8,4 M59,19l-1,5.3 M24,16.1l6.4,4.9l6.4-3.3 M48.5,11.6 l-5.9,3.1 M19.1,12.8L9.7,5.1l1.1,7.7 M13.4,29.8l1,7.3l6.6,1.6 M11.6,18.4l1,6.1 M32.8,41.9 M26.6,40.4 M27.3,40.2l6.1,1.6 M49.9,52.1l-5.6-7.6l-4.9-1.2",lineX:"M15.2,30 M19.7,15.6V1.9H29 M34.8,1.9H40.4 M55.3,15.6V1.9H45.9 M19.7,44.4V58.1H29 M34.8,58.1H40.4 M55.3,44.4 V58.1H45.9 M12.5,20.3l-9.4,9.6l9.6,9.8 M3.1,29.9h16.5 M62.5,20.3l9.4,9.6L62.3,39.7 M71.9,29.9H55.4",lineY:"M38.8,7.7 M52.7,12h13.2v9 M65.9,26.6V32 M52.7,46.3h13.2v-9 M24.9,12H11.8v9 M11.8,26.6V32 M24.9,46.3H11.8v-9 M48.2,5.1l-9.3-9l-9.4,9.2 M38.9-3.9V12 M48.2,53.3l-9.3,9l-9.4-9.2 M38.9,62.3V46.4",keep:"M4,10.5V1h10.3 M20.7,1h6.1 M33,1h6.1 M55.4,10.5V1H45.2 M4,17.3v6.6 M55.6,17.3v6.6 M4,30.5V40h10.3 M20.7,40 h6.1 M33,40h6.1 M55.4,30.5V40H45.2 M21,18.9h62.9v48.6H21V18.9z",clear:"M22,14.7l30.9,31 M52.9,14.7L22,45.7 M4.7,16.8V4.2h13.1 M26,4.2h7.8 M41.6,4.2h7.8 M70.3,16.8V4.2H57.2 M4.7,25.9v8.6 M70.3,25.9v8.6 M4.7,43.2v12.6h13.1 M26,55.8h7.8 M41.6,55.8h7.8 M70.3,43.2v12.6H57.2"},title:i(dI.title)};var hI=Mg.prototype;hI.render=hI.updateView=hI.updateLayout=function(e,t,n){var i,r,o;t.eachComponent({mainType:"brush"},function(e){i=e.brushType,r=e.brushOption.brushMode||"single",o|=e.areas.length}),this._brushType=i,this._brushMode=r,d(e.get("type",!0),function(t){e.setIconStatus(t,("keep"===t?"multiple"===r:"clear"===t?o:t===i)?"emphasis":"normal")})},hI.getIcons=function(){var e=this.model,t=e.get("icon",!0),n={};return d(e.get("type",!0),function(e){t[e]&&(n[e]=t[e])}),n},hI.onclick=function(e,t,n){var i=this._brushType,r=this._brushMode;"clear"===n?(t.dispatchAction({type:"axisAreaSelect",intervals:[]}),t.dispatchAction({type:"brush",command:"clear",areas:[]})):t.dispatchAction({type:"takeGlobalCursor",key:"brush",brushOption:{brushType:"keep"===n?i:i!==n&&n,brushMode:"keep"===n?"multiple"===r?"single":"multiple":r}})},wg("brush",Mg),tr(function(e,t){var n=e&&e.brush;if(y(n)||(n=n?[n]:[]),n.length){var i=[];d(n,function(e){var t=e.hasOwnProperty("toolbox")?e.toolbox:[];t instanceof Array&&(i=i.concat(t))});var r=e&&e.toolbox;y(r)&&(r=r[0]),r||(r={feature:{}},e.toolbox=[r]);var o=r.feature||(r.feature={}),a=o.brush||(o.brush={}),s=a.type||(a.type=[]);s.push.apply(s,i),Yp(s),t&&!s.length&&s.push.apply(s,UE)}}),Ig.prototype={constructor:Ig,type:"calendar",dimensions:["time","value"],getDimensionsInfo:function(){return[{name:"time",type:"time"}]},getRangeInfo:function(){return this._rangeInfo},getModel:function(){return this._model},getRect:function(){return this._rect},getCellWidth:function(){return this._sw},getCellHeight:function(){return this._sh},getOrient:function(){return this._orient},getFirstDayOfWeek:function(){return this._firstDayOfWeek},getDateInfo:function(e){var t=(e=Pi(e)).getFullYear(),n=e.getMonth()+1;n=n<10?"0"+n:n;var i=e.getDate();i=i<10?"0"+i:i;var r=e.getDay();return r=Math.abs((r+7-this.getFirstDayOfWeek())%7),{y:t,m:n,d:i,day:r,time:e.getTime(),formatedDate:t+"-"+n+"-"+i,date:e}},getNextNDay:function(e,t){return 0===(t=t||0)?this.getDateInfo(e):((e=new Date(this.getDateInfo(e).time)).setDate(e.getDate()+t),this.getDateInfo(e))},update:function(e,t){function i(e,t){return null!=e[t]&&"auto"!==e[t]}this._firstDayOfWeek=+this._model.getModel("dayLabel").get("firstDay"),this._orient=this._model.get("orient"),this._lineWidth=this._model.getModel("itemStyle.normal").getItemStyle().lineWidth||0,this._rangeInfo=this._getRangeInfo(this._initRangeOption());var n=this._rangeInfo.weeks||1,r=["width","height"],o=this._model.get("cellSize").slice(),a=this._model.getBoxLayoutParams(),s="horizontal"===this._orient?[n,7]:[7,n];d([0,1],function(e){i(o,e)&&(a[r[e]]=o[e]*s[e])});var l={width:t.getWidth(),height:t.getHeight()},c=this._rect=Ko(a,l);d([0,1],function(e){i(o,e)||(o[e]=c[r[e]]/s[e])}),this._sw=o[0],this._sh=o[1]},dataToPoint:function(e,t){y(e)&&(e=e[0]),null==t&&(t=!0);var n=this.getDateInfo(e),i=this._rangeInfo,r=n.formatedDate;if(t&&!(n.time>=i.start.time&&n.time<=i.end.time))return[NaN,NaN];var o=n.day,a=this._getRangeInfo([i.start.time,r]).nthWeek;return"vertical"===this._orient?[this._rect.x+o*this._sw+this._sw/2,this._rect.y+a*this._sh+this._sh/2]:[this._rect.x+a*this._sw+this._sw/2,this._rect.y+o*this._sh+this._sh/2]},pointToData:function(e){var t=this.pointToDate(e);return t&&t.time},dataToRect:function(e,t){var n=this.dataToPoint(e,t);return{contentShape:{x:n[0]-(this._sw-this._lineWidth)/2,y:n[1]-(this._sh-this._lineWidth)/2,width:this._sw-this._lineWidth,height:this._sh-this._lineWidth},center:n,tl:[n[0]-this._sw/2,n[1]-this._sh/2],tr:[n[0]+this._sw/2,n[1]-this._sh/2],br:[n[0]+this._sw/2,n[1]+this._sh/2],bl:[n[0]-this._sw/2,n[1]+this._sh/2]}},pointToDate:function(e){var t=Math.floor((e[0]-this._rect.x)/this._sw)+1,n=Math.floor((e[1]-this._rect.y)/this._sh)+1,i=this._rangeInfo.range;return"vertical"===this._orient?this._getDateByWeeksAndDay(n,t-1,i):this._getDateByWeeksAndDay(t,n-1,i)},convertToPixel:v(Tg,"dataToPoint"),convertFromPixel:v(Tg,"pointToData"),_initRangeOption:function(){var e=this._model.get("range"),t=e;if(y(t)&&1===t.length&&(t=t[0]),/^\d{4}$/.test(t)&&(e=[t+"-01-01",t+"-12-31"]),/^\d{4}[\/|-]\d{1,2}$/.test(t)){var n=this.getDateInfo(t),i=n.date;i.setMonth(i.getMonth()+1);var r=this.getNextNDay(i,-1);e=[n.formatedDate,r.formatedDate]}/^\d{4}[\/|-]\d{1,2}[\/|-]\d{1,2}$/.test(t)&&(e=[t,t]);var o=this._getRangeInfo(e);return o.start.time>o.end.time&&e.reverse(),e},_getRangeInfo:function(e){var t;(e=[this.getDateInfo(e[0]),this.getDateInfo(e[1])])[0].time>e[1].time&&(t=!0,e.reverse());var n=Math.floor(e[1].time/864e5)-Math.floor(e[0].time/864e5)+1,i=new Date(e[0].time),r=i.getDate(),o=e[1].date.getDate();if(i.setDate(r+n-1),i.getDate()!==o)for(var a=i.getTime()-e[1].time>0?1:-1;i.getDate()!==o&&(i.getTime()-e[1].time)*a>0;)n-=a,i.setDate(r+n-1);var s=Math.floor((n+e[0].day+6)/7),l=t?1-s:s-1;return t&&e.reverse(),{range:[e[0].formatedDate,e[1].formatedDate],start:e[0],end:e[1],allDay:n,weeks:s,nthWeek:l,fweek:e[0].day,lweek:e[1].day}},_getDateByWeeksAndDay:function(e,t,n){var i=this._getRangeInfo(n);if(e>i.weeks||0===e&&t<i.fweek||e===i.weeks&&t>i.lweek)return!1;var r=7*(e-1)-i.fweek+t,o=new Date(i.start.time);return o.setDate(i.start.d+r),this.getDateInfo(o)}},Ig.dimensions=Ig.prototype.dimensions,Ig.getDimensionsInfo=Ig.prototype.getDimensionsInfo,Ig.create=function(e,t){var n=[];return e.eachComponent("calendar",function(i){var r=new Ig(i,e,t);n.push(r),i.coordinateSystem=r}),e.eachSeries(function(e){"calendar"===e.get("coordinateSystem")&&(e.coordinateSystem=n[e.get("calendarIndex")||0])}),n},ua.register("calendar",Ig);var pI=jb.extend({type:"calendar",coordinateSystem:null,defaultOption:{zlevel:0,z:2,left:80,top:60,cellSize:20,orient:"horizontal",splitLine:{show:!0,lineStyle:{color:"#000",width:1,type:"solid"}},itemStyle:{normal:{color:"#fff",borderWidth:1,borderColor:"#ccc"}},dayLabel:{show:!0,firstDay:0,position:"start",margin:"50%",nameMap:"en",color:"#000"},monthLabel:{show:!0,position:"start",margin:5,align:"center",nameMap:"en",formatter:null,color:"#000"},yearLabel:{show:!0,position:null,margin:30,formatter:null,color:"#ccc",fontFamily:"sans-serif",fontWeight:"bolder",fontSize:20}},init:function(e,t,n,i){var r=ea(e);pI.superApply(this,"init",arguments),Ag(e,r)},mergeOption:function(e,t){pI.superApply(this,"mergeOption",arguments),Ag(this.option,e)}}),fI={EN:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],CN:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},gI={EN:["S","M","T","W","T","F","S"],CN:["日","一","二","三","四","五","六"]};lr({type:"calendar",_tlpoints:null,_blpoints:null,_firstDayOfMonth:null,_firstDayPoints:null,render:function(e,t,n){var i=this.group;i.removeAll();var r=e.coordinateSystem,o=r.getRangeInfo(),a=r.getOrient();this._renderDayRect(e,o,i),this._renderLines(e,o,a,i),this._renderYearText(e,o,a,i),this._renderMonthText(e,a,i),this._renderWeekText(e,o,a,i)},_renderDayRect:function(e,t,n){for(var i=e.coordinateSystem,r=e.getModel("itemStyle.normal").getItemStyle(),o=i.getCellWidth(),a=i.getCellHeight(),s=t.start.time;s<=t.end.time;s=i.getNextNDay(s,1).time){var l=i.dataToRect([s],!1).tl,c=new fb({shape:{x:l[0],y:l[1],width:o,height:a},cursor:"default",style:r});n.add(c)}},_renderLines:function(e,t,n,i){function o(t){r._firstDayOfMonth.push(a.getDateInfo(t)),r._firstDayPoints.push(a.dataToRect([t],!1).tl);var o=r._getLinePointsOfOneWeek(e,t,n);r._tlpoints.push(o[0]),r._blpoints.push(o[o.length-1]),l&&r._drawSplitline(o,s,i)}var r=this,a=e.coordinateSystem,s=e.getModel("splitLine.lineStyle").getLineStyle(),l=e.get("splitLine.show"),c=s.lineWidth;this._tlpoints=[],this._blpoints=[],this._firstDayOfMonth=[],this._firstDayPoints=[];for(var u=t.start,d=0;u.time<=t.end.time;d++){o(u.formatedDate),0===d&&(u=a.getDateInfo(t.start.y+"-"+t.start.m));var h=u.date;h.setMonth(h.getMonth()+1),u=a.getDateInfo(h)}o(a.getNextNDay(t.end.time,1).formatedDate),l&&this._drawSplitline(r._getEdgesPoints(r._tlpoints,c,n),s,i),l&&this._drawSplitline(r._getEdgesPoints(r._blpoints,c,n),s,i)},_getEdgesPoints:function(e,t,n){var i=[e[0].slice(),e[e.length-1].slice()],r="horizontal"===n?0:1;return i[0][r]=i[0][r]-t/2,i[1][r]=i[1][r]+t/2,i},_drawSplitline:function(e,t,n){var i=new pb({z2:20,shape:{points:e},style:t});n.add(i)},_getLinePointsOfOneWeek:function(e,t,n){var i=e.coordinateSystem;t=i.getDateInfo(t);for(var r=[],o=0;o<7;o++){var a=i.getNextNDay(t.time,o),s=i.dataToRect([a.time],!1);r[2*a.day]=s.tl,r[2*a.day+1]=s["horizontal"===n?"bl":"tr"]}return r},_formatterLabel:function(e,t){return"string"==typeof e&&e?Hi(e,t):"function"==typeof e?e(t):t.nameMap},_yearTextPositionControl:function(e,t,n,i,r){t=t.slice();var o=["center","bottom"];"bottom"===i?(t[1]+=r,o=["center","top"]):"left"===i?t[0]-=r:"right"===i?(t[0]+=r,o=["center","top"]):t[1]-=r;var a=0;return"left"!==i&&"right"!==i||(a=Math.PI/2),{rotation:a,position:t,style:{textAlign:o[0],textVerticalAlign:o[1]}}},_renderYearText:function(e,t,n,i){var r=e.getModel("yearLabel");if(r.get("show")){var o=r.get("margin"),a=r.get("position");a||(a="horizontal"!==n?"top":"left");var s=[this._tlpoints[this._tlpoints.length-1],this._blpoints[0]],l=(s[0][0]+s[1][0])/2,c=(s[0][1]+s[1][1])/2,u="horizontal"===n?0:1,d={top:[l,s[u][1]],bottom:[l,s[1-u][1]],left:[s[1-u][0],c],right:[s[u][0],c]},h=t.start.y;+t.end.y>+t.start.y&&(h=h+"-"+t.end.y);var p=r.get("formatter"),f={start:t.start.y,end:t.end.y,nameMap:h},g=this._formatterLabel(p,f),m=new rb({z2:30});fo(m.style,r,{text:g}),m.attr(this._yearTextPositionControl(m,d[a],n,a,o)),i.add(m)}},_monthTextPositionControl:function(e,t,n,i,r){var o="left",a="top",s=e[0],l=e[1];return"horizontal"===n?(l+=r,t&&(o="center"),"start"===i&&(a="bottom")):(s+=r,t&&(a="middle"),"start"===i&&(o="right")),{x:s,y:l,textAlign:o,textVerticalAlign:a}},_renderMonthText:function(e,t,n){var i=e.getModel("monthLabel");if(i.get("show")){var r=i.get("nameMap"),o=i.get("margin"),s=i.get("position"),l=i.get("align"),c=[this._tlpoints,this._blpoints];_(r)&&(r=fI[r.toUpperCase()]||[]);var u="start"===s?0:1,d="horizontal"===t?0:1;o="start"===s?-o:o;for(var h="center"===l,p=0;p<c[u].length-1;p++){var f=c[u][p].slice(),g=this._firstDayOfMonth[p];if(h){var m=this._firstDayPoints[p];f[d]=(m[d]+c[0][p+1][d])/2}var v=i.get("formatter"),y=r[+g.m-1],x={yyyy:g.y,yy:(g.y+"").slice(2),MM:g.m,M:+g.m,nameMap:y},b=this._formatterLabel(v,x),w=new rb({z2:30});a(fo(w.style,i,{text:b}),this._monthTextPositionControl(f,h,t,s,o)),n.add(w)}}},_weekTextPositionControl:function(e,t,n,i,r){var o="center",a="middle",s=e[0],l=e[1],c="start"===n;return"horizontal"===t?(s=s+i+(c?1:-1)*r[0]/2,o=c?"right":"left"):(l=l+i+(c?1:-1)*r[1]/2,a=c?"bottom":"top"),{x:s,y:l,textAlign:o,textVerticalAlign:a}},_renderWeekText:function(e,t,n,i){var r=e.getModel("dayLabel");if(r.get("show")){var o=e.coordinateSystem,s=r.get("position"),l=r.get("nameMap"),c=r.get("margin"),u=o.getFirstDayOfWeek();_(l)&&(l=gI[l.toUpperCase()]||[]);var d=o.getNextNDay(t.end.time,7-t.lweek).time,h=[o.getCellWidth(),o.getCellHeight()];c=Si(c,h["horizontal"===n?0:1]),"start"===s&&(d=o.getNextNDay(t.start.time,-(7+t.fweek)).time,c=-c);for(var p=0;p<7;p++){var f=o.getNextNDay(d,p),g=o.dataToRect([f.time],!1).center,m=p;m=Math.abs((p+u)%7);var v=new rb({z2:30});a(fo(v.style,r,{text:l[m]}),this._weekTextPositionControl(g,n,s,c,h)),i.add(v)}}}}),sr({type:"title",layoutMode:{type:"box",ignoreSize:!0},defaultOption:{zlevel:0,z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bolder",color:"#333"},subtextStyle:{color:"#aaa"}}}),lr({type:"title",render:function(e,t,n){if(this.group.removeAll(),e.get("show")){var i=this.group,r=e.getModel("textStyle"),o=e.getModel("subtextStyle"),a=e.get("textAlign"),s=e.get("textBaseline"),l=new rb({style:fo({},r,{text:e.get("text"),textFill:r.getTextColor()},{disableBox:!0}),z2:10}),c=l.getBoundingRect(),u=e.get("subtext"),d=new rb({style:fo({},o,{text:u,textFill:o.getTextColor(),y:c.height+e.get("itemGap"),textVerticalAlign:"top"},{disableBox:!0}),z2:10}),h=e.get("link"),p=e.get("sublink");l.silent=!h,d.silent=!p,h&&l.on("click",function(){window.open(h,"_"+e.get("target"))}),p&&d.on("click",function(){window.open(p,"_"+e.get("subtarget"))}),i.add(l),u&&i.add(d);var f=i.getBoundingRect(),g=e.getBoxLayoutParams();g.width=f.width,g.height=f.height;var m=Ko(g,{width:n.getWidth(),height:n.getHeight()},e.get("padding"));a||("middle"===(a=e.get("left")||e.get("right"))&&(a="center"),"right"===a?m.x+=m.width:"center"===a&&(m.x+=m.width/2)),s||("center"===(s=e.get("top")||e.get("bottom"))&&(s="middle"),"bottom"===s?m.y+=m.height:"middle"===s&&(m.y+=m.height/2),s=s||"top"),i.attr("position",[m.x,m.y]);var v={textAlign:a,textVerticalAlign:s};l.setStyle(v),d.setStyle(v),f=i.getBoundingRect();var _=m.margin,y=e.getItemStyle(["color","opacity"]);y.fill=e.get("backgroundColor");var x=new fb({shape:{x:f.x-_[3],y:f.y-_[0],width:f.width+_[1]+_[3],height:f.height+_[0]+_[2],r:e.get("borderRadius")},style:y,silent:!0});$n(x),i.add(x)}}}),jb.registerSubTypeDefaulter("dataZoom",function(){return"slider"});var mI=["cartesian2d","polar","singleAxis"],vI=function(e,t){var n=f(e=e.slice(),Ui),i=f(t=(t||[]).slice(),Ui);return function(r,o){d(e,function(e,a){for(var s={name:e,capital:n[a]},l=0;l<t.length;l++)s[t[l]]=e+i[l];r.call(o,s)})}}(["x","y","z","radius","angle","single"],["axisIndex","axis","index","id"]),_I=d,yI=Ii,xI=function(e,t,n,i){this._dimName=e,this._axisIndex=t,this._valueWindow,this._percentWindow,this._dataExtent,this._minMaxSpan,this.ecModel=i,this._dataZoomModel=n};xI.prototype={constructor:xI,hostedBy:function(e){return this._dataZoomModel===e},getDataValueWindow:function(){return this._valueWindow.slice()},getDataPercentWindow:function(){return this._percentWindow.slice()},getTargetSeriesModels:function(){var e=[],t=this.ecModel;return t.eachSeries(function(n){if(Cg(n.get("coordinateSystem"))){var i=this._dimName,r=t.queryComponents({mainType:i+"Axis",index:n.get(i+"AxisIndex"),id:n.get(i+"AxisId")})[0];this._axisIndex===(r&&r.componentIndex)&&e.push(n)}},this),e},getAxisModel:function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},getOtherAxisModel:function(){var e,t,n=this._dimName,i=this.ecModel,r=this.getAxisModel();"x"===n||"y"===n?(t="gridIndex",e="x"===n?"y":"x"):(t="polarIndex",e="angle"===n?"radius":"angle");var o;return i.eachComponent(e+"Axis",function(e){(e.get(t)||0)===(r.get(t)||0)&&(o=e)}),o},getMinMaxSpan:function(){return i(this._minMaxSpan)},calculateDataWindow:function(e){var t=this._dataExtent,n=this.getAxisModel().axis.scale,i=this._dataZoomModel.getRangePropMode(),r=[0,100],o=[e.start,e.end],a=[];return _I(["startValue","endValue"],function(t){a.push(null!=e[t]?n.parse(e[t]):null)}),_I([0,1],function(e){var s=a[e],l=o[e];"percent"===i[e]?(null==l&&(l=r[e]),s=n.parse(wi(l,r,t,!0))):l=wi(s,t,r,!0),a[e]=s,o[e]=l}),{valueWindow:yI(a),percentWindow:yI(o)}},reset:function(e){if(e===this._dataZoomModel){this._dataExtent=Lg(this,this._dimName,this.getTargetSeriesModels());var t=this.calculateDataWindow(e.option);this._valueWindow=t.valueWindow,this._percentWindow=t.percentWindow,Og(this),Pg(this)}},restore:function(e){e===this._dataZoomModel&&(this._valueWindow=this._percentWindow=null,Pg(this,!0))},filterData:function(t){function e(e){return e>=o[0]&&e<=o[1]}if(t===this._dataZoomModel){var n=this._dimName,i=this.getTargetSeriesModels(),r=t.get("filterMode"),o=this._valueWindow;if("none"!==r){var a=this.getOtherAxisModel();t.get("$fromToolbox")&&a&&"category"===a.get("type")&&(r="empty"),_I(i,function(t){var i=t.getData(),a=t.coordDimToDataDim(n);"weakFilter"===r?i&&i.filterSelf(function(e){for(var t,n,r,s=0;s<a.length;s++){var l=i.get(a[s],e),c=!isNaN(l),u=l<o[0],d=l>o[1];if(c&&!u&&!d)return!0;c&&(r=!0),u&&(t=!0),d&&(n=!0)}return r&&t&&n}):i&&_I(a,function(n){"empty"===r?t.setData(i.map(n,function(t){return e(t)?t:NaN})):i.filterSelf(n,e)})})}}}};var bI=d,wI=vI,CI=sr({type:"dataZoom",dependencies:["xAxis","yAxis","zAxis","radiusAxis","angleAxis","singleAxis","series"],defaultOption:{zlevel:0,z:4,orient:null,xAxisIndex:null,yAxisIndex:null,filterMode:"filter",throttle:null,start:0,end:100,startValue:null,endValue:null,minSpan:null,maxSpan:null,minValueSpan:null,maxValueSpan:null,rangeMode:null},init:function(e,t,n){this._dataIntervalByAxis={},this._dataInfo={},this._axisProxies={},this.textStyleModel,this._autoThrottle=!0,this._rangePropMode=["percent","percent"];var i=zg(e);this.mergeDefaultAndTheme(e,n),this.doInit(i)},mergeOption:function(e){var t=zg(e);n(this.option,e,!0),this.doInit(t)},doInit:function(e){var t=this.option;jv.canvasSupported||(t.realtime=!1),this._setDefaultThrottle(e),Ng(this,e),bI([["start","startValue"],["end","endValue"]],function(e,n){"value"===this._rangePropMode[n]&&(t[e[0]]=null)},this),this.textStyleModel=this.getModel("textStyle"),this._resetTarget(),this._giveAxisProxies()},_giveAxisProxies:function(){var e=this._axisProxies;this.eachTargetAxis(function(t,n,i,r){var o=this.dependentModels[t.axis][n],a=o.__dzAxisProxy||(o.__dzAxisProxy=new xI(t.name,n,this,r));e[t.name+"_"+n]=a},this)},_resetTarget:function(){var e=this.option,t=this._judgeAutoMode();wI(function(t){var n=t.axisIndex;e[n]=Oo(e[n])},this),"axisIndex"===t?this._autoSetAxisIndex():"orient"===t&&this._autoSetOrient()},_judgeAutoMode:function(){var e=this.option,t=!1;wI(function(n){null!=e[n.axisIndex]&&(t=!0)},this);var n=e.orient;return null==n&&t?"orient":t?void 0:(null==n&&(e.orient="horizontal"),"axisIndex")},_autoSetAxisIndex:function(){var e=!0,t=this.get("orient",!0),n=this.option,i=this.dependentModels;if(e){var r="vertical"===t?"y":"x";i[r+"Axis"].length?(n[r+"AxisIndex"]=[0],e=!1):bI(i.singleAxis,function(i){e&&i.get("orient",!0)===t&&(n.singleAxisIndex=[i.componentIndex],e=!1)})}e&&wI(function(t){if(e){var i=[],r=this.dependentModels[t.axis];if(r.length&&!i.length)for(var o=0,a=r.length;o<a;o++)"category"===r[o].get("type")&&i.push(o);n[t.axisIndex]=i,i.length&&(e=!1)}},this),e&&this.ecModel.eachSeries(function(e){this._isSeriesHasAllAxesTypeOf(e,"value")&&wI(function(t){var i=n[t.axisIndex],r=e.get(t.axisIndex),o=e.get(t.axisId);l(i,r=e.ecModel.queryComponents({mainType:t.axis,index:r,id:o})[0].componentIndex)<0&&i.push(r)})},this)},_autoSetOrient:function(){var e;this.eachTargetAxis(function(t){!e&&(e=t.name)},this),this.option.orient="y"===e?"vertical":"horizontal"},_isSeriesHasAllAxesTypeOf:function(e,t){var n=!0;return wI(function(i){var r=e.get(i.axisIndex),o=this.dependentModels[i.axis][r];o&&o.get("type")===t||(n=!1)},this),n},_setDefaultThrottle:function(e){if(e.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var t=this.ecModel.option;this.option.throttle=t.animation&&t.animationDurationUpdate>0?100:20}},getFirstTargetAxisModel:function(){var e;return wI(function(t){if(null==e){var n=this.get(t.axisIndex);n.length&&(e=this.dependentModels[t.axis][n[0]])}},this),e},eachTargetAxis:function(e,t){var n=this.ecModel;wI(function(i){bI(this.get(i.axisIndex),function(r){e.call(t,i,r,this,n)},this)},this)},getAxisProxy:function(e,t){return this._axisProxies[e+"_"+t]},getAxisModel:function(e,t){var n=this.getAxisProxy(e,t);return n&&n.getAxisModel()},setRawRange:function(e,t){var n=this.option;bI([["start","startValue"],["end","endValue"]],function(t){null==e[t[0]]&&null==e[t[1]]||(n[t[0]]=e[t[0]],n[t[1]]=e[t[1]])},this),!t&&Ng(this,e)},getPercentRange:function(){var e=this.findRepresentativeAxisProxy();if(e)return e.getDataPercentWindow()},getValueRange:function(e,t){if(null!=e||null!=t)return this.getAxisProxy(e,t).getDataValueWindow();var n=this.findRepresentativeAxisProxy();return n?n.getDataValueWindow():void 0},findRepresentativeAxisProxy:function(e){if(e)return e.__dzAxisProxy;var t=this._axisProxies;for(var n in t)if(t.hasOwnProperty(n)&&t[n].hostedBy(this))return t[n];for(var n in t)if(t.hasOwnProperty(n)&&!t[n].hostedBy(this))return t[n]},getRangePropMode:function(){return this._rangePropMode.slice()}}),SI=bw.extend({type:"dataZoom",render:function(e,t,n,i){this.dataZoomModel=e,this.ecModel=t,this.api=n},getTargetCoordInfo:function(){function t(e,t,n,i){for(var r,o=0;o<n.length;o++)if(n[o].model===e){r=n[o];break}r||n.push(r={model:e,axisModels:[],coordIndex:i}),r.axisModels.push(t)}var e=this.dataZoomModel,n=this.ecModel,i={};return e.eachTargetAxis(function(e,r){var o=n.getComponent(e.axis,r);if(o){var a=o.getCoordSysModel();a&&t(a,o,i[a.mainType]||(i[a.mainType]=[]),a.componentIndex)}},this),i}}),TI=(CI.extend({type:"dataZoom.slider",layoutMode:"box",defaultOption:{show:!0,right:"ph",top:"ph",width:"ph",height:"ph",left:null,bottom:null,backgroundColor:"rgba(47,69,84,0)",dataBackground:{lineStyle:{color:"#2f4554",width:.5,opacity:.3},areaStyle:{color:"rgba(47,69,84,0.3)",opacity:.3}},borderColor:"#ddd",fillerColor:"rgba(167,183,204,0.4)",handleIcon:"M8.2,13.6V3.9H6.3v9.7H3.1v14.9h3.3v9.7h1.8v-9.7h3.3V13.6H8.2z M9.7,24.4H4.8v-1.4h4.9V24.4z M9.7,19.1H4.8v-1.4h4.9V19.1z",handleSize:"100%",handleStyle:{color:"#a7b7cc"},labelPrecision:null,labelFormatter:null,showDetail:!0,showDataShadow:"auto",realtime:!0,zoomLock:!1,textStyle:{color:"#333"}}}),fb),AI=wi,MI=Ii,EI=m,II=d,DI="horizontal",kI=5,LI=["line","bar","candlestick","scatter"],NI=SI.extend({type:"dataZoom.slider",init:function(e,t){this._displayables={},this._orient,this._range,this._handleEnds,this._size,this._handleWidth,this._handleHeight,this._location,this._dragging,this._dataShadowInfo,this.api=t},render:function(e,t,n,i){NI.superApply(this,"render",arguments),La(this,"_dispatchZoomAction",this.dataZoomModel.get("throttle"),"fixRate"),this._orient=e.get("orient"),!1!==this.dataZoomModel.get("show")?(i&&"dataZoom"===i.type&&i.from===this.uid||this._buildView(),this._updateView()):this.group.removeAll()},remove:function(){NI.superApply(this,"remove",arguments),ka(this,"_dispatchZoomAction")},dispose:function(){NI.superApply(this,"dispose",arguments),ka(this,"_dispatchZoomAction")},_buildView:function(){var e=this.group;e.removeAll(),this._resetLocation(),this._resetInterval();var t=this._displayables.barGroup=new X_;this._renderBackground(),this._renderHandle(),this._renderDataShadow(),e.add(t),this._positionGroup()},_resetLocation:function(){var e=this.dataZoomModel,t=this.api,n=this._findCoordRect(),i={width:t.getWidth(),height:t.getHeight()},r=this._orient===DI?{right:i.width-n.x-n.width,top:i.height-30-7,width:n.width,height:30}:{right:7,top:n.y,width:30,height:n.height},o=ea(e.option);d(["right","top","width","height"],function(e){"ph"===o[e]&&(o[e]=r[e])});var a=Ko(o,i,e.padding);this._location={x:a.x,y:a.y},this._size=[a.width,a.height],"vertical"===this._orient&&this._size.reverse()},_positionGroup:function(){var e=this.group,t=this._location,n=this._orient,i=this.dataZoomModel.getFirstTargetAxisModel(),r=i&&i.get("inverse"),o=this._displayables.barGroup,a=(this._dataShadowInfo||{}).otherAxisInverse;o.attr(n!==DI||r?n===DI&&r?{scale:a?[-1,1]:[-1,-1]}:"vertical"!==n||r?{scale:a?[-1,-1]:[-1,1],rotation:Math.PI/2}:{scale:a?[1,-1]:[1,1],rotation:Math.PI/2}:{scale:a?[1,1]:[1,-1]});var s=e.getBoundingRect([o]);e.attr("position",[t.x-s.x,t.y-s.y])},_getViewExtent:function(){return[0,this._size[0]]},_renderBackground:function(){var e=this.dataZoomModel,t=this._size,n=this._displayables.barGroup;n.add(new TI({silent:!0,shape:{x:0,y:0,width:t[0],height:t[1]},style:{fill:e.get("backgroundColor")},z2:-40})),n.add(new TI({shape:{x:0,y:0,width:t[0],height:t[1]},style:{fill:"transparent"},z2:0,onclick:m(this._onClickPanelClick,this)}))},_renderDataShadow:function(){var e=this._dataShadowInfo=this._prepareDataShadowInfo();if(e){var t=this._size,n=e.series,i=n.getRawData(),o=n.getShadowDim?n.getShadowDim():e.otherDim;if(null!=o){var a=i.getDataExtent(o),s=.3*(a[1]-a[0]);a=[a[0]-s,a[1]+s];var l,c=[0,t[1]],u=[0,t[0]],d=[[t[0],0],[0,0]],h=[],p=u[1]/(i.count()-1),f=0,g=Math.round(i.count()/t[0]);i.each([o],function(e,t){if(g>0&&t%g)f+=p;else{var n=null==e||isNaN(e)||""===e,i=n?0:AI(e,a,c,!0);n&&!l&&t?(d.push([d[d.length-1][0],0]),h.push([h[h.length-1][0],0])):!n&&l&&(d.push([f,0]),h.push([f,0])),d.push([f,i]),h.push([f,i]),f+=p,l=n}});var m=this.dataZoomModel;this._displayables.barGroup.add(new hb({shape:{points:d},style:r({fill:m.get("dataBackgroundColor")},m.getModel("dataBackground.areaStyle").getAreaStyle()),silent:!0,z2:-20})),this._displayables.barGroup.add(new pb({shape:{points:h},style:m.getModel("dataBackground.lineStyle").getLineStyle(),silent:!0,z2:-19}))}}},_prepareDataShadowInfo:function(){var e=this.dataZoomModel,t=e.get("showDataShadow");if(!1!==t){var n,i=this.ecModel;return e.eachTargetAxis(function(r,o){d(e.getAxisProxy(r.name,o).getTargetSeriesModels(),function(e){if(!(n||!0!==t&&l(LI,e.get("type"))<0)){var a,s=i.getComponent(r.axis,o).axis,c=Eg(r.name),u=e.coordinateSystem;null!=c&&u.getOtherAxis&&(a=u.getOtherAxis(s).inverse),n={thisAxis:s,series:e,thisDim:r.name,otherDim:c,otherAxisInverse:a}}},this)},this),n}},_renderHandle:function(){var e=this._displayables,t=e.handles=[],n=e.handleLabels=[],i=this._displayables.barGroup,r=this._size,o=this.dataZoomModel;i.add(e.filler=new TI({draggable:!0,cursor:Rg(this._orient),drift:EI(this._onDragMove,this,"all"),onmousemove:function(e){Cy(e.event)},ondragstart:EI(this._showDataInfo,this,!0),ondragend:EI(this._onDragEnd,this),onmouseover:EI(this._showDataInfo,this,!0),onmouseout:EI(this._showDataInfo,this,!1),style:{fill:o.get("fillerColor"),textPosition:"inside"}})),i.add(new TI($n({silent:!0,shape:{x:0,y:0,width:r[0],height:r[1]},style:{stroke:o.get("dataBackgroundColor")||o.get("borderColor"),lineWidth:1,fill:"rgba(0,0,0,0)"}}))),II([0,1],function(e){var r=Do(o.get("handleIcon"),{cursor:Rg(this._orient),draggable:!0,drift:EI(this._onDragMove,this,e),onmousemove:function(e){Cy(e.event)},ondragend:EI(this._onDragEnd,this),onmouseover:EI(this._showDataInfo,this,!0),onmouseout:EI(this._showDataInfo,this,!1)},{x:-1,y:0,width:2,height:2}),a=r.getBoundingRect();this._handleHeight=Si(o.get("handleSize"),this._size[1]),this._handleWidth=a.width/a.height*this._handleHeight,r.setStyle(o.getModel("handleStyle").getItemStyle());var s=o.get("handleColor");null!=s&&(r.style.fill=s),i.add(t[e]=r);var l=o.textStyleModel;this.group.add(n[e]=new rb({silent:!0,invisible:!0,style:{x:0,y:0,text:"",textVerticalAlign:"middle",textAlign:"center",textFill:l.getTextColor(),textFont:l.getFont()},z2:10}))},this)},_resetInterval:function(){var e=this._range=this.dataZoomModel.getPercentRange(),t=this._getViewExtent();this._handleEnds=[AI(e[0],[0,100],t,!0),AI(e[1],[0,100],t,!0)]},_updateInterval:function(e,t){var n=this.dataZoomModel,i=this._handleEnds,r=this._getViewExtent(),o=n.findRepresentativeAxisProxy().getMinMaxSpan(),a=[0,100];OA(t,i,r,n.get("zoomLock")?"all":e,null!=o.minSpan?AI(o.minSpan,a,r,!0):null,null!=o.maxSpan?AI(o.maxSpan,a,r,!0):null),this._range=MI([AI(i[0],r,a,!0),AI(i[1],r,a,!0)])},_updateView:function(e){var t=this._displayables,n=this._handleEnds,i=MI(n.slice()),r=this._size;II([0,1],function(e){var i=t.handles[e],o=this._handleHeight;i.attr({scale:[o/2,o/2],position:[n[e],r[1]/2-o/2]})},this),t.filler.setShape({x:i[0],y:0,width:i[1]-i[0],height:r[1]}),this._updateDataInfo(e)},_updateDataInfo:function(t){function e(e){var t=Mo(i.handles[e].parent,this.group),n=To(0===e?"right":"left",t),s=this._handleWidth/2+kI,l=Io([d[e]+(0===e?-s:s),this._size[1]/2],t);r[e].setStyle({x:l[0],y:l[1],textVerticalAlign:o===DI?"middle":n,textAlign:o===DI?n:"center",text:a[e]})}var n=this.dataZoomModel,i=this._displayables,r=i.handleLabels,o=this._orient,a=["",""];if(n.get("showDetail")){var s=n.findRepresentativeAxisProxy();if(s){var l=s.getAxisModel().axis,c=this._range,u=t?s.calculateDataWindow({start:c[0],end:c[1]}).valueWindow:s.getDataValueWindow();a=[this._formatLabel(u[0],l),this._formatLabel(u[1],l)]}}var d=MI(this._handleEnds.slice());e.call(this,0),e.call(this,1)},_formatLabel:function(e,t){var n=this.dataZoomModel,i=n.get("labelFormatter"),r=n.get("labelPrecision");null!=r&&"auto"!==r||(r=t.getPixelPrecision());var o=null==e||isNaN(e)?"":"category"===t.type||"time"===t.type?t.scale.getLabel(Math.round(e)):e.toFixed(Math.min(r,20));return x(i)?i(e,o):_(i)?i.replace("{value}",o):o},_showDataInfo:function(e){e=this._dragging||e;var t=this._displayables.handleLabels;t[0].attr("invisible",!e),t[1].attr("invisible",!e)},_onDragMove:function(e,t,n){this._dragging=!0;var i=Io([t,n],this._displayables.barGroup.getLocalTransform(),!0);this._updateInterval(e,i[0]);var r=this.dataZoomModel.get("realtime");this._updateView(!r),r&&r&&this._dispatchZoomAction()},_onDragEnd:function(){this._dragging=!1,this._showDataInfo(!1),this._dispatchZoomAction()},_onClickPanelClick:function(e){var t=this._size,n=this._displayables.barGroup.transformCoordToLocal(e.offsetX,e.offsetY);if(!(n[0]<0||n[0]>t[0]||n[1]<0||n[1]>t[1])){var i=this._handleEnds,r=(i[0]+i[1])/2;this._updateInterval("all",n[0]-r),this._updateView(),this._dispatchZoomAction()}},_dispatchZoomAction:function(){var e=this._range;this.api.dispatchAction({type:"dataZoom",from:this.uid,dataZoomId:this.dataZoomModel.id,start:e[0],end:e[1]})},_findCoordRect:function(){var e;if(II(this.getTargetCoordInfo(),function(t){if(!e&&t.length){var n=t[0].model.coordinateSystem;e=n.getRect&&n.getRect()}}),!e){var t=this.api.getWidth(),n=this.api.getHeight();e={x:.2*t,y:.2*n,width:.6*t,height:.6*n}}return e}});CI.extend({type:"dataZoom.inside",defaultOption:{disabled:!1,zoomLock:!1,zoomOnMouseWheel:!0,moveOnMouseMove:!0,preventDefaultMouseMove:!0}});var PI=v,OI="\0_ec_dataZoom_roams",RI=m,zI=SI.extend({type:"dataZoom.inside",init:function(e,t){this._range},render:function(e,t,n,i){zI.superApply(this,"render",arguments),Gg(i,e.id)&&(this._range=e.getPercentRange()),d(this.getTargetCoordInfo(),function(t,i){var r=f(t,function(e){return Wg(e.model)});d(t,function(t){var o=t.model,a=e.option;Vg(n,{coordId:Wg(o),allCoordIds:r,containsPoint:function(e,t,n){return o.coordinateSystem.containPoint([t,n])},dataZoomId:e.id,throttleRate:e.get("throttle",!0),panGetRange:RI(this._onPan,this,t,i),zoomGetRange:RI(this._onZoom,this,t,i),zoomLock:a.zoomLock,disabled:a.disabled,roamControllerOpt:{zoomOnMouseWheel:a.zoomOnMouseWheel,moveOnMouseMove:a.moveOnMouseMove,preventDefaultMouseMove:a.preventDefaultMouseMove}})},this)},this)},dispose:function(){Bg(this.api,this.dataZoomModel.id),zI.superApply(this,"dispose",arguments),this._range=null},_onPan:function(e,t,n,i,r,o,a,s,l){var c=this._range.slice(),u=e.axisModels[0];if(u){var d=FI[t]([o,a],[s,l],u,n,e),h=d.signal*(c[1]-c[0])*d.pixel/d.pixelLength;return OA(h,c,[0,100],"all"),this._range=c}},_onZoom:function(e,t,n,i,r,o){var a=this._range.slice(),s=e.axisModels[0];if(s){var l=FI[t](null,[r,o],s,n,e),c=(l.signal>0?l.pixelStart+l.pixelLength-l.pixel:l.pixel-l.pixelStart)/l.pixelLength*(a[1]-a[0])+a[0];i=Math.max(1/i,0),a[0]=(a[0]-c)*i+c,a[1]=(a[1]-c)*i+c;var u=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();return OA(0,a,[0,100],0,u.minSpan,u.maxSpan),this._range=a}}}),FI={grid:function(e,t,n,i,r){var o=n.axis,a={},s=r.model.coordinateSystem.getRect();return e=e||[0,0],"x"===o.dim?(a.pixel=t[0]-e[0],a.pixelLength=s.width,a.pixelStart=s.x,a.signal=o.inverse?1:-1):(a.pixel=t[1]-e[1],a.pixelLength=s.height,a.pixelStart=s.y,a.signal=o.inverse?-1:1),a},polar:function(e,t,n,i,r){var o=n.axis,a={},s=r.model.coordinateSystem,l=s.getRadiusAxis().getExtent(),c=s.getAngleAxis().getExtent();return e=e?s.pointToCoord(e):[0,0],t=s.pointToCoord(t),"radiusAxis"===n.mainType?(a.pixel=t[0]-e[0],a.pixelLength=l[1]-l[0],a.pixelStart=l[0],a.signal=o.inverse?1:-1):(a.pixel=t[1]-e[1],a.pixelLength=c[1]-c[0],a.pixelStart=c[0],a.signal=o.inverse?-1:1),a},singleAxis:function(e,t,n,i,r){var o=n.axis,a=r.model.coordinateSystem.getRect(),s={};return e=e||[0,0],"horizontal"===o.orient?(s.pixel=t[0]-e[0],s.pixelLength=a.width,s.pixelStart=a.x,s.signal=o.inverse?1:-1):(s.pixel=t[1]-e[1],s.pixelLength=a.height,s.pixelStart=a.y,s.signal=o.inverse?-1:1),s}};er(function(e,t){e.eachComponent("dataZoom",function(e){e.eachTargetAxis($g),e.eachTargetAxis(Kg)}),e.eachComponent("dataZoom",function(e){var t=e.findRepresentativeAxisProxy(),n=t.getDataPercentWindow(),i=t.getDataValueWindow();e.setRawRange({start:n[0],end:n[1],startValue:i[0],endValue:i[1]},!0)})}),ir("dataZoom",function(e,t){var n=Dg(m(t.eachComponent,t,"dataZoom"),vI,function(e,t){return e.get(t.axisIndex)}),i=[];t.eachComponent({mainType:"dataZoom",query:e},function(e,t){i.push.apply(i,n(e).nodes)}),d(i,function(t,n){t.setRawRange({start:e.start,end:e.end,startValue:e.startValue,endValue:e.endValue})})});var BI=d,HI=function(e){var t=e&&e.visualMap;y(t)||(t=t?[t]:[]),BI(t,function(e){if(e){Jg(e,"splitList")&&!Jg(e,"pieces")&&(e.pieces=e.splitList,delete e.splitList);var t=e.pieces;t&&y(t)&&BI(t,function(e){b(e)&&(Jg(e,"start")&&!Jg(e,"min")&&(e.min=e.start),Jg(e,"end")&&!Jg(e,"max")&&(e.max=e.end))})}})};jb.registerSubTypeDefaulter("visualMap",function(e){return e.categories||(e.pieces?e.pieces.length>0:e.splitNumber>0)&&!e.calculable?"piecewise":"continuous"}),ar(Pw.VISUAL.COMPONENT,function(e){e.eachComponent("visualMap",function(e){Qg(e)}),tm(e)});var VI={get:function(e,t,n){var r=i((WI[e]||{})[t]);return n&&y(r)?r[r.length-1]:r}},WI={color:{active:["#006edd","#e0ffff"],inactive:["rgba(0,0,0,0)"]},colorHue:{active:[0,360],inactive:[0,0]},colorSaturation:{active:[.3,1],inactive:[0,0]},colorLightness:{active:[.9,.5],inactive:[0,0]},colorAlpha:{active:[.3,1],inactive:[0,0]},opacity:{active:[.3,1],inactive:[0,0]},symbol:{active:["circle","roundRect","diamond"],inactive:["none"]},symbolSize:{active:[10,50],inactive:[0,0]}},UI=XT.mapVisual,$I=XT.eachVisual,GI=y,qI=d,jI=Ii,YI=wi,XI=N,ZI=["#f6efa6","#d88273","#bf444c"],KI=sr({type:"visualMap",dependencies:["series"],stateList:["inRange","outOfRange"],replacableOptionKeys:["inRange","outOfRange","target","controller","color"],dataBound:[-1/0,1/0],layoutMode:{type:"box",ignoreSize:!0},defaultOption:{show:!0,zlevel:0,z:4,seriesIndex:"all",min:0,max:200,dimension:null,inRange:null,outOfRange:null,left:0,right:null,top:null,bottom:0,itemWidth:null,itemHeight:null,inverse:!1,orient:"vertical",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",contentColor:"#5793f3",inactiveColor:"#aaa",borderWidth:0,padding:5,textGap:10,precision:0,color:null,formatter:null,text:null,textStyle:{color:"#333"}},init:function(e,t,n){this._dataExtent,this.targetVisuals={},this.controllerVisuals={},this.textStyleModel,this.itemSize,this.mergeDefaultAndTheme(e,n)},optionUpdated:function(e,t){var n=this.option;jv.canvasSupported||(n.realtime=!1),!t&&Jp(n,e,this.replacableOptionKeys),this.textStyleModel=this.getModel("textStyle"),this.resetItemSize(),this.completeVisualOption()},resetVisual:function(e){var t=this.stateList;e=m(e,this),this.controllerVisuals=Kp(this.option.controller,t,e),this.targetVisuals=Kp(this.option.target,t,e)},getTargetSeriesIndices:function(){var e=this.option.seriesIndex,t=[];return null==e||"all"===e?this.ecModel.eachSeries(function(e,n){t.push(n)}):t=Oo(e),t},eachTargetSeries:function(e,t){d(this.getTargetSeriesIndices(),function(n){e.call(t,this.ecModel.getSeriesByIndex(n))},this)},isTargetSeries:function(e){var t=!1;return this.eachTargetSeries(function(n){n===e&&(t=!0)}),t},formatValueText:function(e,t,i){function n(e){return e===l[0]?"min":e===l[1]?"max":(+e).toFixed(Math.min(s,20))}var r,o,a=this.option,s=a.precision,l=this.dataBound,c=a.formatter;return i=i||["<",">"],y(e)&&(e=e.slice(),r=!0),o=t?e:r?[n(e[0]),n(e[1])]:n(e),_(c)?c.replace("{value}",r?o[0]:o).replace("{value2}",r?o[1]:o):x(c)?r?c(e[0],e[1]):c(e):r?e[0]===l[0]?i[0]+" "+o[1]:e[1]===l[1]?i[1]+" "+o[0]:o[0]+" - "+o[1]:o},resetExtent:function(){var e=this.option,t=jI([e.min,e.max]);this._dataExtent=t},getDataDimension:function(e){var t=this.option.dimension;return null!=t?t:e.dimensions.length-1},getExtent:function(){return this._dataExtent.slice()},completeVisualOption:function(){function t(t){GI(e.color)&&!t.inRange&&(t.inRange={color:e.color.slice().reverse()}),t.inRange=t.inRange||{color:ZI},qI(this.stateList,function(e){var n=t[e];if(_(n)){var i=VI.get(n,"active",s);i?(t[e]={},t[e][n]=i):delete t[e]}},this)}var e=this.option,r={inRange:e.inRange,outOfRange:e.outOfRange},o=e.target||(e.target={}),a=e.controller||(e.controller={});n(o,r),n(a,r);var s=this.isCategory();t.call(this,o),t.call(this,a),function(e,t,n){var i=e[t],r=e[n];i&&!r&&(r=e[n]={},qI(i,function(e,t){if(XT.isValidType(t)){var n=VI.get(t,"inactive",s);null!=n&&(r[t]=n,"color"!==t||r.hasOwnProperty("opacity")||r.hasOwnProperty("colorAlpha")||(r.opacity=[0,0]))}}))}.call(this,o,"inRange","outOfRange"),function(e){var t=(e.inRange||{}).symbol||(e.outOfRange||{}).symbol,n=(e.inRange||{}).symbolSize||(e.outOfRange||{}).symbolSize,r=this.get("inactiveColor");qI(this.stateList,function(o){var a=this.itemSize,l=e[o];l||(l=e[o]={color:s?r:[r]}),null==l.symbol&&(l.symbol=t&&i(t)||(s?"roundRect":["roundRect"])),null==l.symbolSize&&(l.symbolSize=n&&i(n)||(s?a[0]:[a[0],a[0]])),l.symbol=UI(l.symbol,function(e){return"none"===e||"square"===e?"roundRect":e});var c=l.symbolSize;if(null!=c){var u=-1/0;$I(c,function(e){e>u&&(u=e)}),l.symbolSize=UI(c,function(e){return YI(e,[0,u],[0,a[0]],!0)})}},this)}.call(this,a)},resetItemSize:function(){this.itemSize=[parseFloat(this.get("itemWidth")),parseFloat(this.get("itemHeight"))]},isCategory:function(){return!!this.option.categories},setSelected:XI,getValueState:XI,getVisualMeta:XI}),JI=[20,140],QI=KI.extend({type:"visualMap.continuous",defaultOption:{align:"auto",calculable:!1,range:null,realtime:!0,itemHeight:null,itemWidth:null,hoverLink:!0,hoverLinkDataSize:null,hoverLinkOnHandle:null},optionUpdated:function(e,t){QI.superApply(this,"optionUpdated",arguments),this.resetExtent(),this.resetVisual(function(e){e.mappingMethod="linear",e.dataExtent=this.getExtent()}),this._resetRange()},resetItemSize:function(){QI.superApply(this,"resetItemSize",arguments);var e=this.itemSize;"horizontal"===this._orient&&e.reverse(),(null==e[0]||isNaN(e[0]))&&(e[0]=JI[0]),(null==e[1]||isNaN(e[1]))&&(e[1]=JI[1])},_resetRange:function(){var e=this.getExtent(),t=this.option.range;!t||t.auto?(e.auto=1,this.option.range=e):y(t)&&(t[0]>t[1]&&t.reverse(),t[0]=Math.max(t[0],e[0]),t[1]=Math.min(t[1],e[1]))},completeVisualOption:function(){KI.prototype.completeVisualOption.apply(this,arguments),d(this.stateList,function(e){var t=this.option.controller[e].symbolSize;t&&t[0]!==t[1]&&(t[0]=0)},this)},setSelected:function(e){this.option.range=e.slice(),this._resetRange()},getSelected:function(){var e=this.getExtent(),t=Ii((this.get("range")||[]).slice());return t[0]>e[1]&&(t[0]=e[1]),t[1]>e[1]&&(t[1]=e[1]),t[0]<e[0]&&(t[0]=e[0]),t[1]<e[0]&&(t[1]=e[0]),t},getValueState:function(e){var t=this.option.range,n=this.getExtent();return(t[0]<=n[0]||t[0]<=e)&&(t[1]>=n[1]||e<=t[1])?"inRange":"outOfRange"},findTargetDataIndices:function(e){var t=[];return this.eachTargetSeries(function(n){var i=[],r=n.getData();r.each(this.getDataDimension(r),function(t,n){e[0]<=t&&t<=e[1]&&i.push(n)},!0,this),t.push({seriesId:n.id,dataIndex:i})},this),t},getVisualMeta:function(t){function e(e,n){r.push({value:e,color:t(e,n)})}for(var n=im(0,0,this.getExtent()),i=im(0,0,this.option.range.slice()),r=[],o=0,a=0,s=i.length,l=n.length;a<l&&(!i.length||n[a]<=i[0]);a++)n[a]<i[o]&&e(n[a],"outOfRange");for(c=1;o<s;o++,c=0)c&&r.length&&e(i[o],"outOfRange"),e(i[o],"inRange");for(var c=1;a<l;a++)(!i.length||i[i.length-1]<n[a])&&(c&&(r.length&&e(r[r.length-1].value,"outOfRange"),c=0),e(n[a],"outOfRange"));var u=r.length;return{stops:r,outerColors:[u?r[0].color:"transparent",u?r[u-1].color:"transparent"]}}}),eD=lr({type:"visualMap",autoPositionValues:{left:1,right:1,top:1,bottom:1},init:function(e,t){this.ecModel=e,this.api=t,this.visualMapModel},render:function(e,t,n,i){this.visualMapModel=e,!1!==e.get("show")?this.doRender.apply(this,arguments):this.group.removeAll()},renderBackground:function(e){var t=this.visualMapModel,n=Wy(t.get("padding")||0),i=e.getBoundingRect();e.add(new fb({z2:-1,silent:!0,shape:{x:i.x-n[3],y:i.y-n[0],width:i.width+n[3]+n[1],height:i.height+n[0]+n[2]},style:{fill:t.get("backgroundColor"),stroke:t.get("borderColor"),lineWidth:t.get("borderWidth")}}))},getControllerVisual:function(e,t,i){function n(e){return s[e]}function o(e,t){s[e]=t}var r=(i=i||{}).forceState,a=this.visualMapModel,s={};if("symbol"===t&&(s.symbol=a.get("itemSymbol")),"color"===t){var l=a.get("contentColor");s.color=l}var c=a.controllerVisuals[r||a.getValueState(e)];return d(XT.prepareVisualTypes(c),function(r){var a=c[r];i.convertOpacityToAlpha&&"opacity"===r&&(r="colorAlpha",a=c.__alphaForOpacity),XT.dependsOn(r,t)&&a&&a.applyVisual(e,n,o)}),s[t]},positionGroup:function(e){var t=this.visualMapModel,n=this.api;Jo(e,t.getBoxLayoutParams(),{width:n.getWidth(),height:n.getHeight()})},doRender:N}),tD=wi,nD=d,iD=Math.min,rD=Math.max,oD=12,aD=6,sD=eD.extend({type:"visualMap.continuous",init:function(){sD.superApply(this,"init",arguments),this._shapes={},this._dataInterval=[],this._handleEnds=[],this._orient,this._useHandle,this._hoverLinkDataIndices=[],this._dragging,this._hovering},doRender:function(e,t,n,i){i&&"selectDataRange"===i.type&&i.from===this.uid||this._buildView()},_buildView:function(){this.group.removeAll();var e=this.visualMapModel,t=this.group;this._orient=e.get("orient"),this._useHandle=e.get("calculable"),this._resetInterval(),this._renderBar(t);var n=e.get("text");this._renderEndsText(t,n,0),this._renderEndsText(t,n,1),this._updateView(!0),this.renderBackground(t),this._updateView(),this._enableHoverLinkToSeries(),this._enableHoverLinkFromSeries(),this.positionGroup(t)},_renderEndsText:function(e,t,n){if(t){var i=t[1-n];i=null!=i?i+"":"";var r=this.visualMapModel,o=r.get("textGap"),a=r.itemSize,s=this._shapes.barGroup,l=this._applyTransform([a[0]/2,0===n?-o:a[1]+o],s),c=this._applyTransform(0===n?"bottom":"top",s),u=this._orient,d=this.visualMapModel.textStyleModel;this.group.add(new rb({style:{x:l[0],y:l[1],textVerticalAlign:"horizontal"===u?"middle":c,textAlign:"horizontal"===u?c:"center",text:i,textFont:d.getFont(),textFill:d.getTextColor()}}))}},_renderBar:function(e){var t=this.visualMapModel,n=this._shapes,i=t.itemSize,r=this._orient,o=this._useHandle,a=nm(t,this.api,i),s=n.barGroup=this._createBarGroup(a);s.add(n.outOfRange=am()),s.add(n.inRange=am(null,o?um(this._orient):null,m(this._dragHandle,this,"all",!1),m(this._dragHandle,this,"all",!0)));var l=t.textStyleModel.getTextRect("国"),c=rD(l.width,l.height);o&&(n.handleThumbs=[],n.handleLabels=[],n.handleLabelPoints=[],this._createHandle(s,0,i,c,r,a),this._createHandle(s,1,i,c,r,a)),this._createIndicator(s,i,c,r),e.add(s)},_createHandle:function(e,t,n,i,r){var o=m(this._dragHandle,this,t,!1),a=m(this._dragHandle,this,t,!0),s=am(rm(t,i),um(this._orient),o,a);s.position[0]=n[0],e.add(s);var l=this.visualMapModel.textStyleModel,c=new rb({draggable:!0,drift:o,onmousemove:function(e){Cy(e.event)},ondragend:a,style:{x:0,y:0,text:"",textFont:l.getFont(),textFill:l.getTextColor()}});this.group.add(c);var u=["horizontal"===r?i/2:1.5*i,"horizontal"===r?0===t?-1.5*i:1.5*i:0===t?-i/2:i/2],d=this._shapes;d.handleThumbs[t]=s,d.handleLabelPoints[t]=u,d.handleLabels[t]=c},_createIndicator:function(e,t,n,i){var r=am([[0,0]],"move");r.position[0]=t[0],r.attr({invisible:!0,silent:!0}),e.add(r);var o=this.visualMapModel.textStyleModel,a=new rb({silent:!0,invisible:!0,style:{x:0,y:0,text:"",textFont:o.getFont(),textFill:o.getTextColor()}});this.group.add(a);var s=["horizontal"===i?n/2:aD+3,0],l=this._shapes;l.indicator=r,l.indicatorLabel=a,l.indicatorLabelPoint=s},_dragHandle:function(e,t,n,i){if(this._useHandle){if(this._dragging=!t,!t){var r=this._applyTransform([n,i],this._shapes.barGroup,!0);this._updateInterval(e,r[1]),this._updateView()}t===!this.visualMapModel.get("realtime")&&this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:this._dataInterval.slice()}),t?!this._hovering&&this._clearHoverLinkToSeries():hm(this.visualMapModel)&&this._doHoverLinkToSeries(this._handleEnds[e],!1)}},_resetInterval:function(){var e=this.visualMapModel,t=this._dataInterval=e.getSelected(),n=e.getExtent(),i=[0,e.itemSize[1]];this._handleEnds=[tD(t[0],n,i,!0),tD(t[1],n,i,!0)]},_updateInterval:function(e,t){t=t||0;var n=this.visualMapModel,i=this._handleEnds,r=[0,n.itemSize[1]];OA(t,i,r,e,0);var o=n.getExtent();this._dataInterval=[tD(i[0],r,o,!0),tD(i[1],r,o,!0)]},_updateView:function(e){var t=this.visualMapModel,n=t.getExtent(),i=this._shapes,r=[0,t.itemSize[1]],o=e?r:this._handleEnds,a=this._createBarVisual(this._dataInterval,n,o,"inRange"),s=this._createBarVisual(n,n,r,"outOfRange");i.inRange.setStyle({fill:a.barColor,opacity:a.opacity}).setShape("points",a.barPoints),i.outOfRange.setStyle({fill:s.barColor,opacity:s.opacity}).setShape("points",s.barPoints),this._updateHandle(o,a)},_createBarVisual:function(e,t,n,i){var r={forceState:i,convertOpacityToAlpha:!0},o=this._makeColorGradient(e,r),a=[this.getControllerVisual(e[0],"symbolSize",r),this.getControllerVisual(e[1],"symbolSize",r)],s=this._createBarPoints(n,a);return{barColor:new bb(0,0,0,1,o),barPoints:s,handlesColor:[o[0].color,o[o.length-1].color]}},_makeColorGradient:function(e,t){var n=[],i=(e[1]-e[0])/100;n.push({color:this.getControllerVisual(e[0],"color",t),offset:0});for(var r=1;r<100;r++){var o=e[0]+i*r;if(o>e[1])break;n.push({color:this.getControllerVisual(o,"color",t),offset:r/100})}return n.push({color:this.getControllerVisual(e[1],"color",t),offset:1}),n},_createBarPoints:function(e,t){var n=this.visualMapModel.itemSize;return[[n[0]-t[0],e[0]],[n[0],e[0]],[n[0],e[1]],[n[0]-t[1],e[1]]]},_createBarGroup:function(e){var t=this._orient,n=this.visualMapModel.get("inverse");return new X_("horizontal"!==t||n?"horizontal"===t&&n?{scale:"bottom"===e?[-1,1]:[1,1],rotation:-Math.PI/2}:"vertical"!==t||n?{scale:"left"===e?[1,1]:[-1,1]}:{scale:"left"===e?[1,-1]:[-1,-1]}:{scale:"bottom"===e?[1,1]:[-1,1],rotation:Math.PI/2})},_updateHandle:function(e,t){if(this._useHandle){var n=this._shapes,i=this.visualMapModel,r=n.handleThumbs,o=n.handleLabels;nD([0,1],function(a){var s=r[a];s.setStyle("fill",t.handlesColor[a]),s.position[1]=e[a];var l=Io(n.handleLabelPoints[a],Mo(s,this.group));o[a].setStyle({x:l[0],y:l[1],text:i.formatValueText(this._dataInterval[a]),textVerticalAlign:"middle",textAlign:this._applyTransform("horizontal"===this._orient?0===a?"bottom":"top":"left",n.barGroup)})},this)}},_showIndicator:function(e,t,n,i){var r=this.visualMapModel,o=r.getExtent(),a=r.itemSize,s=[0,a[1]],l=tD(e,o,s,!0),c=this._shapes,u=c.indicator;if(u){u.position[1]=l,u.attr("invisible",!1),u.setShape("points",sm(!!n,i,l,a[1]));var d={convertOpacityToAlpha:!0},h=this.getControllerVisual(e,"color",d);u.setStyle("fill",h);var p=Io(c.indicatorLabelPoint,Mo(u,this.group)),f=c.indicatorLabel;f.attr("invisible",!1);var g=this._applyTransform("left",c.barGroup),m=this._orient;f.setStyle({text:(n||"")+r.formatValueText(t),textVerticalAlign:"horizontal"===m?g:"middle",textAlign:"horizontal"===m?"center":g,x:p[0],y:p[1]})}},_enableHoverLinkToSeries:function(){var e=this;this._shapes.barGroup.on("mousemove",function(t){if(e._hovering=!0,!e._dragging){var n=e.visualMapModel.itemSize,i=e._applyTransform([t.offsetX,t.offsetY],e._shapes.barGroup,!0,!0);i[1]=iD(rD(0,i[1]),n[1]),e._doHoverLinkToSeries(i[1],0<=i[0]&&i[0]<=n[0])}}).on("mouseout",function(){e._hovering=!1,!e._dragging&&e._clearHoverLinkToSeries()})},_enableHoverLinkFromSeries:function(){var e=this.api.getZr();this.visualMapModel.option.hoverLink?(e.on("mouseover",this._hoverLinkFromSeriesMouseOver,this),e.on("mouseout",this._hideIndicator,this)):this._clearHoverLinkFromSeries()},_doHoverLinkToSeries:function(e,t){var n=this.visualMapModel,i=n.itemSize;if(n.option.hoverLink){var r=[0,i[1]],o=n.getExtent();e=iD(rD(r[0],e),r[1]);var a=lm(n,o,r),s=[e-a,e+a],l=tD(e,r,o,!0),c=[tD(s[0],r,o,!0),tD(s[1],r,o,!0)];s[0]<r[0]&&(c[0]=-1/0),s[1]>r[1]&&(c[1]=1/0),t&&(c[0]===-1/0?this._showIndicator(l,c[1],"< ",a):c[1]===1/0?this._showIndicator(l,c[0],"> ",a):this._showIndicator(l,l,"≈ ",a));var u=this._hoverLinkDataIndices,d=[];(t||hm(n))&&(d=this._hoverLinkDataIndices=n.findTargetDataIndices(c));var h=Wo(u,d);this._dispatchHighDown("downplay",om(h[0])),this._dispatchHighDown("highlight",om(h[1]))}},_hoverLinkFromSeriesMouseOver:function(e){var t=e.target,n=this.visualMapModel;if(t&&null!=t.dataIndex){var i=this.ecModel.getSeriesByIndex(t.seriesIndex);if(n.isTargetSeries(i)){var r=i.getData(t.dataType),o=r.getDimension(n.getDataDimension(r)),a=r.get(o,t.dataIndex,!0);isNaN(a)||this._showIndicator(a,a)}}},_hideIndicator:function(){var e=this._shapes;e.indicator&&e.indicator.attr("invisible",!0),e.indicatorLabel&&e.indicatorLabel.attr("invisible",!0)},_clearHoverLinkToSeries:function(){this._hideIndicator();var e=this._hoverLinkDataIndices;this._dispatchHighDown("downplay",om(e)),e.length=0},_clearHoverLinkFromSeries:function(){this._hideIndicator();var e=this.api.getZr();e.off("mouseover",this._hoverLinkFromSeriesMouseOver),e.off("mouseout",this._hideIndicator)},_applyTransform:function(e,t,n,i){var r=Mo(t,i?null:this.group);return Eb[y(e)?"applyTransform":"transformDirection"](e,r,n)},_dispatchHighDown:function(e,t){t&&t.length&&this.api.dispatchAction({type:e,batch:t})},dispose:function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()},remove:function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()}});ir({type:"selectDataRange",event:"dataRangeSelected",update:"update"},function(e,t){t.eachComponent({mainType:"visualMap",query:e},function(t){t.setSelected(e.selected)})}),tr(HI);var lD=KI.extend({type:"visualMap.piecewise",defaultOption:{selected:null,minOpen:!1,maxOpen:!1,align:"auto",itemWidth:20,itemHeight:14,itemSymbol:"roundRect",pieceList:null,categories:null,splitNumber:5,selectedMode:"multiple",itemGap:10,hoverLink:!0,showLabel:null},optionUpdated:function(e,t){lD.superApply(this,"optionUpdated",arguments),this._pieceList=[],this.resetExtent();var n=this._mode=this._determineMode();cD[this._mode].call(this),this._resetSelected(e,t);var r=this.option.categories;this.resetVisual(function(e,t){"categories"===n?(e.mappingMethod="category",e.categories=i(r)):(e.dataExtent=this.getExtent(),e.mappingMethod="piecewise",e.pieceList=f(this._pieceList,function(e){var e=i(e);return"inRange"!==t&&(e.visual=null),e}))})},completeVisualOption:function(){function t(e,t,n){return e&&e[t]&&(b(e[t])?e[t].hasOwnProperty(n):e[t]===n)}var e=this.option,n={},i=XT.listVisualTypes(),r=this.isCategory();d(e.pieces,function(e){d(i,function(t){e.hasOwnProperty(t)&&(n[t]=1)})}),d(n,function(n,i){var o=0;d(this.stateList,function(n){o|=t(e,n,i)||t(e.target,n,i)},this),!o&&d(this.stateList,function(t){(e[t]||(e[t]={}))[i]=VI.get(i,"inRange"===t?"active":"inactive",r)})},this),KI.prototype.completeVisualOption.apply(this,arguments)},_resetSelected:function(e,t){var n=this.option,i=this._pieceList,r=(t?n:e).selected||{};if(n.selected=r,d(i,function(e,t){var n=this.getSelectedMapKey(e);r.hasOwnProperty(n)||(r[n]=!0)},this),"single"===n.selectedMode){var o=!1;d(i,function(e,t){var n=this.getSelectedMapKey(e);r[n]&&(o?r[n]=!1:o=!0)},this)}},getSelectedMapKey:function(e){return"categories"===this._mode?e.value+"":e.index+""},getPieceList:function(){return this._pieceList},_determineMode:function(){var e=this.option;return e.pieces&&e.pieces.length>0?"pieces":this.option.categories?"categories":"splitNumber"},setSelected:function(e){this.option.selected=i(e)},getValueState:function(e){var t=XT.findPieceIndex(e,this._pieceList);return null!=t&&this.option.selected[this.getSelectedMapKey(this._pieceList[t])]?"inRange":"outOfRange"},findTargetDataIndices:function(e){var t=[];return this.eachTargetSeries(function(n){var i=[],r=n.getData();r.each(this.getDataDimension(r),function(t,n){XT.findPieceIndex(t,this._pieceList)===e&&i.push(n)},!0,this),t.push({seriesId:n.id,dataIndex:i})},this),t},getRepresentValue:function(e){var t;if(this.isCategory())t=e.value;else if(null!=e.value)t=e.value;else{var n=e.interval||[];t=n[0]===-1/0&&n[1]===1/0?0:(n[0]+n[1])/2}return t},getVisualMeta:function(t){function e(e,o){var a=r.getRepresentValue({interval:e});o||(o=r.getValueState(a));var s=t(a,o);e[0]===-1/0?i[0]=s:e[1]===1/0?i[1]=s:n.push({value:e[0],color:s},{value:e[1],color:s})}if(!this.isCategory()){var n=[],i=[],r=this,o=this._pieceList.slice();if(o.length){var a=o[0].interval[0];a!==-1/0&&o.unshift({interval:[-1/0,a]}),(a=o[o.length-1].interval[1])!==1/0&&o.push({interval:[a,1/0]})}else o.push({interval:[-1/0,1/0]});var s=-1/0;return d(o,function(t){var n=t.interval;n&&(n[0]>s&&e([s,n[0]],"outOfRange"),e(n.slice()),s=n[1])},this),{stops:n,outerColors:i}}}}),cD={splitNumber:function(){var e=this.option,t=this._pieceList,n=Math.min(e.precision,20),i=this.getExtent(),r=e.splitNumber;r=Math.max(parseInt(r,10),1),e.splitNumber=r;for(var o=(i[1]-i[0])/r;+o.toFixed(n)!==o&&n<5;)n++;e.precision=n,o=+o.toFixed(n);var a=0;e.minOpen&&t.push({index:a++,interval:[-1/0,i[0]],close:[0,0]});for(var s=i[0],l=a+r;a<l;s+=o){var c=a===r-1?i[1]:s+o;t.push({index:a++,interval:[s,c],close:[1,1]})}e.maxOpen&&t.push({index:a++,interval:[i[1],1/0],close:[0,0]}),Ei(t),d(t,function(e){e.text=this.formatValueText(e.interval)},this)},categories:function(){var e=this.option;d(e.categories,function(e){this._pieceList.push({text:this.formatValueText(e,!0),value:e})},this),cm(e,this._pieceList)},pieces:function(){var e=this.option,t=this._pieceList;d(e.pieces,function(e,n){b(e)||(e={value:e});var i={text:"",index:n};if(null!=e.label&&(i.text=e.label),e.hasOwnProperty("value")){var r=i.value=e.value;i.interval=[r,r],i.close=[1,1]}else{for(var o=i.interval=[],a=i.close=[0,0],s=[1,0,1],l=[-1/0,1/0],c=[],u=0;u<2;u++){for(var d=[["gte","gt","min"],["lte","lt","max"]][u],h=0;h<3&&null==o[u];h++)o[u]=e[d[h]],a[u]=s[h],c[u]=2===h;null==o[u]&&(o[u]=l[u])}c[0]&&o[1]===1/0&&(a[0]=0),c[1]&&o[0]===-1/0&&(a[1]=0),o[0]===o[1]&&a[0]&&a[1]&&(i.value=o[0])}i.visual=XT.retrieveVisuals(e),t.push(i)},this),cm(e,t),Ei(t),d(t,function(e){var t=e.close,n=[["<","≤"][t[1]],[">","≥"][t[0]]];e.text=e.text||this.formatValueText(null!=e.value?e.value:e.interval,!1,n)},this)}};eD.extend({type:"visualMap.piecewise",doRender:function(){var e=this.group;e.removeAll();var t=this.visualMapModel,n=t.get("textGap"),i=t.textStyleModel,r=i.getFont(),o=i.getTextColor(),a=this._getItemAlign(),s=t.itemSize,l=this._getViewData(),c=l.endsText,u=I(t.get("showLabel",!0),!c);c&&this._renderEndsText(e,c[0],s,u,a),d(l.viewPieceList,function(i){var l=i.piece,c=new X_;c.onclick=m(this._onItemClick,this,l),this._enableHoverLink(c,i.indexInModelPieceList);var d=t.getRepresentValue(l);if(this._createItemSymbol(c,d,[0,0,s[0],s[1]]),u){var h=this.visualMapModel.getValueState(d);c.add(new rb({style:{x:"right"===a?-n:s[0]+n,y:s[1]/2,text:l.text,textVerticalAlign:"middle",textAlign:a,textFont:r,textFill:o,opacity:"outOfRange"===h?.5:1}}))}e.add(c)},this),c&&this._renderEndsText(e,c[1],s,u,a),$b(t.get("orient"),e,t.get("itemGap")),this.renderBackground(e),this.positionGroup(e)},_enableHoverLink:function(e,t){function i(e){var n=this.visualMapModel;n.option.hoverLink&&this.api.dispatchAction({type:e,batch:om(n.findTargetDataIndices(t))})}e.on("mouseover",m(i,this,"highlight")).on("mouseout",m(i,this,"downplay"))},_getItemAlign:function(){var e=this.visualMapModel,t=e.option;if("vertical"===t.orient)return nm(e,this.api,e.itemSize);var n=t.align;return n&&"auto"!==n||(n="left"),n},_renderEndsText:function(e,t,n,i,r){if(t){var o=new X_,a=this.visualMapModel.textStyleModel;o.add(new rb({style:{x:i?"right"===r?n[0]:0:n[0]/2,y:n[1]/2,textVerticalAlign:"middle",textAlign:i?r:"center",text:t,textFont:a.getFont(),textFill:a.getTextColor()}})),e.add(o)}},_getViewData:function(){var e=this.visualMapModel,t=f(e.getPieceList(),function(e,t){return{piece:e,indexInModelPieceList:t}}),n=e.get("text"),i=e.get("orient"),r=e.get("inverse");return("horizontal"===i?r:!r)?t.reverse():n&&(n=n.slice().reverse()),{viewPieceList:t,endsText:n}},_createItemSymbol:function(e,t,n){e.add(Hr(this.getControllerVisual(t,"symbol"),n[0],n[1],n[2],n[3],this.getControllerVisual(t,"color")))},_onItemClick:function(e){var t=this.visualMapModel,n=t.option,r=i(n.selected),o=t.getSelectedMapKey(e);"single"===n.selectedMode?(r[o]=!0,d(r,function(e,t){r[t]=t===o})):r[o]=!r[o],this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:r})}}),tr(HI);var uD=Vi,dD=Gi,hD=sr({type:"marker",dependencies:["series","grid","polar","geo"],init:function(e,t,n,i){this.mergeDefaultAndTheme(e,n),this.mergeOption(e,n,i.createdBySelf,!0)},isAnimationEnabled:function(){if(jv.node)return!1;var e=this.__hostSeries;return this.getShallow("animation")&&e&&e.isAnimationEnabled()},mergeOption:function(e,t,n,i){var r=this.constructor,o=this.mainType+"Model";n||t.eachSeries(function(e){var n=e.get(this.mainType),s=e[o];n&&n.data?(s?s.mergeOption(n,t,!0):(i&&dm(n),d(n.data,function(e){e instanceof Array?(dm(e[0]),dm(e[1])):dm(e)}),a(s=new r(n,this,t),{mainType:this.mainType,seriesIndex:e.seriesIndex,name:e.name,createdBySelf:!0}),s.__hostSeries=e),e[o]=s):e[o]=null},this)},formatTooltip:function(e){var t=this.getData(),n=this.getRawValue(e),i=y(n)?f(n,uD).join(", "):uD(n),r=t.getName(e),o=dD(this.name);return(null!=n||r)&&(o+="<br />"),r&&(o+=dD(r),null!=n&&(o+=" : ")),null!=n&&(o+=dD(i)),o},getData:function(){return this._data},setData:function(e){this._data=e}});u(hD,zb),hD.extend({type:"markPoint",defaultOption:{zlevel:0,z:5,symbol:"pin",symbolSize:50,tooltip:{trigger:"item"},label:{normal:{show:!0,position:"inside"},emphasis:{show:!0}},itemStyle:{normal:{borderWidth:2}}}});var pD=l,fD=v,gD={min:fD(mm,"min"),max:fD(mm,"max"),average:fD(mm,"average")},mD=lr({type:"marker",init:function(){this.markerGroupMap=z()},render:function(e,t,n){var i=this.markerGroupMap;i.each(function(e){e.__keep=!1});var r=this.type+"Model";t.eachSeries(function(e){var i=e[r];i&&this.renderSeries(e,i,t,n)},this),i.each(function(e){!e.__keep&&this.group.remove(e.group)},this)},renderSeries:function(){}});mD.extend({type:"markPoint",updateLayout:function(e,t,n){t.eachSeries(function(e){var t=e.markPointModel;t&&(wm(t.getData(),e,n),this.markerGroupMap.get(e.id).updateLayout(t))},this)},renderSeries:function(e,t,n,i){var r=e.coordinateSystem,o=e.id,a=e.getData(),s=this.markerGroupMap,l=s.get(o)||s.set(o,new ts),c=Sm(r,e,t);t.setData(c),wm(t.getData(),e,i),c.each(function(e){var n=c.getItemModel(e),i=n.getShallow("symbolSize");"function"==typeof i&&(i=i(t.getRawValue(e),t.getDataParams(e))),c.setItemVisual(e,{symbolSize:i,color:n.get("itemStyle.normal.color")||a.getVisual("color"),symbol:n.getShallow("symbol")})}),l.updateData(c),this.group.add(l.group),c.eachItemGraphicEl(function(e){e.traverse(function(e){e.dataModel=t})}),l.__keep=!0,l.group.silent=t.get("silent")||e.get("silent")}}),tr(function(e){e.markPoint=e.markPoint||{}}),hD.extend({type:"markLine",defaultOption:{zlevel:0,z:5,symbol:["circle","arrow"],symbolSize:[8,16],precision:2,tooltip:{trigger:"item"},label:{normal:{show:!0,position:"end"},emphasis:{show:!0}},lineStyle:{normal:{type:"dashed"},emphasis:{width:3}},animationEasing:"linear"}});var vD=function(e,t,r,o){var s=e.getData(),l=o.type;if(!y(o)&&("min"===l||"max"===l||"average"===l||null!=o.xAxis||null!=o.yAxis)){var c,u;if(null!=o.yAxis||null!=o.xAxis)c=null!=o.yAxis?"y":"x",t.getAxis(c),u=I(o.yAxis,o.xAxis);else{var d=ym(o,s,t,e);c=d.valueDataDim,d.valueAxis,u=bm(s,c,l)}var h="x"===c?0:1,p=1-h,f=i(o),g={};f.type=null,f.coord=[],g.coord=[],f.coord[p]=-1/0,g.coord[p]=1/0;var m=r.get("precision");m>=0&&"number"==typeof u&&(u=+u.toFixed(Math.min(m,20))),f.coord[h]=g.coord[h]=u,o=[f,g,{type:l,valueIndex:o.valueIndex,value:u}]}return o=[vm(e,o[0]),vm(e,o[1]),a({},o[2])],o[2].type=o[2].type||"",n(o[2],o[0]),n(o[2],o[1]),o};mD.extend({type:"markLine",updateLayout:function(e,t,n){t.eachSeries(function(e){var t=e.markLineModel;if(t){var i=t.getData(),r=t.__from,o=t.__to;r.each(function(t){Am(r,t,!0,e,n),Am(o,t,!1,e,n)}),i.each(function(e){i.setItemLayout(e,[r.getItemLayout(e),o.getItemLayout(e)])}),this.markerGroupMap.get(e.id).updateLayout()}},this)},renderSeries:function(e,t,n,i){function o(t,n,r){var o=t.getItemModel(n);Am(t,n,r,e,i),t.setItemVisual(n,{symbolSize:o.get("symbolSize")||g[r?0:1],symbol:o.get("symbol",!0)||f[r?0:1],color:o.get("itemStyle.normal.color")||s.getVisual("color")})}var r=e.coordinateSystem,a=e.id,s=e.getData(),l=this.markerGroupMap,c=l.get(a)||l.set(a,new Mu);this.group.add(c.group);var u=Cm(r,e,t),d=u.from,h=u.to,p=u.line;t.__from=d,t.__to=h,t.setData(p);var f=t.get("symbol"),g=t.get("symbolSize");y(f)||(f=[f,f]),"number"==typeof g&&(g=[g,g]),u.from.each(function(e){o(d,e,!0),o(h,e,!1)}),p.each(function(e){var t=p.getItemModel(e).get("lineStyle.normal.color");p.setItemVisual(e,{color:t||d.getItemVisual(e,"color")}),p.setItemLayout(e,[d.getItemLayout(e),h.getItemLayout(e)]),p.setItemVisual(e,{fromSymbolSize:d.getItemVisual(e,"symbolSize"),fromSymbol:d.getItemVisual(e,"symbol"),toSymbolSize:h.getItemVisual(e,"symbolSize"),toSymbol:h.getItemVisual(e,"symbol")})}),c.updateData(p),u.line.eachItemGraphicEl(function(e,n){e.traverse(function(e){e.dataModel=t})}),c.__keep=!0,c.group.silent=t.get("silent")||e.get("silent")}}),tr(function(e){e.markLine=e.markLine||{}}),hD.extend({type:"markArea",defaultOption:{zlevel:0,z:1,tooltip:{trigger:"item"},animation:!1,label:{normal:{show:!0,position:"top"},emphasis:{show:!0,position:"top"}},itemStyle:{normal:{borderWidth:0}}}});var _D=function(e,t,n,i){var r=vm(e,i[0]),a=vm(e,i[1]),s=I,l=r.coord,c=a.coord;l[0]=s(l[0],-1/0),l[1]=s(l[1],-1/0),c[0]=s(c[0],1/0),c[1]=s(c[1],1/0);var u=o([{},r,a]);return u.coord=[r.coord,a.coord],u.x0=r.x,u.y0=r.y,u.x1=a.x,u.y1=a.y,u},yD=[["x0","y0"],["x1","y0"],["x1","y1"],["x0","y1"]];mD.extend({type:"markArea",updateLayout:function(e,t,n){t.eachSeries(function(e){var t=e.markAreaModel;if(t){var i=t.getData();i.each(function(t){var r=f(yD,function(r){return Pm(i,t,r,e,n)});i.setItemLayout(t,r),i.getItemGraphicEl(t).setShape("points",r)})}},this)},renderSeries:function(e,t,n,i){var o=e.coordinateSystem,a=e.name,s=e.getData(),l=this.markerGroupMap,c=l.get(a)||l.set(a,{group:new X_});this.group.add(c.group),c.__keep=!0;var u=Om(o,e,t);t.setData(u),u.each(function(t){u.setItemLayout(t,f(yD,function(n){return Pm(u,t,n,e,i)})),u.setItemVisual(t,{color:s.getVisual("color")})}),u.diff(c.__data).add(function(e){var t=new hb({shape:{points:u.getItemLayout(e)}});u.setItemGraphicEl(e,t),c.group.add(t)}).update(function(e,n){var i=c.__data.getItemGraphicEl(n);wo(i,{shape:{points:u.getItemLayout(e)}},t,e),c.group.add(i),u.setItemGraphicEl(e,i)}).remove(function(e){var t=c.__data.getItemGraphicEl(e);c.group.remove(t)}).execute(),u.eachItemGraphicEl(function(e,n){var i=u.getItemModel(n),o=i.getModel("label.normal"),a=i.getModel("label.emphasis"),s=u.getItemVisual(n,"color");e.useStyle(r(i.getModel("itemStyle.normal").getItemStyle(),{fill:Pt(s,.4),stroke:s})),e.hoverStyle=i.getModel("itemStyle.emphasis").getItemStyle(),co(e.style,e.hoverStyle,o,a,{labelFetcher:t,labelDataIndex:n,defaultText:u.getName(n)||"",isRectText:!0,autoColor:s}),uo(e,{}),e.dataModel=t}),c.__data=u,c.group.silent=t.get("silent")||e.get("silent")}}),tr(function(e){e.markArea=e.markArea||{}}),jb.registerSubTypeDefaulter("timeline",function(){return"slider"}),ir({type:"timelineChange",event:"timelineChanged",update:"prepareAndUpdate"},function(e,t){var n=t.getComponent("timeline");return n&&null!=e.currentIndex&&(n.setCurrentIndex(e.currentIndex),!n.get("loop",!0)&&n.isIndexMax()&&n.setPlayState(!1)),t.resetOption("timeline"),r({currentIndex:n.option.currentIndex},e)}),ir({type:"timelinePlayChange",event:"timelinePlayChanged",update:"update"},function(e,t){var n=t.getComponent("timeline");n&&null!=e.playState&&n.setPlayState(e.playState)});var xD=jb.extend({type:"timeline",layoutMode:"box",defaultOption:{zlevel:0,z:4,show:!0,axisType:"time",realtime:!0,left:"20%",top:null,right:"20%",bottom:0,width:null,height:40,padding:5,controlPosition:"left",autoPlay:!1,rewind:!1,loop:!0,playInterval:2e3,currentIndex:0,itemStyle:{normal:{},emphasis:{}},label:{normal:{color:"#000"},emphasis:{}},data:[]},init:function(e,t,n){this._data,this._names,this.mergeDefaultAndTheme(e,n),this._initData()},mergeOption:function(e){xD.superApply(this,"mergeOption",arguments),this._initData()},setCurrentIndex:function(e){null==e&&(e=this.option.currentIndex);var t=this._data.count();this.option.loop?e=(e%t+t)%t:(e>=t&&(e=t-1),e<0&&(e=0)),this.option.currentIndex=e},getCurrentIndex:function(){return this.option.currentIndex},isIndexMax:function(){return this.getCurrentIndex()>=this._data.count()-1},setPlayState:function(e){this.option.autoPlay=!!e},getPlayState:function(){return!!this.option.autoPlay},_initData:function(){var e=this.option,t=e.data||[],n=e.axisType,r=this._names=[];if("category"===n){var o=[];d(t,function(e,t){var n,a=No(e);b(e)?(n=i(e)).value=t:n=t,o.push(n),_(a)||null!=a&&!isNaN(a)||(a=""),r.push(a+"")}),t=o}var a={category:"ordinal",time:"time"}[n]||"number";(this._data=new sC([{name:"value",type:a}],this)).initData(t,r)},getData:function(){return this._data},getCategories:function(){if("category"===this.get("axisType"))return this._names.slice()}});u(xD.extend({type:"timeline.slider",defaultOption:{backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,orient:"horizontal",inverse:!1,tooltip:{trigger:"item"},symbol:"emptyCircle",symbolSize:10,lineStyle:{show:!0,width:2,color:"#304654"},label:{position:"auto",normal:{show:!0,interval:"auto",rotate:0,color:"#304654"},emphasis:{show:!0,color:"#c23531"}},itemStyle:{normal:{color:"#304654",borderWidth:1},emphasis:{color:"#c23531"}},checkpointStyle:{symbol:"circle",symbolSize:13,color:"#c23531",borderWidth:5,borderColor:"rgba(194,53,49, 0.5)",animation:!0,animationDuration:300,animationEasing:"quinticInOut"},controlStyle:{show:!0,showPlayBtn:!0,showPrevBtn:!0,showNextBtn:!0,itemSize:22,itemGap:12,position:"left",playIcon:"path://M31.6,53C17.5,53,6,41.5,6,27.4S17.5,1.8,31.6,1.8C45.7,1.8,57.2,13.3,57.2,27.4S45.7,53,31.6,53z M31.6,3.3 C18.4,3.3,7.5,14.1,7.5,27.4c0,13.3,10.8,24.1,24.1,24.1C44.9,51.5,55.7,40.7,55.7,27.4C55.7,14.1,44.9,3.3,31.6,3.3z M24.9,21.3 c0-2.2,1.6-3.1,3.5-2l10.5,6.1c1.899,1.1,1.899,2.9,0,4l-10.5,6.1c-1.9,1.1-3.5,0.2-3.5-2V21.3z",stopIcon:"path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z",nextIcon:"path://M18.6,50.8l22.5-22.5c0.2-0.2,0.3-0.4,0.3-0.7c0-0.3-0.1-0.5-0.3-0.7L18.7,4.4c-0.1-0.1-0.2-0.3-0.2-0.5 c0-0.4,0.3-0.8,0.8-0.8c0.2,0,0.5,0.1,0.6,0.3l23.5,23.5l0,0c0.2,0.2,0.3,0.4,0.3,0.7c0,0.3-0.1,0.5-0.3,0.7l-0.1,0.1L19.7,52 c-0.1,0.1-0.3,0.2-0.5,0.2c-0.4,0-0.8-0.3-0.8-0.8C18.4,51.2,18.5,51,18.6,50.8z",prevIcon:"path://M43,52.8L20.4,30.3c-0.2-0.2-0.3-0.4-0.3-0.7c0-0.3,0.1-0.5,0.3-0.7L42.9,6.4c0.1-0.1,0.2-0.3,0.2-0.5 c0-0.4-0.3-0.8-0.8-0.8c-0.2,0-0.5,0.1-0.6,0.3L18.3,28.8l0,0c-0.2,0.2-0.3,0.4-0.3,0.7c0,0.3,0.1,0.5,0.3,0.7l0.1,0.1L41.9,54 c0.1,0.1,0.3,0.2,0.5,0.2c0.4,0,0.8-0.3,0.8-0.8C43.2,53.2,43.1,53,43,52.8z",normal:{color:"#304654",borderColor:"#304654",borderWidth:1},emphasis:{color:"#c23531",borderColor:"#c23531",borderWidth:2}},data:[]}}),zb);var bD=bw.extend({type:"timeline"}),wD=function(e,t,n,i){jC.call(this,e,t,n),this.type=i||"value",this._autoLabelInterval,this.model=null};wD.prototype={constructor:wD,getLabelInterval:function(){var e=this.model,t=e.getModel("label.normal"),n=t.get("interval");return null!=n&&"auto"!=n?n:((n=this._autoLabelInterval)||(n=this._autoLabelInterval=Rr(f(this.scale.getTicks(),this.dataToCoord,this),Vr(this,t.get("formatter")),t.getFont(),"horizontal"===e.get("orient")?0:90,t.get("rotate"))),n)},isLabelIgnored:function(e){if("category"===this.type){var t=this.getLabelInterval();return"function"==typeof t&&!t(e,this.scale.getLabel(e))||e%(t+1)}}},h(wD,jC);var CD=m,SD=d,TD=Math.PI;bD.extend({type:"timeline.slider",init:function(e,t){this.api=t,this._axis,this._viewRect,this._timer,this._currentPointer,this._mainGroup,this._labelGroup},render:function(e,t,n,i){if(this.model=e,this.api=n,this.ecModel=t,this.group.removeAll(),e.get("show",!0)){var r=this._layout(e,n),o=this._createGroup("mainGroup"),a=this._createGroup("labelGroup"),s=this._axis=this._createAxis(r,e);e.formatTooltip=function(e){return Gi(s.scale.getLabel(e))},SD(["AxisLine","AxisTick","Control","CurrentPointer"],function(t){this["_render"+t](r,o,s,e)},this),this._renderAxisLabel(r,a,s,e),this._position(r,e)}this._doPlayStop()},remove:function(){this._clearTimer(),this.group.removeAll()},dispose:function(){this._clearTimer()},_layout:function(e,t){var n=e.get("label.normal.position"),i=e.get("orient"),r=Rm(e,t);null==n||"auto"===n?n="horizontal"===i?r.y+r.height/2<t.getHeight()/2?"-":"+":r.x+r.width/2<t.getWidth()/2?"+":"-":isNaN(n)&&(n={horizontal:{top:"-",bottom:"+"},vertical:{left:"-",right:"+"}}[i][n]);var o={horizontal:"center",vertical:n>=0||"+"===n?"left":"right"},a={horizontal:n>=0||"+"===n?"top":"bottom",vertical:"middle"},s={horizontal:0,vertical:TD/2},l="vertical"===i?r.height:r.width,c=e.getModel("controlStyle"),u=c.get("show"),d=u?c.get("itemSize"):0,h=u?c.get("itemGap"):0,p=d+h,f=e.get("label.normal.rotate")||0;f=f*TD/180;var g,m,v,_,y=c.get("position",!0),x=(u=c.get("show",!0))&&c.get("showPlayBtn",!0),b=u&&c.get("showPrevBtn",!0),w=u&&c.get("showNextBtn",!0),C=0,S=l;return"left"===y||"bottom"===y?(x&&(g=[0,0],C+=p),b&&(m=[C,0],C+=p),w&&(v=[S-d,0],S-=p)):(x&&(g=[S-d,0],S-=p),b&&(m=[0,0],C+=p),w&&(v=[S-d,0],S-=p)),_=[C,S],e.get("inverse")&&_.reverse(),{viewRect:r,mainLength:l,orient:i,rotation:s[i],labelRotation:f,labelPosOpt:n,labelAlign:e.get("label.normal.align")||o[i],labelBaseline:e.get("label.normal.verticalAlign")||e.get("label.normal.baseline")||a[i],playPosition:g,prevBtnPosition:m,nextBtnPosition:v,axisExtent:_,controlSize:d,controlGap:h}},_position:function(e,t){function i(e){var t=e.position;e.origin=[d[0][0]-t[0],d[1][0]-t[1]]}function n(e){return[[e.x,e.x+e.width],[e.y,e.y+e.height]]}function o(e,t,n,i,r){e[i]+=n[i][r]-t[i][r]}var r=this._mainGroup,a=this._labelGroup,s=e.viewRect;if("vertical"===e.orient){var l=ot(),c=s.x,u=s.y+s.height;lt(l,l,[-c,-u]),ht(l,l,-TD/2),lt(l,l,[c,u]),(s=s.clone()).applyTransform(l)}var d=n(s),h=n(r.getBoundingRect()),p=n(a.getBoundingRect()),f=r.position,g=a.position;g[0]=f[0]=d[0][0];var m=e.labelPosOpt;if(isNaN(m))o(f,h,d,1,v="+"===m?0:1),o(g,p,d,1,1-v);else{var v=m>=0?0:1;o(f,h,d,1,v),g[1]=f[1]+m}r.attr("position",f),a.attr("position",g),r.rotation=a.rotation=e.rotation,i(r),i(a)},_createAxis:function(e,t){var n=t.getData(),i=t.get("axisType"),r=Er(t,i),o=n.getDataExtent("value");r.setExtent(o[0],o[1]),this._customizeScale(r,n),r.niceTicks();var a=new wD("value",r,e.axisExtent,i);return a.model=t,a},_customizeScale:function(e,t){e.getTicks=function(){return t.mapArray(["value"],function(e){return e})},e.getTicksLabels=function(){return f(this.getTicks(),e.getLabel,e)}},_createGroup:function(e){var t=this["_"+e]=new X_;return this.group.add(t),t},_renderAxisLine:function(e,t,n,i){var r=n.getExtent();i.get("lineStyle.show")&&t.add(new gb({shape:{x1:r[0],y1:0,x2:r[1],y2:0},style:a({lineCap:"round"},i.getModel("lineStyle").getLineStyle()),silent:!0,z2:1}))},_renderAxisTick:function(e,t,n,i){var r=i.getData(),o=n.scale.getTicks();SD(o,function(e,o){var a=n.dataToCoord(e),s=r.getItemModel(o),l=s.getModel("itemStyle.normal"),c=s.getModel("itemStyle.emphasis"),u={position:[a,0],onclick:CD(this._changeTimeline,this,o)},d=Bm(s,l,t,u);uo(d,c.getItemStyle()),s.get("tooltip")?(d.dataIndex=o,d.dataModel=i):d.dataIndex=d.dataModel=null},this)},_renderAxisLabel:function(e,t,n,i){var r=i.getModel("label.normal");if(r.get("show")){var o=i.getData(),a=n.scale.getTicks(),s=Vr(n,r.get("formatter")),l=n.getLabelInterval();SD(a,function(i,r){if(!n.isLabelIgnored(r,l)){var a=o.getItemModel(r),c=a.getModel("label.normal"),u=a.getModel("label.emphasis"),d=n.dataToCoord(i),h=new rb({position:[d,0],rotation:e.labelRotation-e.rotation,onclick:CD(this._changeTimeline,this,r),silent:!1});fo(h.style,c,{text:s[r],textAlign:e.labelAlign,textVerticalAlign:e.labelBaseline}),t.add(h),uo(h,fo({},u))}},this)}},_renderControl:function(e,t,n,i){function o(e,n,o,u){if(e){var d=Vm(i,n,c,{position:e,origin:[r/2,0],rotation:u?-a:0,rectHover:!0,style:s,onclick:o});t.add(d),uo(d,l)}}var r=e.controlSize,a=e.rotation,s=i.getModel("controlStyle.normal").getItemStyle(),l=i.getModel("controlStyle.emphasis").getItemStyle(),c=[0,-r/2,r,r],u=i.getPlayState(),d=i.get("inverse",!0);o(e.nextBtnPosition,"controlStyle.nextIcon",CD(this._changeTimeline,this,d?"-":"+")),o(e.prevBtnPosition,"controlStyle.prevIcon",CD(this._changeTimeline,this,d?"+":"-")),o(e.playPosition,"controlStyle."+(u?"stopIcon":"playIcon"),CD(this._handlePlayClick,this,!u),!0)},_renderCurrentPointer:function(e,t,n,i){var r=i.getData(),o=i.getCurrentIndex(),a=r.getItemModel(o).getModel("checkpointStyle"),s=this,l={onCreate:function(e){e.draggable=!0,e.drift=CD(s._handlePointerDrag,s),e.ondragend=CD(s._handlePointerDragend,s),Gm(e,o,n,i,!0)},onUpdate:function(e){Gm(e,o,n,i)}};this._currentPointer=Bm(a,a,this._mainGroup,{},this._currentPointer,l)},_handlePlayClick:function(e){this._clearTimer(),this.api.dispatchAction({type:"timelinePlayChange",playState:e,from:this.uid})},_handlePointerDrag:function(e,t,n){this._clearTimer(),this._pointerChangeTimeline([n.offsetX,n.offsetY])},_handlePointerDragend:function(e){this._pointerChangeTimeline([e.offsetX,e.offsetY],!0)},_pointerChangeTimeline:function(e,t){var n=this._toAxisCoord(e)[0],i=Ii(this._axis.getExtent().slice());n>i[1]&&(n=i[1]),n<i[0]&&(n=i[0]),this._currentPointer.position[0]=n,this._currentPointer.dirty();var r=this._findNearestTick(n),o=this.model;(t||r!==o.getCurrentIndex()&&o.get("realtime"))&&this._changeTimeline(r)},_doPlayStop:function(){this._clearTimer(),this.model.getPlayState()&&(this._timer=setTimeout(CD(function(){var e=this.model;this._changeTimeline(e.getCurrentIndex()+(e.get("rewind",!0)?-1:1))},this),this.model.get("playInterval")))},_toAxisCoord:function(e){return Io(e,this._mainGroup.getLocalTransform(),!0)},_findNearestTick:function(e){var t,n=this.model.getData(),i=1/0,r=this._axis;return n.each(["value"],function(n,o){var a=r.dataToCoord(n),s=Math.abs(a-e);s<i&&(i=s,t=o)}),t},_clearTimer:function(){this._timer&&(clearTimeout(this._timer),this._timer=null)},_changeTimeline:function(e){var t=this.model.getCurrentIndex();"+"===e?e=t+1:"-"===e&&(e=t-1),this.api.dispatchAction({type:"timelineChange",currentIndex:e,from:this.uid})}}),tr(function(e){var t=e&&e.timeline;y(t)||(t=t?[t]:[]),d(t,function(e){e&&zm(e)})});var AD=sr({type:"toolbox",layoutMode:{type:"box",ignoreSize:!0},mergeDefaultAndTheme:function(e){AD.superApply(this,"mergeDefaultAndTheme",arguments),d(this.option.feature,function(e,t){var i=Sg(t);i&&n(e,i.defaultOption)})},defaultOption:{show:!0,z:6,zlevel:0,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{normal:{borderColor:"#666",color:"none"},emphasis:{borderColor:"#3E98C5"}}}});lr({type:"toolbox",render:function(e,t,n,i){function o(r,o){var s,d=u[r],h=u[o],p=new Lo(l[d],e,e.ecModel);if(d&&!h){if(Wm(d))s={model:p,onclick:p.option.onclick,featureName:d};else{var f=Sg(d);if(!f)return;s=new f(p,t,n)}c[d]=s}else{if(!(s=c[h]))return;s.model=p,s.ecModel=t,s.api=n}d||!h?p.get("show")&&!s.unusable?(a(p,s,d),p.setIconStatus=function(e,t){var n=this.option,i=this.iconPaths;n.iconStatus=n.iconStatus||{},n.iconStatus[e]=t,i[e]&&i[e].trigger(t)},s.render&&s.render(p,t,n,i)):s.remove&&s.remove(t,n):s.dispose&&s.dispose(t,n)}function a(i,o,a){var l=i.getModel("iconStyle"),c=o.getIcons?o.getIcons():i.get("icon"),u=i.get("title")||{};if("string"==typeof c){var h=c,p=u;u={},(c={})[a]=h,u[a]=p}var f=i.iconPaths={};d(c,function(a,c){var d=Do(a,{},{x:-s/2,y:-s/2,width:s,height:s});d.setStyle(l.getModel("normal").getItemStyle()),d.hoverStyle=l.getModel("emphasis").getItemStyle(),uo(d),e.get("showTitle")&&(d.__title=u[c],d.on("mouseover",function(){var e=l.getModel("emphasis").getItemStyle();d.setStyle({text:u[c],textPosition:e.textPosition||"bottom",textFill:e.fill||e.stroke||"#000",textAlign:e.textAlign||"center"})}).on("mouseout",function(){d.setStyle({textFill:null})})),d.trigger(i.get("iconStatus."+c)||"normal"),r.add(d),d.on("click",m(o.onclick,o,t,n,c)),f[c]=d})}var r=this.group;if(r.removeAll(),e.get("show")){var s=+e.get("itemSize"),l=e.get("feature")||{},c=this._features||(this._features={}),u=[];d(l,function(e,t){u.push(t)}),new fr(this._featureNames||[],u).add(o).update(o).remove(v(o,null)).execute(),this._featureNames=u,yp(r,e,n),r.add(xp(r.getBoundingRect(),e)),r.eachChild(function(e){var t=e.__title,i=e.hoverStyle;if(i&&t){var o=de(t,Ae(i)),a=e.position[0]+r.position[0],l=!1;e.position[1]+r.position[1]+s+o.height>n.getHeight()&&(i.textPosition="top",l=!0);var c=l?-5-o.height:s+8;a+o.width/2>n.getWidth()?(i.textPosition=["100%",c],i.textAlign="right"):a-o.width/2<0&&(i.textPosition=[0,c],i.textAlign="left")}})}},updateView:function(e,t,n,i){d(this._features,function(e){e.updateView&&e.updateView(e.model,t,n,i)})},updateLayout:function(e,t,n,i){d(this._features,function(e){e.updateLayout&&e.updateLayout(e.model,t,n,i)})},remove:function(e,t){d(this._features,function(n){n.remove&&n.remove(e,t)}),this.group.removeAll()},dispose:function(e,t){d(this._features,function(n){n.dispose&&n.dispose(e,t)})}});var MD=uI.toolbox.saveAsImage;Hm.defaultOption={show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:MD.title,type:"png",name:"",excludeComponents:["toolbox"],pixelRatio:1,lang:MD.lang.slice()},Hm.prototype.unusable=!jv.canvasSupported,Hm.prototype.onclick=function(e,t){var n=this.model,i=n.get("name")||e.get("title.0.text")||"echarts",r=document.createElement("a"),o=n.get("type",!0)||"png";r.download=i+"."+o,r.target="_blank";var a=t.getConnectedDataURL({type:o,backgroundColor:n.get("backgroundColor",!0)||e.get("backgroundColor")||"#fff",excludeComponents:n.get("excludeComponents"),pixelRatio:n.get("pixelRatio")});if(r.href=a,"function"!=typeof MouseEvent||jv.browser.ie||jv.browser.edge)if(window.navigator.msSaveOrOpenBlob){for(var s=atob(a.split(",")[1]),l=s.length,c=new Uint8Array(l);l--;)c[l]=s.charCodeAt(l);var u=new Blob([c]);window.navigator.msSaveOrOpenBlob(u,i+"."+o)}else{var d=n.get("lang"),h='<body style="margin:0;"><img src="'+a+'" style="max-width:100%;" title="'+(d&&d[0]||"")+'" /></body>';window.open().document.write(h)}else{var p=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});r.dispatchEvent(p)}},wg("saveAsImage",Hm);var ED=uI.toolbox.magicType;Fm.defaultOption={show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z",tiled:"M2.3,2.2h22.8V25H2.3V2.2z M35,2.2h22.8V25H35V2.2zM2.3,35h22.8v22.8H2.3V35z M35,35h22.8v22.8H35V35z"},title:i(ED.title),option:{},seriesIndex:{}};var ID=Fm.prototype;ID.getIcons=function(){var e=this.model,t=e.get("icon"),n={};return d(e.get("type"),function(e){t[e]&&(n[e]=t[e])}),n};var DD={line:function(e,t,i,r){if("bar"===e)return n({id:t,type:"line",data:i.get("data"),stack:i.get("stack"),markPoint:i.get("markPoint"),markLine:i.get("markLine")},r.get("option.line")||{},!0)},bar:function(e,t,i,r){if("line"===e)return n({id:t,type:"bar",data:i.get("data"),stack:i.get("stack"),markPoint:i.get("markPoint"),markLine:i.get("markLine")},r.get("option.bar")||{},!0)},stack:function(e,t,i,r){if("line"===e||"bar"===e)return n({id:t,stack:"__ec_magicType_stack__"},r.get("option.stack")||{},!0)},tiled:function(e,t,i,r){if("line"===e||"bar"===e)return n({id:t,stack:""},r.get("option.tiled")||{},!0)}},kD=[["line","bar"],["stack","tiled"]];ID.onclick=function(e,t,n){var i=this.model,o=i.get("seriesIndex."+n);if(DD[n]){var a={series:[]};d(kD,function(e){l(e,n)>=0&&d(e,function(e){i.setIconStatus(e,"normal")})}),i.setIconStatus(n,"emphasis"),e.eachComponent({mainType:"series",query:null==o?null:{seriesIndex:o}},function(t){var o=t.subType,s=t.id,l=DD[n](o,s,t,i);l&&(r(l,t.option),a.series.push(l));var c=t.coordinateSystem;if(c&&"cartesian2d"===c.type&&("line"===n||"bar"===n)){var u=c.getAxesByScale("ordinal")[0];if(u){var d=u.dim+"Axis",h=e.queryComponents({mainType:d,index:t.get(name+"Index"),id:t.get(name+"Id")})[0].componentIndex;a[d]=a[d]||[];for(var p=0;p<=h;p++)a[d][h]=a[d][h]||{};a[d][h].boundaryGap="bar"===n}}}),t.dispatchAction({type:"changeMagicType",currentType:n,newOption:a})}},ir({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},function(e,t){t.mergeOption(e.newOption)}),wg("magicType",Fm);var LD=uI.toolbox.dataView,ND=new Array(60).join("-"),PD="\t",OD=new RegExp("["+PD+"]+","g");Qm.defaultOption={show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:i(LD.title),lang:i(LD.lang),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"},Qm.prototype.onclick=function(e,t){function i(){n.removeChild(o),y._dom=null}var n=t.getDom(),r=this.model;this._dom&&n.removeChild(this._dom);var o=document.createElement("div");o.style.cssText="position:absolute;left:5px;top:5px;bottom:5px;right:5px;",o.style.backgroundColor=r.get("backgroundColor")||"#fff";var a=document.createElement("h4"),s=r.get("lang")||[];a.innerHTML=s[0]||r.get("title"),a.style.cssText="margin: 10px 20px;",a.style.color=r.get("textColor");var l=document.createElement("div"),c=document.createElement("textarea");l.style.cssText="display:block;width:100%;overflow:auto;";var u=r.get("optionToContent"),d=r.get("contentToOption"),h=jm(e);if("function"==typeof u){var p=u(t.getOption());"string"==typeof p?l.innerHTML=p:S(p)&&l.appendChild(p)}else l.appendChild(c),c.readOnly=r.get("readOnly"),c.style.cssText="width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;",c.style.color=r.get("textColor"),c.style.borderColor=r.get("textareaBorderColor"),c.style.backgroundColor=r.get("textareaColor"),c.value=h.value;var f=h.meta,g=document.createElement("div");g.style.cssText="position:absolute;bottom:0;left:0;right:0;";var m="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",v=document.createElement("div"),_=document.createElement("div");m+=";background-color:"+r.get("buttonColor"),m+=";color:"+r.get("buttonTextColor");var y=this;si(v,"click",i),si(_,"click",function(){var e;try{e="function"==typeof d?d(l,t.getOption()):Jm(c.value,f)}catch(e){throw i(),new Error("Data view format error "+e)}e&&t.dispatchAction({type:"changeDataView",newOption:e}),i()}),v.innerHTML=s[1],_.innerHTML=s[2],_.style.cssText=m,v.style.cssText=m,!r.get("readOnly")&&g.appendChild(_),g.appendChild(v),si(c,"keydown",function(e){if(9===(e.keyCode||e.which)){var t=this.value,n=this.selectionStart,i=this.selectionEnd;this.value=t.substring(0,n)+PD+t.substring(i),this.selectionStart=this.selectionEnd=n+1,Cy(e)}}),o.appendChild(a),o.appendChild(l),o.appendChild(g),l.style.height=n.clientHeight-80+"px",n.appendChild(o),this._dom=o},Qm.prototype.remove=function(e,t){this._dom&&t.getDom().removeChild(this._dom)},Qm.prototype.dispose=function(e,t){this.remove(e,t)},wg("dataView",Qm),ir({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(e,t){var n=[];d(e.newOption.series,function(e){var i=t.getSeriesByName(e.name)[0];if(i){var r=i.get("data");n.push({name:e.name,data:tv(e.data,r)})}else n.push(a({type:"scatter"},e))}),t.mergeOption(r({series:n},e.newOption))});var RD=d,zD="\0_ec_hist_store";CI.extend({type:"dataZoom.select"}),SI.extend({type:"dataZoom.select"});var FD=uI.toolbox.dataZoom,BD=d,HD="\0_ec_\0toolbox-dataZoom_";rv.defaultOption={show:!0,icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:i(FD.title)};var VD=rv.prototype;VD.render=function(e,t,n,i){this.model=e,this.ecModel=t,this.api=n,hv(e,t,this,i,n),lv(e,t)},VD.onclick=function(e,t,n){WD[n].call(this)},VD.remove=function(e,t){this._brushController.unmount()},VD.dispose=function(e,t){this._brushController.dispose()};var WD={zoom:function(){var e=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:e})},back:function(){this._dispatchZoomAction(iv(this.ecModel))}};VD._onBrush=function(e,t){function i(e,t,i){var a=t.getAxis(e),s=a.model,l=n(e,s,o),c=l.findRepresentativeAxisProxy(s).getMinMaxSpan();null==c.minValueSpan&&null==c.maxValueSpan||(i=OA(0,i.slice(),a.scale.getExtent(),0,c.minValueSpan,c.maxValueSpan)),l&&(r[l.id]={dataZoomId:l.id,startValue:i[0],endValue:i[1]})}function n(e,t,n){var i;return n.eachComponent({mainType:"dataZoom",subType:"select"},function(n){n.getAxisModel(e,t.componentIndex)&&(i=n)}),i}if(t.isEnd&&e.length){var r={},o=this.ecModel;this._brushController.updateCovers([]),new rg(sv(this.model.option),o,{include:["grid"]}).matchOutputRanges(e,o,function(e,t,n){if("cartesian2d"===n.type){var r=e.brushType;"rect"===r?(i("x",n,t[0]),i("y",n,t[1])):i({lineX:"x",lineY:"y"}[r],n,t)}}),ev(o,r),this._dispatchZoomAction(r)}},VD._dispatchZoomAction=function(e){var t=[];BD(e,function(e,n){t.push(i(e))}),t.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:t})},wg("dataZoom",rv),tr(function(t){function e(e,t){if(t){var r=e+"Index",o=t[r];null==o||"all"==o||y(o)||(o=!1===o||"none"===o?[]:[o]),i(e,function(t,i){if(null==o||"all"==o||-1!==l(o,i)){var a={type:"select",$fromToolbox:!0,id:HD+e+i};a[r]=i,n.push(a)}})}}function i(e,n){var i=t[e];y(i)||(i=i?[i]:[]),BD(i,n)}if(t){var n=t.dataZoom||(t.dataZoom=[]);y(n)||(t.dataZoom=n=[n]);var r=t.toolbox;if(r&&(y(r)&&(r=r[0]),r&&r.feature)){var o=r.feature.dataZoom;e("xAxis",o),e("yAxis",o)}}});var UD=uI.toolbox.restore;uv.defaultOption={show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:UD.title},uv.prototype.onclick=function(e,t,n){nv(e),t.dispatchAction({type:"restore",from:this.uid})},wg("restore",uv),ir({type:"restore",event:"restore",update:"prepareAndUpdate"},function(e,t){t.resetOption("recreate")});var $D,GD="urn:schemas-microsoft-com:vml",qD="undefined"==typeof window?null:window,jD=!1,YD=qD&&qD.document;if(YD&&!jv.canvasSupported)try{!YD.namespaces.zrvml&&YD.namespaces.add("zrvml",GD),$D=function(e){return YD.createElement("<zrvml:"+e+' class="zrvml">')}}catch(Hv){$D=function(e){return YD.createElement("<"+e+' xmlns="'+GD+'" class="zrvml">')}}var XD=Px.CMD,ZD=Math.round,KD=Math.sqrt,JD=Math.abs,QD=Math.cos,ek=Math.sin,tk=Math.max;if(!jv.canvasSupported){var nk=21600,ik=nk/2,rk=function(e){e.style.cssText="position:absolute;left:0;top:0;width:1px;height:1px;",e.coordsize=nk+","+nk,e.coordorigin="0,0"},ok=function(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;")},ak=function(e,t,n){return"rgb("+[e,t,n].join(",")+")"},sk=function(e,t){t&&e&&t.parentNode!==e&&e.appendChild(t)},lk=function(e,t){t&&e&&t.parentNode===e&&e.removeChild(t)},ck=function(e,t,n){return 1e5*(parseFloat(e)||0)+1e3*(parseFloat(t)||0)+n},uk=function(e,t){return"string"==typeof e?e.lastIndexOf("%")>=0?parseFloat(e)/100*t:parseFloat(e):e},dk=function(e,t,n){var i=Mt(t);n=+n,isNaN(n)&&(n=1),i&&(e.color=ak(i[0],i[1],i[2]),e.opacity=n*i[3])},hk=function(e){var t=Mt(e);return[ak(t[0],t[1],t[2]),t[3]]},pk=function(e,t,n){var i=t.fill;if(null!=i)if(i instanceof xb){var r,o=0,a=[0,0],s=0,l=1,c=n.getBoundingRect(),u=c.width,d=c.height;if("linear"===i.type){r="gradient";var h=n.transform,p=[i.x*u,i.y*d],f=[i.x2*u,i.y2*d];h&&($(p,p,h),$(f,f,h));var g=f[0]-p[0],m=f[1]-p[1];(o=180*Math.atan2(g,m)/Math.PI)<0&&(o+=360),o<1e-6&&(o=0)}else{r="gradientradial";var p=[i.x*u,i.y*d],h=n.transform,v=n.scale,_=u,y=d;a=[(p[0]-c.x)/_,(p[1]-c.y)/y],h&&$(p,p,h),_/=v[0]*nk,y/=v[1]*nk;var x=tk(_,y);s=0/x,l=2*i.r/x-s}var b=i.colorStops.slice();b.sort(function(e,t){return e.offset-t.offset});for(var w=b.length,C=[],S=[],T=0;T<w;T++){var A=b[T],M=hk(A.color);S.push(A.offset*l+s+" "+M[0]),0!==T&&T!==w-1||C.push(M)}if(w>=2){var E=C[0][0],I=C[1][0],D=C[0][1]*t.opacity,k=C[1][1]*t.opacity;e.type=r,e.method="none",e.focus="100%",e.angle=o,e.color=E,e.color2=I,e.colors=S.join(","),e.opacity=k,e.opacity2=D}"radial"===r&&(e.focusposition=a.join(","))}else dk(e,i,t.opacity)},fk=function(e,t){null!=t.lineDash&&(e.dashstyle=t.lineDash.join(" ")),null==t.stroke||t.stroke instanceof xb||dk(e,t.stroke,t.opacity)},gk=function(e,t,n,i){var r="fill"==t,o=e.getElementsByTagName(t)[0];null!=n[t]&&"none"!==n[t]&&(r||!r&&n.lineWidth)?(e[r?"filled":"stroked"]="true",n[t]instanceof xb&&lk(e,o),o||(o=cv(t)),r?pk(o,n,i):fk(o,n),sk(e,o)):(e[r?"filled":"stroked"]="false",lk(e,o))},mk=[[],[],[]],vk=function(e,t){var n,i,r,o,a,s,l=XD.M,c=XD.C,u=XD.L,d=XD.A,h=XD.Q,p=[],f=e.data,g=e.len();for(o=0;o<g;){switch(r=f[o++],i="",n=0,r){case l:i=" m ",n=1,a=f[o++],s=f[o++],mk[0][0]=a,mk[0][1]=s;break;case u:i=" l ",n=1,a=f[o++],s=f[o++],mk[0][0]=a,mk[0][1]=s;break;case h:case c:i=" c ",n=3;var m,v,_=f[o++],y=f[o++],x=f[o++],b=f[o++];r===h?(m=x,v=b,x=(x+2*_)/3,b=(b+2*y)/3,_=(a+2*_)/3,y=(s+2*y)/3):(m=f[o++],v=f[o++]),mk[0][0]=_,mk[0][1]=y,mk[1][0]=x,mk[1][1]=b,mk[2][0]=m,mk[2][1]=v,a=m,s=v;break;case d:var w=0,C=0,S=1,T=1,A=0;t&&(w=t[4],C=t[5],S=KD(t[0]*t[0]+t[1]*t[1]),T=KD(t[2]*t[2]+t[3]*t[3]),A=Math.atan2(-t[1]/T,t[0]/S));var M=f[o++],E=f[o++],I=f[o++],D=f[o++],k=f[o++]+A,L=f[o++]+k+A;o++;var N=f[o++],P=M+QD(k)*I,O=E+ek(k)*D,_=M+QD(L)*I,y=E+ek(L)*D,R=N?" wa ":" at ";Math.abs(P-_)<1e-4&&(Math.abs(L-k)>.01?N&&(P+=.0125):Math.abs(O-E)<1e-4?N&&P<M||!N&&P>M?y-=.0125:y+=.0125:N&&O<E||!N&&O>E?_+=.0125:_-=.0125),p.push(R,ZD(((M-I)*S+w)*nk-ik),",",ZD(((E-D)*T+C)*nk-ik),",",ZD(((M+I)*S+w)*nk-ik),",",ZD(((E+D)*T+C)*nk-ik),",",ZD((P*S+w)*nk-ik),",",ZD((O*T+C)*nk-ik),",",ZD((_*S+w)*nk-ik),",",ZD((y*T+C)*nk-ik)),a=_,s=y;break;case XD.R:var z=mk[0],F=mk[1];z[0]=f[o++],z[1]=f[o++],F[0]=z[0]+f[o++],F[1]=z[1]+f[o++],t&&($(z,z,t),$(F,F,t)),z[0]=ZD(z[0]*nk-ik),F[0]=ZD(F[0]*nk-ik),z[1]=ZD(z[1]*nk-ik),F[1]=ZD(F[1]*nk-ik),p.push(" m ",z[0],",",z[1]," l ",F[0],",",z[1]," l ",F[0],",",F[1]," l ",z[0],",",F[1]);break;case XD.Z:p.push(" x ")}if(n>0){p.push(i);for(var B=0;B<n;B++){var H=mk[B];t&&$(H,H,t),p.push(ZD(H[0]*nk-ik),",",ZD(H[1]*nk-ik),B<n-1?",":"")}}}return p.join("")};Nn.prototype.brushVML=function(e){var t=this.style,n=this._vmlEl;n||(n=cv("shape"),rk(n),this._vmlEl=n),gk(n,"fill",t,this),gk(n,"stroke",t,this);var i=this.transform,r=null!=i,o=n.getElementsByTagName("stroke")[0];if(o){var a=t.lineWidth;if(r&&!t.strokeNoScale){var s=i[0]*i[3]-i[1]*i[2];a*=KD(JD(s))}o.weight=a+"px"}var l=this.path||(this.path=new Px);this.__dirtyPath&&(l.beginPath(),this.buildPath(l,this.shape),l.toStatic(),this.__dirtyPath=!1),n.path=vk(l,this.transform),n.style.zIndex=ck(this.zlevel,this.z,this.z2),sk(e,n),null!=t.text?this.drawRectText(e,this.getBoundingRect()):this.removeRectText(e)},Nn.prototype.onRemove=function(e){lk(e,this._vmlEl),this.removeRectText(e)},Nn.prototype.onAdd=function(e){sk(e,this._vmlEl),this.appendRectText(e)};var _k=function(e){return"object"==typeof e&&e.tagName&&"IMG"===e.tagName.toUpperCase()};qe.prototype.brushVML=function(e){var t,n,i=this.style,r=i.image;if(_k(r)){var o=r.src;if(o===this._imageSrc)t=this._imageWidth,n=this._imageHeight;else{var a=r.runtimeStyle,s=a.width,l=a.height;a.width="auto",a.height="auto",t=r.width,n=r.height,a.width=s,a.height=l,this._imageSrc=o,this._imageWidth=t,this._imageHeight=n}r=o}else r===this._imageSrc&&(t=this._imageWidth,n=this._imageHeight);if(r){var c=i.x||0,u=i.y||0,d=i.width,h=i.height,p=i.sWidth,f=i.sHeight,g=i.sx||0,m=i.sy||0,v=p&&f,_=this._vmlEl;_||(_=YD.createElement("div"),rk(_),this._vmlEl=_);var y,x=_.style,b=!1,w=1,C=1;if(this.transform&&(y=this.transform,w=KD(y[0]*y[0]+y[1]*y[1]),C=KD(y[2]*y[2]+y[3]*y[3]),b=y[1]||y[2]),b){var S=[c,u],T=[c+d,u],A=[c,u+h],M=[c+d,u+h];$(S,S,y),$(T,T,y),$(A,A,y),$(M,M,y);var E=tk(S[0],T[0],A[0],M[0]),I=tk(S[1],T[1],A[1],M[1]),D=[];D.push("M11=",y[0]/w,",","M12=",y[2]/C,",","M21=",y[1]/w,",","M22=",y[3]/C,",","Dx=",ZD(c*w+y[4]),",","Dy=",ZD(u*C+y[5])),x.padding="0 "+ZD(E)+"px "+ZD(I)+"px 0",x.filter="progid:DXImageTransform.Microsoft.Matrix("+D.join("")+", SizingMethod=clip)"}else y&&(c=c*w+y[4],u=u*C+y[5]),x.filter="",x.left=ZD(c)+"px",x.top=ZD(u)+"px";var k=this._imageEl,L=this._cropEl;k||(k=YD.createElement("div"),this._imageEl=k);var N=k.style;if(v){if(t&&n)N.width=ZD(w*t*d/p)+"px",N.height=ZD(C*n*h/f)+"px";else{var P=new Image,O=this;P.onload=function(){P.onload=null,t=P.width,n=P.height,N.width=ZD(w*t*d/p)+"px",N.height=ZD(C*n*h/f)+"px",O._imageWidth=t,O._imageHeight=n,O._imageSrc=r},P.src=r}L||((L=YD.createElement("div")).style.overflow="hidden",this._cropEl=L);var R=L.style;R.width=ZD((d+g*d/p)*w),R.height=ZD((h+m*h/f)*C),R.filter="progid:DXImageTransform.Microsoft.Matrix(Dx="+-g*d/p*w+",Dy="+-m*h/f*C+")",L.parentNode||_.appendChild(L),k.parentNode!=L&&L.appendChild(k)}else N.width=ZD(w*d)+"px",N.height=ZD(C*h)+"px",_.appendChild(k),L&&L.parentNode&&(_.removeChild(L),this._cropEl=null);var z="",F=i.opacity;F<1&&(z+=".Alpha(opacity="+ZD(100*F)+") "),z+="progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+r+", SizingMethod=scale)",N.filter=z,_.style.zIndex=ck(this.zlevel,this.z,this.z2),sk(e,_),null!=i.text&&this.drawRectText(e,this.getBoundingRect())}},qe.prototype.onRemove=function(e){lk(e,this._vmlEl),this._vmlEl=null,this._cropEl=null,this._imageEl=null,this.removeRectText(e)},qe.prototype.onAdd=function(e){sk(e,this._vmlEl),this.appendRectText(e)};var yk,xk={},bk=0,wk=document.createElement("div"),Ck=function(e){var t=xk[e];if(!t){bk>100&&(bk=0,xk={});var n,i=wk.style;try{i.font=e,n=i.fontFamily.split(",")[0]}catch(e){}t={style:i.fontStyle||"normal",variant:i.fontVariant||"normal",weight:i.fontWeight||"normal",size:0|parseFloat(i.fontSize||12),family:n||"Microsoft YaHei"},xk[e]=t,bk++}return t};!function(e,t){py.measureText=t}(0,function(e,t){var n=YD;yk||((yk=n.createElement("div")).style.cssText="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;",YD.body.appendChild(yk));try{yk.style.font=t}catch(e){}return yk.innerHTML="",yk.appendChild(n.createTextNode(e)),{width:yk.offsetWidth}});for(var Sk=new jt,Tk=[vy,je,qe,Nn,rb],Ak=0;Ak<Tk.length;Ak++){var Mk=Tk[Ak].prototype;Mk.drawRectText=function(e,t,n,i){var r=this.style;this.__dirty&&De(r);var o=r.text;if(null!=o&&(o+=""),o){if(r.rich){var a=Ie(o,r);o=[];for(var s=0;s<a.lines.length;s++){for(var l=a.lines[s].tokens,c=[],u=0;u<l.length;u++)c.push(l[u].text);o.push(c.join(""))}o=o.join("\n")}var d,h,p=r.textAlign,f=r.textVerticalAlign,g=Ck(r.font),m=g.style+" "+g.variant+" "+g.weight+" "+g.size+'px "'+g.family+'"';n=n||de(o,m,p,f);var v=this.transform;if(v&&!i&&(Sk.copy(t),Sk.applyTransform(v),t=Sk),i)d=t.x,h=t.y;else{var _=r.textPosition,y=r.textDistance;if(_ instanceof Array)d=t.x+uk(_[0],t.width),h=t.y+uk(_[1],t.height),p=p||"left";else{var x=ve(_,t,y);d=x.x,h=x.y,p=p||x.textAlign,f=f||x.textVerticalAlign}}d=ge(d,n.width,p),h=me(h,n.height,f),h+=n.height/2;var b,w,C,S=cv,T=this._textVmlEl;T?w=(b=(C=T.firstChild).nextSibling).nextSibling:(T=S("line"),b=S("path"),w=S("textpath"),C=S("skew"),w.style["v-text-align"]="left",rk(T),b.textpathok=!0,w.on=!0,T.from="0 0",T.to="1000 0.05",sk(T,C),sk(T,b),sk(T,w),this._textVmlEl=T);var A=[d,h],M=T.style;v&&i?($(A,A,v),C.on=!0,C.matrix=v[0].toFixed(3)+","+v[2].toFixed(3)+","+v[1].toFixed(3)+","+v[3].toFixed(3)+",0,0",C.offset=(ZD(A[0])||0)+","+(ZD(A[1])||0),C.origin="0 0",M.left="0px",M.top="0px"):(C.on=!1,M.left=ZD(d)+"px",M.top=ZD(h)+"px"),w.string=ok(o);try{w.style.font=m}catch(e){}gk(T,"fill",{fill:r.textFill,opacity:r.opacity},this),gk(T,"stroke",{stroke:r.textStroke,opacity:r.opacity,lineDash:r.lineDash},this),T.style.zIndex=ck(this.zlevel,this.z,this.z2),sk(e,T)}},Mk.removeRectText=function(e){lk(e,this._textVmlEl),this._textVmlEl=null},Mk.appendRectText=function(e){sk(e,this._textVmlEl)}}rb.prototype.brushVML=function(e){var t=this.style;null!=t.text?this.drawRectText(e,{x:t.x||0,y:t.y||0,width:0,height:0},this.getBoundingRect(),!0):this.removeRectText(e)},rb.prototype.onRemove=function(e){this.removeRectText(e)},rb.prototype.onAdd=function(e){this.appendRectText(e)}}pv.prototype={constructor:pv,getType:function(){return"vml"},getViewportRoot:function(){return this._vmlViewport},getViewportRootOffset:function(){var e=this.getViewportRoot();if(e)return{offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}},refresh:function(){var e=this.storage.getDisplayList(!0,!0);this._paintList(e)},_paintList:function(e){for(var t=this._vmlRoot,n=0;n<e.length;n++){var i=e[n];i.invisible||i.ignore?(i.__alreadyNotVisible||i.onRemove(t),i.__alreadyNotVisible=!0):(i.__alreadyNotVisible&&i.onAdd(t),i.__alreadyNotVisible=!1,i.__dirty&&(i.beforeBrush&&i.beforeBrush(),(i.brushVML||i.brush).call(i,t),i.afterBrush&&i.afterBrush())),i.__dirty=!1}this._firstPaint&&(this._vmlViewport.appendChild(t),this._firstPaint=!1)},resize:function(e,t){var e=null==e?this._getWidth():e,t=null==t?this._getHeight():t;if(this._width!=e||this._height!=t){this._width=e,this._height=t;var n=this._vmlViewport.style;n.width=e+"px",n.height=t+"px"}},dispose:function(){this.root.innerHTML="",this._vmlRoot=this._vmlViewport=this.storage=null},getWidth:function(){return this._width},getHeight:function(){return this._height},clear:function(){this._vmlViewport&&this.root.removeChild(this._vmlViewport)},_getWidth:function(){var e=this.root,t=e.currentStyle;return(e.clientWidth||fv(t.width))-fv(t.paddingLeft)-fv(t.paddingRight)|0},_getHeight:function(){var e=this.root,t=e.currentStyle;return(e.clientHeight||fv(t.height))-fv(t.paddingTop)-fv(t.paddingBottom)|0}},d(["getLayer","insertLayer","eachLayer","eachBuiltinLayer","eachOtherLayer","getLayers","modLayer","delLayer","clearLayer","toDataURL","pathToImage"],function(e){pv.prototype[e]=gv(e)}),xi("vml",pv);var Ek="http://www.w3.org/2000/svg",Ik=Px.CMD,Dk=Array.prototype.join,kk="none",Lk=Math.round,Nk=Math.sin,Pk=Math.cos,Ok=Math.PI,Rk=2*Math.PI,zk=180/Ok,Fk=1e-4,Bk={};Bk.brush=function(e){var t=e.style,n=e.__svgEl;n||(n=mv("path"),e.__svgEl=n),e.path||e.createPathProxy();var i=e.path;if(e.__dirtyPath){i.beginPath(),e.buildPath(i,e.shape),e.__dirtyPath=!1;var r=Iv(i);r.indexOf("NaN")<0&&wv(n,"d",r)}Mv(n,t),bv(n,e.transform),null!=t.text&&Uk(e,e.getBoundingRect())};var Hk={};Hk.brush=function(e){var t=e.style,n=t.image;if(n instanceof HTMLImageElement&&(n=n.src),n){var i=t.x||0,r=t.y||0,o=t.width,a=t.height,s=e.__svgEl;s||(s=mv("image"),e.__svgEl=s),n!==e.__imageSrc&&(Sv(s,"href",n),e.__imageSrc=n),wv(s,"width",o),wv(s,"height",a),wv(s,"x",i),wv(s,"y",r),bv(s,e.transform),null!=t.text&&Uk(e,e.getBoundingRect())}};var Vk={},Wk=new jt,Uk=function(e,t,n){var i=e.style;e.__dirty&&De(i);var r=i.text;if(null!=r){r+="";var o=e.__textSvgEl;if(o||(o=mv("text"),e.__textSvgEl=o),Mv(o,i,!0),e instanceof rb||e.style.transformText)bv(o,e.transform);else if(e.transform)Wk.copy(t),Wk.applyTransform(e.transform),t=Wk;else{var a=e.transformCoordToGlobal(t.x,t.y);t.x=a[0],t.y=a[1]}var s,l,c=i.textPosition,u=i.textDistance,d=i.textAlign||"left";"number"==typeof i.fontSize&&(i.fontSize+="px");var h=i.font||[i.fontStyle||"",i.fontWeight||"",i.fontSize||"",i.fontFamily||""].join(" ")||hy,p=Tv(i.textVerticalAlign),f=(n=de(r,h,d,p)).lineHeight;if(c instanceof Array)s=t.x+c[0],l=t.y+c[1];else{var g=ve(c,t,u);s=g.x,l=g.y,p=Tv(g.textVerticalAlign),d=g.textAlign}wv(o,"alignment-baseline",p),h&&(o.style.font=h);var m=i.textPadding;wv(o,"x",s),wv(o,"y",l);var v=r.split("\n"),_=v.length,y=d;"left"===y?(y="start",m&&(s+=m[3])):"right"===y?(y="end",m&&(s-=m[1])):"center"===y&&(y="middle",m&&(s+=(m[3]-m[1])/2));var x=0;if("baseline"===p?(x=-n.height+f,m&&(x-=m[2])):"middle"===p?(x=(-n.height+f)/2,m&&(l+=(m[0]-m[2])/2)):m&&(x+=m[0]),e.__text!==r||e.__textFont!==h){var b=e.__tspanList||[];for(e.__tspanList=b,C=0;C<_;C++)(S=b[C])?S.innerHTML="":(S=b[C]=mv("tspan"),o.appendChild(S),wv(S,"alignment-baseline",p),wv(S,"text-anchor",y)),wv(S,"x",s),wv(S,"y",l+C*f+x),S.appendChild(document.createTextNode(v[C]));for(;C<b.length;C++)o.removeChild(b[C]);b.length=_,e.__text=r,e.__textFont=h}else if(e.__tspanList.length)for(var w=e.__tspanList.length,C=0;C<w;++C){var S=e.__tspanList[C];S&&(wv(S,"x",s),wv(S,"y",l+C*f+x))}}};Vk.drawRectText=Uk,Vk.brush=function(e){var t=e.style;null!=t.text&&(t.textPosition=[0,0],Uk(e,{x:t.x||0,y:t.y||0,width:0,height:0},e.getBoundingRect()))},Av.prototype={diff:function(e,t,n){n||(n=function(e,t){return e===t}),this.equals=n;var i=this;e=e.slice();var r=(t=t.slice()).length,o=e.length,a=1,s=r+o,l=[{newPos:-1,components:[]}],c=this.extractCommon(l[0],t,e,0);if(l[0].newPos+1>=r&&c+1>=o){for(var u=[],d=0;d<t.length;d++)u.push(d);return[{indices:u,count:t.length}]}for(;a<=s;){var h=function(){for(var n=-1*a;n<=a;n+=2){var s,c=l[n-1],u=l[n+1],d=(u?u.newPos:0)-n;c&&(l[n-1]=void 0);var h=c&&c.newPos+1<r,p=u&&0<=d&&d<o;if(h||p){if(!h||p&&c.newPos<u.newPos?(s=Dv(u),i.pushComponent(s.components,void 0,!0)):((s=c).newPos++,i.pushComponent(s.components,!0,void 0)),d=i.extractCommon(s,t,e,n),s.newPos+1>=r&&d+1>=o)return Cv(0,s.components);l[n]=s}else l[n]=void 0}a++}();if(h)return h}},pushComponent:function(e,t,n){var i=e[e.length-1];i&&i.added===t&&i.removed===n?e[e.length-1]={count:i.count+1,added:t,removed:n}:e.push({count:1,added:t,removed:n})},extractCommon:function(e,t,n,i){for(var r=t.length,o=n.length,a=e.newPos,s=a-i,l=0;a+1<r&&s+1<o&&this.equals(t[a+1],n[s+1]);)a++,s++,l++;return l&&e.components.push({count:l}),e.newPos=a,s},tokenize:function(e){return e.slice()},join:function(e){return e.slice()}};var $k=new Av,Gk=function(e,t,n){return $k.diff(e,t,n)};Lv.prototype.createElement=mv,Lv.prototype.getDefs=function(e){var t=this._svgRoot,n=this._svgRoot.getElementsByTagName("defs");return 0===n.length?e?((n=t.insertBefore(this.createElement("defs"),t.firstChild)).contains||(n.contains=function(e){var t=n.children;if(!t)return!1;for(var i=t.length-1;i>=0;--i)if(t[i]===e)return!0;return!1}),n):null:n[0]},Lv.prototype.update=function(e,t){if(e){var n=this.getDefs(!1);if(e._dom&&n.contains(e._dom))"function"==typeof t&&t();else{var i=this.add(e);i&&(e._dom=i)}}},Lv.prototype.addDom=function(e){this.getDefs(!0).appendChild(e)},Lv.prototype.removeDom=function(e){this.getDefs(!1).removeChild(e._dom)},Lv.prototype.getDoms=function(){var e=this.getDefs(!1);if(!e)return[];var t=[];return d(this._tagNames,function(n){var i=e.getElementsByTagName(n);t=t.concat([].slice.call(i))}),t},Lv.prototype.markAllUnused=function(){var e=this;d(this.getDoms(),function(t){t[e._markLabel]="0"})},Lv.prototype.markUsed=function(e){e&&(e[this._markLabel]="1")},Lv.prototype.removeUnused=function(){var e=this.getDefs(!1);if(e){var t=this;d(this.getDoms(),function(n){"1"!==n[t._markLabel]&&e.removeChild(n)})}},Lv.prototype.getSvgProxy=function(e){return e instanceof Nn?Bk:e instanceof qe?Hk:e instanceof rb?Vk:Bk},Lv.prototype.getTextSvgElement=function(e){return e.__textSvgEl},Lv.prototype.getSvgElement=function(e){return e.__svgEl},h(kv,Lv),kv.prototype.addWithoutUpdate=function(e,t){if(t&&t.style){var n=this;d(["fill","stroke"],function(i){if(t.style[i]&&("linear"===t.style[i].type||"radial"===t.style[i].type)){var r,o=t.style[i],a=n.getDefs(!0);o._dom?(r=o._dom,a.contains(o._dom)||n.addDom(r)):r=n.add(o),n.markUsed(t);var s=r.getAttribute("id");e.setAttribute(i,"url(#"+s+")")}})}},kv.prototype.add=function(e){var t;if("linear"===e.type)t=this.createElement("linearGradient");else{if("radial"!==e.type)return U_("Illegal gradient type."),null;t=this.createElement("radialGradient")}return e.id=e.id||this.nextId++,t.setAttribute("id","zr-gradient-"+e.id),this.updateDom(e,t),this.addDom(t),t},kv.prototype.update=function(e){var t=this;Lv.prototype.update.call(this,e,function(){var n=e.type,i=e._dom.tagName;"linear"===n&&"linearGradient"===i||"radial"===n&&"radialGradient"===i?t.updateDom(e,e._dom):(t.removeDom(e),t.add(e))})},kv.prototype.updateDom=function(e,t){if("linear"===e.type)t.setAttribute("x1",e.x),t.setAttribute("y1",e.y),t.setAttribute("x2",e.x2),t.setAttribute("y2",e.y2);else{if("radial"!==e.type)return void U_("Illegal gradient type.");t.setAttribute("cx",e.x),t.setAttribute("cy",e.y),t.setAttribute("r",e.r)}e.global?t.setAttribute("gradientUnits","userSpaceOnUse"):t.setAttribute("gradientUnits","objectBoundingBox"),t.innerHTML="";for(var n=e.colorStops,i=0,r=n.length;i<r;++i){var o=this.createElement("stop");o.setAttribute("offset",100*n[i].offset+"%"),o.setAttribute("stop-color",n[i].color),t.appendChild(o)}e._dom=t},kv.prototype.markUsed=function(e){if(e.style){var t=e.style.fill;t&&t._dom&&Lv.prototype.markUsed.call(this,t._dom),(t=e.style.stroke)&&t._dom&&Lv.prototype.markUsed.call(this,t._dom)}},h(Pv,Lv),Pv.prototype.update=function(e){var t=this.getSvgElement(e);t&&this.updateDom(t,e.__clipPaths,!1);var n=this.getTextSvgElement(e);n&&this.updateDom(n,e.__clipPaths,!0),this.markUsed(e)},Pv.prototype.updateDom=function(e,t,n){if(t&&t.length>0){var i,r,o=this.getDefs(!0),a=t[0],s=n?"_textDom":"_dom";a[s]?(r=a[s].getAttribute("id"),i=a[s],o.contains(i)||o.appendChild(i)):(r="zr-clip-"+this.nextId,++this.nextId,(i=this.createElement("clipPath")).setAttribute("id",r),o.appendChild(i),a[s]=i);var l=this.getSvgProxy(a);if(a.transform&&a.parent.invTransform&&!n){var c=Array.prototype.slice.call(a.transform);st(a.transform,a.parent.invTransform,a.transform),l.brush(a),a.transform=c}else l.brush(a);var u=this.getSvgElement(a);i.appendChild(u.cloneNode()),e.setAttribute("clip-path","url(#"+r+")"),t.length>1&&this.updateDom(i,t.slice(1),n)}else e&&e.setAttribute("clip-path","none")},Pv.prototype.markUsed=function(e){var t=this;e.__clipPaths&&e.__clipPaths.length>0&&d(e.__clipPaths,function(e){e._dom&&Lv.prototype.markUsed.call(t,e._dom),e._textDom&&Lv.prototype.markUsed.call(t,e._textDom)})};var qk=function(e,t,n){this.root=e,this.storage=t,this._opts=n=a({},n||{});var i=mv("svg");i.setAttribute("xmlns","http://www.w3.org/2000/svg"),i.setAttribute("version","1.1"),i.setAttribute("baseProfile","full"),i.style["user-select"]="none",i.style.cssText="position:absolute;left:0;top:0;",this.gradientManager=new kv(i),this.clipPathManager=new Pv(i);var r=document.createElement("div");r.style.cssText="overflow:hidden;position:relative",this._svgRoot=i,this._viewport=r,e.appendChild(r),r.appendChild(i),this.resize(n.width,n.height),this._visibleList=[]};qk.prototype={constructor:qk,getType:function(){return"svg"},getViewportRoot:function(){return this._viewport},getViewportRootOffset:function(){var e=this.getViewportRoot();if(e)return{offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}},refresh:function(){var e=this.storage.getDisplayList(!0);this._paintList(e)},_paintList:function(e){this.gradientManager.markAllUnused(),this.clipPathManager.markAllUnused();var t,n=this._svgRoot,i=this._visibleList,r=e.length,o=[];for(t=0;t<r;t++){var a=zv(p=e[t]);p.invisible||(p.__dirty&&(a&&a.brush(p),this.clipPathManager.update(p),p.style&&(this.gradientManager.update(p.style.fill),this.gradientManager.update(p.style.stroke)),p.__dirty=!1),o.push(p))}var s,l=Gk(i,o);for(t=0;t<l.length;t++)if((d=l[t]).removed)for(h=0;h<d.count;h++){var c=Gv(p=i[d.indices[h]]),u=Bv(p);Vv(n,c),Vv(n,u)}for(t=0;t<l.length;t++){var d=l[t];if(d.added)for(h=0;h<d.count;h++){var c=Gv(p=o[d.indices[h]]),u=Bv(p);s?Ev(n,c,s):Rv(n,c),c?Ev(n,u,c):s?Ev(n,u,s):Rv(n,u),Ev(n,u,c),s=u||c||s,this.gradientManager.addWithoutUpdate(c,p),this.clipPathManager.markUsed(p)}else if(!d.removed)for(var h=0;h<d.count;h++){var p=o[d.indices[h]];s=c=Bv(p)||Gv(p)||s,this.gradientManager.markUsed(p),this.gradientManager.addWithoutUpdate(c,p),this.clipPathManager.markUsed(p)}}this.gradientManager.removeUnused(),this.clipPathManager.removeUnused(),this._visibleList=o},_getDefs:function(e){var t=this._svgRoot,n=this._svgRoot.getElementsByTagName("defs");return 0===n.length?e?((n=t.insertBefore(mv("defs"),t.firstChild)).contains||(n.contains=function(e){var t=n.children;if(!t)return!1;for(var i=t.length-1;i>=0;--i)if(t[i]===e)return!0;return!1}),n):null:n[0]},resize:function(e,t){var n=this._viewport;n.style.display="none";var i=this._opts;if(null!=e&&(i.width=e),null!=t&&(i.height=t),e=this._getSize(0),t=this._getSize(1),n.style.display="",this._width!==e&&this._height!==t){this._width=e,this._height=t;var r=n.style;r.width=e+"px",r.height=t+"px";var o=this._svgRoot;o.setAttribute("width",e),o.setAttribute("height",t)}},getWidth:function(){return this._width},getHeight:function(){return this._height},_getSize:function(e){var t=this._opts,n=["width","height"][e],i=["clientWidth","clientHeight"][e],r=["paddingLeft","paddingTop"][e],o=["paddingRight","paddingBottom"][e];if(null!=t[n]&&"auto"!==t[n])return parseFloat(t[n]);var a=this.root,s=document.defaultView.getComputedStyle(a);return(a[i]||Ov(s[n])||Ov(a.style[n]))-(Ov(s[r])||0)-(Ov(s[o])||0)|0},dispose:function(){this.root.innerHTML="",this._svgRoot=this._viewport=this.storage=null},clear:function(){this._viewport&&this.root.removeChild(this._viewport)},pathToSvg:function(){this.refresh();var e=this._svgRoot.outerHTML;return"data:img/svg+xml;utf-8,"+unescape(e)}},d(["getLayer","insertLayer","eachLayer","eachBuiltinLayer","eachOtherLayer","getLayers","modLayer","delLayer","clearLayer","toDataURL","pathToImage"],function(e){qk.prototype[e]=Wv(e)}),xi("svg",qk),Hv.version="3.8.5",Hv.dependencies=Dw,Hv.PRIORITY=Pw,Hv.init=function(e,t,n){var i=Qa(e);if(i)return i;var r=new za(e,t,n);return r.id="ec_"+Kw++,Xw[r.id]=r,e.setAttribute?e.setAttribute(Qw,r.id):e[Qw]=r.id,Ka(r),r},Hv.connect=function(e){if(y(e)){var t=e;e=null,d(t,function(t){null!=t.group&&(e=t.group)}),e=e||"g_"+Jw++,d(t,function(t){t.group=e})}return Zw[e]=!0,e},Hv.disConnect=Ja,Hv.disconnect=tC,Hv.dispose=function(e){"string"==typeof e?e=Xw[e]:e instanceof za||(e=Qa(e)),e instanceof za&&!e.isDisposed()&&e.dispose()},Hv.getInstanceByDom=Qa,Hv.getInstanceById=function(e){return Xw[e]},Hv.registerTheme=function(e,t){jw[e]=t},Hv.registerPreprocessor=tr,Hv.registerProcessor=er,Hv.registerPostUpdate=function(e){Gw.push(e)},Hv.registerAction=ir,Hv.registerCoordinateSystem=nr,Hv.getCoordinateSystemDimensions=function(e){var t=ua.get(e);if(t)return t.getDimensionsInfo?t.getDimensionsInfo():t.dimensions.slice()},Hv.registerLayout=or,Hv.registerVisual=ar,Hv.registerLoading=rr,Hv.extendComponentModel=sr,Hv.extendComponentView=lr,Hv.extendSeriesModel=hr,Hv.extendChartView=ur,Hv.setCanvasCreator=function(t){e("createCanvas",t)},Hv.registerMap=function(e,t,n){t.geoJson&&!t.features&&(n=t.specialAreas,t=t.geoJson),"string"==typeof t&&(t="undefined"!=typeof JSON&&JSON.parse?JSON.parse(t):new Function("return ("+t+");")()),eC[e]={geoJson:t,specialAreas:n}},Hv.getMap=cr,Hv.dataTool=nC,Hv.zrender=zy,Hv.graphic=Eb,Hv.number=Vy,Hv.format=Yy,Hv.throttle=Da,Hv.helper=$C,Hv.matrix=x_,Hv.vector=p_,Hv.color=z_,Hv.util=ZC,Hv.List=sC,Hv.Model=Lo,Hv.Axis=jC,Hv.env=jv,Hv.parseGeoJson=XC})}).call(t,n(150))},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(2)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.ui.safeActiveElement=function(e){var t;try{t=e.activeElement}catch(n){t=e.body}return t||(t=e.body),t.nodeName||(t=e.body),t}})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(59),n(2),n(5)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){var t=!1;return e(document).on("mouseup",function(){t=!1}),e.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.on("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).on("click."+this.widgetName,function(n){if(!0===e.data(n.target,t.widgetName+".preventClickEvent"))return e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(n){if(!t){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(n),this._mouseDownEvent=n;var i=this,r=1===n.which,o=!("string"!=typeof this.options.cancel||!n.target.nodeName)&&e(n.target).closest(this.options.cancel).length;return!(r&&!o&&this._mouseCapture(n))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(n)&&this._mouseDelayMet(n)&&(this._mouseStarted=!1!==this._mouseStart(n),!this._mouseStarted)?(n.preventDefault(),!0):(!0===e.data(n.target,this.widgetName+".preventClickEvent")&&e.removeData(n.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),n.preventDefault(),t=!0,!0))}},_mouseMove:function(t){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button)return this._mouseUp(t);if(!t.which)if(t.originalEvent.altKey||t.originalEvent.ctrlKey||t.originalEvent.metaKey||t.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,t),this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(n){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,n.target===this._mouseDownEvent.target&&e.data(n.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(n)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,t=!1,n.preventDefault()},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})},function(e,t,n){var i,r;i=[],void 0!==(r=function(){function md5cycle(e,t){var n=e[0],i=e[1],r=e[2],o=e[3];n=ff(n,i,r,o,t[0],7,-680876936),o=ff(o,n,i,r,t[1],12,-389564586),r=ff(r,o,n,i,t[2],17,606105819),i=ff(i,r,o,n,t[3],22,-1044525330),n=ff(n,i,r,o,t[4],7,-176418897),o=ff(o,n,i,r,t[5],12,1200080426),r=ff(r,o,n,i,t[6],17,-1473231341),i=ff(i,r,o,n,t[7],22,-45705983),n=ff(n,i,r,o,t[8],7,1770035416),o=ff(o,n,i,r,t[9],12,-1958414417),r=ff(r,o,n,i,t[10],17,-42063),i=ff(i,r,o,n,t[11],22,-1990404162),n=ff(n,i,r,o,t[12],7,1804603682),o=ff(o,n,i,r,t[13],12,-40341101),r=ff(r,o,n,i,t[14],17,-1502002290),i=ff(i,r,o,n,t[15],22,1236535329),n=gg(n,i,r,o,t[1],5,-165796510),o=gg(o,n,i,r,t[6],9,-1069501632),r=gg(r,o,n,i,t[11],14,643717713),i=gg(i,r,o,n,t[0],20,-373897302),n=gg(n,i,r,o,t[5],5,-701558691),o=gg(o,n,i,r,t[10],9,38016083),r=gg(r,o,n,i,t[15],14,-660478335),i=gg(i,r,o,n,t[4],20,-405537848),n=gg(n,i,r,o,t[9],5,568446438),o=gg(o,n,i,r,t[14],9,-1019803690),r=gg(r,o,n,i,t[3],14,-187363961),i=gg(i,r,o,n,t[8],20,1163531501),n=gg(n,i,r,o,t[13],5,-1444681467),o=gg(o,n,i,r,t[2],9,-51403784),r=gg(r,o,n,i,t[7],14,1735328473),i=gg(i,r,o,n,t[12],20,-1926607734),n=hh(n,i,r,o,t[5],4,-378558),o=hh(o,n,i,r,t[8],11,-2022574463),r=hh(r,o,n,i,t[11],16,1839030562),i=hh(i,r,o,n,t[14],23,-35309556),n=hh(n,i,r,o,t[1],4,-1530992060),o=hh(o,n,i,r,t[4],11,1272893353),r=hh(r,o,n,i,t[7],16,-155497632),i=hh(i,r,o,n,t[10],23,-1094730640),n=hh(n,i,r,o,t[13],4,681279174),o=hh(o,n,i,r,t[0],11,-358537222),r=hh(r,o,n,i,t[3],16,-722521979),i=hh(i,r,o,n,t[6],23,76029189),n=hh(n,i,r,o,t[9],4,-640364487),o=hh(o,n,i,r,t[12],11,-421815835),r=hh(r,o,n,i,t[15],16,530742520),i=hh(i,r,o,n,t[2],23,-995338651),n=ii(n,i,r,o,t[0],6,-198630844),o=ii(o,n,i,r,t[7],10,1126891415),r=ii(r,o,n,i,t[14],15,-1416354905),i=ii(i,r,o,n,t[5],21,-57434055),n=ii(n,i,r,o,t[12],6,1700485571),o=ii(o,n,i,r,t[3],10,-1894986606),r=ii(r,o,n,i,t[10],15,-1051523),i=ii(i,r,o,n,t[1],21,-2054922799),n=ii(n,i,r,o,t[8],6,1873313359),o=ii(o,n,i,r,t[15],10,-30611744),r=ii(r,o,n,i,t[6],15,-1560198380),i=ii(i,r,o,n,t[13],21,1309151649),n=ii(n,i,r,o,t[4],6,-145523070),o=ii(o,n,i,r,t[11],10,-1120210379),r=ii(r,o,n,i,t[2],15,718787259),i=ii(i,r,o,n,t[9],21,-343485551),e[0]=add32(n,e[0]),e[1]=add32(i,e[1]),e[2]=add32(r,e[2]),e[3]=add32(o,e[3])}function cmn(e,t,n,i,r,o){return t=add32(add32(t,e),add32(i,o)),add32(t<<r|t>>>32-r,n)}function ff(e,t,n,i,r,o,a){return cmn(t&n|~t&i,e,t,r,o,a)}function gg(e,t,n,i,r,o,a){return cmn(t&i|n&~i,e,t,r,o,a)}function hh(e,t,n,i,r,o,a){return cmn(t^n^i,e,t,r,o,a)}function ii(e,t,n,i,r,o,a){return cmn(n^(t|~i),e,t,r,o,a)}function md51(e){txt="";var t,n=e.length,i=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)md5cycle(i,md5blk(e.substring(t-64,t)));e=e.substring(t-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)r[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(r[t>>2]|=128<<(t%4<<3),t>55)for(md5cycle(i,r),t=0;t<16;t++)r[t]=0;return r[14]=8*n,md5cycle(i,r),i}function md5blk(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function rhex(t){for(var n="",i=0;i<4;i++)n+=e[t>>8*i+4&15]+e[t>>8*i&15];return n}function hex(e){for(var t=0;t<e.length;t++)e[t]=rhex(e[t]);return e.join("")}function md5(e){return hex(md51(e))}function add32(e,t){return e+t&4294967295}var e="0123456789abcdef".split("");if("5d41402abc4b2a76b9719d911017c592"!=md5("hello"));return{md5:md5}}.apply(t,i))&&(e.exports=r)},function(e,t,n){(function(i,r){var o,a;o=[n(1),n(8),n(17),n(6),n(7),n(4),n(3)],void 0!==(a=function(e,t,r,o,a,s,l){function setEditStatus(e){$=e}function getEditStatus(){return $}function editAdd(){if(!getEditStatus()){var t={processName:he(),owner:ge()},n=e.genApiUrl("process/edit"),r=function(t){s.success(i.i18n.prop("OP_EDIT_Enter"),"",e.toastrConfig),setEditStatus(!0)},o=function(t){s.info(t,"ajax error",e.toastrConfig)};a.get(n,t,r,o)}}function setExperimentFlag(e){Ae=e}function getExperimentFlag(){return Ae}var c,u,d,h,p,f=e.mx,g=null,m={},v="",_=!1,y={params:{},connects:[]},x=function(e){g=e},b=function(){return g},w=function(e){return void 0!==ae(e)},C=function(e){for(var t=0,n=e||"undefined";w(n);)n=e+"("+ ++t+")";return n},S=function(e){for(var t=1,n=e||"1";w(n);)n=String(++t);return n},T=function(e){return o.keys(m).some(function(t){return m[t].description===e})},A=function(e){for(var t=0,n=e||"undefined";T(n);)n=e+"("+ ++t+")";return n},M=function(e){m[e.id]=e},E=function(e){delete m[e]},I=function(){var e=[];return o.values(m).forEach(function(t){t.multiPort&&e.push(g.getModel().getCell(t.id))}),e},D=function(e){return m[e].params},k=function(e,t){var n=[];return e&&e.children&&e.children.forEach(function(e){!e.isEdge()&&e.value.isPort&&e.value.portType===t&&n.push(e)}),n},L=function(e){return k(e,t.PORT_OUTPUT_TYPE)},N=function(e){e.getEdgeCount()>0&&e.edges.forEach(function(t){t.target.value.data=e.value.data})},P=function(e){if(!o.isString(e))return"";if(e.startsWith("{")){var t,n=JSON.parse(e),r=n.key,a=n.params;return(t=i.i18n).prop.apply(t,[r].concat(a))}var s,r=e;if(e.indexOf("␟")>=0){var s=e.split("␟");r=s.splice(0,1)[0]}var l=o.isEmpty(s)?i.i18n.prop(r):i.i18n.prop(r,s);return l.startsWith("[")?e:l},O=function(e){if(e&&(!e.hasOwnProperty("status")||"-1"!==e.status)){var r;e.forEach(function(e){var o=e.name,a=se(g,o);if(a){if(a.value.iterations=e.iterations,g.removeCellOverlays(a),e.status===t.STATUS_FAIL)a.value.status={icon:"fa fa-times-circle",msg:P(e.errorMsg),type:"failed"};else if(e.status===t.STATUS_SUCCESS)a.value.status={icon:"fa fa-check-circle",msg:i.i18n.prop("ict_oneminer_status_exec_success"),type:"success"};else if(e.status===t.STATUS_STOP)a.value.status={icon:"fa fa-ban",msg:i.i18n.prop("ict_oneminer_status_exec_stop"),type:"stop"};else if(e.status===t.STATUS_RUNNING){var s=new f.mxPoint(-15,0),l=new f.mxCellOverlay(new f.mxImage(n(133),18,18),i.i18n.prop("ict_oneminer_status_exec_running"),"right","middle",s,"default");g.addCellOverlay(a,l),a.value.status={icon:"fa fa-spinner",msg:i.i18n.prop("ict_oneminer_status_exec_running"),type:"running"}}else e.status===t.STATUS_WAITING?a.value.status={icon:"fa fa-clock-o",msg:i.i18n.prop("ict_oneminer_status_exec_waiting"),type:"waiting"}:e.status===t.STATUS_WAIT_RESOURCE?a.value.status={icon:"fa fa-clock-o",msg:i.i18n.prop("ict_oneminer_status_exec_waiting_resource"),type:"wait-resource"}:e.status===t.STATUS_MEDIUM?a.value.status={icon:"fa fa-dot-circle-o",msg:P(e.errorMsg),type:"medium"}:e.status===t.STATUS_EMPTY?a.value.status={}:e.status===t.STATUS_WARNING&&(a.value.status={icon:"fa fa-exclamation-circle",msg:P(e.errorMsg),type:"warning"});var c=e.portMetaDataList;c&&Array.isArray(c)||(c=[]),r=L(a),r.forEach(function(e){var t=e.value.name,n=!1;c.some(function(i){if(t===i.operatorPort)return e.value.data=i,N(e),n=!0,!0}),n||(e.value.data=null,N(e))})}}),g.refresh()}},R=function(){},z=function(e){R=e},F=function(){return c},B=function(e){c=e},H=function(){return u||"/0000000000000000000000000"},V=function(e){u=e},W=function(){d=setInterval(function(){var n=ie(),r=n.operators,o=r.filter(function(e){return se(g,e.name).value.operatorExecType==t.ZAIPENTRANCE});0!==o.length?o.forEach(function(t){var n=i('.zaipBox [title="'+t.name+'"]').parents(".zaipBox"),r=se(g,t.name),o=r.value.isDrag?{CANCELLED:0,DONE:0,FAILED:0,QUEUED:0,RUNNING:0}:e.getZaipRunStatus(he(),r.value.initName,Ae);for(var a in o){var s=a.toLowerCase();n.find(".status-"+s).html(o[a])}r.value.runStatus=o,n.find(".train-more").data(o)}):clearInterval(d)},t.SETTIMEOUT_TIME)},U=function(){var t={processName:he(),owner:ge()};a.del(e.genApiUrl("process/stopEdit"),t,function(e){setEditStatus(!1)},function(e){})},$=!1,G=function(){if(getEditStatus())return!0;var t=e.doGet(e.genApiUrl("process/canEdit?processName="+v+"&owner="+p));return!!t&&"true"===t.edit},q=function(t){!t&&s.warning(i.i18n.prop("OP_EDIT_NOT"),"",e.toastrConfig),h(he(),!0,ge())},j=o.throttle(editAdd,1e3),Y=!1,X=function(t){if(!_&&!we()){clearInterval(d),R(t);var n={processName:v,processInfo:JSON.stringify(ie()),modifiedOperators:c,topic:H(),owner:ge()},r=function(e){_||we()||(O(e),getExperimentFlag()&&W())},o=function(e){Y||"ProcessRunningException"!==e.responseText||(Y=!0,s.warning(i.i18n.prop("ict_oneminer_message_reload_msg")),h(he(),!0))};a.post(e.genApiUrl("process/validate"),n,r,o)}},Z=function(e){h=e},K=function(){return h},J=function(t,n,i){var r=ie(),o={processName:v,owner:p,processInfo:JSON.stringify(r),topic:H(),execType:t,targetOperator:n,modifiedOperators:i};return e.getDataFromServer(o,e.genApiUrl("process/execute"))},Q=function(){return{params:{schedule:""},operators:[],connects:[],scale:1,translate:JSON.stringify({x:0,y:0})}},ee=function(){var e={operators:[],connects:[],groups:[]},t=g.getSelectionCells();return t.filter(function(e){return e&&e.value&&e.value.isOperator&&e.value.isGroup}).forEach(function(e){t=t.concat(te(e))}),t=o.uniq(t,!1,"id"),t.filter(function(e){return e&&e.value&&e.value.isOperator}).forEach(function(t,n,i){var r=m[t.id],o={name:r.name,description:r.description,type:r.type,id:r.id,x:t.getGeometry().x,y:t.getGeometry().y,params:r.params};i.some(function(e){return t.parent.id===e.id})&&(o.parent=t.parent.id),r.isGroup?(o.width=t.getGeometry().width,o.height=t.getGeometry().height,o.children=re(t),e.groups.push(o)):(o.parents=oe(t),e.operators.push(o))}),e.operators.forEach(function(t){e.groups.some(function(e){return e.id===t.parent})||delete t.parent}),o.uniq(ne(g.getSelectionCells()),!1,"id").forEach(function(n){var i={},r=n.source.getParent(),o=n.target.getParent(),a=t.some(function(e){return e.id===r.id}),s=t.some(function(e){return e.id===o.id});a&&s&&(r.isVertex()&&(i.from_op=r.value.name),i.from_port=n.source.value.name,o.isVertex()&&(i.to_op=o.value.name),i.to_port=n.target.value.name,e.connects.push(i))}),e},te=function getLoopChildren(e){var t=[];return(e.children||[]).forEach(function(n){n.value&&e.value.isOperator&&(t.push(n),n.value.isGroup&&(t=t.concat(getLoopChildren(n))))}),t},ne=function getConnects(e){var t=[];return e.forEach(function(e){e.edge?t.push(e):o.isEmpty(e.children)||(t=t.concat(getConnects(e.children)))}),t},ie=function(e){var t={params:{},operators:[],connects:[],groups:[]};t.params=y.params,t.scale=g.getView().getScale(),t.translate=JSON.stringify(g.getView().getTranslate());var n=g.getModel();g.getDefaultParent();n.filterDescendants(function(e){return e&&e.value&&e.value.isOperator}).forEach(function(n){var i=m[n.id];if(e||!i.invalid){var r={};r.name=i.name,r.description=i.description,r.type=i.type,r.id=i.id,r.parent=n.parent.id,r.x=n.getGeometry().x,r.y=n.getGeometry().y,r.params=i.params,i.isGroup?(r.width=n.getGeometry().width,r.height=n.getGeometry().height,r.children=re(n),t.groups.push(r)):(r.parents=oe(n),t.operators.push(r))}});var i=function(e){return n.isEdge(e)};return n.filterDescendants(i).forEach(function(n){if(e||!n.source.parent.value.invalid){var i={};n.source.getParent().isVertex()&&(i.from_op=n.source.getParent().value.name),i.from_port=n.source.value.name,n.target.getParent().isVertex()&&(i.to_op=n.target.getParent().value.name),i.to_port=n.target.value.name,t.connects.push(i)}}),t},re=function getChildren(e){var t=[];return o.isEmpty(e.children)||e.children.forEach(function(e){e.value&&e.value.isGroup?(t=t.concat(getChildren(e)),t.push(e.value.name)):e.value&&e.value.isOperator&&t.push(e.value.name)}),t},oe=function getParents(e){var t=[];return e.parent.value&&e.parent.value.isGroup&&(t.push(e.parent.value.name),t=t.concat(getParents(e.parent))),t},ae=function(e){var t;return o.keys(m).some(function(n){if(m[n].name==e)return t=n,!0}),t},se=function(e,t){var n=ae(t);return n?e.getModel().getCell(n):null},le=function(e){return _},ce=function(e){e?i(".loading-img").addClass("show"):i(".loading-img").removeClass("show"),_=e},ue=function(){return y.params},de=function(e){e&&(y.params=e)},he=function(){return v},pe=function(){return y.params.type||0},fe=function(e){v=e,V("/"+r.md5(v))},ge=function(){return p},me=function(e){p=e},ve=function(e,t){m[e].description=t},_e=function(){var t=ue();return t[e.clusterKey]?t[e.clusterKey]:e.getDefaultConnectId()},ye=function(e){e.forEach(function(e){e.children&&e.children.forEach(function(e){e.getEdgeCount()&&e.edges.forEach(function(e){var t=e.source,n=e.target;(!t.parent.value.invalid||n.parent.value.isOperator&&!n.parent.value.invalid)&&g.removeCells([e])})})})},xe=function(e,t){var n=[],i=e.dataSet.concat(t.dataSet);o.values(m).forEach(function(e){var t=se(g,e.name);e.invalid||o.contains(i,e.type)?e.invalid&&o.contains(i,e.type)&&(e.invalid=!1,t.value.invalid=!1,t.setStyle(t.getStyle().replace("fillColor=#999999;","")),t.children&&t.children.forEach(function(e){e.setConnectable(!0)})):(e.invalid=!0,t.value.invalid=!0,t.setStyle(t.getStyle()+"fillColor=#999999;"),t.children&&t.children.forEach(function(e){e.setConnectable(!1)}),n.push(t))}),ye(n),_||g.refresh()},be=!1,we=function(){return be},Ce=function(e){be=e},Se=function(t){v&&e.doStop(v,t)},Te=function(){var e=[];return{addMethod:function(t,n){e.push({name:n,funct:t})},getMethod:function(t){return e.filter(function(e){return e.name===t})[0].funct||function(){}}}}(),Ae=!0,Me=function(){return(g.getSelectionCell().children||[]).filter(function(e){return"import"===e.value.portType}).map(function(e){return e.value.name})},Ee={};return Ee.stop=Se,Ee.getName=C,Ee.getKeyName=S,Ee.isExist=w,Ee.setGraph=x,Ee.getGraph=b,Ee.addOperator=M,Ee.removeOperatorById=E,Ee.getEmptyProcessInfo=Q,Ee.getProcessInfo=ie,Ee.getOperatorParams=D,Ee.getMultiPortOperators=I,Ee.run=J,Ee.refresh=O,Ee.updateData=X,Ee.getOperatorAsCell=se,Ee.getParams=ue,Ee.setParams=de,Ee.getLoadingStatus=le,Ee.setLoadingStatus=ce,Ee.setModifiedOperators=B,Ee.getModifiedOperators=F,Ee.getProcessName=he,Ee.setProcessName=fe,Ee.getProcessOwner=ge,Ee.setProcessOwner=me,Ee.getProcessType=pe,Ee.getOperatorDescription=A,Ee.setOperatorDescription=ve,Ee.setChangeEvent=z,Ee.switchExecuteFrameWork=xe,Ee.getTopic=H,Ee.isRunning=we,Ee.setRunning=Ce,Ee.getCurrentConnectId=_e,Ee.setInitProcess=Z,Ee.getInitProcess=K,Ee.methodProxy=Te,Ee.getSelectProcessInfo=ee,Ee.setExperimentFlag=setExperimentFlag,Ee.getExperimentFlag=getExperimentFlag,Ee.getInputPortsName=Me,Ee.stopEdit=U,Ee.setEditStatus=setEditStatus,Ee.getEditStatus=getEditStatus,Ee.editReload=q,Ee.isEditable=G,Ee.editHandler=j,Ee}.apply(t,o))&&(e.exports=a)}).call(t,n(0),n(68))},function(e,t,n){(function(i){function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r,o;r=[n(1),n(11)],void 0!==(o=function(e,t){var n=function convertTree2List(e){var t=[];if(Array.isArray(e))for(var n=0,i=e.length;n<i;n++)e[n].children?t=t.concat(convertTree2List(e[n].children)):t.push(e[n].id);return t};return function(){function Tree(e,t,n,i,r){_classCallCheck(this,Tree),this.tree=e,this.div=t,this.input=n,this.processManager=i,this.graphManager=r}return Tree.prototype.init=function(e){this.data=this.getTreeData(e),this.dataSet=n(this.data),this.emptyTree(),this.initTree(),this.registerSearchHandler(),this.registerTreeHandler(),this.initContextMenu()},Tree.prototype.getTreeData=function(){throw new Error("implements getTreeData func...")},Tree.prototype.emptyTree=function(){i(this.tree).empty()},Tree.prototype.initTree=function(){var e=this;t.setting.callback={onExpand:function(){i(e.div).getNiceScroll().resize()},onCollapse:function(){i(e.div).getNiceScroll().resize()}},i.fn.zTree.init(i(this.tree),t.setting,this.data),i.fn.zTree.getZTreeObj(this.tree.substr(1)).expandAll("#operator-tree"!==this.tree)},Tree.prototype.registerTreeHandler=function(){throw new Error("implements registerTreeHandler func...")},Tree.prototype.registerSearchHandler=function(){var e=this;i(this.input).on("input",function(){e.search()}),i(this.input).trigger("input")},Tree.prototype.search=function(){var t=i(this.input).val(),n=i("span"+this.tree+"-noMatches");0===t.length?(i(this.tree+" li").css("display","block"),n.css("display","none")):(i(this.tree+" li").css("display","none"),this.filterTree(this.tree,this.data,t)?n.css("display","none"):n.css("display","block")),e.doNiceScroll(this.div)},Tree.prototype.filterTree=function(e,t,n){for(var r=!1,o=0,a=t.length;o<a;o++)if(t[o].children){var s=this.filterTree(e,t[o].children,n);s&&(r=!0,i(e+' li:has(> a[title="'+t[o].label+'"])').css("display","block"))}else t[o].label.toLowerCase().indexOf(n.toLowerCase())>=0&&(r=!0,i(e+' li:has(> a[title="'+t[o].label+'"])').css("display","block"));return r},Tree.prototype.initContextMenu=function(){},Tree.prototype.getAllLeafs=function(t){var n=this,i=[];return t.forEach(function(t){t.children?i=i.concat(n.getAllLeafs(t.children)):(t.icon&&e.setOperatorIcon(t.id,t.icon),i.push(t.id))}),i},Tree.prototype.setSelectNode=function(e){var t=i.fn.zTree.getZTreeObj(this.tree.substr(1)),n=t.getNodeByParam("label",e);t.cancelSelectedNode(),t.selectNode(n,!0)},Tree}()}.apply(t,r))&&(e.exports=o)}).call(t,n(0))},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(2)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.fn.extend({uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}})})},,,,,,,function(e,t,n){!function(t,n){e.exports=n()}(0,function(){var e={isString:function(e){return void 0!==e&&null!==e&&("string"==typeof e||e instanceof String)},isArray:function(e){return void 0!==e&&null!==e&&e instanceof Array},inArray:function(e,t){for(var n=0;n<t.length;++n)if(e===t[n])return n;return-1},setTimeout:function(e,t,n){return window.setTimeout(function(){try{e._debug("Invoking timed function",t),t()}catch(n){e._debug("Exception invoking timed function",t,n)}},n)},clearTimeout:function(e){window.clearTimeout(e)}},t=function(){var e=[],t={};this.getTransportTypes=function(){return e.slice(0)},this.findTransportTypes=function(n,i,r){for(var o=[],a=0;a<e.length;++a){var s=e[a];!0===t[s].accept(n,i,r)&&o.push(s)}return o},this.negotiateTransport=function(n,i,r,o){for(var a=0;a<e.length;++a)for(var s=e[a],l=0;l<n.length;++l)if(s===n[l]){var c=t[s];if(!0===c.accept(i,r,o))return c}return null},this.add=function(n,i,r){for(var o=!1,a=0;a<e.length;++a)if(e[a]===n){o=!0;break}return o||("number"!=typeof r?e.push(n):e.splice(r,0,n),t[n]=i),!o},this.find=function(n){for(var i=0;i<e.length;++i)if(e[i]===n)return t[n];return null},this.remove=function(n){for(var i=0;i<e.length;++i)if(e[i]===n){e.splice(i,1);var r=t[n];return delete t[n],r}return null},this.clear=function(){e=[],t={}},this.reset=function(n){for(var i=0;i<e.length;++i)t[e[i]].reset(n)}},n=function(){var t,n,i;this.registered=function(e,i){t=e,n=i},this.unregistered=function(){t=null,n=null},this._debug=function(){n._debug.apply(n,arguments)},this._mixin=function(){return n._mixin.apply(n,arguments)},this.getConfiguration=function(){return n.getConfiguration()},this.getAdvice=function(){return n.getAdvice()},this.setTimeout=function(t,i){return e.setTimeout(n,t,i)},this.clearTimeout=function(t){e.clearTimeout(t)},this.convertToMessages=function(t){if(e.isString(t))try{return JSON.parse(t)}catch(e){throw this._debug("Could not convert to JSON the following string",'"'+t+'"'),e}if(e.isArray(t))return t;if(void 0===t||null===t)return[];if(t instanceof Object)return[t];throw"Conversion Error "+t+", typeof "+typeof t},this.accept=function(e,t,n){throw"Abstract"},this.getType=function(){return t},this.getURL=function(){return i},this.setURL=function(e){i=e},this.send=function(e,t){throw"Abstract"},this.reset=function(e){this._debug("Transport",t,"reset",e?"initial":"retry")},this.abort=function(){this._debug("Transport",t,"aborted")},this.toString=function(){return this.getType()}};n.derive=function(e){function F(){}return F.prototype=e,new F};var i=function(){function _coalesceEnvelopes(e){for(;s.length>0;){var t=s[0],n=t[0],i=t[1];if(n.url!==e.url||n.sync!==e.sync)break;s.shift(),e.messages=e.messages.concat(n.messages),this._debug("Coalesced",n.messages.length,"messages from request",i.id)}}function _transportSend(e,t){if(this.transportSend(e,t),t.expired=!1,!e.sync){var n=this.getConfiguration().maxNetworkDelay,i=n;!0===t.metaConnect&&(i+=this.getAdvice().timeout),this._debug("Transport",this.getType(),"waiting at most",i,"ms for the response, maxNetworkDelay",n);var r=this;t.timeout=this.setTimeout(function(){t.expired=!0;var n="Request "+t.id+" of transport "+r.getType()+" exceeded "+i+" ms max network delay",o={reason:n},a=t.xhr;o.httpCode=r.xhrStatus(a),r.abortXHR(a),r._debug(n),r.complete(t,!1,t.metaConnect),e.onFailure(a,e.messages,o)},i)}}function _queueSend(e){var t=++r,n={id:t,metaConnect:!1,envelope:e};a.length<this.getConfiguration().maxConnections-1?(a.push(n),_transportSend.call(this,e,n)):(this._debug("Transport",this.getType(),"queueing request",t,"envelope",e),s.push([e,n]))}function _metaConnectComplete(e){var t=e.id;if(this._debug("Transport",this.getType(),"metaConnect complete, request",t),null!==o&&o.id!==t)throw"Longpoll request mismatch, completing request "+t;o=null}function _complete(t,n){var i=e.inArray(t,a);if(i>=0&&a.splice(i,1),s.length>0){var r=s.shift(),o=r[0],l=r[1];if(this._debug("Transport dequeued request",l.id),n)this.getConfiguration().autoBatch&&_coalesceEnvelopes.call(this,o),_queueSend.call(this,o),this._debug("Transport completed request",t.id,o);else{var c=this;this.setTimeout(function(){c.complete(l,!1,l.metaConnect);var e={reason:"Previous request failed"},t=l.xhr;e.httpCode=c.xhrStatus(t),o.onFailure(t,o.messages,e)},0)}}}function _metaConnectSend(e){if(null!==o)throw"Concurrent metaConnect requests not allowed, request id="+o.id+" not yet completed";var t=++r;this._debug("Transport",this.getType(),"metaConnect send, request",t,"envelope",e);var n={id:t,metaConnect:!0,envelope:e};_transportSend.call(this,e,n),o=n}var t=new n,i=n.derive(t),r=0,o=null,a=[],s=[];return i.complete=function(e,t,n){n?_metaConnectComplete.call(this,e):_complete.call(this,e,t)},i.transportSend=function(e,t){throw"Abstract"},i.transportSuccess=function(e,t,n){t.expired||(this.clearTimeout(t.timeout),this.complete(t,!0,t.metaConnect),n&&n.length>0?e.onSuccess(n):e.onFailure(t.xhr,e.messages,{httpCode:204}))},i.transportFailure=function(e,t,n){t.expired||(this.clearTimeout(t.timeout),this.complete(t,!1,t.metaConnect),e.onFailure(t.xhr,e.messages,n))},i.send=function(e,t){t?_metaConnectSend.call(this,e):_queueSend.call(this,e)},i.abort=function(){t.abort();for(var e=0;e<a.length;++e){var n=a[e];n&&(this._debug("Aborting request",n),this.abortXHR(n.xhr)||this.transportFailure(n.envelope,n,{reason:"abort"}))}var i=o;i&&(this._debug("Aborting metaConnect request",i),this.abortXHR(i.xhr)||this.transportFailure(i.envelope,i,{reason:"abort"})),this.reset(!0)},i.reset=function(e){t.reset(e),o=null,a=[],s=[]},i.abortXHR=function(e){if(e)try{var t=e.readyState;return e.abort(),t!==window.XMLHttpRequest.UNSENT}catch(e){this._debug(e)}return!1},i.xhrStatus=function(e){if(e)try{return e.status}catch(e){this._debug(e)}return-1},i},r=function(){var e=new i,t=n.derive(e),r=!0;return t.accept=function(e,t,n){return r||!t},t.newXMLHttpRequest=function(){return new window.XMLHttpRequest},t.xhrSend=function(e){var n=t.newXMLHttpRequest();n.context=t.context,n.withCredentials=!0,n.open("POST",e.url,!0!==e.sync);var i=e.headers;if(i)for(var r in i)i.hasOwnProperty(r)&&n.setRequestHeader(r,i[r]);return n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.onload=function(){200===n.status?e.onSuccess(n.responseText):e.onError(n.statusText)},n.onerror=function(){e.onError(n.statusText)},n.send(e.body),n},t.transportSend=function(e,t){this._debug("Transport",this.getType(),"sending request",t.id,"envelope",e);var n=this;try{var i=!0;t.xhr=this.xhrSend({transport:this,url:e.url,sync:e.sync,headers:this.getConfiguration().requestHeaders,body:JSON.stringify(e.messages),onSuccess:function(i){n._debug("Transport",n.getType(),"received response",i);var o=!1;try{var a=n.convertToMessages(i);0===a.length?(r=!1,n.transportFailure(e,t,{httpCode:204})):(o=!0,n.transportSuccess(e,t,a))}catch(i){if(n._debug(i),!o){r=!1;var s={exception:i};s.httpCode=n.xhrStatus(t.xhr),n.transportFailure(e,t,s)}}},onError:function(o,a){n._debug("Transport",n.getType(),"received error",o,a),r=!1;var s={reason:o,exception:a};s.httpCode=n.xhrStatus(t.xhr),i?n.setTimeout(function(){n.transportFailure(e,t,s)},0):n.transportFailure(e,t,s)}}),i=!1}catch(i){r=!1,this.setTimeout(function(){n.transportFailure(e,t,{exception:i})},0)}},t.reset=function(t){e.reset(t),r=!0},t},o=function(){function _failTransportFn(e,t,n){var i=this;return function(){i.transportFailure(e,t,"error",n)}}var e=new i,t=n.derive(e),r=0;return t.accept=function(e,t,n){return!0},t.jsonpSend=function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("script"),i="_cometd_jsonp_"+r++;window[i]=function(r){t.removeChild(n),delete window[i],e.onSuccess(r)};var o=e.url;o+=o.indexOf("?")<0?"?":"&",o+="jsonp="+i,o+="&message="+e.body,n.src=o,n.async=!0!==e.sync,n.type="application/javascript",n.onerror=function(t){e.onError("jsonp "+t.type)},t.appendChild(n)},t.transportSend=function(e,t){for(var n=this,i=0,r=e.messages.length,o=[];r>0;){var a=JSON.stringify(e.messages.slice(i,i+r)),s=e.url.length+encodeURI(a).length,l=this.getConfiguration().maxURILength;if(s>l){if(1===r){var c="Bayeux message too big ("+s+" bytes, max is "+l+") for transport "+this.getType();return void this.setTimeout(_failTransportFn.call(this,e,t,c),0)}--r}else o.push(r),i+=r,r=e.messages.length-i}var u=e;if(o.length>1){var d=0,h=o[0];this._debug("Transport",this.getType(),"split",e.messages.length,"messages into",o.join(" + ")),u=this._mixin(!1,{},e),u.messages=e.messages.slice(d,h),u.onSuccess=e.onSuccess,u.onFailure=e.onFailure;for(var p=1;p<o.length;++p){var f=this._mixin(!1,{},e);d=h,h+=o[p],f.messages=e.messages.slice(d,h),f.onSuccess=e.onSuccess,f.onFailure=e.onFailure,this.send(f,t.metaConnect)}}this._debug("Transport",this.getType(),"sending request",t.id,"envelope",u);try{var g=!0;this.jsonpSend({transport:this,url:u.url,sync:u.sync,headers:this.getConfiguration().requestHeaders,body:JSON.stringify(u.messages),onSuccess:function(e){var i=!1;try{var r=n.convertToMessages(e);0===r.length?n.transportFailure(u,t,{httpCode:204}):(i=!0,n.transportSuccess(u,t,r))}catch(e){n._debug(e),i||n.transportFailure(u,t,{exception:e})}},onError:function(e,i){var r={reason:e,exception:i};g?n.setTimeout(function(){n.transportFailure(u,t,r)},0):n.transportFailure(u,t,r)}}),g=!1}catch(e){this.setTimeout(function(){n.transportFailure(u,t,{exception:e})},0)}},t},a=function(){function _forceClose(e,t){e&&(this.webSocketClose(e,t.code,t.reason),this.onClose(e,t))}function _sameContext(e){return e===c||e===l}function _storeEnvelope(e,t,n){for(var i=[],r=0;r<t.messages.length;++r){var o=t.messages[r];o.id&&i.push(o.id)}e.envelopes[i.join(",")]=[t,n],this._debug("Transport",this.getType(),"stored envelope, envelopes",e.envelopes)}function _websocketConnect(e){if(!c){var n=t.getURL().replace(/^http/,"ws");this._debug("Transport",this.getType(),"connecting to URL",n);try{var i=t.getConfiguration().protocol;e.webSocket=i?new window.WebSocket(n,i):new window.WebSocket(n),c=e}catch(e){throw o=!1,this._debug("Exception while creating WebSocket object",e),e}s=!1!==t.getConfiguration().stickyReconnect;var r=this,u=t.getConfiguration().connectTimeout;u>0&&(e.connectTimer=this.setTimeout(function(){t._debug("Transport",r.getType(),"timed out while connecting to URL",n,":",u,"ms"),_forceClose.call(r,e,{code:1e3,reason:"Connect Timeout"})},u));var d=function(){t._debug("WebSocket onopen",e),e.connectTimer&&r.clearTimeout(e.connectTimer),_sameContext(e)?(c=null,l=e,a=!0,r.onOpen(e)):(t._warn("Closing extra WebSocket connection",this,"active connection",l),_forceClose.call(r,e,{code:1e3,reason:"Extra Connection"}))},h=function(n){n=n||{code:1e3},t._debug("WebSocket onclose",e,n,"connecting",c,"current",l),e.connectTimer&&r.clearTimeout(e.connectTimer),r.onClose(e,n)},p=function(n){t._debug("WebSocket onmessage",n,e),r.onMessage(e,n)};e.webSocket.onopen=d,e.webSocket.onclose=h,e.webSocket.onerror=function(){h({code:1e3,reason:"Error"})},e.webSocket.onmessage=p,this._debug("Transport",this.getType(),"configured callbacks on",e)}}function _webSocketSend(e,n,i){var r=JSON.stringify(n.messages);e.webSocket.send(r),this._debug("Transport",this.getType(),"sent",n,"metaConnect =",i);var o=this.getConfiguration().maxNetworkDelay,a=o;i&&(a+=this.getAdvice().timeout,u=!0);for(var s=this,l=[],c=0;c<n.messages.length;++c)!function(){var i=n.messages[c];i.id&&(l.push(i.id),e.timeouts[i.id]=s.setTimeout(function(){t._debug("Transport",s.getType(),"timing out message",i.id,"after",a,"on",e),_forceClose.call(s,e,{code:1e3,reason:"Message Timeout"})},a))}();this._debug("Transport",this.getType(),"waiting at most",a,"ms for messages",l,"maxNetworkDelay",o,", timeouts:",e.timeouts)}function _send(e,t,n){try{null===e?(e=c||{envelopes:{},timeouts:{}},_storeEnvelope.call(this,e,t,n),_websocketConnect.call(this,e)):(_storeEnvelope.call(this,e,t,n),_webSocketSend.call(this,e,t,n))}catch(t){var i=this;this.setTimeout(function(){_forceClose.call(i,e,{code:1e3,reason:"Exception",exception:t})},0)}}var t,i=new n,r=n.derive(i),o=!0,a=!1,s=!0,l=null,c=null,u=!1,d=null;return r.reset=function(e){i.reset(e),o=!0,e&&(a=!1),s=!0,l=null,c=null,u=!1},r._notifySuccess=function(e,t){e.call(this,t)},r._notifyFailure=function(e,t,n,i){e.call(this,t,n,i)},r.onOpen=function(e){var t=e.envelopes;this._debug("Transport",this.getType(),"opened",e,"pending messages",t);for(var n in t)if(t.hasOwnProperty(n)){var i=t[n],r=i[0],o=i[1];d=r.onSuccess,_webSocketSend.call(this,e,r,o)}},r.onMessage=function(t,n){this._debug("Transport",this.getType(),"received websocket message",n,t);for(var i=!1,r=this.convertToMessages(n.data),o=[],a=0;a<r.length;++a){var s=r[a];if((/^\/meta\//.test(s.channel)||void 0===s.data)&&s.id){o.push(s.id);var l=t.timeouts[s.id];l&&(this.clearTimeout(l),delete t.timeouts[s.id],this._debug("Transport",this.getType(),"removed timeout for message",s.id,", timeouts",t.timeouts))}"/meta/connect"===s.channel&&(u=!1),"/meta/disconnect"!==s.channel||u||(i=!0)}for(var c=!1,h=t.envelopes,p=0;p<o.length;++p){var f=o[p];for(var g in h)if(h.hasOwnProperty(g)){var m=g.split(","),v=e.inArray(f,m);if(v>=0){c=!0,m.splice(v,1);var _=h[g][0],y=h[g][1];delete h[g],m.length>0&&(h[m.join(",")]=[_,y]);break}}}c&&this._debug("Transport",this.getType(),"removed envelope, envelopes",h),this._notifySuccess(d,r),i&&this.webSocketClose(t,1e3,"Disconnect")},r.onClose=function(e,t){this._debug("Transport",this.getType(),"closed",e,t),_sameContext(e)&&(o=s&&a,c=null,l=null);var n=e.timeouts;e.timeouts={};for(var i in n)n.hasOwnProperty(i)&&this.clearTimeout(n[i]);var r=e.envelopes;e.envelopes={};for(var d in r)if(r.hasOwnProperty(d)){var h=r[d][0],p=r[d][1];p&&(u=!1);var f={websocketCode:t.code,reason:t.reason};t.exception&&(f.exception=t.exception),this._notifyFailure(h.onFailure,e,h.messages,f)}},r.registered=function(e,n){i.registered(e,n),t=n},r.accept=function(e,n,i){return this._debug("Transport",this.getType(),"accept, supported:",o),o&&!!window.WebSocket&&!1!==t.websocketEnabled},r.send=function(e,t){this._debug("Transport",this.getType(),"sending",e,"metaConnect =",t),_send.call(this,l,e,t)},r.webSocketClose=function(e,t,n){try{e.webSocket&&e.webSocket.close(t,n)}catch(e){this._debug(e)}},r.abort=function(){i.abort(),_forceClose.call(this,l,{code:1e3,reason:"Abort"}),this.reset(!0)},r},s=function(n){function _fieldValue(e,t){try{return e[t]}catch(e){return}}function _isString(t){return e.isString(t)}function _isFunction(e){return void 0!==e&&null!==e&&"function"==typeof e}function _zeroPad(e,t){for(var n="";--t>0&&!(e>=Math.pow(10,t));)n+="0";return n+=e}function _log(e,t){if(window.console){var n=window.console[e];if(_isFunction(n)){var i=new Date;[].splice.call(t,0,0,_zeroPad(i.getHours(),2)+":"+_zeroPad(i.getMinutes(),2)+":"+_zeroPad(i.getSeconds(),2)+"."+_zeroPad(i.getMilliseconds(),3)),n.apply(window.console,t)}}}function _splitURL(e){return/(^https?:\/\/)?(((\[[^\]]+\])|([^:\/\?#]+))(:(\d+))?)?([^\?#]*)(.*)?/.exec(e)}function _configure(e){c._debug("Configuring cometd object with",e),_isString(e)&&(e={url:e}),e||(e={}),k=c._mixin(!1,k,e);var t=c.getURL();if(!t)throw"Missing required configuration parameter 'url' specifying the Bayeux server URL";var n=_splitURL(t),i=n[2],r=n[8],o=n[9];if(d=c._isCrossDomain(i),k.appendMessageTypeToURL)if(void 0!==o&&o.length>0)c._info("Appending message type to URI "+r+o+" is not supported, disabling 'appendMessageTypeToURL' configuration"),k.appendMessageTypeToURL=!1;else{var a=r.split("/"),s=a.length-1;r.match(/\/$/)&&(s-=1),a[s].indexOf(".")>=0&&(c._info("Appending message type to URI "+r+" is not supported, disabling 'appendMessageTypeToURL' configuration"),k.appendMessageTypeToURL=!1)}}function _removeListener(e){if(e){var t=x[e.channel];t&&t[e.id]&&(delete t[e.id],c._debug("Removed",e.listener?"listener":"subscription",e))}}function _removeSubscription(e){e&&!e.listener&&_removeListener(e)}function _clearSubscriptions(){for(var e in x)if(x.hasOwnProperty(e)){var t=x[e];if(t)for(var n in t)t.hasOwnProperty(n)&&_removeSubscription(t[n])}}function _setStatus(e){p!==e&&(c._debug("Status",p,"->",e),p=e)}function _isDisconnected(){return"disconnecting"===p||"disconnected"===p}function _nextMessageId(){return""+ ++f}function _applyExtension(e,t,n,i,r){try{return t.call(e,i)}catch(e){var o=c.onExtensionException;if(_isFunction(o)){c._debug("Invoking extension exception handler",n,e);try{o.call(c,e,n,r,i)}catch(e){c._info("Exception during execution of extension exception handler",n,e)}}else c._info("Exception during execution of extension",n,e);return i}}function _applyIncomingExtensions(e){for(var t=0;t<C.length&&(void 0!==e&&null!==e);++t){var n=C[t],i=n.extension.incoming;if(_isFunction(i)){var r=_applyExtension(n.extension,i,n.name,e,!1);e=void 0===r?e:r}}return e}function _applyOutgoingExtensions(e){for(var t=C.length-1;t>=0&&(void 0!==e&&null!==e);--t){var n=C[t],i=n.extension.outgoing;if(_isFunction(i)){var r=_applyExtension(n.extension,i,n.name,e,!0);e=void 0===r?e:r}}return e}function _notify(e,t){var n=x[e];if(n)for(var i in n)if(n.hasOwnProperty(i)){var r=n[i];if(r)try{r.callback.call(r.scope,t)}catch(e){var o=c.onListenerException;if(_isFunction(o)){c._debug("Invoking listener exception handler",r,e);try{o.call(c,e,r,r.listener,t)}catch(e){c._info("Exception during execution of listener exception handler",r,e)}}else c._info("Exception during execution of listener",r,t,e)}}}function _notifyListeners(e,t){_notify(e,t);for(var n=e.split("/"),i=n.length-1,r=i;r>0;--r){var o=n.slice(0,r).join("/")+"/*";r===i&&_notify(o,t),o+="*",_notify(o,t)}}function _cancelDelayedSend(){null!==w&&e.clearTimeout(w),w=null}function _delayedSend(t,n){_cancelDelayedSend();var i=S.interval+n;c._debug("Function scheduled in",i,"ms, interval =",S.interval,"backoff =",b,t),w=e.setTimeout(c,t,i)}function _send(e,t,n,r){for(var o=0;o<t.length;++o){var a=t[o],s=a.id;g&&(a.clientId=g),a=_applyOutgoingExtensions(a),void 0!==a&&null!==a?(a.id=s,t[o]=a):(delete T[s],t.splice(o--,1))}if(0!==t.length){var l=c.getURL();k.appendMessageTypeToURL&&(l.match(/\/$/)||(l+="/"),r&&(l+=r));var u={url:l,sync:e,messages:t,onSuccess:function(e){try{L.call(c,e)}catch(e){c._info("Exception during handling of messages",e)}},onFailure:function(e,t,n){try{var i=c.getTransport();n.connectionType=i?i.getType():"unknown",N.call(c,e,t,n)}catch(e){c._info("Exception during handling of failure",e)}}};c._debug("Send",u),i.send(u,n)}}function _queueSend(e){m>0||!0===_?v.push(e):_send(!1,[e],!1)}function _resetBackoff(){b=0}function _increaseBackoff(){return b<k.maxBackoff&&(b+=k.backoffIncrement),b}function _startBatch(){++m,c._debug("Starting batch, depth",m)}function _flushBatch(){var e=v;v=[],e.length>0&&_send(!1,e,!1)}function _endBatch(){if(--m,c._debug("Ending batch, depth",m),m<0)throw"Calls to startBatch() and endBatch() are not paired";0!==m||_isDisconnected()||_||_flushBatch()}function _connect(){if(!_isDisconnected()){var e={id:_nextMessageId(),channel:"/meta/connect",connectionType:i.getType()};E||(e.advice={timeout:0}),_setStatus("connecting"),c._debug("Connect sent",e),_send(!1,[e],!0,"connect"),_setStatus("connected")}}function _delayedConnect(e){_setStatus("connecting"),_delayedSend(function(){_connect()},e)}function _updateAdvice(e){e&&(S=c._mixin(!1,{},k.advice,e),c._debug("New advice",S))}function _disconnect(e){if(_cancelDelayedSend(),e&&i&&i.abort(),g=null,_setStatus("disconnected"),m=0,_resetBackoff(),i=null,M=!1,E=!1,v.length>0){var t=v;v=[],N.call(c,void 0,t,{reason:"Disconnected"})}}function _notifyTransportException(e,t,n){var i=c.onTransportException;if(_isFunction(i)){c._debug("Invoking transport exception handler",e,t,n);try{i.call(c,n,e,t)}catch(e){c._info("Exception during execution of transport exception handler",e)}}}function _handshake(e,t){_isFunction(e)&&(t=e,e=void 0),g=null,_clearSubscriptions(),_isDisconnected()&&h.reset(!0),_updateAdvice({}),m=0,_=!0,s=e,l=t;var n=c.getURL(),r=h.findTransportTypes("1.0",d,n),o={id:_nextMessageId(),version:"1.0",minimumVersion:"1.0",channel:"/meta/handshake",supportedConnectionTypes:r,advice:{timeout:S.timeout,interval:S.interval}},a=c._mixin(!1,{},s,o);if(c._putCallback(a.id,t),!i&&!(i=h.negotiateTransport(r,"1.0",d,n))){var u="Could not find initial transport among: "+h.getTransportTypes();throw c._warn(u),u}c._debug("Initial transport is",i.getType()),_setStatus("handshaking"),c._debug("Handshake sent",a),_send(!1,[a],!1,"handshake")}function _delayedHandshake(e){_setStatus("handshaking"),_=!0,_delayedSend(function(){_handshake(s,l)},e)}function _notifyCallback(e,t){try{e.call(c,t)}catch(e){var n=c.onCallbackException;if(_isFunction(n)){c._debug("Invoking callback exception handler",e);try{n.call(c,e,t)}catch(e){c._info("Exception during execution of callback exception handler",e)}}else c._info("Exception during execution of message callback",e)}}function _handleCallback(e){var t=c._getCallback([e.id]);_isFunction(t)&&(delete T[e.id],_notifyCallback(t,e))}function _handleRemoteCall(t){var n=A[t.id];if(delete A[t.id],n){c._debug("Handling remote call response for",t,"with context",n);var i=n.timeout;i&&e.clearTimeout(i);var r=n.callback;if(_isFunction(r))return _notifyCallback(r,t),!0}return!1}function _handleTransportFailure(e){c._debug("Transport failure handling",e),e.transport&&(i=e.transport),e.url&&i.setURL(e.url);var t=e.action,n=e.delay||0;switch(t){case"handshake":_delayedHandshake(n);break;case"retry":_delayedConnect(n);break;case"none":_disconnect(!0);break;default:throw"Unknown action "+t}}function _failHandshake(e,t){_handleCallback(e),_notifyListeners("/meta/handshake",e),_notifyListeners("/meta/unsuccessful",e),_isDisconnected()&&(t.action="none"),c.onTransportFailure.call(c,e,t,_handleTransportFailure)}function _handshakeResponse(e){var t=c.getURL();if(e.successful){var n=c._isCrossDomain(_splitURL(t)[2]),r=h.negotiateTransport(e.supportedConnectionTypes,e.version,n,t);if(null===r)return e.successful=!1,void _failHandshake(e,{cause:"negotiation",action:"none",transport:null});i!==r&&(c._debug("Transport",i.getType(),"->",r.getType()),i=r),g=e.clientId,_=!1,_flushBatch(),e.reestablish=M,M=!0,_handleCallback(e),_notifyListeners("/meta/handshake",e),D=e["x-messages"]||0;var o=_isDisconnected()?"none":S.reconnect||"retry";switch(o){case"retry":_resetBackoff(),0===D?_delayedConnect(0):c._debug("Processing",D,"handshake-delivered messages");break;case"none":_disconnect(!0);break;default:throw"Unrecognized advice action "+o}}else _failHandshake(e,{cause:"unsuccessful",action:S.reconnect||"handshake",transport:i})}function _handshakeFailure(e){_failHandshake(e,{cause:"failure",action:"handshake",transport:null})}function _failConnect(e,t){_notifyListeners("/meta/connect",e),_notifyListeners("/meta/unsuccessful",e),_isDisconnected()&&(t.action="none"),c.onTransportFailure.call(c,e,t,_handleTransportFailure)}function _connectResponse(e){if(E=e.successful){_notifyListeners("/meta/connect",e);var t=_isDisconnected()?"none":S.reconnect||"retry";switch(t){case"retry":_resetBackoff(),_delayedConnect(b);break;case"none":_disconnect(!1);break;default:throw"Unrecognized advice action "+t}}else _failConnect(e,{cause:"unsuccessful",action:S.reconnect||"retry",transport:i})}function _connectFailure(e){E=!1,_failConnect(e,{cause:"failure",action:"retry",transport:null})}function _failDisconnect(e){_disconnect(!0),_handleCallback(e),_notifyListeners("/meta/disconnect",e),_notifyListeners("/meta/unsuccessful",e)}function _disconnectResponse(e){e.successful?(_disconnect(!1),_handleCallback(e),_notifyListeners("/meta/disconnect",e)):_failDisconnect(e)}function _disconnectFailure(e){_failDisconnect(e)}function _failSubscribe(e){var t=x[e.subscription];if(t)for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];i&&!i.listener&&(delete t[n],c._debug("Removed failed subscription",i))}_handleCallback(e),_notifyListeners("/meta/subscribe",e),_notifyListeners("/meta/unsuccessful",e)}function _subscribeResponse(e){e.successful?(_handleCallback(e),_notifyListeners("/meta/subscribe",e)):_failSubscribe(e)}function _subscribeFailure(e){_failSubscribe(e)}function _failUnsubscribe(e){_handleCallback(e),_notifyListeners("/meta/unsubscribe",e),_notifyListeners("/meta/unsuccessful",e)}function _unsubscribeResponse(e){e.successful?(_handleCallback(e),_notifyListeners("/meta/unsubscribe",e)):_failUnsubscribe(e)}function _unsubscribeFailure(e){_failUnsubscribe(e)}function _failMessage(e){_handleRemoteCall(e)||(_handleCallback(e),_notifyListeners("/meta/publish",e),_notifyListeners("/meta/unsuccessful",e))}function _messageResponse(e){void 0!==e.data?_handleRemoteCall(e)||(_notifyListeners(e.channel,e),D>0&&0===--D&&(c._debug("Processed last handshake-delivered message"),_delayedConnect(0))):void 0===e.successful?c._warn("Unknown Bayeux Message",e):e.successful?(_handleCallback(e),_notifyListeners("/meta/publish",e)):_failMessage(e)}function _messageFailure(e){_failMessage(e)}function _receive(e){if(I=0,void 0!==(e=_applyIncomingExtensions(e))&&null!==e){_updateAdvice(e.advice);switch(e.channel){case"/meta/handshake":_handshakeResponse(e);break;case"/meta/connect":_connectResponse(e);break;case"/meta/disconnect":_disconnectResponse(e);break;case"/meta/subscribe":_subscribeResponse(e);break;case"/meta/unsubscribe":_unsubscribeResponse(e);break;default:_messageResponse(e)}}}function _hasSubscriptions(e){var t=x[e];if(t)for(var n in t)if(t.hasOwnProperty(n)&&t[n])return!0;return!1}function _resolveScopedCallback(e,t){var n={scope:e,method:t};if(_isFunction(e))n.scope=void 0,n.method=e;else if(_isString(t)){if(!e)throw"Invalid scope "+e;if(n.method=e[t],!_isFunction(n.method))throw"Invalid callback "+t+" for scope "+e}else if(!_isFunction(t))throw"Invalid callback "+t;return n}function _addListener(e,t,n,i){var r=_resolveScopedCallback(t,n);c._debug("Adding",i?"listener":"subscription","on",e,"with scope",r.scope,"and callback",r.method);var o=++y,a={id:o,channel:e,scope:r.scope,callback:r.method,listener:i},s=x[e];return s||(s={},x[e]=s),s[o]=a,c._debug("Added",i?"listener":"subscription",a),a}var i,s,l,c=this,u=n||"default",d=!1,h=new t,p="disconnected",f=0,g=null,m=0,v=[],_=!1,y=0,x={},b=0,w=null,C=[],S={},T={},A={},M=!1,E=!1,I=0,D=0,k={protocol:null,stickyReconnect:!0,connectTimeout:0,maxConnections:2,backoffIncrement:1e3,maxBackoff:6e4,logLevel:"info",maxNetworkDelay:1e4,requestHeaders:{},appendMessageTypeToURL:!0,autoBatch:!1,urls:{},maxURILength:2e3,advice:{timeout:6e4,interval:0,reconnect:void 0,maxInterval:0}};this._mixin=function(e,t,n){for(var i=t||{},r=2;r<arguments.length;++r){var o=arguments[r];if(void 0!==o&&null!==o)for(var a in o)if(o.hasOwnProperty(a)){var s=_fieldValue(o,a),l=_fieldValue(i,a);if(s===t)continue;if(void 0===s)continue;if(e&&"object"==typeof s&&null!==s)if(s instanceof Array)i[a]=this._mixin(e,l instanceof Array?l:[],s);else{var c="object"!=typeof l||l instanceof Array?{}:l;i[a]=this._mixin(e,c,s)}else i[a]=s}}return i},this._warn=function(){_log("warn",arguments)},this._info=function(){"warn"!==k.logLevel&&_log("info",arguments)},this._debug=function(){"debug"===k.logLevel&&_log("debug",arguments)},this._isCrossDomain=function(e){return!!(window.location&&window.location.host&&e)&&e!==window.location.host};var L,N;this.send=_queueSend,this._getCallback=function(e){return T[e]},this._putCallback=function(e,t){var n=this._getCallback(e);return _isFunction(t)&&(T[e]=t),n},this.onTransportFailure=function(e,t,n){this._debug("Transport failure",t,"for",e);var r=this.getTransportRegistry(),o=this.getURL(),a=this._isCrossDomain(_splitURL(o)[2]),s=r.findTransportTypes("1.0",a,o);if("none"===t.action){if("/meta/handshake"===e.channel&&!t.transport){var l="Could not negotiate transport, client=["+s+"], server=["+e.supportedConnectionTypes+"]";this._warn(l),_notifyTransportException(i.getType(),null,{reason:l,connectionType:i.getType(),transport:i})}}else if(t.delay=this.getBackoffPeriod(),"/meta/handshake"===e.channel){if(!t.transport){var u=r.negotiateTransport(s,"1.0",a,o);u?(this._debug("Transport",i.getType(),"->",u.getType()),_notifyTransportException(i.getType(),u.getType(),e.failure),t.action="handshake",t.transport=u):(this._warn("Could not negotiate transport, client=["+s+"]"),_notifyTransportException(i.getType(),null,e.failure),t.action="none")}"none"!==t.action&&this.increaseBackoffPeriod()}else{var d=(new Date).getTime();if(0===I&&(I=d),"retry"===t.action){t.delay=this.increaseBackoffPeriod();var h=S.maxInterval;if(h>0){var p=S.timeout+S.interval+h,f=d-I;f+b>p&&(t.action="handshake")}}"handshake"===t.action&&(t.delay=0,r.reset(!1),this.resetBackoffPeriod())}n.call(c,t)},this.receive=_receive,L=function(e){c._debug("Received",e);for(var t=0;t<e.length;++t){_receive(e[t])}},N=function(e,t,n){c._debug("handleFailure",e,t,n),n.transport=e;for(var i=0;i<t.length;++i){var r=t[i],o={id:r.id,successful:!1,channel:r.channel,failure:n};switch(n.message=r,r.channel){case"/meta/handshake":_handshakeFailure(o);break;case"/meta/connect":_connectFailure(o);break;case"/meta/disconnect":_disconnectFailure(o);break;case"/meta/subscribe":o.subscription=r.subscription,_subscribeFailure(o);break;case"/meta/unsubscribe":o.subscription=r.subscription,_unsubscribeFailure(o);break;default:_messageFailure(o)}}},this.registerTransport=function(e,t,n){var i=h.add(e,t,n);return i&&(this._debug("Registered transport",e),_isFunction(t.registered)&&t.registered(e,this)),i},this.unregisterTransport=function(e){var t=h.remove(e);return null!==t&&(this._debug("Unregistered transport",e),_isFunction(t.unregistered)&&t.unregistered()),t},this.unregisterTransports=function(){h.clear()},this.getTransportTypes=function(){return h.getTransportTypes()},this.findTransport=function(e){return h.find(e)},this.getTransportRegistry=function(){return h},this.configure=function(e){_configure.call(this,e)},this.init=function(e,t){this.configure(e),this.handshake(t)},this.handshake=function(e,t){if("disconnected"!==p)throw"Illegal state: handshaken";_handshake(e,t)},this.disconnect=function(e,t,n){if(!_isDisconnected()){"boolean"!=typeof e&&(n=t,t=e,e=!1),_isFunction(t)&&(n=t,t=void 0);var i={id:_nextMessageId(),channel:"/meta/disconnect"},r=this._mixin(!1,{},t,i);c._putCallback(r.id,n),_setStatus("disconnecting"),_send(!0===e,[r],!1,"disconnect")}},this.startBatch=function(){_startBatch()},this.endBatch=function(){_endBatch()},this.batch=function(e,t){var n=_resolveScopedCallback(e,t);this.startBatch();try{n.method.call(n.scope),this.endBatch()}catch(e){throw this._info("Exception during execution of batch",e),this.endBatch(),e}},this.addListener=function(e,t,n){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!_isString(e))throw"Illegal argument type: channel must be a string";return _addListener(e,t,n,!0)},this.removeListener=function(e){if(!(e&&e.channel&&"id"in e))throw"Invalid argument: expected subscription, not "+e;_removeListener(e)},this.clearListeners=function(){x={}},this.subscribe=function(e,t,n,i,r){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!_isString(e))throw"Illegal argument type: channel must be a string";if(_isDisconnected())throw"Illegal state: disconnected";_isFunction(t)&&(r=i,i=n,n=t,t=void 0),_isFunction(i)&&(r=i,i=void 0);var o=!_hasSubscriptions(e),a=_addListener(e,t,n,!1);if(o){var s={id:_nextMessageId(),channel:"/meta/subscribe",subscription:e},l=this._mixin(!1,{},i,s);c._putCallback(l.id,r),_queueSend(l)}return a},this.unsubscribe=function(e,t,n){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(_isDisconnected())throw"Illegal state: disconnected";_isFunction(t)&&(n=t,t=void 0),this.removeListener(e);var i=e.channel;if(!_hasSubscriptions(i)){var r={id:_nextMessageId(),channel:"/meta/unsubscribe",subscription:i},o=this._mixin(!1,{},t,r);c._putCallback(o.id,n),_queueSend(o)}},this.resubscribe=function(e,t){if(_removeSubscription(e),e)return this.subscribe(e.channel,e.scope,e.callback,t)},this.clearSubscriptions=function(){_clearSubscriptions()},this.publish=function(e,t,n,i){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(!_isString(e))throw"Illegal argument type: channel must be a string";if(/^\/meta\//.test(e))throw"Illegal argument: cannot publish to meta channels";if(_isDisconnected())throw"Illegal state: disconnected";_isFunction(t)?(i=t,t={},n=void 0):_isFunction(n)&&(i=n,n=void 0);var r={id:_nextMessageId(),channel:e,data:t},o=this._mixin(!1,{},n,r);c._putCallback(o.id,i),_queueSend(o)},this.publishBinary=function(e,t,n,i,r){_isFunction(t)?(r=t,t=new ArrayBuffer(0),n=!0,i=void 0):_isFunction(n)?(r=n,n=!0,i=void 0):_isFunction(i)&&(r=i,i=void 0);var o={meta:i,data:t,last:n},a={ext:{binary:{}}};this.publish(e,o,a,r)},this.remoteCall=function(t,n,i,r,o){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(!_isString(t))throw"Illegal argument type: target must be a string";if(_isDisconnected())throw"Illegal state: disconnected";if(_isFunction(n)?(o=n,n={},i=k.maxNetworkDelay,r=void 0):_isFunction(i)?(o=i,i=k.maxNetworkDelay,r=void 0):_isFunction(r)&&(o=r,r=void 0),"number"!=typeof i)throw"Illegal argument type: timeout must be a number";t.match(/^\//)||(t="/"+t);var a="/service"+t,s={id:_nextMessageId(),channel:a,data:n},l=this._mixin(!1,{},r,s),u={callback:o};i>0&&(u.timeout=e.setTimeout(c,function(){c._debug("Timing out remote call",l,"after",i,"ms"),_failMessage({id:l.id,error:"406::timeout",successful:!1,failure:{message:l,reason:"Remote Call Timeout"}})},i),c._debug("Scheduled remote call timeout",l,"in",i,"ms")),A[l.id]=u,_queueSend(l)},this.remoteCallBinary=function(e,t,n,i,r,o){_isFunction(t)?(o=t,t=new ArrayBuffer(0),n=!0,i=void 0,r=k.maxNetworkDelay):_isFunction(n)?(o=n,n=!0,i=void 0,r=k.maxNetworkDelay):_isFunction(i)?(o=i,i=void 0,r=k.maxNetworkDelay):_isFunction(r)&&(o=r,r=k.maxNetworkDelay);var a={meta:i,data:t,last:n},s={ext:{binary:{}}};this.remoteCall(e,a,r,s,o)},this.getStatus=function(){return p},this.isDisconnected=_isDisconnected,this.setBackoffIncrement=function(e){k.backoffIncrement=e},this.getBackoffIncrement=function(){return k.backoffIncrement},this.getBackoffPeriod=function(){return b},this.increaseBackoffPeriod=function(){return _increaseBackoff()},this.resetBackoffPeriod=function(){_resetBackoff()},this.setLogLevel=function(e){k.logLevel=e},this.registerExtension=function(e,t){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!_isString(e))throw"Illegal argument type: extension name must be a string";for(var n=!1,i=0;i<C.length;++i){if(C[i].name===e){n=!0;break}}return n?(this._info("Could not register extension with name",e,"since another extension with the same name already exists"),!1):(C.push({name:e,extension:t}),this._debug("Registered extension",e),_isFunction(t.registered)&&t.registered(e,this),!0)},this.unregisterExtension=function(e){if(!_isString(e))throw"Illegal argument type: extension name must be a string";for(var t=!1,n=0;n<C.length;++n){var i=C[n];if(i.name===e){C.splice(n,1),t=!0,this._debug("Unregistered extension",e);var r=i.extension;_isFunction(r.unregistered)&&r.unregistered();break}}return t},this.getExtension=function(e){for(var t=0;t<C.length;++t){var n=C[t];if(n.name===e)return n.extension}return null},this.getName=function(){return u},this.getClientId=function(){return g},this.getURL=function(){if(i){var e=i.getURL();if(e)return e;if(e=k.urls[i.getType()])return e}return k.url},this.getTransport=function(){return i},this.getConfiguration=function(){return this._mixin(!0,{},k)},this.getAdvice=function(){return this._mixin(!0,{},S)},window.WebSocket&&this.registerTransport("websocket",new a),this.registerTransport("long-polling",new r),this.registerTransport("callback-polling",new o)},l=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z",".","-",":","+","=","^","!","/","*","?","&","<",">","(",")","[","]","{","}","@","%","$","#"],c=[0,68,0,84,83,82,72,0,75,76,70,65,0,63,62,69,0,1,2,3,4,5,6,7,8,9,64,0,73,66,74,71,81,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,77,0,78,67,0,0,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,79,0,80,0,0];return{CometD:s,Transport:n,RequestTransport:i,LongPollingTransport:r,CallbackPollingTransport:o,WebSocketTransport:a,Utils:e,Z85:{encode:function(e){var t=null;if(e instanceof ArrayBuffer?t=e:e.buffer instanceof ArrayBuffer?t=e.buffer:Array.isArray(e)&&(t=new Uint8Array(e).buffer),null==t)throw"Cannot Z85 encode "+e;for(var n=t.byteLength,i=n%4,r=4-(0===i?4:i),o=new DataView(t),a="",s=0,c=0;c<n+r;++c){var u=c>=n;if(s=256*s+(u?0:o.getUint8(c)),(c+1)%4==0){for(var d=52200625,h=5;h>0;--h){if(!u||h>r){var p=Math.floor(s/d)%85;a+=l[p]}d/=85}s=0}}return a},decode:function(e){for(var t=e.length%5,n=5-(0===t?5:t),i=0;i<n;++i)e+=l[l.length-1];for(var r=e.length,o=new ArrayBuffer(4*r/5-n),a=new DataView(o),s=0,u=0,d=0,h=0;h<r;++h){var p=e.charCodeAt(u++)-32;if(s=85*s+c[p],u%5==0){for(var f=16777216;f>=1;)d<a.byteLength&&a.setUint8(d++,Math.floor(s/f)%256),f/=256;s=0}}return o}}}})},function(e,t,n){var i,r;!function(o){i=[n(0),n(96)],void 0!==(r=function(e){return o(e,window,document)}.apply(t,i))&&(e.exports=r)}(function(e,t,n,i){var r=e.fn.dataTable;return e.extend(!0,r.defaults,{dom:"<'row'<'col-sm-6'l><'col-sm-6'f>><'row'<'col-sm-12'tr>><'row'<'col-sm-5'i><'col-sm-7'p>>",renderer:"bootstrap"}),e.extend(r.ext.classes,{sWrapper:"dataTables_wrapper form-inline dt-bootstrap",sFilterInput:"form-control input-sm",sLengthSelect:"form-control input-sm",sProcessing:"dataTables_processing panel panel-default"}),r.ext.renderer.pageButton.bootstrap=function(t,o,a,s,l,c){var u,d,h,p=new r.Api(t),f=t.oClasses,g=t.oLanguage.oPaginate,m=t.oLanguage.oAria.paginate||{},v=0,_=function(n,i){var r,o,s,h,y=function(t){t.preventDefault(),!e(t.currentTarget).hasClass("disabled")&&p.page()!=t.data.action&&p.page(t.data.action).draw("page")};for(r=0,o=i.length;r<o;r++)if(h=i[r],e.isArray(h))_(n,h);else{switch(d=u="",h){case"ellipsis":u="&#x2026;",d="disabled";break;case"first":u=g.sFirst,d=h+(0<l?"":" disabled");break;case"previous":u=g.sPrevious,d=h+(0<l?"":" disabled");break;case"next":u=g.sNext,d=h+(l<c-1?"":" disabled");break;case"last":u=g.sLast,d=h+(l<c-1?"":" disabled");break;default:u=h+1,d=l===h?"active":""}u&&(s=e("<li>",{class:f.sPageButton+" "+d,id:0===a&&"string"==typeof h?t.sTableId+"_"+h:null}).append(e("<a>",{href:"#","aria-controls":t.sTableId,"aria-label":m[h],"data-dt-idx":v,tabindex:t.iTabIndex}).html(u)).appendTo(n),t.oApi._fnBindAction(s,{action:h},y),v++)}};try{h=e(o).find(n.activeElement).data("dt-idx")}catch(e){}_(e(o).empty().html('<ul class="pagination"/>').children("ul"),s),h!==i&&e(o).find("[data-dt-idx="+h+"]").focus()},r})},function(e,t,n){(function(i,r){var o,a;o=[n(1),n(8),n(17),n(6),n(7),n(4),n(3)],void 0!==(a=function(e,t,n,r,o,a,s){function setInputcol(e){pe=e}function getInputcol(e){return pe}function setOutputcol(e){fe=e}function getOutputcol(e){return fe}function setZaipData(e){p=e}function getZaipData(){return p}function getZaipInputInitParams(e){var n=e||JSON.parse(getInputcol()),i={};return n.forEach(function(e){i[e]=t.ZAIP_INPUT_PARAM}),i}function getZaipInputServerParams(e){var t={};for(var n in e){for(var i in e[n])t[i+n]=e[n][i];t["columns"+n]=n}return t}function getZaipOutputInitParams(){var e=JSON.parse(JSON.stringify(t.ZAIP_OUTPUT_PARAM));return e.colname=getOutputcol(),e}function hanlderInputData(e){var t=e.operators.filter(function(e){return"zaipInput"==e.type})[0].params,n={};for(var i in t)if(i.startsWith("columns")){var r=i.replace("columns","");n[r]={}}for(var i in t)for(var o in n)if(i.endsWith(o)&&!i.startsWith("columns")){var a=i.replace(o,"");n[o][a]=t[i]}return n}function setExperimentFlag(e){Se=e}function getExperimentFlag(){return Se}function setIsDrag(e){f=e}function isDrag(){return f}var l,c,u,d,h,p,f,g=(e.mx,null),m={},v="",_=!1,y={params:{},connects:[]},x=function(e){g=e},b=function(){return g},w=function(e){return void 0!==j(e)},C=function(e){for(var t=0,n=e||"undefined";w(n);){n=n.substring(0,n.lastIndexOf("_"))+"_"+ ++t}return n},S=function(e){m[e.id]=e},T=function(e){delete m[e]},A=function(){var e=[];return r.values(m).forEach(function(t){t.multiPort&&e.push(g.getModel().getCell(t.id))}),e},M=function(e){return m[e].params},E=function(e){if(e&&(!e.hasOwnProperty("status")||"-1"!==e.status)){var t=$(!0).operators;for(var n in e.shapeData){var i=n,r=Y(g,i);if(!r)return;g.removeCellOverlays(r),r.value.shape=e.shapeData[n]}!e.errorLayer&&e.exception&&a.error(e.exception),t.forEach(function(t){var n=Y(g,t.name);e.errorLayer&&e.errorLayer===t.name?n.value.status.msg=e.exception:n.value.status={}}),g.refresh()}},I=function(){},D=function(e){I=e},k=function(){return l},L=function(e){l=e},N=function(){return c||"/0000000000000000000000000"},P=function(e){c=e},O=!1,R=function(t){if(!_&&!se()){I(t);var n=JSON.parse(JSON.stringify($(!0)));n.operators.forEach(function(e){"zaipInput"==e.type&&(e.params=hanlderInputData(n))});var r={zaipData:JSON.stringify(getZaipData()),content:JSON.stringify(n),connectId:d},s=function(e){_||se()||E(e)},l=function(e){O||"ProcessRunningException"!==e.responseText||(O=!0,a.warning(i.i18n.prop("ict_oneminer_message_reload_msg")),u())};o.post(e.genApiUrl("task/validate"),r,s,l)}},z=function(e){u=e},F=function(){return u},B=function(t,n,i){var r=$(),o={};return o.processName=v,o.processInfo=JSON.stringify(r),o.topic=N(),o.execType=t,o.targetOperator=n,o.modifiedOperators=i,e.getDataFromServer(o,e.genApiUrl("process/execute"))},H=function(){return{params:{},operators:[],connects:[],scale:1,translate:JSON.stringify({x:0,y:0})}},V=function(){var e={operators:[],connects:[],groups:[]},t=g.getSelectionCells();return t.filter(function(e){return e&&e.value&&e.value.isOperator&&e.value.isGroup}).forEach(function(e){t=t.concat(W(e))}),t=r.uniq(t,!1,"id"),t.filter(function(e){return e&&e.value&&e.value.isOperator}).forEach(function(t,n,i){var r=m[t.id],o={name:r.name,type:r.type,id:r.id,x:t.getGeometry().x,y:t.getGeometry().y,params:r.params};i.some(function(e){return t.parent.id===e.id})&&(o.parent=t.parent.id),r.isGroup?(o.width=t.getGeometry().width,o.height=t.getGeometry().height,o.children=G(t),e.groups.push(o)):(o.parents=q(t),e.operators.push(o))}),e.operators.forEach(function(t){e.groups.some(function(e){return e.id===t.parent})||delete t.parent}),r.uniq(U(g.getSelectionCells()),!1,"id").forEach(function(n){var i={},r=n.source.getParent(),o=n.target.getParent(),a=t.some(function(e){return e.id===r.id}),s=t.some(function(e){return e.id===o.id});a&&s&&(r.isVertex()&&(i.from_op=r.value.name),i.from_port=n.source.value.name,o.isVertex()&&(i.to_op=o.value.name),i.to_port=n.target.value.name,e.connects.push(i))}),e},W=function getLoopChildren(e){var t=[];return(e.children||[]).forEach(function(n){n.value&&e.value.isOperator&&(t.push(n),n.value.isGroup&&(t=t.concat(getLoopChildren(n))))}),t},U=function getConnects(e){var t=[];return e.forEach(function(e){e.edge?t.push(e):r.isEmpty(e.children)||(t=t.concat(getConnects(e.children)))}),t},$=function(e){var t={params:{},operators:[],connects:[],groups:[]};t.params=y.params,t.scale=g.getView().getScale(),t.translate=JSON.stringify(g.getView().getTranslate());var n=g.getModel();g.getDefaultParent();n.filterDescendants(function(e){return e&&e.value&&e.value.isOperator}).forEach(function(n){var i=m[n.id];if(e||!i.invalid){var r={};r.name=i.name,r.type=i.type,r.id=i.id,r.parent=n.parent.id,r.x=n.getGeometry().x,r.y=n.getGeometry().y,r.params=i.params,i.isGroup?(r.width=n.getGeometry().width,r.height=n.getGeometry().height,r.children=G(n),t.groups.push(r)):(r.parents=q(n),t.operators.push(r))}});var i=function(e){return n.isEdge(e)};return n.filterDescendants(i).forEach(function(n){if(e||!n.source.parent.value.invalid){var i={};n.source.getParent().isVertex()&&(i.from_op=n.source.getParent().value.name),i.from_port=n.source.value.name,n.target.getParent().isVertex()&&(i.to_op=n.target.getParent().value.name),i.to_port=n.target.value.name,t.connects.push(i)}}),t},G=function getChildren(e){var t=[];return r.isEmpty(e.children)||e.children.forEach(function(e){e.value&&e.value.isGroup?(t=t.concat(getChildren(e)),t.push(e.value.name)):e.value&&e.value.isOperator&&t.push(e.value.name)}),t},q=function getParents(e){var t=[];return e.parent.value&&e.parent.value.isGroup&&(t.push(e.parent.value.name),t=t.concat(getParents(e.parent))),t},j=function(e){var t;return r.keys(m).some(function(n){if(m[n].name===e)return t=n,!0}),t},Y=function(e,t){var n=j(t);return n?e.getModel().getCell(n):null},X=function(e){return _},Z=function(e){_=e},K=function(){return y.params},J=function(e){e&&(y.params=e)},Q=function(){return v},ee=function(){return y.params.type?y.params.type:0},te=function(e){v=e,P("/"+n.md5(v))},ne=function(e,t){m[e].name=t},ie=function(){var t=K();return t[e.clusterKey]?t[e.clusterKey]:e.getDefaultConnectId()},re=function(e){e.forEach(function(e){e.children&&e.children.forEach(function(e){e.getEdgeCount()&&e.edges.forEach(function(e){var t=e.source,n=e.target;(!t.parent.value.invalid||n.parent.value.isOperator&&!n.parent.value.invalid)&&g.removeCells([e])})})})},oe=function(e,t){var n=[],i=e.dataSet.concat(t.dataSet);r.values(m).forEach(function(e){var t=Y(g,e.name);e.invalid||r.contains(i,e.type)?e.invalid&&r.contains(i,e.type)&&(e.invalid=!1,t.value.invalid=!1,t.setStyle(t.getStyle().replace("fillColor=#999999;","")),t.children&&t.children.forEach(function(e){e.setConnectable(!0)})):(e.invalid=!0,t.value.invalid=!0,t.setStyle(t.getStyle()+"fillColor=#999999;"),t.children&&t.children.forEach(function(e){e.setConnectable(!1)}),n.push(t))}),re(n),_||g.refresh()},ae=!1,se=function(){return ae},le=function(e){ae=e},ce=function(t){v&&e.doStop(v,t)},ue=function(){var e=[];return{addMethod:function(t,n){e.push({name:n,funct:t})},getMethod:function(t){return e.filter(function(e){return e.name===t})[0].funct||function(){}}}}(),de=function(e){d=e},he=function(){return d},pe=[],fe="",ge=function(){return h},me=function(e){h=e},ve={},_e=function(e,t){if(t)return void(ve[e]=t);ve[e]=$(!0)},ye=function(e){return e?ve[e]:ve},xe=function(e){e?delete ve[e]:ve={}},be=!0,we=function(e){be=e},Ce=function(){return be},Se=!1,Te={};return Te.stop=ce,Te.getName=C,Te.isExist=w,Te.setGraph=x,Te.getGraph=b,Te.addOperator=S,Te.removeOperatorById=T,Te.getEmptyProcessInfo=H,Te.getProcessInfo=$,Te.getOperatorParams=M,Te.getMultiPortOperators=A,Te.run=B,Te.refresh=E,Te.updateData=R,Te.getOperatorAsCell=Y,Te.getParams=K,Te.setParams=J,Te.getLoadingStatus=X,Te.setLoadingStatus=Z,Te.setModifiedOperators=L,Te.getModifiedOperators=k,Te.getProcessName=Q,Te.setProcessName=te,Te.getProcessType=ee,Te.setOperatorName=ne,Te.setChangeEvent=D,Te.switchExecuteFrameWork=oe,Te.getTopic=N,Te.isRunning=se,Te.setRunning=le,Te.getCurrentConnectId=ie,Te.setInitProcess=z,Te.getInitProcess=F,Te.methodProxy=ue,Te.getSelectProcessInfo=V,Te.setZaipId=de,Te.getZaipId=he,Te.setOpName=me,Te.getOpName=ge,Te.setInputcol=setInputcol,Te.getInputcol=getInputcol,Te.setOutputcol=setOutputcol,Te.getOutputcol=getOutputcol,Te.setZaipData=setZaipData,Te.getZaipData=getZaipData,Te.getZaipInputInitParams=getZaipInputInitParams,Te.getZaipInputServerParams=getZaipInputServerParams,Te.getZaipOutputInitParams=getZaipOutputInitParams,Te.setCacheTrain=_e,Te.getCacheTrain=ye,Te.setEditable=we,Te.getEditable=Ce,Te.hanlderInputData=hanlderInputData,Te.setExperimentFlag=setExperimentFlag,Te.getExperimentFlag=getExperimentFlag,Te.clearCacheTrain=xe,Te.setIsDrag=setIsDrag,Te.isDrag=isDrag,Te}.apply(t,o))&&(e.exports=a)}).call(t,n(0),n(68))},function(e,t,n){!function(e){e(n(9))}(function(e){"use strict";e.defineMode("sql",function(t,n){function tokenBase(e,t){var n=e.next();if(c[n]){var d=c[n](e,t);if(!1!==d)return d}if(l.hexNumber&&("0"==n&&e.match(/^[xX][0-9a-fA-F]+/)||("x"==n||"X"==n)&&e.match(/^'[0-9a-fA-F]+'/)))return"number";if(l.binaryNumber&&(("b"==n||"B"==n)&&e.match(/^'[01]+'/)||"0"==n&&e.match(/^b[01]+/)))return"number";if(n.charCodeAt(0)>47&&n.charCodeAt(0)<58)return e.match(/^[0-9]*(\.[0-9]+)?([eE][-+]?[0-9]+)?/),l.decimallessFloat&&e.match(/^\.(?!\.)/),"number";if("?"==n&&(e.eatSpace()||e.eol()||e.eat(";")))return"variable-3";if("'"==n||'"'==n&&l.doubleQuote)return t.tokenize=tokenLiteral(n),t.tokenize(e,t);if((l.nCharCast&&("n"==n||"N"==n)||l.charsetCast&&"_"==n&&e.match(/[a-z][a-z0-9]*/i))&&("'"==e.peek()||'"'==e.peek()))return"keyword";if(/^[\(\),\;\[\]]/.test(n))return null;if(l.commentSlashSlash&&"/"==n&&e.eat("/"))return e.skipToEnd(),"comment";if(l.commentHash&&"#"==n||"-"==n&&e.eat("-")&&(!l.commentSpaceRequired||e.eat(" ")))return e.skipToEnd(),"comment";if("/"==n&&e.eat("*"))return t.tokenize=tokenComment(1),t.tokenize(e,t);if("."!=n){if(s.test(n))return e.eatWhile(s),null;if("{"==n&&(e.match(/^( )*(d|D|t|T|ts|TS)( )*'[^']*'( )*}/)||e.match(/^( )*(d|D|t|T|ts|TS)( )*"[^"]*"( )*}/)))return"number";e.eatWhile(/^[_\w\d]/);var h=e.current().toLowerCase();return u.hasOwnProperty(h)&&(e.match(/^( )+'[^']*'/)||e.match(/^( )+"[^"]*"/))?"number":r.hasOwnProperty(h)?"atom":o.hasOwnProperty(h)?"builtin":a.hasOwnProperty(h)?"keyword":i.hasOwnProperty(h)?"string-2":null}return l.zerolessFloat&&e.match(/^(?:\d+(?:e[+-]?\d+)?)/i)?"number":e.match(/^\.+/)?null:l.ODBCdotTable&&e.match(/^[\w\d_]+/)?"variable-2":void 0}function tokenLiteral(e){return function(t,n){for(var i,r=!1;null!=(i=t.next());){if(i==e&&!r){n.tokenize=tokenBase;break}r=!r&&"\\"==i}return"string"}}function tokenComment(e){return function(t,n){var i=t.match(/^.*?(\/\*|\*\/)/);return i?"/*"==i[1]?n.tokenize=tokenComment(e+1):n.tokenize=e>1?tokenComment(e-1):tokenBase:t.skipToEnd(),"comment"}}function pushContext(e,t,n){t.context={prev:t.context,indent:e.indentation(),col:e.column(),type:n}}function popContext(e){e.indent=e.context.indent,e.context=e.context.prev}var i=n.client||{},r=n.atoms||{false:!0,true:!0,null:!0},o=n.builtin||{},a=n.keywords||{},s=n.operatorChars||/^[*+\-%<>!=&|~^]/,l=n.support||{},c=n.hooks||{},u=n.dateSQL||{date:!0,time:!0,timestamp:!0};return{startState:function(){return{tokenize:tokenBase,context:null}},token:function(e,t){if(e.sol()&&t.context&&null==t.context.align&&(t.context.align=!1),t.tokenize==tokenBase&&e.eatSpace())return null;var n=t.tokenize(e,t);if("comment"==n)return n;t.context&&null==t.context.align&&(t.context.align=!0);var i=e.current();return"("==i?pushContext(e,t,")"):"["==i?pushContext(e,t,"]"):t.context&&t.context.type==i&&popContext(t),n},indent:function(n,i){var r=n.context;if(!r)return e.Pass;var o=i.charAt(0)==r.type;return r.align?r.col+(o?0:1):r.indent+(o?0:t.indentUnit)},blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:l.commentSlashSlash?"//":l.commentHash?"#":"--"}}),function(){function hookIdentifier(e){for(var t;null!=(t=e.next());)if("`"==t&&!e.eat("`"))return"variable-2";return e.backUp(e.current().length-1),e.eatWhile(/\w/)?"variable-2":null}function hookIdentifierDoublequote(e){for(var t;null!=(t=e.next());)if('"'==t&&!e.eat('"'))return"variable-2";return e.backUp(e.current().length-1),e.eatWhile(/\w/)?"variable-2":null}function hookVar(e){return e.eat("@")&&(e.match(/^session\./),e.match(/^local\./),e.match(/^global\./)),e.eat("'")?(e.match(/^.*'/),"variable-2"):e.eat('"')?(e.match(/^.*"/),"variable-2"):e.eat("`")?(e.match(/^.*`/),"variable-2"):e.match(/^[0-9a-zA-Z$\.\_]+/)?"variable-2":null}function hookClient(e){return e.eat("N")?"atom":e.match(/^[a-zA-Z.#!?]/)?"variable-2":null}function set(e){for(var t={},n=e.split(" "),i=0;i<n.length;++i)t[n[i]]=!0;return t}var t="alter and as asc between by count create delete desc distinct drop from group having in insert into is join like not on or order select set table union update values where limit ";e.defineMIME("text/x-sql",{name:"sql",keywords:set(t+"begin"),builtin:set("bool boolean bit blob enum long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision real date datetime year unsigned signed decimal numeric"),atoms:set("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:set("date time timestamp"),support:set("ODBCdotTable doubleQuote binaryNumber hexNumber")}),e.defineMIME("text/x-mssql",{name:"sql",client:set("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:set(t+"begin trigger proc view index for add constraint key primary foreign collate clustered nonclustered declare exec"),builtin:set("bigint numeric bit smallint decimal smallmoney int tinyint money float real char varchar text nchar nvarchar ntext binary varbinary image cursor timestamp hierarchyid uniqueidentifier sql_variant xml table "),atoms:set("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:set("date datetimeoffset datetime2 smalldatetime datetime time"),hooks:{"@":hookVar}}),e.defineMIME("text/x-mysql",{name:"sql",client:set("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:set(t+"accessible action add after algorithm all analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general get global grant grants group group_concat handler hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show signal slave slow smallint snapshot soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),builtin:set("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),atoms:set("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^]/,dateSQL:set("date time timestamp"),support:set("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),hooks:{"@":hookVar,"`":hookIdentifier,"\\":hookClient}}),e.defineMIME("text/x-mariadb",{name:"sql",client:set("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:set(t+"accessible action add after algorithm all always analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general generated get global grant grants group groupby_concat handler hard hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password persistent phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show shutdown signal slave slow smallint snapshot soft soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views virtual warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),builtin:set("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),atoms:set("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^]/,dateSQL:set("date time timestamp"),support:set("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),hooks:{"@":hookVar,"`":hookIdentifier,"\\":hookClient}}),e.defineMIME("text/x-sqlite",{name:"sql",client:set("auth backup bail binary changes check clone databases dbinfo dump echo eqp exit explain fullschema headers help import imposter indexes iotrace limit lint load log mode nullvalue once open output print prompt quit read restore save scanstats schema separator session shell show stats system tables testcase timeout timer trace vfsinfo vfslist vfsname width"),keywords:set(t+"abort action add after all analyze attach autoincrement before begin cascade case cast check collate column commit conflict constraint cross current_date current_time current_timestamp database default deferrable deferred detach each else end escape except exclusive exists explain fail for foreign full glob if ignore immediate index indexed initially inner instead intersect isnull key left limit match natural no notnull null of offset outer plan pragma primary query raise recursive references regexp reindex release rename replace restrict right rollback row savepoint temp temporary then to transaction trigger unique using vacuum view virtual when with without"),builtin:set("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text clob bigint int int2 int8 integer float double char varchar date datetime year unsigned signed numeric real"),atoms:set("null current_date current_time current_timestamp"),operatorChars:/^[*+\-%<>!=&|\/~]/,dateSQL:set("date time timestamp datetime"),support:set("decimallessFloat zerolessFloat"),identifierQuote:'"',hooks:{"@":hookVar,":":hookVar,"?":hookVar,$:hookVar,'"':hookIdentifierDoublequote,"`":hookIdentifier}}),e.defineMIME("text/x-cassandra",{name:"sql",client:{},keywords:set("add all allow alter and any apply as asc authorize batch begin by clustering columnfamily compact consistency count create custom delete desc distinct drop each_quorum exists filtering from grant if in index insert into key keyspace keyspaces level limit local_one local_quorum modify nan norecursive nosuperuser not of on one order password permission permissions primary quorum rename revoke schema select set storage superuser table three to token truncate ttl two type unlogged update use user users using values where with writetime"),builtin:set("ascii bigint blob boolean counter decimal double float frozen inet int list map static text timestamp timeuuid tuple uuid varchar varint"),atoms:set("false true infinity NaN"),operatorChars:/^[<>=]/,dateSQL:{},support:set("commentSlashSlash decimallessFloat"),hooks:{}}),e.defineMIME("text/x-plsql",{name:"sql",client:set("appinfo arraysize autocommit autoprint autorecovery autotrace blockterminator break btitle cmdsep colsep compatibility compute concat copycommit copytypecheck define describe echo editfile embedded escape exec execute feedback flagger flush heading headsep instance linesize lno loboffset logsource long longchunksize markup native newpage numformat numwidth pagesize pause pno recsep recsepchar release repfooter repheader serveroutput shiftinout show showmode size spool sqlblanklines sqlcase sqlcode sqlcontinue sqlnumber sqlpluscompatibility sqlprefix sqlprompt sqlterminator suffix tab term termout time timing trimout trimspool ttitle underline verify version wrap"),keywords:set("abort accept access add all alter and any array arraylen as asc assert assign at attributes audit authorization avg base_table begin between binary_integer body boolean by case cast char char_base check close cluster clusters colauth column comment commit compress connect connected constant constraint crash create current currval cursor data_base database date dba deallocate debugoff debugon decimal declare default definition delay delete desc digits dispose distinct do drop else elseif elsif enable end entry escape exception exception_init exchange exclusive exists exit external fast fetch file for force form from function generic goto grant group having identified if immediate in increment index indexes indicator initial initrans insert interface intersect into is key level library like limited local lock log logging long loop master maxextents maxtrans member minextents minus mislabel mode modify multiset new next no noaudit nocompress nologging noparallel not nowait number_base object of off offline on online only open option or order out package parallel partition pctfree pctincrease pctused pls_integer positive positiven pragma primary prior private privileges procedure public raise range raw read rebuild record ref references refresh release rename replace resource restrict return returning returns reverse revoke rollback row rowid rowlabel rownum rows run savepoint schema segment select separate session set share snapshot some space split sql start statement storage subtype successful synonym tabauth table tables tablespace task terminate then to trigger truncate type union unique unlimited unrecoverable unusable update use using validate value values variable view views when whenever where while with work"),builtin:set("abs acos add_months ascii asin atan atan2 average bfile bfilename bigserial bit blob ceil character chartorowid chr clob concat convert cos cosh count dec decode deref dual dump dup_val_on_index empty error exp false float floor found glb greatest hextoraw initcap instr instrb int integer isopen last_day least length lengthb ln lower lpad ltrim lub make_ref max min mlslabel mod months_between natural naturaln nchar nclob new_time next_day nextval nls_charset_decl_len nls_charset_id nls_charset_name nls_initcap nls_lower nls_sort nls_upper nlssort no_data_found notfound null number numeric nvarchar2 nvl others power rawtohex real reftohex round rowcount rowidtochar rowtype rpad rtrim serial sign signtype sin sinh smallint soundex sqlcode sqlerrm sqrt stddev string substr substrb sum sysdate tan tanh to_char text to_date to_label to_multi_byte to_number to_single_byte translate true trunc uid unlogged upper user userenv varchar varchar2 variance varying vsize xml"),operatorChars:/^[*+\-%<>!=~]/,dateSQL:set("date time timestamp"),support:set("doubleQuote nCharCast zerolessFloat binaryNumber hexNumber")}),e.defineMIME("text/x-hive",{name:"sql",keywords:set("select alter $elem$ $key$ $value$ add after all analyze and archive as asc before between binary both bucket buckets by cascade case cast change cluster clustered clusterstatus collection column columns comment compute concatenate continue create cross cursor data database databases dbproperties deferred delete delimited desc describe directory disable distinct distribute drop else enable end escaped exclusive exists explain export extended external false fetch fields fileformat first format formatted from full function functions grant group having hold_ddltime idxproperties if import in index indexes inpath inputdriver inputformat insert intersect into is items join keys lateral left like limit lines load local location lock locks mapjoin materialized minus msck no_drop nocompress not of offline on option or order out outer outputdriver outputformat overwrite partition partitioned partitions percent plus preserve procedure purge range rcfile read readonly reads rebuild recordreader recordwriter recover reduce regexp rename repair replace restrict revoke right rlike row schema schemas semi sequencefile serde serdeproperties set shared show show_database sort sorted ssl statistics stored streamtable table tables tablesample tblproperties temporary terminated textfile then tmp to touch transform trigger true unarchive undo union uniquejoin unlock update use using utc utc_tmestamp view when where while with"),builtin:set("bool boolean long timestamp tinyint smallint bigint int float double date datetime unsigned string array struct map uniontype"),atoms:set("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:set("date timestamp"),support:set("ODBCdotTable doubleQuote binaryNumber hexNumber")}),e.defineMIME("text/x-pgsql",{name:"sql",client:set("source"),keywords:set(t+"a abort abs absent absolute access according action ada add admin after aggregate all allocate also always analyse analyze any are array array_agg array_max_cardinality asensitive assertion assignment asymmetric at atomic attribute attributes authorization avg backward base64 before begin begin_frame begin_partition bernoulli binary bit_length blob blocked bom both breadth c cache call called cardinality cascade cascaded case cast catalog catalog_name ceil ceiling chain characteristics characters character_length character_set_catalog character_set_name character_set_schema char_length check checkpoint class class_origin clob close cluster coalesce cobol collate collation collation_catalog collation_name collation_schema collect column columns column_name command_function command_function_code comment comments commit committed concurrently condition condition_number configuration conflict connect connection connection_name constraint constraints constraint_catalog constraint_name constraint_schema constructor contains content continue control conversion convert copy corr corresponding cost covar_pop covar_samp cross csv cube cume_dist current current_catalog current_date current_default_transform_group current_path current_role current_row current_schema current_time current_timestamp current_transform_group_for_type current_user cursor cursor_name cycle data database datalink datetime_interval_code datetime_interval_precision day db deallocate dec declare default defaults deferrable deferred defined definer degree delimiter delimiters dense_rank depth deref derived describe descriptor deterministic diagnostics dictionary disable discard disconnect dispatch dlnewcopy dlpreviouscopy dlurlcomplete dlurlcompleteonly dlurlcompletewrite dlurlpath dlurlpathonly dlurlpathwrite dlurlscheme dlurlserver dlvalue do document domain dynamic dynamic_function dynamic_function_code each element else empty enable encoding encrypted end end-exec end_frame end_partition enforced enum equals escape event every except exception exclude excluding exclusive exec execute exists exp explain expression extension external extract false family fetch file filter final first first_value flag float floor following for force foreign fortran forward found frame_row free freeze fs full function functions fusion g general generated get global go goto grant granted greatest grouping groups handler header hex hierarchy hold hour id identity if ignore ilike immediate immediately immutable implementation implicit import including increment indent index indexes indicator inherit inherits initially inline inner inout input insensitive instance instantiable instead integrity intersect intersection invoker isnull isolation k key key_member key_type label lag language large last last_value lateral lead leading leakproof least left length level library like_regex link listen ln load local localtime localtimestamp location locator lock locked logged lower m map mapping match matched materialized max maxvalue max_cardinality member merge message_length message_octet_length message_text method min minute minvalue mod mode modifies module month more move multiset mumps name names namespace national natural nchar nclob nesting new next nfc nfd nfkc nfkd nil no none normalize normalized nothing notify notnull nowait nth_value ntile null nullable nullif nulls number object occurrences_regex octets octet_length of off offset oids old only open operator option options ordering ordinality others out outer output over overlaps overlay overriding owned owner p pad parallel parameter parameter_mode parameter_name parameter_ordinal_position parameter_specific_catalog parameter_specific_name parameter_specific_schema parser partial partition pascal passing passthrough password percent percentile_cont percentile_disc percent_rank period permission placing plans pli policy portion position position_regex power precedes preceding prepare prepared preserve primary prior privileges procedural procedure program public quote range rank read reads reassign recheck recovery recursive ref references referencing refresh regr_avgx regr_avgy regr_count regr_intercept regr_r2 regr_slope regr_sxx regr_sxy regr_syy reindex relative release rename repeatable replace replica requiring reset respect restart restore restrict restricted result return returned_cardinality returned_length returned_octet_length returned_sqlstate returning returns revoke right role rollback rollup routine routine_catalog routine_name routine_schema row rows row_count row_number rule savepoint scale schema schema_name scope scope_catalog scope_name scope_schema scroll search second section security selective self sensitive sequence sequences serializable server server_name session session_user setof sets share show similar simple size skip snapshot some source space specific specifictype specific_name sql sqlcode sqlerror sqlexception sqlstate sqlwarning sqrt stable standalone start state statement static statistics stddev_pop stddev_samp stdin stdout storage strict strip structure style subclass_origin submultiset substring substring_regex succeeds sum symmetric sysid system system_time system_user t tables tablesample tablespace table_name temp template temporary then ties timezone_hour timezone_minute to token top_level_count trailing transaction transactions_committed transactions_rolled_back transaction_active transform transforms translate translate_regex translation treat trigger trigger_catalog trigger_name trigger_schema trim trim_array true truncate trusted type types uescape unbounded uncommitted under unencrypted unique unknown unlink unlisten unlogged unnamed unnest until untyped upper uri usage user user_defined_type_catalog user_defined_type_code user_defined_type_name user_defined_type_schema using vacuum valid validate validator value value_of varbinary variadic var_pop var_samp verbose version versioning view views volatile when whenever whitespace width_bucket window within work wrapper write xmlagg xmlattributes xmlbinary xmlcast xmlcomment xmlconcat xmldeclaration xmldocument xmlelement xmlexists xmlforest xmliterate xmlnamespaces xmlparse xmlpi xmlquery xmlroot xmlschema xmlserialize xmltable xmltext xmlvalidate year yes loop repeat attach path depends detach zone"),builtin:set("bigint int8 bigserial serial8 bit varying varbit boolean bool box bytea character char varchar cidr circle date double precision float8 inet integer int int4 interval json jsonb line lseg macaddr macaddr8 money numeric decimal path pg_lsn point polygon real float4 smallint int2 smallserial serial2 serial serial4 text time without zone with timetz timestamp timestamptz tsquery tsvector txid_snapshot uuid xml"),atoms:set("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^\/#@?~]/,dateSQL:set("date time timestamp"),support:set("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber nCharCast charsetCast")}),e.defineMIME("text/x-gql",{name:"sql",keywords:set("ancestor and asc by contains desc descendant distinct from group has in is limit offset on order select superset where"),atoms:set("false true"),builtin:set("blob datetime first key __key__ string integer double boolean null"),operatorChars:/^[*+\-%<>!=]/}),e.defineMIME("text/x-gpsql",{name:"sql",client:set("source"),keywords:set("abort absolute access action active add admin after aggregate all also alter always analyse analyze and any array as asc assertion assignment asymmetric at authorization backward before begin between bigint binary bit boolean both by cache called cascade cascaded case cast chain char character characteristics check checkpoint class close cluster coalesce codegen collate column comment commit committed concurrency concurrently configuration connection constraint constraints contains content continue conversion copy cost cpu_rate_limit create createdb createexttable createrole createuser cross csv cube current current_catalog current_date current_role current_schema current_time current_timestamp current_user cursor cycle data database day deallocate dec decimal declare decode default defaults deferrable deferred definer delete delimiter delimiters deny desc dictionary disable discard distinct distributed do document domain double drop dxl each else enable encoding encrypted end enum errors escape every except exchange exclude excluding exclusive execute exists explain extension external extract false family fetch fields filespace fill filter first float following for force foreign format forward freeze from full function global grant granted greatest group group_id grouping handler hash having header hold host hour identity if ignore ilike immediate immutable implicit in including inclusive increment index indexes inherit inherits initially inline inner inout input insensitive insert instead int integer intersect interval into invoker is isnull isolation join key language large last leading least left level like limit list listen load local localtime localtimestamp location lock log login mapping master match maxvalue median merge minute minvalue missing mode modifies modify month move name names national natural nchar new newline next no nocreatedb nocreateexttable nocreaterole nocreateuser noinherit nologin none noovercommit nosuperuser not nothing notify notnull nowait null nullif nulls numeric object of off offset oids old on only operator option options or order ordered others out outer over overcommit overlaps overlay owned owner parser partial partition partitions passing password percent percentile_cont percentile_disc placing plans position preceding precision prepare prepared preserve primary prior privileges procedural procedure protocol queue quote randomly range read readable reads real reassign recheck recursive ref references reindex reject relative release rename repeatable replace replica reset resource restart restrict returning returns revoke right role rollback rollup rootpartition row rows rule savepoint scatter schema scroll search second security segment select sequence serializable session session_user set setof sets share show similar simple smallint some split sql stable standalone start statement statistics stdin stdout storage strict strip subpartition subpartitions substring superuser symmetric sysid system table tablespace temp template temporary text then threshold ties time timestamp to trailing transaction treat trigger trim true truncate trusted type unbounded uncommitted unencrypted union unique unknown unlisten until update user using vacuum valid validation validator value values varchar variadic varying verbose version view volatile web when where whitespace window with within without work writable write xml xmlattributes xmlconcat xmlelement xmlexists xmlforest xmlparse xmlpi xmlroot xmlserialize year yes zone"),builtin:set("bigint int8 bigserial serial8 bit varying varbit boolean bool box bytea character char varchar cidr circle date double precision float float8 inet integer int int4 interval json jsonb line lseg macaddr macaddr8 money numeric decimal path pg_lsn point polygon real float4 smallint int2 smallserial serial2 serial serial4 text time without zone with timetz timestamp timestamptz tsquery tsvector txid_snapshot uuid xml"),atoms:set("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^\/#@?~]/,dateSQL:set("date time timestamp"),support:set("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber nCharCast charsetCast")}),e.defineMIME("text/x-sparksql",{name:"sql",keywords:set("add after all alter analyze and anti archive array as asc at between bucket buckets by cache cascade case cast change clear cluster clustered codegen collection column columns comment commit compact compactions compute concatenate cost create cross cube current current_date current_timestamp database databases datata dbproperties defined delete delimited desc describe dfs directories distinct distribute drop else end escaped except exchange exists explain export extended external false fields fileformat first following for format formatted from full function functions global grant group grouping having if ignore import in index indexes inner inpath inputformat insert intersect interval into is items join keys last lateral lazy left like limit lines list load local location lock locks logical macro map minus msck natural no not null nulls of on option options or order out outer outputformat over overwrite partition partitioned partitions percent preceding principals purge range recordreader recordwriter recover reduce refresh regexp rename repair replace reset restrict revoke right rlike role roles rollback rollup row rows schema schemas select semi separated serde serdeproperties set sets show skewed sort sorted start statistics stored stratify struct table tables tablesample tblproperties temp temporary terminated then to touch transaction transactions transform true truncate unarchive unbounded uncache union unlock unset use using values view when where window with"),builtin:set("tinyint smallint int bigint boolean float double string binary timestamp decimal array map struct uniontype delimited serde sequencefile textfile rcfile inputformat outputformat"),atoms:set("false true null"),operatorChars:/^[*+\-%<>!=~&|^]/,dateSQL:set("date time timestamp"),support:set("ODBCdotTable doubleQuote zerolessFloat")})}()})},function(e,t,n){(function(e,t){new function(n){var i=n.separator||"&",r=!1!==n.spaces,o=!1!==n.prefix,a=o?!0===n.hash?"#":"?":"",s=!1!==n.numbers;e.query=new function(){var n=function(e,t){return void 0!=e&&null!==e&&(!t||e.constructor==t)},o=function(e){for(var t,n=/\[([^[]*)\]/g,i=/^([^[]+)(\[.*\])?$/.exec(e),r=i[1],o=[];t=n.exec(i[2]);)o.push(t[1]);return[r,o]},l=function(e,t,i){var r=t.shift();if("object"!=typeof e&&(e=null),""===r)if(e||(e=[]),n(e,Array))e.push(0==t.length?i:l(null,t.slice(0),i));else if(n(e,Object)){for(var o=0;null!=e[o++];);e[--o]=0==t.length?i:l(e[o],t.slice(0),i)}else e=[],e.push(0==t.length?i:l(null,t.slice(0),i));else if(r&&r.match(/^\s*[0-9]+\s*$/)){var a=parseInt(r,10);e||(e=[]),e[a]=0==t.length?i:l(e[a],t.slice(0),i)}else{if(!r)return i;var a=r.replace(/^\s*|\s*$/g,"");if(e||(e={}),n(e,Array)){for(var s={},o=0;o<e.length;++o)s[o]=e[o];e=s}e[a]=0==t.length?i:l(e[a],t.slice(0),i)}return e},c=function(t){var n=this;return n.keys={},t.queryObject?e.each(t.get(),function(e,t){n.SET(e,t)}):n.parseNew.apply(n,arguments),n};return c.prototype={queryObject:!0,parseNew:function(){var t=this;return t.keys={},e.each(arguments,function(){var n=""+this;n=n.replace(/^[?#]/,""),n=n.replace(/[;&]$/,""),r&&(n=n.replace(/[+]/g," ")),e.each(n.split(/[&;]/),function(){var e=decodeURIComponent(this.split("=")[0]||""),n=decodeURIComponent(this.split("=")[1]||"");e&&(s&&(/^[+-]?[0-9]+\.[0-9]*$/.test(n)?n=parseFloat(n):/^[+-]?[1-9][0-9]*$/.test(n)&&(n=parseInt(n,10))),n=!n&&0!==n||n,t.SET(e,n))})}),t},has:function(e,t){var i=this.get(e);return n(i,t)},GET:function(e){if(!n(e))return this.keys;for(var t=o(e),i=t[0],r=t[1],a=this.keys[i];null!=a&&0!=r.length;)a=a[r.shift()];return"number"==typeof a?a:a||""},get:function(t){var i=this.GET(t);return n(i,Object)?e.extend(!0,{},i):n(i,Array)?i.slice(0):i},SET:function(e,t){var i=n(t)?t:null,r=o(e),a=r[0],s=r[1],c=this.keys[a];return this.keys[a]=l(c,s.slice(0),i),this},set:function(e,t){return this.copy().SET(e,t)},REMOVE:function(e,i){if(i){var r=this.GET(e);if(n(r,Array)){for(tval in r)r[tval]=r[tval].toString();var o=t.inArray(i,r);if(!(o>=0))return;e=r.splice(o,1),e=e[o]}else if(i!=r)return}return this.SET(e,null).COMPACT()},remove:function(e,t){return this.copy().REMOVE(e,t)},EMPTY:function(){var t=this;return e.each(t.keys,function(e,n){delete t.keys[e]}),t},load:function(e){var t=e.replace(/^.*?[#](.+?)(?:\?.+)?$/,"$1"),n=e.replace(/^.*?[?](.+?)(?:#.+)?$/,"$1");return new c(e.length==n.length?"":n,e.length==t.length?"":t)},empty:function(){return this.copy().EMPTY()},copy:function(){return new c(this)},COMPACT:function(){function build(t){function add(e,t,i){n(e,Array)?e.push(i):e[t]=i}var i="object"==typeof t?n(t,Array)?[]:{}:t;return"object"==typeof t&&e.each(t,function(e,t){if(!n(t))return!0;add(i,e,build(t))}),i}return this.keys=build(this.keys),this},compact:function(){return this.copy().COMPACT()},toString:function(){var t=[],o=[],s=function(e){return e+="",e=encodeURIComponent(e),r&&(e=e.replace(/%20/g,"+")),e},l=function(e,t,i){if(n(i)&&!1!==i){var r=[s(t)];!0!==i&&(r.push("="),r.push(s(i))),e.push(r.join(""))}},c=function(t,n){var i=function(e){return n&&""!=n?[n,"[",e,"]"].join(""):[e].join("")};e.each(t,function(e,t){"object"==typeof t?c(t,i(e)):l(o,i(e),t)})};return c(this.keys),o.length>0&&t.push(a),t.push(o.join(i)),t.join("")}},new c(location.search,location.hash)}}(e.query||{})}).call(t,n(0),n(0))},,,function(e,t,n){var i,r,o;!function(a){r=[n(0),n(2)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.ui.escapeSelector=function(){var e=/([!"#$%&'()*+,.\/:;<=>?@[\]^`{|}~])/g;return function(t){return t.replace(e,"\\$1")}}()})},,function(e,t,n){var i,r,o;!function(a){r=[n(0),n(2)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return function(){function getOffsets(e,t,n){return[parseFloat(e[0])*(l.test(e[0])?t/100:1),parseFloat(e[1])*(l.test(e[1])?n/100:1)]}function parseCss(t,n){return parseInt(e.css(t,n),10)||0}function getDimensions(t){var n=t[0];return 9===n.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(n)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:n.preventDefault?{width:0,height:0,offset:{top:n.pageY,left:n.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}var t,n=Math.max,i=Math.abs,r=/left|center|right/,o=/top|center|bottom/,a=/[\+\-]\d+(\.[\d]+)?%?/,s=/^\w+/,l=/%$/,c=e.fn.position;e.position={scrollbarWidth:function(){if(void 0!==t)return t;var n,i,r=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=r.children()[0];return e("body").append(r),n=o.offsetWidth,r.css("overflow","scroll"),i=o.offsetWidth,n===i&&(i=r[0].clientWidth),r.remove(),t=n-i},getScrollInfo:function(t){var n=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),i=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),r="scroll"===n||"auto"===n&&t.width<t.element[0].scrollWidth;return{width:"scroll"===i||"auto"===i&&t.height<t.element[0].scrollHeight?e.position.scrollbarWidth():0,height:r?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),i=e.isWindow(n[0]),r=!!n[0]&&9===n[0].nodeType;return{element:n,isWindow:i,isDocument:r,offset:i||r?{left:0,top:0}:e(t).offset(),scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:n.outerWidth(),height:n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return c.apply(this,arguments);t=e.extend({},t);var l,u,d,h,p,f,g=e(t.of),m=e.position.getWithinInfo(t.within),v=e.position.getScrollInfo(m),_=(t.collision||"flip").split(" "),y={};return f=getDimensions(g),g[0].preventDefault&&(t.at="left top"),u=f.width,d=f.height,h=f.offset,p=e.extend({},h),e.each(["my","at"],function(){var e,n,i=(t[this]||"").split(" ");1===i.length&&(i=r.test(i[0])?i.concat(["center"]):o.test(i[0])?["center"].concat(i):["center","center"]),i[0]=r.test(i[0])?i[0]:"center",i[1]=o.test(i[1])?i[1]:"center",e=a.exec(i[0]),n=a.exec(i[1]),y[this]=[e?e[0]:0,n?n[0]:0],t[this]=[s.exec(i[0])[0],s.exec(i[1])[0]]}),1===_.length&&(_[1]=_[0]),"right"===t.at[0]?p.left+=u:"center"===t.at[0]&&(p.left+=u/2),"bottom"===t.at[1]?p.top+=d:"center"===t.at[1]&&(p.top+=d/2),l=getOffsets(y.at,u,d),p.left+=l[0],p.top+=l[1],this.each(function(){var r,o,a=e(this),s=a.outerWidth(),c=a.outerHeight(),f=parseCss(this,"marginLeft"),x=parseCss(this,"marginTop"),b=s+f+parseCss(this,"marginRight")+v.width,w=c+x+parseCss(this,"marginBottom")+v.height,C=e.extend({},p),S=getOffsets(y.my,a.outerWidth(),a.outerHeight());"right"===t.my[0]?C.left-=s:"center"===t.my[0]&&(C.left-=s/2),"bottom"===t.my[1]?C.top-=c:"center"===t.my[1]&&(C.top-=c/2),C.left+=S[0],C.top+=S[1],r={marginLeft:f,marginTop:x},e.each(["left","top"],function(n,i){e.ui.position[_[n]]&&e.ui.position[_[n]][i](C,{targetWidth:u,targetHeight:d,elemWidth:s,elemHeight:c,collisionPosition:r,collisionWidth:b,collisionHeight:w,offset:[l[0]+S[0],l[1]+S[1]],my:t.my,at:t.at,within:m,elem:a})}),t.using&&(o=function(e){var r=h.left-C.left,o=r+u-s,l=h.top-C.top,p=l+d-c,f={target:{element:g,left:h.left,top:h.top,width:u,height:d},element:{element:a,left:C.left,top:C.top,width:s,height:c},horizontal:o<0?"left":r>0?"right":"center",vertical:p<0?"top":l>0?"bottom":"middle"};u<s&&i(r+o)<u&&(f.horizontal="center"),d<c&&i(l+p)<d&&(f.vertical="middle"),n(i(r),i(o))>n(i(l),i(p))?f.important="horizontal":f.important="vertical",t.using.call(this,e,f)}),a.offset(e.extend(C,{using:o}))})},e.ui.position={fit:{left:function(e,t){var i,r=t.within,o=r.isWindow?r.scrollLeft:r.offset.left,a=r.width,s=e.left-t.collisionPosition.marginLeft,l=o-s,c=s+t.collisionWidth-a-o;t.collisionWidth>a?l>0&&c<=0?(i=e.left+l+t.collisionWidth-a-o,e.left+=l-i):e.left=c>0&&l<=0?o:l>c?o+a-t.collisionWidth:o:l>0?e.left+=l:c>0?e.left-=c:e.left=n(e.left-s,e.left)},top:function(e,t){var i,r=t.within,o=r.isWindow?r.scrollTop:r.offset.top,a=t.within.height,s=e.top-t.collisionPosition.marginTop,l=o-s,c=s+t.collisionHeight-a-o;t.collisionHeight>a?l>0&&c<=0?(i=e.top+l+t.collisionHeight-a-o,e.top+=l-i):e.top=c>0&&l<=0?o:l>c?o+a-t.collisionHeight:o:l>0?e.top+=l:c>0?e.top-=c:e.top=n(e.top-s,e.top)}},flip:{left:function(e,t){var n,r,o=t.within,a=o.offset.left+o.scrollLeft,s=o.width,l=o.isWindow?o.scrollLeft:o.offset.left,c=e.left-t.collisionPosition.marginLeft,u=c-l,d=c+t.collisionWidth-s-l,h="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];u<0?((n=e.left+h+p+f+t.collisionWidth-s-a)<0||n<i(u))&&(e.left+=h+p+f):d>0&&((r=e.left-t.collisionPosition.marginLeft+h+p+f-l)>0||i(r)<d)&&(e.left+=h+p+f)},top:function(e,t){var n,r,o=t.within,a=o.offset.top+o.scrollTop,s=o.height,l=o.isWindow?o.scrollTop:o.offset.top,c=e.top-t.collisionPosition.marginTop,u=c-l,d=c+t.collisionHeight-s-l,h="top"===t.my[1],p=h?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,g=-2*t.offset[1];u<0?((r=e.top+p+f+g+t.collisionHeight-s-a)<0||r<i(u))&&(e.top+=p+f+g):d>0&&((n=e.top-t.collisionPosition.marginTop+p+f+g-l)>0||i(n)<d)&&(e.top+=p+f+g)}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}}}(),e.ui.position})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(127),n(64),n(16),n(131),n(58),n(10),n(36),n(15),n(61),n(125),n(20),n(2),n(5)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.widget("ui.dialog",{version:"1.12.1",options:{appendTo:"body",autoOpen:!0,buttons:[],classes:{"ui-dialog":"ui-corner-all","ui-dialog-titlebar":"ui-corner-all"},closeOnEscape:!0,closeText:"Close",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var n=e(this).css(t).offset().top;n<0&&e(this).css("top",t.top-n)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),null==this.options.title&&null!=this.originalTitle&&(this.options.title=this.originalTitle),this.options.disabled&&(this.options.disabled=!1),this._createWrapper(),this.element.show().removeAttr("title").appendTo(this.uiDialog),this._addClass("ui-dialog-content","ui-widget-content"),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().css(this.originalCss).detach(),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var n=this;this._isOpen&&!1!==this._trigger("beforeClose",t)&&(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),this.opener.filter(":focusable").trigger("focus").length||e.ui.safeBlur(e.ui.safeActiveElement(this.document[0])),this._hide(this.uiDialog,this.options.hide,function(){n._trigger("close",t)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,n){var i=!1,r=this.uiDialog.siblings(".ui-front:visible").map(function(){return+e(this).css("z-index")}).get(),o=Math.max.apply(null,r);return o>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",o+1),i=!0),i&&!n&&this._trigger("focus",t),i},open:function(){var t=this;if(this._isOpen)return void(this._moveToTop()&&this._focusTabbable());this._isOpen=!0,this.opener=e(e.ui.safeActiveElement(this.document[0])),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),this._makeFocusTarget(),this._trigger("open")},_focusTabbable:function(){var e=this._focusedElement;e||(e=this.element.find("[autofocus]")),e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).trigger("focus")},_keepFocus:function(t){function checkFocus(){var t=e.ui.safeActiveElement(this.document[0]);this.uiDialog[0]===t||e.contains(this.uiDialog[0],t)||this._focusTabbable()}t.preventDefault(),checkFocus.call(this),this._delay(checkFocus)},_createWrapper:function(){this.uiDialog=e("<div>").hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._addClass(this.uiDialog,"ui-dialog","ui-widget ui-widget-content ui-front"),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE)return t.preventDefault(),void this.close(t);if(t.keyCode===e.ui.keyCode.TAB&&!t.isDefaultPrevented()){var n=this.uiDialog.find(":tabbable"),i=n.filter(":first"),r=n.filter(":last");t.target!==r[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==i[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(this._delay(function(){r.trigger("focus")}),t.preventDefault()):(this._delay(function(){i.trigger("focus")}),t.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>"),this._addClass(this.uiDialogTitlebar,"ui-dialog-titlebar","ui-widget-header ui-helper-clearfix"),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.trigger("focus")}}),this.uiDialogTitlebarClose=e("<button type='button'></button>").button({label:e("<a>").text(this.options.closeText).html(),icon:"ui-icon-closethick",showLabel:!1}).appendTo(this.uiDialogTitlebar),this._addClass(this.uiDialogTitlebarClose,"ui-dialog-titlebar-close"),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().prependTo(this.uiDialogTitlebar),this._addClass(t,"ui-dialog-title"),this._title(t),this.uiDialogTitlebar.prependTo(this.uiDialog),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title?e.text(this.options.title):e.html("&#160;")},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>"),this._addClass(this.uiDialogButtonPane,"ui-dialog-buttonpane","ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").appendTo(this.uiDialogButtonPane),this._addClass(this.uiButtonSet,"ui-dialog-buttonset"),this._createButtons()},_createButtons:function(){var t=this,n=this.options.buttons;if(this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),e.isEmptyObject(n)||e.isArray(n)&&!n.length)return void this._removeClass(this.uiDialog,"ui-dialog-buttons");e.each(n,function(n,i){var r,o;i=e.isFunction(i)?{click:i,text:n}:i,i=e.extend({type:"button"},i),r=i.click,o={icon:i.icon,iconPosition:i.iconPosition,showLabel:i.showLabel,icons:i.icons,text:i.text},delete i.click,delete i.icon,delete i.iconPosition,delete i.showLabel,delete i.icons,"boolean"==typeof i.text&&delete i.text,e("<button></button>",i).button(o).appendTo(t.uiButtonSet).on("click",function(){r.apply(t.element[0],arguments)})}),this._addClass(this.uiDialog,"ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog)},_makeDraggable:function(){function filteredUi(e){return{position:e.position,offset:e.offset}}var t=this,n=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(n,i){t._addClass(e(this),"ui-dialog-dragging"),t._blockFrames(),t._trigger("dragStart",n,filteredUi(i))},drag:function(e,n){t._trigger("drag",e,filteredUi(n))},stop:function(i,r){var o=r.offset.left-t.document.scrollLeft(),a=r.offset.top-t.document.scrollTop();n.position={my:"left top",at:"left"+(o>=0?"+":"")+o+" top"+(a>=0?"+":"")+a,of:t.window},t._removeClass(e(this),"ui-dialog-dragging"),t._unblockFrames(),t._trigger("dragStop",i,filteredUi(r))}})},_makeResizable:function(){function filteredUi(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var t=this,n=this.options,i=n.resizable,r=this.uiDialog.css("position"),o="string"==typeof i?i:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:n.maxWidth,maxHeight:n.maxHeight,minWidth:n.minWidth,minHeight:this._minHeight(),handles:o,start:function(n,i){t._addClass(e(this),"ui-dialog-resizing"),t._blockFrames(),t._trigger("resizeStart",n,filteredUi(i))},resize:function(e,n){t._trigger("resize",e,filteredUi(n))},stop:function(i,r){var o=t.uiDialog.offset(),a=o.left-t.document.scrollLeft(),s=o.top-t.document.scrollTop();n.height=t.uiDialog.height(),n.width=t.uiDialog.width(),n.position={my:"left top",at:"left"+(a>=0?"+":"")+a+" top"+(s>=0?"+":"")+s,of:t.window},t._removeClass(e(this),"ui-dialog-resizing"),t._unblockFrames(),t._trigger("resizeStop",i,filteredUi(r))}}).css("position",r)},_trackFocus:function(){this._on(this.widget(),{focusin:function(t){this._makeFocusTarget(),this._focusedElement=e(t.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var t=this._trackingInstances(),n=e.inArray(this,t);-1!==n&&t.splice(n,1)},_trackingInstances:function(){var e=this.document.data("ui-dialog-instances");return e||(e=[],this.document.data("ui-dialog-instances",e)),e},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(t){var n=this,i=!1,r={};e.each(t,function(e,t){n._setOption(e,t),e in n.sizeRelatedOptions&&(i=!0),e in n.resizableRelatedOptions&&(r[e]=t)}),i&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",r)},_setOption:function(t,n){var i,r,o=this.uiDialog;"disabled"!==t&&(this._super(t,n),"appendTo"===t&&this.uiDialog.appendTo(this._appendTo()),"buttons"===t&&this._createButtons(),"closeText"===t&&this.uiDialogTitlebarClose.button({label:e("<a>").text(""+this.options.closeText).html()}),"draggable"===t&&(i=o.is(":data(ui-draggable)"),i&&!n&&o.draggable("destroy"),!i&&n&&this._makeDraggable()),"position"===t&&this._position(),"resizable"===t&&(r=o.is(":data(ui-resizable)"),r&&!n&&o.resizable("destroy"),r&&"string"==typeof n&&o.resizable("option","handles",n),r||!1===n||this._makeResizable()),"title"===t&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,n,i=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),i.minWidth>i.width&&(i.width=i.minWidth),e=this.uiDialog.css({height:"auto",width:i.width}).outerHeight(),t=Math.max(0,i.minHeight-e),n="number"==typeof i.maxHeight?Math.max(0,i.maxHeight-e):"none","auto"===i.height?this.element.css({minHeight:t,maxHeight:n,height:"auto"}):this.element.height(Math.max(0,i.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return!!e(t.target).closest(".ui-dialog").length||!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=!0;this._delay(function(){t=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(e){t||this._allowInteraction(e)||(e.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=e("<div>").appendTo(this._appendTo()),this._addClass(this.overlay,null,"ui-widget-overlay ui-front"),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var e=this.document.data("ui-dialog-overlays")-1;e?this.document.data("ui-dialog-overlays",e):(this._off(this.document,"focusin"),this.document.removeData("ui-dialog-overlays")),this.overlay.remove(),this.overlay=null}}}),!1!==e.uiBackCompat&&e.widget("ui.dialog",e.ui.dialog,{options:{dialogClass:""},_createWrapper:function(){this._super(),this.uiDialog.addClass(this.options.dialogClass)},_setOption:function(e,t){"dialogClass"===e&&this.uiDialog.removeClass(this.options.dialogClass).addClass(t),this._superApply(arguments)}}),e.ui.dialog})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(34),n(10),n(15),n(20),n(2),n(5)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.widget("ui.tabs",{version:"1.12.1",delay:300,options:{active:null,classes:{"ui-tabs":"ui-corner-all","ui-tabs-nav":"ui-corner-all","ui-tabs-panel":"ui-corner-bottom","ui-tabs-tab":"ui-corner-top"},collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var e=/#.*$/;return function(t){var n,i;n=t.href.replace(e,""),i=location.href.replace(e,"");try{n=decodeURIComponent(n)}catch(e){}try{i=decodeURIComponent(i)}catch(e){}return t.hash.length>1&&n===i}}(),_create:function(){var t=this,n=this.options;this.running=!1,this._addClass("ui-tabs","ui-widget ui-widget-content"),this._toggleClass("ui-tabs-collapsible",null,n.collapsible),this._processTabs(),n.active=this._initialActive(),e.isArray(n.disabled)&&(n.disabled=e.unique(n.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),!1!==this.options.active&&this.anchors.length?this.active=this._findActive(n.active):this.active=e(),this._refresh(),this.active.length&&this.load(n.active)},_initialActive:function(){var t=this.options.active,n=this.options.collapsible,i=location.hash.substring(1);return null===t&&(i&&this.tabs.each(function(n,r){if(e(r).attr("aria-controls")===i)return t=n,!1}),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),null!==t&&-1!==t||(t=!!this.tabs.length&&0)),!1!==t&&-1===(t=this.tabs.index(this.tabs.eq(t)))&&(t=!n&&0),!n&&!1===t&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var n=e(e.ui.safeActiveElement(this.document[0])).closest("li"),i=this.tabs.index(n),r=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:i++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:r=!1,i--;break;case e.ui.keyCode.END:i=this.anchors.length-1;break;case e.ui.keyCode.HOME:i=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i);case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i!==this.options.active&&i);default:return}t.preventDefault(),clearTimeout(this.activating),i=this._focusNextTab(i,r),t.ctrlKey||t.metaKey||(n.attr("aria-selected","false"),this.tabs.eq(i).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",i)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.trigger("focus"))},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,n){for(var i=this.tabs.length-1;-1!==e.inArray(function(){return t>i&&(t=0),t<0&&(t=i),t}(),this.options.disabled);)t=n?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).trigger("focus"),e},_setOption:function(e,t){if("active"===e)return void this._activate(t);this._super(e,t),"collapsible"===e&&(this._toggleClass("ui-tabs-collapsible",null,t),t||!1!==this.options.active||this._activate(0)),"event"===e&&this._setupEvents(t),"heightStyle"===e&&this._setupHeightStyle(t)},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,n=this.tablist.children(":has(a[href])");t.disabled=e.map(n.filter(".ui-state-disabled"),function(e){return n.index(e)}),this._processTabs(),!1!==t.active&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setOptionDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._addClass(this.active,"ui-tabs-active","ui-state-active"),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this,n=this.tabs,i=this.anchors,r=this.panels;this.tablist=this._getList().attr("role","tablist"),this._addClass(this.tablist,"ui-tabs-nav","ui-helper-reset ui-helper-clearfix ui-widget-header"),this.tablist.on("mousedown"+this.eventNamespace,"> li",function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).on("focus"+this.eventNamespace,".ui-tabs-anchor",function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").attr({role:"tab",tabIndex:-1}),this._addClass(this.tabs,"ui-tabs-tab","ui-state-default"),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).attr({role:"presentation",tabIndex:-1}),this._addClass(this.anchors,"ui-tabs-anchor"),this.panels=e(),this.anchors.each(function(n,i){var r,o,a,s=e(i).uniqueId().attr("id"),l=e(i).closest("li"),c=l.attr("aria-controls");t._isLocal(i)?(r=i.hash,a=r.substring(1),o=t.element.find(t._sanitizeSelector(r))):(a=l.attr("aria-controls")||e({}).uniqueId()[0].id,r="#"+a,o=t.element.find(r),o.length||(o=t._createPanel(a),o.insertAfter(t.panels[n-1]||t.tablist)),o.attr("aria-live","polite")),o.length&&(t.panels=t.panels.add(o)),c&&l.data("ui-tabs-aria-controls",c),l.attr({"aria-controls":a,"aria-labelledby":s}),o.attr("aria-labelledby",s)}),this.panels.attr("role","tabpanel"),this._addClass(this.panels,"ui-tabs-panel","ui-widget-content"),n&&(this._off(n.not(this.tabs)),this._off(i.not(this.anchors)),this._off(r.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol, ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).data("ui-tabs-destroy",!0)},_setOptionDisabled:function(t){var n,i,r;for(e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1),r=0;i=this.tabs[r];r++)n=e(i),!0===t||-1!==e.inArray(r,t)?(n.attr("aria-disabled","true"),this._addClass(n,null,"ui-state-disabled")):(n.removeAttr("aria-disabled"),this._removeClass(n,null,"ui-state-disabled"));this.options.disabled=t,this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!0===t)},_setupEvents:function(t){var n={};t&&e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(e){e.preventDefault()}}),this._on(this.anchors,n),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var n,i=this.element.parent();"fill"===t?(n=i.height(),n-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),i=t.css("position");"absolute"!==i&&"fixed"!==i&&(n-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){n-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,n-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(n=0,this.panels.each(function(){n=Math.max(n,e(this).height("").height())}).height(n))},_eventHandler:function(t){var n=this.options,i=this.active,r=e(t.currentTarget),o=r.closest("li"),a=o[0]===i[0],s=a&&n.collapsible,l=s?e():this._getPanelForTab(o),c=i.length?this._getPanelForTab(i):e(),u={oldTab:i,oldPanel:c,newTab:s?e():o,newPanel:l};t.preventDefault(),o.hasClass("ui-state-disabled")||o.hasClass("ui-tabs-loading")||this.running||a&&!n.collapsible||!1===this._trigger("beforeActivate",t,u)||(n.active=!s&&this.tabs.index(o),this.active=a?e():o,this.xhr&&this.xhr.abort(),c.length||l.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),l.length&&this.load(this.tabs.index(o),t),this._toggle(t,u))},_toggle:function(t,n){function complete(){i.running=!1,i._trigger("activate",t,n)}function show(){i._addClass(n.newTab.closest("li"),"ui-tabs-active","ui-state-active"),r.length&&i.options.show?i._show(r,i.options.show,complete):(r.show(),complete())}var i=this,r=n.newPanel,o=n.oldPanel;this.running=!0,o.length&&this.options.hide?this._hide(o,this.options.hide,function(){i._removeClass(n.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),show()}):(this._removeClass(n.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),o.hide(),show()),o.attr("aria-hidden","true"),n.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),r.length&&o.length?n.oldTab.attr("tabIndex",-1):r.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),r.attr("aria-hidden","false"),n.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(t){var n,i=this._findActive(t);i[0]!==this.active[0]&&(i.length||(i=this.active),n=i.find(".ui-tabs-anchor")[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop}))},_findActive:function(t){return!1===t?e():this.tabs.eq(t)},_getIndex:function(t){return"string"==typeof t&&(t=this.anchors.index(this.anchors.filter("[href$='"+e.ui.escapeSelector(t)+"']"))),t},_destroy:function(){this.xhr&&this.xhr.abort(),this.tablist.removeAttr("role").off(this.eventNamespace),this.anchors.removeAttr("role tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeAttr("role tabIndex aria-live aria-busy aria-selected aria-labelledby aria-hidden aria-expanded")}),this.tabs.each(function(){var t=e(this),n=t.data("ui-tabs-aria-controls");n?t.attr("aria-controls",n).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(t){var n=this.options.disabled;!1!==n&&(void 0===t?n=!1:(t=this._getIndex(t),n=e.isArray(n)?e.map(n,function(e){return e!==t?e:null}):e.map(this.tabs,function(e,n){return n!==t?n:null})),this._setOptionDisabled(n))},disable:function(t){var n=this.options.disabled;if(!0!==n){if(void 0===t)n=!0;else{if(t=this._getIndex(t),-1!==e.inArray(t,n))return;n=e.isArray(n)?e.merge([t],n).sort():[t]}this._setOptionDisabled(n)}},load:function(t,n){t=this._getIndex(t);var i=this,r=this.tabs.eq(t),o=r.find(".ui-tabs-anchor"),a=this._getPanelForTab(r),s={tab:r,panel:a},l=function(e,t){"abort"===t&&i.panels.stop(!1,!0),i._removeClass(r,"ui-tabs-loading"),a.removeAttr("aria-busy"),e===i.xhr&&delete i.xhr};this._isLocal(o[0])||(this.xhr=e.ajax(this._ajaxSettings(o,n,s)),this.xhr&&"canceled"!==this.xhr.statusText&&(this._addClass(r,"ui-tabs-loading"),a.attr("aria-busy","true"),this.xhr.done(function(e,t,r){setTimeout(function(){a.html(e),i._trigger("load",n,s),l(r,t)},1)}).fail(function(e,t){setTimeout(function(){l(e,t)},1)})))},_ajaxSettings:function(t,n,i){var r=this;return{url:t.attr("href").replace(/#.*$/,""),beforeSend:function(t,o){return r._trigger("beforeLoad",n,e.extend({jqXHR:t,ajaxSettings:o},i))}}},_getPanelForTab:function(t){var n=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+n))}}),!1!==e.uiBackCompat&&e.widget("ui.tabs",e.ui.tabs,{_processTabs:function(){this._superApply(arguments),this._addClass(this.tabs,"ui-tab")}}),e.ui.tabs})},,function(e,t,n){!function(t,i){e.exports=i(n(14))}(0,function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var i;void 0!==(i=function(e){var t=n(1);return t.dataTool={version:"1.0.0",gexf:n(5),prepareBoxplotData:n(6)},t.dataTool}.call(t,n,t,e))&&(e.exports=i)},function(t,n){t.exports=e},,,,function(e,r,s){var c;void 0!==(c=function(e){"use strict";function t(e){var t;if("string"==typeof e){t=(new DOMParser).parseFromString(e,"text/xml")}else t=e;if(!t||t.getElementsByTagName("parsererror").length)return null;var i=l(t,"gexf");if(!i)return null;for(var r=l(i,"graph"),s=o(l(r,"attributes")),c={},u=0;u<s.length;u++)c[s[u].id]=s[u];return{nodes:n(l(r,"nodes"),c),links:a(l(r,"edges"))}}function o(e){return e?r.map(u(e,"attribute"),function(e){return{id:i(e,"id"),title:i(e,"title"),type:i(e,"type")}}):[]}function n(e,t){return e?r.map(u(e,"node"),function(e){var n=i(e,"id"),r=i(e,"label"),o={id:n,name:r,itemStyle:{normal:{}}},a=l(e,"viz:size"),s=l(e,"viz:position"),c=l(e,"viz:color"),d=l(e,"attvalues");if(a&&(o.symbolSize=parseFloat(i(a,"value"))),s&&(o.x=parseFloat(i(s,"x")),o.y=parseFloat(i(s,"y"))),c&&(o.itemStyle.normal.color="rgb("+[0|i(c,"r"),0|i(c,"g"),0|i(c,"b")].join(",")+")"),d){var h=u(d,"attvalue");o.attributes={};for(var p=0;p<h.length;p++){var f=h[p],g=i(f,"for"),m=i(f,"value"),v=t[g];if(v){switch(v.type){case"integer":case"long":m=parseInt(m,10);break;case"float":case"double":m=parseFloat(m);break;case"boolean":m="true"==m.toLowerCase()}o.attributes[g]=m}}}return o}):[]}function a(e){return e?r.map(u(e,"edge"),function(e){var t=i(e,"id"),n=i(e,"label"),r=i(e,"source"),o=i(e,"target"),a={id:t,name:n,source:r,target:o,lineStyle:{normal:{}}},s=a.lineStyle.normal,c=l(e,"viz:thickness"),u=l(e,"viz:color");return c&&(s.width=parseFloat(c.getAttribute("value"))),u&&(s.color="rgb("+[0|i(u,"r"),0|i(u,"g"),0|i(u,"b")].join(",")+")"),a}):[]}function i(e,t){return e.getAttribute(t)}function l(e,t){for(var n=e.firstChild;n;){if(1==n.nodeType&&n.nodeName.toLowerCase()==t.toLowerCase())return n;n=n.nextSibling}return null}function u(e,t){for(var n=e.firstChild,i=[];n;)n.nodeName.toLowerCase()==t.toLowerCase()&&i.push(n),n=n.nextSibling;return i}var r=s(1).util;return{parse:t}}.call(r,s,r,e))&&(e.exports=c)},function(e,t,n){var i;void 0!==(i=function(e){var t=n(7),i=n(1).number;return function(e,n){n=n||[];for(var r=[],o=[],a=[],s=n.boundIQR,l=0;l<e.length;l++){a.push(l+"");var c=i.asc(e[l].slice()),u=t(c,.25),d=t(c,.5),h=t(c,.75),p=h-u,f="none"===s?c[0]:u-(null==s?1.5:s)*p,g="none"===s?c[c.length-1]:h+(null==s?1.5:s)*p;r.push([f,u,d,h,g]);for(var m=0;m<c.length;m++){var v=c[m];if(v<f||v>g){var _=[l,v];"vertical"===n.layout&&_.reverse(),o.push(_)}}}return{boxData:r,outliers:o,axisData:a}}}.call(t,n,t,e))&&(e.exports=i)},function(e,t,n){var i;void 0!==(i=function(e){return function(e,t){var n=(e.length-1)*t+1,i=Math.floor(n),r=+e[i-1],o=n-i;return o?r+o*(e[i]-r):r}}.call(t,n,t,e))&&(e.exports=i)}])})},function(e,t,n){var i,r,o;!function(a,s){r=[t,n(14)],i=s,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(0,function(e,t){if(!t)return void function(e){"undefined"!=typeof console&&console&&console.error}();var n=function(){return{axisLine:{lineStyle:{color:"#eee"}},axisTick:{lineStyle:{color:"#eee"}},axisLabel:{textStyle:{color:"#eee"}},splitLine:{lineStyle:{type:"dashed",color:"#aaa"}},splitArea:{areaStyle:{color:"#eee"}}}},i=["#ff0000","#80ff00","#00ffff","#7f00ff","#ff8000","#00ff00","#007fff","#ff00ff","#ffff00","#00ff80","#0000ff"],r={color:i,tooltip:{axisPointer:{lineStyle:{color:"#eee"},crossStyle:{color:"#eee"}}},legend:{textStyle:{color:"#eee"}},textStyle:{color:"#eee"},title:{textStyle:{color:"#eee"}},toolbox:{iconStyle:{normal:{borderColor:"#eee"}}},dataZoom:{textStyle:{color:"#eee"}},visualMap:{textStyle:{color:"#eee"}},timeline:{lineStyle:{color:"#eee"},itemStyle:{normal:{color:i[1]}},label:{normal:{textStyle:{color:"#eee"}}},controlStyle:{normal:{color:"#eee",borderColor:"#eee"}}},timeAxis:n(),logAxis:n(),valueAxis:n(),categoryAxis:n(),line:{symbol:"circle"},graph:{color:i},gauge:{title:{textStyle:{color:"#eee"}}},candlestick:{itemStyle:{normal:{color:"#FD1050",color0:"#0CF49B",borderColor:"#FD1050",borderColor0:"#0CF49B"}}},backgroundColor:"#242B36"};r.categoryAxis.splitLine.show=!1,t.registerTheme("dark",r)})},,function(e,t,n){var i;void 0!==(i=function(){for(var e=[],t=0;t<256;t++)e[t]=(t<16?"0":"")+t.toString(16);return{generate:function(){var t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return e[255&t]+e[t>>8&255]+e[t>>16&255]+e[t>>24&255]+"-"+e[255&n]+e[n>>8&255]+"-"+e[n>>16&15|64]+e[n>>24&255]+"-"+e[63&i|128]+e[i>>8&255]+"-"+e[i>>16&255]+e[i>>24&255]+e[255&r]+e[r>>8&255]+e[r>>16&255]+e[r>>24&255]}}}.call(t,n,t,e))&&(e.exports=i)},function(e,t,n){var i,r;i=[n(0),n(3)],void 0!==(r=function(e,t){function cronValidate(t){n=e.i18n.prop("CRON_Second"),i=e.i18n.prop("CRON_Minutes"),r=e.i18n.prop("CRON_Hour"),o=e.i18n.prop("CRON_Day"),a=e.i18n.prop("CRON_Week"),s=e.i18n.prop("CRON_Year"),l=e.i18n.prop("CRON_Month");var c="",u=t.split(" ");return u.length<6||u.length>7?[e.i18n.prop("CRON_Parameter_Number_Error"),void 0]:"?"==u[3]&&"?"!=u[5]||"?"==u[5]&&"?"!=u[3]||"*"==u[3]&&"*"==u[5]?1!=(c=checkSecondsField(u[0]))?[c+"<br>"+e.i18n.prop("cron_Allowed_rule")+":"+e.i18n.prop("cron_Allowed_values")+":0-59,"+e.i18n.prop("cron_Allowed_character")+":, - * /",0]:1!=(c=checkMinutesField(u[1]))?[c+"<br>"+e.i18n.prop("cron_Allowed_rule")+":"+e.i18n.prop("cron_Allowed_values")+":0-59,"+e.i18n.prop("cron_Allowed_character")+":, - * /",1]:1!=(c=checkHoursField(u[2]))?[c+"<br>"+e.i18n.prop("cron_Allowed_rule")+":"+e.i18n.prop("cron_Allowed_values")+":0-23,"+e.i18n.prop("cron_Allowed_character")+":, - * /",2]:1!=(c=checkDayOfMonthField(u[3]))?[c+"<br>"+e.i18n.prop("cron_Allowed_rule")+":"+e.i18n.prop("cron_Allowed_values")+":1-31,"+e.i18n.prop("cron_Allowed_character")+":, - * / L W C ?",3]:1!=(c=checkMonthsField(u[4]))?[c+"<br>"+e.i18n.prop("cron_Allowed_rule")+":"+e.i18n.prop("cron_Allowed_values")+":1-12 JAN-DEC,"+e.i18n.prop("cron_Allowed_character")+":, - * /",4]:(c=checkDayOfWeekField(u[5]),1!=c?[c+"<br>"+e.i18n.prop("cron_Allowed_rule")+":"+e.i18n.prop("cron_Allowed_values")+":1-7 SUN-SAT,"+e.i18n.prop("cron_Allowed_character")+":, - * ? / L C #",5]:!(u.length>6&&1!=(c=checkYearField(u[6])))||[c+"<br>"+e.i18n.prop("cron_Allowed_rule")+":"+e.i18n.prop("cron_Allowed_values")+":1970-2099,"+e.i18n.prop("cron_Allowed_character")+":, - * /",6]):[e.i18n.prop("CRON_Parameter_Specified_Error"),[3,5]]}function checkSecondsField(e){return checkField(e,0,59,n)}function checkMinutesField(e){return checkField(e,0,59,i)}function checkHoursField(e){return checkField(e,0,23,r)}function checkDayOfMonthField(e){return"?"==e||(e.indexOf("L")>=0?checkFieldWithLetter(e,"L",1,7,o):e.indexOf("W")>=0?checkFieldWithLetter(e,"W",1,31,o):e.indexOf("C")>=0?checkFieldWithLetter(e,"C",1,31,o):checkField(e,1,31,o))}function checkMonthsField(e){return"*"==e||(e=e.replace("JAN","1"),e=e.replace("FEB","2"),e=e.replace("MAR","3"),e=e.replace("APR","4"),e=e.replace("MAY","5"),e=e.replace("JUN","6"),e=e.replace("JUL","7"),e=e.replace("AUG","8"),e=e.replace("SEP","9"),e=e.replace("OCT","10"),e=e.replace("NOV","11"),e=e.replace("DEC","12"),checkField(e,1,12,l))}function checkDayOfWeekField(e){return e=e.replace("SUN","1"),e=e.replace("MON","2"),e=e.replace("TUE","3"),e=e.replace("WED","4"),e=e.replace("THU","5"),e=e.replace("FRI","6"),"?"==(e=e.replace("SAT","7"))||(e.indexOf("L")>=0?checkFieldWithLetterWeek(e,"L",1,7,a):e.indexOf("C")>=0?checkFieldWithLetterWeek(e,"C",1,7,a):e.indexOf("#")>=0?checkFieldWithLetterWeek(e,"#",1,7,a):checkField(e,1,7,a))}function checkYearField(e){return checkField(e,1970,2099,s)}function checkField(e,t,n,i){return e.indexOf("-")>-1?checkRangeAndCycle(e,t,n,i):e.indexOf(",")>-1?checkListField(e,t,n,i):e.indexOf("/")>-1?checkIncrementField(e,t,n,i):"*"==e||checkIntValue(e,t,n,!0,i)}function checkIntValue(t,n,i,r,o){try{var a=parseInt(t,10);return t==a?!r||(!(a<n||a>i)||o+":"+e.i18n.prop("CRON_Parameter_Scope")+":"+n+"-"+i):o+":"+e.i18n.prop("CRON_Parameter_Illegal")}catch(t){return o+":"+e.i18n.prop("CRON_Parameter_Illegal")}}function checkListField(t,n,i,r){for(var o=t.split(","),a=new Array(o.length),s=0,l=0;l<o.length;l++)a[l]=o[l];for(var c=0;c<a.length;c++){if(message=checkIntValue(a[c],n,i,!0,r),1!=message)return message;s=0;for(var l=0;l<a.length;l++)if(a[c]==a[l]&&s++,s>1)return r+":"+e.i18n.prop("CRON_Parameter_Repeat")}for(var u=-1,c=0;c<a.length;c++){var d=a[c];try{var h=parseInt(d,10);if(h<u)return r+":"+e.i18n.prop("CRON_Parameter_arrangement_Error");u=h}catch(e){return""}}return!0}function checkIncrementField(t,n,i,r){if(t.split("/").length>2)return r+":"+e.i18n.prop("CRON_Parameter_OnlyOne")+"/";var o=t.substring(0,t.indexOf("/")),a=t.substring(t.indexOf("/")+1);return"*"!=o?(message=checkIntValue(o,n,i,!0,r),1!=message?message:(message=checkIntValue(a,n,i,!0,r),1==message||message)):checkIntValue(a,n,i,!1,r)}function checkRangeAndCycle(t,n,i,r){if(t.split("-").length>2)return r+":"+e.i18n.prop("CRON_Parameter_OnlyOne")+"-";var o=null,a=null;if(t.indexOf("/")>-1){if(t.split("/").length>2)return r+":"+e.i18n.prop("CRON_Parameter_OnlyOne")+"/";if(o=t.split("/")[0],a=t.split("/")[1],message=checkIntValue(a,n,i,!0,r),1!=message)return message}else o=t;var s=o.substring(0,o.indexOf("-")),l=o.substring(o.indexOf("-")+1);if(message=checkIntValue(s,n,i,!0,r),1!=message)return message;if(message=checkIntValue(l,n,i,!0,r),1!=message)return message;try{var c=parseInt(s,10),u=parseInt(l,10);return u<c?r+":"+e.i18n.prop("CRON_Parameter_Scope_Error"):!(u-c<parseInt(a,10))||r+":"+e.i18n.prop("CRON_Parameter_Cycle_Error")}catch(t){return r+":"+e.i18n.prop("CRON_Parameter_Illegal")}}function checkFieldWithLetter(t,n,i,r,o){for(var a=0;a<t.length;a++){var s=0;if(t.charAt(a)==n&&s++,s>1)return o+":"+n+e.i18n.prop("CRON_Parameter_OnlyOne")}if("L"==n){if("LW"==t)return!0;if("L"==t)return!0;if(t.endsWith("LW")&&t.length>2)return o+":"+e.i18n.prop("CRON_Parameter_LW_Error");if(t.endsWith("L")){var l=t.substring(0,t.indexOf(n));return checkIntValue(l,i,r,!0,o)}return o+":"+e.i18n.prop("CRON_Parameter_L_Error")}if("W"==n){if(t.endsWith("W")){if("W"==t)return o+":"+e.i18n.prop("CRON_Parameter_LWithNumber_Error");var l=t.substring(0,t.indexOf(n));return checkIntValue(l,i,r,!0,o)}return o+":"+e.i18n.prop("CRON_Parameter_WForEnd_Error")}if("C"==n){if(t.endsWith("C")){if("C"==t)return o+":"+e.i18n.prop("CRON_Parameter_CWithNumber_Error");var l=t.substring(0,t.indexOf(n));return checkIntValue(l,i,r,!0,o)}return o+":"+e.i18n.prop("CRON_Parameter_CForEnd_Error")}}function checkFieldWithLetterWeek(t,n,i,r,o){for(var a=0;a<t.length;a++){var s=0;if(t.charAt(a)==n&&s++,s>1)return o+":"+n+e.i18n.prop("CRON_Parameter_OnlyOne")}if("L"==n){if("L"==t)return!0;if(t.endsWith("L")){var l=t.substring(0,t.indexOf(n));return checkIntValue(l,i,r,!0,o)}return o+":"+e.i18n.prop("CRON_Parameter_LForEnd_Error")}if("C"==n){if(t.endsWith("C")){if("C"==t)return o+":"+e.i18n.prop("CRON_Parameter_CWithNumber_Error");var l=t.substring(0,t.indexOf(n));return checkIntValue(l,i,r,!0,o)}return o+":"+e.i18n.prop("CRON_Parameter_CForEnd_Error")}if("#"==n){if("#"==t)return o+":#"+e.i18n.prop("CRON_Parameter_Parse");if(t.charAt(0)==n)return o+":#"+e.i18n.prop("CRON_Parameter_Parse");if(t.endsWith("#"))return o+":#"+e.i18n.prop("CRON_Parameter_Parse");var c=t.substring(0,t.indexOf(n)),u=t.substring(t.indexOf(n)+1,t.length);return message=checkIntValue(c,1,4,!0,o),1!=message?message:(message=checkIntValue(u,i,r,!0,o),1==message||message)}}var n,i,r,o,a,s,l;return{cronValidate:cronValidate}}.apply(t,i))&&(e.exports=r)},function(e,t,n){(function(i){function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r,o;r=[n(6),n(13),n(11),n(1),n(8)],void 0!==(o=function(e,t,n,r,o){return function(t){function ExpDialog(e,n,i,r,o){return _classCallCheck(this,ExpDialog),_possibleConstructorReturn(this,t.call(this,e,n,i,r,o))}return _inherits(ExpDialog,t),ExpDialog.prototype.setProperties=function(){this.title=i.i18n.prop("ict_oneminer_process_set_exp_name"),this.position={my:"center",at:"top+200px"}},ExpDialog.prototype.init=function(){var e=this.data&&this.data.column;if(e){var t=e.data();i("#inputProcessName").val(i(t[1]).text()).attr("readonly","readonly").css({background:"inherit","pointer-events":"none"}),i("#inputProcessDesc").val(r.unescape(t[2])).focus()}else i("#inputProcessName").focus(),r.handleValidate(i(this.el).find("form"));r.doNiceScroll("#inputProcessDesc")},ExpDialog.prototype.confirm=function(){switch(this.data&&this.data.type){case"new":this.addConfirm(!0);break;case"save":this.addConfirm();break;case"edit":this.editConfirm()}},ExpDialog.prototype.addConfirm=function(e){if(!i("#saveProcessForm").valid())return i("#inputProcessName").focus();var t=i("#inputProcessName").val(),n=i("#inputProcessDesc").val(),r={name:t,desc:n,publish:0,content:JSON.stringify(e?this.processManager.getEmptyProcessInfo():this.processManager.getProcessInfo(!0)),type:e?0:this.processManager.getProcessType()};this.getZaipTemplate().length&&(r.dlContent=JSON.stringify({templates:this.getZaipTemplate()})),this.processManager.methodProxy.getMethod("saveas")(r,!0,!1),this.triggerHook("afterClose",t),this._close()},ExpDialog.prototype.editConfirm=function(){var e=this,t=i("#inputProcessDesc").val(),n={name:i(e.data.column.data()[1]).text(),owner:e.data.column.data()[7].userId,desc:t};i.post(r.genApiUrl("process/update"),n).done(function(){e.triggerHook("afterClose",t)}).fail(),e._close()},ExpDialog.prototype.getZaipTemplate=function(){if(e.isEmpty(this.zaip.getCacheTrain()))return[];var t=this,n=this.processManager.getProcessInfo(),i=[];return n.operators.forEach(function(e){if(t.processManager.getOperatorAsCell(t.graphManager.getGraph(),e.name).value.operatorExecType==o.ZAIPENTRANCE){var r=t.graphManager.getSourceByOperatorName(t.graphManager.getGraph(),e.name,o.PORT_INPUT_TYPE,"params",o.ZAIPDATA),a=n.params.zaip_id,s=a+t.processManager.getProcessName()+t.graphManager.getOperatorCellByName(t.graphManager.getGraph(),e.name).value.initName,l=t.zaip.getCacheTrain(s)&&JSON.parse(JSON.stringify(t.zaip.getCacheTrain(s))),c=l?t.zaip.handlerParams(e,n,l):{},u={opname:e.name,connectid:a,datasource:JSON.stringify(r),content:JSON.stringify(c)};i.push(u)}}),i},ExpDialog.prototype.render=function(){return'<form id="saveProcessForm" class="form-horizontal col-sm-12 savePopWin" onsubmit="return false">\n                        <div class="form-group" style="margin-top: 20px;">\n                            <div class="processWord col-sm-3" style="padding-left: 0;">\n                                <span class="redStar">*</span><label for="inputProcessName" class="control-label">'+i.i18n.prop("ict_oneminer_process_exp_name")+'</label>\n                            </div>\n                            <div class="col-sm-8">\n                                <input type="text" class="form-control" maxlength="100" id="inputProcessName" name="name" style="height:26px;" placeholder="'+i.i18n.prop("ict_oneminer_process_exp_name_pl")+'"/>\n                            </div>\n                        </div>\n                        <div class="form-group" style="margin-top: 30px;">\n                            <label for="inputProcessDesc" class="control-label col-sm-3">'+i.i18n.prop("ict_oneminer_process_exp_desc")+'</label>\n                            <div class="col-sm-8">\n                                <textarea class="form-control" id="inputProcessDesc" name="desc" placeholder="'+i.i18n.prop("ict_oneminer_process_exp_desc_pl")+'" rows="3"></textarea>\n                            </div>\n                        </div>\n                    </form>'},ExpDialog}(t)}.apply(t,r))&&(e.exports=o)}).call(t,n(0))},function(e,t,n){(function(i){function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r,o;r=[n(13),n(1)],void 0!==(o=function(e,t){return function(e){function List(t,n,i,r){_classCallCheck(this,List);var o=_possibleConstructorReturn(this,e.call(this,t,n,i));return o.paramType=r.paramType,o.keyType=r.paramType.keyType,o.valueType=r.paramType.valueType,o.cell=r.cell,o.values=r.values,o.modifyConfirm=r.modifyConfirm,o.handleParam=r.handleParam,o.currentOperator=r.currentOperator,o}return _inherits(List,e),List.prototype.setProperties=function(){var e=this;this.buttons=[{text:"Add",click:function(){e.addColumn()}},{text:"Remove",click:function(){e.removeColumn()}},{text:"Apply",click:function(){e.applyColumn()}},{text:"Cancel",click:function(){e._close()}}],this.title="Edit"},List.prototype.addColumn=function(){var e=i(this.el).find("table tbody"),n=this.handleParam(null,this.keyType,{},this.cell,this.currentOperator),r=this.handleParam(null,this.valueType,{},this.cell,this.currentOperator);n.attr("data-key",!0),e.append(i("<tr/>").append(i("<td/>").append(n)).append(i("<td/>").append(r))),e.children("tr.active").length||e.children("tr").first().addClass("active"),t.doNiceScroll(i(this.el))},List.prototype.removeColumn=function(){var e=i(this.el).find("table tbody"),n=e.children("tr.active"),r=!n.next().length,o=r?n.prev():n.next();n.remove(),o.addClass("active"),this.checkKeyValidity(),this.checkValueValidity(),t.doNiceScroll(i(this.el))},List.prototype.applyColumn=function(){var e=this;if(this.checkValidity()){var t=i(this.el).find("table tbody"),n=Array.from(t.children("tr")).map(function(t){return[e.getElementValue(t,"key"),e.getElementValue(t,"value")]}),r=JSON.stringify(n);this.modifyConfirm({},null,this.paramType,this.values,r,null,null,e.currentOperator),this._close()}},List.prototype.init=function(){var e=this,n=this,r=i(this.el).find("table tbody"),o=t.getValue(this.paramType,this.values);o&&(JSON.parse(o).forEach(function(t){var n,o=(n={},n[e.keyType.key]=t[0],n[e.valueType.key]=t[1],n),a=e.handleParam(null,e.keyType,o,e.cell,e.currentOperator);a.attr("data-key",!0);var s=e.handleParam(null,e.valueType,o,e.cell,e.currentOperator);r.append(i("<tr/>").append(i("<td/>").append(a)).append(i("<td/>").append(s)))}),r.children("tr").first().addClass("active")),r.on("click","tr",function(){i(this).addClass("active").siblings().removeClass("active")}).on("input","input",function(){n.checkKeyValue(this)}).on("change","select",function(){n.checkKeyValue(this)})},List.prototype.registerValidateRules=function(e){this.keyRule=e.key,this.valueRule=e.value},List.prototype.checkValidity=function(){var e=i(this.el).find(".invalid-variable, .invalid");return!e.length||(e.focus(),!1)},List.prototype.checkKeyValue=function(e){"true"===e.dataset.key||"true"===i(e).parent()[0].dataset.key?this.checkKeyValidity():this.checkValueValidity()},List.prototype.checkKeyValidity=function(){var e=this,t=Array.from(i(this.el).find("tbody tr")).map(function(e){var t=i(e).find("td").first(),n=t.find("input")[0],r=t.find("select")[0];return n||r}),n=t.map(function(e){return e.value}),r=e.calculateCounts(n);t.forEach(function(t){e.isValidKey(t,r)?i(t).removeClass("invalid-variable"):i(t).addClass("invalid-variable")})},List.prototype.isValidKey=function(e,t){var n=e.value,i=this.keyRule&&this.keyRule(n),r=1===t[n];return"INPUT"===e.nodeName?n&&r&&i:n&&r},List.prototype.checkValueValidity=function(){Array.from(i(this.el).find("tbody tr")).map(function(e){var t=i(e).find("td").last(),n=t.find("input")[0],r=t.find("select")[0];return n||r}).forEach(function(e){e.value?i(e).removeClass("invalid-variable"):i(e).addClass("invalid-variable")})},List.prototype.getElementValue=function(e,t){var n="key"===t?i(e).find("td").first():i(e).find("td").last(),r=n.find("input"),o=n.find("select");return 1===r.length?r.val():1===o.length?o.val():2===o.length?Array.from(o).map(function(e){return i(e).val()}).join("."):void 0},List.prototype.calculateCounts=function(e){var t={};return e.forEach(function(e){t[e]=t[e]&&++t[e]||1}),t},List.prototype.render=function(){return'<table class="table table-bordered dataTable header-fixed">\n                        <thead>\n                            <tr><th>'+this.keyType.label+"</th><th>"+this.valueType.label+"</th></tr>\n                        </thead>\n                        <tbody/>\n                    </table>"},List}(e)}.apply(t,r))&&(e.exports=o)}).call(t,n(0))},function(e,t,n){(function(i){function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r,o;r=[n(6),n(13),n(11),n(1),n(8)],void 0!==(o=function(e,t,n,r,o){var a=function(){var e=i.fn.zTree.getZTreeObj("encryptTree"),t=[];e.getNodes().forEach(function(e){var n=e.children.filter(function(e){return e.checked}).map(function(e){return e.id});n.length&&t.push({name:e.id,operators:n})});return t};return function(t){function Template(e,n,i,r,o){return _classCallCheck(this,Template),_possibleConstructorReturn(this,t.call(this,e,n,i,r,o))}return _inherits(Template,t),Template.prototype.setProperties=function(){this.title=i.i18n.prop("ict_oneminer_process_set_temp_name"),this.position={my:"center",at:"top+200px"}},Template.prototype.init=function(){var e=this.data&&this.data.column;if(e){var t=e.data();i("#inputProcessName").val(i(t[1]).text()).attr("readonly","readonly").css({background:"inherit","pointer-events":"none"}),i("#inputProcessDesc").val(r.unescape(t[2])).focus()}else this.initNew()},Template.prototype.initNew=function(){i("#inputProcessName").focus(),r.handleValidate(i(this.el).find("form")),i("#encypt").click(function(){i("#encryptTree").toggleClass("show"),r.doNiceScroll("#encryptTree")});var t=this.getTreeData();"admin"!==i("span#username").text()||e.isEmpty(t)||(i(".encypt-div").show(),n.checkBoxSetting.callback={onExpand:function(){i("#encryptTree").getNiceScroll().resize()},onCollapse:function(){i("#encryptTree").getNiceScroll().resize()}},i.fn.zTree.init(i("#encryptTree"),n.checkBoxSetting,t))},Template.prototype.getZaipTemplate=function(){var e=this,t=this.processManager.getProcessInfo(),n=[];return t.operators.forEach(function(i){if(e.processManager.getOperatorAsCell(e.graphManager.getGraph(),i.name).value.operatorExecType==o.ZAIPENTRANCE){var r=e.graphManager.getSourceByOperatorName(e.graphManager.getGraph(),i.name,o.PORT_INPUT_TYPE,"params",o.ZAIPDATA),a=t.params.zaip_id,s=a+e.processManager.getProcessName()+e.graphManager.getOperatorCellByName(e.graphManager.getGraph(),i.name).value.initName,l=e.zaip.getCacheTrain(s)&&JSON.parse(JSON.stringify(e.zaip.getCacheTrain(s))),c=l?e.zaip.handlerParams(i,t,l):{},u={opname:i.name,connectid:a,datasource:JSON.stringify(r),content:JSON.stringify(c)};n.push(u)}}),n},Template.prototype.confirm=function(){switch(this.data&&this.data.type){case"new":this.addConfirm();break;case"edit":this.editConfirm()}},Template.prototype.addConfirm=function(){if(!i("#saveProcessForm").valid())return i("#inputProcessName").focus();var e=this.processManager.getProcessInfo();i("#encryptTree").is(":visible")&&(e.encrypt=a());var t={name:i("#inputProcessName").val(),desc:i("#inputProcessDesc").val(),publish:0,content:JSON.stringify(e),type:this.processManager.getProcessType()};this.getZaipTemplate().length&&(t.dlContent=JSON.stringify({templates:this.getZaipTemplate()})),this.processManager.methodProxy.getMethod("saveas")(t,!1,!0),this.triggerHook("afterClose"),this._close()},Template.prototype.editConfirm=function(){var e=this,t=i("#inputProcessDesc").val(),n=(e.data.column.data()[7],{name:i(e.data.column.data()[1]).text(),desc:t});i.post(r.genApiUrl("template/update"),n).done(function(){e.triggerHook("afterClose",t)}).fail(),this._close()},Template.prototype.getTreeData=function(){var t=[];return this.processManager.getGraph().getModel().filterDescendants(function(t){return t&&t.value&&t.value.isOperator&&e.contains(o.ENCYPT_OPERATORS,t.value.type)}).forEach(function(e){var n=r.getParameters(e.value.type),i=n.filter(function(e){return e.supportEncrypt}).map(function(e){return{id:e.key,label:e.key,checked:!0}});i.length&&t.push({id:e.value.name,label:e.value.description,checked:!0,children:i})}),t},Template.prototype.render=function(){return'<form id="saveProcessForm" class="form-horizontal col-sm-12 savePopWin" onsubmit="return false">\n                        <div class="form-group" style="margin-top: 20px;">\n                            <div class="processWord col-sm-3" style="padding-left: 0;">\n                                <span class="redStar">*</span><label for="inputProcessName" class="control-label">'+i.i18n.prop("ict_oneminer_process_temp_name")+'</label>\n                            </div>\n                            <div class="col-sm-8">\n                                <input type="text" class="form-control" maxlength="100" id="inputProcessName" name="templateName" style="height:26px;" placeholder="'+i.i18n.prop("ict_oneminer_process_temp_name_pl")+'"/>\n                            </div>\n                        </div>\n                        <div class="form-group" style="margin-top: 30px;">\n                            <label for="inputProcessDesc" class="control-label col-sm-3">'+i.i18n.prop("ict_oneminer_process_temp_desc")+'</label>\n                            <div class="col-sm-8">\n                                <textarea class="form-control" id="inputProcessDesc" name="desc" placeholder="'+i.i18n.prop("ict_oneminer_process_temp_desc_pl")+'" rows="3"></textarea>\n                            </div>\n                        </div>\n                        <div class="form-group encypt-div" style="margin-top: 20px;display:none">\n                            <label class="control-label col-sm-3">'+i.i18n.prop("ict_oneminer_process_temp_encypt")+'</label>\n                            <input type="checkbox" id="encypt"><label style="margin:8px 0 0 10px;display:inline-block" for="encypt"></label>\n                        </div>\n                        <ul id="encryptTree" class="ztree pageLeft hide"></ul>\n                    </form>'},Template}(t)}.apply(t,r))&&(e.exports=o)}).call(t,n(0))},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(0),__webpack_require__(5),__webpack_require__(4),__webpack_require__(6),__webpack_require__(1),__webpack_require__(18),__webpack_require__(8),__webpack_require__(3),__webpack_require__(12),__webpack_require__(9),__webpack_require__(7),__webpack_require__(44),__webpack_require__(46),__webpack_require__(102)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function($,___1,toastr,_,utils,processManager,constants,i18n,Cookies,CodeMirror,http,cronEV,ListDialog,SparkConfigDialog){function initSqlCodeTips(e){global_sql_editor=CodeMirror.fromTextArea(document.getElementById("sql-code"),{lineNumbers:!0,extraKeys:{Alt:"autocomplete"},mode:{name:"text/x-hive"},theme:"monokai"}),global_sql_editor.on("keyup",function(e,t){!e.state.completionActive&&(t.keyCode>=65&&t.keyCode<=90||190==t.keyCode)&&CodeMirror.commands.autocomplete(e,null,{completeSingle:!1})}),global_sql_editor.setValue(e)}function clusterChangedEvent(e){Cookies.set(clusterKey,e,{expires:365,path:""}),connectIdChangeCallback()}function valueChangeEvent(e,t){processManager.updateData(t),e&&selectionChanged(!0)}function handleResourceConfig(e,t,n){var i=e.value.type;if(e.value.operatorExecType!==constants.OPERATOR_TYPE_SPARK||utils.isModel(i)||utils.getSingle(processManager.getCurrentConnectId()))$("a[href='#config']").parent().hide();else{$("a[href='#config']").parent().show();var r=e.value.params;$(config).append('<ul class="resource-config">\n                            <li>\n                                <label class="control-label">cores(>=1)</label>\n                                <div><input id="cores" type="number" class="form-control" step="1" min="1"></div>\n                            </li>\n                            <li>\n                                <label class="control-label">memory(G, >=3)</label>\n                                <div><input id="memory" type="number" class="form-control" step="1" min="3"></div>\n                            </li>\n                            <li>\n                                <label class="control-label">advanced setting</label>\n                                <div><button class="btn btn-primary form-control advanced-setting">Edit</button></div>\n                            </li>\n                        </ul>'),advancedSetting(t,n);var o=t.cores||r&&r.cores||3,a=t.memory||r&&r.memory||5;$("#cores").val(o),$("#memory").val(a),t.cores=o,t.memory=a,$("#cores,#memory").on({keypress:function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||$(this).blur()},blur:function(){var e=$(this).attr("id");if(!this.checkValidity())return toastr.warning($.i18n.prop("ict_oneminer_message_number_min",e,this.min)),$(this).val(t[e]).focus();if(checkResource(t)){var n=t[e]+"";$(this).val()!==n&&(t[e]=$(this).val()||"",processManager.methodProxy.getMethod("setSavable")(!0))}}})}}function selectionChanged(e){if(graph){document.activeElement.blur(),isSelectionChange=!e;var t=graph.getSelectionCell();dialogs.forEach(function(e){$(e).dialog("destroy")}),dialogs=[],$("#properties, #config").empty();var n=document.createDocumentFragment(),i=document.createDocumentFragment();graph.container.focus();var r,o,a,s;t&&t.isVertex()&&!t.value.isPort?(r=t.value.name,o=processManager.getOperatorParams(t.id),a=utils.getParameters(t.value.type),isSelectionChange&&(s=r),handleResourceConfig(t,o,s)):(r="Process: "+processManager.getProcessName(),o=processManager.getParams(),!o[clusterKey]&&Cookies.get(clusterKey)&&(o[clusterKey]=Cookies.get(clusterKey)),a=utils.getParameters("root-process"),s=null,$("a[href='#config']").parent().hide()),$("#param-tabs").tabs({active:0,activate:function(e,t){1===t.newTab.index()&&utils.doNiceScroll("#config")}});var l=$("<h6/>").html(t&&t.value&&t.value.description||r);if($(n).append(l).append("<hr/>"),t&&t.value&&utils.isModel(t.value.type)){if(_.isArray(a)&&!_.isEmpty(a)){var c=$("<div/>",{class:"operator-desc"});c.append($("<label/>").text($.i18n.prop("OP_DESC")));var u="";a.some(function(e){if("model info"===e.key)return u=e.defaultValue,!0}),c.append($('<div style="line-height:20px"/>').text(u)),$(n).append(c)}}else{var d=$("<div/>",{class:"form-vertical"});if($(n).append(d),_.isArray(a)&&!_.isEmpty(a)){var h=getAllDependParams(a),p=[];a.forEach(function(e){if(isVisible(e,o,p)){p.push(e.key);var n=$("<div/>",{class:"form-group form-group-sm"});"Password"===e.key&&(e.type="password"),_.contains(h,e.key)&&(e.needRepaint=!0),handleParam(n,e,o,t,s),d.append(n)}})}if(handleLogLevel(d,o,t),t&&t.value&&t.value.type){$(n).append("<hr/>"),$(i).append('<hr style="width:100%"/>');var c=getDescription(t);$(n).append(c),$(i).append($(c).clone())}}$(n).append("<br/>"),document.getElementById("properties").appendChild(n),document.getElementById("config").appendChild(i),Array.from($(".need-scroll")).forEach(function(e){utils.doNiceScroll(e)}),utils.doNiceScroll("#properties")}}function getAllDependParams(e){var t=[];return e.forEach(function(e){var n=e.conditions;_.isEmpty(n)||n.forEach(function(e){var n=e.conditionParameter;_.contains(t,n)||t.push(n)})}),t}function isVisible(e,t,n){var i=e.conditions;if(_.isEmpty(i))return!0;for(var r=0,o=i.length;r<o;r++){if(!conditionMet(i[r],t,n))return!1}return!0}function conditionMet(e,t,n){if(!_.contains(n,e.conditionParameter))return!1;var i,r,o=e.conditionType;switch(o){case"EqualType":case"NonEqualType":return i=t[e.conditionParameter],r=[],e.fulfillingOptions.forEach(function(t){t<e.possibleOptions.length&&r.push(e.possibleOptions[t])}),_.contains(r,i)===("EqualType"===o);case"EqualString":case"NonEqualString":return i=t[e.conditionParameter],r=e.conditionValue,i===r==("EqualString"===o);case"Boolean":return i=t[e.conditionParameter],r=e.conditionValue,"number"==typeof i&&(i=!!i),i===r;default:return toastr.warning("unsupported condition, please contact developer"),!0}}function generateLabel(e,t,n){var i=$("<label/>",{class:"control-label",style:"text-align:left;",for:t.key,title:t.description}).html(t.label);if(t.isRequired||i.append("<span>&nbsp;(optional)<span>"),"sql"===t.type||"pythonEditWindow"===t.type){String(utils.getValue(t,n)).startsWith("@#Infomation Already Encrypted#@")||("sql"===t.type&&i.append('<i class="fa fa-pencil-square-o sql-icon" style="margin-left:15px;cursor:pointer"></i>'),"pythonEditWindow"===t.type&&i.append('<i class="fa fa-pencil-square-o python-icon" style="margin-left:15px;cursor:pointer"></i>'))}e.append(i)}function generateField(e,t){var n="";"spanCheckbox"===t[0].className&&(n="inlineCheckBox");var i=$("<div/>",{class:n});i.append(t),e.append(i)}function generateRow(e,t,n,i){if(!e)return n;"test connection"!==$(n).val()&&generateLabel(e,t,i),generateField(e,n)}function handleParam(row,paramType,values,cell,currentOperator){if(paramType.supportEncrypt){var isEncrypted=String(utils.getValue(paramType,values)).startsWith("@#Infomation Already Encrypted#@");if(isEncrypted)return encryptField(row,paramType,values,cell)}var type=paramType.type+"Field";return eval(type+"(row, paramType, values, cell, currentOperator)")}function encryptField(e,t,n,i){var r=$("<input/>",{class:"form-control",style:"background-color:#5a3e3e",disabled:!0,id:t.key});return r.val("This parameter has been encrypted."),generateRow(e,t,r,n)}function pythonEditWindowField(e,t,n,i,r){var o=$("<textarea/>",{class:"form-control need-scroll",rows:8,id:t.key});o.val(utils.getValue(t,n)||""),t.isRequired&&""===o.val()&&o.addClass("invalid"),o.on("keypress",function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||o.blur()});var a=function(){t.isRequired&&""===o.val()?o.addClass("invalid"):o.removeClass("invalid");var i=o.val()||"";i!==n[t.key]&&modifyConfirm(e,o,t,n,i,null,null,r)};return o.on("blur",a),generateRow(e,t,o,n)}function hdfsFilesField(e,t,n,i,r){var o=$("<div/>",{class:"ui-front input-group",style:"width:100%"}),a=$("<input/>",{class:"form-control",style:"width:61%",id:t.key}),s=$("<input/>",{type:"file",style:"display:none"}),l=$("<button/>",{class:"btn btn-primary btn-sm",style:"margin-left:5px;height:26px",text:"Select"});o.append(a).append(s).append(l),a.val(utils.getValue(t,n)||""),t.isRequired&&""===a.val()&&a.addClass("invalid");var c=function(){t.isRequired&&""===a.val()?a.addClass("invalid"):a.removeClass("invalid");var i=a.val()||"";i!==n[t.key]&&modifyConfirm(e,a,t,n,i,null,null,r)};return l.on("click",function(e){openFileBrowser(a)}),a.on("keypress",function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||a.blur()}),a.on("blur",c),generateRow(e,t,o)}function uploadField(e,t,n){var i=$("<div/>",{class:"ui-front input-group",style:"width:100%"}),r=$("<input/>",{class:"form-control",readonly:"readonly",style:"background: inherit;cursor: pointer;width:61%",placeholder:"select",id:t.key}),o=$("<input/>",{type:"file",style:"display:none"}),a=$("<button/>",{class:"btn btn-primary btn-sm",style:"margin-left:5px;height:26px;",disabled:!0,text:"Upload"});return i.append(r).append(o).append(a),r.val(utils.getValue(t,n)||""),r.on("click",function(){$(this).next().click()}),o.on("change",function(){var e=$(this).val().split(".").pop(),n=this.files[0].size/1024/1024;if(e&&e.toUpperCase()!==t.fileType)toastr.error($.i18n.prop("ict_oneminer_process_title_check_filetype")),$(this).val("").prev().val("");else if(n>20)toastr.error($.i18n.prop("ict_oneminer_process_title_check_filesize")),$(this).val("").prev().val("");else{var i=$(this).val().split("\\").pop();$(this).prev().val(i).blur()}$(this).next("button").attr("disabled",!this.value)}),a.on("click",function(){uploadFile($(this).prev()[0].files[0],t.targetComponentId),$(this).attr("disabled",!0).siblings().val("")}),generateRow(e,t,i)}function uploadFile(e,t){var n=new FormData;n.append("file",e,encodeURI(e.name)),n.append("connectId",processManager.getCurrentConnectId());var i=function(e){"false"!==e?(t&&$("#"+t).val(e).blur(),toastr.success($.i18n.prop("ict_oneminer_message_upload_success"),"",utils.toastrConfig)):toastr.error($.i18n.prop("ict_oneminer_message_upload_failed"))};http.upload(utils.genApiUrl("file/upload"),n,i,errorHandler,"text")}function loopConditionField(e,t,n,i,r){var o=$("<button/>",{class:"btn btn-primary",width:"100%",text:"Edit"});return o.on("click",function(){var e=utils.getValue(t,n);openLoopConditionDialog(i,e,n,r)}),generateRow(e,t,o)}function openLoopConditionDialog(e,t,n,i){var r=new utils.Dialog(700);r.title=$.i18n.prop("ict_oneminer_dialog_loop_title"),r.position={my:"top",at:"top"},r.setOpenHandler(function(){$(this).dialog("option","maxHeight",$(window).height()),initLoopConditionDialog(e,t,$(this)),utils.doNiceScroll(".loop-condition")}),r.setConfirmHandler(function(){var e=getColumnsInfo();n["loop-condition"]=e,processManager.updateData(i),$(this).dialog("close")}),$('<div class="loop-condition"></div>').dialog(r).dialog("open")}function initLoopConditionDialog(e,t,n){var i='<table id="loopCpndition" class="table table-bordered dataTable"><thead><tr><th>'+$.i18n.prop("ict_oneminer_dialog_loop_name")+"</th><th>"+$.i18n.prop("ict_oneminer_dialog_loop_port")+"</th><th>"+$.i18n.prop("ict_oneminer_dialog_loop_condition")+"</th></tr></thead></table>";n.append(i),initLoopColumns(e,t)}function initLoopColumns(e,t){var n=getOperators(e),i=[],r=t&&t.split("␞")||[];n.forEach(function(e,n){var o=e.value.outputs.map(function(e){return e.name}),a=r.filter(function(t){return t.split("␟")[0]===e.value.name})[0];if(t&&a){var s=a.split("␟");i[n]=[s[0],getPortsHtml(o,s[1]),'<input class="meta-input form-control" value="'+s[2]+'"></input>']}else i[n]=[e.value.name,getPortsHtml(o),'<input class="meta-input form-control"></input>']});var o=$("#loopCpndition");o.dataTable().fnClearTable(),o.dataTable().fnDestroy(),o.dataTable({autoWidth:!1,paging:!1,order:!1,info:!1,searching:!1,bLengthChange:!1,columnDefs:[{targets:[0,1,2],orderable:!1}],data:i})}function getPortsHtml(e,t){for(var n='<select  class="meta-select form-control" style="width:85%">',i=0,r=e.length;i<r;i++){var o=e[i];n+=o===t?'<option selected="selected" value='+o+">"+o+"</option>":"<option value="+o+">"+o+"</option>"}return n+="</select>"}function getOperators(e){var t=[];return(e.children||[]).forEach(function(e){e.value&&(e.value.isGroup?t=t.concat(getOperators(e)):t.push(e))}),t}function getColumnsInfo(){var e="",t=$("#loopCpndition").find("tbody > tr");return t.each(function(n,i){var r=$(this).find("td").eq(0).text(),o=$(this).find("td").eq(1).find("select").val(),a=$(this).find("td").eq(2).find("input").val();e+=r+"␟"+o+"␟"+a,e+=n===t.length-1?"":"␞"}),e}function mappingField(e,t,n,i,r){var o=$("<div/>",{class:"ui-front input-group col-sm-12"}),a=$("<input/>",{class:"form-control",type:"text",width:"85%",id:t.key}),s=$("<a/>",{class:"edit-meta",text:"Edit"});o.append(a),o.append(s),a.val(utils.getValue(t,n)||""),t.isRequired&&""===a.val()&&a.addClass("invalid");var l=function(){t.isRequired&&""===a.val()?a.addClass("invalid"):a.removeClass("invalid");var i=a.val()||"";i!==n[t.key]&&modifyConfirm(e,a,t,n,i,null,null,r)};return a.on("keypress",function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||a.blur()}),s.on("click",function(){var e="";i.children&&i.children[0].value&&i.children[0].value.data&&(e=i.children[0].value.data.result),openEditDialog(e)}),a.on("blur",l),generateRow(e,t,o)}function openEditDialog(e){var t=new utils.Dialog(900);t.title=$.i18n.prop("ict_oneminer_dialog_metadata_metadata"),t.position={my:"top",at:"top"},t.setOpenHandler(function(){$(this).dialog("option","maxHeight",$(window).height()),utils.doNiceScroll(".edit-div"),initEditDialog(e,$(this))}),t.setConfirmHandler(function(){var e=getMetaColInfo();"{}"!=JSON.stringify(e)&&($(this).dialog("close"),$("#mapping").val(JSON.stringify(e)).blur())}),$('<div class="edit-div"></div>').dialog(t).dialog("open")}function initEditDialog(e,t){var n='<table id="metaTable" class="table table-bordered dataTable"><thead><tr><th id="table-operator-name">'+$.i18n.prop("ict_oneminer_dialog_metadata_name")+'</th><th id="table-operator-port">'+$.i18n.prop("ict_oneminer_dialog_metadata_port")+'</th><th id="table-operator-type">'+$.i18n.prop("ict_oneminer_dialog_metadata_type")+'</th><th id="table-operator-options">'+$.i18n.prop("ict_oneminer_dialog_metadata_options")+"</th></tr></thead></table>";t.append(n),initMetaColumns(e)}function initMetaColumns(e){var t=e.split(","),n=$("#mapping").val(),i=n?JSON.parse(n):void 0,r=[];t.forEach(function(e,t){i&&i.hasOwnProperty(e)?r[t]=['<span class="wordsFlow" title="'+e+'">'+e+"</span>",'<select  class="meta-select form-control">'+genSelectHtml(i[e].port,"InputPort0,OutputPort0")+"</select>",'<select  class="meta-select form-control type-select">'+genSelectHtml(i[e].type,"Numeric,Array,Categorical,Image")+"</select>",genMetaColOptionsHtml(i[e])]:r[t]=['<span class="wordsFlow" title="'+e+'">'+e+"</span>",'<select  class="meta-select form-control"><option value="InputPort0">InputPort0</option><option value="OutputPort0">OutputPort0</option></select>','<select  class="meta-select form-control type-select"><option value="Numeric">Numeric</option><option value="Array">Array</option><option value="Categorical">Categorical</option><option value="Image">Image</option></select>',""]});var o=$("#metaTable");o.dataTable().fnClearTable(),o.dataTable().fnDestroy(),o.dataTable({autoWidth:!1,paging:!1,ordering:!0,info:!1,searching:!1,bLengthChange:!1,columnDefs:[{targets:[1,2,3],orderable:!1},{targets:[3],width:"35%"}],data:r}),utils.doNiceScroll(".meta-option"),$(".type-select").change(function(){typeChangeHandler($(this))}),$(".categorical-select").change(function(){onCategoricalChange($(this))})}function typeChangeHandler(e){var t=e.parent().next();switch(e.val()){case"Categorical":var n='<div class="meta-option"><div class="meta_div select_input_div"><select class="form-control meta-select categorical-select"><option value="depth">depth</option><option value="vocabulary">vocabulary</option></select><input type="text" class="meta-input form-control" placeholder="'+$.i18n.prop("ict_oneminer_dialog_metadata_Categorical_Class")+'" style="width:50% !important"></div></div>';$(t).html(n);break;case"Image":var i='<div class="meta-option"><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_shear_range")+'">shear_range</label><input type="text" class="meta-input form-control"></div><div class="meta_div select_div"><label data-type="bool" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_vertical_flip")+'">vertical_flip</label><select class="form-control meta-select"><option value="true">true</option><option value="false">false</option></select></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_height")+'">height</label><input type="text" class="meta-input form-control"></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_scaling")+'">scaling</label><input type="text" class="meta-input form-control"></div><div class="meta_div select_div"><label data-type="bool" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_augmentation")+'">augmentation</label><select class="form-control meta-select"><option value="true">true</option><option value="false">false</option></select></div><div class="meta_div select_div"><label data-type="bool" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_resize")+'">resize</label><select class="form-control meta-select"><option value="true">true</option><option value="false">false</option></select></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_width_shift_range")+'">width_shift_range</label><input type="text" class="meta-input form-control"></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_width")+'">width</label><input type="text" class="meta-input form-control"></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_height_shift_range")+'">height_shift_range</label><input type="text" class="meta-input form-control"></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_rotation_range")+'">rotation_range</label><input type="text" class="meta-input form-control"></div><div class="meta_div select_div"><label data-type="bool" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_normalization")+'">normalization</label><select class="form-control meta-select"><option value="true">true</option><option value="false">false</option></select></div><div class="meta_div select_div"><label data-type="bool" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_horizontal_flip")+'">horizontal_flip</label><select class="form-control meta-select"><option value="true">true</option><option value="false">false</option></select></div></div>';$(t).html(i);break;default:$(t).html("")}utils.doNiceScroll(".meta-option"),$(".categorical-select").change(function(){onCategoricalChange($(this))})}function genMetaColOptionsHtml(e){if(!e)return"";var t="";switch(e.type){case"Image":t='<div class="meta-option"><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_shear_range")+'">shear_range</label><input type="text" class="meta-input form-control" value="'+e.options.shear_range+'"></div><div class="meta_div select_div"><label data-type="bool" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_vertical_flip")+'">vertical_flip</label><select class="form-control meta-select">'+genSelectHtml(e.options.vertical_flip)+'</select></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_height")+'">height</label><input type="text" class="meta-input form-control" value="'+e.options.height+'"></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_scaling")+'">scaling</label><input type="text" class="meta-input form-control" value="'+e.options.scaling+'"></div><div class="meta_div select_div"><label data-type="bool" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_augmentation")+'">augmentation</label><select class="form-control meta-select">'+genSelectHtml(e.options.augmentation)+'</select></div><div class="meta_div select_div"><label data-type="bool" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_resize")+'">resize</label><select class="form-control meta-select">'+genSelectHtml(e.options.resize)+'</select></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_width_shift_range")+'">width_shift_range</label><input type="text" class="meta-input form-control" value="'+e.options.width_shift_range+'"></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_width")+'">width</label><input type="text" class="meta-input form-control" value="'+e.options.width+'"></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_height_shift_range")+'">height_shift_range</label><input type="text" class="meta-input form-control" value="'+e.options.height_shift_range+'"></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_rotation_range")+'">rotation_range</label><input type="text" class="meta-input form-control" value="'+e.options.rotation_range+'"></div><div class="meta_div select_div"><label data-type="bool" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_normalization")+'">normalization</label><select class="form-control meta-select">'+genSelectHtml(e.options.normalization)+'</select></div><div class="meta_div select_div"><label data-type="bool" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_horizontal_flip")+'">horizontal_flip</label><select class="form-control meta-select">'+genSelectHtml(e.options.horizontal_flip)+"</select></div></div>";break;case"Categorical":var n=e.options.hasOwnProperty("vocabulary")?"vocabulary":"depth",i="vocabulary"==n?$.i18n.prop("ict_oneminer_dialog_metadata_Categorical_Vocabulary"):$.i18n.prop("ict_oneminer_dialog_metadata_Categorical_Class");t='<div class="meta-option"><div class="meta_div select_input_div"><select class="form-control meta-select categorical-select">'+genSelectHtml(n,"depth,vocabulary")+'</select><input type="text" class="meta-input form-control" placeholder="'+i+'" style="width:50% !important" value="'+e.options[n]+'"></div></div>'}return t}function genSelectHtml(e,t){var n="";return(t||"true,false").split(",").forEach(function(t,i){e.toString()==t?n+='<option selected="selected" value="'+t+'">'+t+"</option>":n+='<option value="'+t+'">'+t+"</option>"}),n}function onCategoricalChange(e){var t=$(e).val();$(e).next().val(""),"vocabulary"===t?$(e).next().attr("placeholder",$.i18n.prop("ict_oneminer_dialog_metadata_Categorical_Vocabulary")):$(e).next().attr("placeholder",$.i18n.prop("ict_oneminer_dialog_metadata_Categorical_Class"))}function getMetaColInfo(){var e={},t=!0;return $("#metaTable").find("tbody > tr").each(function(){var n=$(this).find("td").eq(0).find("span").text();e[n]={type:$(this).find("td").eq(2).find("select").val(),port:$(this).find("td").eq(1).find("select").val(),options:{}};var i={};$(this).find("td").eq(3).find(".meta-option > .meta_div").each(function(){switch($(this).attr("class")){case"meta_div select_div":i[$(this).find("label").text()]=transferData($(this).find("select").val(),$(this).find("label").data("type"));break;case"meta_div input_div":var e=$(this).find("label").text(),n=$(this).find("input").val();if(""===n)return $(this).find("input").focus(),t=!1,!1;i[e]=transferData(n,$(this).find("label").data("type"));break;case"meta_div select_input_div":var r=$(this).find("select").val(),o=$(this).find("input").val();if(""===o)return $(this).find("input").focus(),t=!1,!1;i[r]="vocabulary"===r?o.split(","):transferData(o,"int")}}),"{}"!=JSON.stringify(i)?e[n].options=i:delete e[n].options}),t?e:{}}function transferData(e,t){var n=e;switch(t){case"int":n=parseInt(e);break;case"bool":n="true"==e;break;case"float":n=parseFloat(e)}return n}function multilinePlaintextField(e,t,n){var i=$("<textarea/>",{class:"form-control",rows:15,readonly:"readonly",style:"background: inherit",id:t.key});return i.val(utils.getValue(t,n)||""),generateRow(e,t,i)}function sqlField(e,t,n,i,r){var o=$("<textarea/>",{class:"form-control need-scroll",rows:8,id:t.key});o.val(utils.getValue(t,n)||""),t.isRequired&&""===o.val()&&o.addClass("invalid");var a=function(){t.isRequired&&""===o.val()?o.addClass("invalid"):o.removeClass("invalid");var i=o.val()||"";i!==n[t.key]&&modifyConfirm(e,o,t,n,i,null,null,r)};return o.on("keypress",function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||o.blur()}),o.on("blur",a),generateRow(e,t,o,n)}function inputCellChange(){var e=$("#cron .cron-table-inputCell input");e.on("input",function(){var t=[];Array.from(e).forEach(function(n,i){t.push(e.eq(i).val())}),$("#cronValue").val(t.join(" ").trim())}),e.on("blur",function(){cronValidateHandler()})}function cronValueChange(){var e=$("#cronValue"),t=$("#cron .cron-table-inputCell input");e.on("input",function(){var n=e.val().split(" ");n.forEach(function(e,i){t.eq(i).val(n[i])})}),e.on("blur",function(){cronValidateHandler()})}function addCronInputChangeListener(){inputCellChange(),cronValueChange(),cronParsing(),$("#cronValue").trigger("input")}function cronParsing(){$("#analysis").on("click",function(){if(cronValidateHandler()){var e={cronExp:$("#cronValue").val(),number:5},t=function(e){var t="";if(e&&1==e.status)for(var n=e.timeNext,i=0;i<n.length;i++)t+="<li>"+n[i]+"</li>";else t="<li>"+e.message+"</li>";var r='<div>\n                                <div class="cron-run-time">'+$.i18n.prop("CRON_expression_timeNext")+":</div>\n                                <ul>"+t+"</ul>\n                            </div>";$("#cron-msg").html(r)};http.post(utils.genApiUrl("process/parseCron"),e,t,errorHandler)}})}function opCronTable(e,t,n){var i='<div id="cron">\n                        <table>\n                            <tbody>\n                                <tr class="cron-table-title">\n                                    <td></td>\n                                    <td align="center">'+$.i18n.prop("CRON_Second")+'<span>*</span></td>\n                                    <td align="center">'+$.i18n.prop("CRON_Minutes")+'<span>*</span></td>\n                                    <td align="center">'+$.i18n.prop("CRON_Hour")+'<span>*</span></td>\n                                    <td align="center">'+$.i18n.prop("CRON_Day")+'<span>*</span></td>\n                                    <td align="center">'+$.i18n.prop("CRON_Month")+'<span>*</span></td>\n                                    <td align="center">'+$.i18n.prop("CRON_Week")+'<span>*</span></td>\n                                    <td align="center">'+$.i18n.prop("CRON_Year")+'</td>\n                                </tr>\n                                <tr class="cron-table-inputCell">\n                                    <td>'+$.i18n.prop("CRON_expression")+'</td>\n                                    <td><input type="text"  class="col"></td>\n                                    <td><input type="text"  class="col"></td>\n                                    <td><input type="text"  class="col"></td>\n                                    <td><input type="text"  class="col"></td>\n                                    <td><input type="text"  class="col"></td>\n                                    <td><input type="text"  class="col"></td>\n                                    <td><input type="text"  class="col"></td>\n                                </tr>\n                                <tr>\n                                    <td>'+$.i18n.prop("CRON_expression_cron")+'</td>\n                                    <td colspan="5"><input type="text" name="v_second" style="width:100%" id="cronValue"></td>\n                                    <td colspan="2" align="center"><button id="analysis" class="btn btn-primary " style="width: 80%;">'+$.i18n.prop("CRON_expression_parsing")+'</button></td>\n                                </tr>\n                                <tr>\n                                    <td colspan="8" id="cron-msg"></td>\n                                </tr>\n                            </tbody>\n                        </table>\n                    </div>',r=new utils.Dialog(830,400);r.title=$.i18n.prop("CRON_expression_cron"),r.setOpenHandler(function(){$(this).html(i),$("#cronValue").val(n),addCronInputChangeListener()}),r.setConfirmHandler(function(){cronValidateHandler()&&($(this).dialog("close"),scheduleApplyHandler(e,t))}),$("<div></div>").dialog(r).dialog("open")}function cronValidateHandler(){$("#cron .cron-table-inputCell input").removeClass("invalid");var e=$("#cronValue").val(),t=cronEV.cronValidate(e);if(!0===t)return $("#cron-msg").html(""),$("#cron-input").val(e),!0;var n='<div id="cron-error-msg" class="cron-error-msg">'+t[0]+"</div>";return void 0!==t[1]&&(t[1]instanceof Array?t[1].forEach(function(e){$("#cron .cron-table-inputCell input").eq(e).addClass("invalid")}):$("#cron .cron-table-inputCell input").eq(t[1]).addClass("invalid")),$("#cron-msg").html(n),!1}function datetimeField(e,t,n,i,r){var o=$("<input/>",{class:"form-control",style:"border-right: 0px",type:"text",id:t.key});o.val(utils.getValue(t,n)||"");var a=$("<div/>",{class:"input-group-addon",style:"cursor:pointer; padding: 5px 3px; background-color: transparent;border-left: 0px; border-color: rgba(255,255,255,0.1);"}).append($("<i/>",{class:"fa fa-calendar"})),s=$("<div/>",{class:"input-group"}).append(o).append(a);a.on("click",function(){o.focus()});var l=function(){var e=o.val()||"";e!==n[t.key]&&(processManager.methodProxy.getMethod("setSavable")(!0),n[t.key]=e,valueChangeEvent(t.needRepaint,r))};o.on("keypress",function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||o.blur()}),o.on("blur",l);var c=generateRow(e,t,s);return o.datetimepicker({showOtherMonths:!0,selectOtherMonths:!0,changeMonth:!1,changeYear:!1,dateFormat:"yy-mm-dd",timeInput:!0,onSelect:l}),c}function stringField(e,t,n,i,r){var o;o="password"===t.type?$("<input/>",{class:"form-control",type:"password",id:t.key}):$("<input/>",{class:"form-control",type:"text",id:t.key}),o.val(utils.getValue(t,n)||""),t.isRequired&&""===o.val()&&o.addClass("invalid");var a=function(){t.isRequired&&""===o.val()?o.addClass("invalid"):o.removeClass("invalid");var i=o.val()||"";i!==n[t.key]&&modifyConfirm(e,o,t,n,i,null,null,r)};return o.on("keypress",function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||o.blur()}),o.on("blur",a),generateRow(e,t,o)}function isNonScientificNumber(e){if(void 0===e||null===e||"number"!=typeof e&&"string"!=typeof e)return!1;var t=String(e);return t.length<=15&&t.indexOf("e+")<0&&t.indexOf("E+")<0&&!isNaN(t)&&isFinite(t)}function intField(e,t,n,i,r){var o=$("<input/>",{class:"form-control",type:"number",title:" ",id:t.key});o.prop("step","double"===t.type?.01:1),_.has(t,"min")&&isNonScientificNumber(t.min)&&o.prop("min",t.min),_.has(t,"max")&&isNonScientificNumber(t.max)&&o.prop("max",t.max),o.val(utils.getValue(t,n)),t.isRequired&&""===o.val()&&o.addClass("invalid");var a=function(){if(t.isRequired&&""===o.val()?o.addClass("invalid"):o.removeClass("invalid"),!this.checkValidity())return toastr.warning($.i18n.prop("ict_oneminer_message_number_range",t.label,this.min,this.max)),$(this).val(n[t.key]).focus();var i=o.val()||"";i!==n[t.key]&&(null===r?(processManager.methodProxy.getMethod("setSavable")(!0),n[t.key]=i,valueChangeEvent(t.needRepaint,r)):modifyConfirm(e,o,t,n,i,null,null,r))};return o.on("keypress",function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||o.blur()}),o.on("blur",a),generateRow(e,t,o)}function booleanField(e,t,n,i,r){var o=$("<span/>",{class:"spanCheckbox"}),a=$("<input/>",{type:"checkbox",class:"pull-left",id:t.key}),s=$("<label/>",{for:t.key});o.append(a).append(s);var l=utils.getValue(t,n);a.prop("checked",_.isBoolean(l)?l:"true"===l||1===l);var c=function(){var i=a.prop("checked");null===r?(processManager.methodProxy.getMethod("setSavable")(!0),n[t.key]=i,valueChangeEvent(t.needRepaint,r)):modifyConfirm(e,a,t,n,i,null,null,r)};return a.on("click",c),generateRow(e,t,o)}function getZaipTopOperators(){var e=processManager.getProcessInfo(),t=e&&e.operators,n=[constants.ZAIPDATA,constants.ZAIPENTRANCE,constants.ZAIPPREDICTION],i=[],r=[];t.forEach(function(e){var t=processManager.getOperatorAsCell(graph,e.name),n=t&&t.children||[];(n.every(function(e){return e.value.portType!==constants.PORT_INPUT_TYPE})||n.every(function(e){return e.value.portType!==constants.PORT_INPUT_TYPE||!e.edges}))&&i.push(t)});return function getTopZaipOp(e){e.forEach(function(e){if(_.contains(n,e.value.operatorExecType))r.push(e.value.name);else{var t=e&&e.children||[];t.every(function(e){return e.value.portType!==constants.PORT_OUTPUT_TYPE})||t.every(function(e){return e.value.portType!==constants.PORT_OUTPUT_TYPE||!e.edges})||t.forEach(function(e){e.value.portType===constants.PORT_OUTPUT_TYPE&&(e.edges||[]).forEach(function(e){getTopZaipOp([e.target.parent])})})}})}(i),r.join()}function categoryField(e,t,n,i,r){var o=$("<select/>",{class:"form-control",id:t.key});if(t.categories){var a=!1,s=utils.getValue(t,n),l=[];if(t.categories.length>0)l=t.categories;else if("table_name"===t.key){var c=processManager.getOperatorParams(i.id);l=JSON.parse(c.checkDbButton||"[]")}l.forEach(function(e){a=a||e===s,o.append($("<option/>",{selected:e===s}).html(e))}),a||(t.categories.length&&(n[t.key]=""),o.append($("<option/>",{selected:!0,disabled:!0,style:"display:none"}).html("")))}var u=function(){var i=o.val()||"";if(i!==n[t.key])if(t.key===clusterKey)if(processManager.isRunning())resetConfirmDialog(o,t,n);else{var a=function(e,t,n){processManager.methodProxy.getMethod("setSavable")(!0),t[e.key]=n,clusterChangedEvent(t[e.key])};modifyConfirmDialog(o,t,n,i,a,null,null,r)}else if("zaip_id"===t.key)if(isZaipRunning())resetConfirmDialog(o,t,n);else if(processManager.isRunning())zaipIdChangeDialog(o,t,n,i);else{var a=function(e,t,n){processManager.methodProxy.getMethod("setSavable")(!0),t[e.key]=n,valueChangeEvent(e.needRepaint,getZaipTopOperators()),clearZaipTrainCache()};modifyConfirmDialog(o,t,n,i,a,"zaip",null,getZaipTopOperators(),!0)}else null===r?(processManager.methodProxy.getMethod("setSavable")(!0),n[t.key]=i,valueChangeEvent(t.needRepaint,r)):modifyConfirm(e,o,t,n,i,null,null,r)};return o.on("change",u),generateRow(e,t,o)}function stringcategoryField(e,t,n,i,r){var o=$("<div/>",{class:"ui-front",style:"position:relative"}),a=$("<input/>",{class:"form-control",id:t.key});o.append(a),a.val(utils.getValue(t,n)),t.isRequired&&""===a.val()&&a.addClass("invalid"),a.autocomplete({minLength:0,source:t.categories,select:function(i,o){var s=o.item.value;modifyConfirm(e,a,t,n,s,null,null,r)},open:function(){$("div.ui-front").removeClass("ui-front-zIndex"),$(this).parent().addClass("ui-front-zIndex"),utils.doNiceScroll($(".header-fixed").parent()),$(".header-fixed>tbody").getNiceScroll().resize()},close:function(){$(".header-fixed").parent().getNiceScroll().resize(),$(".header-fixed>tbody").getNiceScroll().resize()}}).click(function(){$(this).autocomplete("search",""),utils.doNiceScroll($(".form-group .ui-widget-content"))}),a.on("keypress",function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||a.blur()});var s=function(){t.isRequired&&""===a.val()?a.addClass("invalid"):a.removeClass("invalid");var i=a.val()||"";i!==n[t.key]&&modifyConfirm(e,a,t,n,i,null,null,r)};return a.on("blur",s),generateRow(e,t,o)}function hivetableField(e,t,n,i,r){var o=$("<div/>",{class:"ui-front input-group"}),a=$("<input/>",{class:"form-control",id:t.key}),s=$("<div/>",{class:"input-group-btn"}),l=$("<button/>",{class:"btn btn-default",type:"button",style:"font-size:12px;line-height: 1px;"}).append($("<span/>",{class:"fa fa-refresh"}));s.append(l),o.append(a),o.append(s);var c=processManager.getParams()[clusterKey];if(!_.isEmpty(t.categories)&&_.has(n,clusterKey)&&n[clusterKey]===c||(n.zadoop_connection_id=c,t.categories=utils.getHiveTables(c,t.tableType)),initTableInput(a,t,n,r),l.on("click",function(){"0"===utils.refreshHiveTable(c,t.tableType)&&toastr.warning("It is refreshing now, please try again later.");var e=$("<input/>",{class:"form-control",id:t.key});$(this).parent().prev().replaceWith(e),n.zadoop_connection_id=c,t.categories=utils.getHiveTables(c,t.tableType),initTableInput(e,t,n)}),!e)return o;generateRow(e,t,o)}function attributeField(e,t,n,i,r){var o=$("<select/>",{class:"form-control",id:t.key});if(t.inPort&&(t.categories=[],(i.children||[]).some(function(e){if(e.value.portType===constants.PORT_INPUT_TYPE&&e.value.name===t.inPort&&e.value.data&&e.value.data.type===constants.METADATA_EXAMPLE_VIEW){t.categories=t.enableEmpty?[""]:[];var n=JSON.parse(e.value.data.result);return t.categoriyList=n,n.forEach(function(e){t.categories.push(e.name)}),!0}})),t.categories){var a=!1,s=utils.getValue(t,n);t.categories.forEach(function(e){a=a||e===s,o.append($("<option/>",{value:e,selected:e===s,"data-type":getTypeByValue(t,e)}).html(e))}),a||(t.categories.length&&(n[t.key]=""),o.append($("<option/>",{selected:!0,disabled:!0,style:"display:none"}).html("")))}t.isRequired&&!o.val()&&o.addClass("invalid");var l=function(){t.isRequired&&!o.val()?o.addClass("invalid"):o.removeClass("invalid");var i=o.val()||"";i!==n[t.key]&&modifyConfirm(e,o,t,n,i,null,null,r)};return o.on("change",l),generateRow(e,t,o)}function attributesField(e,t,n,i,r){var o=[],a=utils.getValue(t,n);a=a?JSON.parse(a):[],t.inPort&&(t.categories=[],(i.children||[]).some(function(e){if(e.value.portType===constants.PORT_INPUT_TYPE&&e.value.name===t.inPort&&e.value.data&&e.value.data.type===constants.METADATA_EXAMPLE_VIEW){t.categories=[];return JSON.parse(e.value.data.result).forEach(function(e){t.categories.push(e.name)}),!0}})),t.categories&&t.categories.forEach(function(e){a.indexOf(e)<0&&(!t.excludeAttrs||t.excludeAttrs.indexOf(e)<0)&&o.push(e)});var s=t.key+"ParamDialog",l=$("<div/>",{id:s,style:"display: table, width:100%"});$("#properties").append(l);var c=$("#attributesDialog").clone();l.append(c.children());var u="#"+s+" ";$(u+"#unselected-filter").on("input",function(){var e=$(this).val().toLowerCase();$(u+"#unselected-attr li").each(function(){var t=$(this);t.removeClass("selected"),t.text().toLowerCase().indexOf(e)<0?t.addClass("hide"):t.removeClass("hide")})}),$(u+"#selected-filter").on("input",function(){var e=$(this).val().toLowerCase();$(u+"#selected-attr li").each(function(){var t=$(this);t.removeClass("selected"),t.text().toLowerCase().indexOf(e)<0?t.addClass("hide"):t.removeClass("hide")})}),$(u+"#unselected-attr,"+u+"#selected-attr").sortable({connectWith:".connected",receive:function(e,t){sort(t.item.parent())},stop:function(e,t){sort(t.item.parent())}});var d=[],h=[];handleListSelect($(u+"#unselected-attr"),d,u),handleListSelect($(u+"#selected-attr"),h,u),$(u+"button#select").on("click",function(){var e=$(u+"#unselected-attr .selected").detach();e.removeClass("selected lastselected"),$(u+"#selected-attr").append(e),sort($(u+"#selected-attr"))}),$(u+"button#unselect").on("click",function(){var e=$(u+"#selected-attr .selected").detach();e.removeClass("selected lastselected"),$(u+"#unselected-attr").append(e),sort($(u+"#unselected-attr"))}),o.forEach(function(e){$(u+"#unselected-attr").append($("<li/>").html(e))}),sort($(u+"#unselected-attr")),a.forEach(function(e){$(u+"#selected-attr").append($("<li/>").html(e))}),sort($(u+"#selected-attr")),dialogs.push("#"+s);var p=$("#"+s).dialog({autoOpen:!1,show:{effect:"fade",duration:500},hide:"drop",modal:!0,classes:"display_table",resizable:!0,height:"auto",width:700,title:"Select Attributes: "+t.key,buttons:[{text:"Apply",click:function(){var e=[];$(u+"#selected-attr li").each(function(){e.push($(this).text())});var i=JSON.stringify(e);n[t.key]!==i&&modifyConfirm({},null,t,n,i,null,null,r),$(this).dialog("close")}},{text:"Cancel",click:function(){$(this).dialog("close")}}]}),f=function(){p.data("info",{attributes:o,selected_attrs:a}).dialog("open")},g=$("<button/>",{type:"button",class:"btn btn-primary form-control"}).html("Select Attributes");return g.on("click",f),generateRow(e,t,g)}function sort(e){var t=e.children().detach().sort(function(e,t){return $(e).text()<$(t).text()?-1:$(e).text()>$(t).text()?1:0});e.append(t)}function handleListSelect(e,t,n){e.on("click","li",function(n){document.activeElement.blur();var i=$(this),r=e.find("li");if(n.shiftKey){var o=null;if(i.nextAll(".lastselected").length>0?o="forward":i.prevAll(".lastselected").length>0&&(o="back"),o&&t.length>0){if(i[0]===t[0])return;var a=[];if("forward"===o)a=i.nextUntil(t,"li");else{if("back"!==o)return;a=t.nextUntil(i,"li")}r.removeClass("selected"),a.addClass("selected"),t.addClass("selected"),i.addClass("selected")}else t=i,i.addClass("lastselected"),r.removeClass("selected"),i.addClass("selected")}else n.ctrlKey||$(".connected .selected").removeClass("selected"),e.find(".lastselected").removeClass("lastselected"),i.addClass("selected"),i.addClass("lastselected"),t=i}),e.on("dblclick","li",function(){var t=e.attr("id"),i=$(this).detach();i.removeClass("selected lastselected"),"unselected-attr"===t?($(n+"#selected-attr").append(i),sort($(n+"#selected-attr"))):($(n+"#unselected-attr").append(i),sort($(n+"#unselected-attr")))})}function checkDbButtonField(e,t,n,i){var r=$("<input/>",{type:"button",class:"checkDbButton",id:t.type});$(r).val("test connection");var o=function(){checkDbConnection({dbSystem:$("#database_system").val(),host:$("#Host").val(),port:$("#Port").val(),schema:$("#Schema").val(),username:$("#Username").val(),password:$("#Password").val()},n,!0)};return r.on("click",o),generateRow(e,t,r)}function resetTableList(){var e=graph.getSelectionCell();utils.getParameters(e.value.type).forEach(function(e){"table_name"===e.key&&valueChangeEvent(!0)})}function checkDbConnection(e,t,n){var i=function(e){var i;"result:fail"===e[0]?(i=[],toastr.error($.i18n.prop("ict_oneminer_property_check_database_failed"))):"Please test database link firstly."==e[0]?i=e:(i=e,toastr.success($.i18n.prop("ict_oneminer_property_check_database_success"),"",utils.toastrConfig)),n&&(t.checkDbButton=JSON.stringify(i),resetTableList())};http.get(utils.genApiUrl("operator/checkdb"),e,i,errorHandler)}function pageLinkField(e,t,n,i,r){var o=t.key+"ParamDialog",a=$("<div/>",{id:o,style:"display: table, width:100%"});$("#properties").append(a);var s=$("<iframe>").attr({id:"gis-frame",src:t.pageUrl,width:"100%",height:"100%"});a.append(s),dialogs.push("#"+o);var l=$("#"+o).dialog({autoOpen:!1,show:{effect:"fade",duration:500},hide:"drop",modal:!0,classes:"display_table",resizable:!0,height:800,width:1070,title:"Gis Select: "+t.label,buttons:[{text:"Apply",click:function(){var e=function(e){return{cellsArray:e.globalCondition.cellsArray,gridsArray:e.globalCondition.gridsArray}}($("#gis-frame")[0].contentWindow);n[t.key]=JSON.stringify(e),valueChangeEvent(t.needRepaint,r),$(this).dialog("close")}},{text:"Cancel",click:function(){$(this).dialog("close")}}]}),c=function(){l.data("info",{pageUrl:t.pageUrl,script:t.script}).dialog("open")},u=$("<button/>",{type:"button",class:"btn btn-primary form-control"}).html("Gis Select");return u.on("click",c),generateRow(e,t,u)}function setGraph(e){graph=e}function checkGBaseButtonField(e,t,n,i){var r=$("<input/>",{type:"button",class:"checkDbButton",id:t.type});$(r).val("test connection");var o=function(){checkDbConnection({dbSystem:"gbase",host:$("#Host").val(),port:$("#Port").val(),schema:$("#Schema").val(),username:$("#Username").val(),password:$("#Password").val()},n,!1)};return r.on("click",o),generateRow(e,t,r)}function zaipdataField(e,t,n,i,r){var o=$("<div/>",{class:"ui-front input-group",style:"width:100%"}),a=$("<input/>",{class:"form-control",id:t.key});o.append(a);var s=processManager.getParams().zaip_id,l=utils.getHiveZaip(s);_.isEmpty(t.categories)&&(t.categories=l);var c=utils.getValue(t,n),u=l.filter(function(e){return e.id==c})[0].name;a.val(u||""),t.isRequired&&""===a.val()&&a.addClass("invalid"),a.autocomplete({minLength:0,source:function(e,t){for(var n=new RegExp($.ui.autocomplete.escapeRegex(e.term),"i"),i=l.map(function(e){return e.name}),r=l.map(function(e){return e.id}),o=[],a=0;a<i.length;a++){var s=i[a],c=r[a];if(!s||e.term&&!n.test(s)||o.push({label:s,value:s,id:c}),o.length>100){o.push({label:$.i18n.prop("ict_oneminer_tip_more_items"),value:"maxRepSizeReached"});break}}t(o)},select:function(i,o){if("maxRepSizeReached"==o.item.value)return!1;var s=o.item.id;modifyConfirm(e,a,t,n,s,function(e,t,n){t[e.key]=n,valueChangeEvent(e.needRepaint,r)},null,r)},focus:function(e,t){if("maxRepSizeReached"==t.item.value)return!1}}).click(function(){$(this).autocomplete("search",""),utils.doNiceScroll($(".form-group .ui-widget-content"))}),a.on("keypress",function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||a.blur()}),generateRow(e,t,o)}function zaipmodelsField(e,t,n,i,r){var o=$("<div/>",{class:"ui-front input-group",style:"width:100%"}),a=$("<input/>",{class:"form-control",id:t.key});o.append(a);var s=processManager.getParams().zaip_id,l=processManager.methodProxy.getMethod("getSourceByOperatorName")(graph,i.value.name,constants.PORT_INPUT_TYPE,"name",constants.ZAIPENTRANCE),c=utils.getValue(t,n),u=utils.getZaipModels(s,processManager.getProcessName(),l),d=u[0]&&u.filter(function(e){return e.id==c}),h=d&&d[0]&&d[0].name;a.val(h||""),t.isRequired&&""===a.val()&&a.addClass("invalid"),a.autocomplete({minLength:0,source:function(e,t){for(var n=utils.getZaipModels(s,processManager.getProcessName(),l),i=new RegExp($.ui.autocomplete.escapeRegex(e.term),"i"),r=n.map(function(e){return e.name}),o=n.map(function(e){return e.id}),a=[],c=0;c<r.length;c++){var u=r[c],d=o[c];if(!u||e.term&&!i.test(u)||a.push({label:u,value:u,id:d}),a.length>100){a.push({label:$.i18n.prop("ict_oneminer_tip_more_items"),value:"maxRepSizeReached"});break}}t(a)},select:function(i,o){if("maxRepSizeReached"==o.item.value)return!1;var s=o.item.id;modifyConfirm(e,a,t,n,s,function(e,t,n){t[e.key]=n,valueChangeEvent(e.needRepaint,r)},null,null,r)},focus:function(e,t){if("maxRepSizeReached"==t.item.value)return!1}}).click(function(){$(this).autocomplete("search",""),utils.doNiceScroll($(".form-group .ui-widget-content"))}),a.on("keypress",function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||a.blur()}),generateRow(e,t,o)}var mx=utils.mx;__webpack_require__(63),__webpack_require__(66),__webpack_require__(37),__webpack_require__(38),__webpack_require__(21),__webpack_require__(35),__webpack_require__(65),__webpack_require__(33),__webpack_require__(32),__webpack_require__(9),__webpack_require__(30),__webpack_require__(53),__webpack_require__(51),__webpack_require__(52),$.ui.autocomplete.prototype._resizeMenu=function(){this.menu.element.outerWidth(this.element.outerWidth())};var dialogs=[],graph,isSelectionChange,currentConnectId,clusterKey=utils.clusterKey,sparkConfig={},global_sql_editor;$("#properties").on("click",".python-icon",function(){var e=$(this).parents(".form-group").find("textarea"),t=e.val(),n=new utils.Dialog(1e3,500);n.title="Python",n.resizable=!0,n.position={my:"center",at:"center"},n.setOpenHandler(pythonDialogOpenHandler),n.setConfirmHandler(pythonDialogConfirmHandler),$("<div></div>").dialog(n).data("info",{pyCode:t,callBack:function(t){e.val(t).blur()}}).dialog("open")});var pythonDialogOpenHandler=function(){$(this).append('<textarea id="py-code" style="background:inherit"/>'),initPythonEditor($(this).data("info").pyCode)},initPythonEditor=function(e){pythonEditor=CodeMirror.fromTextArea(document.getElementById("py-code"),{lineNumbers:!0,mode:"python",theme:"monokai"}),pythonEditor.on("keyup",function(e,t){!e.state.completionActive&&(t.keyCode>=65&&t.keyCode<=90||190==t.keyCode)&&CodeMirror.commands.autocomplete(e,null,{completeSingle:!1})}),pythonEditor.setValue(e)},pythonDialogConfirmHandler=function(){var e=pythonEditor.getValue();(0,$(this).data("info").callBack)(e),$(this).dialog("close")};$("#properties").on("click",".sql-icon",function(e){var t=$(this).parent().next().children();$("<div></div>").dialog({resizable:!0,autoOpen:!1,width:1e3,height:500,modal:!0,title:"sql",open:function(){$(this).append('<textarea id="sql-code" style="background:inherit"/>')},buttons:[{text:$.i18n.prop("ict_oneminer_dialog_confirm"),click:function(){t.val(global_sql_editor.getValue()).blur(),$(this).dialog("close")}},{text:$.i18n.prop("ict_oneminer_dialog_cancel"),click:function(){$(this).dialog("close")}}],close:function(){$(this).dialog("close"),$(this).empty()},position:{my:"center",at:"center"}}).dialog("open"),initSqlCodeTips(t.val())});var connectIdChangeCallback=function(){},setClusterChangeCallback=function(e){connectIdChangeCallback=e},checkResource=function(e){var t=$("#cores").val(),n=$("#memory").val(),i=utils.getResourceConfig(processManager.getCurrentConnectId())||{},r=i.cores,o=i.executorCores,a=i.memory;return t>r?(toastr.warning($.i18n.prop("ict_oneminer_message_max_cores",r)),$("#cores").val(e.cores),!1):!(t/o*n>a&&(toastr.warning($.i18n.prop("ict_oneminer_message_max_memory",a,o)),$("#memory").val(e.memory),1))},advancedSetting=function(e,t){$(".advanced-setting").on("click",function(){var n=processManager.getCurrentConnectId(),i=sparkConfig[n]||(sparkConfig[n]=utils.getDataFromServer({connectId:n},utils.genApiUrl("datasource/sparkresource/list"))),r=Object.keys(i)||[],o=[["spark.port.maxRetries",r["spark.port.maxRetries"]||"100"],["spark.driver.maxResultSize",r["spark.driver.maxResultSize"]||"3g"],["spark.akka.frameSize",r["spark.akka.frameSize"]||"20"]],a=e.sparkConfs||JSON.stringify(o);e.sparkConfs=a;var s={key:"sparkConfs",keyType:{categories:r,categoryList:i,key:"parameter_name",label:"parameter name",isRequired:!0,type:"stringcategory"},valueType:{key:"parameter_value",label:"parameter value",isRequired:!0,type:"string"}},l={},c=new SparkConfigDialog(700,500,processManager,{paramType:s,values:e,cell:l,modifyConfirm:modifyConfirm,handleParam:handleParam,currentOperator:t});c.registerValidateRules({key:function(e){return!0}}),c.show()})},handleLogLevel=function(e,t,n){if((n&&n.value&&n.value.operatorExecType)===constants.OPERATOR_TYPE_SPARK){var i=t.spark_log_level||"";t.spark_log_level=i;var r=$("<div/>",{class:"form-group form-group-sm"}),o=$("<label/>",{class:"control-label",for:"spark_log_level",title:"spark log level",style:"text-align:left"}).html("spark log level"),a=$("<select/>",{class:"form-control",id:"spark_log_level"}),s=$("<div/>").append(a);r.append(o).append(s),["","INFO","WARN","ERROR"].forEach(function(e){a.append($("<option/>",{selected:i===e}).html(e))}),a.on("change",function(){t.spark_log_level=this.value,processManager.methodProxy.getMethod("setSavable")(!0)}),e.append(r)}},getDescription=function(e){var t=e.value.type.replace(" ","_"),n='<ul class="operator-desc">';$.i18n.prop("OP_NAME_"+t).startsWith("[")||(n+='<li>\n                        <div class="desc-label">'+$.i18n.prop("OP_NAME")+'</div>\n                        <a style="color:#77adff;cursor:pointer;" href="'+utils.getHelpDocUrl(t)+'" target="_blank">'+$.i18n.prop("OP_NAME_"+t)+"</a>\n                    </li>");for(var i=["OP_ABSTRACT","OP_DESC","OP_INPUT","OP_OUTPUT"],r=0,o=i.length;r<o;r++){var a=i[r],s=$.i18n.prop(a+"_"+t);if(!s.startsWith("[")){n+='<li>\n                            <div class="desc-label">'+$.i18n.prop(a)+"</div>\n                            <div>"+s+"</div>\n                        </li>"}}return n+="</ul>"},openFileBrowser=function(e){var t=new utils.Dialog(500);t.title=$.i18n.prop("ict_oneminer_process_title_file_select"),t.setOpenHandler(fileBrowserOpenHandler),t.setConfirmHandler(fileBrowserConfirmHandler),$('<div id="fileBrowser"></div>').dialog(t).data("info",{path:e.val(),callBack:function(t){e.val(t).blur()}}).dialog("open")},fileBrowserOpenHandler=function(){var e=$(this).data("info").path||"/";$(this).append('<div class="col-sm-7" style="padding-left:10px;height:26px"><input type="search" class="form-control" id="searchInput" placeholder="input path:/home/fakepath" style="height:26px;"></div><div><button id="searchBtn" class="btn btn-primary btn-sm" style="margin-left:8px; height:26px;">search</button><button id="upBtn" class="btn btn-primary btn-sm" style="margin-left:15px; height:26px;">Up</button></div>'),$("#searchInput").val(e),$("#searchInput").keypress(function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||$("#searchBtn").click()}),$("#searchBtn").click(function(){var e=$("#searchInput").val();getFileList(e)}),$("#upBtn").click(function(){var e=$("#searchInput").val(),t=e.lastIndexOf("/")>0,n=t&&e.lastIndexOf("/")||e.lastIndexOf("\\"),i=e.substring(0,n);$("#searchInput").val(i),getFileList(i)}),getFileList(e)},getFileList=function(e){var t={connectId:processManager.getCurrentConnectId,path:e||"/"};http.post(utils.genApiUrl("datasource/hdfs/listdir"),t,getFileListSuccess,errorHandler)},fileBrowserConfirmHandler=function(){var e=$("#searchInput").val();(0,$(this).data("info").callBack)(e),$(this).dialog("close")},getFileListSuccess=function(e){$(".file-list").remove();var t=e||[],n='<ul class="file-list">';t.forEach(function(e){var t=e.path.split("/").pop(),i=e.dir?"fa fa-folder-o":"fa fa-file",r=e.dir?"hdfs-folder":"hdfs-file";n+='<li><a><i class="'+i+'"></i><div class="'+r+'" data-path="'+e.path+'">'+t+"</div></a></li>"}),n+="</ul>",$("#fileBrowser").append(n),utils.doNiceScroll(".file-list"),$(".hdfs-folder").dblclick(function(){var e=$(this)[0].dataset.path;$("#searchInput").val(e),getFileList(e)}),$(".hdfs-folder, .hdfs-file").click(function(){$(this).parents("li").toggleClass("li-selected").siblings().removeClass("li-selected");var e=$(this)[0].dataset.path;$("#searchInput").val(e)})},errorHandler=function(e){toastr.info(e,"ajax error",utils.toastrConfig)},scheduleField=function(e,t,n){var i=$("<select/>",{class:"form-control",id:t.key}),r=utils.getValue(t,n).split(";").shift();["once","daily","weekly","monthly","cron"].forEach(function(e){i.append($("<option/>",{selected:r===e}).html(e))}),initSchedule(e,t,n,i);var o=generateRow(e,t,i);return setTimeout(function(){i.change()},0),o},initSchedule=function(e,t,n,i){i.on({change:function(){$(".schedule-options").remove();var r=utils.getValue(t,n).split(";");switch(i.val()){case"once":return initOnceOption(e,r,t,n);case"daily":return initDailyOption(e,r);case"weekly":return initWeeklyOption(e,r);case"monthly":return initMonthlyOption(e,r);case"cron":return initCronOption(e,r,t,n)}},blur:function(){scheduleApplyHandler(t,n)}}),$("#properties").on("blur",".schedule-val",function(){scheduleApplyHandler(t,n)})},scheduleApplyHandler=function(e,t){var n=[$("#"+e.key).val()],r=Array.from($(".schedule-val"));for(i=0,len=r.length;i<len;i++){var o=r[i];if(""===$(o).val()){var a=o.dataset.type;"datetime"===a?$(o).val((new Date).Format("yyyy-MM-dd hh:mm")):"time"===a?$(o).val((new Date).Format("hh:mm")):"cron"===a?$(o).val("0 0 0 * * ?"):$(o).val("1")}}var s=r.map(function(e){return $(e).val()}),l=n.concat(s).join(";");l!==t[e.key]&&(processManager.methodProxy.getMethod("setSavable")(!0),t[e.key]=l,valueChangeEvent(e.needRepaint))},initOnceOption=function(e,t,n,i){var r=$("<label/>",{class:"control-label",style:"text-align:left;"}).html("start time"),o=$("<input/>",{class:"form-control schedule-val","data-type":"datetime"}),a=$("<div/>").append(o),s=$("<div/>",{class:"form-group form-group-sm schedule-options"}).append(r).append(a),l="once"===t[0]?t[1]:(new Date).Format("yyyy-MM-dd hh:mm");o.val(l),e.after(s),o.datetimepicker({showOtherMonths:!0,selectOtherMonths:!0,changeMonth:!1,changeYear:!1,dateFormat:"yy-mm-dd",timeInput:!0,onSelect:function(){scheduleApplyHandler(n,i)}})},initDailyOption=function(e,t){var n="daily"===t[0]?t[1]:"1",i="daily"===t[0]?t[2]:(new Date).Format("hh:mm"),r='<div class="form-group form-group-sm schedule-options"><label class="control-label" style="text-align:left;">every</label><div><input class="form-control schedule-val" type="number" min=1 value='+n+"></div></div>",o='<div class="form-group form-group-sm schedule-options"><label class="control-label" style="text-align:left;">start time</label><div><input class="form-control schedule-val" data-type="time" type="time" value='+i+"></div></div>";e.after(o).after(r)},initWeeklyOption=function(e,t){var n="weekly"===t[0]?t[1]:"",i="weekly"===t[0]?t[2]:(new Date).Format("hh:mm"),r=$("<label/>",{class:"control-label",style:"text-align:left;"}).html("day"),o=$("<select/>",{class:"form-control schedule-val"}),a=$("<div/>").append(o),s=$("<div/>",{class:"form-group form-group-sm schedule-options"}).append(r).append(a);["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].forEach(function(e,t){o.append($("<option/>",{value:t,selected:n==t}).html(e))});var l='<div class="form-group form-group-sm schedule-options"><label class="control-label" style="text-align:left;">start time</label><div><input class="form-control schedule-val" data-type="time" type="time" value='+i+"></div></div>";e.after(l).after(s)},initMonthlyOption=function(e,t){var n="monthly"===t[0]?t[1]:"1",i="monthly"===t[0]?t[2]:(new Date).Format("hh:mm"),r='<div class="form-group form-group-sm schedule-options"><label class="control-label" style="text-align:left;">day</label><div><input class="form-control schedule-val" type="number" min=1 max=31 value='+n+"></div></div>",o='<div class="form-group form-group-sm schedule-options"><label class="control-label" style="text-align:left;">start time</label><div><input class="form-control schedule-val" data-type="time" type="time" value='+i+"></div></div>";e.after(o).after(r)},initCronOption=function(e,t,n,i){var r="cron"===t[0]?t[1]:"0 0 0 * * ?";r=r||"0 0 0 * * ?";var o='<div class="form-group form-group-sm schedule-options"><label class="control-label" style="text-align:left;">'+$.i18n.prop("CRON_expression_cron")+'：</label><input id="cron-input" class="schedule-val" data-type="cron" value="'+r+'" readonly="readonly" style="background:transparent;border:none"><button class="btn btn-primary opCronTable" style="width: 100%;">Edit</button></div>';e.after(o),$(document).off("click",".opCronTable"),$(document).on("click",".opCronTable",function(){opCronTable(n,i,$("#cron-input").val())})},textField=function(e,t,n,i,r){var o=$("<textarea/>",{class:"form-control need-scroll",rows:8,id:t.key});o.val(utils.getValue(t,n)||""),t.isRequired&&""===o.val()&&o.addClass("invalid");var a=function(){t.isRequired&&""===o.val()?o.addClass("invalid"):o.removeClass("invalid");var i=o.val()||"";i!==n[t.key]&&modifyConfirm(e,o,t,n,i,null,null,r)};return o.on("blur",a),generateRow(e,t,o)},passwordField=function(e,t,n,i,r){return stringField(e,t,n,i,r)},longField=function(e,t,n,i,r){return intField(e,t,n,i,r)},doubleField=function(e,t,n,i,r){return intField(e,t,n,i,r)},isMedium=function(e){return e.value&&e.value.status&&"medium"===e.value.status.type},isSuccess=function(e){return e.value&&e.value.status&&("success"===e.value.status.type||getIteration(e)>0)},isWaiting=function(e){return e.value&&e.value.status&&"waiting"===e.value.status.type},isRunning=function(e){return e.value&&e.value.status&&"running"===e.value.status.type},getIteration=function(e){if(e.value.iterations){var t=e.value.iterations.split(";")[0],n=t?parseInt(t):0;return e.value.status&&(n="running"===e.value.status.type?n-1:n),Math.max(n,0)}},modifyConfirm=function(e,t,n,i,r,o,a,s){if(e){var o=o||getModifyCallBack(e,t,n,i,r,s),l=graph.getSelectionCell();if(!l)return o(n,i,r),void processManager.methodProxy.getMethod("setSavable")(!0);if(isMedium(l)||isSuccess(l)||isWaiting(l)||l.isEdge()){var c=getChangeNum(a,s);c.canModify?modifyConfirmDialog(t,n,i,r,o,c,a,s):resetConfirmDialog(t,n,i,a)}else isRunning(l)?resetConfirmDialog(t,n,i,a):(o(n,i,r),processManager.methodProxy.getMethod("setSavable")(!0))}},resetConfirmDialog=function(e,t,n,i){var r=$.i18n.prop("ict_oneminer_dialog_modify_tip"),o=new utils.Dialog(400,200,r);o.buttons=o.buttons.slice(0,1),o.setConfirmHandler(function(){i||resetData(e,t,n),$(this).dialog("close")}),$("<div></div>").dialog(o).dialog("open")},getModifyCallBack=function(e,t,n,i,r,o){return e?function(e,t,n){t[e.key]=n,valueChangeEvent(e.needRepaint,o)}:function(e,t,n){t[e.key]=n}},resetData=function(e,t,n){if("boolean"===t.type)e.attr("checked",n[t.key]);else if("sparktable"===t.type){var i=n[t.key].split(".");e.val("SELECT"===e[0].nodeName?i[0]:i[1])}else if("partitionInfo"===t.type){var r=JSON.parse(n[t.key]),i=r.tableName.split(".")[0],o=r.tableName.split(".")[1],a=r.columns||[];if("INPUT"===e.nodeName){var s=a.filter(function(t){return t.columnName===$(e).prev().text()})[0].columnValue;$(e).val(s)}else e.val("SELECT"===e[0].nodeName?i:o)}else if("conversioncategory"===t.type){var l=n[t.key],c=l.indexOf(".")>-1;if(c){var u=!!$(e).parent().find(".accuracy").length;if(u)return $(e).parent().find(".accuracy").val(l.split(".")[1]);var d=$("<select class='form-control accuracy'/>");constants.TIME_ACCURACY.forEach(function(e){d.append($("<option/>",{value:e,selected:e===l.split(".")[1]}).html(e))}),e.after(d),d.parent().css({display:"flex",width:"100%"}),d.on("change",function(){e.trigger("change")})}e.val(l.split(".")[0])}else e&&e.val(n[t.key])},modifyConfirmDialog=function(e,t,n,i,r,o,a,s,l){var c=getConfirmMessage(o);if(c){var u=new utils.Dialog(400,200,c);u.setConfirmHandler(function(){confirmModify(t,n,i,r,a,s),l&&http.post(utils.genApiUrl("task/changeId"),{processName:processManager.getProcessName()}),$(this).dialog("close")}),u.setCancelHandler(function(){a||resetData(e,t,n),$(this).dialog("close")}),$("<div></div>").dialog(u).dialog("open")}else confirmModify(t,n,i,r,a,s)},getConfirmMessage=function(e){return e?"zaip"===e?$.i18n.prop("ict_oneminer_dialog_continue_confirm__zaip_all"):e.time>=constants.OP_CHANGE_LIMIT_TIME?$.i18n.prop("ict_oneminer_dialog_continue_confirm_time"):e.count>=constants.OP_CHANGE_LIMIT_NUM?$.i18n.prop("ict_oneminer_dialog_continue_confirm").replace("*",e.count):void 0:$.i18n.prop("ict_oneminer_dialog_continue_confirm_all")},confirmModify=function(e,t,n,i,r,o,a){if(processManager.isRunning()){var s={processName:processManager.getProcessName(),processInfo:JSON.stringify(processManager.getProcessInfo()),operatorName:o||r&&r.operatorName};a&&http.post(utils.genApiUrl("task/changeId"),{processName:processManager.getProcessName()}),http.post(utils.genApiUrl("process/modifyOperator"),s)}i(e,t,n),processManager.methodProxy.getMethod("setSavable")(!0)},getChangeNum=function(e,t){var n=processManager.getModifiedOperators()&&processManager.getModifiedOperators().split(",")||[],i=e&&e.operatorName||t;_.contains(n,i)||n.push(i);var r={processName:processManager.getProcessName(),processInfo:JSON.stringify(processManager.getProcessInfo()),modifiedOperators:e&&e.execAll?"":n.join(),owner:processManager.getProcessOwner()};return utils.getDataFromServer(r,utils.genApiUrl("process/relatedOperatorCount"))},clearZaipTrainCache=function(){var e=processManager.getProcessInfo(),t=e.params.zaip_id,n=processManager.getProcessName();(e&&e.operators).forEach(function(e){if(processManager.getOperatorAsCell(graph,e.name).value.operatorExecType==constants.ZAIPENTRANCE){var i=t+n+e.name;processManager.methodProxy.getMethod("clearCacheTrain")(i)}})},zaipIdChangeDialog=function(e,t,n,i){var r=new utils.Dialog(400,200,$.i18n.prop("ict_oneminer_dialog_continue_confirm__zaip_all"));r.setConfirmHandler(function(){confirmModify(t,n,i,function(e,t,n){processManager.methodProxy.getMethod("setSavable")(!0),t[e.key]=n,clearZaipTrainCache()},null,getZaipTopOperators(),!0),$(this).dialog("close")}),r.setCancelHandler(function(){e.val(n[t.key]),$(this).dialog("close")}),$("<div></div>").dialog(r).dialog("open")},isZaipSingelRunning=function(e){var t=processManager.getOperatorAsCell(graph,e);if(!isRunning(t)||!isWaiting(t)){if(t.value.operatorExecType==constants.ZAIPENTRANCE){var n=t.value.runStatus;return n.QUEUED||n.RUNNING}if(t.value.operatorExecType==constants.ZAIPPREDICTION){return utils.doGet(utils.genApiUrl("task/list?processName="+processManager.getProcessName()+"&opName="+e)).data.some(function(e){return"QUEUED"===e.status||"RUNNING"===e.status})}}return!1},isZaipRunning=function(){for(var e=processManager.getProcessInfo(),t=e.operators,n=[constants.ZAIPDATA,constants.ZAIPENTRANCE,constants.ZAIPPREDICTION],i=0;i<t.length;i++){var r=processManager.getOperatorAsCell(graph,t[i].name);if(_.contains(n,r.value.operatorExecType)&&isZaipSingelRunning(t[i].name))return!0}return!1},conversioncategoryField=function(e,t,n,i,r){var o=$("<select class='form-control' id="+t.key+"><select>");if(t.categories){var a=utils.getValue(t,n);(t.categories||[]).forEach(function(e){o.append($("<option/>",{selected:e===a.split(".")[0]}).html(e))}),a.indexOf(".")>-1&&setTimeout(function(){var e=$("<select class='form-control accuracy'/>");constants.TIME_ACCURACY.forEach(function(t){e.append($("<option/>",{value:t,selected:t===a.split(".")[1]}).html(t))}),o.after(e),e.parent().css({display:"flex",width:"100%"}),e.on("change",function(){o.trigger("change")})},0)}var s=function(){conversionHangler(t,this);var i=o.val()||"";$(this).next().length&&(i=o.val()+"."+$(this).next().val()),i!==n[t.key]&&modifyConfirm(e,o,t,n,i,null,null,r)};return o.on("change",s),setTimeout(function(){(o.parent("td").prev().find("select").length?o.parent("td").prev().find("select"):o.parents(".form-group-sm").prev().find("select")).on("change",function(){isRunning(i)||o.trigger("change")})},0),generateRow(e,t,o)},conversionHangler=function(e,t){var n,i;e.isSubSet?(n=$(t).parent("td").prev().find("select"),i=$(t).parent("td")):(n=$(t).parents(".form-group-sm").prev().find("select"),i=$(t).parent());var r=Array.from(n.children()),o=r.filter(function(e){return e.value===n.val()})[0];if("datetime"===(o&&o.dataset.type)&&"integer"===t.value){if($(t).next().length)return;var a=$("<select class='form-control accuracy'/>");constants.TIME_ACCURACY.forEach(function(e){a.append($("<option/>",{value:e}).html(e))}),i.css({display:"flex",width:"100%"}).append(a),a.on("change",function(){$(t).trigger("change")})}else i.find(".accuracy").remove()},initTableInput=function(e,t,n,i){e.val(utils.getValue(t,n)),t.isRequired&&""===e.val()&&e.addClass("invalid"),e.on("keypress",function(t){13!==t.keyCode||mx.mxEvent.isShiftDown(t)||e.blur()}),configAutoComplete(e,t,n,i);var r=function(r){t.isRequired&&""===e.val()?e.addClass("invalid"):e.removeClass("invalid");var o=e.val()||"";o!==n[t.key]&&modifyConfirm({},e,t,n,o,null,null,i)};e.on("blur",r)},configAutoComplete=function(e,t,n,i){e.autocomplete({minLength:0,source:function(e,n){for(var i=new RegExp($.ui.autocomplete.escapeRegex(e.term),"i"),r=t.categories,o=[],a=0;a<r.length;a++){var s=r[a];if(!s||e.term&&!i.test(s)||o.push({label:s,value:s}),o.length>100){o.push({label:$.i18n.prop("ict_oneminer_tip_more_items"),value:"maxRepSizeReached"});break}}n(o)},select:function(r,o){if("maxRepSizeReached"==o.item.value)return!1;var a=o.item.value;modifyConfirm({},e,t,n,a,null,null,i)},focus:function(e,t){if("maxRepSizeReached"==t.item.value)return!1}}).click(function(){$(this).autocomplete("search",""),utils.doNiceScroll($(".form-group .ui-widget-content"))})},getTypeByValue=function(e,t){if(e.categoriyList){var n=e.categoriyList.filter(function(e){return e.name===t});return n&&n[0]&&n[0].type}},listField=function(e,t,n,i,r){var o=$("<button id="+t.key+' class="btn btn-primary form-control">Edit List</button>');o.on("click",function(){var e=new ListDialog(700,500,processManager,{paramType:t,values:n,cell:i,modifyConfirm:modifyConfirm,handleParam:handleParam,currentOperator:r});e.registerValidateRules({key:function(e){return!0}}),e.show()}),generateRow(e,t,o)},sparktableField=function(e,t,n,i,r){t.categories=utils.getDataFromServer({connectId:processManager.getCurrentConnectId()},utils.genApiUrl("datasource/sparkMultiDBTable/list"));var o=t.categories.map(function(e){return e.dataBaseName}),a=utils.getValue(t,n);a.indexOf(".")>-1?(schema=a.split(".")[0],table=a.split(".")[1]):(schema=t.categories[0].dataBaseName,table=utils.getValue(t,n)),o.some(function(e){return e===schema})||(schema=""),n[t.key]=schema+"."+table;var s=$("<select/>",{class:"form-control",id:t.key});o.forEach(function(e){s.append($("<option/>",{value:e}).html(e))}),setTimeout(function(){s.val(schema)},0),s.on("change",function(){var i=this.value,o=this.value+".";modifyConfirm(e,s,t,n,o,function(t,n,o){n[t.key]=o,createTableParam(e,t,n,i,"",r),valueChangeEvent(t.needRepaint,r)},null,r)}),setTimeout(function(){createTableParam(e,t,n,schema,table,r)},0),generateRow(e,t,s)},createTableParam=function(e,t,n,i,r,o){$(".schemaTables").remove();var a=t.categories.filter(function(e){return e.dataBaseName===i})[0],s=a&&a.tables||[];n[t.key]=i+"."+r;var l=$('<div class="ui-front form-group form-group-sm schemaTables">\n                            <label class="control-label" style="text-align:left" title="This parameter defines where table locates">table name</label>\n                            <input class="form-control" />\n                        </div>'),c=l.find("input");c.val(r),t.isRequired&&""===c.val()&&c.addClass("invalid");var u=function(e){t.isRequired&&""===c.val()?c.addClass("invalid"):c.removeClass("invalid");var i=n[t.key].split(".")[0]+"."+c.val();i!==n[t.key]&&modifyConfirm({},c,t,n,i,null,null,o)};c.on({keypress:function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||this.blur()},blur:u}),configSchemaComplete(e,c,t,n,s,o),e.after(l)},configSchemaComplete=function(e,t,n,i,r,o){t.autocomplete({minLength:0,source:function(e,t){for(var n=new RegExp($.ui.autocomplete.escapeRegex(e.term),"i"),i=r,o=[],a=0;a<i.length;a++){var s=i[a];if(!s||e.term&&!n.test(s)||o.push({label:s,value:s}),o.length>100){o.push({label:$.i18n.prop("ict_oneminer_tip_more_items"),value:"maxRepSizeReached"});break}}t(o)},select:function(r,a){if("maxRepSizeReached"==a.item.value)return!1;var s=i[n.key].split(".")[0]+"."+a.item.value;modifyConfirm(e,t,n,i,s,null,null,o)},focus:function(e,t){if("maxRepSizeReached"==t.item.value)return!1}}).click(function(){$(this).autocomplete("search",""),utils.doNiceScroll($(".form-group .ui-widget-content"))})},partitionInfoField=function(e,t,n,i,r){t.categories=utils.getDataFromServer({connectId:processManager.getCurrentConnectId()},utils.genApiUrl("datasource/sparkMultiDBTable/list"));var o=t.categories.map(function(e){return e.dataBaseName}),a=JSON.parse(utils.getValue(t,n)||"[]");a.tableName&&a.tableName.indexOf(".")>-1?(schema=a.tableName.split(".")[0],table=a.tableName.split(".")[1]):(schema=t.categories[0].dataBaseName,table=a.tableName||""),n[t.key]=JSON.stringify({tableName:schema+"."+table,columns:a.columns||[]});var s=$("<select/>",{class:"form-control",id:t.key});o.forEach(function(e){s.append($("<option/>",{value:e,selected:e===schema}).html(e))}),s.on("change",function(){var i=this.value,o=JSON.stringify({tableName:this.value+".",columns:[]});modifyConfirm(e,s,t,n,o,function(t,n,o){n[t.key]=o,createPartitionTableParam(e,t,n,i,"",[],r),valueChangeEvent(t.needRepaint,r)},null,r)}),setTimeout(function(){var i=JSON.parse(n[t.key]).columns;createPartitionTableParam(e,t,n,schema,table,i,r),createPartitionTableColumns(e,t,n,i,r)},0),generateRow(e,t,s)},createPartitionTableParam=function(e,t,n,i,r,o,a){$(".schemaTables, .partition-column").remove();var s=t.categories.filter(function(e){return e.dataBaseName===i})[0],l=s&&s.tables||[];l.some(function(e){return e===r})||(r=""),n[t.key]=JSON.stringify({tableName:i+"."+r,columns:o});var c=$('<div class="ui-front form-group form-group-sm schemaTables">\n                            <label class="control-label" style="text-align:left" title="This parameter defines where table locates">table name</label>\n                            <input class="form-control" />\n                        </div>'),u=c.find("input");u.val(r),t.isRequired&&""===u.val()&&u.addClass("invalid");var d=function(i){t.isRequired&&""===u.val()?u.addClass("invalid"):u.removeClass("invalid");var r=$("#"+t.key).val()+"."+this.value,o=utils.getPartitionColumns(processManager.getCurrentConnectId(),constants.TABLE_TYPE,r,JSON.stringify(processManager.getProcessInfo()),processManager.getProcessName(),a),s=(o||[]).map(function(e){return{columnName:e.columnName,columnValue:""}}),l=JSON.stringify({tableName:r,columns:s});if(l!==n[t.key]){modifyConfirm(e,u,t,n,l,function(t,n,i){n[t.key]=i,createPartitionTableColumns(e,t,n,s,a),valueChangeEvent(t.needRepaint,a)},null,a)}};u.on({keypress:function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||this.blur()},blur:d}),configPartitionComplete(e,u,t,n,l,a),e.after(c)},configPartitionComplete=function(e,t,n,i,r,o){t.autocomplete({minLength:0,source:function(e,t){for(var n=new RegExp($.ui.autocomplete.escapeRegex(e.term),"i"),i=r,o=[],a=0;a<i.length;a++){var s=i[a];if(!s||e.term&&!n.test(s)||o.push({label:s,value:s}),o.length>100){o.push({label:$.i18n.prop("ict_oneminer_tip_more_items"),value:"maxRepSizeReached"});break}}t(o)},select:function(r,a){if("maxRepSizeReached"==a.item.value)return!1;var s=$("#"+n.key).val()+"."+a.item.value,l=utils.getPartitionColumns(processManager.getCurrentConnectId(),constants.TABLE_TYPE,s,JSON.stringify(processManager.getProcessInfo()),processManager.getProcessName(),o),c=(l||[]).map(function(e){return{columnName:e.columnName,columnValue:""}}),u=JSON.stringify({tableName:JSON.parse(i[n.key]).tableName.split(".")[0]+"."+a.item.value,columns:c});modifyConfirm(e,t,n,i,u,function(t,n,i){n[t.key]=i,createPartitionTableColumns(e,t,n,c,o),valueChangeEvent(t.needRepaint,o)},null,o)},focus:function(e,t){if("maxRepSizeReached"==t.item.value)return!1}}).click(function(){$(this).autocomplete("search",""),utils.doNiceScroll($(".form-group .ui-widget-content"))})},createPartitionTableColumns=function(e,t,n,i,r){$(".partition-column").remove(),i.forEach(function(t){var n='<div class="form-group form-group-sm partition-column">\n                            <label class="control-label" style="text-align:left">'+(t.columnName||"")+'</label>\n                            <input class="form-control" value="'+(t.columnValue||"")+'">\n                         </div>';e.next().after($(n))}),$("#properties").off("blur keypress",".partition-column input"),$("#properties").on("blur",".partition-column input",function(){var i=JSON.stringify(getPartitionData(t));modifyConfirm(e,this,t,n,i,function(e,t,n){t[e.key]=n,valueChangeEvent(e.needRepaint,r)},null,r)}).on("keypress",".partition-column input",function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||$(this).blur()})},getPartitionData=function(e){return{tableName:$("#"+e.key).val()+"."+$(".schemaTables").find("input").val(),columns:Array.from($(".partition-column")).reverse().map(function(e){return{columnName:$(e).find("label").text(),columnValue:$(e).find("input").val()}})}},renamelistField=function(e,t,n,i,r){var o=$("<button id="+t.key+' class="btn btn-primary form-control">Rename</button>');return o.on("click",function(){openColumnsDialog(e,t,n,i,r)}),generateRow(e,t,o)},openColumnsDialog=function(e,t,n,i,r){var o=new utils.Dialog(700,500);o.title="Rename",o.open=function(){$(this).append('<table class="table table-bordered dataTable header-fixed">\n                            <thead>\n                                <tr><th>column name</th><th>new name</th></tr>\n                            </thead>\n                            <tbody/>\n                        </table>'),initColumns($(this),t,n,i)},o.buttons=[{text:"Add",click:function(){addColumn($(this),t,i)}},{text:"Remove",click:function(){removeColumn($(this));var e=Array.from($(this).find("tbody select"));checkValidity(e,columnNameValidate)}},{text:"Apply",click:function(){applyColumns($(this),e,t,n,r)}},{text:"Cancel",click:function(){$(this).dialog("close")}}],$('<div class="column-dialog"></div>').dialog(o).dialog("open")},calculateCounts=function(e){var t={};return e.forEach(function(e){t[e]=t[e]&&++t[e]||1}),t},isValidInput=function(e,t,n){var i=e.value,r=n(i),o=1===t[i];return"INPUT"===e.nodeName?i&&o&&r:i&&o},checkValidity=function(e,t){var n=e.map(function(e){return e.value}),i=calculateCounts(n);e.forEach(function(e){isValidInput(e,i,t)?$(e).removeClass("invalid-variable"):$(e).addClass("invalid-variable")})},columnNameValidate=function(e){return/(^_([a-zA-Z0-9]_?)*$)|(^[a-zA-Z](_?[a-zA-Z0-9])*_?$)/.test(e)},initColumns=function(e,t,n,i){var r=e.find("table tbody");r.on("click","tr",function(){$(this).addClass("active").siblings().removeClass("active")}).on("input","input",function(){var e=Array.from($(r).find("input"));checkValidity(e,columnNameValidate)}).on("change","select",function(){var e=Array.from($(r).find("select"));checkValidity(e,columnNameValidate)});var o=utils.getValue(t,n);if(o&&"[]"!==o)JSON.parse(o).forEach(function(e){var n,o=(n={},n[t.keyType.key]=e[0],n[t.valueType.key]=e[1],n),a=handleParam(null,t.keyType,o,i),s=handleParam(null,t.valueType,o,i);r.append($("<tr/>").append($("<td/>").append(a)).append($("<td/>").append(s)))});else{handleParam(null,t.keyType,{},i);t.keyType.categories.filter(function(e){return/\s+/g.test(e.trim())}).forEach(function(e){var n=t.keyType;n.defaultValue=e;var o=t.valueType;o.defaultValue=e.replace(/\s+/g,"_");var n=handleParam(null,n,{},i),o=handleParam(null,o,{},i);r.append($("<tr/>").append($("<td/>").append(n)).append($("<td/>").append(o)))})}utils.doNiceScroll(".column-dialog")},addColumn=function(e,t,n){var i=e.find("table tbody"),r=t.keyType;r.defaultValue="";var o=t.valueType;o.defaultValue="";var r=handleParam(null,r,{},n),o=handleParam(null,o,{},n);r.addClass("invalid-variable"),o.addClass("invalid-variable"),i.append($("<tr/>").append($("<td/>").append(r)).append($("<td/>").append(o))),utils.doNiceScroll(".column-dialog")},removeColumn=function(e){var t=e.find("table tbody");(t.children("tr.active").length?t.children("tr.active"):t.children("tr").last()).remove(),utils.doNiceScroll(".column-dialog")},applyColumns=function(e,t,n,i,r){var o=$(".invalid-variable");if(o.length)return o.focus();var a=e.find("table tbody"),s=Array.from(a.children("tr")).map(function(e){return[$(e).find("select").val(),$(e).find("input").val()]}),l=JSON.stringify(s);modifyConfirm(t,null,n,i,l,null,null,r),e.dialog("close")},ProcessTypeField=function(e,t,n,i,r){for(var o=utils.getValue(t,n),a=$("<div/>",{class:"clearfix",id:t.key}),s="",l=0;l<5;l++){s+='<div class="pull-left type-circle type-params process-type-'+(l+1)+" "+(o===l+1?"cur":"")+'">\n            <div class="inner-circle"></div>\n            </div>'}return a.append(s),$(document).off("click",".type-params"),$(document).on("click",".type-params",function(){$(this).siblings(".type-params").removeClass("cur"),$(this).toggleClass("cur");var i=$(".type-params.cur")?$(".type-params.cur").index()+1:0;modifyConfirm(e,a,t,n,i,function(e,t,n){t[e.key]=n,valueChangeEvent(e.needRepaint,r)},null,r)}),generateRow(e,t,a)},selectField=function(e,t,n,i,r){var o=parseInt(utils.getValue(t,n)||1);n[t.key]=o;var a=$("<div/>",{class:"clearfix",id:t.key}),s=processManager.getProcessInfo(!0).params.zaip_id,l=utils.getZaipConfig(s).gpuNum,c=[],u=0;(function(e){if(1!=e){for(;1!=e;){if(e%2!=0)return!1;e/=2}return!0}return!0})(l)&&function handleBtnNum(){var e=Math.pow(2,u);e===l?c.push(e):(c.push(e),handleBtnNum(++u))}();var d="";return c.forEach(function(e){d+='<div class="pull-left gpu-btn '+(e===o?"cur":"")+'">'+e+"</div>"}),a.append(d),$(document).off("click",".gpu-btn"),$(document).on("click",".gpu-btn",function(){$(this).siblings(".gpu-btn").removeClass("cur"),$(this).addClass("cur");var i=$(".gpu-btn.cur").html();modifyConfirm(e,a,t,n,i,function(e,t,n){t[e.key]=n,valueChangeEvent(e.needRepaint,r)},null,r)}),generateRow(e,t,a)},that={};return that.selectionChanged=selectionChanged,that.setGraph=setGraph,that.setClusterChangeCallback=setClusterChangeCallback,that.getChangeNum=getChangeNum,that.getConfirmMessage=getConfirmMessage,that.modifyConfirm=modifyConfirm,that}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(0),__webpack_require__(5),__webpack_require__(4),__webpack_require__(6),__webpack_require__(1),__webpack_require__(29),__webpack_require__(8),__webpack_require__(3),__webpack_require__(12),__webpack_require__(9),__webpack_require__(7),__webpack_require__(44)],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function($,___1,toastr,_,utils,processManager,constants,i18n,Cookies,CodeMirror,http,cronEV){function valueChangeEvent(e){processManager.updateData(currentOperator),e&&selectionChanged(!0)}function selectionChanged(e){if(graph){document.activeElement.blur(),isSelectionChange=!e;var t=graph.getSelectionCell();dialogs.forEach(function(e){$(e).dialog("destroy")}),dialogs=[],$("#visual-properties, #visual-config").empty();var n=document.createDocumentFragment();document.createDocumentFragment();graph.container.focus();var i,r,o;if(t&&t.isVertex()&&!t.value.isPort&&"zaipBackground"!=t.value.type){if($('a[href="#visual-properties"]').html($.i18n.prop("ict_oneminer_config_param")),i=t.value.name,r=processManager.getOperatorParams(t.id),"zaipInput"===i){var a=JSON.parse(processManager.getInputcol());o=utils.getParametersInput(t.value.type,a)}else o=utils.getParameDLMters(t.value.type);isSelectionChange&&(currentOperator=i)}else i="Process: "+processManager.getProcessName(),r=processManager.getParams(),!r[clusterKey]&&Cookies.get(clusterKey)&&(r[clusterKey]=Cookies.get(clusterKey)),o=utils.getParameDLMters("root-process"),currentOperator=null,$('a[href="#visual-properties"]').html($.i18n.prop("ict_zaip_super_param"));$("#visual-param-tabs").tabs({});var s=$("<h6/>").html(i);if($(n).append(s).append("<hr/>"),t&&t.value&&!t.value.isPort&&utils.isModel(t.value.type)){if(_.isArray(o)&&!_.isEmpty(o)){var l=$("<div/>",{class:"operator-desc"});l.append($("<label/>").text($.i18n.prop("OP_DESC")));var c="";o.some(function(e){if("model info"===e.key)return c=e.defaultValue,!0}),l.append($('<div style="line-height:20px"/>').text(c)),$(n).append(l)}}else{var u=$("<div/>",{class:"form-vertical"});if($(n).append(u),_.isArray(o)&&!_.isEmpty(o)){var d=getAllDependParams(o),h=[];o.forEach(function(e){if(isVisible(e,r,h)){h.push(e.key);var n=$("<div/>",{class:"form-group form-group-sm"});"Password"===e.key&&(e.type="password"),_.contains(d,e.key)&&(e.needRepaint=!0),handleParam(n,e,r,t),u.append(n)}})}if(t&&t.value&&t.value.type){$(n).append("<hr/>");var l=getDescription(t);$(n).append(l)}}if($(n).append("<br/>"),document.getElementById("visual-properties").appendChild(n),Array.from($(".need-scroll")).forEach(function(e){utils.doNiceScroll(e)}),n=null,null,utils.doNiceScroll("#visual-properties"),processManager.getEditable())$("#noedit").remove();else{$("#visual-properties .form-vertical").append('<div id="noedit" style="position:absolute;top:0;left:0;width:100%;height:100%;"></div>')}}}function getAllDependParams(e){var t=[];return e.forEach(function(e){var n=e.conditions;_.isEmpty(n)||n.forEach(function(e){var n=e.conditionParameter;_.contains(t,n)||t.push(n)})}),t}function isVisible(e,t,n){var i=e.conditions;if(_.isEmpty(i))return!0;for(var r=0,o=i.length;r<o;r++){if(!conditionMet(i[r],t,n))return!1}return!0}function conditionMet(e,t,n){if(!_.contains(n,e.conditionParameter))return!1;var i,r,o=e.conditionType;switch(o){case"EqualType":case"NonEqualType":return i=t[e.conditionParameter],r=[],e.fulfillingOptions.forEach(function(t){t<e.possibleOptions.length&&r.push(e.possibleOptions[t])}),_.contains(r,i)===("EqualType"===o);case"EqualString":case"NonEqualString":return i=t[e.conditionParameter],r=e.conditionValue,i===r==("EqualString"===o);case"Boolean":return i=t[e.conditionParameter],r=e.conditionValue,i===r;default:return toastr.warning("unsupported condition, please contact developer"),!0}}function generateLabel(e,t,n){var i=$("<label/>",{class:"control-label",style:"text-align:left;",for:t.key,title:t.description}).html(t.label);if(t.isRequired||i.append("<span>&nbsp;(optional)<span>"),"sql"===t.type||"pythonEditWindow"===t.type){String(utils.getValue(t,n)).startsWith("@#Infomation Already Encrypted#@")||("sql"===t.type&&i.append('<i class="fa fa-pencil-square-o sql-icon" style="margin-left:15px;cursor:pointer"></i>'),"pythonEditWindow"===t.type&&i.append('<i class="fa fa-pencil-square-o python-icon" style="margin-left:15px;cursor:pointer"></i>'))}e.append(i)}function generateField(e,t){var n="";"spanCheckbox"===t[0].className&&(n="inlineCheckBox");var i=$("<div/>",{class:n});i.append(t),e.append(i)}function generateRow(e,t,n,i){if(!e)return n;"test connection"!==$(n).val()&&generateLabel(e,t,i),generateField(e,n)}function handleParam(row,paramType,values,cell){if(paramType.supportEncrypt){var isEncrypted=String(utils.getValue(paramType,values)).startsWith("@#Infomation Already Encrypted#@");if(isEncrypted)return encryptField(row,paramType,values,cell)}var type=paramType.type+"Field";return eval(type+"(row, paramType, values, cell)")}function encryptField(e,t,n,i){var r=$("<input/>",{class:"form-control",style:"background-color:#5a3e3e",disabled:!0,id:t.key});return r.val("This parameter has been encrypted."),generateRow(e,t,r,n)}function pythonEditWindowField(e,t,n){var i=$("<textarea/>",{class:"form-control need-scroll",rows:8,id:t.key});i.val(utils.getValue(t,n)||""),t.isRequired&&""===i.val()&&i.addClass("invalid"),i.on("keypress",function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||i.blur()});var r=function(){t.isRequired&&""===i.val()?i.addClass("invalid"):i.removeClass("invalid");var r=i.val()||"";r!==n[t.key]&&modifyConfirm(e,i,t,n,r)};return mx.mxClient.IS_IE?i.on("focusout",r):i.on("blur",r),generateRow(e,t,i,n)}function hdfsFilesField(e,t,n){var i=$("<div/>",{class:"ui-front input-group",style:"width:100%"}),r=$("<input/>",{class:"form-control",style:"width:61%",id:t.key}),o=$("<input/>",{type:"file",style:"display:none"}),a=$("<button/>",{class:"btn btn-primary btn-sm",style:"margin-left:5px;height:26px",text:"Select"});i.append(r).append(o).append(a),r.val(utils.getValue(t,n)||""),t.isRequired&&""===r.val()&&r.addClass("invalid");var s=function(){t.isRequired&&""===r.val()?r.addClass("invalid"):r.removeClass("invalid");var i=r.val()||"";i!==n[t.key]&&modifyConfirm(e,r,t,n,i)};return a.on("click",function(e){openFileBrowser(r)}),r.on("keypress",function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||r.blur()}),mx.mxClient.IS_IE?r.on("focusout",s):r.on("blur",s),generateRow(e,t,i)}function uploadField(e,t,n){var i=$("<div/>",{class:"ui-front input-group",style:"width:100%"}),r=$("<input/>",{class:"form-control",readonly:"readonly",style:"background: inherit;cursor: pointer;width:61%",placeholder:"select",id:t.key}),o=$("<input/>",{type:"file",style:"display:none"}),a=$("<button/>",{class:"btn btn-primary btn-sm",style:"margin-left:5px;height:26px;",disabled:!0,text:"Upload"});return i.append(r).append(o).append(a),r.val(utils.getValue(t,n)||""),r.on("click",function(){$(this).next().click()}),o.on("change",function(){var e=$(this).val().split(".").pop(),n=this.files[0].size/1024/1024;if(e&&e.toUpperCase()!==t.fileType)toastr.error($.i18n.prop("ict_oneminer_process_title_check_filetype")),$(this).val("").prev().val("");else if(n>20)toastr.error($.i18n.prop("ict_oneminer_process_title_check_filesize")),$(this).val("").prev().val("");else{var i=$(this).val().split("\\").pop();$(this).prev().val(i).blur()}$(this).next("button").attr("disabled",!this.value)}),a.on("click",function(){uploadFile($(this).prev()[0].files[0],t.targetComponentId),$(this).attr("disabled",!0).siblings().val("")}),generateRow(e,t,i)}function uploadFile(e,t){var n=new FormData;n.append("file",e,encodeURI(e.name)),n.append("connectId",processManager.getCurrentConnectId());var i=function(e){"false"!==e?(t&&$("#"+t).val(e).blur(),toastr.success($.i18n.prop("ict_oneminer_message_upload_success"),"",utils.toastrConfig)):toastr.error($.i18n.prop("ict_oneminer_message_upload_failed"))};http.upload(utils.genApiUrl("file/upload"),n,i,errorHandler,"text")}function loopConditionField(e,t,n,i){var r=$("<button/>",{class:"btn btn-primary",width:"100%",text:"Edit"});return r.on("click",function(){var e=utils.getValue(t,n);openLoopConditionDialog(i,e,n)}),generateRow(e,t,r)}function openLoopConditionDialog(e,t,n){var i=new utils.Dialog(700);i.title=$.i18n.prop("ict_oneminer_dialog_loop_title"),i.position={my:"top",at:"top"},i.setOpenHandler(function(){$(this).dialog("option","maxHeight",$(window).height()),initLoopConditionDialog(e,t,$(this)),utils.doNiceScroll(".loop-condition")}),i.setConfirmHandler(function(){var e=getColumnsInfo();n["loop-condition"]=e,processManager.updateData(currentOperator),$(this).dialog("close")}),$('<div class="loop-condition"></div>').dialog(i).dialog("open")}function initLoopConditionDialog(e,t,n){var i='<table id="loopCpndition" class="table table-bordered dataTable"><thead><tr><th>'+$.i18n.prop("ict_oneminer_dialog_loop_name")+"</th><th>"+$.i18n.prop("ict_oneminer_dialog_loop_port")+"</th><th>"+$.i18n.prop("ict_oneminer_dialog_loop_condition")+"</th></tr></thead></table>";n.append(i),initLoopColumns(e,t)}function initLoopColumns(e,t){var n=getOperators(e),i=[],r=t&&t.split("␞")||[];n.forEach(function(e,n){var o=e.value.outputs.map(function(e){return e.name}),a=r.filter(function(t){return t.split("␟")[0]===e.value.name})[0];if(t&&a){var s=a.split("␟");i[n]=[s[0],getPortsHtml(o,s[1]),'<input class="meta-input form-control" value="'+s[2]+'"></input>']}else i[n]=[e.value.name,getPortsHtml(o),'<input class="meta-input form-control"></input>']});var o=$("#loopCpndition");o.dataTable().fnClearTable(),o.dataTable().fnDestroy(),o.dataTable({autoWidth:!1,paging:!1,order:!1,info:!1,searching:!1,bLengthChange:!1,columnDefs:[{targets:[0,1,2],orderable:!1}],data:i})}function getPortsHtml(e,t){for(var n='<select  class="meta-select form-control" style="width:85%">',i=0,r=e.length;i<r;i++){var o=e[i];n+=o===t?'<option selected="selected" value='+o+">"+o+"</option>":"<option value="+o+">"+o+"</option>"}return n+="</select>"}function getOperators(e){var t=[];return(e.children||[]).forEach(function(e){e.value&&(e.value.isGroup?t=t.concat(getOperators(e)):t.push(e))}),t}function getColumnsInfo(){var e="",t=$("#loopCpndition").find("tbody > tr");return t.each(function(n,i){var r=$(this).find("td").eq(0).text(),o=$(this).find("td").eq(1).find("select").val(),a=$(this).find("td").eq(2).find("input").val();e+=r+"␟"+o+"␟"+a,e+=n===t.length-1?"":"␞"}),e}function mappingField(e,t,n,i){var r=$("<div/>",{class:"ui-front input-group col-sm-12"}),o=$("<input/>",{class:"form-control",type:"text",width:"85%",id:t.key}),a=$("<a/>",{class:"edit-meta",text:"Edit"});r.append(o),r.append(a),o.val(utils.getValue(t,n)||""),t.isRequired&&""===o.val()&&o.addClass("invalid");var s=function(){t.isRequired&&""===o.val()?o.addClass("invalid"):o.removeClass("invalid");var i=o.val()||"";i!==n[t.key]&&modifyConfirm(e,o,t,n,i)};return o.on("keypress",function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||o.blur()}),a.on("click",function(){var e="";i.children&&i.children[0].value&&i.children[0].value.data&&(e=i.children[0].value.data.result),openEditDialog(e)}),mx.mxClient.IS_IE?o.on("focusout",s):o.on("blur",s),generateRow(e,t,r)}function openEditDialog(e){var t=new utils.Dialog(900);t.title=$.i18n.prop("ict_oneminer_dialog_metadata_metadata"),t.position={my:"top",at:"top"},t.setOpenHandler(function(){$(this).dialog("option","maxHeight",$(window).height()),utils.doNiceScroll(".edit-div"),initEditDialog(e,$(this))}),t.setConfirmHandler(function(){var e=getMetaColInfo();"{}"!=JSON.stringify(e)&&($(this).dialog("close"),$("#mapping").val(JSON.stringify(e)).blur())}),$('<div class="edit-div"></div>').dialog(t).dialog("open")}function initEditDialog(e,t){var n='<table id="metaTable" class="table table-bordered dataTable"><thead><tr><th id="table-operator-name">'+$.i18n.prop("ict_oneminer_dialog_metadata_name")+'</th><th id="table-operator-port">'+$.i18n.prop("ict_oneminer_dialog_metadata_port")+'</th><th id="table-operator-type">'+$.i18n.prop("ict_oneminer_dialog_metadata_type")+'</th><th id="table-operator-options">'+$.i18n.prop("ict_oneminer_dialog_metadata_options")+"</th></tr></thead></table>";t.append(n),initMetaColumns(e)}function initMetaColumns(e){var t=e.split(","),n=$("#mapping").val(),i=n?JSON.parse(n):void 0,r=[];t.forEach(function(e,t){i&&i.hasOwnProperty(e)?r[t]=['<span class="wordsFlow" title="'+e+'">'+e+"</span>",'<select  class="meta-select form-control">'+genSelectHtml(i[e].port,"InputPort0,OutputPort0")+"</select>",'<select  class="meta-select form-control type-select">'+genSelectHtml(i[e].type,"Numeric,Array,Categorical,Image")+"</select>",genMetaColOptionsHtml(i[e])]:r[t]=['<span class="wordsFlow" title="'+e+'">'+e+"</span>",'<select  class="meta-select form-control"><option value="InputPort0">InputPort0</option><option value="OutputPort0">OutputPort0</option></select>','<select  class="meta-select form-control type-select"><option value="Numeric">Numeric</option><option value="Array">Array</option><option value="Categorical">Categorical</option><option value="Image">Image</option></select>',""]});var o=$("#metaTable");o.dataTable().fnClearTable(),o.dataTable().fnDestroy(),o.dataTable({autoWidth:!1,paging:!1,ordering:!0,info:!1,searching:!1,bLengthChange:!1,columnDefs:[{targets:[1,2,3],orderable:!1},{targets:[3],width:"35%"}],data:r}),utils.doNiceScroll(".meta-option"),$(".type-select").change(function(){typeChangeHandler($(this))}),$(".categorical-select").change(function(){onCategoricalChange($(this))})}function typeChangeHandler(e){var t=e.parent().next();switch(e.val()){case"Categorical":var n='<div class="meta-option"><div class="meta_div select_input_div"><select class="form-control meta-select categorical-select"><option value="depth">depth</option><option value="vocabulary">vocabulary</option></select><input type="text" class="meta-input form-control" placeholder="'+$.i18n.prop("ict_oneminer_dialog_metadata_Categorical_Class")+'" style="width:50% !important"></div></div>';$(t).html(n);break;case"Image":var i='<div class="meta-option"><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_shear_range")+'">shear_range</label><input type="text" class="meta-input form-control"></div><div class="meta_div select_div"><label data-type="bool" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_vertical_flip")+'">vertical_flip</label><select class="form-control meta-select"><option value="true">true</option><option value="false">false</option></select></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_height")+'">height</label><input type="text" class="meta-input form-control"></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_scaling")+'">scaling</label><input type="text" class="meta-input form-control"></div><div class="meta_div select_div"><label data-type="bool" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_augmentation")+'">augmentation</label><select class="form-control meta-select"><option value="true">true</option><option value="false">false</option></select></div><div class="meta_div select_div"><label data-type="bool" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_resize")+'">resize</label><select class="form-control meta-select"><option value="true">true</option><option value="false">false</option></select></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_width_shift_range")+'">width_shift_range</label><input type="text" class="meta-input form-control"></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_width")+'">width</label><input type="text" class="meta-input form-control"></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_height_shift_range")+'">height_shift_range</label><input type="text" class="meta-input form-control"></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_rotation_range")+'">rotation_range</label><input type="text" class="meta-input form-control"></div><div class="meta_div select_div"><label data-type="bool" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_normalization")+'">normalization</label><select class="form-control meta-select"><option value="true">true</option><option value="false">false</option></select></div><div class="meta_div select_div"><label data-type="bool" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_horizontal_flip")+'">horizontal_flip</label><select class="form-control meta-select"><option value="true">true</option><option value="false">false</option></select></div></div>';$(t).html(i);break;default:$(t).html("")}utils.doNiceScroll(".meta-option"),$(".categorical-select").change(function(){onCategoricalChange($(this))})}function genMetaColOptionsHtml(e){if(!e)return"";var t="";switch(e.type){case"Image":t='<div class="meta-option"><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_shear_range")+'">shear_range</label><input type="text" class="meta-input form-control" value="'+e.options.shear_range+'"></div><div class="meta_div select_div"><label data-type="bool" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_vertical_flip")+'">vertical_flip</label><select class="form-control meta-select">'+genSelectHtml(e.options.vertical_flip)+'</select></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_height")+'">height</label><input type="text" class="meta-input form-control" value="'+e.options.height+'"></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_scaling")+'">scaling</label><input type="text" class="meta-input form-control" value="'+e.options.scaling+'"></div><div class="meta_div select_div"><label data-type="bool" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_augmentation")+'">augmentation</label><select class="form-control meta-select">'+genSelectHtml(e.options.augmentation)+'</select></div><div class="meta_div select_div"><label data-type="bool" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_resize")+'">resize</label><select class="form-control meta-select">'+genSelectHtml(e.options.resize)+'</select></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_width_shift_range")+'">width_shift_range</label><input type="text" class="meta-input form-control" value="'+e.options.width_shift_range+'"></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_width")+'">width</label><input type="text" class="meta-input form-control" value="'+e.options.width+'"></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_height_shift_range")+'">height_shift_range</label><input type="text" class="meta-input form-control" value="'+e.options.height_shift_range+'"></div><div class="meta_div input_div"><label data-type="int" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_rotation_range")+'">rotation_range</label><input type="text" class="meta-input form-control" value="'+e.options.rotation_range+'"></div><div class="meta_div select_div"><label data-type="bool" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_normalization")+'">normalization</label><select class="form-control meta-select">'+genSelectHtml(e.options.normalization)+'</select></div><div class="meta_div select_div"><label data-type="bool" title="'+$.i18n.prop("ict_oneminer_dialog_metadata_Image_horizontal_flip")+'">horizontal_flip</label><select class="form-control meta-select">'+genSelectHtml(e.options.horizontal_flip)+"</select></div></div>";break;case"Categorical":var n=e.options.hasOwnProperty("vocabulary")?"vocabulary":"depth",i="vocabulary"==n?$.i18n.prop("ict_oneminer_dialog_metadata_Categorical_Vocabulary"):$.i18n.prop("ict_oneminer_dialog_metadata_Categorical_Class");t='<div class="meta-option"><div class="meta_div select_input_div"><select class="form-control meta-select categorical-select">'+genSelectHtml(n,"depth,vocabulary")+'</select><input type="text" class="meta-input form-control" placeholder="'+i+'" style="width:50% !important" value="'+e.options[n]+'"></div></div>'}return t}function genSelectHtml(e,t){var n="";return(t||"true,false").split(",").forEach(function(t,i){e.toString()==t?n+='<option selected="selected" value="'+t+'">'+t+"</option>":n+='<option value="'+t+'">'+t+"</option>"}),n}function onCategoricalChange(e){var t=$(e).val();$(e).next().val(""),"vocabulary"===t?$(e).next().attr("placeholder",$.i18n.prop("ict_oneminer_dialog_metadata_Categorical_Vocabulary")):$(e).next().attr("placeholder",$.i18n.prop("ict_oneminer_dialog_metadata_Categorical_Class"))}function getMetaColInfo(){var e={},t=!0;return $("#metaTable").find("tbody > tr").each(function(){var n=$(this).find("td").eq(0).find("span").text();e[n]={type:$(this).find("td").eq(2).find("select").val(),port:$(this).find("td").eq(1).find("select").val(),options:{}};var i={};$(this).find("td").eq(3).find(".meta-option > .meta_div").each(function(){switch($(this).attr("class")){case"meta_div select_div":i[$(this).find("label").text()]=transferData($(this).find("select").val(),$(this).find("label").data("type"));break;case"meta_div input_div":var e=$(this).find("label").text(),n=$(this).find("input").val();if(""===n)return $(this).find("input").focus(),t=!1,!1;i[e]=transferData(n,$(this).find("label").data("type"));break;case"meta_div select_input_div":var r=$(this).find("select").val(),o=$(this).find("input").val();if(""===o)return $(this).find("input").focus(),t=!1,!1;i[r]="vocabulary"===r?o.split(","):transferData(o,"int")}}),"{}"!=JSON.stringify(i)?e[n].options=i:delete e[n].options}),t?e:{}}function transferData(e,t){var n=e;switch(t){case"int":n=parseInt(e);break;case"bool":n="true"==e;break;case"float":n=parseFloat(e)}return n}function multilinePlaintextField(e,t,n){var i=$("<textarea/>",{class:"form-control",rows:15,readonly:"readonly",style:"background: inherit",id:t.key});return i.val(utils.getValue(t,n)||""),generateRow(e,t,i)}function sqlField(e,t,n){var i=$("<textarea/>",{class:"form-control need-scroll",rows:8,id:t.key});i.val(utils.getValue(t,n)||""),t.isRequired&&""===i.val()&&i.addClass("invalid");var r=function(){t.isRequired&&""===i.val()?i.addClass("invalid"):i.removeClass("invalid");var r=i.val()||"";r!==n[t.key]&&modifyConfirm(e,i,t,n,r)};return i.on("keypress",function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||i.blur()}),mx.mxClient.IS_IE?i.on("focusout",r):i.on("blur",r),generateRow(e,t,i,n)}function inputCellChange(){var e=$("#cron .cron-table-inputCell input");e.on("input",function(){var t=[];Array.from(e).forEach(function(n,i){t.push(e.eq(i).val())}),$("#cronValue").val(t.join(" ").trim())}),e.on("blur",function(){cronValidateHandler()})}function cronValueChange(){var e=$("#cronValue"),t=$("#cron .cron-table-inputCell input");e.on("input",function(){var n=e.val().split(" ");n.forEach(function(e,i){t.eq(i).val(n[i])})}),e.on("blur",function(){cronValidateHandler()})}function addCronInputChangeListener(){inputCellChange(),cronValueChange(),cronParsing(),$("#cronValue").trigger("input")}function cronParsing(){$("#analysis").on("click",function(){if(cronValidateHandler()){var e={cronExp:$("#cronValue").val(),number:5},t=function(e){var t="";if(e&&1==e.status)for(var n=e.timeNext,i=0;i<n.length;i++)t+="<li>"+n[i]+"</li>";else t="<li>"+e.message+"</li>";var r='<div>\n                                <div class="cron-run-time">'+$.i18n.prop("CRON_expression_timeNext")+":</div>\n                                <ul>"+t+"</ul>\n                            </div>";$("#cron-msg").html(r)};http.post(utils.genApiUrl("process/parseCron"),e,t,errorHandler)}})}function opCronTable(e,t,n){var i='<div id="cron">\n                        <table>\n                            <tbody>\n                                <tr class="cron-table-title">\n                                    <td></td>\n                                    <td align="center">'+$.i18n.prop("CRON_Second")+'<span>*</span></td>\n                                    <td align="center">'+$.i18n.prop("CRON_Minutes")+'<span>*</span></td>\n                                    <td align="center">'+$.i18n.prop("CRON_Hour")+'<span>*</span></td>\n                                    <td align="center">'+$.i18n.prop("CRON_Day")+'<span>*</span></td>\n                                    <td align="center">'+$.i18n.prop("CRON_Month")+'<span>*</span></td>\n                                    <td align="center">'+$.i18n.prop("CRON_Week")+'<span>*</span></td>\n                                    <td align="center">'+$.i18n.prop("CRON_Year")+'</td>\n                                </tr>\n                                <tr class="cron-table-inputCell">\n                                    <td>'+$.i18n.prop("CRON_expression")+'</td>\n                                    <td><input type="text"  class="col"></td>\n                                    <td><input type="text"  class="col"></td>\n                                    <td><input type="text"  class="col"></td>\n                                    <td><input type="text"  class="col"></td>\n                                    <td><input type="text"  class="col"></td>\n                                    <td><input type="text"  class="col"></td>\n                                    <td><input type="text"  class="col"></td>\n                                </tr>\n                                <tr>\n                                    <td>'+$.i18n.prop("CRON_expression_cron")+'</td>\n                                    <td colspan="5"><input type="text" name="v_second" style="width:100%" id="cronValue"></td>\n                                    <td colspan="2" align="center"><button id="analysis" class="btn btn-primary " style="width: 80%;">'+$.i18n.prop("CRON_expression_parsing")+'</button></td>\n                                </tr>\n                                <tr>\n                                    <td colspan="8" id="cron-msg"></td>\n                                </tr>\n                            </tbody>\n                        </table>\n                    </div>',r=new utils.Dialog(830,400);r.title=$.i18n.prop("CRON_expression_cron"),r.setOpenHandler(function(){$(this).html(i),$("#cronValue").val(n),addCronInputChangeListener()}),r.setConfirmHandler(function(){cronValidateHandler()&&($(this).dialog("close"),scheduleApplyHandler(e,t))}),$("<div></div>").dialog(r).dialog("open")}function cronValidateHandler(){$("#cron .cron-table-inputCell input").removeClass("invalid");var e=$("#cronValue").val(),t=cronEV.cronValidate(e);if(!0===t)return $("#cron-msg").html(""),$("#cron-input").val(e),!0;var n='<div id="cron-error-msg" class="cron-error-msg">'+t[0]+"</div>";return void 0!==t[1]&&(t[1]instanceof Array?t[1].forEach(function(e){$("#cron .cron-table-inputCell input").eq(e).addClass("invalid")}):$("#cron .cron-table-inputCell input").eq(t[1]).addClass("invalid")),$("#cron-msg").html(n),!1}function datetimeField(e,t,n,i){var r=$("<input/>",{class:"form-control",style:"border-right: 0px",type:"text",id:t.key});r.val(utils.getValue(t,n)||"");var o=$("<div/>",{class:"input-group-addon",style:"cursor:pointer; padding: 5px 3px; background-color: transparent;border-left: 0px; border-color: rgba(255,255,255,0.1);"}).append($("<i/>",{class:"fa fa-calendar"})),a=$("<div/>",{class:"input-group"}).append(r).append(o);o.on("click",function(){r.focus()});var s=function(){var e=r.val()||"";e!==n[t.key]&&(processManager.methodProxy.getMethod("setSavable")(!0,processManager.getInitProcess()),n[t.key]=e,valueChangeEvent(t.needRepaint))};r.on("keypress",function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||r.blur()}),mx.mxClient.IS_IE?r.on("focusout",s):r.on("blur",s);var l=generateRow(e,t,a);return r.datetimepicker({showOtherMonths:!0,selectOtherMonths:!0,changeMonth:!1,changeYear:!1,dateFormat:"yy-mm-dd",timeInput:!0,onSelect:s}),l}function stringField(e,t,n,i){var r;r="password"===t.type?$("<input/>",{class:"form-control",type:"password",id:t.key}):$("<input/>",{class:"form-control",type:"text",id:t.key}),"csv path"===t.key&&r.attr("placeholder","example:/home/fakepath"),r.val(utils.getValue(t,n)||""),t.isRequired&&""===r.val()&&r.addClass("invalid");var o=function(){t.isRequired&&""===r.val()?r.addClass("invalid"):r.removeClass("invalid");var i=r.val()||"";i!==n[t.key]&&modifyConfirm(e,r,t,n,i)};return r.on("keypress",function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||r.blur()}),mx.mxClient.IS_IE?r.on("focusout",o):r.on("blur",o),generateRow(e,t,r)}function isNonScientificNumber(e){if(void 0===e||null===e||"number"!=typeof e&&"string"!=typeof e)return!1;var t=String(e);return t.length<=15&&t.indexOf("e+")<0&&t.indexOf("E+")<0&&!isNaN(t)&&isFinite(t)}function intField(e,t,n){var i=$("<input/>",{class:"form-control",type:"number",title:" ",id:t.key});"double"===t.type?i.prop("step",.01):i.prop("step",1),_.has(t,"min")&&isNonScientificNumber(t.min)&&i.prop("min",t.min),_.has(t,"max")&&isNonScientificNumber(t.max)&&i.prop("max",t.max),i.val(utils.getValue(t,n)),t.isRequired&&""===i.val()&&i.addClass("invalid");var r=function(){if(t.isRequired&&""===i.val()?i.addClass("invalid"):i.removeClass("invalid"),!this.checkValidity())return toastr.warning($.i18n.prop("ict_oneminer_message_number_range",t.label,this.min,this.max)),$(this).val(n[t.key]).focus();var r=i.val()||"";r!==n[t.key]&&(null===currentOperator?(processManager.methodProxy.getMethod("setSavable")(!0,processManager.getInitProcess()),n[t.key]=r,valueChangeEvent(t.needRepaint)):modifyConfirm(e,i,t,n,r))};return i.on("keypress",function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||i.blur()}),mx.mxClient.IS_IE?i.on("focusout",r):i.on("blur",r),generateRow(e,t,i)}function booleanField(e,t,n){var i=$("<span/>",{class:"spanCheckbox"}),r=$("<input/>",{type:"checkbox",class:"pull-left",id:t.key}),o=$("<label/>",{for:t.key});i.append(r).append(o);var a=utils.getValue(t,n);r.prop("checked",_.isBoolean(a)?a:"true"===a);var s=function(){var i=r.prop("checked");null===currentOperator?(processManager.methodProxy.getMethod("setSavable")(!0,processManager.getInitProcess()),n[t.key]=i,valueChangeEvent(t.needRepaint)):modifyConfirm(e,r,t,n,i)};return r.on("click",s),generateRow(e,t,i)}function categoryField(e,t,n,i){var r=$("<select/>",{class:"form-control",id:t.key});if(t.categories){var o=!1,a=utils.getValue(t,n),s=[];if(t.categories.length>0)s=t.categories;else if("table_name"===t.key){var l=processManager.getOperatorParams(i.id);s=JSON.parse(l.checkDbButton||"[]")}s.forEach(function(e){o=o||e===a,r.append($("<option/>",{selected:e===a}).html(e))}),o||(t.categories.length&&(n[t.key]=""),r.append($("<option/>",{selected:!0,disabled:!0,style:"display:none"}).html("")))}var c=function(){var i=r.val()||"";if(i!==n[t.key])if(t.key===clusterKey)if(processManager.isRunning())resetConfirmDialog(r,t,n);else{var o=function(e,t,n){processManager.methodProxy.getMethod("setSavable")(!0,processManager.getInitProcess()),t[e.key]=n,clusterChangedEvent(t[e.key])};modifyConfirmDialog(r,t,n,i,o)}else null===currentOperator?(processManager.methodProxy.getMethod("setSavable")(!0,processManager.getInitProcess()),n[t.key]=i,valueChangeEvent(t.needRepaint)):modifyConfirm(e,r,t,n,i)};return r.on("change",c),generateRow(e,t,r)}function stringcategoryField(e,t,n,i){var r=$("<div/>",{class:"ui-front",style:"position:relative"}),o=$("<input/>",{class:"form-control",id:t.key});r.append(o),o.val(utils.getValue(t,n)),t.isRequired&&""===o.val()&&o.addClass("invalid"),o.autocomplete({minLength:0,source:t.categories,select:function(i,r){var a=r.item.value;modifyConfirm(e,o,t,n,a)},open:function(){$("div.ui-front").removeClass("ui-front-zIndex"),$(this).parent().addClass("ui-front-zIndex"),utils.doNiceScroll($(".header-fixed").parent()),$(".header-fixed>tbody").getNiceScroll().resize()},close:function(){$(".header-fixed").parent().getNiceScroll().resize(),$(".header-fixed>tbody").getNiceScroll().resize()}}).click(function(){$(this).autocomplete("search",""),utils.doNiceScroll($(".form-group .ui-widget-content"))}),o.on("keypress",function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||o.blur()});var a=function(i){t.isRequired&&""===o.val()?o.addClass("invalid"):o.removeClass("invalid");var r=o.val()||"";r!==n[t.key]&&modifyConfirm(e,o,t,n,r)};if(mx.mxClient.IS_IE?o.on("focusout",a):o.on("blur",a),!e)return r;generateRow(e,t,r)}function hivetableField(e,t,n,i){var r=$("<div/>",{class:"ui-front input-group"}),o=$("<input/>",{class:"form-control",id:t.key}),a=$("<div/>",{class:"input-group-btn"}),s=$("<button/>",{class:"btn btn-default",type:"button",style:"font-size:12px;line-height: 1px;"}).append($("<span/>",{class:"fa fa-refresh"}));a.append(s),r.append(o),r.append(a);var l=processManager.getParams()[clusterKey];if(!_.isEmpty(t.categories)&&_.has(n,clusterKey)&&n[clusterKey]===l||(n.zadoop_connection_id=l,t.categories=utils.getHiveTables(l,t.tableType)),initTableInput(o,t,n),s.on("click",function(){"0"===utils.refreshHiveTable(l,t.tableType)&&toastr.warning("It is refreshing now, please try again later.");var e=$("<input/>",{class:"form-control",id:t.key});$(this).parent().prev().replaceWith(e),n.zadoop_connection_id=l,t.categories=utils.getHiveTables(l,t.tableType),initTableInput(e,t,n)}),!e)return r;generateRow(e,t,r)}function attributeField(e,t,n,i){var r=$("<select/>",{class:"form-control",id:t.key});if(t.inPort&&(t.categories=[],i.children.some(function(e){if(e.value.portType===constants.PORT_INPUT_TYPE&&e.value.name===t.inPort&&e.value.data&&e.value.data.type===constants.METADATA_EXAMPLE_VIEW){t.categories=t.enableEmpty?[""]:[];return JSON.parse(e.value.data.result).forEach(function(e){t.categories.push(e.name)}),!0}})),t.categories){var o=!1,a=utils.getValue(t,n);t.categories.forEach(function(e){o=o||e===a,r.append($("<option/>",{value:e,selected:e===a}).html(e))}),o||(t.categories.length&&(n[t.key]=""),r.append($("<option/>",{selected:!0,disabled:!0,style:"display:none"}).html("")))}t.isRequired&&!r.val()&&r.addClass("invalid");var s=function(){t.isRequired&&!r.val()?r.addClass("invalid"):r.removeClass("invalid");var i=r.val()||"";i!==n[t.key]&&modifyConfirm(e,r,t,n,i)};return r.on("change",s),generateRow(e,t,r)}function attributesField(e,t,n,i){var r=[],o=utils.getValue(t,n);o=o?JSON.parse(o):[],t.inPort&&(t.categories=[],i.children.some(function(e){if(e.value.portType===constants.PORT_INPUT_TYPE&&e.value.name===t.inPort&&e.value.data&&e.value.data.type===constants.METADATA_EXAMPLE_VIEW){t.categories=[];return JSON.parse(e.value.data.result).forEach(function(e){t.categories.push(e.name)}),!0}})),t.categories&&t.categories.forEach(function(e){o.indexOf(e)<0&&(!t.excludeAttrs||t.excludeAttrs.indexOf(e)<0)&&r.push(e)});var a=t.key+"ParamDialog",s=$("<div/>",{id:a,style:"display: table, width:100%"});$("#properties").append(s);var l=$("#attributesDialog").clone();s.append(l.children());var c="#"+a+" ";$(c+"#unselected-filter").on("input",function(){var e=$(this).val().toLowerCase();$(c+"#unselected-attr li").each(function(){var t=$(this);t.removeClass("selected"),t.text().toLowerCase().indexOf(e)<0?t.addClass("hide"):t.removeClass("hide")})}),$(c+"#selected-filter").on("input",function(){var e=$(this).val().toLowerCase();$(c+"#selected-attr li").each(function(){var t=$(this);t.removeClass("selected"),t.text().toLowerCase().indexOf(e)<0?t.addClass("hide"):t.removeClass("hide")})}),$(c+"#unselected-attr,"+c+"#selected-attr").sortable({connectWith:".connected",receive:function(e,t){sort(t.item.parent())},stop:function(e,t){sort(t.item.parent())}});var u=[],d=[];handleListSelect($(c+"#unselected-attr"),u),handleListSelect($(c+"#selected-attr"),d),$(c+"button#select").on("click",function(){var e=$(c+"#unselected-attr .selected").detach();e.removeClass("selected lastselected"),$(c+"#selected-attr").append(e),sort($(c+"#selected-attr"))}),$(c+"button#unselect").on("click",function(){var e=$(c+"#selected-attr .selected").detach();e.removeClass("selected lastselected"),$(c+"#unselected-attr").append(e),sort($(c+"#unselected-attr"))}),r.forEach(function(e){$(c+"#unselected-attr").append($("<li/>").html(e))}),sort($(c+"#unselected-attr")),o.forEach(function(e){$(c+"#selected-attr").append($("<li/>").html(e))}),sort($(c+"#selected-attr")),dialogs.push("#"+a);var h=$("#"+a).dialog({autoOpen:!1,show:{effect:"fade",duration:500},hide:"drop",modal:!0,classes:"display_table",resizable:!0,height:"auto",width:700,title:"Select Attributes: "+t.key,buttons:[{text:"Apply",click:function(){var e=[];$(c+"#selected-attr li").each(function(){e.push($(this).text())});var i=JSON.stringify(e);modifyConfirm({},null,t,n,i),$(this).dialog("close")}},{text:"Cancel",click:function(){$(this).dialog("close")}}]}),p=function(){h.data("info",{attributes:r,selected_attrs:o}).dialog("open")},f=$("<button/>",{type:"button",class:"btn btn-primary form-control"}).html("Select Attributes");return f.on("click",p),generateRow(e,t,f)}function listField(e,t,n,i){var r,o=t.keyType,a=t.valueType,s=t.key+"ParamDialog",l=$("<div/>",{id:s});$("#properties").append(l),l.append($('<table class="table table-bordered dataTable header-fixed"><thead><tr/></thead><tbody/></table>'));var c=l.find("table thead tr");c.append($("<th/>").html(o.label)),c.append($("<th/>").html(a.label));var u=l.find("table tbody"),d=utils.getValue(t,n);if(d)JSON.parse(d).forEach(function(e){var t={};t[o.key]=e[0],t[a.key]=e[1];var n=handleParam(null,o,t,i),r=handleParam(null,a,t,i);u.append($("<tr/>").append($("<td/>").append(n)).append($("<td/>").append(r)))});else{var h=handleParam(null,o,{},i),p=handleParam(null,a,{},i);u.append($("<tr/>").append($("<td/>").append(h)).append($("<td/>").append(p)))}u.on("click","tr",function(){u.children("tr.active").removeClass("active"),$(this).addClass("active")}),dialogs.push("#"+s);var f=$("#"+s).dialog((r={autoOpen:!1,show:{effect:"fade",duration:500},hide:"drop",modal:!0,resizable:!1,height:"auto",width:700},r.height=500,r.title="Edit "+t.label,r.buttons=[{text:"Add",click:function(){var e=handleParam(null,o,{},i),t=handleParam(null,a,{},i);u.append($("<tr/>").append($("<td/>").append(e)).append($("<td/>").append(t))),utils.doNiceScroll("#"+s)}},{text:"Remove",click:function(){var e=u.children("tr.active");e.length?e.remove():u.children("tr").last().remove(),utils.doNiceScroll("#"+s)}},{text:"Apply",click:function(){var i=[];u.children("tr").each(function(e,t){var n="";"stringcategory"===o.type?n=$(this).children("td").first().children("div.ui-front").children("input").val():"category"===o.type||"attribute"===o.type||"string"===o.type?n=$(this).children("td").first().children().val():toastr.warning("failed to get key, unsupported key type: "+o.type);var r="";"stringcategory"===a.type?r=$(this).children("td").last().children("div.ui-front").children("input").val():"category"===a.type||"string"===a.type||"double"===a.type?r=$(this).children("td").last().children().val():toastr.warning("failed to get value, unsupported value type: "+a.type),i.push([n,r])});var r=JSON.stringify(i);modifyConfirm(e,null,t,n,r),$(this).dialog("close")}},{text:"Cancel",click:function(){$(this).dialog("close")}}],r)),g=function(){f.dialog("open"),utils.doNiceScroll("#"+s)},m=$("<button/>",{type:"button",class:"btn btn-primary form-control"}).html("Edit List");return m.on("click",g),generateRow(e,t,m)}function sort(e){var t=e.children().detach().sort(function(e,t){return $(e).text()<$(t).text()?-1:$(e).text()>$(t).text()?1:0});e.append(t)}function handleListSelect(e,t){e.on("click","li",function(n){document.activeElement.blur();var i=$(this),r=e.find("li");if(n.shiftKey){var o=null;if(i.nextAll(".lastselected").length>0?o="forward":i.prevAll(".lastselected").length>0&&(o="back"),o&&t.length>0){if(i[0]===t[0])return;var a=[];if("forward"===o)a=i.nextUntil(t,"li");else{if("back"!==o)return;a=t.nextUntil(i,"li")}r.removeClass("selected"),a.addClass("selected"),t.addClass("selected"),i.addClass("selected")}else t=i,i.addClass("lastselected"),r.removeClass("selected"),i.addClass("selected")}else n.ctrlKey||$(".connected .selected").removeClass("selected"),e.find(".lastselected").removeClass("lastselected"),i.addClass("selected"),i.addClass("lastselected"),t=i})}function checkDbButtonField(e,t,n,i){var r=$("<input/>",{type:"button",class:"checkDbButton",id:t.type});$(r).val("test connection");var o=function(){checkDbConnection({dbSystem:$("#database_system").val(),host:$("#Host").val(),port:$("#Port").val(),schema:$("#Schema").val(),username:$("#Username").val(),password:$("#Password").val()},n,!0)};return r.on("click",o),generateRow(e,t,r)}function resetTableList(){var e=graph.getSelectionCell();utils.getParameters(e.value.type).forEach(function(e){"table_name"===e.key&&valueChangeEvent(!0)})}function checkDbConnection(e,t,n){var i=function(e){var i;"result:fail"===e[0]?(i=[],toastr.error($.i18n.prop("ict_oneminer_property_check_database_failed"))):"Please test database link firstly."==e[0]?i=e:(i=e,toastr.success($.i18n.prop("ict_oneminer_property_check_database_success"),"",utils.toastrConfig)),n&&(t.checkDbButton=JSON.stringify(i),resetTableList())};http.get(utils.genApiUrl("operator/checkdb"),e,i,errorHandler)}function pageLinkField(e,t,n,i){var r=t.key+"ParamDialog",o=$("<div/>",{id:r,style:"display: table, width:100%"});$("#properties").append(o);var a=$("<iframe>").attr({id:"gis-frame",src:t.pageUrl,width:"100%",height:"100%"});o.append(a),dialogs.push("#"+r);var s=$("#"+r).dialog({autoOpen:!1,show:{effect:"fade",duration:500},hide:"drop",modal:!0,classes:"display_table",resizable:!0,height:800,width:1070,title:"Gis Select: "+t.label,buttons:[{text:"Apply",click:function(){var e=function(e){return{cellsArray:e.globalCondition.cellsArray,gridsArray:e.globalCondition.gridsArray}}($("#gis-frame")[0].contentWindow);n[t.key]=JSON.stringify(e),valueChangeEvent(t.needRepaint),$(this).dialog("close")}},{text:"Cancel",click:function(){$(this).dialog("close")}}]}),l=function(){s.data("info",{pageUrl:t.pageUrl,script:t.script}).dialog("open")},c=$("<button/>",{type:"button",class:"btn btn-primary form-control"}).html("Gis Select");return c.on("click",l),generateRow(e,t,c)}function setGraph(e){graph=e}function checkGBaseButtonField(e,t,n,i){var r=$("<input/>",{type:"button",class:"checkDbButton",id:t.type});$(r).val("test connection");var o=function(){checkDbConnection({dbSystem:"gbase",host:$("#Host").val(),port:$("#Port").val(),schema:$("#Schema").val(),username:$("#Username").val(),password:$("#Password").val()},n,!1)};return r.on("click",o),generateRow(e,t,r)}function zaipdataField(e,t,n,i){var r=$("<div/>",{class:"ui-front input-group",style:"width:100%"}),o=$("<input/>",{class:"form-control",id:t.key});r.append(o);var a=processManager.getParams().zaip_id,s=utils.getHiveZaip(a);_.isEmpty(t.categories)&&(t.categories=s);var l=utils.getValue(t,n),c=s.filter(function(e){return e.id==l})[0].name;o.val(c||""),t.isRequired&&""===o.val()&&o.addClass("invalid"),o.autocomplete({minLength:0,source:function(e,t){for(var n=new RegExp($.ui.autocomplete.escapeRegex(e.term),"i"),i=s.map(function(e){return e.name}),r=(s.map(function(e){return e.id}),[]),o=0;o<i.length;o++){var a=i[o];if(!a||e.term&&!n.test(a)||r.push({label:a,value:a}),r.length>100){r.push({label:$.i18n.prop("ict_oneminer_tip_more_items"),value:"maxRepSizeReached"});break}}t(r)},select:function(i,r){if("maxRepSizeReached"==r.item.value)return!1;var a=r.item.value,l=s.filter(function(e){return e.name==a})[0].id;modifyConfirm(e,o,t,n,l,function(e,t,n){t[e.key]=n,valueChangeEvent(e.needRepaint)})},focus:function(e,t){if("maxRepSizeReached"==t.item.value)return!1}}).click(function(){$(this).autocomplete("search",""),utils.doNiceScroll($(".form-group .ui-widget-content"))}),o.on("keypress",function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||o.blur()}),generateRow(e,t,r)}function zaipinputField(e,t,n,i){var r=$("<div/>",{}),o=$("<div/>",{class:"form-vertical"});$(r).append(o);var a=t.currentOpen?"cur":"",s=$("<div/>",{class:"input-set "+a}),l='\n               <span class="fa fa-fw fa-caret-right"></span>\n                <span class="fa fa-fw fa-caret-down"></span>\n                </span><span>'+t.label+"</span>\n                ";if(s.append(l),_.isArray(t.value)&&!_.isEmpty(t.value)){var c=getAllDependParams(t.value),u=[];t.value.forEach(function(e){if(isVisible(e,n,u)){u.push(e.key);var t=$("<div/>",{class:"form-group form-group-sm"});"Password"===e.key&&(e.type="password"),_.contains(c,e.key)&&(e.needRepaint=!0),handleParam(t,e,n,i),o.append(t)}})}e.append(s).append(r),s.on("click",function(){$(this).toggleClass("cur"),t.currentOpen=!t.currentOpen,utils.doNiceScroll("#visual-properties")})}var mx=utils.mx;__webpack_require__(63),__webpack_require__(66),__webpack_require__(37),__webpack_require__(38),__webpack_require__(21),__webpack_require__(35),__webpack_require__(65),__webpack_require__(33),__webpack_require__(32),__webpack_require__(9),__webpack_require__(30),__webpack_require__(53),__webpack_require__(51),__webpack_require__(52),$.ui.autocomplete.prototype._resizeMenu=function(){this.menu.element.outerWidth(this.element.outerWidth())};var dialogs=[],graph,isSelectionChange,currentOperator,currentConnectId,clusterKey=utils.clusterKey,global_sql_editor,getDescription=function(e){for(var t=e.value.type.replace(" ","_"),n='<ul class="operator-desc">',i=["OP_NAME","OP_ABSTRACT","OP_DESC","OP_INPUT","OP_OUTPUT"],r=0,o=i.length;r<o;r++){var a=i[r],s=$.i18n.prop(a+"_"+t);if(!s.startsWith("[")){n+='<li>\n                            <div class="desc-label">'+$.i18n.prop(a)+"</div>\n                            <div>"+s+"</div>\n                        </li>"}}return n+="</ul>"},openFileBrowser=function(e){var t=new utils.Dialog(500);t.title=$.i18n.prop("ict_oneminer_process_title_file_select"),t.setOpenHandler(fileBrowserOpenHandler),t.setConfirmHandler(fileBrowserConfirmHandler),$('<div id="fileBrowser"></div>').dialog(t).data("info",{path:e.val(),callBack:function(t){e.val(t).blur()}}).dialog("open")},fileBrowserOpenHandler=function(){var e=$(this).data("info").path||"/";$(this).append('<div class="col-sm-7" style="padding-left:10px;height:26px"><input type="search" class="form-control" id="searchInput" placeholder="input path:/home/fakepath" style="height:26px;"></div><div><button id="searchBtn" class="btn btn-primary btn-sm" style="margin-left:8px; height:26px;">search</button><button id="upBtn" class="btn btn-primary btn-sm" style="margin-left:15px; height:26px;">Up</button></div>'),$("#searchInput").val(e),$("#searchInput").keypress(function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||$("#searchBtn").click()}),$("#searchBtn").click(function(){var e=$("#searchInput").val();getFileList(e)}),$("#upBtn").click(function(){var e=$("#searchInput").val(),t=e.lastIndexOf("/")>0,n=t&&e.lastIndexOf("/")||e.lastIndexOf("\\"),i=e.substring(0,n);$("#searchInput").val(i),getFileList(i)}),getFileList(e)},getFileList=function(e){var t={connectId:processManager.getCurrentConnectId,path:e||"/"};http.post(utils.genApiUrl("datasource/hdfs/listdir"),t,getFileListSuccess,errorHandler)},fileBrowserConfirmHandler=function(){var e=$("#searchInput").val();(0,$(this).data("info").callBack)(e),$(this).dialog("close")},getFileListSuccess=function(e){$(".file-list").remove();var t=e||[],n='<ul class="file-list">';t.forEach(function(e){var t=e.path.split("/").pop(),i=e.dir?"fa fa-folder-o":"fa fa-file",r=e.dir?"hdfs-folder":"hdfs-file";n+='<li><a><i class="'+i+'"></i><div class="'+r+'" data-path="'+e.path+'">'+t+"</div></a></li>"}),n+="</ul>",$("#fileBrowser").append(n),utils.doNiceScroll(".file-list"),$(".hdfs-folder").dblclick(function(){var e=$(this)[0].dataset.path;$("#searchInput").val(e),getFileList(e)}),$(".hdfs-folder, .hdfs-file").click(function(){$(this).parents("li").toggleClass("li-selected").siblings().removeClass("li-selected");var e=$(this)[0].dataset.path;$("#searchInput").val(e)})},errorHandler=function(e){toastr.info(e,"ajax error",utils.toastrConfig)},scheduleField=function(e,t,n){var i=$("<select/>",{class:"form-control",id:t.key}),r=utils.getValue(t,n).split(";").shift();["once","daily","weekly","monthly","cron"].forEach(function(e){i.append($("<option/>",{selected:r===e}).html(e))}),initSchedule(e,t,n,i);var o=generateRow(e,t,i);return setTimeout(function(){i.change()},0),o},initSchedule=function(e,t,n,i){i.on({change:function(){$(".schedule-options").remove();var r=utils.getValue(t,n).split(";");switch(i.val()){case"once":return initOnceOption(e,r,t,n);case"daily":return initDailyOption(e,r);case"weekly":return initWeeklyOption(e,r);case"monthly":return initMonthlyOption(e,r);case"cron":return initCronOption(e,r,t,n)}},blur:function(){scheduleApplyHandler(t,n)}}),$("#properties").on("blur",".schedule-val",function(){scheduleApplyHandler(t,n)})},scheduleApplyHandler=function(e,t){var n=[$("#"+e.key).val()],r=Array.from($(".schedule-val"));for(i=0,len=r.length;i<len;i++){var o=r[i];if(""===$(o).val()){var a=o.dataset.type;"datetime"===a?$(o).val((new Date).Format("yyyy-MM-dd hh:mm")):"time"===a?$(o).val((new Date).Format("hh:mm")):"cron"===a?$(o).val("0 0 0 * * ?"):$(o).val("1")}}var s=r.map(function(e){return $(e).val()}),l=n.concat(s).join(";");l!==t[e.key]&&(processManager.methodProxy.getMethod("setSavable")(!0,processManager.getInitProcess()),t[e.key]=l,valueChangeEvent(e.needRepaint))},initOnceOption=function(e,t,n,i){var r=$("<label/>",{class:"control-label",style:"text-align:left;"}).html("start time"),o=$("<input/>",{class:"form-control schedule-val","data-type":"datetime"}),a=$("<div/>").append(o),s=$("<div/>",{class:"form-group form-group-sm schedule-options"}).append(r).append(a),l="once"===t[0]?t[1]:(new Date).Format("yyyy-MM-dd hh:mm");o.val(l),e.after(s),o.datetimepicker({showOtherMonths:!0,selectOtherMonths:!0,changeMonth:!1,changeYear:!1,dateFormat:"yy-mm-dd",timeInput:!0,onSelect:function(){scheduleApplyHandler(n,i)}})},initDailyOption=function(e,t){var n="daily"===t[0]?t[1]:"1",i="daily"===t[0]?t[2]:(new Date).Format("hh:mm"),r='<div class="form-group form-group-sm schedule-options"><label class="control-label" style="text-align:left;">every</label><div><input class="form-control schedule-val" type="number" min=1 value='+n+"></div></div>",o='<div class="form-group form-group-sm schedule-options"><label class="control-label" style="text-align:left;">start time</label><div><input class="form-control schedule-val" data-type="time" type="time" value='+i+"></div></div>";e.after(o).after(r)},initWeeklyOption=function(e,t){var n="weekly"===t[0]?t[1]:"",i="weekly"===t[0]?t[2]:(new Date).Format("hh:mm"),r=$("<label/>",{class:"control-label",style:"text-align:left;"}).html("day"),o=$("<select/>",{class:"form-control schedule-val"}),a=$("<div/>").append(o),s=$("<div/>",{class:"form-group form-group-sm schedule-options"}).append(r).append(a);["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].forEach(function(e,t){o.append($("<option/>",{value:t,selected:n==t}).html(e))});var l='<div class="form-group form-group-sm schedule-options"><label class="control-label" style="text-align:left;">start time</label><div><input class="form-control schedule-val" data-type="time" type="time" value='+i+"></div></div>";e.after(l).after(s)},initMonthlyOption=function(e,t){var n="monthly"===t[0]?t[1]:"1",i="monthly"===t[0]?t[2]:(new Date).Format("hh:mm"),r='<div class="form-group form-group-sm schedule-options"><label class="control-label" style="text-align:left;">day</label><div><input class="form-control schedule-val" type="number" min=1 max=31 value='+n+"></div></div>",o='<div class="form-group form-group-sm schedule-options"><label class="control-label" style="text-align:left;">start time</label><div><input class="form-control schedule-val" data-type="time" type="time" value='+i+"></div></div>";e.after(o).after(r)},initCronOption=function(e,t,n,i){var r="cron"===t[0]?t[1]:"0 0 0 * * ?";r=r||"0 0 0 * * ?";var o='<div class="form-group form-group-sm schedule-options"><label class="control-label" style="text-align:left;">'+$.i18n.prop("CRON_expression_cron")+'：</label><input id="cron-input" class="schedule-val" data-type="cron" value="'+r+'" readonly="readonly" style="background:transparent;border:none"><button class="btn btn-primary opCronTable" style="width: 100%;">Edit</button></div>';e.after(o),$(document).off("click",".opCronTable"),$(document).on("click",".opCronTable",function(){opCronTable(n,i,$("#cron-input").val())})},textField=function(e,t,n,i){var r=$("<textarea/>",{class:"form-control need-scroll",rows:8,id:t.key});r.val(utils.getValue(t,n)||""),t.isRequired&&""===r.val()&&r.addClass("invalid");var o=function(){t.isRequired&&""===r.val()?r.addClass("invalid"):r.removeClass("invalid");var i=r.val()||"";i!==n[t.key]&&modifyConfirm(e,r,t,n,i)};return r.on("blur",o),generateRow(e,t,r)},passwordField=function(e,t,n,i){return stringField(e,t,n,i)},longField=function(e,t,n){return intField(e,t,n)},doubleField=function(e,t,n){return intField(e,t,n)},isMedium=function(e){return e.value&&e.value.status&&"medium"===e.value.status.type},isSuccess=function(e){return e.value&&e.value.status&&("success"===e.value.status.type||getIteration(e)>0)},isWaiting=function(e){return e.value&&e.value.status&&"waiting"===e.value.status.type},isRunning=function(e){return e.value&&e.value.status&&"running"===e.value.status.type},getIteration=function(e){if(e.value.iterations){var t=e.value.iterations.split(";")[0],n=t?parseInt(t):0;return e.value.status&&(n="running"===e.value.status.type?n-1:n),Math.max(n,0)}},modifyConfirm=function(e,t,n,i,r,o,a){if(e){var o=o||getModifyCallBack(e,t,n,i,r),s=graph.getSelectionCell();if(!s)return o(n,i,r),void processManager.methodProxy.getMethod("setSavable")(!0,processManager.getInitProcess());if(isMedium(s)||isSuccess(s)||isWaiting(s)||s.isEdge()){var l=getChangeNum(a);l.canModify?modifyConfirmDialog(t,n,i,r,o,l,a):resetConfirmDialog(t,n,i,a)}else isRunning(s)?resetConfirmDialog(t,n,i,a):(o(n,i,r),processManager.methodProxy.getMethod("setSavable")(!0,processManager.getInitProcess()))}},resetConfirmDialog=function(e,t,n,i){var r=$.i18n.prop("ict_oneminer_dialog_modify_tip"),o=new utils.Dialog(400,200,r);o.buttons=o.buttons.slice(0,1),o.setConfirmHandler(function(){i||resetData(e,t,n),$(this).dialog("close")}),$("<div></div>").dialog(o).dialog("open")},getModifyCallBack=function(e,t,n,i,r){return e?function(e,t,n){t[e.key]=n,valueChangeEvent(e.needRepaint)}:function(e,t,n){t[e.key]=n}},resetData=function(e,t,n){if("boolean"===t.type)e.attr("checked",n[t.key]);else if("sparktable"===t.type){var i=n[t.key].split(".");e.val("SELECT"===e[0].nodeName?i[0]:i[1])}else if("partitionInfo"===t.type){var r=JSON.parse(n[t.key]),i=r.tableName.split(".")[0],o=r.tableName.split(".")[1],a=r.columns||[];if("INPUT"===e.nodeName){var s=a.filter(function(t){return t.columnName===$(e).prev().text()})[0].columnValue;$(e).val(s)}else e.val("SELECT"===e[0].nodeName?i:o)}else e&&e.val(n[t.key])},modifyConfirmDialog=function(e,t,n,i,r,o,a){var s=getConfirmMessage(o);if(s){var l=new utils.Dialog(400,200,s);l.setConfirmHandler(function(){confirmModify(t,n,i,r,a),$(this).dialog("close")}),l.setCancelHandler(function(){a||resetData(e,t,n),$(this).dialog("close")}),$("<div></div>").dialog(l).dialog("open")}else confirmModify(t,n,i,r,a)},getConfirmMessage=function(e){return e?e.time>=constants.OP_CHANGE_LIMIT_TIME?$.i18n.prop("ict_oneminer_dialog_continue_confirm_time"):e.count>=constants.OP_CHANGE_LIMIT_NUM?$.i18n.prop("ict_oneminer_dialog_continue_confirm").replace("*",e.count):void 0:$.i18n.prop("ict_oneminer_dialog_continue_confirm_all")},confirmModify=function(e,t,n,i,r){if(processManager.isRunning()){var o={processName:processManager.getProcessName(),processInfo:JSON.stringify(processManager.getProcessInfo()),operatorName:currentOperator||r&&r.operatorName};http.post(utils.genApiUrl("process/modifyOperator"),o)}i(e,t,n),processManager.methodProxy.getMethod("setSavable")(!0,processManager.getInitProcess())},getChangeNum=function(e){var t=processManager.getModifiedOperators()&&processManager.getModifiedOperators().split(",")||[],n=e&&e.operatorName||currentOperator;_.contains(t,n)||t.push(n);var i={processName:processManager.getProcessName(),processInfo:JSON.stringify(processManager.getProcessInfo()),modifiedOperators:e&&e.execAll?"":t.join()};return utils.getDataFromServer(i,utils.genApiUrl("process/relatedOperatorCount"))},initTableInput=function(e,t,n){e.val(utils.getValue(t,n)),t.isRequired&&""===e.val()&&e.addClass("invalid"),e.on("keypress",function(t){13!==t.keyCode||mx.mxEvent.isShiftDown(t)||e.blur()}),configAutoComplete(e,t,n);var i=function(i){t.isRequired&&""===e.val()?e.addClass("invalid"):e.removeClass("invalid");var r=e.val()||"";r!==n[t.key]&&modifyConfirm({},e,t,n,r)};mx.mxClient.IS_IE?e.on("focusout",i):e.on("blur",i)},configAutoComplete=function(e,t,n){e.autocomplete({minLength:0,source:function(e,n){for(var i=new RegExp($.ui.autocomplete.escapeRegex(e.term),"i"),r=t.categories,o=[],a=0;a<r.length;a++){var s=r[a];if(!s||e.term&&!i.test(s)||o.push({label:s,value:s}),o.length>100){o.push({label:$.i18n.prop("ict_oneminer_tip_more_items"),value:"maxRepSizeReached"});break}}n(o)},select:function(i,r){if("maxRepSizeReached"==r.item.value)return!1;var o=r.item.value;modifyConfirm({},e,t,n,o)},focus:function(e,t){if("maxRepSizeReached"==t.item.value)return!1}}).click(function(){$(this).autocomplete("search",""),utils.doNiceScroll($(".form-group .ui-widget-content"))})},sparktableField=function(e,t,n,i){t.categories=utils.getDataFromServer({connectId:processManager.getCurrentConnectId()},utils.genApiUrl("datasource/sparkMultiDBTable/list"));var r=t.categories.map(function(e){return e.dataBaseName}),o=utils.getValue(t,n);o.indexOf(".")>-1?(schema=o.split(".")[0],table=o.split(".")[1]):(schema=t.categories[0].dataBaseName,table=utils.getValue(t,n)),r.some(function(e){return e===schema})||(schema=""),n[t.key]=schema+"."+table;var a=$("<select/>",{class:"form-control",id:t.key});r.forEach(function(e){a.append($("<option/>",{value:e,selected:e===schema}).html(e))}),a.on("change",function(){var i=this.value,r=this.value+".";modifyConfirm(e,a,t,n,r,function(t,n,r){n[t.key]=r,createTableParam(e,t,n,i,""),valueChangeEvent(t.needRepaint)})}),setTimeout(function(){createTableParam(e,t,n,schema,table)},0),generateRow(e,t,a)},createTableParam=function(e,t,n,i,r){$(".schemaTables").remove();var o=t.categories.filter(function(e){return e.dataBaseName===i})[0],a=o&&o.tables||[];n[t.key]=i+"."+r;var s=$('<div class="ui-front form-group form-group-sm schemaTables">\n                            <label class="control-label" style="text-align:left" title="This parameter defines where table locates">table name</label>\n                            <input class="form-control" />\n                        </div>'),l=s.find("input");l.val(r),t.isRequired&&""===l.val()&&l.addClass("invalid");var c=function(e){t.isRequired&&""===l.val()?l.addClass("invalid"):l.removeClass("invalid");var i=n[t.key].split(".")[0]+"."+l.val();i!==n[t.key]&&modifyConfirm({},l,t,n,i)};l.on({keypress:function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||this.blur()},blur:c}),configSchemaComplete(e,l,t,n,a),e.after(s)},configSchemaComplete=function(e,t,n,i,r){t.autocomplete({minLength:0,source:function(e,t){for(var n=new RegExp($.ui.autocomplete.escapeRegex(e.term),"i"),i=r,o=[],a=0;a<i.length;a++){var s=i[a];if(!s||e.term&&!n.test(s)||o.push({label:s,value:s}),o.length>100){o.push({label:$.i18n.prop("ict_oneminer_tip_more_items"),value:"maxRepSizeReached"});break}}t(o)},select:function(r,o){if("maxRepSizeReached"==o.item.value)return!1;var a=i[n.key].split(".")[0]+"."+o.item.value;modifyConfirm(e,t,n,i,a)},focus:function(e,t){if("maxRepSizeReached"==t.item.value)return!1}}).click(function(){$(this).autocomplete("search",""),utils.doNiceScroll($(".form-group .ui-widget-content"))})},partitionInfoField=function(e,t,n){t.categories=utils.getDataFromServer({connectId:processManager.getCurrentConnectId()},utils.genApiUrl("datasource/sparkMultiDBTable/list"));var i=t.categories.map(function(e){return e.dataBaseName}),r=JSON.parse(utils.getValue(t,n)||"[]");r.tableName&&r.tableName.indexOf(".")>-1?(schema=r.tableName.split(".")[0],table=r.tableName.split(".")[1]):(schema=t.categories[0].dataBaseName,table=r.tableName||""),n[t.key]=JSON.stringify({tableName:schema+"."+table,columns:r.columns||[]});var o=$("<select/>",{class:"form-control",id:t.key});i.forEach(function(e){o.append($("<option/>",{value:e,selected:e===schema}).html(e))}),o.on("change",function(){var i=this.value,r=JSON.stringify({tableName:this.value+".",columns:[]});modifyConfirm(e,o,t,n,r,function(t,n,r){n[t.key]=r,createPartitionTableParam(e,t,n,i,"",[]),valueChangeEvent(t.needRepaint)})}),setTimeout(function(){var i=JSON.parse(n[t.key]).columns;createPartitionTableParam(e,t,n,schema,table,i),createPartitionTableColumns(e,t,n,i)},0),generateRow(e,t,o)},createPartitionTableParam=function(e,t,n,i,r,o){$(".schemaTables, .partition-column").remove();var a=t.categories.filter(function(e){return e.dataBaseName===i})[0],s=a&&a.tables||[];s.some(function(e){return e===r})||(r=""),n[t.key]=JSON.stringify({tableName:i+"."+r,columns:o});var l=$('<div class="ui-front form-group form-group-sm schemaTables">\n                            <label class="control-label" style="text-align:left" title="This parameter defines where table locates">table name</label>\n                            <input class="form-control" />\n                        </div>'),c=l.find("input");c.val(r),t.isRequired&&""===c.val()&&c.addClass("invalid");var u=function(i){t.isRequired&&""===c.val()?c.addClass("invalid"):c.removeClass("invalid");var r=getPartitionData(t),o=JSON.stringify(r)||"";if(o!==n[t.key]){modifyConfirm(e,c,t,n,o,function(e,t,n){t[e.key]=n,valueChangeEvent(e.needRepaint)})}};c.on({keypress:function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||this.blur()},blur:u}),configPartitionComplete(e,c,t,n,s),e.after(l)},configPartitionComplete=function(e,t,n,i,r){t.autocomplete({minLength:0,source:function(e,t){for(var n=new RegExp($.ui.autocomplete.escapeRegex(e.term),"i"),i=r,o=[],a=0;a<i.length;a++){var s=i[a];if(!s||e.term&&!n.test(s)||o.push({label:s,value:s}),o.length>100){o.push({label:$.i18n.prop("ict_oneminer_tip_more_items"),value:"maxRepSizeReached"});break}}t(o)},select:function(r,o){if("maxRepSizeReached"==o.item.value)return!1;var a=$("#"+n.key).val()+"."+o.item.value,s=utils.getPartitionColumns(processManager.getCurrentConnectId(),constants.TABLE_TYPE,a,JSON.stringify(processManager.getProcessInfo()),processManager.getProcessName(),currentOperator),l=(s||[]).map(function(e){return{columnName:e.columnName,columnValue:""}}),c=JSON.stringify({tableName:JSON.parse(i[n.key]).tableName.split(".")[0]+"."+o.item.value,columns:l});modifyConfirm(e,t,n,i,c,function(t,n,i){n[t.key]=i,createPartitionTableColumns(e,t,n,l),valueChangeEvent(t.needRepaint)})},focus:function(e,t){if("maxRepSizeReached"==t.item.value)return!1}}).click(function(){$(this).autocomplete("search",""),utils.doNiceScroll($(".form-group .ui-widget-content"))})},createPartitionTableColumns=function(e,t,n,i){$(".partition-column").remove(),i.forEach(function(t){var n='<div class="form-group form-group-sm partition-column">\n                            <label class="control-label" style="text-align:left">'+(t.columnName||"")+'</label>\n                            <input class="form-control" value="'+(t.columnValue||"")+'">\n                         </div>';e.next().after($(n))}),$("#properties").off("blur keypress",".partition-column input"),$("#properties").on("blur",".partition-column input",function(){var i=JSON.stringify(getPartitionData(t));modifyConfirm(e,this,t,n,i,function(e,t,n){t[e.key]=n,valueChangeEvent(e.needRepaint)})}).on("keypress",".partition-column input",function(e){13!==e.keyCode||mx.mxEvent.isShiftDown(e)||$(this).blur()})},getPartitionData=function(e){return{tableName:$("#"+e.key).val()+"."+$(".schemaTables").find("input").val(),columns:Array.from($(".partition-column")).reverse().map(function(e){return{columnName:$(e).find("label").text(),columnValue:$(e).find("input").val()}})}},renamelistField=function(e,t,n,i){var r=$("<button id="+t.key+' class="btn btn-primary form-control">Rename</button>');return r.on("click",function(){openColumnsDialog(e,t,n,i)}),generateRow(e,t,r)},openColumnsDialog=function(e,t,n,i){var r=new utils.Dialog(700,500);r.title="Rename",r.position={my:"top",at:"top"},r.open=function(){$(this).append('<table class="table table-bordered dataTable header-fixed">\n                            <thead>\n                                <tr><th>column name</th><th>new name</th></tr>\n                            </thead>\n                            <tbody/>\n                        </table>'),initColumns($(this),t,n,i)},r.buttons=[{text:"Add",click:function(){addColumn($(this),t,i)}},{text:"Remove",click:function(){removeColumn($(this))}},{text:"Apply",click:function(){applyColumns($(this),e,t,n)}},{text:"Cancel",click:function(){$(this).dialog("close")}}],$('<div class="column-dialog"></div>').dialog(r).dialog("open")},calculateCounts=function(e){var t={};return e.forEach(function(e){t[e]=t[e]&&++t[e]||1}),t},isValidInput=function(e,t){var n=e.value,i=/(^_([a-zA-Z0-9]_?)*$)|(^[a-zA-Z](_?[a-zA-Z0-9])*_?$)/.test(n),r=1===t[n];return"INPUT"===e.nodeName?n&&r&&i:n&&r},checkValidity=function(e){var t=e.map(function(e){return e.value}),n=calculateCounts(t);e.forEach(function(e){isValidInput(e,n)?$(e).removeClass("invalid-variable"):$(e).addClass("invalid-variable")})},initColumns=function(e,t,n,i){var r=e.find("table tbody");r.on("click","tr",function(){$(this).addClass("active").siblings().removeClass("active")}).on("input","input",function(){var e=Array.from($(r).find("input"));checkValidity(e)}).on("change","select",function(){var e=Array.from($(r).find("select"));checkValidity(e)});var o=utils.getValue(t,n);if(o&&"[]"!==o)JSON.parse(o).forEach(function(e){var n,o=(n={},n[t.keyType.key]=e[0],n[t.valueType.key]=e[1],n),a=handleParam(null,t.keyType,o,i),s=handleParam(null,t.valueType,o,i);r.append($("<tr/>").append($("<td/>").append(a)).append($("<td/>").append(s)))});else{handleParam(null,t.keyType,{},i);t.keyType.categories.filter(function(e){return/\s+/g.test(e.trim())}).forEach(function(e){var n=t.keyType;n.defaultValue=e;var o=t.valueType;o.defaultValue=e.replace(/\s+/g,"_");var n=handleParam(null,n,{},i),o=handleParam(null,o,{},i);r.append($("<tr/>").append($("<td/>").append(n)).append($("<td/>").append(o)))})}utils.doNiceScroll(".column-dialog")},addColumn=function(e,t,n){var i=e.find("table tbody"),r=t.keyType;r.defaultValue="";var o=t.valueType;o.defaultValue="";var r=handleParam(null,r,{},n),o=handleParam(null,o,{},n);r.addClass("invalid-variable"),o.addClass("invalid-variable"),i.append($("<tr/>").append($("<td/>").append(r)).append($("<td/>").append(o))),utils.doNiceScroll(".column-dialog")},removeColumn=function(e){var t=e.find("table tbody");(t.children("tr.active").length?t.children("tr.active"):t.children("tr").last()).remove(),utils.doNiceScroll(".column-dialog")},applyColumns=function(e,t,n,i){var r=$(".invalid-variable");if(r.length)return r.focus();var o=e.find("table tbody"),a=Array.from(o.children("tr")).map(function(e){return[$(e).find("select").val(),$(e).find("input").val()]}),s=JSON.stringify(a);modifyConfirm(t,null,n,i,s),e.dialog("close")},ProcessTypeField=function(e,t,n,i){for(var r=utils.getValue(t,n),o=$("<div/>",{class:"clearfix",id:t.key}),a="",s=0;s<5;s++){a+='<div class="pull-left type-circle type-params process-type-'+(s+1)+" "+(r===s+1?"cur":"")+'">\n            <div class="inner-circle"></div>\n            </div>'}return o.append(a),$(document).off("click",".type-params"),$(document).on("click",".type-params",function(){$(this).siblings(".type-params").removeClass("cur"),$(this).toggleClass("cur");var i=$(".type-params.cur")?$(".type-params.cur").index()+1:0;modifyConfirm(e,o,t,n,i,function(e,t,n){t[e.key]=n,valueChangeEvent(e.needRepaint)})}),generateRow(e,t,o)},selectField=function(e,t,n,i){var r=parseInt(utils.getValue(t,n)||1);n[t.key]=r;var o=$("<div/>",{class:"clearfix",id:t.key}),a=processManager.getZaipId(),s=utils.getZaipConfig(a).gpuNum,l=[],c=0;s&&function handleBtnNum(){var e=Math.pow(2,c);e===s?l.push(e):(l.push(e),handleBtnNum(++c))}();var u="";return l.forEach(function(e){u+='<div class="pull-left gpu-btn '+(e===r?"cur":"")+'">'+e+"</div>"}),o.append(u),$(document).off("click",".gpu-btn"),$(document).on("click",".gpu-btn",function(){$(this).siblings(".gpu-btn").removeClass("cur"),$(this).addClass("cur");var i=$(".gpu-btn.cur").html();modifyConfirm(e,o,t,n,i,function(e,t,n){t[e.key]=n,valueChangeEvent(e.needRepaint)})}),generateRow(e,t,o)},that={};return that.selectionChanged=selectionChanged,that.setGraph=setGraph,that.getChangeNum=getChangeNum,that.getConfirmMessage=getConfirmMessage,that.modifyConfirm=modifyConfirm,that}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(e,t,n){var i,r;i=[n(0),n(6),n(11),n(55),n(1),n(3),n(7),n(4),n(43),n(8),n(49),n(29),n(116),n(117),n(118)],void 0!==(r=function(e,t,n,i,r,o,a,s,l,c,u,d,h,p,f){function changeListener(){d.getLoadingStatus()||T(!0,S)}function changeParamListener(e){!d.getLoadingStatus()&&e&&T(!0,S)}function initGraph(){h.init(document.getElementById("visual-graph"),changeListener,openEastPanel,closeEastPanel),w=h.getGraph(),d.setGraph(w),d.setChangeEvent(changeParamListener),d.setInitProcess(S),u.setGraph(w),d.methodProxy.addMethod(T,"setSavable")}function closeEastPanel(){m.close("east")}function openEastPanel(){m.open("east")}function openSouthPanel(){v.open("south")}function closeSouthPanel(){v.close("south")}function initContainer(t,n,i){N(t),A(n),E(i),e("#visual-tabs").tabs({activate:function(e,t){0===t.newTab.index()||t.newTab.index()}}),m=e("#visual").layout({center__paneSelector:"#center-item",west__paneSelector:"#left-item",east__paneSelector:"#right-item",west__size:240,east__size:260,spacing_open:6,spacing_closed:6,togglerContent_open:'<div class="ui-icon"></div>',togglerContent_closed:'<div class="ui-icon"></div>',east__resizable:!1,center__onresize:function(){v.resizeAll(),r.doNiceScroll("#visual-op-tree-div"),r.doNiceScroll("#visual-mod-tree-div"),r.doNiceScroll("#visual-properties")}}),v=e("#center-item").layout({center__paneSelector:"#visual-graph-panel",south__paneSelector:"#visual-log",initClosed:!0,spacing_open:6,spacing_closed:6,togglerContent_open:'<div class="ui-icon"></div>',togglerContent_closed:'<div class="ui-icon"></div>',south__size:250,onresize:function(){r.doNiceScroll("#visual-log-content")}}),e("#visual-toolbar>span").each(function(){if(this.title){var t=this.title,n=this.id;e(this).mouseover(function(i){this.title="",e("#visual-graph-panel>.title-bar").append('<span id="tooltip">'+t+"</span>");var r=e("#"+n)[0].offsetLeft,o=e("#"+n)[0].offsetTop,a=parseInt(e("#tooltip").css("width"),10)/2-9;e("#tooltip").css({left:r-a+"px",top:o+35+"px",position:"absolute",background:"#2E394A"}).show()}).mouseout(function(){e("#tooltip").remove(),this.title=t})}}),e("span#close-win").click(function(){closeWin()}),e("span#train-run").click(function(){D()}),e("span#zaip-edit").click(function(){edit()}),e("span#pullmax").click(function(){var t=e(this).hasClass("fa-expand")?e("#center-item").height():250;v.sizePane("south",t),e(this).toggleClass("fa-expand fa-compress")}),b.hide(),b.css({top:"45px"}),initGraph()}function edit(){var t=new r.Dialog(500,200);t.title=e.i18n.prop("ict_zaip_add_edit_operator"),t.buttons[0].text=e.i18n.prop("ict_zaip_add_edit_last"),t.buttons[1].text=e.i18n.prop("ict_oneminer_button_yes"),t.buttons.push({text:e.i18n.prop("ict_oneminer_button_cancel"),click:function(){setWatchMode(),e(this).dialog("close")}}),t.setOpenHandler(function(){e(this).html(e.i18n.prop("ict_zaip_add_edit_ask"))}),t.setConfirmHandler(function(){setEditMode();var t=JSON.parse(JSON.stringify(d.getCacheTrain(g)));t.operators.forEach(function(e){"zaipInput"==e.type&&(e.params=d.hanlderInputData(t))}),resetProcess(t),e(this).dialog("close")}),t.setCancelHandler(function(){setEditMode(),d.setCacheTrain(g),e(this).dialog("close")}),e("<div></div>").dialog(t).dialog("open")}function handlerParams(e,t,n){var i=e.params.input_columns&&JSON.parse(e.params.input_columns),r=e.params.output_column;if(i&&0!==i.length&&r){n.operators.forEach(function(e){"zaipInput"==e.type&&(e.params=d.hanlderInputData(n))});var o=[],a=n.operators.filter(function(e){return"zaipInput"==e.type})[0].params,s=n.operators.filter(function(e){return"zaipOutput"==e.type})[0].params.colname;r!==s&&(n.operators.forEach(function(e){"zaipOutput"==e.type&&(e.params=c.ZAIP_OUTPUT_PARAM,e.params.colname=r)}),d.getCacheTrain(g).operators.forEach(function(e){"zaipOutput"==e.type&&(e.params=c.ZAIP_OUTPUT_PARAM,e.params.colname=r)}));for(var l in a)o.push(l);return o.sort().toString()===i.sort().toString()||(n.operators.forEach(function(e){"zaipInput"==e.type&&(e.params=d.getZaipInputInitParams(i))}),d.getCacheTrain(g).operators.forEach(function(e){"zaipInput"==e.type&&(e.params=d.getZaipInputServerParams(d.getZaipInputInitParams(i)))})),n}}function save(e,t,n,i,r){var o={};o.isNew=r.value.isDrag,o.processName=i,o.opName=e.name,o.connectId=t.params.zaip_id,o.initName=r.value.initName;var a=n&&JSON.stringify(n);o.zaipData=a;var s=t.params.zaip_id+i+r.value.initName,l=d.getCacheTrain(s)&&JSON.parse(JSON.stringify(d.getCacheTrain(s)));if(l){var c=handlerParams(e,t,l);o.content=JSON.stringify(c)||{}}return o}function setEditMode(t){t||s.success(""+e.i18n.prop("ict_zaip_edit_mode"),"",r.toastrConfig),e("#zaip-mode").html(""),d.setEditable(!0),e("#noedit").remove(),e("#train-run").show(),e("#zaip-edit").hide()}function setWatchMode(){s.success(e.i18n.prop("ict_zaip_view_mode")+":"+P,"",r.toastrConfig),e("#zaip-mode").html("("+e.i18n.prop("ict_zaip_view_mode")+":"+P+")"),d.setEditable(!1);e("#visual-properties .form-vertical").append('<div id="noedit" style="position:absolute;top:0;left:0;width:100%;height:100%;"></div>'),e("#zaip-edit").show(),e("#train-run").hide()}function closeWin(){autoReload(!1),w&&w.popupMenuHandler.div.remove(),d.getEditable()&&d.setCacheTrain(g),setEditMode(!0),r.removeParametersInput(),e("#zaip-mode").html(""),h.clearZaipBackground(),k()}function resetProcess(e){!d.getLoadingStatus()&&d.setLoadingStatus(!0),h.clear(),h.setModelUpdate(!0),t.isEmpty(e.groups)||e.groups.forEach(function(e){h.insertOperator(e)}),t.isEmpty(e.operators)||e.operators.forEach(function(e){h.insertOperator(e)}),t.isEmpty(e.connects)||e.connects.forEach(function(e){h.insertConnect(e)}),h.setModelUpdate(!1),w.selectCells(),u.selectionChanged(!1);var n=t.has(e,"scale")?e.scale:1;w.getView().setScale(n);var i=0,r=0;if(t.has(e,"translate")){var o=JSON.parse(e.translate);i=o.x,r=o.y}w.getView().setTranslate(i,r),d.setLoadingStatus(!1),d.setParams(e.params),d.updateData()}function initZaipOp(){var t=e("#visual-graph").height(),n=e("#visual-graph").width(),i=Math.max(.8*t,300),r=Math.max(.8*n,600);resetProcess({params:{},operators:[{name:"zaipInput",type:"zaipInput",id:"2",parent:"",x:10,y:10,params:d.getZaipInputInitParams()},{name:"zaipOutput",type:"zaipOutput",id:"3",parent:"",x:r-200,y:i+60,params:d.getZaipOutputInitParams()}],connects:[],groups:[{name:"",type:"zaipBackground",id:"1",parent:"",x:10,y:50,params:{},width:r,height:i,children:[]}],scale:1,translate:'{"x":0,"y":0}'})}function loadProcess(e){var n=e||d.getProcessName(),i=d.getOpName(),o=d.getExperimentFlag()?r.genApiUrl("task/query?id="+n+"&processName="+d.getProcessName()+"&opName="+i+"&connectId="+d.getZaipId()):r.genApiUrl("task/query?processName="+n+"&opName="+i+"&isTemplate=true"),s=function(n){n&&n.hasOwnProperty("content")&&!t.isEmpty(n.content)?resetProcess(n.content):initZaipOp(),!e&&d.setCacheTrain(g)};a.get(o,"",s,C)}function getCacheTrain(e){return d.getCacheTrain(e)}function setCacheTrain(e,t){d.setCacheTrain(e,t)}function loadProcessForOut(e,n,i,o,s){var l=s?r.genApiUrl("task/query?id="+e+"&processName="+e+"&opName="+n+"&connectId="+o):r.genApiUrl("task/query?processName="+e+"&opName="+n+"&isTemplate=true"),c=function(e){if(e&&e.hasOwnProperty("content")&&!t.isEmpty(e.content)){var n=e.content,r=n.operators.filter(function(e){return"zaipInput"==e.type})[0].params;n.operators.forEach(function(e){"zaipInput"==e.type&&(e.params=d.getZaipInputServerParams(r))}),d.setCacheTrain(i,n)}};a.get(l,"",c,C)}function init(t,n,i,r,o,a,s,l){setTimeout(function(){g=n+i+t,d.setOpName(t),d.setZaipId(n),d.setProcessName(i),d.setInputcol(r),d.setOutputcol(o),d.setZaipData(a),d.setExperimentFlag(s),d.setIsDrag(l),resizeTabLayout(),_=new p("#visual-operator-tree","#visual-op-tree-div","#visual-opSearch",d,h),d.getExperimentFlag()?e("#train-run").show():e("#train-run").hide(),_.init();var c=d.getCacheTrain(g)&&JSON.parse(JSON.stringify(d.getCacheTrain(g)));s&&getTrainTable(),c?(c.operators.forEach(function(e){"zaipInput"==e.type&&(e.params=d.hanlderInputData(c))}),resetProcess(c)):initZaipOp()},5),d.setLoadingStatus(!0),h.clear(),e("#visual-log-content").empty(),k(),closeEastPanel(),closeSouthPanel()}function resizeTabLayout(){var t=e("#visual");(t.jquery?t:e(t.newPanel||t.panel)).filter(":visible").find(".ui-layout-container:visible").andSelf().each(function(){var t=e(this).data("layout");t&&(t.options.resizeWithWindow=!1,t.resizeAll())})}function getProcess(e,t){var t=t||0,e=e.toLowerCase();return"done"==e&&(t="100"),'<div class="train-process-box clearfix">\n                    <div class="train-process-bg pull-left">\n                        <div class="train-process-line process-'+e+'" style="width:'+t+'%"></div>\n                    </div>\n                    <div class="train-process-number pull-left">'+t+"%</div>\n                    </div>"}function getBtn(t){var n="";switch(t){case"QUEUED":case"RUNNING":n='<span class="fa fa-fw fa-stop stop-train" title='+e.i18n.prop("ict_oneminer_experiment_status_stop")+'></span>\n                    <span class="fa fa-fw fa-caret-square-o-right runtrain" style="display:none" title='+e.i18n.prop("ict_oneminer_process_toolbar_tooltip_run")+"></span>";break;case"DONE":case"FAILED":case"CANCELLED":n=""}return"<div>"+n+'<span class="fa fa-fw fa fa-trash-o del-train" title='+e.i18n.prop("ict_oneminer_dialog_delete")+'></span>\n        <span class="fa fa-fw fa-bar-chart resultMsg" title='+e.i18n.prop("ict_oneminer_dialog_title_resultinfo")+'></span>\n        <span class="fa fa-fw fa-file-text" title='+e.i18n.prop("ict_oneminer_popup_menu_showlog")+"></span></div>"}function getTrainTable(){var t=[{targets:[0],width:"90px"},{targets:[1,2],width:"15%"},{targets:[3],width:"10%"},{targets:[4],width:"10%"},{targets:[5],width:"10%"},{targets:[7],width:"10%"}],n=e("#visual-log-content"),i=e("<table/>",{class:"table table-bordered dataTable",id:"train-table"});n.append(i);var o=(e("#train-table"),r.genApiUrl("task/list?processName="+d.getProcessName()+"&opName="+d.getOpName())),s=function(n){var o=[];n&&n.data&&!d.isDrag()&&n.data.forEach(function(t){var n=['<a class="train-num" train-id='+t.id+" train-instanceid="+t.instanceid+">"+t.name+"</a>",t.createtime,t.starttime,t.runtime,e.i18n.prop("Zaip_"+t.status.toLowerCase()),getProcess(t.status,t.process),'<input type="text" class="des-input" dec-title='+t.desc+" value="+t.desc+' placeholder="'+e.i18n.prop("ict_zaip_set_description")+'"/> ',getBtn(t.status)];o.push(n)});var a=[{title:e.i18n.prop("ict_oneminer_zaip_train_number")},{title:e.i18n.prop("ict_oneminer_zaip_train_createtime")},{title:e.i18n.prop("ict_oneminer_zaip_train_starttime")},{title:e.i18n.prop("ict_oneminer_zaip_train_runtime")},{title:e.i18n.prop("ict_oneminer_table_head_experiment_status")},{title:e.i18n.prop("ict_oneminer_zaip_train_process")},{title:e.i18n.prop("ict_oneminer_zaip_train_dec")},{title:e.i18n.prop("ict_oneminer_zaip_train_set")}];i.DataTable({language:r.getDatatableLanguage(),dom:'<"search" f>rt<"diyTableBottom" ipl>',autoWidth:!1,deferRender:!0,data:o,paging:!1,ordering:!1,info:!1,searching:!0,columnDefs:t,columns:a}),r.doNiceScroll("#visual-log-content"),addTrainTableListener(),d.getExperimentFlag()&&autoReload(!0)};a.get(o,"",s,C)}function refreshTable(){var t=r.genApiUrl("task/list?processName="+d.getProcessName()+"&opName="+d.getOpName()),n=function(t){var n=t.data;n&&(y=e("#train-table").dataTable(),oSettings=y.fnSettings(),y.fnClearTable(this),n.forEach(function(t){var n=['<a class="train-num" train-id='+t.id+" train-instanceid="+t.instanceid+">"+t.name+"</a>",t.createtime,t.starttime,t.runtime,e.i18n.prop("Zaip_"+t.status.toLowerCase()),getProcess(t.status,t.process),'<input type="text" class="des-input" dec-title='+t.desc+" value="+t.desc+' placeholder="'+e.i18n.prop("ict_zaip_set_description")+'"/> ',getBtn(t.status)];y.oApi._fnAddData(oSettings,n)}),oSettings.aiDisplay=oSettings.aiDisplayMaster.slice(),y.fnDraw())};a.get(t,"",n,C)}function autoReload(e){e&&!d.isDrag()?x=setInterval(function(){refreshTable()},c.SETTIMEOUT_TIME):clearInterval(x)}function trainTableTrClickListener(){e(document).off("click","#train-table .train-num"),e(document).on("click","#train-table .train-num",function(t){var n=e(this).attr("train-id");P=e(this).html(),d.getEditable()&&d.setCacheTrain(g),setWatchMode(),loadProcess(n)})}function setDec(){e(document).off("blur","#train-table .des-input"),e(document).on("blur","#train-table .des-input",function(){var t=e(this),n=e(this).prop("dec-title")||"",i=e(this).val()||"";if(n!==i){if(!M())return e(this).val(n),s.warning(e.i18n.prop("OP_EDIT_NOT"),"",r.toastrConfig);var o=e(this).parents("tr").find(".train-num").attr("train-id"),l={processName:d.getProcessName(),desc:i,id:o,opName:d.getOpName()},c=function(n){n?(s.success(e.i18n.prop("ict_zaip_add_dec_success"),"",r.toastrConfig),t.prop("dec-title",i)):s.error(e.i18n.prop("ict_zaip_add_dec_failed"))},u=function(e){s.info(e,"ajax error",r.toastrConfig)};a.post(r.genApiUrl("task/update/instance"),l,c,u)}})}function delExpConfirmHandler(t,n){var i=t,o=t.data("info").url,l=t.data("info").data,c=(t.data("info").id,function(t){if(!0===t){(0,i.data("info").callback)(),s.success(e.i18n.prop("ict_oneminer_message_delete_success"),"",r.toastrConfig)}i.dialog("close")}),u=function(e){n.parents("tr").removeClass("zaip-select"),s.info(e,"ajax error",r.toastrConfig)};a.del(o,l,c,u)}function delTrain(t,n,i,o){e(document).off("click",t+" .del-train"),e(document).on("click",t+" .del-train",function(){if(!M())return s.warning(e.i18n.prop("OP_EDIT_NOT"),"",r.toastrConfig);var a=e(this);a.parents("tr").addClass("zaip-select");var l=e(this).parents("tr").find(".train-num").attr("train-id"),c=e(this).parents("tr").find(".train-num").html(),u=r.genApiUrl("task/instance"),h={connectId:n||d.getZaipId(),id:l,processName:i||d.getProcessName(),opName:o||d.getOpName()},p=e.i18n.prop("ict_oneminer_dialog_del_confirm").replace("*",c),f=new r.Dialog(400,"auto",p);f.setConfirmHandler(function(){delExpConfirmHandler(e(this),a)}),e("<div></div>").dialog(f).data("info",{url:u,data:h,id:l,callback:function(){if(e(t).DataTable().row(".zaip-select").remove().draw(!1),"#train-table"===t&&!d.getEditable()&&c===P){setEditMode();var n=JSON.parse(JSON.stringify(d.getCacheTrain(g)));n.operators.forEach(function(e){"zaipInput"==e.type&&(e.params=d.hanlderInputData(n))}),resetProcess(n)}}}).dialog("open")})}function stopTrain(t,n,i,o){e(document).off("click",t),e(document).on("click",t,function(){var t=e(this),l=e(this).parents("tr").find(".train-num").attr("train-id"),c=r.genApiUrl("task/instance/stop"),u={connectId:n||d.getZaipId(),id:l,processName:i||d.getProcessName(),opName:o||d.getOpName()},h=function(n){!0===n&&(t.hide(),t.parents("tr").find(".train-process-line").removeClass("process-running").addClass("process-cancelled"),t.parents("tr").find(".train-status")&&t.parents("tr").find(".train-status").html(e.i18n.prop("Zaip_cancelled")))},p=function(e){s.info(e,"ajax error",r.toastrConfig)};a.post(c,u,h,p)})}function getResultMsgTable(){e(document).off("click","#train-table .resultMsg"),e(document).on("click","#train-table .resultMsg",function(){var t=r.getZaipConfig(d.getZaipId()).webSocketUrl,n=e(this).parents("tr").find(".train-num").attr("train-instanceid");t&&f.createDialog(t,n)})}function addTrainTableListener(){e("#train-table").hover(function(){autoReload(!1)},function(){autoReload(!0)}),trainTableTrClickListener(),setDec(),delTrain("#train-table"),stopTrain("#train-table .stop-train"),getResultMsgTable()}var g,m,v,_,y,x,b=e("#visual"),w=null,C=function(e){s.info(e,"ajax error",r.toastrConfig)},S=function(){loadProcess()},T=function(){},A=function(e){T=e},M=function(){},E=function(e){M=e},I=function(){var e=refreshTable;d.setIsDrag(!1),d.setCacheTrain(g),L(c.EXEC_TYPE_CURRENT,d.getOpName(),e,S),openSouthPanel()},D=t.throttle(I,1e3),k=function(){var e=b.is(":hidden");e&&b.show();var t="animated "+(e?"bounceIn":"bounceOut");b.addClass(t),setTimeout(function(){e||b.hide(),b.removeClass(t)},500)},L=function(){},N=function(e){L=e},P="";return{initContainer:initContainer,init:init,save:save,loadProcessForOut:loadProcessForOut,getProcess:getProcess,getBtn:getBtn,stopTrain:stopTrain,delTrain:delTrain,getCacheTrain:getCacheTrain,setCacheTrain:setCacheTrain,clearCacheTrain:function(e){d.clearCacheTrain(e)},handlerParams:handlerParams,delCallBack:function(){h.delCallBack()}}}.apply(t,i))&&(e.exports=r)},function(e,t,n){!function(e){e(n(9))}(function(e){"use strict";function Completion(e,t){this.cm=e,this.options=t,this.widget=null,this.debounce=0,this.tick=0,this.startPos=this.cm.getCursor("start"),this.startLen=this.cm.getLine(this.startPos.line).length-this.cm.getSelection().length;var n=this;e.on("cursorActivity",this.activityFunc=function(){n.cursorActivity()})}function isNewCompletion(t,n){return e.cmpPos(n.from,t.from)>0&&t.to.ch-t.from.ch!=n.to.ch-n.from.ch}function parseOptions(e,t,n){var i=e.options.hintOptions,r={};for(var a in o)r[a]=o[a];if(i)for(var a in i)void 0!==i[a]&&(r[a]=i[a]);if(n)for(var a in n)void 0!==n[a]&&(r[a]=n[a]);return r.hint.resolve&&(r.hint=r.hint.resolve(e,t)),r}function getText(e){return"string"==typeof e?e:e.text}function buildKeyMap(e,t){function addBinding(e,i){var o;o="string"!=typeof i?function(e){return i(e,t)}:n.hasOwnProperty(i)?n[i]:i,r[e]=o}var n={Up:function(){t.moveFocus(-1)},Down:function(){t.moveFocus(1)},PageUp:function(){t.moveFocus(1-t.menuSize(),!0)},PageDown:function(){t.moveFocus(t.menuSize()-1,!0)},Home:function(){t.setFocus(0)},End:function(){t.setFocus(t.length-1)},Enter:t.pick,Tab:t.pick,Esc:t.close},i=e.options.customKeys,r=i?{}:n;if(i)for(var o in i)i.hasOwnProperty(o)&&addBinding(o,i[o]);var a=e.options.extraKeys;if(a)for(var o in a)a.hasOwnProperty(o)&&addBinding(o,a[o]);return r}function getHintElement(e,t){for(;t&&t!=e;){if("LI"===t.nodeName.toUpperCase()&&t.parentNode==e)return t;t=t.parentNode}}function Widget(i,r){this.completion=i,this.data=r,this.picked=!1;var o=this,a=i.cm,s=this.hints=document.createElement("ul");s.className="CodeMirror-hints",this.selectedHint=r.selectedHint||0;for(var l=r.list,c=0;c<l.length;++c){var u=s.appendChild(document.createElement("li")),d=l[c],h=t+(c!=this.selectedHint?"":" "+n);null!=d.className&&(h=d.className+" "+h),u.className=h,d.render?d.render(u,r,d):u.appendChild(document.createTextNode(d.displayText||getText(d))),u.hintId=c}var p=a.cursorCoords(i.options.alignWithWord?r.from:null),f=p.left,g=p.bottom,m=!0;s.style.left=f+"px",s.style.top=g+"px";var v=window.innerWidth||Math.max(document.body.offsetWidth,document.documentElement.offsetWidth),_=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight);(i.options.container||document.body).appendChild(s);var y=s.getBoundingClientRect(),x=y.bottom-_,b=s.scrollHeight>s.clientHeight+1,w=a.getScrollInfo();if(x>0){var C=y.bottom-y.top;if(p.top-(p.bottom-y.top)-C>0)s.style.top=(g=p.top-C)+"px",m=!1;else if(C>_){s.style.height=_-5+"px",s.style.top=(g=p.bottom-y.top)+"px";var S=a.getCursor();r.from.ch!=S.ch&&(p=a.cursorCoords(S),s.style.left=(f=p.left)+"px",y=s.getBoundingClientRect())}}var T=y.right-v;if(T>0&&(y.right-y.left>v&&(s.style.width=v-5+"px",T-=y.right-y.left-v),s.style.left=(f=p.left-T)+"px"),b)for(var A=s.firstChild;A;A=A.nextSibling)A.style.paddingRight=a.display.nativeBarWidth+"px";if(a.addKeyMap(this.keyMap=buildKeyMap(i,{moveFocus:function(e,t){o.changeActive(o.selectedHint+e,t)},setFocus:function(e){o.changeActive(e)},menuSize:function(){return o.screenAmount()},length:l.length,close:function(){i.close()},pick:function(){o.pick()},data:r})),i.options.closeOnUnfocus){var M;a.on("blur",this.onBlur=function(){M=setTimeout(function(){i.close()},100)}),a.on("focus",this.onFocus=function(){clearTimeout(M)})}return a.on("scroll",this.onScroll=function(){var e=a.getScrollInfo(),t=a.getWrapperElement().getBoundingClientRect(),n=g+w.top-e.top,r=n-(window.pageYOffset||(document.documentElement||document.body).scrollTop);if(m||(r+=s.offsetHeight),r<=t.top||r>=t.bottom)return i.close();s.style.top=n+"px",s.style.left=f+w.left-e.left+"px"}),e.on(s,"dblclick",function(e){var t=getHintElement(s,e.target||e.srcElement);t&&null!=t.hintId&&(o.changeActive(t.hintId),o.pick())}),e.on(s,"click",function(e){var t=getHintElement(s,e.target||e.srcElement);t&&null!=t.hintId&&(o.changeActive(t.hintId),i.options.completeOnSingleClick&&o.pick())}),e.on(s,"mousedown",function(){setTimeout(function(){a.focus()},20)}),e.signal(r,"select",l[0],s.firstChild),!0}function applicableHelpers(e,t){if(!e.somethingSelected())return t;for(var n=[],i=0;i<t.length;i++)t[i].supportsSelection&&n.push(t[i]);return n}function fetchHints(e,t,n,i){if(e.async)e(t,i,n);else{var r=e(t,n);r&&r.then?r.then(i):i(r)}}function resolveAutoHints(t,n){var i,r=t.getHelpers(n,"hint");if(r.length){var o=function(e,t,n){function run(r){if(r==i.length)return t(null);fetchHints(i[r],e,n,function(e){e&&e.list.length>0?t(e):run(r+1)})}var i=applicableHelpers(e,r);run(0)};return o.async=!0,o.supportsSelection=!0,o}return(i=t.getHelper(t.getCursor(),"hintWords"))?function(t){return e.hint.fromList(t,{words:i})}:e.hint.anyword?function(t,n){return e.hint.anyword(t,n)}:function(){}}var t="CodeMirror-hint",n="CodeMirror-hint-active";e.showHint=function(e,t,n){if(!t)return e.showHint(n);n&&n.async&&(t.async=!0);var i={hint:t};if(n)for(var r in n)i[r]=n[r];return e.showHint(i)},e.defineExtension("showHint",function(t){t=parseOptions(this,this.getCursor("start"),t);var n=this.listSelections();if(!(n.length>1)){if(this.somethingSelected()){if(!t.hint.supportsSelection)return;for(var i=0;i<n.length;i++)if(n[i].head.line!=n[i].anchor.line)return}this.state.completionActive&&this.state.completionActive.close();var r=this.state.completionActive=new Completion(this,t);r.options.hint&&(e.signal(this,"startCompletion",this),r.update(!0))}});var i=window.requestAnimationFrame||function(e){return setTimeout(e,1e3/60)},r=window.cancelAnimationFrame||clearTimeout;Completion.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.tick=null,this.cm.off("cursorActivity",this.activityFunc),this.widget&&this.data&&e.signal(this.data,"close"),this.widget&&this.widget.close(),e.signal(this.cm,"endCompletion",this.cm))},active:function(){return this.cm.state.completionActive==this},pick:function(t,n){var i=t.list[n];i.hint?i.hint(this.cm,t,i):this.cm.replaceRange(getText(i),i.from||t.from,i.to||t.to,"complete"),e.signal(t,"pick",i),this.close()},cursorActivity:function(){this.debounce&&(r(this.debounce),this.debounce=0);var e=this.cm.getCursor(),t=this.cm.getLine(e.line);if(e.line!=this.startPos.line||t.length-e.ch!=this.startLen-this.startPos.ch||e.ch<this.startPos.ch||this.cm.somethingSelected()||e.ch&&this.options.closeCharacters.test(t.charAt(e.ch-1)))this.close();else{var n=this;this.debounce=i(function(){n.update()}),this.widget&&this.widget.disable()}},update:function(e){if(null!=this.tick){var t=this,n=++this.tick;fetchHints(this.options.hint,this.cm,this.options,function(i){t.tick==n&&t.finishUpdate(i,e)})}},finishUpdate:function(t,n){this.data&&e.signal(this.data,"update");var i=this.widget&&this.widget.picked||n&&this.options.completeSingle;this.widget&&this.widget.close(),t&&this.data&&isNewCompletion(this.data,t)||(this.data=t,t&&t.list.length&&(i&&1==t.list.length?this.pick(t,0):(this.widget=new Widget(this,t),e.signal(t,"shown"))))}},Widget.prototype={close:function(){if(this.completion.widget==this){this.completion.widget=null,this.hints.parentNode.removeChild(this.hints),this.completion.cm.removeKeyMap(this.keyMap);var e=this.completion.cm;this.completion.options.closeOnUnfocus&&(e.off("blur",this.onBlur),e.off("focus",this.onFocus)),e.off("scroll",this.onScroll)}},disable:function(){this.completion.cm.removeKeyMap(this.keyMap);var e=this;this.keyMap={Enter:function(){e.picked=!0}},this.completion.cm.addKeyMap(this.keyMap)},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(t,i){if(t>=this.data.list.length?t=i?this.data.list.length-1:0:t<0&&(t=i?0:this.data.list.length-1),this.selectedHint!=t){var r=this.hints.childNodes[this.selectedHint];r.className=r.className.replace(" "+n,""),r=this.hints.childNodes[this.selectedHint=t],r.className+=" "+n,r.offsetTop<this.hints.scrollTop?this.hints.scrollTop=r.offsetTop-3:r.offsetTop+r.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=r.offsetTop+r.offsetHeight-this.hints.clientHeight+3),e.signal(this.data,"select",this.data.list[this.selectedHint],r)}},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1}},e.registerHelper("hint","auto",{resolve:resolveAutoHints}),e.registerHelper("hint","fromList",function(t,n){var i=t.getCursor(),r=t.getTokenAt(i),o=e.Pos(i.line,r.end);if(r.string&&/\w/.test(r.string[r.string.length-1]))var a=r.string,s=e.Pos(i.line,r.start);else var a="",s=o;for(var l=[],c=0;c<n.words.length;c++){var u=n.words[c];u.slice(0,a.length)==a&&l.push(u)}if(l.length)return{list:l,from:s,to:o}}),e.commands.autocomplete=e.showHint;var o={hint:e.hint.auto,completeSingle:!0,alignWithWord:!0,closeCharacters:/[\s()\[\]{};:>,]/,closeOnUnfocus:!0,completeOnSingleClick:!0,container:null,customKeys:null,extraKeys:null};e.defineOption("hintOptions",null)})},function(e,t,n){!function(e){e(n(9),n(30))}(function(e){"use strict";function isArray(e){return"[object Array]"==Object.prototype.toString.call(e)}function getKeywords(t){var n=t.doc.modeOption;return"sql"===n&&(n="text/x-sql"),e.resolveMode(n).keywords}function getIdentifierQuote(t){var n=t.doc.modeOption;return"sql"===n&&(n="text/x-sql"),e.resolveMode(n).identifierQuote||"`"}function getText(e){return"string"==typeof e?e:e.text}function wrapTable(e,t){return isArray(t)&&(t={columns:t}),t.text||(t.text=e),t}function parseTables(e){var t={};if(isArray(e))for(var n=e.length-1;n>=0;n--){var i=e[n];t[getText(i).toUpperCase()]=wrapTable(getText(i),i)}else if(e)for(var r in e)t[r.toUpperCase()]=wrapTable(r,e[r]);return t}function getTable(e){return t[e.toUpperCase()]}function shallowClone(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function match(e,t){var n=e.length,i=getText(t).substr(0,n);return e.toUpperCase()===i.toUpperCase()}function addMatches(e,t,n,i){if(isArray(n))for(var r=0;r<n.length;r++)match(t,n[r])&&e.push(i(n[r]));else for(var o in n)if(n.hasOwnProperty(o)){var a=n[o];a=a&&!0!==a?a.displayText?{text:a.text,displayText:a.displayText}:a.text:o,match(t,a)&&e.push(i(a))}}function cleanName(e){"."==e.charAt(0)&&(e=e.substr(1));for(var t=e.split(r+r),n=0;n<t.length;n++)t[n]=t[n].replace(new RegExp(r,"g"),"");return t.join(r)}function insertIdentifierQuotes(e){for(var t=getText(e).split("."),n=0;n<t.length;n++)t[n]=r+t[n].replace(new RegExp(r,"g"),r+r)+r;var i=t.join(".");return"string"==typeof e?i:(e=shallowClone(e),e.text=i,e)}function nameCompletion(e,i,o,s){for(var l=!1,c=[],u=i.start,d=!0;d;)d="."==i.string.charAt(0),l=l||i.string.charAt(0)==r,u=i.start,c.unshift(cleanName(i.string)),i=s.getTokenAt(a(e.line,i.start)),"."==i.string&&(d=!0,i=s.getTokenAt(a(e.line,i.start)));var h=c.join(".");addMatches(o,h,t,function(e){return l?insertIdentifierQuotes(e):e}),addMatches(o,h,n,function(e){return l?insertIdentifierQuotes(e):e}),h=c.pop();var p=c.join("."),f=!1,g=p;if(!getTable(p)){var m=p;p=findTableByAlias(p,s),p!==m&&(f=!0)}var v=getTable(p);return v&&v.columns&&(v=v.columns),v&&addMatches(o,h,v,function(e){var t=p;return 1==f&&(t=g),"string"==typeof e?e=t+"."+e:(e=shallowClone(e),e.text=t+"."+e.text),l?insertIdentifierQuotes(e):e}),u}function eachWord(e,t){for(var n=e.split(/\s+/),i=0;i<n.length;i++)n[i]&&t(n[i].replace(/[,;]/g,""))}function findTableByAlias(e,t){for(var n=t.doc,i=n.getValue(),r=e.toUpperCase(),l="",c="",u=[],d={start:a(0,0),end:a(t.lastLine(),t.getLineHandle(t.lastLine()).length)},h=i.indexOf(o.QUERY_DIV);-1!=h;)u.push(n.posFromIndex(h)),h=i.indexOf(o.QUERY_DIV,h+1);u.unshift(a(0,0)),u.push(a(t.lastLine(),t.getLineHandle(t.lastLine()).text.length));for(var p=null,f=t.getCursor(),g=0;g<u.length;g++){if((null==p||s(f,p)>0)&&s(f,u[g])<=0){d={start:p,end:u[g]};break}p=u[g]}for(var m=n.getRange(d.start,d.end,!1),g=0;g<m.length;g++){if(eachWord(m[g],function(e){var t=e.toUpperCase();t===r&&getTable(l)&&(c=l),t!==o.ALIAS_KEYWORD&&(l=e)}),c)break}return c}var t,n,i,r,o={QUERY_DIV:";",ALIAS_KEYWORD:"AS"},a=e.Pos,s=e.cmpPos;e.registerHelper("hint","sql",function(e,o){t=parseTables(o&&o.tables);var s=o&&o.defaultTable,l=o&&o.disableKeywords;n=s&&getTable(s),i=getKeywords(e),r=getIdentifierQuote(e),s&&!n&&(n=findTableByAlias(s,e)),n=n||[],n.columns&&(n=n.columns);var c,u,d,h=e.getCursor(),p=[],f=e.getTokenAt(h);return f.end>h.ch&&(f.end=h.ch,f.string=f.string.slice(0,h.ch-f.start)),f.string.match(/^[.`"\w@]\w*$/)?(d=f.string,c=f.start,u=f.end):(c=u=h.ch,d=""),"."==d.charAt(0)||d.charAt(0)==r?c=nameCompletion(h,f,p,e):(addMatches(p,d,t,function(e){return e}),addMatches(p,d,n,function(e){return e}),l||addMatches(p,d,i,function(e){return e.toUpperCase()})),{list:p,from:a(h.line,c),to:a(h.line,u)}})})},function(e,t,n){!function(e){e(n(9))}(function(e){"use strict";function wordRegexp(e){return new RegExp("^(("+e.join(")|(")+"))\\b")}function top(e){return e.scopes[e.scopes.length-1]}var t=wordRegexp(["and","or","not","is"]),n=["as","assert","break","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","lambda","pass","raise","return","try","while","with","yield","in"],i=["abs","all","any","bin","bool","bytearray","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip","__import__","NotImplemented","Ellipsis","__debug__"];e.registerHelper("hintWords","python",n.concat(i)),e.defineMode("python",function(r,o){function tokenBase(e,t){if(e.sol()&&(t.indent=e.indentation()),e.sol()&&"py"==top(t).type){var n=top(t).offset;if(e.eatSpace()){var i=e.indentation();return i>n?pushPyScope(t):i<n&&dedent(e,t)&&"#"!=e.peek()&&(t.errorToken=!0),null}var r=tokenBaseInner(e,t);return n>0&&dedent(e,t)&&(r+=" "+a),r}return tokenBaseInner(e,t)}function tokenBaseInner(e,n){if(e.eatSpace())return null;if("#"==e.peek())return e.skipToEnd(),"comment";if(e.match(/^[0-9\.]/,!1)){var i=!1;if(e.match(/^[\d_]*\.\d+(e[\+\-]?\d+)?/i)&&(i=!0),e.match(/^[\d_]+\.\d*/)&&(i=!0),e.match(/^\.\d+/)&&(i=!0),i)return e.eat(/J/i),"number";var r=!1;if(e.match(/^0x[0-9a-f_]+/i)&&(r=!0),e.match(/^0b[01_]+/i)&&(r=!0),e.match(/^0o[0-7_]+/i)&&(r=!0),e.match(/^[1-9][\d_]*(e[\+\-]?[\d_]+)?/)&&(e.eat(/J/i),r=!0),e.match(/^0(?![\dx])/i)&&(r=!0),r)return e.eat(/L/i),"number"}if(e.match(g))return n.tokenize=tokenStringFactory(e.current()),n.tokenize(e,n);for(var o=0;o<l.length;o++)if(e.match(l[o]))return"operator";return e.match(s)?"punctuation":"."==n.lastToken&&e.match(f)?"property":e.match(m)||e.match(t)?"keyword":e.match(v)?"builtin":e.match(/^(self|cls)\b/)?"variable-2":e.match(f)?"def"==n.lastToken||"class"==n.lastToken?"def":"variable":(e.next(),a)}function tokenStringFactory(e){function tokenString(i,r){for(;!i.eol();)if(i.eatWhile(/[^'"\\]/),i.eat("\\")){if(i.next(),t&&i.eol())return n}else{if(i.match(e))return r.tokenize=tokenBase,n;i.eat(/['"]/)}if(t){if(o.singleLineStringErrors)return a;r.tokenize=tokenBase}return n}for(;"rubf".indexOf(e.charAt(0).toLowerCase())>=0;)e=e.substr(1);var t=1==e.length,n="string";return tokenString.isString=!0,tokenString}function pushPyScope(e){for(;"py"!=top(e).type;)e.scopes.pop();e.scopes.push({offset:top(e).offset+r.indentUnit,type:"py",align:null})}function pushBracketScope(e,t,n){var i=e.match(/^([\s\[\{\(]|#.*)*$/,!1)?null:e.column()+1;t.scopes.push({offset:t.indent+u,type:n,align:i})}function dedent(e,t){for(var n=e.indentation();t.scopes.length>1&&top(t).offset>n;){if("py"!=top(t).type)return!0;t.scopes.pop()}return top(t).offset!=n}function tokenLexer(e,t){e.sol()&&(t.beginningOfLine=!0);var n=t.tokenize(e,t),i=e.current();if(t.beginningOfLine&&"@"==i)return e.match(f,!1)?"meta":p?"operator":a;/\S/.test(i)&&(t.beginningOfLine=!1),"variable"!=n&&"builtin"!=n||"meta"!=t.lastToken||(n="meta"),"pass"!=i&&"return"!=i||(t.dedent+=1),"lambda"==i&&(t.lambda=!0),":"!=i||t.lambda||"py"!=top(t).type||pushPyScope(t);var r=1==i.length?"[({".indexOf(i):-1;if(-1!=r&&pushBracketScope(e,t,"])}".slice(r,r+1)),-1!=(r="])}".indexOf(i))){if(top(t).type!=i)return a;t.indent=t.scopes.pop().offset-u}return t.dedent>0&&e.eol()&&"py"==top(t).type&&(t.scopes.length>1&&t.scopes.pop(),t.dedent-=1),n}for(var a="error",s=o.delimiters||o.singleDelimiters||/^[\(\)\[\]\{\}@,:`=;\.]/,l=[o.singleOperators,o.doubleOperators,o.doubleDelimiters,o.tripleDelimiters,o.operators||/^([-+*\/%\/&|^]=?|[<>=]+|\/\/=?|\*\*=?|!=|[~!@])/],c=0;c<l.length;c++)l[c]||l.splice(c--,1);var u=o.hangingIndent||r.indentUnit,d=n,h=i;void 0!=o.extra_keywords&&(d=d.concat(o.extra_keywords)),void 0!=o.extra_builtins&&(h=h.concat(o.extra_builtins));var p=!(o.version&&Number(o.version)<3);if(p){var f=o.identifiers||/^[_A-Za-z\u00A1-\uFFFF][_A-Za-z0-9\u00A1-\uFFFF]*/;d=d.concat(["nonlocal","False","True","None","async","await"]),h=h.concat(["ascii","bytes","exec","print"]);var g=new RegExp("^(([rbuf]|(br))?('{3}|\"{3}|['\"]))","i")}else{var f=o.identifiers||/^[_A-Za-z][_A-Za-z0-9]*/;d=d.concat(["exec","print"]),h=h.concat(["apply","basestring","buffer","cmp","coerce","execfile","file","intern","long","raw_input","reduce","reload","unichr","unicode","xrange","False","True","None"]);var g=new RegExp("^(([rubf]|(ur)|(br))?('{3}|\"{3}|['\"]))","i")}var m=wordRegexp(d),v=wordRegexp(h);return{startState:function(e){return{tokenize:tokenBase,scopes:[{offset:e||0,type:"py",align:null}],indent:e||0,lastToken:null,lambda:!1,dedent:0}},token:function(e,t){var n=t.errorToken;n&&(t.errorToken=!1);var i=tokenLexer(e,t);return i&&"comment"!=i&&(t.lastToken="keyword"==i||"punctuation"==i?e.current():i),"punctuation"==i&&(i=null),e.eol()&&t.lambda&&(t.lambda=!1),n?i+" "+a:i},indent:function(t,n){if(t.tokenize!=tokenBase)return t.tokenize.isString?e.Pass:0;var i=top(t),r=i.type==n.charAt(0);return null!=i.align?i.align-(r?1:0):i.offset-(r?u:0)},electricInput:/^\s*[\}\]\)]$/,closeBrackets:{triples:"'\""},lineComment:"#",fold:"indent"}}),e.defineMIME("text/x-python","python");e.defineMIME("text/x-cython",{name:"python",extra_keywords:function(e){return e.split(" ")}("by cdef cimport cpdef ctypedef enum except extern gil include nogil property public readonly struct union DEF IF ELIF ELSE")})})},function(e,t,n){!function(t,n){e.exports=n()}(0,function(){return function(e){function __webpack_require__(n){if(t[n])return t[n].exports;var i=t[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,__webpack_require__),i.loaded=!0,i.exports}var t={};return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.p="",__webpack_require__(0)}([function(e,t,n){"use strict";e.exports=n(1)},function(e,t,n){"use strict";e.exports={color:{Color:n(2),math:n(6),interpret:n(3)},controllers:{Controller:n(7),BooleanController:n(8),OptionController:n(10),StringController:n(11),NumberController:n(12),NumberControllerBox:n(13),NumberControllerSlider:n(14),FunctionController:n(20),ColorController:n(21)},dom:{dom:n(9)},gui:{GUI:n(22)},GUI:n(22)}},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function defineRGBComponent(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space?this.__state[t]:(d.recalculateRGB(this,t,n),this.__state[t])},set:function(e){"RGB"!==this.__state.space&&(d.recalculateRGB(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function defineHSVComponent(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space?this.__state[t]:(d.recalculateHSV(this),this.__state[t])},set:function(e){"HSV"!==this.__state.space&&(d.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}t.__esModule=!0;var i=n(3),r=_interopRequireDefault(i),o=n(6),a=_interopRequireDefault(o),s=n(4),l=_interopRequireDefault(s),c=n(5),u=_interopRequireDefault(c),d=function(){function Color(){if(_classCallCheck(this,Color),this.__state=r.default.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return Color.prototype.toString=function(){return l.default(this)},Color.prototype.toOriginal=function(){return this.__state.conversion.write(this)},Color}();d.recalculateRGB=function(e,t,n){if("HEX"===e.__state.space)e.__state[t]=a.default.component_from_hex(e.__state.hex,n);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");u.default.extend(e.__state,a.default.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},d.recalculateHSV=function(e){var t=a.default.rgb_to_hsv(e.r,e.g,e.b);u.default.extend(e.__state,{s:t.s,v:t.v}),u.default.isNaN(t.h)?u.default.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},d.COMPONENTS=["r","g","b","h","s","v","hex","a"],defineRGBComponent(d.prototype,"r",2),defineRGBComponent(d.prototype,"g",1),defineRGBComponent(d.prototype,"b",0),defineHSVComponent(d.prototype,"h"),defineHSVComponent(d.prototype,"s"),defineHSVComponent(d.prototype,"v"),Object.defineProperty(d.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(d.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=a.default.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}}),t.default=d,e.exports=t.default},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=n(4),r=_interopRequireDefault(i),o=n(5),a=_interopRequireDefault(o),s=[{litmus:a.default.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:r.default},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:r.default},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:r.default},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:r.default}}},{litmus:a.default.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:a.default.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:a.default.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(a.default.isNumber(e.r)&&a.default.isNumber(e.g)&&a.default.isNumber(e.b)&&a.default.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(a.default.isNumber(e.r)&&a.default.isNumber(e.g)&&a.default.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(a.default.isNumber(e.h)&&a.default.isNumber(e.s)&&a.default.isNumber(e.v)&&a.default.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(a.default.isNumber(e.h)&&a.default.isNumber(e.s)&&a.default.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],l=void 0,c=void 0,u=function(){c=!1;var e=arguments.length>1?a.default.toArray(arguments):arguments[0];return a.default.each(s,function(t){if(t.litmus(e))return a.default.each(t.conversions,function(t,n){if(l=t.read(e),!1===c&&!1!==l)return c=l,l.conversionName=n,l.conversion=t,a.default.BREAK}),a.default.BREAK}),c};t.default=u,e.exports=t.default},function(e,t,n){"use strict";t.__esModule=!0;var i=n(5),r=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=function(e){if(1===e.a||r.default.isUndefined(e.a)){for(var t=e.hex.toString(16);t.length<6;)t="0"+t;return"#"+t}return"rgba("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+","+e.a+")"},e.exports=t.default},function(e,t){"use strict";t.__esModule=!0;var n=Array.prototype.forEach,i=Array.prototype.slice,r={BREAK:{},extend:function(e){return this.each(i.call(arguments,1),function(t){for(var n in t)this.isUndefined(t[n])||(e[n]=t[n])},this),e},defaults:function(e){return this.each(i.call(arguments,1),function(t){for(var n in t)this.isUndefined(e[n])&&(e[n]=t[n])},this),e},compose:function(){var e=i.call(arguments);return function(){for(var t=i.call(arguments),n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},each:function(e,t,i){if(e)if(n&&e.forEach&&e.forEach===n)e.forEach(t,i);else if(e.length===e.length+0){var r=void 0,o=void 0;for(r=0,o=e.length;r<o;r++)if(r in e&&t.call(i,e[r],r)===this.BREAK)return}else for(var r in e)if(t.call(i,e[r],r)===this.BREAK)return},defer:function(e){setTimeout(e,0)},toArray:function(e){return e.toArray?e.toArray():i.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){function isNaN(t){return e.apply(this,arguments)}return isNaN.toString=function(){return e.toString()},isNaN}(function(e){return isNaN(e)}),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}};t.default=r,e.exports=t.default},function(e,t){"use strict";t.__esModule=!0;var n=void 0,i={hsv_to_rgb:function(e,t,n){var i=Math.floor(e/60)%6,r=e/60-Math.floor(e/60),o=n*(1-t),a=n*(1-r*t),s=n*(1-(1-r)*t),l=[[n,s,o],[a,n,o],[o,n,s],[o,a,n],[s,o,n],[n,o,a]][i];return{r:255*l[0],g:255*l[1],b:255*l[2]}},rgb_to_hsv:function(e,t,n){var i=Math.min(e,t,n),r=Math.max(e,t,n),o=r-i,a=void 0,s=void 0;return 0===r?{h:NaN,s:0,v:0}:(s=o/r,a=e===r?(t-n)/o:t===r?2+(n-e)/o:4+(e-t)/o,a/=6,a<0&&(a+=1),{h:360*a,s:s,v:r/255})},rgb_to_hex:function(e,t,n){var i=this.hex_with_component(0,2,e);return i=this.hex_with_component(i,1,t),i=this.hex_with_component(i,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,i){return i<<(n=8*t)|e&~(255<<n)}};t.default=i,e.exports=t.default},function(e,t){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var n=function(){function Controller(e,t){_classCallCheck(this,Controller),this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}return Controller.prototype.onChange=function(e){return this.__onChange=e,this},Controller.prototype.onFinishChange=function(e){return this.__onFinishChange=e,this},Controller.prototype.setValue=function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this},Controller.prototype.getValue=function(){return this.object[this.property]},Controller.prototype.updateDisplay=function(){return this},Controller.prototype.isModified=function(){return this.initialValue!==this.getValue()},Controller}();t.default=n,e.exports=t.default},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=n(7),r=_interopRequireDefault(i),o=n(9),a=_interopRequireDefault(o),s=function(e){function BooleanController(t,n){function onChange(){i.setValue(!i.__prev)}_classCallCheck(this,BooleanController),e.call(this,t,n);var i=this;this.__prev=this.getValue(),this.__checkbox=document.createElement("input"),this.__checkbox.setAttribute("type","checkbox"),a.default.bind(this.__checkbox,"change",onChange,!1),this.domElement.appendChild(this.__checkbox),this.updateDisplay()}return _inherits(BooleanController,e),BooleanController.prototype.setValue=function(t){var n=e.prototype.setValue.call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n},BooleanController.prototype.updateDisplay=function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,e.prototype.updateDisplay.call(this)},BooleanController}(r.default);t.default=s,e.exports=t.default},function(e,t,n){"use strict";function cssValueToPixels(e){if("0"===e||r.default.isUndefined(e))return 0;var t=e.match(s);return r.default.isNull(t)?0:parseFloat(t[1])}t.__esModule=!0;var i=n(5),r=function(e){return e&&e.__esModule?e:{default:e}}(i),o={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},a={};r.default.each(o,function(e,t){r.default.each(e,function(e){a[e]=t})});var s=/(\d+(\.\d+)?)px/,l={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,n){var i=n,o=t;r.default.isUndefined(o)&&(o=!0),r.default.isUndefined(i)&&(i=!0),e.style.position="absolute",o&&(e.style.left=0,e.style.right=0),i&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,n,i){var o=n||{},s=a[t];if(!s)throw new Error("Event type "+t+" not supported.");var l=document.createEvent(s);switch(s){case"MouseEvents":var c=o.x||o.clientX||0,u=o.y||o.clientY||0;l.initMouseEvent(t,o.bubbles||!1,o.cancelable||!0,window,o.clickCount||1,0,0,c,u,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var d=l.initKeyboardEvent||l.initKeyEvent;r.default.defaults(o,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),d(t,o.bubbles||!1,o.cancelable,window,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.keyCode,o.charCode);break;default:l.initEvent(t,o.bubbles||!1,o.cancelable||!0)}r.default.defaults(l,i),e.dispatchEvent(l)},bind:function(e,t,n,i){var r=i||!1;return e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on"+t,n),l},unbind:function(e,t,n,i){var r=i||!1;return e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent&&e.detachEvent("on"+t,n),l},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var n=e.className.split(/ +/);-1===n.indexOf(t)&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return l},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var n=e.className.split(/ +/),i=n.indexOf(t);-1!==i&&(n.splice(i,1),e.className=n.join(" "))}else e.className=void 0;return l},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return cssValueToPixels(t["border-left-width"])+cssValueToPixels(t["border-right-width"])+cssValueToPixels(t["padding-left"])+cssValueToPixels(t["padding-right"])+cssValueToPixels(t.width)},getHeight:function(e){var t=getComputedStyle(e);return cssValueToPixels(t["border-top-width"])+cssValueToPixels(t["border-bottom-width"])+cssValueToPixels(t["padding-top"])+cssValueToPixels(t["padding-bottom"])+cssValueToPixels(t.height)},getOffset:function(e){var t=e,n={left:0,top:0};if(t.offsetParent)do{n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent}while(t);return n},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}};t.default=l,e.exports=t.default},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=n(7),r=_interopRequireDefault(i),o=n(9),a=_interopRequireDefault(o),s=n(5),l=_interopRequireDefault(s),c=function(e){function OptionController(t,n,i){_classCallCheck(this,OptionController),e.call(this,t,n);var r=i,o=this;this.__select=document.createElement("select"),l.default.isArray(r)&&function(){var e={};l.default.each(r,function(t){e[t]=t}),r=e}(),l.default.each(r,function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),o.__select.appendChild(n)}),this.updateDisplay(),a.default.bind(this.__select,"change",function(){var e=this.options[this.selectedIndex].value;o.setValue(e)}),this.domElement.appendChild(this.__select)}return _inherits(OptionController,e),OptionController.prototype.setValue=function(t){var n=e.prototype.setValue.call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n},OptionController.prototype.updateDisplay=function(){return this.__select.value=this.getValue(),e.prototype.updateDisplay.call(this)},OptionController}(r.default);t.default=c,e.exports=t.default},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=n(7),r=_interopRequireDefault(i),o=n(9),a=_interopRequireDefault(o),s=function(e){function StringController(t,n){function onChange(){i.setValue(i.__input.value)}function onBlur(){i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())}_classCallCheck(this,StringController),e.call(this,t,n);var i=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),a.default.bind(this.__input,"keyup",onChange),a.default.bind(this.__input,"change",onChange),a.default.bind(this.__input,"blur",onBlur),a.default.bind(this.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),this.updateDisplay(),this.domElement.appendChild(this.__input)}return _inherits(StringController,e),StringController.prototype.updateDisplay=function(){return a.default.isActive(this.__input)||(this.__input.value=this.getValue()),e.prototype.updateDisplay.call(this)},StringController}(r.default);t.default=s,e.exports=t.default},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function numDecimals(e){var t=e.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}t.__esModule=!0;var i=n(7),r=_interopRequireDefault(i),o=n(5),a=_interopRequireDefault(o),s=function(e){function NumberController(t,n,i){_classCallCheck(this,NumberController),e.call(this,t,n);var r=i||{};this.__min=r.min,this.__max=r.max,this.__step=r.step,a.default.isUndefined(this.__step)?0===this.initialValue?this.__impliedStep=1:this.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(this.initialValue))/Math.LN10))/10:this.__impliedStep=this.__step,this.__precision=numDecimals(this.__impliedStep)}return _inherits(NumberController,e),NumberController.prototype.setValue=function(t){var n=t;return void 0!==this.__min&&n<this.__min?n=this.__min:void 0!==this.__max&&n>this.__max&&(n=this.__max),void 0!==this.__step&&n%this.__step!=0&&(n=Math.round(n/this.__step)*this.__step),e.prototype.setValue.call(this,n)},NumberController.prototype.min=function(e){return this.__min=e,this},NumberController.prototype.max=function(e){return this.__max=e,this},NumberController.prototype.step=function(e){return this.__step=e,this.__impliedStep=e,this.__precision=numDecimals(e),this},NumberController}(r.default);t.default=s,e.exports=t.default},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function roundToDecimal(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}t.__esModule=!0;var i=n(12),r=_interopRequireDefault(i),o=n(9),a=_interopRequireDefault(o),s=n(5),l=_interopRequireDefault(s),c=function(e){function NumberControllerBox(t,n,i){function onChange(){var e=parseFloat(r.__input.value);l.default.isNaN(e)||r.setValue(e)}function onBlur(){onChange(),r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())}function onMouseDown(e){a.default.bind(window,"mousemove",onMouseDrag),a.default.bind(window,"mouseup",onMouseUp),o=e.clientY}function onMouseDrag(e){var t=o-e.clientY;r.setValue(r.getValue()+t*r.__impliedStep),o=e.clientY}function onMouseUp(){a.default.unbind(window,"mousemove",onMouseDrag),a.default.unbind(window,"mouseup",onMouseUp)}_classCallCheck(this,NumberControllerBox),e.call(this,t,n,i),this.__truncationSuspended=!1;var r=this,o=void 0;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),a.default.bind(this.__input,"change",onChange),a.default.bind(this.__input,"blur",onBlur),a.default.bind(this.__input,"mousedown",onMouseDown),a.default.bind(this.__input,"keydown",function(e){13===e.keyCode&&(r.__truncationSuspended=!0,this.blur(),r.__truncationSuspended=!1)}),this.updateDisplay(),this.domElement.appendChild(this.__input)}return _inherits(NumberControllerBox,e),NumberControllerBox.prototype.updateDisplay=function(){return this.__input.value=this.__truncationSuspended?this.getValue():roundToDecimal(this.getValue(),this.__precision),e.prototype.updateDisplay.call(this)},NumberControllerBox}(r.default);t.default=c,e.exports=t.default},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function map(e,t,n,i,r){return i+(e-t)/(n-t)*(r-i)}t.__esModule=!0;var i=n(12),r=_interopRequireDefault(i),o=n(9),a=_interopRequireDefault(o),s=n(15),l=_interopRequireDefault(s),c=n(16),u=_interopRequireDefault(c),d=function(e){function NumberControllerSlider(t,n,i,r,o){function onMouseDown(e){a.default.bind(window,"mousemove",onMouseDrag),a.default.bind(window,"mouseup",onMouseUp),onMouseDrag(e)}function onMouseDrag(e){e.preventDefault();var t=a.default.getOffset(s.__background),n=a.default.getWidth(s.__background);return s.setValue(map(e.clientX,t.left,t.left+n,s.__min,s.__max)),!1}function onMouseUp(){a.default.unbind(window,"mousemove",onMouseDrag),a.default.unbind(window,"mouseup",onMouseUp),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}_classCallCheck(this,NumberControllerSlider),e.call(this,t,n,{min:i,max:r,step:o});var s=this;this.__background=document.createElement("div"),this.__foreground=document.createElement("div"),a.default.bind(this.__background,"mousedown",onMouseDown),a.default.addClass(this.__background,"slider"),a.default.addClass(this.__foreground,"slider-fg"),this.updateDisplay(),this.__background.appendChild(this.__foreground),this.domElement.appendChild(this.__background)}return _inherits(NumberControllerSlider,e),NumberControllerSlider.prototype.updateDisplay=function(){var t=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*t+"%",e.prototype.updateDisplay.call(this)},NumberControllerSlider}(r.default);d.useDefaultStyles=function(){l.default.inject(u.default)},t.default=d,e.exports=t.default},function(e,t){"use strict";e.exports={load:function(e,t){var n=t||document,i=n.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e,n.getElementsByTagName("head")[0].appendChild(i)},inject:function(e,t){var n=t||document,i=document.createElement("style");i.type="text/css",i.innerHTML=e,n.getElementsByTagName("head")[0].appendChild(i)}}},function(e,t,n){var i=n(17);"string"==typeof i&&(i=[[e.id,i,""]]);n(19)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){t=e.exports=n(18)(),t.push([e.id,"/**\n * dat-gui JavaScript Controller Library\n * http://code.google.com/p/dat-gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n.slider {\n  box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden; }\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em; }\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border: 1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em; }\n",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},r=0;r<this.length;r++){var o=this[r][0];"number"==typeof o&&(i[o]=!0)}for(r=0;r<t.length;r++){var a=t[r];"number"==typeof a[0]&&i[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(e,t,n){function addStylesToDom(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=i[r.id];if(o){o.refs++;for(var a=0;a<o.parts.length;a++)o.parts[a](r.parts[a]);for(;a<r.parts.length;a++)o.parts.push(addStyle(r.parts[a],t))}else{for(var s=[],a=0;a<r.parts.length;a++)s.push(addStyle(r.parts[a],t));i[r.id]={id:r.id,refs:1,parts:s}}}}function listToStyles(e){for(var t=[],n={},i=0;i<e.length;i++){var r=e[i],o=r[0],a=r[1],s=r[2],l=r[3],c={css:a,media:s,sourceMap:l};n[o]?n[o].parts.push(c):t.push(n[o]={id:o,parts:[c]})}return t}function createStyleElement(){var e=document.createElement("style"),t=a();return e.type="text/css",t.appendChild(e),e}function createLinkElement(){var e=document.createElement("link"),t=a();return e.rel="stylesheet",t.appendChild(e),e}function addStyle(e,t){var n,i,r;if(t.singleton){var o=l++;n=s||(s=createStyleElement()),i=applyToSingletonTag.bind(null,n,o,!1),r=applyToSingletonTag.bind(null,n,o,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=createLinkElement(),i=updateLink.bind(null,n),r=function(){n.parentNode.removeChild(n),n.href&&URL.revokeObjectURL(n.href)}):(n=createStyleElement(),i=applyToTag.bind(null,n),r=function(){n.parentNode.removeChild(n)});return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else r()}}function applyToSingletonTag(e,t,n,i){var r=n?"":i.css;if(e.styleSheet)e.styleSheet.cssText=c(t,r);else{var o=document.createTextNode(r),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function applyToTag(e,t){var n=t.css,i=t.media;t.sourceMap;if(i&&e.setAttribute("media",i),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function updateLink(e,t){var n=t.css,i=(t.media,t.sourceMap);i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var r=new Blob([n],{type:"text/css"}),o=e.href;e.href=URL.createObjectURL(r),o&&URL.revokeObjectURL(o)}var i={},r=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}},o=r(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),a=r(function(){return document.head||document.getElementsByTagName("head")[0]}),s=null,l=0;e.exports=function(e,t){t=t||{},void 0===t.singleton&&(t.singleton=o());var n=listToStyles(e);return addStylesToDom(n,t),function(e){for(var r=[],o=0;o<n.length;o++){var a=n[o],s=i[a.id];s.refs--,r.push(s)}if(e){addStylesToDom(listToStyles(e),t)}for(var o=0;o<r.length;o++){var s=r[o];if(0===s.refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete i[s.id]}}}};var c=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=n(7),r=_interopRequireDefault(i),o=n(9),a=_interopRequireDefault(o),s=function(e){function FunctionController(t,n,i){_classCallCheck(this,FunctionController),e.call(this,t,n);var r=this;this.__button=document.createElement("div"),this.__button.innerHTML=void 0===i?"Fire":i,a.default.bind(this.__button,"click",function(e){return e.preventDefault(),r.fire(),!1}),a.default.addClass(this.__button,"button"),this.domElement.appendChild(this.__button)}return _inherits(FunctionController,e),FunctionController.prototype.fire=function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())},FunctionController}(r.default);t.default=s,e.exports=t.default},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function linearGradient(e,t,n,i){e.style.background="",h.default.each(f,function(r){e.style.cssText+="background: "+r+"linear-gradient("+t+", "+n+" 0%, "+i+" 100%); "})}function hueGradient(e){e.style.background="",e.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",e.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}t.__esModule=!0;var i=n(7),r=_interopRequireDefault(i),o=n(9),a=_interopRequireDefault(o),s=n(2),l=_interopRequireDefault(s),c=n(3),u=_interopRequireDefault(c),d=n(5),h=_interopRequireDefault(d),p=function(e){function ColorController(t,n){function fieldDown(e){setSV(e),a.default.bind(window,"mousemove",setSV),a.default.bind(window,"mouseup",unbindSV)}function unbindSV(){a.default.unbind(window,"mousemove",setSV),a.default.unbind(window,"mouseup",unbindSV)}function onBlur(){var e=u.default(this.value);!1!==e?(i.__color.__state=e,i.setValue(i.__color.toOriginal())):this.value=i.__color.toString()}function unbindH(){a.default.unbind(window,"mousemove",setH),a.default.unbind(window,"mouseup",unbindH)}function setSV(e){e.preventDefault();var t=a.default.getWidth(i.__saturation_field),n=a.default.getOffset(i.__saturation_field),r=(e.clientX-n.left+document.body.scrollLeft)/t,o=1-(e.clientY-n.top+document.body.scrollTop)/t;return o>1?o=1:o<0&&(o=0),r>1?r=1:r<0&&(r=0),i.__color.v=o,i.__color.s=r,i.setValue(i.__color.toOriginal()),!1}function setH(e){e.preventDefault();var t=a.default.getHeight(i.__hue_field),n=a.default.getOffset(i.__hue_field),r=1-(e.clientY-n.top+document.body.scrollTop)/t;return r>1?r=1:r<0&&(r=0),i.__color.h=360*r,i.setValue(i.__color.toOriginal()),!1}_classCallCheck(this,ColorController),e.call(this,t,n),this.__color=new l.default(this.getValue()),this.__temp=new l.default(0);var i=this;this.domElement=document.createElement("div"),a.default.makeSelectable(this.domElement,!1),this.__selector=document.createElement("div"),this.__selector.className="selector",this.__saturation_field=document.createElement("div"),this.__saturation_field.className="saturation-field",this.__field_knob=document.createElement("div"),this.__field_knob.className="field-knob",this.__field_knob_border="2px solid ",this.__hue_knob=document.createElement("div"),this.__hue_knob.className="hue-knob",this.__hue_field=document.createElement("div"),this.__hue_field.className="hue-field",this.__input=document.createElement("input"),this.__input.type="text",this.__input_textShadow="0 1px 1px ",a.default.bind(this.__input,"keydown",function(e){13===e.keyCode&&onBlur.call(this)}),a.default.bind(this.__input,"blur",onBlur),a.default.bind(this.__selector,"mousedown",function(){a.default.addClass(this,"drag").bind(window,"mouseup",function(){a.default.removeClass(i.__selector,"drag")})});var r=document.createElement("div");h.default.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),h.default.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),h.default.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),h.default.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),h.default.extend(r.style,{width:"100%",height:"100%",background:"none"}),linearGradient(r,"top","rgba(0,0,0,0)","#000"),h.default.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"}),hueGradient(this.__hue_field),h.default.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"}),a.default.bind(this.__saturation_field,"mousedown",fieldDown),a.default.bind(this.__field_knob,"mousedown",fieldDown),a.default.bind(this.__hue_field,"mousedown",function(e){setH(e),a.default.bind(window,"mousemove",setH),a.default.bind(window,"mouseup",unbindH)}),this.__saturation_field.appendChild(r),this.__selector.appendChild(this.__field_knob),this.__selector.appendChild(this.__saturation_field),this.__selector.appendChild(this.__hue_field),this.__hue_field.appendChild(this.__hue_knob),this.domElement.appendChild(this.__input),this.domElement.appendChild(this.__selector),this.updateDisplay()}return _inherits(ColorController,e),ColorController.prototype.updateDisplay=function(){var e=u.default(this.getValue());if(!1!==e){var t=!1;h.default.each(l.default.COMPONENTS,function(n){if(!h.default.isUndefined(e[n])&&!h.default.isUndefined(this.__color.__state[n])&&e[n]!==this.__color.__state[n])return t=!0,{}},this),t&&h.default.extend(this.__color.__state,e)}h.default.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var n=this.__color.v<.5||this.__color.s>.5?255:0,i=255-n;h.default.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+n+","+n+","+n+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,linearGradient(this.__saturation_field,"left","#fff",this.__temp.toString()),h.default.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+n+","+n+","+n+")",textShadow:this.__input_textShadow+"rgba("+i+","+i+","+i+",.7)"})},ColorController}(r.default),f=["-moz-","-o-","-webkit-","-ms-",""];t.default=p,e.exports=t.default},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function addRow(e,t,n){var i=document.createElement("li");return t&&i.appendChild(t),n?e.__ul.insertBefore(i,params.before):e.__ul.appendChild(i),e.onResize(),i}function markPresetModified(e,t){var n=e.__preset_select[e.__preset_select.selectedIndex];n.innerHTML=t?n.value+"*":n.value}function augmentController(e,t,n){if(n.__li=t,n.__gui=e,D.default.extend(n,{options:function(t){return arguments.length>1?(n.remove(),add(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[D.default.toArray(arguments)]})):D.default.isArray(t)||D.default.isObject(t)?(n.remove(),add(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[t]})):void 0},name:function(e){return n.__li.firstElementChild.firstElementChild.innerHTML=e,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof x.default)!function(){var e=new _.default(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});D.default.each(["updateDisplay","onChange","onFinishChange"],function(t){var i=n[t],r=e[t];n[t]=e[t]=function(){var t=Array.prototype.slice.call(arguments);return i.apply(n,t),r.apply(e,t)}}),E.default.addClass(t,"has-slider"),n.domElement.insertBefore(e.domElement,n.domElement.firstElementChild)}();else if(n instanceof _.default){var i=function(t){return D.default.isNumber(n.__min)&&D.default.isNumber(n.__max)?(n.remove(),add(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]})):t};n.min=D.default.compose(i,n.min),n.max=D.default.compose(i,n.max)}else n instanceof f.default?(E.default.bind(t,"click",function(){E.default.fakeEvent(n.__checkbox,"click")}),E.default.bind(n.__checkbox,"click",function(e){e.stopPropagation()})):n instanceof m.default?(E.default.bind(t,"click",function(){E.default.fakeEvent(n.__button,"click")}),E.default.bind(t,"mouseover",function(){E.default.addClass(n.__button,"hover")}),E.default.bind(t,"mouseout",function(){E.default.removeClass(n.__button,"hover")})):n instanceof w.default&&(E.default.addClass(t,"color"),n.updateDisplay=D.default.compose(function(e){return t.style.borderLeftColor=n.__color.toString(),e},n.updateDisplay),n.updateDisplay());n.setValue=D.default.compose(function(t){return e.getRoot().__preset_select&&n.isModified()&&markPresetModified(e.getRoot(),!0),t},n.setValue)}function recallSavedValue(e,t){var n=e.getRoot(),i=n.__rememberedObjects.indexOf(t.object);if(-1!==i){var r=n.__rememberedObjectIndecesToControllers[i];if(void 0===r&&(r={},n.__rememberedObjectIndecesToControllers[i]=r),r[t.property]=t,n.load&&n.load.remembered){var o=n.load.remembered,a=void 0;if(o[e.preset])a=o[e.preset];else{if(!o[k])return;a=o[k]}if(a[i]&&void 0!==a[i][t.property]){var s=a[i][t.property];t.initialValue=s,t.setValue(s)}}}}function add(e,t,n,i){if(void 0===t[n])throw new Error('Object "'+t+'" has no property "'+n+'"');var r=void 0;if(i.color)r=new w.default(t,n);else{var o=[t,n].concat(i.factoryArgs);r=u.default.apply(e,o)}i.before instanceof h.default&&(i.before=i.before.__li),recallSavedValue(e,r),E.default.addClass(r.domElement,"c");var a=document.createElement("span");E.default.addClass(a,"property-name"),a.innerHTML=r.property;var s=document.createElement("div");s.appendChild(a),s.appendChild(r.domElement);var l=addRow(e,s,i.before);return E.default.addClass(l,F.CLASS_CONTROLLER_ROW),r instanceof w.default?E.default.addClass(l,"color"):E.default.addClass(l,typeof r.getValue()),augmentController(e,l,r),e.__controllers.push(r),r}function getLocalStorageHash(e,t){return document.location.href+"."+t}function addPresetOption(e,t,n){var i=document.createElement("option");i.innerHTML=t,i.value=t,e.__preset_select.appendChild(i),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function showHideExplain(e,t){t.style.display=e.useLocalStorage?"block":"none"}function addSaveMenu(e){var t=e.__save_row=document.createElement("li");E.default.addClass(e.domElement,"has-save"),e.__ul.insertBefore(t,e.__ul.firstChild),E.default.addClass(t,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",E.default.addClass(n,"button gears");var i=document.createElement("span");i.innerHTML="Save",E.default.addClass(i,"button"),E.default.addClass(i,"save");var r=document.createElement("span");r.innerHTML="New",E.default.addClass(r,"button"),E.default.addClass(r,"save-as");var o=document.createElement("span");o.innerHTML="Revert",E.default.addClass(o,"button"),E.default.addClass(o,"revert");var a=e.__preset_select=document.createElement("select");e.load&&e.load.remembered?D.default.each(e.load.remembered,function(t,n){addPresetOption(e,n,n===e.preset)}):addPresetOption(e,k,!1),E.default.bind(a,"change",function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value}),t.appendChild(a),t.appendChild(n),t.appendChild(i),t.appendChild(r),t.appendChild(o),L&&function(){var t=document.getElementById("dg-local-explain"),n=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(getLocalStorageHash(e,"isLocal"))&&n.setAttribute("checked","checked"),showHideExplain(e,t),E.default.bind(n,"change",function(){e.useLocalStorage=!e.useLocalStorage,showHideExplain(e,t)})}();var s=document.getElementById("dg-new-constructor");E.default.bind(s,"keydown",function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||N.hide()}),E.default.bind(n,"click",function(){s.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),N.show(),s.focus(),s.select()}),E.default.bind(i,"click",function(){e.save()}),E.default.bind(r,"click",function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)}),E.default.bind(o,"click",function(){e.revert()})}function addResizeHandle(e){function drag(n){return n.preventDefault(),e.width+=t-n.clientX,e.onResize(),t=n.clientX,!1}function dragStop(){E.default.removeClass(e.__closeButton,F.CLASS_DRAG),E.default.unbind(window,"mousemove",drag),E.default.unbind(window,"mouseup",dragStop)}function dragStart(n){return n.preventDefault(),t=n.clientX,E.default.addClass(e.__closeButton,F.CLASS_DRAG),E.default.bind(window,"mousemove",drag),E.default.bind(window,"mouseup",dragStop),!1}var t=void 0;e.__resize_handle=document.createElement("div"),D.default.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),E.default.bind(e.__resize_handle,"mousedown",dragStart),E.default.bind(e.__closeButton,"mousedown",dragStart),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function setWidth(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function getCurrentPreset(e,t){var n={};return D.default.each(e.__rememberedObjects,function(i,r){var o={},a=e.__rememberedObjectIndecesToControllers[r];D.default.each(a,function(e,n){o[n]=t?e.initialValue:e.getValue()}),n[r]=o}),n}function setPresetSelectIndex(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}function updateDisplays(e){0!==e.length&&S.default(function(){updateDisplays(e)}),D.default.each(e,function(e){e.updateDisplay()})}var i=n(15),r=_interopRequireDefault(i),o=n(23),a=_interopRequireDefault(o),s=n(24),l=_interopRequireDefault(s),c=n(26),u=_interopRequireDefault(c),d=n(7),h=_interopRequireDefault(d),p=n(8),f=_interopRequireDefault(p),g=n(20),m=_interopRequireDefault(g),v=n(13),_=_interopRequireDefault(v),y=n(14),x=_interopRequireDefault(y),b=n(21),w=_interopRequireDefault(b),C=n(27),S=_interopRequireDefault(C),T=n(28),A=_interopRequireDefault(T),M=n(9),E=_interopRequireDefault(M),I=n(5),D=_interopRequireDefault(I);r.default.inject(l.default);var k="Default",L=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}(),N=void 0,P=!0,O=void 0,R=!1,z=[],F=function GUI(e){var t=this,n=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),E.default.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],n=D.default.defaults(n,{autoPlace:!0,width:GUI.DEFAULT_WIDTH}),n=D.default.defaults(n,{resizable:n.autoPlace,hideable:n.autoPlace}),D.default.isUndefined(n.load)?n.load={preset:k}:n.preset&&(n.load.preset=n.preset),D.default.isUndefined(n.parent)&&n.hideable&&z.push(this),n.resizable=D.default.isUndefined(n.parent)&&n.resizable,n.autoPlace&&D.default.isUndefined(n.scrollable)&&(n.scrollable=!0);var i=L&&"true"===localStorage.getItem(getLocalStorageHash(this,"isLocal")),r=void 0;if(Object.defineProperties(this,{parent:{get:function(){return n.parent}},scrollable:{get:function(){return n.scrollable}},autoPlace:{get:function(){return n.autoPlace}},preset:{get:function(){return t.parent?t.getRoot().preset:n.load.preset},set:function(e){t.parent?t.getRoot().preset=e:n.load.preset=e,setPresetSelectIndex(this),t.revert()}},width:{get:function(){return n.width},set:function(e){n.width=e,setWidth(t,e)}},name:{get:function(){return n.name},set:function(e){n.name=e,titleRowName&&(titleRowName.innerHTML=n.name)}},closed:{get:function(){return n.closed},set:function(e){n.closed=e,n.closed?E.default.addClass(t.__ul,GUI.CLASS_CLOSED):E.default.removeClass(t.__ul,GUI.CLASS_CLOSED),this.onResize(),t.__closeButton&&(t.__closeButton.innerHTML=e?GUI.TEXT_OPEN:GUI.TEXT_CLOSED)}},load:{get:function(){return n.load}},useLocalStorage:{get:function(){return i},set:function(e){L&&(i=e,e?E.default.bind(window,"unload",r):E.default.unbind(window,"unload",r),localStorage.setItem(getLocalStorageHash(t,"isLocal"),e))}}}),D.default.isUndefined(n.parent)){if(n.closed=!1,E.default.addClass(this.domElement,GUI.CLASS_MAIN),E.default.makeSelectable(this.domElement,!1),L&&i){t.useLocalStorage=!0;var o=localStorage.getItem(getLocalStorageHash(this,"gui"));o&&(n.load=JSON.parse(o))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=GUI.TEXT_CLOSED,E.default.addClass(this.__closeButton,GUI.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),E.default.bind(this.__closeButton,"click",function(){t.closed=!t.closed})}else{void 0===n.closed&&(n.closed=!0);var a=document.createTextNode(n.name);E.default.addClass(a,"controller-name");var s=addRow(t,a),l=function(e){return e.preventDefault(),t.closed=!t.closed,!1};E.default.addClass(this.__ul,GUI.CLASS_CLOSED),E.default.addClass(s,"title"),E.default.bind(s,"click",l),n.closed||(this.closed=!1)}n.autoPlace&&(D.default.isUndefined(n.parent)&&(P&&(O=document.createElement("div"),E.default.addClass(O,"dg"),E.default.addClass(O,GUI.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(O),P=!1),O.appendChild(this.domElement),E.default.addClass(this.domElement,GUI.CLASS_AUTO_PLACE)),this.parent||setWidth(t,n.width)),E.default.bind(window,"resize",function(){t.onResize()}),E.default.bind(this.__ul,"webkitTransitionEnd",function(){t.onResize()}),E.default.bind(this.__ul,"transitionend",function(){t.onResize()}),E.default.bind(this.__ul,"oTransitionEnd",function(){t.onResize()}),this.onResize(),n.resizable&&addResizeHandle(this),r=function(){L&&"true"===localStorage.getItem(getLocalStorageHash(t,"isLocal"))&&localStorage.setItem(getLocalStorageHash(t,"gui"),JSON.stringify(t.getSaveObject()))},this.saveToLocalStorageIfPossible=r,n.parent||function(){var e=t.getRoot();e.width+=1,D.default.defer(function(){e.width-=1})}()};F.toggleHide=function(){R=!R,D.default.each(z,function(e){e.domElement.style.zIndex=R?-999:999,e.domElement.style.opacity=R?0:1})},F.CLASS_AUTO_PLACE="a",F.CLASS_AUTO_PLACE_CONTAINER="ac",F.CLASS_MAIN="main",F.CLASS_CONTROLLER_ROW="cr",F.CLASS_TOO_TALL="taller-than-window",F.CLASS_CLOSED="closed",F.CLASS_CLOSE_BUTTON="close-button",F.CLASS_DRAG="drag",F.DEFAULT_WIDTH=245,F.TEXT_CLOSED="Close Controls",F.TEXT_OPEN="Open Controls",E.default.bind(window,"keydown",function(e){"text"===document.activeElement.type||72!==e.which&&72!==e.keyCode||F.toggleHide()},!1),D.default.extend(F.prototype,{add:function(e){function add(t,n){return e.apply(this,arguments)}return add.toString=function(){return e.toString()},add}(function(e,t){return add(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})}),addColor:function(e,t){return add(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;D.default.defer(function(){t.onResize()})},destroy:function(){this.autoPlace&&O.removeChild(this.domElement)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var n=new F(t);this.__folders[e]=n;var i=addRow(this,n.domElement);return E.default.addClass(i,"folder"),n},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=E.default.getOffset(e.__ul).top,n=0;D.default.each(e.__ul.childNodes,function(t){e.autoPlace&&t===e.__save_row||(n+=E.default.getHeight(t))}),window.innerHeight-t-20<n?(E.default.addClass(e.domElement,F.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(E.default.removeClass(e.domElement,F.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&D.default.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},remember:function(){if(D.default.isUndefined(N)&&(N=new A.default,N.domElement.innerHTML=a.default),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;D.default.each(Array.prototype.slice.call(arguments),function(t){0===e.__rememberedObjects.length&&addSaveMenu(e),-1===e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)}),this.autoPlace&&setWidth(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=getCurrentPreset(this)),e.folders={},D.default.each(this.__folders,function(t,n){e.folders[n]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=getCurrentPreset(this),markPresetModified(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[k]=getCurrentPreset(this,!0)),this.load.remembered[e]=getCurrentPreset(this),this.preset=e,addPresetOption(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){D.default.each(this.__controllers,function(t){this.getRoot().load.remembered?recallSavedValue(e||this.getRoot(),t):t.setValue(t.initialValue)},this),D.default.each(this.__folders,function(e){e.revert(e)}),e||markPresetModified(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&updateDisplays(this.__listening)}}),e.exports=F},function(e,t){e.exports='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'},function(e,t,n){var i=n(25);"string"==typeof i&&(i=[[e.id,i,""]]);n(19)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){t=e.exports=n(18)(),t.push([e.id,".dg {\n  /** Clear list styles */\n  /* Auto-place container */\n  /* Auto-placed GUI's */\n  /* Line items that don't contain folders. */\n  /** Folder names */\n  /** Hides closed items */\n  /** Controller row */\n  /** Name-half (left) */\n  /** Controller-half (right) */\n  /** Controller placement */\n  /** Shorter number boxes when slider is present. */\n  /** Ensure the entire boolean and function row shows a hand */ }\n  .dg ul {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n    width: 100%;\n    clear: both; }\n  .dg.ac {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 0;\n    z-index: 0; }\n  .dg:not(.ac) .main {\n    /** Exclude mains in ac so that we don't hide close button */\n    overflow: hidden; }\n  .dg.main {\n    -webkit-transition: opacity 0.1s linear;\n    -o-transition: opacity 0.1s linear;\n    -moz-transition: opacity 0.1s linear;\n    transition: opacity 0.1s linear; }\n    .dg.main.taller-than-window {\n      overflow-y: auto; }\n      .dg.main.taller-than-window .close-button {\n        opacity: 1;\n        /* TODO, these are style notes */\n        margin-top: -1px;\n        border-top: 1px solid #2c2c2c; }\n    .dg.main ul.closed .close-button {\n      opacity: 1 !important; }\n    .dg.main:hover .close-button,\n    .dg.main .close-button.drag {\n      opacity: 1; }\n    .dg.main .close-button {\n      /*opacity: 0;*/\n      -webkit-transition: opacity 0.1s linear;\n      -o-transition: opacity 0.1s linear;\n      -moz-transition: opacity 0.1s linear;\n      transition: opacity 0.1s linear;\n      border: 0;\n      position: absolute;\n      line-height: 19px;\n      height: 20px;\n      /* TODO, these are style notes */\n      cursor: pointer;\n      text-align: center;\n      background-color: #000; }\n      .dg.main .close-button:hover {\n        background-color: #111; }\n  .dg.a {\n    float: right;\n    margin-right: 15px;\n    overflow-x: hidden; }\n    .dg.a.has-save > ul {\n      margin-top: 27px; }\n      .dg.a.has-save > ul.closed {\n        margin-top: 0; }\n    .dg.a .save-row {\n      position: fixed;\n      top: 0;\n      z-index: 1002; }\n  .dg li {\n    -webkit-transition: height 0.1s ease-out;\n    -o-transition: height 0.1s ease-out;\n    -moz-transition: height 0.1s ease-out;\n    transition: height 0.1s ease-out; }\n  .dg li:not(.folder) {\n    cursor: auto;\n    height: 27px;\n    line-height: 27px;\n    overflow: hidden;\n    padding: 0 4px 0 5px; }\n  .dg li.folder {\n    padding: 0;\n    border-left: 4px solid transparent; }\n  .dg li.title {\n    cursor: pointer;\n    margin-left: -4px; }\n  .dg .closed li:not(.title),\n  .dg .closed ul li,\n  .dg .closed ul li > * {\n    height: 0;\n    overflow: hidden;\n    border: 0; }\n  .dg .cr {\n    clear: both;\n    padding-left: 3px;\n    height: 27px; }\n  .dg .property-name {\n    cursor: default;\n    float: left;\n    clear: left;\n    width: 40%;\n    overflow: hidden;\n    text-overflow: ellipsis; }\n  .dg .c {\n    float: left;\n    width: 60%; }\n  .dg .c input[type=text] {\n    border: 0;\n    margin-top: 4px;\n    padding: 3px;\n    width: 100%;\n    float: right; }\n  .dg .has-slider input[type=text] {\n    width: 30%;\n    /*display: none;*/\n    margin-left: 0; }\n  .dg .slider {\n    float: left;\n    width: 66%;\n    margin-left: -5px;\n    margin-right: 0;\n    height: 19px;\n    margin-top: 4px; }\n  .dg .slider-fg {\n    height: 100%; }\n  .dg .c input[type=checkbox] {\n    margin-top: 9px; }\n  .dg .c select {\n    margin-top: 5px; }\n  .dg .cr.function,\n  .dg .cr.function .property-name, .dg .cr.function *,\n  .dg .cr.boolean,\n  .dg .cr.boolean * {\n    cursor: pointer; }\n  .dg .selector {\n    display: none;\n    position: absolute;\n    margin-left: -9px;\n    margin-top: 23px;\n    z-index: 10; }\n  .dg .c:hover .selector,\n  .dg .selector.drag {\n    display: block; }\n  .dg li.save-row {\n    padding: 0; }\n    .dg li.save-row .button {\n      display: inline-block;\n      padding: 0px 6px; }\n  .dg.dialogue {\n    background-color: #222;\n    width: 460px;\n    padding: 15px;\n    font-size: 13px;\n    line-height: 15px; }\n\n/* TODO Separate style and structure */\n#dg-new-constructor {\n  padding: 10px;\n  color: #222;\n  font-family: Monaco, monospace;\n  font-size: 10px;\n  border: 0;\n  resize: none;\n  box-shadow: inset 1px 1px 1px #888;\n  word-wrap: break-word;\n  margin: 12px 0;\n  display: block;\n  width: 440px;\n  overflow-y: scroll;\n  height: 100px;\n  position: relative; }\n\n#dg-local-explain {\n  display: none;\n  font-size: 11px;\n  line-height: 17px;\n  border-radius: 3px;\n  background-color: #333;\n  padding: 8px;\n  margin-top: 10px; }\n  #dg-local-explain code {\n    font-size: 10px; }\n\n#dat-gui-save-locally {\n  display: none; }\n\n/** Main type */\n.dg {\n  color: #eee;\n  font: 11px 'Lucida Grande', sans-serif;\n  text-shadow: 0 -1px 0 #111;\n  /** Auto place */\n  /* Controller row, <li> */\n  /** Controllers */ }\n  .dg.main {\n    /** Scrollbar */ }\n    .dg.main::-webkit-scrollbar {\n      width: 5px;\n      background: #1a1a1a; }\n    .dg.main::-webkit-scrollbar-corner {\n      height: 0;\n      display: none; }\n    .dg.main::-webkit-scrollbar-thumb {\n      border-radius: 5px;\n      background: #676767; }\n  .dg li:not(.folder) {\n    background: #1a1a1a;\n    border-bottom: 1px solid #2c2c2c; }\n  .dg li.save-row {\n    line-height: 25px;\n    background: #dad5cb;\n    border: 0; }\n    .dg li.save-row select {\n      margin-left: 5px;\n      width: 108px; }\n    .dg li.save-row .button {\n      margin-left: 5px;\n      margin-top: 1px;\n      border-radius: 2px;\n      font-size: 9px;\n      line-height: 7px;\n      padding: 4px 4px 5px 4px;\n      background: #c5bdad;\n      color: #fff;\n      text-shadow: 0 1px 0 #b0a58f;\n      box-shadow: 0 -1px 0 #b0a58f;\n      cursor: pointer; }\n      .dg li.save-row .button.gears {\n        background: #c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;\n        height: 7px;\n        width: 8px; }\n      .dg li.save-row .button:hover {\n        background-color: #bab19e;\n        box-shadow: 0 -1px 0 #b0a58f; }\n  .dg li.folder {\n    border-bottom: 0; }\n  .dg li.title {\n    padding-left: 16px;\n    background: #000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;\n    cursor: pointer;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.2); }\n  .dg .closed li.title {\n    background-image: url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==); }\n  .dg .cr.boolean {\n    border-left: 3px solid #806787; }\n  .dg .cr.color {\n    border-left: 3px solid; }\n  .dg .cr.function {\n    border-left: 3px solid #e61d5f; }\n  .dg .cr.number {\n    border-left: 3px solid #2FA1D6; }\n    .dg .cr.number input[type=text] {\n      color: #2FA1D6; }\n  .dg .cr.string {\n    border-left: 3px solid #1ed36f; }\n    .dg .cr.string input[type=text] {\n      color: #1ed36f; }\n  .dg .cr.function:hover,\n  .dg .cr.boolean:hover {\n    background: #111; }\n  .dg .c input[type=text] {\n    background: #303030;\n    outline: none; }\n    .dg .c input[type=text]:hover {\n      background: #3c3c3c; }\n    .dg .c input[type=text]:focus {\n      background: #494949;\n      color: #fff; }\n  .dg .c .slider {\n    background: #303030;\n    cursor: ew-resize; }\n  .dg .c .slider-fg {\n    background: #2FA1D6; }\n  .dg .c .slider:hover {\n    background: #3c3c3c; }\n    .dg .c .slider:hover .slider-fg {\n      background: #44abda; }\n",""])},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=n(10),r=_interopRequireDefault(i),o=n(13),a=_interopRequireDefault(o),s=n(14),l=_interopRequireDefault(s),c=n(11),u=_interopRequireDefault(c),d=n(20),h=_interopRequireDefault(d),p=n(8),f=_interopRequireDefault(p),g=n(5),m=_interopRequireDefault(g),v=function(e,t){var n=e[t];return m.default.isArray(arguments[2])||m.default.isObject(arguments[2])?new r.default(e,t,arguments[2]):m.default.isNumber(n)?m.default.isNumber(arguments[2])&&m.default.isNumber(arguments[3])?m.default.isNumber(arguments[4])?new l.default(e,t,arguments[2],arguments[3],arguments[4]):new l.default(e,t,arguments[2],arguments[3]):new a.default(e,t,{min:arguments[2],max:arguments[3]}):m.default.isString(n)?new u.default(e,t):m.default.isFunction(n)?new h.default(e,t,""):m.default.isBoolean(n)?new f.default(e,t):void 0};t.default=v,e.exports=t.default},function(e,t){"use strict";t.__esModule=!0,t.default=function(){function requestAnimationFrame(e){window.setTimeout(e,1e3/60)}return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||requestAnimationFrame},e.exports=t.default},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=n(9),r=_interopRequireDefault(i),o=n(5),a=_interopRequireDefault(o),s=function(){function CenteredDiv(){_classCallCheck(this,CenteredDiv),this.backgroundElement=document.createElement("div"),a.default.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),r.default.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),a.default.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;r.default.bind(this.backgroundElement,"click",function(){e.hide()})}return CenteredDiv.prototype.show=function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),a.default.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})},CenteredDiv.prototype.hide=function(){var e=this,t=function hide(){e.domElement.style.display="none",e.backgroundElement.style.display="none",r.default.unbind(e.domElement,"webkitTransitionEnd",hide),r.default.unbind(e.domElement,"transitionend",hide),r.default.unbind(e.domElement,"oTransitionEnd",hide)};r.default.bind(this.domElement,"webkitTransitionEnd",t),r.default.bind(this.domElement,"transitionend",t),r.default.bind(this.domElement,"oTransitionEnd",t),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},CenteredDiv.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-r.default.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-r.default.getHeight(this.domElement)/2+"px"},CenteredDiv}();t.default=s,e.exports=t.default}])})},function(module,exports,__webpack_require__){(function(jQuery){var $=__webpack_require__(0),dra=__webpack_require__(64);!function($){var min=Math.min,max=Math.max,round=Math.floor,isStr=function(e){return"string"===$.type(e)},runPluginCallbacks=function(Instance,a_fn){function g(e){return e}if($.isArray(a_fn))for(var i=0,c=a_fn.length;i<c;i++){var fn=a_fn[i];try{isStr(fn)&&(fn=eval(fn)),$.isFunction(fn)&&g(fn)(Instance)}catch(e){}}};$.layout={version:"1.4.3",revision:1.0403,browser:{},effects:{slide:{all:{duration:"fast"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},drop:{all:{duration:"slow"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},scale:{all:{duration:"fast"}},blind:{},clip:{},explode:{},fade:{},fold:{},puff:{},size:{all:{easing:"swing"}}},config:{optionRootKeys:"effects,panes,north,south,west,east,center".split(","),allPanes:"north,south,west,east,center".split(","),borderPanes:"north,south,west,east".split(","),oppositeEdge:{north:"south",south:"north",east:"west",west:"east"},offscreenCSS:{left:"-99999px",right:"auto"},offscreenReset:"offscreenReset",hidden:{visibility:"hidden"},visible:{visibility:"visible"},resizers:{cssReq:{position:"absolute",padding:0,margin:0,fontSize:"1px",textAlign:"left",overflow:"hidden"},cssDemo:{background:"#DDD",border:"none"}},togglers:{cssReq:{position:"absolute",display:"block",padding:0,margin:0,overflow:"hidden",textAlign:"center",fontSize:"1px",cursor:"pointer",zIndex:1},cssDemo:{background:"#AAA"}},content:{cssReq:{position:"relative"},cssDemo:{overflow:"auto",padding:"10px"},cssDemoPane:{overflow:"hidden",padding:0}},panes:{cssReq:{position:"absolute",margin:0},cssDemo:{padding:"10px",background:"#FFF",border:"1px solid #BBB",overflow:"auto"}},north:{side:"top",sizeType:"Height",dir:"horz",cssReq:{top:0,bottom:"auto",left:0,right:0,width:"auto"}},south:{side:"bottom",sizeType:"Height",dir:"horz",cssReq:{top:"auto",bottom:0,left:0,right:0,width:"auto"}},east:{side:"right",sizeType:"Width",dir:"vert",cssReq:{left:"auto",right:0,top:"auto",bottom:"auto",height:"auto"}},west:{side:"left",sizeType:"Width",dir:"vert",cssReq:{left:0,right:"auto",top:"auto",bottom:"auto",height:"auto"}},center:{dir:"center",cssReq:{left:"auto",right:"auto",top:"auto",bottom:"auto",height:"auto",width:"auto"}}},callbacks:{},getParentPaneElem:function(e){var t=$(e),n=t.data("layout")||t.data("parentLayout");if(n){var i=n.container;if(i.data("layoutPane"))return i;var r=i.closest("."+$.layout.defaults.panes.paneClass);if(r.data("layoutPane"))return r}return null},getParentPaneInstance:function(e){var t=$.layout.getParentPaneElem(e);return t?t.data("layoutPane"):null},getParentLayoutInstance:function(e){var t=$.layout.getParentPaneElem(e);return t?t.data("parentLayout"):null},getEventObject:function(e){return"object"==typeof e&&e.stopPropagation?e:null},parsePaneName:function(e){var t=$.layout.getEventObject(e),n=e;return t&&(t.stopPropagation(),n=$(this).data("layoutEdge")),n&&!/^(west|east|north|south|center)$/.test(n)&&($.layout.msg('LAYOUT ERROR - Invalid pane-name: "'+n+'"'),n="error"),n},plugins:{draggable:!!$.fn.draggable,effects:{core:!!$.effects,slide:$.effects&&($.effects.slide||$.effects.effect&&$.effects.effect.slide)}},onCreate:[],onLoad:[],onReady:[],onDestroy:[],onUnload:[],afterOpen:[],afterClose:[],scrollbarWidth:function(){return window.scrollbarWidth||$.layout.getScrollbarSize("width")},scrollbarHeight:function(){return window.scrollbarHeight||$.layout.getScrollbarSize("height")},getScrollbarSize:function(e){var t=$('<div style="position: absolute; top: -10000px; left: -10000px; width: 100px; height: 100px; border: 0; overflow: scroll;"></div>').appendTo("body"),n={width:t.outerWidth-t[0].clientWidth,height:100-t[0].clientHeight};return t.remove(),window.scrollbarWidth=n.width,window.scrollbarHeight=n.height,e.match(/^(width|height)$/)?n[e]:n},disableTextSelection:function(){var e=$(document),t="textSelectionDisabled",n="textSelectionInitialized";$.fn.disableSelection&&(e.data(n)||e.on("mouseup",$.layout.enableTextSelection).data(n,!0),e.data(t)||e.disableSelection().data(t,!0))},enableTextSelection:function(){var e=$(document),t="textSelectionDisabled";$.fn.enableSelection&&e.data(t)&&e.enableSelection().data(t,!1)},showInvisibly:function(e,t){if(e&&e.length&&(t||"none"===e.css("display"))){var n=e[0].style,i={display:n.display||"",visibility:n.visibility||""};return e.css({display:"block",visibility:"hidden"}),i}return{}},getElementDimensions:function(e,t){var n,i,r,o={css:{},inset:{}},a=o.css,s={bottom:0},l=$.layout.cssNum,c=Math.round,u=e.offset();return o.offsetLeft=u.left,o.offsetTop=u.top,t||(t={}),$.each("Left,Right,Top,Bottom".split(","),function(l,c){n=a["border"+c]=$.layout.borderWidth(e,c),i=a["padding"+c]=$.layout.cssNum(e,"padding"+c),r=c.toLowerCase(),o.inset[r]=t[r]>=0?t[r]:i,s[r]=o.inset[r]+n}),a.width=c(e.width()),a.height=c(e.height()),a.top=l(e,"top",!0),a.bottom=l(e,"bottom",!0),a.left=l(e,"left",!0),a.right=l(e,"right",!0),o.outerWidth=c(e.outerWidth()),o.outerHeight=c(e.outerHeight()),o.innerWidth=max(0,o.outerWidth-s.left-s.right),o.innerHeight=max(0,o.outerHeight-s.top-s.bottom),o.layoutWidth=c(e.innerWidth()),o.layoutHeight=c(e.innerHeight()),o},getElementStyles:function(e,t){var n,i,r,o,a,s,l={},c=e[0].style,u=t.split(","),d="Top,Bottom,Left,Right".split(","),h="Color,Style,Width".split(",");for(o=0;o<u.length;o++)if(n=u[o],n.match(/(border|padding|margin)$/))for(a=0;a<4;a++)if(i=d[a],"border"===n)for(s=0;s<3;s++)r=h[s],l[n+i+r]=c[n+i+r];else l[n+i]=c[n+i];else l[n]=c[n];return l},cssWidth:function(e,t){if(t<=0)return 0;var n=$.layout.browser,i=n.boxModel?n.boxSizing?e.css("boxSizing"):"content-box":"border-box",r=$.layout.borderWidth,o=$.layout.cssNum,a=t;return"border-box"!==i&&(a-=r(e,"Left")+r(e,"Right")),"content-box"===i&&(a-=o(e,"paddingLeft")+o(e,"paddingRight")),max(0,a)},cssHeight:function(e,t){if(t<=0)return 0;var n=$.layout.browser,i=n.boxModel?n.boxSizing?e.css("boxSizing"):"content-box":"border-box",r=$.layout.borderWidth,o=$.layout.cssNum,a=t;return"border-box"!==i&&(a-=r(e,"Top")+r(e,"Bottom")),"content-box"===i&&(a-=o(e,"paddingTop")+o(e,"paddingBottom")),max(0,a)},cssNum:function(e,t,n){e.jquery||(e=$(e));var i=$.layout.showInvisibly(e),r=$.css(e[0],t,!0),o=n&&"auto"==r?r:Math.round(parseFloat(r)||0);return e.css(i),o},borderWidth:function(e,t){e.jquery&&(e=e[0]);var n="border"+t.substr(0,1).toUpperCase()+t.substr(1);return"none"===$.css(e,n+"Style",!0)?0:Math.round(parseFloat($.css(e,n+"Width",!0))||0)},isMouseOverElem:function(e,t){var n=$(t||this),i=n.offset(),r=i.top,o=i.left,a=o+n.outerWidth(),s=r+n.outerHeight(),l=e.pageX,c=e.pageY;return $.layout.browser.msie&&l<0&&c<0||l>=o&&l<=a&&c>=r&&c<=s},msg:function(e,t,n,i){if($.isPlainObject(e)&&window.debugData){"string"==typeof t?(i=n,n=t):"object"==typeof n&&(i=n,n=null);var r=n||"log( <object> )",o=$.extend({sort:!1,returnHTML:!1,display:!1},i);!0===t||o.display?debugData(e,r,o):window.console}else if(t)alert(e);else if(window.console);else{var a=$("#layoutLogger");a.length||(a=function(){var e=$.support.fixedPosition?"fixed":"absolute",t=$('<div id="layoutLogger" style="position: '+e+'; top: 5px; z-index: 999999; max-width: 25%; overflow: hidden; border: 1px solid #000; border-radius: 5px; background: #FBFBFB; box-shadow: 0 2px 10px rgba(0,0,0,0.3);"><div style="font-size: 13px; font-weight: bold; padding: 5px 10px; background: #F6F6F6; border-radius: 5px 5px 0 0; cursor: move;"><span style="float: right; padding-left: 7px; cursor: pointer;" title="Remove Console" onclick="$(this).closest(\'#layoutLogger\').remove()">X</span>Layout console.log</div><ul style="font-size: 13px; font-weight: none; list-style: none; margin: 0; padding: 0 0 2px;"></ul></div>').appendTo("body");return t.css("left",$(window).width()-t.outerWidth()-5),$.ui.draggable&&t.draggable({handle:":first-child"}),t}()),a.children("ul").append('<li style="padding: 4px 10px; margin: 0; border-top: 1px solid #CCC;">'+e.replace(/\</g,"&lt;").replace(/\>/g,"&gt;")+"</li>")}}},function(){var e=navigator.userAgent.toLowerCase(),t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],n=t[1]||"",i=t[2]||0,r="msie"===n,o=document.compatMode,a=$.support,s=void 0!==a.boxSizing?a.boxSizing:a.boxSizingReliable,l=!r||!o||"CSS1Compat"===o||a.boxModel||!1,c=$.layout.browser={version:i,safari:"webkit"===n,webkit:"chrome"===n,msie:r,isIE6:r&&6==i,boxModel:l,boxSizing:!!("function"==typeof s?s():s)};n&&(c[n]=!0),l||o||$(function(){c.boxModel=a.boxModel})}(),$.layout.defaults={name:"",containerClass:"ui-layout-container",inset:null,scrollToBookmarkOnLoad:!0,resizeWithWindow:!0,resizeWithWindowDelay:200,resizeWithWindowMaxDelay:0,maskPanesEarly:!1,onresizeall_start:null,onresizeall_end:null,onload_start:null,onload_end:null,onunload_start:null,onunload_end:null,initPanes:!0,showErrorMessages:!0,showDebugMessages:!1,zIndex:null,zIndexes:{pane_normal:0,content_mask:1,resizer_normal:2,pane_sliding:100,pane_animate:1e3,resizer_drag:1e4},errors:{pane:"pane",selector:"selector",addButtonError:"Error Adding Button\nInvalid ",containerMissing:"UI Layout Initialization Error\nThe specified layout-container does not exist.",centerPaneMissing:"UI Layout Initialization Error\nThe center-pane element does not exist.\nThe center-pane is a required element.",noContainerHeight:"UI Layout Initialization Warning\nThe layout-container \"CONTAINER\" has no height.\nTherefore the layout is 0-height and hence 'invisible'!",callbackError:"UI Layout Callback Error\nThe EVENT callback is not a valid function."},panes:{applyDemoStyles:!1,closable:!0,resizable:!0,slidable:!0,initClosed:!1,initHidden:!1,contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore",findNestedContent:!1,paneClass:"ui-layout-pane",resizerClass:"ui-layout-resizer",togglerClass:"ui-layout-toggler",buttonClass:"ui-layout-button",minSize:0,maxSize:0,spacing_open:6,spacing_closed:6,togglerLength_open:50,togglerLength_closed:50,togglerAlign_open:"center",togglerAlign_closed:"center",togglerContent_open:"",togglerContent_closed:"",resizerDblClickToggle:!0,autoResize:!0,autoReopen:!0,resizerDragOpacity:1,maskContents:!1,maskObjects:!1,maskZindex:null,resizingGrid:!1,livePaneResizing:!1,liveContentResizing:!1,liveResizingTolerance:1,sliderCursor:"pointer",slideTrigger_open:"click",slideTrigger_close:"mouseleave",slideDelay_open:300,slideDelay_close:300,hideTogglerOnSlide:!1,preventQuickSlideClose:$.layout.browser.webkit,preventPrematureSlideClose:!1,tips:{Open:"Open",Close:"Close",Resize:"Resize",Slide:"Slide Open",Pin:"Pin",Unpin:"Un-Pin",noRoomToOpen:"Not enough room to show this panel.",minSizeWarning:"Panel has reached its minimum size",maxSizeWarning:"Panel has reached its maximum size"},showOverflowOnHover:!1,enableCursorHotkey:!0,customHotkeyModifier:"SHIFT",fxName:"slide",fxSpeed:null,fxSettings:{},fxOpacityFix:!0,animatePaneSizing:!1,children:null,containerSelector:"",initChildren:!0,destroyChildren:!0,resizeChildren:!0,triggerEventsOnLoad:!1,triggerEventsDuringLiveResize:!0,onshow_start:null,onshow_end:null,onhide_start:null,onhide_end:null,onopen_start:null,onopen_end:null,onclose_start:null,onclose_end:null,onresize_start:null,onresize_end:null,onsizecontent_start:null,onsizecontent_end:null,onswap_start:null,onswap_end:null,ondrag_start:null,ondrag_end:null},north:{paneSelector:".ui-layout-north",size:"auto",resizerCursor:"n-resize",customHotkey:""},south:{paneSelector:".ui-layout-south",size:"auto",resizerCursor:"s-resize",customHotkey:""},east:{paneSelector:".ui-layout-east",size:200,resizerCursor:"e-resize",customHotkey:""},west:{paneSelector:".ui-layout-west",size:200,resizerCursor:"w-resize",customHotkey:""},center:{paneSelector:".ui-layout-center",minWidth:0,minHeight:0}},$.layout.optionsMap={layout:"name,instanceKey,stateManagement,effects,inset,zIndexes,errors,zIndex,scrollToBookmarkOnLoad,showErrorMessages,maskPanesEarly,outset,resizeWithWindow,resizeWithWindowDelay,resizeWithWindowMaxDelay,onresizeall,onresizeall_start,onresizeall_end,onload,onload_start,onload_end,onunload,onunload_start,onunload_end".split(","),center:"paneClass,contentSelector,contentIgnoreSelector,findNestedContent,applyDemoStyles,triggerEventsOnLoad,showOverflowOnHover,maskContents,maskObjects,liveContentResizing,containerSelector,children,initChildren,resizeChildren,destroyChildren,onresize,onresize_start,onresize_end,onsizecontent,onsizecontent_start,onsizecontent_end".split(","),noDefault:"paneSelector,resizerCursor,customHotkey".split(",")},$.layout.transformData=function(e,t){var n,i,r,o,a,s,l,c=t?{panes:{},center:{}}:{};if("object"!=typeof e)return c;for(i in e)for(n=c,a=e[i],r=i.split("__"),l=r.length-1,s=0;s<=l;s++)o=r[s],s===l?$.isPlainObject(a)?n[o]=$.layout.transformData(a):n[o]=a:(n[o]||(n[o]={}),n=n[o]);return c},$.layout.backwardCompatibility={map:{applyDefaultStyles:"applyDemoStyles",childOptions:"children",initChildLayout:"initChildren",destroyChildLayout:"destroyChildren",resizeChildLayout:"resizeChildren",resizeNestedLayout:"resizeChildren",resizeWhileDragging:"livePaneResizing",resizeContentWhileDragging:"liveContentResizing",triggerEventsWhileDragging:"triggerEventsDuringLiveResize",maskIframesOnResize:"maskContents",useStateCookie:"stateManagement.enabled","cookie.autoLoad":"stateManagement.autoLoad","cookie.autoSave":"stateManagement.autoSave","cookie.keys":"stateManagement.stateKeys","cookie.name":"stateManagement.cookie.name","cookie.domain":"stateManagement.cookie.domain","cookie.path":"stateManagement.cookie.path","cookie.expires":"stateManagement.cookie.expires","cookie.secure":"stateManagement.cookie.secure",noRoomToOpenTip:"tips.noRoomToOpen",togglerTip_open:"tips.Close",togglerTip_closed:"tips.Open",resizerTip:"tips.Resize",sliderTip:"tips.Slide"},renameOptions:function(e){function getBranch(t,n){for(var i,r=t.split("."),o=r.length-1,a={branch:e,key:r[o]},s=0;s<o;s++)i=r[s],void 0==a.branch[i]?a.branch=n?a.branch[i]={}:{}:a.branch=a.branch[i];return a}var t,n,i,r=$.layout.backwardCompatibility.map;for(var o in r)t=getBranch(o),void 0!==(i=t.branch[t.key])&&(n=getBranch(r[o],!0),n.branch[n.key]=i,delete t.branch[t.key])},renameAllOptions:function(e){var t=$.layout.backwardCompatibility.renameOptions;return t(e),e.defaults&&("object"!=typeof e.panes&&(e.panes={}),$.extend(!0,e.panes,e.defaults),delete e.defaults),e.panes&&t(e.panes),$.each($.layout.config.allPanes,function(n,i){e[i]&&t(e[i])}),e}},$.fn.layout=function(opts){function keyDown(e){if(!e)return!0;var t=e.keyCode;if(t<33)return!0;var n,i,r,o,a={38:"north",40:"south",37:"west",39:"east"},s=(e.altKey,e.shiftKey),l=e.ctrlKey,c=l&&t>=37&&t<=40;return c&&options[a[t]].enableCursorHotkey?o=a[t]:(l||s)&&$.each(_c.borderPanes,function(e,a){if(n=options[a],i=n.customHotkey,r=n.customHotkeyModifier,(s&&"SHIFT"==r||l&&"CTRL"==r||l&&s)&&i&&t===(isNaN(i)||i<=9?i.toUpperCase().charCodeAt(0):i))return o=a,!1}),!(o&&$Ps[o]&&options[o].closable&&!state[o].isHidden)||(toggle(o),e.stopPropagation(),e.returnValue=!1,!1)}function allowOverflow(e){if(isInitialized()){this&&this.tagName&&(e=this);var t;if(isStr(e)?t=$Ps[e]:$(e).data("layoutRole")?t=$(e):$(e).parents().each(function(){if($(this).data("layoutRole"))return t=$(this),!1}),t&&t.length){var n=t.data("layoutEdge"),i=state[n];if(i.cssSaved&&resetOverflow(n),i.isSliding||i.isResizing||i.isClosed)return void(i.cssSaved=!1);var r={zIndex:options.zIndexes.resizer_normal+1},o={},a=t.css("overflow"),s=t.css("overflowX"),l=t.css("overflowY");"visible"!=a&&(o.overflow=a,r.overflow="visible"),s&&!s.match(/(visible|auto)/)&&(o.overflowX=s,r.overflowX="visible"),l&&!l.match(/(visible|auto)/)&&(o.overflowY=s,r.overflowY="visible"),i.cssSaved=o,t.css(r),$.each(_c.allPanes,function(e,t){t!=n&&resetOverflow(t)})}}}function resetOverflow(e){if(isInitialized()){this&&this.tagName&&(e=this);var t;if(isStr(e)?t=$Ps[e]:$(e).data("layoutRole")?t=$(e):$(e).parents().each(function(){if($(this).data("layoutRole"))return t=$(this),!1}),t&&t.length){var n=t.data("layoutEdge"),i=state[n],r=i.cssSaved||{};i.isSliding||i.isResizing||t.css("zIndex",options.zIndexes.pane_normal),t.css(r),i.cssSaved=!1}}}var browser=$.layout.browser,_c=$.layout.config,cssW=$.layout.cssWidth,cssH=$.layout.cssHeight,elDims=$.layout.getElementDimensions,styles=$.layout.getElementStyles,evtObj=$.layout.getEventObject,evtPane=$.layout.parsePaneName,options=$.extend(!0,{},$.layout.defaults),effects=options.effects=$.extend(!0,{},$.layout.effects),state={id:"layout"+$.now(),initialized:!1,paneResizing:!1,panesSliding:{},container:{innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0,layoutWidth:0,layoutHeight:0},north:{childIdx:0},south:{childIdx:0},east:{childIdx:0},west:{childIdx:0},center:{childIdx:0}},children={north:null,south:null,east:null,west:null,center:null},timer={data:{},set:function(e,t,n){timer.clear(e),timer.data[e]=setTimeout(t,n)},clear:function(e){var t=timer.data;t[e]&&(clearTimeout(t[e]),delete t[e])}},_log=function(e,t,n){var i=options;return(i.showErrorMessages&&!n||n&&i.showDebugMessages)&&$.layout.msg(i.name+" / "+e,!1!==t),!1},_runCallbacks=function(evtName,pane,skipBoundEvents){function g(e){return e}var hasPane=pane&&isStr(pane),s=hasPane?state[pane]:state,o=hasPane?options[pane]:options,lName=options.name,lng=evtName+(evtName.match(/_/)?"":"_end"),shrt=lng.match(/_end$/)?lng.substr(0,lng.length-4):"",fn=o[lng]||o[shrt],retVal="NC",args=[],$P=hasPane?$Ps[pane]:0;if(hasPane&&!$P)return retVal;if(hasPane||"boolean"!==$.type(pane)||(skipBoundEvents=pane,pane=""),fn)try{isStr(fn)&&(fn.match(/,/)?(args=fn.split(","),fn=eval(args[0])):fn=eval(fn)),$.isFunction(fn)&&(retVal=args.length?g(fn)(args[1]):hasPane?g(fn)(pane,$Ps[pane],s,o,lName):g(fn)(Instance,s,o,lName))}catch(e){_log(options.errors.callbackError.replace(/EVENT/,$.trim((pane||"")+" "+lng)),!1),"string"===$.type(e)&&string.length&&_log("Exception:  "+e,!1)}return skipBoundEvents||!1===retVal||(hasPane?(o=options[pane],s=state[pane],$P.triggerHandler("layoutpane"+lng,[pane,$P,s,o,lName]),shrt&&$P.triggerHandler("layoutpane"+shrt,[pane,$P,s,o,lName])):($N.triggerHandler("layout"+lng,[Instance,s,o,lName]),shrt&&$N.triggerHandler("layout"+shrt,[Instance,s,o,lName]))),hasPane&&"onresize_end"===evtName&&resizeChildren(pane+"",!0),retVal},_fixIframe=function(e){if(!browser.mozilla){var t=$Ps[e];"IFRAME"===state[e].tagName?t.css(_c.hidden).css(_c.visible):t.find("IFRAME").css(_c.hidden).css(_c.visible)}},cssSize=function(e,t){return("horz"==_c[e].dir?cssH:cssW)($Ps[e],t)},cssMinDims=function(e){var t=$Ps[e],n=_c[e].dir,i={minWidth:1001-cssW(t,1e3),minHeight:1001-cssH(t,1e3)};return"horz"===n&&(i.minSize=i.minHeight),"vert"===n&&(i.minSize=i.minWidth),i},setOuterWidth=function(e,t,n){var i,r=e;isStr(e)?r=$Ps[e]:e.jquery||(r=$(e)),i=cssW(r,t),r.css({width:i}),i>0?n&&r.data("autoHidden")&&r.innerHeight()>0&&(r.show().data("autoHidden",!1),browser.mozilla||r.css(_c.hidden).css(_c.visible)):n&&!r.data("autoHidden")&&r.hide().data("autoHidden",!0)},setOuterHeight=function(e,t,n){var i,r=e;isStr(e)?r=$Ps[e]:e.jquery||(r=$(e)),i=cssH(r,t),r.css({height:i,visibility:"visible"}),i>0&&r.innerWidth()>0?n&&r.data("autoHidden")&&(r.show().data("autoHidden",!1),browser.mozilla||r.css(_c.hidden).css(_c.visible)):n&&!r.data("autoHidden")&&r.hide().data("autoHidden",!0)},_parseSize=function(e,t,n){if(n||(n=_c[e].dir),isStr(t)&&t.match(/%/)&&(t="100%"===t?-1:parseInt(t,10)/100),0===t)return 0;if(t>=1)return parseInt(t,10);var i=options,r=0;if("horz"==n?r=sC.innerHeight-($Ps.north?i.north.spacing_open:0)-($Ps.south?i.south.spacing_open:0):"vert"==n&&(r=sC.innerWidth-($Ps.west?i.west.spacing_open:0)-($Ps.east?i.east.spacing_open:0)),-1===t)return r;if(t>0)return round(r*t);if("center"==e)return 0;var o="horz"===n?"height":"width",a=$Ps[e],s="height"===o&&$Cs[e],l=$.layout.showInvisibly(a),c=a.css(o),u=s?s.css(o):0;return a.css(o,"auto"),s&&s.css(o,"auto"),t="height"===o?a.outerHeight():a.outerWidth(),a.css(o,c).css(l),s&&s.css(o,u),t},getPaneSize=function(e,t){var n=$Ps[e],i=options[e],r=state[e],o=t?i.spacing_open:0,a=t?i.spacing_closed:0;return!n||r.isHidden?0:r.isClosed||r.isSliding&&t?a:"horz"===_c[e].dir?n.outerHeight()+o:n.outerWidth()+o},setSizeLimits=function(e,t){if(isInitialized()){var n=options[e],i=state[e],r=_c[e],o=r.dir,a=(r.sizeType.toLowerCase(),void 0!=t?t:i.isSliding),s=($Ps[e],n.spacing_open),l=_c.oppositeEdge[e],c=state[l],u=$Ps[l],d=!u||!1===c.isVisible||c.isSliding?0:"horz"==o?u.outerHeight():u.outerWidth(),h=(!u||c.isHidden?0:options[l][!1!==c.isClosed?"spacing_closed":"spacing_open"])||0,p="horz"==o?sC.innerHeight:sC.innerWidth,f=cssMinDims("center"),g="horz"==o?max(options.center.minHeight,f.minHeight):max(options.center.minWidth,f.minWidth),m=p-s-(a?0:_parseSize("center",g,o)+d+h),v=i.minSize=max(_parseSize(e,n.minSize),cssMinDims(e).minSize),_=i.maxSize=min(n.maxSize?_parseSize(e,n.maxSize):1e5,m),y=i.resizerPosition={},x=sC.inset.top,b=sC.inset.left,w=sC.innerWidth,C=sC.innerHeight,S=n.spacing_open;switch(e){case"north":y.min=x+v,y.max=x+_;break;case"west":y.min=b+v,y.max=b+_;break;case"south":y.min=x+C-_-S,y.max=x+C-v-S;break;case"east":y.min=b+w-_-S,y.max=b+w-v-S}}},calcNewCenterPaneDims=function(){var e={top:getPaneSize("north",!0),bottom:getPaneSize("south",!0),left:getPaneSize("west",!0),right:getPaneSize("east",!0),width:0,height:0};return e.width=sC.innerWidth-e.left-e.right,e.height=sC.innerHeight-e.bottom-e.top,e.top+=sC.inset.top,e.bottom+=sC.inset.bottom,e.left+=sC.inset.left,e.right+=sC.inset.right,e},getHoverClasses=function(e,t){var n=$(e),i=n.data("layoutRole"),r=n.data("layoutEdge"),o=options[r],a=o[i+"Class"],s="-"+r,l="-hover ",c=n.hasClass(a+"-closed")?"-closed":"-open",u="-closed"===c?"-open":"-closed",d=a+l+(a+s+l)+(a+c+l)+(a+s+c+l);return t&&(d+=a+u+l+(a+s+u+l)),"resizer"==i&&n.hasClass(a+"-sliding")&&(d+=a+"-sliding"+l+(a+s)+"-sliding"+l),$.trim(d)},addHover=function(e,t){var n=$(t||this);e&&"toggler"===n.data("layoutRole")&&e.stopPropagation(),n.addClass(getHoverClasses(n))},removeHover=function(e,t){var n=$(t||this);n.removeClass(getHoverClasses(n,!0))},onResizerEnter=function(e){var t=$(this).data("layoutEdge"),n=state[t];$(document);n.isResizing||state.paneResizing||options.maskPanesEarly&&showMasks(t,{resizing:!0})},onResizerLeave=function(e,t){var n=t||this,i=$(n).data("layoutEdge"),r=i+"ResizerLeave";$(document);timer.clear(i+"_openSlider"),timer.clear(r),t?options.maskPanesEarly&&!state.paneResizing&&hideMasks():timer.set(r,function(){onResizerLeave(e,n)},200)},_create=function(){initOptions();var e=options,t=state;return t.creatingLayout=!0,runPluginCallbacks(Instance,$.layout.onCreate),!1===_runCallbacks("onload_start")?"cancel":(_initContainer(),initHotkeys(),$(window).bind("unload."+sID,unload),runPluginCallbacks(Instance,$.layout.onLoad),e.initPanes&&_initLayoutElements(),delete t.creatingLayout,state.initialized)},isInitialized=function(){return!(!state.initialized&&!state.creatingLayout)||_initLayoutElements()},_initLayoutElements=function(e){var t=options;if(!$N.is(":visible"))return!e&&browser.webkit&&"BODY"===$N[0].tagName&&setTimeout(function(){_initLayoutElements(!0)},50),!1;if(!getPane("center").length)return _log(t.errors.centerPaneMissing);if(state.creatingLayout=!0,$.extend(sC,elDims($N,t.inset)),initPanes(),t.scrollToBookmarkOnLoad){var n=self.location;n.hash&&n.replace(n.hash)}return Instance.hasParentLayout?t.resizeWithWindow=!1:t.resizeWithWindow&&$(window).bind("resize."+sID,windowResize),delete state.creatingLayout,state.initialized=!0,runPluginCallbacks(Instance,$.layout.onReady),_runCallbacks("onload_end"),!0},createChildren=function(e,t){var n=evtPane.call(this,e),i=$Ps[n];if(i){var r=$Cs[n],o=state[n],a=options[n],s=options.stateManagement||{},l=t?a.children=t:a.children;if($.isPlainObject(l))l=[l];else if(!l||!$.isArray(l))return;$.each(l,function(e,t){if($.isPlainObject(t)){(t.containerSelector?i.find(t.containerSelector):r||i).each(function(){var e=$(this),i=e.data("layout");if(!i){if(setInstanceKey({container:e,options:t},o),s.includeChildren&&state.stateData[n]){var r=state.stateData[n].children||{},a=r[t.instanceKey],l=t.stateManagement||(t.stateManagement={autoLoad:!0});!0===l.autoLoad&&a&&(l.autoSave=!1,l.includeChildren=!0,l.autoLoad=$.extend(!0,{},a))}i=e.layout(t),i&&refreshChildren(n,i)}})}})}},setInstanceKey=function(e,t){var n=e.container,i=e.options,r=i.stateManagement,o=i.instanceKey||n.data("layoutInstanceKey");return o||(o=(r&&r.cookie?r.cookie.name:"")||i.name),o=o?o.replace(/[^\w-]/gi,"_").replace(/_{2,}/g,"_"):"layout"+ ++t.childIdx,i.instanceKey=o,n.data("layoutInstanceKey",o),o},refreshChildren=function(e,t){var n,i=$Ps[e],r=children[e],o=state[e];$.isPlainObject(r)&&($.each(r,function(e,t){t.destroyed&&delete r[e]}),$.isEmptyObject(r)&&(r=children[e]=null)),t||r||(t=i.data("layout")),t&&(t.hasParentLayout=!0,n=t.options,setInstanceKey(t,o),r||(r=children[e]={}),r[n.instanceKey]=t.container.data("layout")),Instance[e].children=children[e],t||createChildren(e)},windowResize=function(){var e=options,t=Number(e.resizeWithWindowDelay);t<10&&(t=100),timer.clear("winResize"),timer.set("winResize",function(){timer.clear("winResize"),timer.clear("winResizeRepeater");var t=elDims($N,e.inset);t.innerWidth===sC.innerWidth&&t.innerHeight===sC.innerHeight||resizeAll()},t),timer.data.winResizeRepeater||setWindowResizeRepeater()},setWindowResizeRepeater=function(){var e=Number(options.resizeWithWindowMaxDelay);e>0&&timer.set("winResizeRepeater",function(){setWindowResizeRepeater(),resizeAll()},e)},unload=function(){_runCallbacks("onunload_start"),runPluginCallbacks(Instance,$.layout.onUnload),_runCallbacks("onunload_end")},_initContainer=function(){var e,t,n=$N[0],i=$("html"),r=sC.tagName=n.tagName,o=sC.id=n.id,a=sC.className=n.className,s=options,l=s.name,c="position,margin,padding,border",u="layoutCSS",d={},h="hidden",p=$N.data("parentLayout"),f=$N.data("layoutEdge"),g=p&&f,m=$.layout.cssNum;sC.selector=$N.selector.split(".slice")[0],sC.ref=(s.name?s.name+" layout / ":"")+r+(o?"#"+o:a?".["+a+"]":""),sC.isBody="BODY"===r,g||sC.isBody||(e=$N.closest("."+$.layout.defaults.panes.paneClass),p=e.data("parentLayout"),f=e.data("layoutEdge"),g=p&&f),$N.data({layout:Instance,layoutContainer:sID}).addClass(s.containerClass);var v={destroy:"",initPanes:"",resizeAll:"resizeAll",resize:"resizeAll"};for(l in v)$N.bind("layout"+l.toLowerCase()+"."+sID,Instance[v[l]||l]);g&&(Instance.hasParentLayout=!0,p.refreshChildren(f,Instance)),$N.data(u)||(sC.isBody?($N.data(u,$.extend(styles($N,c),{height:$N.css("height"),overflow:$N.css("overflow"),overflowX:$N.css("overflowX"),overflowY:$N.css("overflowY")})),i.data(u,$.extend(styles(i,"padding"),{height:"auto",overflow:i.css("overflow"),overflowX:i.css("overflowX"),overflowY:i.css("overflowY")}))):$N.data(u,styles($N,c+",top,bottom,left,right,width,height,overflow,overflowX,overflowY")));try{if(d={overflow:h,overflowX:h,overflowY:h},$N.css(d),s.inset&&!$.isPlainObject(s.inset)&&(t=parseInt(s.inset,10)||0,s.inset={top:t,bottom:t,left:t,right:t}),sC.isBody)s.outset?$.isPlainObject(s.outset)||(t=parseInt(s.outset,10)||0,s.outset={top:t,bottom:t,left:t,right:t}):s.outset={top:m(i,"paddingTop"),bottom:m(i,"paddingBottom"),left:m(i,"paddingLeft"),right:m(i,"paddingRight")},i.css(d).css({height:"100%",border:"none",padding:0,margin:0}),browser.isIE6?($N.css({width:"100%",height:"100%",border:"none",padding:0,margin:0,position:"relative"}),s.inset||(s.inset=elDims($N).inset)):($N.css({width:"auto",height:"auto",margin:0,position:"absolute"}),$N.css(s.outset)),$.extend(sC,elDims($N,s.inset));else{var _=$N.css("position");_&&_.match(/(fixed|absolute|relative)/)||$N.css("position","relative"),$N.is(":visible")&&($.extend(sC,elDims($N,s.inset)),sC.innerHeight<1&&_log(s.errors.noContainerHeight.replace(/CONTAINER/,sC.ref)))}m($N,"minWidth")&&$N.parent().css("overflowX","auto"),m($N,"minHeight")&&$N.parent().css("overflowY","auto")}catch(e){}},initHotkeys=function(e){e=e?e.split(","):_c.borderPanes,$.each(e,function(e,t){var n=options[t];if(n.enableCursorHotkey||n.customHotkey)return $(document).bind("keydown."+sID,keyDown),!1})},initOptions=function(){function createFxOptions(e){var t=options[e],n=options.panes;t.fxSettings||(t.fxSettings={}),n.fxSettings||(n.fxSettings={}),$.each(["_open","_close","_size"],function(i,r){var o="fxName"+r,a="fxSpeed"+r,s="fxSettings"+r,l=t[o]=t[o]||n[o]||t.fxName||n.fxName||"none",c=$.effects&&($.effects[l]||$.effects.effect&&$.effects.effect[l]);"none"!==l&&options.effects[l]&&c||(l=t[o]="none");var u=options.effects[l]||{},d=u.all||null,h=u[e]||null;t[a]=t[a]||n[a]||t.fxSpeed||n.fxSpeed||null,t[s]=$.extend(!0,{},d,h,n.fxSettings,t.fxSettings,n[s],t[s])}),delete t.fxName,delete t.fxSpeed,delete t.fxSettings}var e,t,n,i,r,o,a;if(opts=$.layout.transformData(opts,!0),opts=$.layout.backwardCompatibility.renameAllOptions(opts),!$.isEmptyObject(opts.panes)){for(e=$.layout.optionsMap.noDefault,r=0,o=e.length;r<o;r++)n=e[r],delete opts.panes[n];for(e=$.layout.optionsMap.layout,r=0,o=e.length;r<o;r++)n=e[r],delete opts.panes[n]}e=$.layout.optionsMap.layout;var s=$.layout.config.optionRootKeys;for(n in opts)i=opts[n],$.inArray(n,s)<0&&$.inArray(n,e)<0&&(opts.panes[n]||(opts.panes[n]=$.isPlainObject(i)?$.extend(!0,{},i):i),delete opts[n]);$.extend(!0,options,opts),$.each(_c.allPanes,function(i,r){if(_c[r]=$.extend(!0,{},_c.panes,_c[r]),t=options.panes,a=options[r],"center"===r)for(e=$.layout.optionsMap.center,i=0,o=e.length;i<o;i++)n=e[i],opts.center[n]||!opts.panes[n]&&a[n]||(a[n]=t[n]);else a=options[r]=$.extend(!0,{},t,a),createFxOptions(r),a.resizerClass||(a.resizerClass="ui-layout-resizer"),a.togglerClass||(a.togglerClass="ui-layout-toggler");a.paneClass||(a.paneClass="ui-layout-pane")});var l=opts.zIndex,c=options.zIndexes;l>0&&(c.pane_normal=l,c.content_mask=max(l+1,c.content_mask),c.resizer_normal=max(l+2,c.resizer_normal)),delete options.panes},getPane=function(e){var t=options[e].paneSelector;if("#"===t.substr(0,1))return $N.find(t).eq(0);var n=$N.children(t).eq(0);return n.length?n:$N.children("form:first").children(t).eq(0)},initPanes=function(e){evtPane(e),$.each(_c.allPanes,function(e,t){addPane(t,!0)}),initHandles(),$.each(_c.borderPanes,function(e,t){$Ps[t]&&state[t].isVisible&&(setSizeLimits(t),makePaneFit(t))}),sizeMidPanes("center"),$.each(_c.allPanes,function(e,t){afterInitPane(t)})},addPane=function(e,t){if(t||isInitialized()){var n,i,r,o=options[e],a=state[e],s=_c[e],l=s.dir,c=(a.fx,o.spacing_open,"center"===e),u={},d=$Ps[e];if(d?removePane(e,!1,!0,!1):$Cs[e]=!1,d=$Ps[e]=getPane(e),!d.length)return void($Ps[e]=!1);if(!d.data("layoutCSS")){d.data("layoutCSS",styles(d,"position,top,left,bottom,right,width,height,overflow,zIndex,display,backgroundColor,padding,margin,border"))}Instance[e]={name:e,pane:$Ps[e],content:$Cs[e],options:options[e],state:state[e],children:children[e]},d.data({parentLayout:Instance,layoutPane:Instance[e],layoutEdge:e,layoutRole:"pane"}).css(s.cssReq).css("zIndex",options.zIndexes.pane_normal).css(o.applyDemoStyles?s.cssDemo:{}).addClass(o.paneClass+" "+o.paneClass+"-"+e).bind("mouseenter."+sID,addHover).bind("mouseleave."+sID,removeHover);var h,p={hide:"",show:"",toggle:"",close:"",open:"",slideOpen:"",slideClose:"",slideToggle:"",size:"sizePane",sizePane:"sizePane",sizeContent:"",sizeHandles:"",enableClosable:"",disableClosable:"",enableSlideable:"",disableSlideable:"",enableResizable:"",disableResizable:"",swapPanes:"swapPanes",swap:"swapPanes",move:"swapPanes",removePane:"removePane",remove:"removePane",createChildren:"",resizeChildren:"",resizeAll:"resizeAll",resizeLayout:"resizeAll"};for(h in p)d.bind("layoutpane"+h.toLowerCase()+"."+sID,Instance[p[h]||h]);initContent(e,!1),c||(n=a.size=_parseSize(e,o.size),i=_parseSize(e,o.minSize)||1,r=_parseSize(e,o.maxSize)||1e5,n>0&&(n=max(min(n,r),i)),a.autoResize=o.autoResize,a.isClosed=!1,a.isSliding=!1,a.isResizing=!1,a.isHidden=!1,a.pins||(a.pins=[])),a.tagName=d[0].tagName,a.edge=e,a.noRoom=!1,a.isVisible=!0,setPanePosition(e),"horz"===l?u.height=cssH(d,n):"vert"===l&&(u.width=cssW(d,n)),d.css(u),"horz"!=l&&sizeMidPanes(e,!0),state.initialized&&(initHandles(e),initHotkeys(e)),o.initClosed&&o.closable&&!o.initHidden?close(e,!0,!0):o.initHidden||o.initClosed?hide(e):a.noRoom||d.css("display","block"),d.css("visibility","visible"),o.showOverflowOnHover&&d.hover(allowOverflow,resetOverflow),state.initialized&&afterInitPane(e)}},afterInitPane=function(e){var t=$Ps[e],n=state[e],i=options[e];t&&(t.data("layout")&&refreshChildren(e,t.data("layout")),n.isVisible&&(state.initialized?resizeAll():sizeContent(e),i.triggerEventsOnLoad?_runCallbacks("onresize_end",e):resizeChildren(e,!0)),i.initChildren&&i.children&&createChildren(e))},setPanePosition=function(e){e=e?e.split(","):_c.borderPanes,$.each(e,function(e,t){var n=$Ps[t],i=$Rs[t],r=(options[t],state[t]),o=_c[t].side,a={};if(n){switch(t){case"north":a.top=sC.inset.top,a.left=sC.inset.left,a.right=sC.inset.right;break;case"south":a.bottom=sC.inset.bottom,a.left=sC.inset.left,a.right=sC.inset.right;break;case"west":a.left=sC.inset.left;break;case"east":a.right=sC.inset.right}n.css(a),i&&r.isClosed?i.css(o,sC.inset[o]):i&&!r.isHidden&&i.css(o,sC.inset[o]+getPaneSize(t))}})},initHandles=function(e){e=e?e.split(","):_c.borderPanes,$.each(e,function(e,t){var n=$Ps[t];if($Rs[t]=!1,$Ts[t]=!1,n){var i=options[t],r=state[t],o=(_c[t],"#"===i.paneSelector.substr(0,1)?i.paneSelector.substr(1):""),a=i.resizerClass,s=i.togglerClass,l=(r.isVisible?i.spacing_open:i.spacing_closed,"-"+t),c=(r.isVisible,Instance[t]),u=c.resizer=$Rs[t]=$("<div></div>"),d=c.toggler=!!i.closable&&($Ts[t]=$("<div></div>"));!r.isVisible&&i.slidable&&u.attr("title",i.tips.Slide).css("cursor",i.sliderCursor),u.attr("id",o?o+"-resizer":"").data({parentLayout:Instance,layoutPane:Instance[t],layoutEdge:t,layoutRole:"resizer"}).css(_c.resizers.cssReq).css("zIndex",options.zIndexes.resizer_normal).css(i.applyDemoStyles?_c.resizers.cssDemo:{}).addClass(a+" "+a+l).hover(addHover,removeHover).hover(onResizerEnter,onResizerLeave).mousedown($.layout.disableTextSelection).mouseup($.layout.enableTextSelection).appendTo($N),$.fn.disableSelection&&u.disableSelection(),i.resizerDblClickToggle&&u.bind("dblclick."+sID,toggle),d&&(d.attr("id",o?o+"-toggler":"").data({parentLayout:Instance,layoutPane:Instance[t],layoutEdge:t,layoutRole:"toggler"}).css(_c.togglers.cssReq).css(i.applyDemoStyles?_c.togglers.cssDemo:{}).addClass(s+" "+s+l).hover(addHover,removeHover).bind("mouseenter",onResizerEnter).appendTo(u),i.togglerContent_open&&$("<span>"+i.togglerContent_open+"</span>").data({layoutEdge:t,layoutRole:"togglerContent"}).data("layoutRole","togglerContent").data("layoutEdge",t).addClass("content content-open").css("display","none").appendTo(d),i.togglerContent_closed&&$("<span>"+i.togglerContent_closed+"</span>").data({layoutEdge:t,layoutRole:"togglerContent"}).addClass("content content-closed").css("display","none").appendTo(d),enableClosable(t)),initResizable(t),r.isVisible?setAsOpen(t):(setAsClosed(t),bindStartSlidingEvents(t,!0))}}),sizeHandles()},initContent=function(e,t){if(isInitialized()){var n,i=options[e],r=i.contentSelector,o=Instance[e],a=$Ps[e];r&&(n=o.content=$Cs[e]=i.findNestedContent?a.find(r).eq(0):a.children(r).eq(0)),n&&n.length?(n.data("layoutRole","content"),n.data("layoutCSS")||n.data("layoutCSS",styles(n,"height")),n.css(_c.content.cssReq),i.applyDemoStyles&&(n.css(_c.content.cssDemo),a.css(_c.content.cssDemoPane)),a.css("overflowX").match(/(scroll|auto)/)&&a.css("overflow","hidden"),state[e].content={},!1!==t&&sizeContent(e)):o.content=$Cs[e]=!1}},initResizable=function(e){var t=$.layout.plugins.draggable;e=e?e.split(","):_c.borderPanes,$.each(e,function(e,i){var r=options[i];if(!t||!$Ps[i]||!r.resizable)return r.resizable=!1,!0;var o,a,s=state[i],l=options.zIndexes,c=_c[i],u="horz"==c.dir?"top":"left",d=($Ps[i],$Rs[i]),h=r.resizerClass,p=0,f=h+"-drag",g=h+"-"+i+"-drag",m=h+"-dragging",v=h+"-"+i+"-dragging",_=h+"-dragging-limit",y=h+"-"+i+"-dragging-limit",x=!1;s.isClosed||d.attr("title",r.tips.Resize).css("cursor",r.resizerCursor),d.draggable({containment:$N[0],axis:"horz"==c.dir?"y":"x",delay:0,distance:1,grid:r.resizingGrid,helper:"clone",opacity:r.resizerDragOpacity,addClasses:!1,zIndex:l.resizer_drag,start:function(e,t){if(r=options[i],s=state[i],a=r.livePaneResizing,!1===_runCallbacks("ondrag_start",i))return!1;s.isResizing=!0,state.paneResizing=i,timer.clear(i+"_closeSlider"),setSizeLimits(i),o=s.resizerPosition,p=t.position[u],d.addClass(f+" "+g),x=!1,showMasks(i,{resizing:!0})},drag:function(e,t){x||(t.helper.addClass(m+" "+v).css({right:"auto",bottom:"auto"}).children().css("visibility","hidden"),x=!0,s.isSliding&&$Ps[i].css("zIndex",l.pane_sliding));var c=0;t.position[u]<o.min?(t.position[u]=o.min,c=-1):t.position[u]>o.max&&(t.position[u]=o.max,c=1),c?(t.helper.addClass(_+" "+y),window.defaultStatus=c>0&&i.match(/(north|west)/)||c<0&&i.match(/(south|east)/)?r.tips.maxSizeWarning:r.tips.minSizeWarning):(t.helper.removeClass(_+" "+y),window.defaultStatus=""),a&&Math.abs(t.position[u]-p)>=r.liveResizingTolerance&&(p=t.position[u],n(e,t,i))},stop:function(e,t){$("body").enableSelection(),window.defaultStatus="",d.removeClass(f+" "+g),s.isResizing=!1,state.paneResizing=!1,n(e,t,i,!0)}})});var n=function(e,t,n,i){var r,o=t.position,a=_c[n],s=options[n],l=state[n];switch(n){case"north":r=o.top;break;case"west":r=o.left;break;case"south":r=sC.layoutHeight-o.top-s.spacing_open;break;case"east":r=sC.layoutWidth-o.left-s.spacing_open}var c=r-sC.inset[a.side];if(i)!1!==_runCallbacks("ondrag_end",n)&&manualSizePane(n,c,!1,!0),hideMasks(!0),l.isSliding&&showMasks(n,{resizing:!0});else{if(Math.abs(c-l.size)<s.liveResizingTolerance)return;manualSizePane(n,c,!1,!0),sizeMasks()}}},sizeMask=function(){var e=$(this),t=e.data("layoutMask"),n=state[t];"IFRAME"==n.tagName&&n.isVisible&&e.css({top:n.offsetTop,left:n.offsetLeft,width:n.outerWidth,height:n.outerHeight})},sizeMasks=function(){$Ms.each(sizeMask)},showMasks=function(e,t){var n,i,r=_c[e],o=["center"],a=options.zIndexes,s=$.extend({objectsOnly:!1,animation:!1,resizing:!0,sliding:state[e].isSliding},t);s.resizing&&o.push(e),s.sliding&&o.push(_c.oppositeEdge[e]),"horz"===r.dir&&(o.push("west"),o.push("east")),$.each(o,function(e,t){i=state[t],n=options[t],i.isVisible&&(n.maskObjects||!s.objectsOnly&&n.maskContents)&&getMasks(t).each(function(){sizeMask.call(this),this.style.zIndex=i.isSliding?a.pane_sliding+1:a.pane_normal+1,this.style.display="block"})})},hideMasks=function(e){if(e||!state.paneResizing)$Ms.hide();else if(!e&&!$.isEmptyObject(state.panesSliding))for(var t,n,i=$Ms.length-1;i>=0;i--)n=$Ms.eq(i),t=n.data("layoutMask"),options[t].maskObjects||n.hide()},getMasks=function(e){for(var t,n=$([]),i=0,r=$Ms.length;i<r;i++)t=$Ms.eq(i),t.data("layoutMask")===e&&(n=n.add(t));return n.length?n:createMasks(e)},createMasks=function(e){var t,n,i,r,o,a=$Ps[e],s=state[e],l=options[e],c=options.zIndexes;if(!l.maskContents&&!l.maskObjects)return $([]);for(o=0;o<(l.maskObjects?2:1);o++)t=l.maskObjects&&0==o,n=document.createElement(t?"iframe":"div"),i=$(n).data("layoutMask",e),n.className="ui-layout-mask ui-layout-mask-"+e,r=n.style,r.background="#FFF",r.position="absolute",r.display="block",t?(n.src="about:blank",n.frameborder=0,r.border=0,r.opacity=0,r.filter="Alpha(Opacity='0')"):(r.opacity=.001,r.filter="Alpha(Opacity='1')"),"IFRAME"==s.tagName?(r.zIndex=c.pane_normal+1,$N.append(n)):(i.addClass("ui-layout-mask-inside-pane"),r.zIndex=l.maskZindex||c.content_mask,r.top=0,r.left=0,r.width="100%",r.height="100%",a.append(n)),$Ms=$Ms.add(n);return $Ms},destroy=function(e,t){$(window).unbind("."+sID),$(document).unbind("."+sID),"object"==typeof e?evtPane(e):t=e,$N.clearQueue().removeData("layout").removeData("layoutContainer").removeClass(options.containerClass).unbind("."+sID),$Ms.remove(),$.each(_c.allPanes,function(e,n){removePane(n,!1,!0,t)});var n="layoutCSS";$N.data(n)&&!$N.data("layoutRole")&&$N.css($N.data(n)).removeData(n),"BODY"===sC.tagName&&($N=$("html")).data(n)&&$N.css($N.data(n)).removeData(n),runPluginCallbacks(Instance,$.layout.onDestroy),unload();for(var i in Instance)i.match(/^(container|options)$/)||delete Instance[i];return Instance.destroyed=!0,Instance},removePane=function(e,t,n,i){if(isInitialized()){var r=evtPane.call(this,e),o=$Ps[r],a=$Cs[r],s=$Rs[r],l=$Ts[r];o&&$.isEmptyObject(o.data())&&(o=!1),a&&$.isEmptyObject(a.data())&&(a=!1),s&&$.isEmptyObject(s.data())&&(s=!1),l&&$.isEmptyObject(l.data())&&(l=!1),o&&o.stop(!0,!0);var c=options[r],u=(state[r],"layoutCSS"),d=children[r],h=$.isPlainObject(d)&&!$.isEmptyObject(d),p=void 0!==i?i:c.destroyChildren;if(h&&p&&($.each(d,function(e,t){t.destroyed||t.destroy(!0),t.destroyed&&delete d[e]}),$.isEmptyObject(d)&&(d=children[r]=null,h=!1)),o&&t&&!h)o.remove();else if(o&&o[0]){var f=c.paneClass,g=f+"-"+r,m=[f,f+"-open",f+"-closed",f+"-sliding",g,g+"-open",g+"-closed",g+"-sliding"];$.merge(m,getHoverClasses(o,!0)),o.removeClass(m.join(" ")).removeData("parentLayout").removeData("layoutPane").removeData("layoutRole").removeData("layoutEdge").removeData("autoHidden").unbind("."+sID),h&&a?(a.width(a.width()),$.each(d,function(e,t){t.resizeAll()})):a&&a.css(a.data(u)).removeData(u).removeData("layoutRole"),o.data("layout")||o.css(o.data(u)).removeData(u)}l&&l.remove(),s&&s.remove(),Instance[r]=$Ps[r]=$Cs[r]=$Rs[r]=$Ts[r]=!1,{removed:!0},n||resizeAll()}},_hidePane=function(e){var t=$Ps[e],n=options[e],i=t[0].style;n.useOffscreenClose?(t.data(_c.offscreenReset)||t.data(_c.offscreenReset,{left:i.left,right:i.right}),t.css(_c.offscreenCSS)):t.hide().removeData(_c.offscreenReset)},_showPane=function(e){var t=$Ps[e],n=options[e],i=_c.offscreenCSS,r=t.data(_c.offscreenReset),o=t[0].style;t.show().removeData(_c.offscreenReset),n.useOffscreenClose&&r&&(o.left==i.left&&(o.left=r.left),o.right==i.right&&(o.right=r.right))},hide=function(e,t){if(isInitialized()){var n=evtPane.call(this,e),i=options[n],r=state[n],o=$Ps[n],a=$Rs[n];"center"!==n&&o&&!r.isHidden&&(state.initialized&&!1===_runCallbacks("onhide_start",n)||(r.isSliding=!1,delete state.panesSliding[n],a&&a.hide(),!state.initialized||r.isClosed?(r.isClosed=!0,r.isHidden=!0,r.isVisible=!1,state.initialized||_hidePane(n),sizeMidPanes("horz"===_c[n].dir?"":"center"),(state.initialized||i.triggerEventsOnLoad)&&_runCallbacks("onhide_end",n)):(r.isHiding=!0,close(n,!1,t))))}},show=function(e,t,n,i){if(isInitialized()){var r=evtPane.call(this,e),o=(options[r],state[r]),a=$Ps[r];$Rs[r];"center"!==r&&a&&o.isHidden&&!1!==_runCallbacks("onshow_start",r)&&(o.isShowing=!0,o.isSliding=!1,delete state.panesSliding[r],!1===t?close(r,!0):open(r,!1,n,i))}},toggle=function(e,t){if(isInitialized()){var n=evtObj(e),i=evtPane.call(this,e),r=state[i];n&&n.stopImmediatePropagation(),r.isHidden?show(i):r.isClosed?open(i,!!t):close(i)}},_closePane=function(e,t){var n=($Ps[e],state[e]);_hidePane(e),n.isClosed=!0,n.isVisible=!1,t&&setAsClosed(e)},close=function(e,t,n,i){function close_2(){d.isMoving=!1,bindStartSlidingEvents(r,!0);var e=_c.oppositeEdge[r];state[e].noRoom&&(setSizeLimits(e),makePaneFit(e)),i||!state.initialized&&!u.triggerEventsOnLoad||(a||_runCallbacks("onclose_end",r),a&&_runCallbacks("onshow_end",r),s&&_runCallbacks("onhide_end",r))}var r=evtPane.call(this,e);if("center"!==r){if(!state.initialized&&$Ps[r])return void _closePane(r,!0);if(isInitialized()){var o,a,s,l,c=$Ps[r],u=($Rs[r],$Ts[r],options[r]),d=state[r];_c[r];$N.queue(function(e){if(!c||!u.closable&&!d.isShowing&&!d.isHiding||!t&&d.isClosed&&!d.isShowing)return e();var i=!d.isShowing&&!1===_runCallbacks("onclose_start",r);if(a=d.isShowing,s=d.isHiding,l=d.isSliding,delete d.isShowing,delete d.isHiding,i)return e();o=!n&&!d.isClosed&&"none"!=u.fxName_close,d.isMoving=!0,d.isClosed=!0,d.isVisible=!1,s?d.isHidden=!0:a&&(d.isHidden=!1),d.isSliding?bindStopSlidingEvents(r,!1):sizeMidPanes("horz"===_c[r].dir?"":"center",!1),setAsClosed(r),o?(lockPaneForFX(r,!0),c.hide(u.fxName_close,u.fxSettings_close,u.fxSpeed_close,function(){lockPaneForFX(r,!1),d.isClosed&&close_2(),e()})):(_hidePane(r),close_2(),e())})}}},setAsClosed=function(e){if($Rs[e]){var t=($Ps[e],$Rs[e]),n=$Ts[e],i=options[e],r=state[e],o=_c[e].side,a=i.resizerClass,s=i.togglerClass,l="-"+e;t.css(o,sC.inset[o]).removeClass(a+"-open "+a+l+"-open").removeClass(a+"-sliding "+a+l+"-sliding").addClass(a+"-closed "+a+l+"-closed"),r.isHidden&&t.hide(),i.resizable&&$.layout.plugins.draggable&&t.draggable("disable").removeClass("ui-state-disabled").css("cursor","default").attr("title",""),n&&(n.removeClass(s+"-open "+s+l+"-open").addClass(s+"-closed "+s+l+"-closed").attr("title",i.tips.Open),n.children(".content-open").hide(),n.children(".content-closed").css("display","block")),syncPinBtns(e,!1),state.initialized&&sizeHandles()}},open=function(e,t,n,i){function open_2(){c.isMoving=!1,_fixIframe(a),c.isSliding||sizeMidPanes("vert"==_c[a].dir?"center":"",!1),setAsOpen(a)}if(isInitialized()){var r,o,a=evtPane.call(this,e),s=$Ps[a],l=($Rs[a],$Ts[a],options[a]),c=state[a];_c[a];"center"!==a&&$N.queue(function(e){if(!s||!l.resizable&&!l.closable&&!c.isShowing||c.isVisible&&!c.isSliding)return e();if(c.isHidden&&!c.isShowing)return e(),void show(a,!0);c.autoResize&&c.size!=l.size?sizePane(a,l.size,!0,!0,!0):setSizeLimits(a,t);var u=_runCallbacks("onopen_start",a);return"abort"===u?e():("NC"!==u&&setSizeLimits(a,t),c.minSize>c.maxSize?(syncPinBtns(a,!1),!i&&l.tips.noRoomToOpen&&alert(l.tips.noRoomToOpen),e()):(t?bindStopSlidingEvents(a,!0):c.isSliding?bindStopSlidingEvents(a,!1):l.slidable&&bindStartSlidingEvents(a,!1),c.noRoom=!1,makePaneFit(a),o=c.isShowing,delete c.isShowing,r=!n&&c.isClosed&&"none"!=l.fxName_open,c.isMoving=!0,c.isVisible=!0,c.isClosed=!1,o&&(c.isHidden=!1),void(r?(lockPaneForFX(a,!0),s.show(l.fxName_open,l.fxSettings_open,l.fxSpeed_open,function(){lockPaneForFX(a,!1),c.isVisible&&open_2(),e()})):(_showPane(a),open_2(),e()))))})}},setAsOpen=function(e,t){var n=$Ps[e],i=$Rs[e],r=$Ts[e],o=options[e],a=state[e],s=_c[e].side,l=o.resizerClass,c=o.togglerClass,u="-"+e;i.css(s,sC.inset[s]+getPaneSize(e)).removeClass(l+"-closed "+l+u+"-closed").addClass(l+"-open "+l+u+"-open"),a.isSliding?i.addClass(l+"-sliding "+l+u+"-sliding"):i.removeClass(l+"-sliding "+l+u+"-sliding"),removeHover(0,i),o.resizable&&$.layout.plugins.draggable?i.draggable("enable").css("cursor",o.resizerCursor).attr("title",o.tips.Resize):a.isSliding||i.css("cursor","default"),r&&(r.removeClass(c+"-closed "+c+u+"-closed").addClass(c+"-open "+c+u+"-open").attr("title",o.tips.Close),removeHover(0,r),r.children(".content-closed").hide(),r.children(".content-open").css("display","block")),syncPinBtns(e,!a.isSliding),$.extend(a,elDims(n)),state.initialized&&(sizeHandles(),sizeContent(e,!0)),!t&&(state.initialized||o.triggerEventsOnLoad)&&n.is(":visible")&&(_runCallbacks("onopen_end",e),a.isShowing&&_runCallbacks("onshow_end",e),state.initialized&&_runCallbacks("onresize_end",e))},slideOpen=function(e){function open_NOW(){i.isClosed?i.isMoving||open(n,!0):bindStopSlidingEvents(n,!0)}if(isInitialized()){var t=evtObj(e),n=evtPane.call(this,e),i=state[n],r=options[n].slideDelay_open;"center"!==n&&(t&&t.stopImmediatePropagation(),i.isClosed&&t&&"mouseenter"===t.type&&r>0?timer.set(n+"_openSlider",open_NOW,r):open_NOW())}},slideClose=function(e){function close_NOW(){r.isClosed?bindStopSlidingEvents(n,!1):r.isMoving||close(n)}if(isInitialized()){var t=evtObj(e),n=evtPane.call(this,e),i=options[n],r=state[n],o=r.isMoving?1e3:300;if("center"!==n&&!r.isClosed&&!r.isResizing)if("click"===i.slideTrigger_close)close_NOW();else{if(i.preventQuickSlideClose&&r.isMoving)return;if(i.preventPrematureSlideClose&&t&&$.layout.isMouseOverElem(t,$Ps[n]))return;t?timer.set(n+"_closeSlider",close_NOW,max(i.slideDelay_close,o)):close_NOW()}}},slideToggle=function(e){var t=evtPane.call(this,e);toggle(t,!0)},lockPaneForFX=function(e,t){var n=$Ps[e],i=state[e],r=options[e],o=options.zIndexes;t?(showMasks(e,{animation:!0,objectsOnly:!0}),n.css({zIndex:o.pane_animate}),"south"==e?n.css({top:sC.inset.top+sC.innerHeight-n.outerHeight()}):"east"==e&&n.css({left:sC.inset.left+sC.innerWidth-n.outerWidth()})):(hideMasks(),n.css({zIndex:i.isSliding?o.pane_sliding:o.pane_normal}),"south"==e?n.css({top:"auto"}):"east"!=e||n.css("left").match(/\-99999/)||n.css({left:"auto"}),browser.msie&&r.fxOpacityFix&&"slide"!=r.fxName_open&&n.css("filter")&&1==n.css("opacity")&&n[0].style.removeAttribute("filter"))},bindStartSlidingEvents=function(e,t){var n=options[e],i=($Ps[e],$Rs[e]),r=n.slideTrigger_open.toLowerCase();!i||t&&!n.slidable||(r.match(/mouseover/)?r=n.slideTrigger_open="mouseenter":r.match(/(click|dblclick|mouseenter)/)||(r=n.slideTrigger_open="click"),n.resizerDblClickToggle&&r.match(/click/)&&i[t?"unbind":"bind"]("dblclick."+sID,toggle),i[t?"bind":"unbind"](r+"."+sID,slideOpen).css("cursor",t?n.sliderCursor:"default").attr("title",t?n.tips.Slide:""))},bindStopSlidingEvents=function(e,t){function cancelMouseOut(t){timer.clear(e+"_closeSlider"),t.stopPropagation()}var n=options[e],i=state[e],r=(_c[e],options.zIndexes),o=n.slideTrigger_close.toLowerCase(),a=t?"bind":"unbind",s=$Ps[e],l=$Rs[e];timer.clear(e+"_closeSlider"),t?(i.isSliding=!0,state.panesSliding[e]=!0,bindStartSlidingEvents(e,!1)):(i.isSliding=!1,delete state.panesSliding[e]),s.css("zIndex",t?r.pane_sliding:r.pane_normal),l.css("zIndex",t?r.pane_sliding+2:r.resizer_normal),o.match(/(click|mouseleave)/)||(o=n.slideTrigger_close="mouseleave"),l[a](o,slideClose),"mouseleave"===o&&(s[a]("mouseleave."+sID,slideClose),l[a]("mouseenter."+sID,cancelMouseOut),s[a]("mouseenter."+sID,cancelMouseOut)),t?"click"!==o||n.resizable||(l.css("cursor",t?n.sliderCursor:"default"),l.attr("title",t?n.tips.Close:"")):timer.clear(e+"_closeSlider")},makePaneFit=function(e,t,n,i){var r=options[e],o=state[e],a=_c[e],s=$Ps[e],l=$Rs[e],c="vert"===a.dir,u=!1;if(("center"===e||c&&o.noVerticalRoom)&&(u=o.maxHeight>=0,u&&o.noRoom?(_showPane(e),l&&l.show(),o.isVisible=!0,o.noRoom=!1,c&&(o.noVerticalRoom=!1),_fixIframe(e)):u||o.noRoom||(_hidePane(e),l&&l.hide(),o.isVisible=!1,o.noRoom=!0)),"center"===e);else if(o.minSize<=o.maxSize){if(u=!0,o.size>o.maxSize)sizePane(e,o.maxSize,n,!0,i);else if(o.size<o.minSize)sizePane(e,o.minSize,n,!0,i);else if(l&&o.isVisible&&s.is(":visible")){var d=o.size+sC.inset[a.side];$.layout.cssNum(l,a.side)!=d&&l.css(a.side,d)}o.noRoom&&(o.wasOpen&&r.closable?r.autoReopen?open(e,!1,!0,!0):o.noRoom=!1:show(e,o.wasOpen,!0,!0))}else o.noRoom||(o.noRoom=!0,o.wasOpen=!o.isClosed&&!o.isSliding,o.isClosed||(r.closable?close(e,!0,!0):hide(e,!0)))},manualSizePane=function(e,t,n,i,r){if(isInitialized()){var o=evtPane.call(this,e),a=options[o],s=state[o],l=r||a.livePaneResizing&&!s.isResizing;"center"!==o&&(s.autoResize=!1,sizePane(o,t,n,i,l))}},sizePane=function(e,t,n,i,r){function sizePane_2(){for(var e="width"===p?u.outerWidth():u.outerHeight(),i=[{pane:s,count:1,target:t,actual:e,correct:t===e,attempt:t,cssSize:a}],l=i[0],g={},m="Inaccurate size after resizing the "+s+"-pane.";!(l.correct||(g={pane:s,count:l.count+1,target:t},l.actual>t?g.attempt=max(0,l.attempt-(l.actual-t)):g.attempt=max(0,l.attempt+(t-l.actual)),g.cssSize=cssSize(s,g.attempt),u.css(p,g.cssSize),g.actual="width"==p?u.outerWidth():u.outerHeight(),g.correct=t===g.actual,1===i.length&&(_log(m,!1,!0),_log(l,!1,!0)),_log(g,!1,!0),i.length>3));)i.push(g),l=i[i.length-1];c.size=t,$.extend(c,elDims(u)),c.isVisible&&u.is(":visible")&&(d&&d.css(h,t+sC.inset[h]),sizeContent(s)),!n&&!f&&state.initialized&&c.isVisible&&_runCallbacks("onresize_end",s),n||(c.isSliding||sizeMidPanes("horz"==_c[s].dir?"":"center",f,r),sizeHandles());var v=_c.oppositeEdge[s];t<o&&state[v].noRoom&&(setSizeLimits(v),makePaneFit(v,!1,n)),i.length>1&&_log(m+"\nSee the Error Console for details.",!0,!0)}if(isInitialized()){var o,a,s=evtPane.call(this,e),l=options[s],c=state[s],u=$Ps[s],d=$Rs[s],h=_c[s].side,p=_c[s].sizeType.toLowerCase(),f=c.isResizing&&!l.triggerEventsDuringLiveResize,g=!0!==i&&l.animatePaneSizing;"center"!==s&&$N.queue(function(e){if(setSizeLimits(s),o=c.size,t=_parseSize(s,t),t=max(t,_parseSize(s,l.minSize)),(t=min(t,c.maxSize))<c.minSize)return e(),void makePaneFit(s,!1,n);if(!r&&t===o)return e();if(c.newSize=t,!n&&state.initialized&&c.isVisible&&_runCallbacks("onresize_start",s),a=cssSize(s,t),g&&u.is(":visible")){var i=$.layout.effects.size[s]||$.layout.effects.size.all,d=l.fxSettings_size.easing||i.easing,h=options.zIndexes,f={};f[p]=a+"px",c.isMoving=!0,u.css({zIndex:h.pane_animate}).show().animate(f,l.fxSpeed_size,d,function(){u.css({zIndex:c.isSliding?h.pane_sliding:h.pane_normal}),c.isMoving=!1,delete c.newSize,sizePane_2(),e()})}else u.css(p,a),delete c.newSize,u.is(":visible")?sizePane_2():c.size=t,e()})}},sizeMidPanes=function(e,t,n){e=(e||"east,west,center").split(","),$.each(e,function(e,i){if($Ps[i]){var r=options[i],o=state[i],a=$Ps[i],s=($Rs[i],!0),l={},c=$.layout.showInvisibly(a),u=calcNewCenterPaneDims();if($.extend(o,elDims(a)),"center"===i){if(!n&&o.isVisible&&u.width===o.outerWidth&&u.height===o.outerHeight)return a.css(c),!0;if($.extend(o,cssMinDims(i),{maxWidth:u.width,maxHeight:u.height}),l=u,o.newWidth=l.width,o.newHeight=l.height,l.width=cssW(a,l.width),l.height=cssH(a,l.height),s=l.width>=0&&l.height>=0,!state.initialized&&r.minWidth>u.width){var d=r.minWidth-o.outerWidth,h=options.east.minSize||0,p=options.west.minSize||0,f=state.east.size,g=state.west.size,m=f,v=g;if(d>0&&state.east.isVisible&&f>h&&(m=max(f-h,f-d),d-=f-m),d>0&&state.west.isVisible&&g>p&&(v=max(g-p,g-d),d-=g-v),0===d)return f&&f!=h&&sizePane("east",m,!0,!0,n),g&&g!=p&&sizePane("west",v,!0,!0,n),sizeMidPanes("center",t,n),void a.css(c)}}else{if(o.isVisible&&!o.noVerticalRoom&&$.extend(o,elDims(a),cssMinDims(i)),!n&&!o.noVerticalRoom&&u.height===o.outerHeight)return a.css(c),!0;l.top=u.top,l.bottom=u.bottom,o.newSize=u.height,l.height=cssH(a,u.height),o.maxHeight=l.height,s=o.maxHeight>=0,s||(o.noVerticalRoom=!0)}if(s?(!t&&state.initialized&&_runCallbacks("onresize_start",i),a.css(l),"center"!==i&&sizeHandles(i),!o.noRoom||o.isClosed||o.isHidden||makePaneFit(i),o.isVisible&&($.extend(o,elDims(a)),state.initialized&&sizeContent(i))):!o.noRoom&&o.isVisible&&makePaneFit(i),a.css(c),delete o.newSize,delete o.newWidth,delete o.newHeight,!o.isVisible)return!0;if("center"===i){var _=browser.isIE6||!browser.boxModel;$Ps.north&&(_||"IFRAME"==state.north.tagName)&&$Ps.north.css("width",cssW($Ps.north,sC.innerWidth)),$Ps.south&&(_||"IFRAME"==state.south.tagName)&&$Ps.south.css("width",cssW($Ps.south,sC.innerWidth))}!t&&state.initialized&&_runCallbacks("onresize_end",i)}})},resizeAll=function(e){var t=sC.innerWidth,n=sC.innerHeight;if(evtPane(e),$N.is(":visible")){if(!state.initialized)return void _initLayoutElements();if(!0===e&&$.isPlainObject(options.outset)&&$N.css(options.outset),$.extend(sC,elDims($N,options.inset)),sC.outerHeight){if(!0===e&&setPanePosition(),!1===_runCallbacks("onresizeall_start"))return!1;var i,r,o;sC.innerHeight,sC.innerWidth;$.each(["south","north","east","west"],function(e,t){$Ps[t]&&(r=options[t],o=state[t],o.autoResize&&o.size!=r.size?sizePane(t,r.size,!0,!0,!0):(setSizeLimits(t),makePaneFit(t,!1,!0,!0)))}),sizeMidPanes("",!0,!0),sizeHandles(),$.each(_c.allPanes,function(e,t){(i=$Ps[t])&&state[t].isVisible&&_runCallbacks("onresize_end",t)}),_runCallbacks("onresizeall_end")}}},resizeChildren=function(e,t){var n=evtPane.call(this,e);if(options[n].resizeChildren){t||refreshChildren(n);var i=children[n];$.isPlainObject(i)&&$.each(i,function(e,t){t.destroyed||t.resizeAll()})}},sizeContent=function(e,t){if(isInitialized()){var n=evtPane.call(this,e);n=n?n.split(","):_c.allPanes,$.each(n,function(e,n){function _below(e){return max(a.css.paddingBottom,parseInt(e.css("marginBottom"),10)||0)}function _measure(){var e=options[n].contentIgnoreSelector,t=r.nextAll().not(".ui-layout-mask").not(e||":lt(0)"),i=t.filter(":visible"),o=i.filter(":last");s={top:r[0].offsetTop,height:r.outerHeight(),numFooters:t.length,hiddenFooters:t.length-i.length,spaceBelow:0},s.spaceAbove=s.top,s.bottom=s.top+s.height,o.length?s.spaceBelow=o[0].offsetTop+o.outerHeight()-s.bottom+_below(o):s.spaceBelow=_below(r)}var i=$Ps[n],r=$Cs[n],o=options[n],a=state[n],s=a.content;if(!i||!r||!i.is(":visible"))return!0;if((r.length||(initContent(n,!1),r))&&!1!==_runCallbacks("onsizecontent_start",n)){(!a.isMoving&&!a.isResizing||o.liveContentResizing||t||void 0==s.top)&&(_measure(),s.hiddenFooters>0&&"hidden"===i.css("overflow")&&(i.css("overflow","visible"),_measure(),i.css("overflow","hidden")));var l=a.innerHeight-(s.spaceAbove-a.css.paddingTop)-(s.spaceBelow-a.css.paddingBottom);r.is(":visible")&&s.height==l||(setOuterHeight(r,l,!0),s.height=l),state.initialized&&_runCallbacks("onsizecontent_end",n)}})}},sizeHandles=function(e){var t=evtPane.call(this,e);t=t?t.split(","):_c.borderPanes,$.each(t,function(e,t){var n,i=options[t],r=state[t],o=$Ps[t],a=$Rs[t],s=$Ts[t];if(o&&a){var l,c,u,d=_c[t].dir,h=r.isClosed?"_closed":"_open",p=i["spacing"+h],f=i["togglerAlign"+h],g=i["togglerLength"+h];if(0===p)return void a.hide();if(r.noRoom||r.isHidden||a.show(),"horz"===d?(l=sC.innerWidth,r.resizerLength=l,c=$.layout.cssNum(o,"left"),a.css({width:cssW(a,l),height:cssH(a,p),left:c>-9999?c:sC.inset.left})):(l=o.outerHeight(),r.resizerLength=l,a.css({height:cssH(a,l),width:cssW(a,p),top:sC.inset.top+getPaneSize("north",!0)})),removeHover(i,a),s){if(0===g||r.isSliding&&i.hideTogglerOnSlide)return void s.hide();if(s.show(),!(g>0)||"100%"===g||g>l)g=l,u=0;else if(isStr(f))switch(f){case"top":case"left":u=0;break;case"bottom":case"right":u=l-g;break;case"middle":case"center":default:u=round((l-g)/2)}else{var m=parseInt(f,10);u=f>=0?m:l-g+m}if("horz"===d){var v=cssW(s,g);s.css({width:v,height:cssH(s,p),left:u,top:0}),s.children(".content").each(function(){n=$(this),n.css("marginLeft",round((v-n.outerWidth())/2))})}else{var _=cssH(s,g);s.css({height:_,width:cssW(s,p),top:u,left:0}),s.children(".content").each(function(){n=$(this),n.css("marginTop",round((_-n.outerHeight())/2))})}removeHover(0,s)}state.initialized||!i.initHidden&&!r.isHidden||(a.hide(),s&&s.hide())}})},enableClosable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Ts[t],i=options[t];n&&(i.closable=!0,n.bind("click."+sID,function(e){e.stopPropagation(),toggle(t)}).css("visibility","visible").css("cursor","pointer").attr("title",state[t].isClosed?i.tips.Open:i.tips.Close).show())}},disableClosable=function(e,t){if(isInitialized()){var n=evtPane.call(this,e),i=$Ts[n];i&&(options[n].closable=!1,state[n].isClosed&&open(n,!1,!0),i.unbind("."+sID).css("visibility",t?"hidden":"visible").css("cursor","default").attr("title",""))}},enableSlidable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Rs[t];n&&n.data("draggable")&&(options[t].slidable=!0,state[t].isClosed&&bindStartSlidingEvents(t,!0))}},disableSlidable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Rs[t];n&&(options[t].slidable=!1,state[t].isSliding?close(t,!1,!0):(bindStartSlidingEvents(t,!1),n.css("cursor","default").attr("title",""),removeHover(null,n[0])))}},enableResizable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Rs[t],i=options[t];n&&n.data("draggable")&&(i.resizable=!0,n.draggable("enable"),state[t].isClosed||n.css("cursor",i.resizerCursor).attr("title",i.tips.Resize))}},disableResizable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Rs[t];n&&n.data("draggable")&&(options[t].resizable=!1,n.draggable("disable").css("cursor","default").attr("title",""),removeHover(null,n[0]))}},swapPanes=function(e,t){function copy(e){var t=$Ps[e],n=$Cs[e];return!!t&&{pane:e,P:!!t&&t[0],C:!!n&&n[0],state:$.extend(!0,{},state[e]),options:$.extend(!0,{},options[e])}}function move(e,t){if(e){var n,i,r=e.P,a=e.C,s=e.pane,l=_c[t],c=$.extend(!0,{},state[t]),u=options[t],d={resizerCursor:u.resizerCursor};$.each("fxName,fxSpeed,fxSettings".split(","),function(e,t){d[t+"_open"]=u[t+"_open"],d[t+"_close"]=u[t+"_close"],d[t+"_size"]=u[t+"_size"]}),$Ps[t]=$(r).data({layoutPane:Instance[t],layoutEdge:t}).css(_c.hidden).css(l.cssReq),$Cs[t]=!!a&&$(a),options[t]=$.extend(!0,{},e.options,d),state[t]=$.extend(!0,{},e.state),n=new RegExp(u.paneClass+"-"+s,"g"),r.className=r.className.replace(n,u.paneClass+"-"+t),initHandles(t),l.dir!=_c[s].dir?(i=o[t]||0,setSizeLimits(t),i=max(i,state[t].minSize),manualSizePane(t,i,!0,!0)):$Rs[t].css(l.side,sC.inset[l.side]+(state[t].isVisible?getPaneSize(t):0)),e.state.isVisible&&!c.isVisible?setAsOpen(t,!0):(setAsClosed(t),bindStartSlidingEvents(t,!0)),e=null}}if(isInitialized()){var n=evtPane.call(this,e);if(state[n].edge=t,state[t].edge=n,!1===_runCallbacks("onswap_start",n)||!1===_runCallbacks("onswap_start",t))return state[n].edge=n,void(state[t].edge=t);var i=copy(n),r=copy(t),o={};o[n]=i?i.state.size:0,o[t]=r?r.state.size:0,$Ps[n]=!1,$Ps[t]=!1,state[n]={},state[t]={},$Ts[n]&&$Ts[n].remove(),$Ts[t]&&$Ts[t].remove(),$Rs[n]&&$Rs[n].remove(),$Rs[t]&&$Rs[t].remove(),$Rs[n]=$Rs[t]=$Ts[n]=$Ts[t]=!1,move(i,t),move(r,n),i=r=o=null,$Ps[n]&&$Ps[n].css(_c.visible),$Ps[t]&&$Ps[t].css(_c.visible),resizeAll(),_runCallbacks("onswap_end",n),_runCallbacks("onswap_end",t)}},syncPinBtns=function(e,t){$.layout.plugins.buttons&&$.each(state[e].pins,function(n,i){$.layout.buttons.setPinState(Instance,$(i),e,t)})},$N=$(this).eq(0);if(!$N.length)return _log(options.errors.containerMissing);if($N.data("layoutContainer")&&$N.data("layout"))return $N.data("layout");var $Ps={},$Cs={},$Rs={},$Ts={},$Ms=$([]),sC=state.container,sID=state.id,Instance={options:options,state:state,container:$N,panes:$Ps,contents:$Cs,resizers:$Rs,togglers:$Ts,hide:hide,show:show,toggle:toggle,open:open,close:close,slideOpen:slideOpen,slideClose:slideClose,slideToggle:slideToggle,setSizeLimits:setSizeLimits,_sizePane:sizePane,sizePane:manualSizePane,sizeContent:sizeContent,swapPanes:swapPanes,showMasks:showMasks,hideMasks:hideMasks,initContent:initContent,addPane:addPane,removePane:removePane,createChildren:createChildren,refreshChildren:refreshChildren,enableClosable:enableClosable,disableClosable:disableClosable,enableSlidable:enableSlidable,disableSlidable:disableSlidable,enableResizable:enableResizable,disableResizable:disableResizable,allowOverflow:allowOverflow,resetOverflow:resetOverflow,destroy:destroy,initPanes:isInitialized,resizeAll:resizeAll,runCallbacks:_runCallbacks,hasParentLayout:!1,children:children,north:!1,south:!1,west:!1,east:!1,center:!1};return"cancel"===_create()?null:Instance}}(jQuery)}).call(exports,__webpack_require__(0))},,function(e,t,n){var i,r,o;!function(a){r=[n(0),n(2)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,i){return!!e.data(t,i[3])}})})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(2)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){function visible(e){for(var t=e.css("visibility");"inherit"===t;)e=e.parent(),t=e.css("visibility");return"hidden"!==t}return e.ui.focusable=function(t,n){var i,r,o,a,s,l=t.nodeName.toLowerCase();return"area"===l?(i=t.parentNode,r=i.name,!(!t.href||!r||"map"!==i.nodeName.toLowerCase())&&(o=e("img[usemap='#"+r+"']"),o.length>0&&o.is(":visible"))):(/^(input|select|textarea|button|object)$/.test(l)?(a=!t.disabled)&&(s=e(t).closest("fieldset")[0])&&(a=!s.disabled):a="a"===l?t.href||n:n,a&&e(t).is(":visible")&&visible(e(t)))},e.extend(e.expr[":"],{focusable:function(t){return e.ui.focusable(t,null!=e.attr(t,"tabindex"))}}),e.ui.focusable})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(2)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase())})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(2)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.ui.plugin={add:function(t,n,i){var r,o=e.ui[t].prototype;for(r in i)o.plugins[r]=o.plugins[r]||[],o.plugins[r].push([n,i[r]])},call:function(e,t,n,i){var r,o=e.plugins[t];if(o&&(i||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(r=0;r<o.length;r++)e.options[o[r][0]]&&o[r][1].apply(e.element,n)}}})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(2)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.ui.safeBlur=function(t){t&&"body"!==t.nodeName.toLowerCase()&&e(t).trigger("blur")}})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(2)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.fn.scrollParent=function(t){var n=this.css("position"),i="absolute"===n,r=t?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var t=e(this);return(!i||"static"!==t.css("position"))&&r.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==n&&o.length?o:e(this[0].ownerDocument||document)}})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(130),n(10),n(36),n(15),n(2),n(5)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.widget("ui.autocomplete",{version:"1.12.1",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var t,n,i,r=this.element[0].nodeName.toLowerCase(),o="textarea"===r,a="input"===r;this.isMultiLine=o||!a&&this._isContentEditable(this.element),this.valueMethod=this.element[o||a?"val":"text"],this.isNewMenu=!0,this._addClass("ui-autocomplete-input"),this.element.attr("autocomplete","off"),this._on(this.element,{keydown:function(r){if(this.element.prop("readOnly"))return t=!0,i=!0,void(n=!0);t=!1,i=!1,n=!1;var o=e.ui.keyCode;switch(r.keyCode){case o.PAGE_UP:t=!0,this._move("previousPage",r);break;case o.PAGE_DOWN:t=!0,this._move("nextPage",r);break;case o.UP:t=!0,this._keyEvent("previous",r);break;case o.DOWN:t=!0,this._keyEvent("next",r);break;case o.ENTER:this.menu.active&&(t=!0,r.preventDefault(),this.menu.select(r));break;case o.TAB:this.menu.active&&this.menu.select(r);break;case o.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(r),r.preventDefault());break;default:n=!0,this._searchTimeout(r)}},keypress:function(i){if(t)return t=!1,void(this.isMultiLine&&!this.menu.element.is(":visible")||i.preventDefault());if(!n){var r=e.ui.keyCode;switch(i.keyCode){case r.PAGE_UP:this._move("previousPage",i);break;case r.PAGE_DOWN:this._move("nextPage",i);break;case r.UP:this._keyEvent("previous",i);break;case r.DOWN:this._keyEvent("next",i)}}},input:function(e){if(i)return i=!1,void e.preventDefault();this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){if(this.cancelBlur)return void delete this.cancelBlur;clearTimeout(this.searching),this.close(e),this._change(e)}}),this._initSource(),this.menu=e("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._addClass(this.menu.element,"ui-autocomplete","ui-front"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,this.element[0]!==e.ui.safeActiveElement(this.document[0])&&this.element.trigger("focus")})},menufocus:function(t,n){var i,r;if(this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)});r=n.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",t,{item:r})&&t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(r.value),(i=n.item.attr("aria-label")||r.value)&&e.trim(i).length&&(this.liveRegion.children().hide(),e("<div>").text(i).appendTo(this.liveRegion))},menuselect:function(t,n){var i=n.item.data("ui-autocomplete-item"),r=this.previous;this.element[0]!==e.ui.safeActiveElement(this.document[0])&&(this.element.trigger("focus"),this.previous=r,this._delay(function(){this.previous=r,this.selectedItem=i})),!1!==this._trigger("select",t,{item:i})&&this._value(i.value),this.term=this._value(),this.close(t),this.selectedItem=i}}),this.liveRegion=e("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_isEventTargetInWidget:function(t){var n=this.menu.element[0];return t.target===this.element[0]||t.target===n||e.contains(n,t.target)},_closeOnClickOutside:function(e){this._isEventTargetInWidget(e)||this.close()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front, dialog")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,n,i=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(n,i){i(e.ui.autocomplete.filter(t,n.term))}):"string"==typeof this.options.source?(n=this.options.source,this.source=function(t,r){i.xhr&&i.xhr.abort(),i.xhr=e.ajax({url:n,data:t,dataType:"json",success:function(e){r(e)},error:function(){r([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){var t=this.term===this._value(),n=this.menu.element.is(":visible"),i=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;t&&(!t||n||i)||(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):!1!==this._trigger("search",t)?this._search(e):void 0},_search:function(e){this.pending++,this._addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return e.proxy(function(e){t===this.requestIndex&&this.__response(e),--this.pending||this._removeClass("ui-autocomplete-loading")},this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this._off(this.document,"mousedown"),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({},t,{label:t.label||t.value,value:t.value||t.label})})},_suggest:function(t){var n=this.menu.element.empty();this._renderMenu(n,t),this.isNewMenu=!0,this.menu.refresh(),n.show(),this._resizeMenu(),n.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(),this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,n){var i=this;e.each(n,function(e,n){i._renderItemData(t,n)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,n){return e("<li>").append(e("<div>").text(n.label)).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[e](t):void this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(e,t),t.preventDefault())},_isContentEditable:function(e){if(!e.length)return!1;var t=e.prop("contentEditable");return"inherit"===t?this._isContentEditable(e.parent()):"true"===t}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,n){var i=new RegExp(e.ui.autocomplete.escapeRegex(n),"i");return e.grep(t,function(e){return i.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var n;this._superApply(arguments),this.options.disabled||this.cancelSearch||(n=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.children().hide(),e("<div>").text(n).appendTo(this.liveRegion))}}),e.ui.autocomplete})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(16),n(57),n(60),n(15),n(61),n(62),n(2),n(5)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.widget("ui.draggable",e.ui.mouse,{version:"1.12.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this._addClass("ui-draggable"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){if((this.helper||this.element).is(".ui-draggable-dragging"))return void(this.destroyOnClear=!0);this._removeHandleClassName(),this._mouseDestroy()},_mouseCapture:function(t){var n=this.options;return!(this.helper||n.disabled||e(t.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(t),!!this.handle&&(this._blurActiveElement(t),this._blockFrames(!0===n.iframeFix?"iframe":n.iframeFix),!0))},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map(function(){var t=e(this);return e("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var n=e.ui.safeActiveElement(this.document[0]);e(t.target).closest(n).length||e.ui.safeBlur(n)},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this._addClass(this.helper,"ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===e(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),!1===this._trigger("start",t)?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(t,n){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!n){var i=this._uiHash();if(!1===this._trigger("drag",t,i))return this._mouseUp(new e.Event("mouseup",t)),!1;this.position=i.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=this,i=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(i=e.ui.ddmanager.drop(this,t)),this.dropped&&(i=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||!0===this.options.revert||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==n._trigger("stop",t)&&n._clear()}):!1!==this._trigger("stop",t)&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.trigger("focus"),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp(new e.Event("mouseup",{target:this.element[0]})):this._clear(),this},_getHandle:function(t){return!this.options.handle||!!e(t.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(t){var n=this.options,i=e.isFunction(n.helper),r=i?e(n.helper.apply(this.element[0],[t])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),i&&r[0]===this.element[0]&&this._setPositionRelative(),r[0]===this.element[0]||/(fixed|absolute)/.test(r.css("position"))||r.css("position","absolute"),r},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),n=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==n&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,i,r=this.options,o=this.document[0];return this.relativeContainer=null,r.containment?"window"===r.containment?void(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===r.containment?void(this.containment=[0,0,e(o).width()-this.helperProportions.width-this.margins.left,(e(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):r.containment.constructor===Array?void(this.containment=r.containment):("parent"===r.containment&&(r.containment=this.helper[0].parentNode),n=e(r.containment),void((i=n[0])&&(t=/(scroll|auto)/.test(n.css("overflow")),this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(t?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=n))):void(this.containment=null)},_convertPositionTo:function(e,t){t||(t=this.position);var n="absolute"===e?1:-1,i=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.offset.scroll.top:i?0:this.offset.scroll.top)*n,left:t.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.offset.scroll.left:i?0:this.offset.scroll.left)*n}},_generatePosition:function(e,t){var n,i,r,o,a=this.options,s=this._isRootNode(this.scrollParent[0]),l=e.pageX,c=e.pageY;return s&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(i=this.relativeContainer.offset(),n=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):n=this.containment,e.pageX-this.offset.click.left<n[0]&&(l=n[0]+this.offset.click.left),e.pageY-this.offset.click.top<n[1]&&(c=n[1]+this.offset.click.top),e.pageX-this.offset.click.left>n[2]&&(l=n[2]+this.offset.click.left),e.pageY-this.offset.click.top>n[3]&&(c=n[3]+this.offset.click.top)),a.grid&&(r=a.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,c=n?r-this.offset.click.top>=n[1]||r-this.offset.click.top>n[3]?r:r-this.offset.click.top>=n[1]?r-a.grid[1]:r+a.grid[1]:r,o=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,l=n?o-this.offset.click.left>=n[0]||o-this.offset.click.left>n[2]?o:o-this.offset.click.left>=n[0]?o-a.grid[0]:o+a.grid[0]:o),"y"===a.axis&&(l=this.originalPageX),"x"===a.axis&&(c=this.originalPageY)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(t,n,i){return i=i||this._uiHash(),e.ui.plugin.call(this,t,[n,i,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),i.offset=this.positionAbs),e.Widget.prototype._trigger.call(this,t,n,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n,i){var r=e.extend({},n,{item:i.element});i.sortables=[],e(i.options.connectToSortable).each(function(){var n=e(this).sortable("instance");n&&!n.options.disabled&&(i.sortables.push(n),n.refreshPositions(),n._trigger("activate",t,r))})},stop:function(t,n,i){var r=e.extend({},n,{item:i.element});i.cancelHelperRemoval=!1,e.each(i.sortables,function(){var e=this;e.isOver?(e.isOver=0,i.cancelHelperRemoval=!0,e.cancelHelperRemoval=!1,e._storedCSS={position:e.placeholder.css("position"),top:e.placeholder.css("top"),left:e.placeholder.css("left")},e._mouseStop(t),e.options.helper=e.options._helper):(e.cancelHelperRemoval=!0,e._trigger("deactivate",t,r))})},drag:function(t,n,i){e.each(i.sortables,function(){var r=!1,o=this;o.positionAbs=i.positionAbs,o.helperProportions=i.helperProportions,o.offset.click=i.offset.click,o._intersectsWith(o.containerCache)&&(r=!0,e.each(i.sortables,function(){return this.positionAbs=i.positionAbs,this.helperProportions=i.helperProportions,this.offset.click=i.offset.click,this!==o&&this._intersectsWith(this.containerCache)&&e.contains(o.element[0],this.element[0])&&(r=!1),r})),r?(o.isOver||(o.isOver=1,i._parent=n.helper.parent(),o.currentItem=n.helper.appendTo(o.element).data("ui-sortable-item",!0),o.options._helper=o.options.helper,o.options.helper=function(){return n.helper[0]},t.target=o.currentItem[0],o._mouseCapture(t,!0),o._mouseStart(t,!0,!0),o.offset.click.top=i.offset.click.top,o.offset.click.left=i.offset.click.left,o.offset.parent.left-=i.offset.parent.left-o.offset.parent.left,o.offset.parent.top-=i.offset.parent.top-o.offset.parent.top,i._trigger("toSortable",t),i.dropped=o.element,e.each(i.sortables,function(){this.refreshPositions()}),i.currentItem=i.element,o.fromOutside=i),o.currentItem&&(o._mouseDrag(t),n.position=o.position)):o.isOver&&(o.isOver=0,o.cancelHelperRemoval=!0,o.options._revert=o.options.revert,o.options.revert=!1,o._trigger("out",t,o._uiHash(o)),o._mouseStop(t,!0),o.options.revert=o.options._revert,o.options.helper=o.options._helper,o.placeholder&&o.placeholder.remove(),n.helper.appendTo(i._parent),i._refreshOffsets(t),n.position=i._generatePosition(t,!0),i._trigger("fromSortable",t),i.dropped=!1,e.each(i.sortables,function(){this.refreshPositions()}))})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,n,i){var r=e("body"),o=i.options;r.css("cursor")&&(o._cursor=r.css("cursor")),r.css("cursor",o.cursor)},stop:function(t,n,i){var r=i.options;r._cursor&&e("body").css("cursor",r._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n,i){var r=e(n.helper),o=i.options;r.css("opacity")&&(o._opacity=r.css("opacity")),r.css("opacity",o.opacity)},stop:function(t,n,i){var r=i.options;r._opacity&&e(n.helper).css("opacity",r._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,n){n.scrollParentNotHidden||(n.scrollParentNotHidden=n.helper.scrollParent(!1)),n.scrollParentNotHidden[0]!==n.document[0]&&"HTML"!==n.scrollParentNotHidden[0].tagName&&(n.overflowOffset=n.scrollParentNotHidden.offset())},drag:function(t,n,i){var r=i.options,o=!1,a=i.scrollParentNotHidden[0],s=i.document[0];a!==s&&"HTML"!==a.tagName?(r.axis&&"x"===r.axis||(i.overflowOffset.top+a.offsetHeight-t.pageY<r.scrollSensitivity?a.scrollTop=o=a.scrollTop+r.scrollSpeed:t.pageY-i.overflowOffset.top<r.scrollSensitivity&&(a.scrollTop=o=a.scrollTop-r.scrollSpeed)),r.axis&&"y"===r.axis||(i.overflowOffset.left+a.offsetWidth-t.pageX<r.scrollSensitivity?a.scrollLeft=o=a.scrollLeft+r.scrollSpeed:t.pageX-i.overflowOffset.left<r.scrollSensitivity&&(a.scrollLeft=o=a.scrollLeft-r.scrollSpeed))):(r.axis&&"x"===r.axis||(t.pageY-e(s).scrollTop()<r.scrollSensitivity?o=e(s).scrollTop(e(s).scrollTop()-r.scrollSpeed):e(window).height()-(t.pageY-e(s).scrollTop())<r.scrollSensitivity&&(o=e(s).scrollTop(e(s).scrollTop()+r.scrollSpeed))),r.axis&&"y"===r.axis||(t.pageX-e(s).scrollLeft()<r.scrollSensitivity?o=e(s).scrollLeft(e(s).scrollLeft()-r.scrollSpeed):e(window).width()-(t.pageX-e(s).scrollLeft())<r.scrollSensitivity&&(o=e(s).scrollLeft(e(s).scrollLeft()+r.scrollSpeed)))),!1!==o&&e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(i,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,n,i){var r=i.options;i.snapElements=[],e(r.snap.constructor!==String?r.snap.items||":data(ui-draggable)":r.snap).each(function(){var t=e(this),n=t.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:n.top,left:n.left})})},drag:function(t,n,i){var r,o,a,s,l,c,u,d,h,p,f=i.options,g=f.snapTolerance,m=n.offset.left,v=m+i.helperProportions.width,_=n.offset.top,y=_+i.helperProportions.height;for(h=i.snapElements.length-1;h>=0;h--)l=i.snapElements[h].left-i.margins.left,c=l+i.snapElements[h].width,u=i.snapElements[h].top-i.margins.top,d=u+i.snapElements[h].height,v<l-g||m>c+g||y<u-g||_>d+g||!e.contains(i.snapElements[h].item.ownerDocument,i.snapElements[h].item)?(i.snapElements[h].snapping&&i.options.snap.release&&i.options.snap.release.call(i.element,t,e.extend(i._uiHash(),{snapItem:i.snapElements[h].item})),i.snapElements[h].snapping=!1):("inner"!==f.snapMode&&(r=Math.abs(u-y)<=g,o=Math.abs(d-_)<=g,a=Math.abs(l-v)<=g,s=Math.abs(c-m)<=g,r&&(n.position.top=i._convertPositionTo("relative",{top:u-i.helperProportions.height,left:0}).top),o&&(n.position.top=i._convertPositionTo("relative",{top:d,left:0}).top),a&&(n.position.left=i._convertPositionTo("relative",{top:0,left:l-i.helperProportions.width}).left),s&&(n.position.left=i._convertPositionTo("relative",{top:0,left:c}).left)),p=r||o||a||s,"outer"!==f.snapMode&&(r=Math.abs(u-_)<=g,o=Math.abs(d-y)<=g,a=Math.abs(l-m)<=g,s=Math.abs(c-v)<=g,r&&(n.position.top=i._convertPositionTo("relative",{top:u,left:0}).top),o&&(n.position.top=i._convertPositionTo("relative",{top:d-i.helperProportions.height,left:0}).top),a&&(n.position.left=i._convertPositionTo("relative",{top:0,left:l}).left),s&&(n.position.left=i._convertPositionTo("relative",{top:0,left:c-i.helperProportions.width}).left)),!i.snapElements[h].snapping&&(r||o||a||s||p)&&i.options.snap.snap&&i.options.snap.snap.call(i.element,t,e.extend(i._uiHash(),{snapItem:i.snapElements[h].item})),i.snapElements[h].snapping=r||o||a||s||p)}}),e.ui.plugin.add("draggable","stack",{start:function(t,n,i){var r,o=i.options,a=e.makeArray(e(o.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});a.length&&(r=parseInt(e(a[0]).css("zIndex"),10)||0,e(a).each(function(t){e(this).css("zIndex",r+t)}),this.css("zIndex",r+a.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n,i){var r=e(n.helper),o=i.options;r.css("zIndex")&&(o._zIndex=r.css("zIndex")),r.css("zIndex",o.zIndex)},stop:function(t,n,i){var r=i.options;r._zIndex&&e(n.helper).css("zIndex",r._zIndex)}}),e.ui.draggable})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(16),n(10),n(2),n(5)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.widget("ui.slider",e.ui.mouse,{version:"1.12.1",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,n,i=this.options,r=this.element.find(".ui-slider-handle"),o=[];for(n=i.values&&i.values.length||1,r.length>n&&(r.slice(n).remove(),r=r.slice(0,n)),t=r.length;t<n;t++)o.push("<span tabindex='0'></span>");this.handles=r.add(e(o.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t).attr("tabIndex",0)})},_createRange:function(){var t=this.options;t.range?(!0===t.range&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=e("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),"min"!==t.range&&"max"!==t.range||this._addClass(this.range,"ui-slider-range-"+t.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(t){var n,i,r,o,a,s,l,c=this,u=this.options;return!u.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),n={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(n),r=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var n=Math.abs(i-c.values(t));(r>n||r===n&&(t===c._lastChangedValue||c.values(t)===u.min))&&(r=n,o=e(this),a=t)}),!1!==this._start(t,a)&&(this._mouseSliding=!0,this._handleIndex=a,this._addClass(o,null,"ui-state-active"),o.trigger("focus"),s=o.offset(),l=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:t.pageX-s.left-o.width()/2,top:t.pageY-s.top-o.height()/2-(parseInt(o.css("borderTopWidth"),10)||0)-(parseInt(o.css("borderBottomWidth"),10)||0)+(parseInt(o.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,a,i),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,n),!1},_mouseStop:function(e){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,n,i,r,o;return"horizontal"===this.orientation?(t=this.elementSize.width,n=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,n=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),i=n/t,i>1&&(i=1),i<0&&(i=0),"vertical"===this.orientation&&(i=1-i),r=this._valueMax()-this._valueMin(),o=this._valueMin()+i*r,this._trimAlignValue(o)},_uiHash:function(e,t,n){var i={handle:this.handles[e],handleIndex:e,value:void 0!==t?t:this.value()};return this._hasMultipleValues()&&(i.value=void 0!==t?t:this.values(e),i.values=n||this.values()),i},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(e,t){return this._trigger("start",e,this._uiHash(t))},_slide:function(e,t,n){var i,r=this.value(),o=this.values();this._hasMultipleValues()&&(i=this.values(t?0:1),r=this.values(t),2===this.options.values.length&&!0===this.options.range&&(n=0===t?Math.min(i,n):Math.max(i,n)),o[t]=n),n!==r&&!1!==this._trigger("slide",e,this._uiHash(t,n,o))&&(this._hasMultipleValues()?this.values(t,n):this.value(n))},_stop:function(e,t){this._trigger("stop",e,this._uiHash(t))},_change:function(e,t){this._keySliding||this._mouseSliding||(this._lastChangedValue=t,this._trigger("change",e,this._uiHash(t)))},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),void this._change(null,0)):this._value()},values:function(t,n){var i,r,o;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(n),this._refreshValue(),void this._change(null,t);if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this._hasMultipleValues()?this._values(t):this.value();for(i=this.options.values,r=arguments[0],o=0;o<i.length;o+=1)i[o]=this._trimAlignValue(r[o]),this._change(null,o);this._refreshValue()},_setOption:function(t,n){var i,r=0;switch("range"===t&&!0===this.options.range&&("min"===n?(this.options.value=this._values(0),this.options.values=null):"max"===n&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(r=this.options.values.length),this._super(t,n),t){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(n),this.handles.css("horizontal"===n?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),i=r-1;i>=0;i--)this._change(null,i);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(e){this._super(e),this._toggleClass(null,"ui-state-disabled",!!e)},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,n,i;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this._hasMultipleValues()){for(n=this.options.values.slice(),i=0;i<n.length;i+=1)n[i]=this._trimAlignValue(n[i]);return n}return[]},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,n=(e-this._valueMin())%t,i=e-n;return 2*Math.abs(n)>=t&&(i+=n>0?t:-t),parseFloat(i.toFixed(5))},_calculateNewMax:function(){var e=this.options.max,t=this._valueMin(),n=this.options.step;e=Math.round((e-t)/n)*n+t,e>this.options.max&&(e-=n),this.max=parseFloat(e.toFixed(this._precision()))},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=e.toString(),n=t.indexOf(".");return-1===n?0:t.length-n-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(e){"vertical"===e&&this.range.css({width:"",left:""}),"horizontal"===e&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var t,n,i,r,o,a=this.options.range,s=this.options,l=this,c=!this._animateOff&&s.animate,u={};this._hasMultipleValues()?this.handles.each(function(i){n=(l.values(i)-l._valueMin())/(l._valueMax()-l._valueMin())*100,u["horizontal"===l.orientation?"left":"bottom"]=n+"%",e(this).stop(1,1)[c?"animate":"css"](u,s.animate),!0===l.options.range&&("horizontal"===l.orientation?(0===i&&l.range.stop(1,1)[c?"animate":"css"]({left:n+"%"},s.animate),1===i&&l.range[c?"animate":"css"]({width:n-t+"%"},{queue:!1,duration:s.animate})):(0===i&&l.range.stop(1,1)[c?"animate":"css"]({bottom:n+"%"},s.animate),1===i&&l.range[c?"animate":"css"]({height:n-t+"%"},{queue:!1,duration:s.animate}))),t=n}):(i=this.value(),r=this._valueMin(),o=this._valueMax(),n=o!==r?(i-r)/(o-r)*100:0,u["horizontal"===this.orientation?"left":"bottom"]=n+"%",this.handle.stop(1,1)[c?"animate":"css"](u,s.animate),"min"===a&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:n+"%"},s.animate),"max"===a&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:100-n+"%"},s.animate),"min"===a&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:n+"%"},s.animate),"max"===a&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:100-n+"%"},s.animate))},_handleEvents:{keydown:function(t){var n,i,r,o=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,this._addClass(e(t.target),null,"ui-state-active"),!1===this._start(t,o)))return}switch(r=this.options.step,n=i=this._hasMultipleValues()?this.values(o):this.value(),t.keyCode){case e.ui.keyCode.HOME:i=this._valueMin();break;case e.ui.keyCode.END:i=this._valueMax();break;case e.ui.keyCode.PAGE_UP:i=this._trimAlignValue(n+(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.PAGE_DOWN:i=this._trimAlignValue(n-(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(n===this._valueMax())return;i=this._trimAlignValue(n+r);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(n===this._valueMin())return;i=this._trimAlignValue(n-r)}this._slide(t,o,i)},keyup:function(t){var n=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,n),this._change(t,n),this._removeClass(e(t.target),null,"ui-state-active"))}}})})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(16),n(57),n(59),n(62),n(2),n(5)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.widget("ui.sortable",e.ui.mouse,{version:"1.12.1",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,n){return e>=t&&e<t+n},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){var t=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),e.each(this.items,function(){t._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")})},_destroy:function(){this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,n){var i=null,r=!1,o=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(t),e(t.target).parents().each(function(){if(e.data(this,o.widgetName+"-item")===o)return i=e(this),!1}),e.data(t.target,o.widgetName+"-item")===o&&(i=e(t.target)),!!i&&(!(this.options.handle&&!n&&(e(this.options.handle,i).find("*").addBack().each(function(){this===t.target&&(r=!0)}),!r))&&(this.currentItem=i,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(t,n,i){var r,o,a=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),a.containment&&this._setContainment(),a.cursor&&"auto"!==a.cursor&&(o=this.document.find("body"),this.storedCursor=o.css("cursor"),o.css("cursor",a.cursor),this.storedStylesheet=e("<style>*{ cursor: "+a.cursor+" !important; }</style>").appendTo(o)),a.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",a.opacity)),a.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",a.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!i)for(r=this.containers.length-1;r>=0;r--)this.containers[r]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!a.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var n,i,r,o,a=this.options,s=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<a.scrollSensitivity?this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop+a.scrollSpeed:t.pageY-this.overflowOffset.top<a.scrollSensitivity&&(this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop-a.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<a.scrollSensitivity?this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft+a.scrollSpeed:t.pageX-this.overflowOffset.left<a.scrollSensitivity&&(this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft-a.scrollSpeed)):(t.pageY-this.document.scrollTop()<a.scrollSensitivity?s=this.document.scrollTop(this.document.scrollTop()-a.scrollSpeed):this.window.height()-(t.pageY-this.document.scrollTop())<a.scrollSensitivity&&(s=this.document.scrollTop(this.document.scrollTop()+a.scrollSpeed)),t.pageX-this.document.scrollLeft()<a.scrollSensitivity?s=this.document.scrollLeft(this.document.scrollLeft()-a.scrollSpeed):this.window.width()-(t.pageX-this.document.scrollLeft())<a.scrollSensitivity&&(s=this.document.scrollLeft(this.document.scrollLeft()+a.scrollSpeed))),!1!==s&&e.ui.ddmanager&&!a.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),n=this.items.length-1;n>=0;n--)if(i=this.items[n],r=i.item[0],(o=this._intersectsWithPointer(i))&&i.instance===this.currentContainer&&!(r===this.currentItem[0]||this.placeholder[1===o?"next":"prev"]()[0]===r||e.contains(this.placeholder[0],r)||"semi-dynamic"===this.options.type&&e.contains(this.element[0],r))){if(this.direction=1===o?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(i))break;this._rearrange(t,i),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var i=this,r=this.placeholder.offset(),o=this.options.axis,a={};o&&"x"!==o||(a.left=r.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),o&&"y"!==o||(a.top=r.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(a,parseInt(this.options.revert,10)||500,function(){i._clear(t)})}else this._clear(t,n);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new e.Event("mouseup",{target:null})),"original"===this.options.helper?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},e(n).each(function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);n&&i.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))}),!i.length&&t.key&&i.push(t.key+"="),i.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},n.each(function(){i.push(e(t.item||this).attr(t.attribute||"id")||"")}),i},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,i=this.positionAbs.top,r=i+this.helperProportions.height,o=e.left,a=o+e.width,s=e.top,l=s+e.height,c=this.offset.click.top,u=this.offset.click.left,d="x"===this.options.axis||i+c>s&&i+c<l,h="y"===this.options.axis||t+u>o&&t+u<a,p=d&&h;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:o<t+this.helperProportions.width/2&&n-this.helperProportions.width/2<a&&s<i+this.helperProportions.height/2&&r-this.helperProportions.height/2<l},_intersectsWithPointer:function(e){var t,n,i="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),r="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width);return!(!i||!r)&&(t=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection(),this.floating?"right"===n||"down"===t?2:1:t&&("down"===t?2:1))},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),n=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),i=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return this.floating&&r?"right"===r&&n||"left"===r&&!n:i&&("down"===i&&t||"up"===i&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function addItems(){a.push(this)}var n,i,r,o,a=[],s=[],l=this._connectWith();if(l&&t)for(n=l.length-1;n>=0;n--)for(r=e(l[n],this.document[0]),i=r.length-1;i>=0;i--)(o=e.data(r[i],this.widgetFullName))&&o!==this&&!o.options.disabled&&s.push([e.isFunction(o.options.items)?o.options.items.call(o.element):e(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(s.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=s.length-1;n>=0;n--)s[n][0].each(addItems);return e(a)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var n=0;n<t.length;n++)if(t[n]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var n,i,r,o,a,s,l,c,u=this.items,d=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],h=this._connectWith();if(h&&this.ready)for(n=h.length-1;n>=0;n--)for(r=e(h[n],this.document[0]),i=r.length-1;i>=0;i--)(o=e.data(r[i],this.widgetFullName))&&o!==this&&!o.options.disabled&&(d.push([e.isFunction(o.options.items)?o.options.items.call(o.element[0],t,{item:this.currentItem}):e(o.options.items,o.element),o]),this.containers.push(o));for(n=d.length-1;n>=0;n--)for(a=d[n][1],s=d[n][0],i=0,c=s.length;i<c;i++)l=e(s[i]),l.data(this.widgetName+"-item",a),u.push({item:l,instance:a,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.floating=!!this.items.length&&("x"===this.options.axis||this._isFloating(this.items[0].item)),this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var n,i,r,o;for(n=this.items.length-1;n>=0;n--)i=this.items[n],i.instance!==this.currentContainer&&this.currentContainer&&i.item[0]!==this.currentItem[0]||(r=this.options.toleranceElement?e(this.options.toleranceElement,i.item):i.item,t||(i.width=r.outerWidth(),i.height=r.outerHeight()),o=r.offset(),i.left=o.left,i.top=o.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(n=this.containers.length-1;n>=0;n--)o=this.containers[n].element.offset(),this.containers[n].containerCache.left=o.left,this.containers[n].containerCache.top=o.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var n,i=t.options;i.placeholder&&i.placeholder.constructor!==String||(n=i.placeholder,i.placeholder={element:function(){var i=t.currentItem[0].nodeName.toLowerCase(),r=e("<"+i+">",t.document[0]);return t._addClass(r,"ui-sortable-placeholder",n||t.currentItem[0].className)._removeClass(r,"ui-sortable-helper"),"tbody"===i?t._createTrPlaceholder(t.currentItem.find("tr").eq(0),e("<tr>",t.document[0]).appendTo(r)):"tr"===i?t._createTrPlaceholder(t.currentItem,r):"img"===i&&r.attr("src",t.currentItem.attr("src")),n||r.css("visibility","hidden"),r},update:function(e,r){n&&!i.forcePlaceholderSize||(r.height()||r.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),r.width()||r.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(i.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),i.placeholder.update(t,t.placeholder)},_createTrPlaceholder:function(t,n){var i=this;t.children().each(function(){e("<td>&#160;</td>",i.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(n)})},_contactContainers:function(t){var n,i,r,o,a,s,l,c,u,d,h=null,p=null;for(n=this.containers.length-1;n>=0;n--)if(!e.contains(this.currentItem[0],this.containers[n].element[0]))if(this._intersectsWith(this.containers[n].containerCache)){if(h&&e.contains(this.containers[n].element[0],h.element[0]))continue;h=this.containers[n],p=n}else this.containers[n].containerCache.over&&(this.containers[n]._trigger("out",t,this._uiHash(this)),this.containers[n].containerCache.over=0);if(h)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(r=1e4,o=null,u=h.floating||this._isFloating(this.currentItem),a=u?"left":"top",s=u?"width":"height",d=u?"pageX":"pageY",i=this.items.length-1;i>=0;i--)e.contains(this.containers[p].element[0],this.items[i].item[0])&&this.items[i].item[0]!==this.currentItem[0]&&(l=this.items[i].item.offset()[a],c=!1,t[d]-l>this.items[i][s]/2&&(c=!0),Math.abs(t[d]-l)<r&&(r=Math.abs(t[d]-l),o=this.items[i],this.direction=c?"up":"down"));if(!o&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return void(this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1));o?this._rearrange(t,o,null,!0):this._rearrange(t,null,this.containers[p].element,!0),this._trigger("change",t,this._uiHash()),this.containers[p]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(t){var n=this.options,i=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t,this.currentItem])):"clone"===n.helper?this.currentItem.clone():this.currentItem;return i.parents("body").length||e("parent"!==n.appendTo?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(i[0]),i[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),i[0].style.width&&!n.forceHelperSize||i.width(this.currentItem.width()),i[0].style.height&&!n.forceHelperSize||i.height(this.currentItem.height()),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,i,r=this.options;"parent"===r.containment&&(r.containment=this.helper[0].parentNode),"document"!==r.containment&&"window"!==r.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===r.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===r.containment?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(r.containment)||(t=e(r.containment)[0],n=e(r.containment).offset(),i="hidden"!==e(t).css("overflow"),this.containment=[n.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,n.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,n.left+(i?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,n.top+(i?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,n){n||(n=this.position);var i="absolute"===t?1:-1,r="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(r[0].tagName);return{top:n.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:r.scrollTop())*i,left:n.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:r.scrollLeft())*i}},_generatePosition:function(t){var n,i,r=this.options,o=t.pageX,a=t.pageY,s="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(s[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(a=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(a=this.containment[3]+this.offset.click.top)),r.grid&&(n=this.originalPageY+Math.round((a-this.originalPageY)/r.grid[1])*r.grid[1],a=this.containment?n-this.offset.click.top>=this.containment[1]&&n-this.offset.click.top<=this.containment[3]?n:n-this.offset.click.top>=this.containment[1]?n-r.grid[1]:n+r.grid[1]:n,i=this.originalPageX+Math.round((o-this.originalPageX)/r.grid[0])*r.grid[0],o=this.containment?i-this.offset.click.left>=this.containment[0]&&i-this.offset.click.left<=this.containment[2]?i:i-this.offset.click.left>=this.containment[0]?i-r.grid[0]:i+r.grid[0]:i)),{top:a-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:s.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:s.scrollLeft())}},_rearrange:function(e,t,n,i){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var r=this.counter;this._delay(function(){r===this.counter&&this.refreshPositions(!i)})},_clear:function(e,t){function delayEvent(e,t,n){return function(i){n._trigger(e,i,t._uiHash(t))}}this.reverting=!1;var n,i=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)"auto"!==this._storedCSS[n]&&"static"!==this._storedCSS[n]||(this._storedCSS[n]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&i.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||i.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(i.push(function(e){this._trigger("remove",e,this._uiHash())}),i.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),i.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),n=this.containers.length-1;n>=0;n--)t||i.push(delayEvent("deactivate",this,this.containers[n])),this.containers[n].containerCache.over&&(i.push(delayEvent("out",this,this.containers[n])),this.containers[n].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!t){for(n=0;n<i.length;n++)i[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===e.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}})})},,function(e,t){function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(n===setTimeout)return setTimeout(e,0);if((n===defaultSetTimout||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}function runClearTimeout(e){if(i===clearTimeout)return clearTimeout(e);if((i===defaultClearTimeout||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{return i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}function cleanUpNextTick(){s&&o&&(s=!1,o.length?a=o.concat(a):l=-1,a.length&&drainQueue())}function drainQueue(){if(!s){var e=runTimeout(cleanUpNextTick);s=!0;for(var t=a.length;t;){for(o=a,a=[];++l<t;)o&&o[l].run();l=-1,t=a.length}o=null,s=!1,runClearTimeout(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}var n,i,r=e.exports={};!function(){try{n="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){n=defaultSetTimout}try{i="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){i=defaultClearTimeout}}();var o,a=[],s=!1,l=-1;r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.push(new Item(e,t)),1!==a.length||s||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=noop,r.addListener=noop,r.once=noop,r.off=noop,r.removeListener=noop,r.removeAllListeners=noop,r.emit=noop,r.prependListener=noop,r.prependOnceListener=noop,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},,function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAODUlEQVR42uVbCXRcZRW+/2SdpMmk0KYtLdBalcqiiAJS4QAWZae0QKkcaBGXo9KaBlmTpqRNW3FrG1rliIqGikSqLYgUBApY5ABaVDatBwVqG9omhWwzk8xMMr/fnf9/mTdv3jaTdOHwn3Pn5r15783/f3f5773vRtAHfIiDPYGDPQ4kAEWgo0FTQONBVaAC/V0S1AnaA3oLtAOUeL8DUA46A3QO6LOgj4PKfN4bBb0Geg70JGgrKPx+AIAleiboS6CLQCH9G5I5Vi8PAz9C80JwfCkGwN8D3w3+LnhEX6/v49EN2gz6Jehp0MChBgCr91zQjaATjOdikSnRTwd9CvQhfa7QRIzYoF4R6zzbwZugl0iJ/1nQu+nfYUBeB60C3QeKHwoAXAy6A3QsT7AUz5wBPgv8NPCglnSh5kBKFAjwAsUBgBiUJAcGoQnMtUYYvB/8efCN4I+D96U149+gW0EPHSwAoMm0FnQpKFCBjzmk1GAcpSVcWgLDhyGUjoK0i/GDevpyUFFqBBQ6xneDUIV4LxxBD1GsX2kGX7oXdD+oFdSj7mTn+XvQQtCuAwnAhaCfgsazBGHs8svg47WkgyWw8WoSo0bBxmOQZDfWGiaRjJOUkoTUNm7LBYlAEZ4zikRRCPeXkuiPkuzcSyLarzSjA9fdDf6QwlBobL6mwdivAPD1rHbLWMCT8HET6EQt7dGVQAQolEJkCcwSix7yYsPhhfCewWo8DxrU0Q4/0aW04lVStrdDXcpK0ghaYbp9RAFgR9cM+joffA73Qu8kVF+EykhOmQTJR0jG90CSgy4SHgaHqciycTiuILnzHRJdYZLAWGBS8om0b/g56JvkM47wCwCslO4BzeNt62pS9l6Kg6lHKptPtGm7HgGJe3EBuyuHB+rFrN7cSdQPT7CB1B6ZVJf8itRWbHiZYQOwGlTDKMDQxPn4kVCQxAmT4M0hicFInhI1Hcs87i8MkiyB5m1vI9kVJfEozt+F8xoEdtCLyMMc/ADA6rSOJQ9HR1g8TRiNzR6efXCHmrmnxEwUcPhhqSmpxWaQl0bwg0ZBC9+CLbQhmgIIdLf6ni+p0UDkDcBnQE+BSi/BtVfhoZPHkDi+EN54j7eEAjrSExaJ++VJHQ8ktLd3+70y7DpshW+1k0CEJDep5yBsIIQl9Hw+AHAsvw00jUM79vZTx6iAfnCfi0RM0h6pwc/mSDFGaaO2+/3g4UQ7gfp/sQN9F8cvq6+2gz4NiuQKwHdAt2BnE014/rEhEqcWk0x2uNu0yEPSuXDEvqLfxWcEoaFvDJB8vYvEbTjuUffxbnlbLgB8GPQKg/oVfJyHaG7GYTpbcZH8gRrsJzhddPIRZYhFtiF92gwD+Ik6zabAyvsfvwC0gOYBBXkrIrNzJ2K/32WPuNzPEnfi/LtYlUw4aGIBdoet2B1WILZ8Q51fD5rvB4CppDKukm/j47KxRMch8komspGW5K0BgYkTKdnWlpek/dzLoo3baEIAoek+aO1GRI7fU6dgOXQcqWTTFQD2HzchdRWNsPmLyuHFO7Mln7TZz608uHChLGtqEj2XXy4TTz6Zk4SLzjlHVG7YIKNLloi+tWvz0oTiKpIv9JGoj5F8U13Pa7vVDYAijdAk1pVaSP/oDnvJe4VYwQULaNSaNYjaCkj29lLXrFmU2LLFl+SLZsygqk2bSFQg5h0cpPCiRdS3bp3j9TyfCNn7hCjWcGeHihIx/kfKvw2FyVYAzgZtQU5PzcUk5kADKJxt8wNekl+wQFY0N8N7CCkwJI9wWHTPni3jHppQDMmHNm6UgYqK1H2p+5NJ2VtTIwCC432skWGb3aEYWeXTCZLXIyuNqfNnkSqx2QLwfdCNn8DHXYj2PtaZjSjvx0kX6ZUtXEgVq1enJG8dyXA4pQkAwfZeLD4l+QDy6CwpQxN6a2sputY5sOM4od8yXx77sJYFnUNxQYYZWAH4C+jkubh/dSWJkp5Mm0pqW3OSYBkkX7lmDbK2wJDkrVxGIqJz5kwZf+qpTMnPmCFGP/igxOJt70vxgQHZU1srog6awPOMcIXJ4gtEJcllvSTul6njF0hV6bIAwG6fKj6WrEb+fW0sO7tLuEi/HDZf2dyM+DdAXiMJn9AJTYhpn1ACmx/Nkq+o8LwX5kA9NTUUcfAJca0FGbkIpvQY7PqGaOoUf1bp5WQAwFvEq1zT+0M5yZMi2bYfc5B80ckny7HPPSeosNBR8naa8N6sWan7D9u0yV3yVp5IyI7p00Vi2zbbXcHOF7yN3ewyZK0xdd00UjXFDAC4jP1wNT62BonG9mXaklG1tR1Idyrq66ly6VJfGjCkCWFV6rezeUcNwNJ6liyh3hUr0qmoZfRTulw8tBtgTef3DVWYzwP90QoAR713HwPf/UwRbDKeiWAsnWc7+oDKhgZZ2diY4f1HlGM36MHze5qaXOcxoKvHGRqMXe0y7AZvyNR1vMvfawWAiwerT4HzflRHOgaCTH0+JVS5eDGFctQEX5KH7Xfffjv1LF/ufS2puMAcqbIfuBar3aYCmG+RrhNYAVh1diGJDQPZ3r+PfMbqkFSork6Gli0bOU2A5LsREXavXAk/Ln3NI2LSWGMd1xeSfHYg9X0taI2tBpwLDbjP4v2NXDyXEWpooCrWBDG8ygDbfBck393UlNN9/Xre5nUswtqeVhrgCMAqeAex3oJcgoa8Z05ZW2jxYjl66dL8NQGSx+JF1/LlOWeLMT1v8zpqwJ8hDw1g97jeglwiDw1IDUi/qq6ORi9blrNPYJvvhLfvWrnS0du7jZiNBnCB8E/koQHn2mhAPE8NYB5EhDdh82Ypiotz0gBKJMTuCy6QfVu25F05smoAPJ/cqr7ntTZbAZgHajkVHw/baEA/5T6CiO0nOMT2fgbHCbsRMfY55A5uI26jAfyi4B/q0HYbZO3fPBnnXrQgx/tqNEcJlCGrm2DN6vLgHDECBBnNsZ4Qs+QEHBleDN6mvoei0+NWAI4BbedSMGdNhsz4CRwS5NKeUYbY/gifsb0vTUDu8A40IeqznsBzjlFmHNCrV63jmY+Qrg+aAeBiSBfPHwonj7dEUmEfkaAh+YkjIPksTQiHRdvs2b40Ial9gHn+/6TUKz0jRkKCrLpMrJs0N2VM59er15nQJErX3txGOWx+4jBs3lMT4BPaoAkRD5/AW72Rtxjz/zXoB+pPLoacaVxrBYDXXvcF3NdiQZDf0ERckC+Ht5/klc/beXvjfUIOPmHnzJkyaqknmHnCUrNkji1Q/Fkd86v9RicATmeEynD+7/ijgjK9KNuRXT2g9MQTafLWrTnZPO/zHY1qHmPBc8oi4RPePuMM6n/55eznaumb583dJOzhY2r6XAx50QkA7nNg53DUKnx3pWU3iDnkBNjj5cSWFlF55ZW+I7x2xPb7VqxI3T+mvl5W55A7dLe2yrb584WMx7M0YMAmB/gd+Er1Pa9tGplqunaBesoMuOuD+00MuRgeNUz2FWGAQJPWr6fQFVcQucT/rPVYPHWY83lcP7a+nqo9sshULWDDBtp1zTXwctkeyahWm70/H19DuvpB1ADKSCftZjoZ9C9QaSuec7qNLwg72B5rAkAQAMFZ8sjn2x3y+eqGBlntUk/oeuABicXbSp70vm+tBMHuxSJ1zKWwj4Le8QKAB7eZXHcSPjaS6uUz2xTvCE65AWvCkS0tVDV3bqZ0YPN7kdW1e+Tz1YsX0zgbTehqbaWd8+fbSt6YV9IyT/YFHP1tV6d+BFqQNV+HeXA/L7eqBrF1iDkWmzLiggEXTTjq3ntFaM6cIcnvgc23+8nncX11XZ0cr30Cn2fJ75w3z1HykuzfFv8W/A51HftB7mNs8wsADxZVPXd2PkaqD8hAligdHTq9IWJNOFr7hD2Q/N4c8/lxDQ00HprQDZvf4WDzZulb31/sBl1Fauci9Wr8Dtt5uswhCPor6LjTdVxQYEE4qTVh0EkTiopk5YUXim7EB44Sd6snXHqp7HnkkVQV2O06q+Q5e71ebeV8zE0e3LFrW9P1KtecQqo5uewb+LjZgrqhCVE6QL3tNpO3Sp7n80PQb9Rhj178a27P8BrcF/hj7vxYit+52gF5zr768sjb8+HccyTIvl9hPfha5RP4HKf493mB6GcwqLXc0suWbPbvZgmwP+C6wf7SBnOXmbThvNJm9TcfLtXk+Uw/g3/3Z6Qqy+JG/MBXVaXZ1gaNLm+vt8h+Of9OwMXm2Qdx7/A96dCKBXazCZ9hA8CDw+Q7SZmE4BbxRlKtZE4SYXtMULrbO5cRMJHT83mwkXPouiV9mhtC6sj9JXZeABjX85bCGVXBFL3PftJBMmYutaSSevcw79tE6X5Cg3s9j/lL4JhIqj9Q43wDqYAnpwXlM/ifJLhdfhyrBaL/VIg1xkVSI8nbSXV/ce1Si5k7P7jO90yuCxnOWwvulud31JfwAfcTIumQXwQ/3KcEc+GsMfx/Aq06wououfP62fdxP1dHPosY3msbNWaTaqrkRCMVPX2e1L+RcHum0SeSr8RZr7lrg6XNNX1TDsIli1tATwxn8iMBAA9uruCsk21wmvFshNHyNPBTdI2R/1us3MWbM0foKnaBI3IRCOHki+DdmbvC30g5OqT5OfvW/QaAMbiwys3JnIRxEabC/Bv8T4PcmjGW1P/TGR6eV8GtKazDXJW1vInmRb9HqjzxC1J1S18e/mAAYB5wC6niI1sEFCHVgVJK/vZ/zrNeofQ/TiKtp+j+mOT+BMA6WDumaOLkkkvTAUoHkdZ/nR2xf448VAA4JMcHHoD/Axonsrm2P8FXAAAAAElFTkSuQmCC"},,,,,function(e,t,n){var i,r;i=[n(0),n(151),n(31),n(5),n(120),n(28),n(22),n(67),n(27),n(119),n(55),n(4),n(6),n(48),n(104),n(18),n(11),n(1),n(8),n(43),n(98),n(3),n(115),n(7),n(12),n(114),n(113),n(107),n(109),n(108),n(110),n(99),n(47),n(50),n(45)],void 0!==(r=function(e,t,i,r,o,a,s,l,c,u,d,h,p,f,g,m,v,_,y,x,b,w,C,S,T,A,M,E,I,D,k,L,N,P,O){function beforeUnloadHandler(e){S.get(_.genApiUrl("refresh"),"",function(e){},function(e){},"false")}function handleColorChange(){var t=m.getProcessInfo(!0).params.type;H.data.forEach(function(e){e.children.forEach(function(e){e.id===m.getProcessName()&&(e.processType=t)})}),e(".curSelectedNode[title="+m.getProcessName()+"]").eq(0).find(".ico_docu").attr("class","button ico_docu fa fa-flask p-"+t)}function saveCallBack(){setDrag();var e=m.getProcessInfo(!0).params.zaip_id;m.getProcessInfo(!0).operators.forEach(function(t){var n=m.getOperatorAsCell(j,t.name);if(n.value.operatorExecType==y.ZAIPENTRANCE){var i=e+m.getProcessName()+t.name,r=e+m.getProcessName()+n.value.initName;i!==r&&(P.setCacheTrain(i,P.getCacheTrain(r)),P.clearCacheTrain(r))}m.getOperatorAsCell(j,t.name).value.initName=t.name})}function save(t){if(isSaved())return t();var n=m.getProcessInfo(!0),i=[];n.operators.forEach(function(e){var t=m.getOperatorAsCell(j,e.name);if(t.value.operatorExecType==y.ZAIPENTRANCE){var r=g.getSourceByOperatorName(j,e.name,y.PORT_INPUT_TYPE,"params",y.ZAIPDATA);i.push(P.save(e,n,r,m.getProcessName(),t))}t.value.operatorExecType==y.ZAIPPREDICTION&&i.push({ZAIPPrediction:e.name,initName:t.value.initName})});var r={name:m.getProcessName(),content:JSON.stringify(m.getProcessInfo(!0)),type:m.getProcessType(),owner:m.getProcessOwner(),zaip:JSON.stringify(i)},o=function(n){n||"true"===n?(h.success(e.i18n.prop("ict_oneminer_message_save_success"),"",_.toastrConfig),setSavable(!1),handleColorChange(),saveCallBack(),"function"==typeof t&&t()):(setSavable(!0),h.error(e.i18n.prop("ict_oneminer_process_save_failed")))},a=function(e){setSavable(!0),h.info(e,"ajax error",_.toastrConfig)};S.post(_.genApiUrl("process/update"),r,o,a)}function saveas(t,n,i){var r=i?_.genApiUrl("template/add"):_.genApiUrl("process/add"),o=function(t){g.getExperimentFlag()||i||g.setExperimentFlag(!0),t||"true"===t?(h.success(e.i18n.prop("ict_oneminer_message_save_success"),"",_.toastrConfig),n&&setSavable(!1)):h.error(e.i18n.prop("ict_oneminer_process_save_failed"))};S.put(r,t,o,ie,"false"),n&&m.setProcessName(t.name)}function openLogPanel(){F.open("south")}function closeEastPanel(){z.close("east")}function openEastPanel(){z.open("east")}function updateStatus(e){var t=e.data;if(t.operatorStatus){m.refresh(t.operatorStatus),cacheResult(t.processStatus);t.processStatus===y.STATUS_RUNNING||(B=[],m.setModifiedOperators(""),setRunnable(!0),m.updateData(),R&&cometdDisconnect(),m.getLoadingStatus()||W.init(),m.switchExecuteFrameWork(V,W))}p.isEmpty(Y.text())&&t.processStatus&&te(),t.log&&appendLogs(t.log)}function appendLogs(t){t.forEach(function(t){Y.append(t).append(e("<br>"))}),Y.animate({scrollTop:Y[0].scrollHeight-Y[0].clientHeight},{duration:500,queue:!1})}function isSaved(){return e("span#save").hasClass("disabled")}function doSave(e){if(m.getProcessName())return save(e),!0;var t=new O(600,null,m,g,P);return t.data={type:"save"},t.registerHook("afterClose",function(){U.initExperiment(),H.init(),H.setSelectNode(m.getProcessName()),"function"==typeof e&&e()}),t.show(),!1}function setSavable(t,n){t?e("span#save").removeClass("disabled"):(e("span#save").addClass("disabled"),m.setEditStatus(!1)),!m.getLoadingStatus()&&t&&(m.isEditable()?m.editHandler():n&&n()||m.editReload())}function setRunnable(t){m.setRunning(!t),t?(e("span#run").show(),e("span#stop").hide()):(e("span#run").hide(),e("span#stop").show())}function cometdDisconnect(){e.cometd.disconnect(!0),R=void 0}function cometdConnect(t,n){var i;i=t||"/"+x.generate();var r=e.cometd,o=_.genApiUrl("cometd");r.configure({url:o,logLevel:"info"}),r.clearListeners(),r.addListener("/meta/handshake",function(e){e.successful&&(r.batch(function(){R=r.subscribe(i,updateStatus)}),n&&!e.reestablish?n():openLogPanel())});try{"disconnecting"===r.getStatus()?setTimeout(r.handshake,1e3):r.handshake()}catch(e){h.error("Failed to handshake with server, please make sure cometd is disconnected.")}}function runAfterSave(){if(!m.isEditable())return m.editReload();doSave(run)}function run(){var t=f.getChangeNum({execAll:!0}),n=f.getConfirmMessage(t);if(n){var i=new _.Dialog(400,200,n);i.setConfirmHandler(function(){ne(),e(this).dialog("close")}),e("<div></div>").dialog(i).dialog("open")}else ne()}function setDrag(){m.getProcessInfo(!0).operators.forEach(function(e){m.getOperatorAsCell(j,e.name).value.isDrag=!1})}function resizeTabLayout(){var t=e("#exp");(t.jquery?t:e(t.newPanel||t.panel)).filter(":visible").find(".ui-layout-container:visible").andSelf().each(function(){var t=e(this).data("layout");t&&(t.options.resizeWithWindow=!1,t.resizeAll())})}function runByType(t,n,i,r){if(!m.isEditable())return r&&r()||m.editReload();doSave(function(){if(t===y.EXEC_TYPE_STOP)re(t,n,i);else{var r=f.getChangeNum(null,n),o=f.getConfirmMessage(r);if(o){var a=new _.Dialog(400,200,o);a.setConfirmHandler(function(){re(t,n,i),e(this).dialog("close")}),e("<div></div>").dialog(a).dialog("open")}else re(t,n,i)}})}function switchExp(t,n,i){if(isSaved()||!m.getEditStatus())return t();var r=e.i18n.prop("OP_EDIT_Leave"),o=new _.Dialog(400,200,r);o.setConfirmHandler(function(){m.getProcessName()&&(m.stopEdit(),i&&m.editReload(!0)),t(),e(this).dialog("close")}),o.setCancelHandler(function(){n(),e(this).dialog("close")}),e("<div></div>").dialog(o).dialog("open")}function initGraph(){H=new E("#experiment-tree","#exp-tree-div","#expSearch",m,g,"#color-chose .type-circle-cho",switchExp),V=new I("#operator-tree","#op-tree-div","#opSearch",m,g),W=new D("#model-tree","#mod-tree-div","#modSearch",m,g),H.init(),V.init(),W.init(),$=new L(m,g,V,P),g.init(document.getElementById("graph"),document.getElementById("outlineContainer"),changeListener,f.selectionChanged,$.init.bind($),openEastPanel,closeEastPanel),j=g.getGraph(),m.setGraph(j),m.setChangeEvent(paramChangeListener),m.setInitProcess(initProcess),m.methodProxy.addMethod(saveas,"saveas"),m.methodProxy.addMethod(ce,"addExpCallBack"),m.methodProxy.addMethod(ue,"refreshTree"),m.methodProxy.addMethod(runByType,"runByType"),m.methodProxy.addMethod(operatorChangeEvent,"operatorChangeEvent"),m.methodProxy.addMethod(g.getSourceByOperatorName,"getSourceByOperatorName"),m.methodProxy.addMethod(P.clearCacheTrain,"clearCacheTrain"),m.methodProxy.addMethod(setSavable,"setSavable"),f.setGraph(j),f.selectionChanged(),f.setClusterChangeCallback(ae)}function initContainer(){e(window).on("resize",function(){resizeTabLayout()}),e("#east-panel, #west-panel, .top-side, .left-side, .title-bar").on("click",function(){j&&j.popupMenuHandler.div.remove(),e(".train-tip").remove()}),e("#graph").on("click",function(){document.activeElement.blur(),e(".train-tip").remove()}),e("#op-mod-tabs").tabs({activate:function(t,n){0===n.newTab.index()?(H.init(),g.getExperimentFlag()&&H.setSelectNode(m.getProcessName())):1===n.newTab.index()?(V.init(),m.switchExecuteFrameWork(V,W)):2===n.newTab.index()&&(W.init(),m.switchExecuteFrameWork(V,W)),setTimeout(function(){e("#exp-tree-div").getNiceScroll().resize(),e("#op-tree-div").getNiceScroll().resize(),e("#mod-tree-div").getNiceScroll().resize()},1e3)}}),F=e("#center-panel").layout({center__paneSelector:"#graph-panel",south__paneSelector:"#log-panel",initClosed:!0,spacing_open:6,spacing_closed:6,togglerContent_open:'<div class="ui-icon"></div>',togglerContent_closed:'<div class="ui-icon"></div>',south__size:250,onresize:function(){_.doNiceScroll("#log-content")}}),z=e("#exp").layout({center__paneSelector:"#center-panel",west__paneSelector:"#west-panel",east__paneSelector:"#east-panel",west__size:240,east__size:260,spacing_open:6,spacing_closed:6,togglerContent_open:'<div class="ui-icon"></div>',togglerContent_closed:'<div class="ui-icon"></div>',east__resizable:!1,center__onresize:function(){F.resizeAll(),_.doNiceScroll("#exp-tree-div"),_.doNiceScroll("#op-tree-div"),_.doNiceScroll("#mod-tree-div"),_.doNiceScroll("#properties")}}),e("span#download").click(function(){location.href=_.genApiUrl("template/download?templateNames="+m.getProcessName())}),e("span#save").click(doSave),e("span#saveas").click(function(){var e=new O(600,null,m,g,P);e.data={type:"save"},e.registerHook("afterClose",function(e){initProcess(e,!0),U.initExperiment(),H.init(),H.setSelectNode(e)}),e.show()}),e("span#saveasTemplate").click(function(){var e=N.getInstance(600,"auto",m,g,P);e.data={type:"new"},e.registerHook("afterClose",function(){U.initTemplate()}),e.show()}),e("span#run").click(runAfterSave),e("span#stop").hide(),e("span#stop").click(function(){if(!m.isEditable())return m.editReload();m.stop(null)}),e("span#copy").click(function(){g.copy()}),e("span#paste").click(function(){g.paste()}),e("span#pan").click(function(){"pan"===j.mode?(g.setMode("connect"),e("#pan").removeClass("pressed")):(e("#pan").addClass("pressed"),g.setMode("pan"))}),e("span#delete").click(function(){g.delZaip(),j.removeCells()}),e("span#zoomin").click(function(){j.zoomIn()}),e("span#zoomout").click(function(){j.zoomOut()}),e("span#zoomactual").click(function(){j.zoomActual()}),e("span#fit").click(function(){j.fit()}),e("span#outline").click(function(){var t=e("#outlineContainer");t.is(":visible")?t.addClass("hide"):(t.removeClass("hide"),j.outline.update())}),e("#toolbar>span").each(function(){if(this.title){var t=this.title,n=this.id;e(this).mouseover(function(i){this.title="",e("#graph-panel>.title-bar").append('<span id="tooltip">'+t+"</span>");var r=e("#"+n)[0].offsetLeft,o=e("#"+n)[0].offsetTop,a=parseInt(e("#tooltip").css("width"),10)/2-9;e("#tooltip").css({left:r-a+"px",top:o+35+"px",position:"absolute",background:"#2E394A"}).show()}).mouseout(function(){e("#tooltip").remove(),this.title=t})}})}function cacheResult(e){p.isArray(e.resultList)&&!p.isEmpty(e.resultList)&&(e.resultList.forEach(function(e){var t=e.operatorName;X[t]=[]}),e.resultList.forEach(function(e){var t=e.operatorName;p.has(X,t)&&X[t].push(e)}))}function changeListener(e,t){setSavable(!0)}function paramChangeListener(e){e&&(setSavable(!0),p.isArray(B)&&!p.contains(B,e)&&(B.push(e),m.setModifiedOperators(B.join())))}function activeHome(){}function activeExp(){resizeTabLayout(),_.doNiceScroll("#exp-tree-div"),_.doNiceScroll("#op-tree-div"),_.doNiceScroll("#mod-tree-div"),_.doNiceScroll("#properties");var e=m.getProcessName();U.experiments.concat(U.templates).indexOf(e)>-1||(cometdDisconnect(),m.setProcessName(""),g.clear(),f.selectionChanged(!1)),closeEastPanel()}function activeManage(){e(".download-template").width(e("#downloadMenu").outerWidth()),q.initOperatorTable()}function activeLog(){A.init()}function activeBackup(){}function init(){e(document).ajaxError(function(e,t){401===t.status&&(location.href=_.genStaticUrl("login.html"))});var t=_.getUsername();if(!t)return void(location.href=_.genStaticUrl("login.html"));w.refetchDiyOperatorI18n(),e("span#username").text(t);var n=e(".notification-menu .dropdown-toggle").css("width");e(".notification-menu .dropdown-menu-usermenu").css("width",n),e(".notification-menu li").on("mouseenter mouseleave",function(){e(this).toggleClass("open")}),e("a#signout").on("click",function(){var t=e.i18n.prop("ict_oneminer_dialog_logout_confirm"),n=new _.Dialog(400,200,t);n.setConfirmHandler(function(){T.remove("aieUser",{path:"/aie"}),T.remove("aiePwd",{path:"/aie"}),T.remove("aieUser",{path:"/aie/"}),T.remove("aiePwd",{path:"/aie/"}),e(this).dialog("close"),S.post(_.genApiUrl("auth/logout"),null,null,null,"false"),_.signout()}),e("<div></div>").dialog(n).dialog("open")}),e("a#about").on("click",function(){var t=new _.Dialog(500,300);t.buttons=[],t.title="",t.open=function(t){de(e(t.target))},e("<div></div>").dialog(t).dialog("open")}),e('li[role="presentation"]').click(function(){var t=e(this).attr("type");e(this).addClass("active").siblings().removeClass("active"),oe(t)}),e('li[role="presentation"][type="log"]').on("mouseenter mouseleave",function(){e(".maint-menu").toggleClass("show")}),e(".maint-menu li").click(function(t){t.stopPropagation();var n=e(this).attr("type");e('li[role="presentation"][type="log"]').addClass("active").siblings().removeClass("active"),oe(n)}),U=new k(m,g,P),initContainer(),initGraph(),P.initContainer(runByType,setSavable,m.isEditable),q=new C(m)}function resetOperatorAndModelTree(){V.init(),W.init(),setTimeout(function(){e("#exp-tree-div").getNiceScroll().resize(),e("#op-tree-div").getNiceScroll().resize(),e("#mod-tree-div").getNiceScroll().resize()},1e3),m.switchExecuteFrameWork(V,W)}function initProcess(t,n,i){m.setLoadingStatus(!0),g.clear(),n?(e("span#save, span#run").show(),e("span#download, span#stop").hide()):(e("span#download").show(),e("span#save, span#run, span#stop").hide());var r=n?_.genApiUrl("process/query/")+t:_.genApiUrl("template/query/")+t,o=function(e){e&&e.hasOwnProperty("content")?K(t,i,JSON.parse(e.content)):(m.setLoadingStatus(!1),h.error("process not found or is illegal","Load process error",{timeOut:5e3}))};S.get(r,{owner:i},o,ie)}function operatorChangeEvent(){V.init(!0),m.switchExecuteFrameWork(V,W)}_.mx;n(38),n(37),n(126),n(39),_.initWebRoot();var R,z,F,B,H,V,W,U,$,G,q,j=null,Y=e("#log-content"),X={};window.addEventListener("beforeunload",beforeUnloadHandler,!0);var Z=T.get("paasName");Z&&(e("#signout").remove(),function(t){e.ajax({method:"POST",url:_.genApiUrl("callback?client_name=FormClient"),async:!1,contentType:"application/x-www-form-urlencoded",data:{username:t,password:t,submit:"Submit"},success:function(e,n,i){if(200===i.status){var r=(new Date).getTime();T.set("loginTime",r,{expires:365,path:""});var e={password:t};S.post(_.genApiUrl("auth/login"),e,null,null,"false")}},error:function(){location.href=_.genStaticUrl("login.html")}})}(Z));var K=function(t,n,i){if(m.setProcessName(t),m.setProcessOwner(n),e("#log-content").empty(),cometdDisconnect(),!i.operators||!i.connects)return m.setLoadingStatus(!1),h.error("process illegal");g.setModelUpdate(!0);var r=(i.groups||[]).map(function(e){return g.insertOperator(e)});e.when.apply(e,r).done(function(){var t=i.operators.map(function(e){return g.insertOperator(e)});e.when.apply(e,t).done(function(){i.connects.forEach(function(e){return g.insertConnect(e)}),m.setParams(i.params),resetOperatorAndModelTree(),ee(i)})})},J=function(e){g.setModelUpdate(!1),j.selectCells(),f.selectionChanged(!1),Q(e),setSavable(!1),m.setLoadingStatus(!1),m.updateData()},Q=function(e){var t=p.has(e,"scale")?e.scale:1;j.getView().setScale(t);var n=0,i=0;if(p.has(e,"translate")){var r=JSON.parse(e.translate);n=r.x,i=r.y}j.getView().setTranslate(n,i)},ee=function(e){if(g.getExperimentFlag()){setRunnable(!0);var t={processName:m.getProcessName(),owner:m.getProcessOwner()};S.post(_.genApiUrl("process/resulthandler"),t,function(t){p.isObject(t)&&(t.processStatus===y.STATUS_RUNNING&&t.topic?(setRunnable(!1),updateStatus({data:t}),cometdConnect(m.getTopic())):updateStatus({data:t})),J(e)})}else J(e)},te=function(){var e={processName:m.getProcessName(),owner:m.getProcessOwner()};S.post(_.genApiUrl("process/execlog"),e,appendLogs,ie)},ne=function(){if(setRunnable(!1),R)return void h.warning(e.i18n.prop("ict_oneminer_tips_processisrunning"));x.generate();cometdConnect(m.getTopic(),function(){var t=m.run(y.EXEC_TYPE_ALL);"1"!==t?(t&&h.error(t),cometdDisconnect(),setRunnable(!0)):(e("#log-content").empty(),openLogPanel())})},ie=function(e){h.info(e,"ajax error",_.toastrConfig)},re=function(t,n,i){m.isRunning()?m.run(t,n,[]):cometdConnect(m.getTopic(),function(){var r="";p.isArray(B)&&(r=B.join());var o=m.run(t,n,r);"1"!==o?(h.error(o,"Error",{timeOut:5e3}),cometdDisconnect(),setRunnable(!0)):(setRunnable(!1),B=[],m.setModifiedOperators(""),e("#log-content").empty(),openLogPanel()),i&&i()})};e.validator.addMethod("operatorName",function(e){return p.last(V.data).children.map(function(e){return e.id}).indexOf(e)<0});var oe=function(t){var n={home:activeHome,exp:activeExp,manage:activeManage,log:activeLog,backup:activeBackup},i=function(){e("#"+t).show().siblings().hide(),n[t].call()},r=function(){e('li[role="presentation"][type="exp"]').addClass("active").siblings().removeClass("active")};e("#exp").is(":visible")?switchExp(i,r,!0):i()},ae=function(){resetOperatorAndModelTree(),se();var e={name:m.getProcessName()},t=function(){var e={processName:m.getProcessName(),processInfo:JSON.stringify(m.getProcessInfo()),modifiedOperators:"",topic:m.getTopic(),owner:m.getProcessOwner()},t=_.getDataFromServer(e,_.genApiUrl("process/validate"));m.refresh(t)};S.post(_.genApiUrl("process/clearProcessCache"),e,t,ie)},se=function(){j.getModel().filterDescendants(function(e){return e&&e.value&&e.value.isOperator}).forEach(function(e){le(e),e.value.status={}})},le=function(e){var t=e.value.params,n=_.getParameters(e.value.type);for(var i in t){var r=n.filter(function(e){return e.key===i}),o=r&&r[0]&&r[0].type;p.contains(["attribute","list"],o)&&(t[i]="")}},ce=function(t,n,i){if(m.getLoadingStatus())return void setTimeout(function(){H.setSelectNode(m.getProcessName())},0);g.setExperimentFlag(n),e('li[role="presentation"][type="exp"]').click(),initProcess(t.exp,n,t.userId),i&&H.init(),H.setSelectNode(n?t.exp:null),e("#home").getNiceScroll().resize()},ue=function(e){H.init(),H.setSelectNode(e)},de=function(t){var n=G||(G=_.doGet(_.genApiUrl("version/getVersion"))),i='<div class="about-main headingImage" style="">\n                        <span>ZTE</span>\n                        <i class="fa fa-circle"></i>\n                        <span>AI Explorer</span>\n                    </div>\n                    <ul class="about-info">\n                        <li>'+e.i18n.prop("ict_oneminer_dialog_about_build")+"<span>"+(n&&n.buildTime||"")+"</span></li>\n                        <li>"+e.i18n.prop("ict_oneminer_dialog_about_version")+"<span>"+(n&&n.version||"")+" ("+(n&&n.commitID||"")+")</span></li>\n                    </ul>";t.append(i),t.parent().addClass("about-dialog")};return{init:init}}.apply(t,i))&&(e.exports=r)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},,function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){var i,r;!function(o){i=[n(0)],void 0!==(r=function(e){return o(e,window,document)}.apply(t,i))&&(e.exports=r)}(function(e,t,n,i){function Y(t){var n,i,r={};e.each(t,function(e){(n=e.match(/^([^A-Z]+?)([A-Z])/))&&-1!=="a aa ai ao as b fn i m o s ".indexOf(n[1]+" ")&&(i=e.replace(n[0],n[2].toLowerCase()),r[i]=e,"o"===n[1]&&Y(t[e]))}),t._hungarianMap=r}function J(t,n,r){t._hungarianMap||Y(t);var o;e.each(n,function(a){(o=t._hungarianMap[a])===i||!r&&n[o]!==i||("o"===o.charAt(0)?(n[o]||(n[o]={}),e.extend(!0,n[o],n[a]),J(t[o],n[o],r)):n[o]=n[a])})}function Fa(e){var t=c.defaults.oLanguage,n=e.sZeroRecords;!e.sEmptyTable&&n&&"No data available in table"===t.sEmptyTable&&F(e,e,"sZeroRecords","sEmptyTable"),!e.sLoadingRecords&&n&&"Loading..."===t.sLoadingRecords&&F(e,e,"sZeroRecords","sLoadingRecords"),e.sInfoThousands&&(e.sThousands=e.sInfoThousands),(e=e.sDecimal)&&fb(e)}function gb(e){if(L(e,"ordering","bSort"),L(e,"orderMulti","bSortMulti"),L(e,"orderClasses","bSortClasses"),L(e,"orderCellsTop","bSortCellsTop"),L(e,"order","aaSorting"),L(e,"orderFixed","aaSortingFixed"),L(e,"paging","bPaginate"),L(e,"pagingType","sPaginationType"),L(e,"pageLength","iDisplayLength"),L(e,"searching","bFilter"),"boolean"==typeof e.sScrollX&&(e.sScrollX=e.sScrollX?"100%":""),"boolean"==typeof e.scrollX&&(e.scrollX=e.scrollX?"100%":""),e=e.aoSearchCols)for(var t=0,n=e.length;t<n;t++)e[t]&&J(c.models.oSearch,e[t])}function hb(t){L(t,"orderable","bSortable"),L(t,"orderData","aDataSort"),L(t,"orderSequence","asSorting"),L(t,"orderDataType","sortDataType");var n=t.aDataSort;n&&!e.isArray(n)&&(t.aDataSort=[n])}function ib(n){if(!c.__browser){var i={};c.__browser=i;var r=e("<div/>").css({position:"fixed",top:0,left:-1*e(t).scrollLeft(),height:1,width:1,overflow:"hidden"}).append(e("<div/>").css({position:"absolute",top:1,left:1,width:100,overflow:"scroll"}).append(e("<div/>").css({width:"100%",height:10}))).appendTo("body"),o=r.children(),a=o.children();i.barWidth=o[0].offsetWidth-o[0].clientWidth,i.bScrollOversize=100===a[0].offsetWidth&&100!==o[0].clientWidth,i.bScrollbarLeft=1!==Math.round(a.offset().left),i.bBounding=!!r[0].getBoundingClientRect().width,r.remove()}e.extend(n.oBrowser,c.__browser),n.oScroll.iBarWidth=c.__browser.barWidth}function jb(e,t,n,r,o,a){var s,l=!1;for(n!==i&&(s=n,l=!0);r!==o;)e.hasOwnProperty(r)&&(s=l?t(s,e[r],r,e):e[r],l=!0,r+=a);return s}function Ga(t,i){var r=c.defaults.column,o=t.aoColumns.length,r=e.extend({},c.models.oColumn,r,{nTh:i||n.createElement("th"),sTitle:r.sTitle?r.sTitle:i?i.innerHTML:"",aDataSort:r.aDataSort?r.aDataSort:[o],mData:r.mData?r.mData:o,idx:o});t.aoColumns.push(r),r=t.aoPreSearchCols,r[o]=e.extend({},c.models.oSearch,r[o]),la(t,o,e(i).data())}function la(t,n,r){var n=t.aoColumns[n],o=t.oClasses,a=e(n.nTh);if(!n.sWidthOrig){n.sWidthOrig=a.attr("width")||null;var s=(a.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/);s&&(n.sWidthOrig=s[1])}r!==i&&null!==r&&(hb(r),J(c.defaults.column,r),r.mDataProp!==i&&!r.mData&&(r.mData=r.mDataProp),r.sType&&(n._sManualType=r.sType),r.className&&!r.sClass&&(r.sClass=r.className),e.extend(n,r),F(n,r,"sWidth","sWidthOrig"),r.iDataSort!==i&&(n.aDataSort=[r.iDataSort]),F(n,r,"aDataSort"));var l=n.mData,u=R(l),d=n.mRender?R(n.mRender):null,r=function(e){return"string"==typeof e&&-1!==e.indexOf("@")};n._bAttrSrc=e.isPlainObject(l)&&(r(l.sort)||r(l.type)||r(l.filter)),n._setter=null,n.fnGetData=function(e,t,n){var r=u(e,t,i,n);return d&&t?d(r,t,e,n):r},n.fnSetData=function(e,t,n){return S(l)(e,t,n)},"number"!=typeof l&&(t._rowReadObject=!0),t.oFeatures.bSort||(n.bSortable=!1,a.addClass(o.sSortableNone)),t=-1!==e.inArray("asc",n.asSorting),r=-1!==e.inArray("desc",n.asSorting),n.bSortable&&(t||r)?t&&!r?(n.sSortingClass=o.sSortableAsc,n.sSortingClassJUI=o.sSortJUIAscAllowed):!t&&r?(n.sSortingClass=o.sSortableDesc,n.sSortingClassJUI=o.sSortJUIDescAllowed):(n.sSortingClass=o.sSortable,n.sSortingClassJUI=o.sSortJUI):(n.sSortingClass=o.sSortableNone,n.sSortingClassJUI="")}function Z(e){if(!1!==e.oFeatures.bAutoWidth){var t=e.aoColumns;Ha(e);for(var n=0,i=t.length;n<i;n++)t[n].nTh.style.width=t[n].sWidth}t=e.oScroll,(""!==t.sY||""!==t.sX)&&ma(e),s(e,null,"column-sizing",[e])}function $(e,t){var n=na(e,"bVisible");return"number"==typeof n[t]?n[t]:null}function aa(t,n){var i=na(t,"bVisible"),i=e.inArray(n,i);return-1!==i?i:null}function ba(t){var n=0;return e.each(t.aoColumns,function(t,i){i.bVisible&&"none"!==e(i.nTh).css("display")&&n++}),n}function na(t,n){var i=[];return e.map(t.aoColumns,function(e,t){e[n]&&i.push(t)}),i}function Ia(e){var t,n,r,o,a,s,l,u,d,h=e.aoColumns,p=e.aoData,f=c.ext.type.detect;for(t=0,n=h.length;t<n;t++)if(l=h[t],d=[],!l.sType&&l._sManualType)l.sType=l._sManualType;else if(!l.sType){for(r=0,o=f.length;r<o;r++){for(a=0,s=p.length;a<s&&(d[a]===i&&(d[a]=B(e,a,t,"type")),(u=f[r](d[a],e))||r===f.length-1)&&"html"!==u;a++);if(u){l.sType=u;break}}l.sType||(l.sType="string")}}function kb(t,n,r,o){var a,s,l,c,u,d,h=t.aoColumns;if(n)for(a=n.length-1;0<=a;a--){d=n[a];var p=d.targets!==i?d.targets:d.aTargets;for(e.isArray(p)||(p=[p]),s=0,l=p.length;s<l;s++)if("number"==typeof p[s]&&0<=p[s]){for(;h.length<=p[s];)Ga(t);o(p[s],d)}else if("number"==typeof p[s]&&0>p[s])o(h.length+p[s],d);else if("string"==typeof p[s])for(c=0,u=h.length;c<u;c++)("_all"==p[s]||e(h[c].nTh).hasClass(p[s]))&&o(c,d)}if(r)for(a=0,t=r.length;a<t;a++)o(a,r[a])}function N(t,n,r,o){var a=t.aoData.length,s=e.extend(!0,{},c.models.oRow,{src:r?"dom":"data",idx:a});s._aData=n,t.aoData.push(s);for(var l=t.aoColumns,u=0,d=l.length;u<d;u++)l[u].sType=null;return t.aiDisplayMaster.push(a),n=t.rowIdFn(n),n!==i&&(t.aIds[n]=s),(r||!t.oFeatures.bDeferRender)&&Ja(t,a,r,o),a}function oa(t,n){var i;return n instanceof e||(n=e(n)),n.map(function(e,n){return i=Ka(t,n),N(t,i.data,n,i.cells)})}function B(e,t,n,r){var o=e.iDraw,a=e.aoColumns[n],s=e.aoData[t]._aData,l=a.sDefaultContent,c=a.fnGetData(s,r,{settings:e,row:t,col:n});if(c===i)return e.iDrawError!=o&&null===l&&(K(e,0,"Requested unknown parameter "+("function"==typeof a.mData?"{function}":"'"+a.mData+"'")+" for row "+t+", column "+n,4),e.iDrawError=o),l;if(c!==s&&null!==c||null===l||r===i){if("function"==typeof c)return c.call(s)}else c=l;return null===c&&"display"==r?"":c}function lb(e,t,n,i){e.aoColumns[n].fnSetData(e.aoData[t]._aData,i,{settings:e,row:t,col:n})}function La(t){return e.map(t.match(/(\\.|[^\.])+/g)||[""],function(e){return e.replace(/\\\./g,".")})}function R(t){if(e.isPlainObject(t)){var n={};return e.each(t,function(e,t){t&&(n[e]=R(t))}),function(e,t,r,o){var a=n[t]||n._;return a!==i?a(e,t,r,o):e}}if(null===t)return function(e){return e};if("function"==typeof t)return function(e,n,i,r){return t(e,n,i,r)};if("string"==typeof t&&(-1!==t.indexOf(".")||-1!==t.indexOf("[")||-1!==t.indexOf("("))){var r=function(t,n,o){var a,s;if(""!==o){s=La(o);for(var l=0,c=s.length;l<c;l++){if(o=s[l].match(P),a=s[l].match(H),o){if(s[l]=s[l].replace(P,""),""!==s[l]&&(t=t[s[l]]),a=[],s.splice(0,l+1),s=s.join("."),e.isArray(t))for(l=0,c=t.length;l<c;l++)a.push(r(t[l],n,s));t=o[0].substring(1,o[0].length-1),t=""===t?a:a.join(t);break}if(a)s[l]=s[l].replace(H,""),t=t[s[l]]();else{if(null===t||t[s[l]]===i)return i;t=t[s[l]]}}}return t};return function(e,n){return r(e,n,t)}}return function(e){return e[t]}}function S(t){if(e.isPlainObject(t))return S(t._);if(null===t)return function(){};if("function"==typeof t)return function(e,n,i){t(e,"set",n,i)};if("string"==typeof t&&(-1!==t.indexOf(".")||-1!==t.indexOf("[")||-1!==t.indexOf("("))){var n=function(t,r,o){var a,o=La(o);a=o[o.length-1];for(var s,l,c=0,u=o.length-1;c<u;c++){if(s=o[c].match(P),l=o[c].match(H),s){if(o[c]=o[c].replace(P,""),t[o[c]]=[],a=o.slice(),a.splice(0,c+1),s=a.join("."),e.isArray(r))for(l=0,u=r.length;l<u;l++)a={},n(a,r[l],s),t[o[c]].push(a);else t[o[c]]=r;return}l&&(o[c]=o[c].replace(H,""),t=t[o[c]](r)),null!==t[o[c]]&&t[o[c]]!==i||(t[o[c]]={}),t=t[o[c]]}a.match(H)?t[a.replace(H,"")](r):t[a.replace(P,"")]=r};return function(e,i){return n(e,i,t)}}return function(e,n){e[t]=n}}function Ma(e){return A(e.aoData,"_aData")}function pa(e){e.aoData.length=0,e.aiDisplayMaster.length=0,e.aiDisplay.length=0,e.aIds={}}function qa(e,t,n){for(var r=-1,o=0,a=e.length;o<a;o++)e[o]==t?r=o:e[o]>t&&e[o]--;-1!=r&&n===i&&e.splice(r,1)}function da(e,t,n,r){var o,a=e.aoData[t],s=function(n,i){for(;n.childNodes.length;)n.removeChild(n.firstChild);n.innerHTML=B(e,t,i,"display")};if("dom"!==n&&(n&&"auto"!==n||"dom"!==a.src)){var l=a.anCells;if(l)if(r!==i)s(l[r],r);else for(n=0,o=l.length;n<o;n++)s(l[n],n)}else a._aData=Ka(e,a,r,r===i?i:a._aData).data;if(a._aSortData=null,a._aFilterData=null,s=e.aoColumns,r!==i)s[r].sType=null;else{for(n=0,o=s.length;n<o;n++)s[n].sType=null;Na(e,a)}}function Ka(t,n,r,o){var a,s,l,c=[],u=n.firstChild,d=0,h=t.aoColumns,p=t._rowReadObject,o=o!==i?o:p?{}:[],f=function(e,t){if("string"==typeof e){var n=e.indexOf("@");-1!==n&&(n=e.substring(n+1),S(e)(o,t.getAttribute(n)))}},g=function(t){r!==i&&r!==d||(s=h[d],l=e.trim(t.innerHTML),s&&s._bAttrSrc?(S(s.mData._)(o,l),f(s.mData.sort,t),f(s.mData.type,t),f(s.mData.filter,t)):p?(s._setter||(s._setter=S(s.mData)),s._setter(o,l)):o[d]=l),d++};if(u)for(;u;)a=u.nodeName.toUpperCase(),"TD"!=a&&"TH"!=a||(g(u),c.push(u)),u=u.nextSibling;else for(c=n.anCells,u=0,a=c.length;u<a;u++)g(c[u]);return(n=n.firstChild?n:n.nTr)&&(n=n.getAttribute("id"))&&S(t.rowId)(o,n),{data:o,cells:c}}function Ja(t,i,r,o){var a,l,c,u,d,h=t.aoData[i],p=h._aData,f=[];if(null===h.nTr){for(a=r||n.createElement("tr"),h.nTr=a,h.anCells=f,a._DT_RowIndex=i,Na(t,h),u=0,d=t.aoColumns.length;u<d;u++)c=t.aoColumns[u],l=r?o[u]:n.createElement(c.sCellType),l._DT_CellIndex={row:i,column:u},f.push(l),r&&!c.mRender&&c.mData===u||e.isPlainObject(c.mData)&&c.mData._===u+".display"||(l.innerHTML=B(t,i,u,"display")),c.sClass&&(l.className+=" "+c.sClass),c.bVisible&&!r?a.appendChild(l):!c.bVisible&&r&&l.parentNode.removeChild(l),c.fnCreatedCell&&c.fnCreatedCell.call(t.oInstance,l,B(t,i,u),p,i,u);s(t,"aoRowCreatedCallback",null,[a,p,i])}h.nTr.setAttribute("role","row")}function Na(t,n){var i=n.nTr,r=n._aData;if(i){var o=t.rowIdFn(r);o&&(i.id=o),r.DT_RowClass&&(o=r.DT_RowClass.split(" "),n.__rowc=n.__rowc?k(n.__rowc.concat(o)):o,e(i).removeClass(n.__rowc.join(" ")).addClass(r.DT_RowClass)),r.DT_RowAttr&&e(i).attr(r.DT_RowAttr),r.DT_RowData&&e(i).data(r.DT_RowData)}}function mb(t){var n,i,r,o,a,s=t.nTHead,l=t.nTFoot,c=0===e("th, td",s).length,u=t.oClasses,d=t.aoColumns;for(c&&(o=e("<tr/>").appendTo(s)),n=0,i=d.length;n<i;n++)a=d[n],r=e(a.nTh).addClass(a.sClass),c&&r.appendTo(o),t.oFeatures.bSort&&(r.addClass(a.sSortingClass),!1!==a.bSortable&&(r.attr("tabindex",t.iTabIndex).attr("aria-controls",t.sTableId),Oa(t,a.nTh,n))),a.sTitle!=r[0].innerHTML&&r.html(a.sTitle),Pa(t,"header")(t,r,a,u);if(c&&ea(t.aoHeader,s),e(s).find(">tr").attr("role","row"),e(s).find(">tr>th, >tr>td").addClass(u.sHeaderTH),e(l).find(">tr>th, >tr>td").addClass(u.sFooterTH),null!==l)for(t=t.aoFooter[0],n=0,i=t.length;n<i;n++)a=d[n],a.nTf=t[n].cell,a.sClass&&e(a.nTf).addClass(a.sClass)}function fa(t,n,r){var o,a,s,l,c=[],u=[],d=t.aoColumns.length;if(n){for(r===i&&(r=!1),o=0,a=n.length;o<a;o++){for(c[o]=n[o].slice(),c[o].nTr=n[o].nTr,s=d-1;0<=s;s--)!t.aoColumns[s].bVisible&&!r&&c[o].splice(s,1);u.push([])}for(o=0,a=c.length;o<a;o++){if(t=c[o].nTr)for(;s=t.firstChild;)t.removeChild(s);for(s=0,n=c[o].length;s<n;s++)if(l=d=1,u[o][s]===i){for(t.appendChild(c[o][s].cell),u[o][s]=1;c[o+d]!==i&&c[o][s].cell==c[o+d][s].cell;)u[o+d][s]=1,d++;for(;c[o][s+l]!==i&&c[o][s].cell==c[o][s+l].cell;){for(r=0;r<d;r++)u[o+r][s+l]=1;l++}e(c[o][s].cell).attr("rowspan",d).attr("colspan",l)}}}}function O(t){var n=s(t,"aoPreDrawCallback","preDraw",[t]);if(-1!==e.inArray(!1,n))C(t,!1);else{var n=[],r=0,o=t.asStripeClasses,a=o.length,l=t.oLanguage,c=t.iInitDisplayStart,u="ssp"==y(t),d=t.aiDisplay;t.bDrawing=!0,c!==i&&-1!==c&&(t._iDisplayStart=u?c:c>=t.fnRecordsDisplay()?0:c,t.iInitDisplayStart=-1);var c=t._iDisplayStart,h=t.fnDisplayEnd();if(t.bDeferLoading)t.bDeferLoading=!1,t.iDraw++,C(t,!1);else if(u){if(!t.bDestroying&&!nb(t))return}else t.iDraw++;if(0!==d.length)for(l=u?t.aoData.length:h,u=u?0:c;u<l;u++){var p=d[u],f=t.aoData[p];if(null===f.nTr&&Ja(t,p),p=f.nTr,0!==a){var g=o[r%a];f._sRowStripe!=g&&(e(p).removeClass(f._sRowStripe).addClass(g),f._sRowStripe=g)}s(t,"aoRowCallback",null,[p,f._aData,r,u]),n.push(p),r++}else r=l.sZeroRecords,1==t.iDraw&&"ajax"==y(t)?r=l.sLoadingRecords:l.sEmptyTable&&0===t.fnRecordsTotal()&&(r=l.sEmptyTable),n[0]=e("<tr/>",{class:a?o[0]:""}).append(e("<td />",{valign:"top",colSpan:ba(t),class:t.oClasses.sRowEmpty}).html(r))[0];s(t,"aoHeaderCallback","header",[e(t.nTHead).children("tr")[0],Ma(t),c,h,d]),s(t,"aoFooterCallback","footer",[e(t.nTFoot).children("tr")[0],Ma(t),c,h,d]),o=e(t.nTBody),o.children().detach(),o.append(e(n)),s(t,"aoDrawCallback","draw",[t]),t.bSorted=!1,t.bFiltered=!1,t.bDrawing=!1}}function T(e,t){var n=e.oFeatures,i=n.bFilter;n.bSort&&ob(e),i?ga(e,e.oPreviousSearch):e.aiDisplay=e.aiDisplayMaster.slice(),!0!==t&&(e._iDisplayStart=0),e._drawHold=t,O(e),e._drawHold=!1}function pb(t){var n=t.oClasses,i=e(t.nTable),i=e("<div/>").insertBefore(i),r=t.oFeatures,o=e("<div/>",{id:t.sTableId+"_wrapper",class:n.sWrapper+(t.nTFoot?"":" "+n.sNoFooter)});t.nHolding=i[0],t.nTableWrapper=o[0],t.nTableReinsertBefore=t.nTable.nextSibling;for(var a,s,l,u,d,h,p=t.sDom.split(""),f=0;f<p.length;f++){if(a=null,"<"==(s=p[f])){if(l=e("<div/>")[0],"'"==(u=p[f+1])||'"'==u){for(d="",h=2;p[f+h]!=u;)d+=p[f+h],h++;"H"==d?d=n.sJUIHeader:"F"==d&&(d=n.sJUIFooter),-1!=d.indexOf(".")?(u=d.split("."),l.id=u[0].substr(1,u[0].length-1),l.className=u[1]):"#"==d.charAt(0)?l.id=d.substr(1,d.length-1):l.className=d,f+=h}o.append(l),o=e(l)}else if(">"==s)o=o.parent();else if("l"==s&&r.bPaginate&&r.bLengthChange)a=qb(t);else if("f"==s&&r.bFilter)a=rb(t);else if("r"==s&&r.bProcessing)a=sb(t);else if("t"==s)a=tb(t);else if("i"==s&&r.bInfo)a=ub(t);else if("p"==s&&r.bPaginate)a=vb(t);else if(0!==c.ext.feature.length)for(l=c.ext.feature,h=0,u=l.length;h<u;h++)if(s==l[h].cFeature){a=l[h].fnInit(t);break}a&&(l=t.aanFeatures,l[s]||(l[s]=[]),l[s].push(a),o.append(a))}i.replaceWith(o),t.nHolding=null}function ea(t,n){var i,r,o,a,s,l,c,u,d,h,p=e(n).children("tr");for(t.splice(0,t.length),o=0,l=p.length;o<l;o++)t.push([]);for(o=0,l=p.length;o<l;o++)for(i=p[o],r=i.firstChild;r;){if("TD"==r.nodeName.toUpperCase()||"TH"==r.nodeName.toUpperCase()){for(u=1*r.getAttribute("colspan"),d=1*r.getAttribute("rowspan"),u=u&&0!==u&&1!==u?u:1,d=d&&0!==d&&1!==d?d:1,a=0,s=t[o];s[a];)a++;for(c=a,h=1===u,s=0;s<u;s++)for(a=0;a<d;a++)t[o+a][c+s]={cell:r,unique:h},t[o+a].nTr=i}r=r.nextSibling}}function ta(e,t,n){var i=[];n||(n=e.aoHeader,t&&(n=[],ea(n,t)));for(var t=0,r=n.length;t<r;t++)for(var o=0,a=n[t].length;o<a;o++)!n[t][o].unique||i[o]&&e.bSortCellsTop||(i[o]=n[t][o].cell);return i}function ua(t,n,i){if(s(t,"aoServerParams","serverParams",[n]),n&&e.isArray(n)){var r={},o=/(.*?)\[\]$/;e.each(n,function(e,t){var n=t.name.match(o);n?(n=n[0],r[n]||(r[n]=[]),r[n].push(t.value)):r[t.name]=t.value}),n=r}var a,l=t.ajax,c=t.oInstance,u=function(e){s(t,null,"xhr",[t,e,t.jqXHR]),i(e)};if(e.isPlainObject(l)&&l.data){a=l.data;var d=e.isFunction(a)?a(n,t):a,n=e.isFunction(a)&&d?d:e.extend(!0,n,d);delete l.data}d={data:n,success:function(e){var n=e.error||e.sError;n&&K(t,0,n),t.json=e,u(e)},dataType:"json",cache:!1,type:t.sServerMethod,error:function(n,i){var r=s(t,null,"xhr",[t,null,t.jqXHR]);-1===e.inArray(!0,r)&&("parsererror"==i?K(t,0,"Invalid JSON response",1):4===n.readyState&&K(t,0,"Ajax error",7)),C(t,!1)}},t.oAjaxData=n,s(t,null,"preXhr",[t,n]),t.fnServerData?t.fnServerData.call(c,t.sAjaxSource,e.map(n,function(e,t){return{name:t,value:e}}),u,t):t.sAjaxSource||"string"==typeof l?t.jqXHR=e.ajax(e.extend(d,{url:l||t.sAjaxSource})):e.isFunction(l)?t.jqXHR=l.call(c,n,u,t):(t.jqXHR=e.ajax(e.extend(d,l)),l.data=a)}function nb(e){return!e.bAjaxDataGet||(e.iDraw++,C(e,!0),ua(e,wb(e),function(t){xb(e,t)}),!1)}function wb(t){var n,i,r,o,a=t.aoColumns,s=a.length,l=t.oFeatures,u=t.oPreviousSearch,d=t.aoPreSearchCols,h=[],p=W(t);n=t._iDisplayStart,i=!1!==l.bPaginate?t._iDisplayLength:-1;var f=function(e,t){h.push({name:e,value:t})};f("sEcho",t.iDraw),f("iColumns",s),f("sColumns",A(a,"sName").join(",")),f("iDisplayStart",n),f("iDisplayLength",i);var g={draw:t.iDraw,columns:[],order:[],start:n,length:i,search:{value:u.sSearch,regex:u.bRegex}};for(n=0;n<s;n++)r=a[n],o=d[n],i="function"==typeof r.mData?"function":r.mData,g.columns.push({data:i,name:r.sName,searchable:r.bSearchable,orderable:r.bSortable,search:{value:o.sSearch,regex:o.bRegex}}),f("mDataProp_"+n,i),l.bFilter&&(f("sSearch_"+n,o.sSearch),f("bRegex_"+n,o.bRegex),f("bSearchable_"+n,r.bSearchable)),l.bSort&&f("bSortable_"+n,r.bSortable);return l.bFilter&&(f("sSearch",u.sSearch),f("bRegex",u.bRegex)),l.bSort&&(e.each(p,function(e,t){g.order.push({column:t.col,dir:t.dir}),f("iSortCol_"+e,t.col),f("sSortDir_"+e,t.dir)}),f("iSortingCols",p.length)),a=c.ext.legacy.ajax,null===a?t.sAjaxSource?h:g:a?h:g}function xb(e,t){var n=va(e,t),r=t.sEcho!==i?t.sEcho:t.draw,o=t.iTotalRecords!==i?t.iTotalRecords:t.recordsTotal,a=t.iTotalDisplayRecords!==i?t.iTotalDisplayRecords:t.recordsFiltered;if(r){if(1*r<e.iDraw)return;e.iDraw=1*r}for(pa(e),e._iRecordsTotal=parseInt(o,10),e._iRecordsDisplay=parseInt(a,10),r=0,o=n.length;r<o;r++)N(e,n[r]);e.aiDisplay=e.aiDisplayMaster.slice(),e.bAjaxDataGet=!1,O(e),e._bInitComplete||wa(e,t),e.bAjaxDataGet=!0,C(e,!1)}function va(t,n){var r=e.isPlainObject(t.ajax)&&t.ajax.dataSrc!==i?t.ajax.dataSrc:t.sAjaxDataProp;return"data"===r?n.aaData||n[r]:""!==r?R(r)(n):n}function rb(t){var i=t.oClasses,r=t.sTableId,o=t.oLanguage,a=t.oPreviousSearch,s=t.aanFeatures,l='<input type="search" class="'+i.sFilterInput+'"/>',c=o.sSearch,c=c.match(/_INPUT_/)?c.replace("_INPUT_",l):c+l,i=e("<div/>",{id:s.f?null:r+"_filter",class:i.sFilter}).append(e("<label/>").append(c)),s=function(){var e=this.value?this.value:"";e!=a.sSearch&&(ga(t,{sSearch:e,bRegex:a.bRegex,bSmart:a.bSmart,bCaseInsensitive:a.bCaseInsensitive}),t._iDisplayStart=0,O(t))},l=null!==t.searchDelay?t.searchDelay:"ssp"===y(t)?400:0,u=e("input",i).val(a.sSearch).attr("placeholder",o.sSearchPlaceholder).on("keyup.DT search.DT input.DT paste.DT cut.DT",l?j(s,l):s).on("keypress.DT",function(e){if(13==e.keyCode)return!1}).attr("aria-controls",r);return e(t.nTable).on("search.dt.DT",function(e,i){if(t===i)try{u[0]!==n.activeElement&&u.val(a.sSearch)}catch(e){}}),i[0]}function ga(e,t,n){var r=e.oPreviousSearch,o=e.aoPreSearchCols,a=function(e){r.sSearch=e.sSearch,r.bRegex=e.bRegex,r.bSmart=e.bSmart,r.bCaseInsensitive=e.bCaseInsensitive};if(Ia(e),"ssp"!=y(e)){for(yb(e,t.sSearch,n,t.bEscapeRegex!==i?!t.bEscapeRegex:t.bRegex,t.bSmart,t.bCaseInsensitive),a(t),t=0;t<o.length;t++)zb(e,o[t].sSearch,t,o[t].bEscapeRegex!==i?!o[t].bEscapeRegex:o[t].bRegex,o[t].bSmart,o[t].bCaseInsensitive);Ab(e)}else a(t);e.bFiltered=!0,s(e,null,"search",[e])}function Ab(t){for(var n,i,r=c.ext.search,o=t.aiDisplay,a=0,s=r.length;a<s;a++){for(var l=[],u=0,d=o.length;u<d;u++)i=o[u],n=t.aoData[i],r[a](t,n._aFilterData,i,n._aData,u)&&l.push(i);o.length=0,e.merge(o,l)}}function zb(e,t,n,i,r,o){if(""!==t){for(var a=[],s=e.aiDisplay,i=Ra(t,i,r,o),r=0;r<s.length;r++)t=e.aoData[s[r]]._aFilterData[n],i.test(t)&&a.push(s[r]);e.aiDisplay=a}}function yb(e,t,n,i,r,o){var a,i=Ra(t,i,r,o),o=e.oPreviousSearch.sSearch,s=e.aiDisplayMaster,r=[];if(0!==c.ext.search.length&&(n=!0),a=Bb(e),0>=t.length)e.aiDisplay=s.slice();else{for((a||n||o.length>t.length||0!==t.indexOf(o)||e.bSorted)&&(e.aiDisplay=s.slice()),t=e.aiDisplay,n=0;n<t.length;n++)i.test(e.aoData[t[n]]._sFilterRow)&&r.push(t[n]);e.aiDisplay=r}}function Ra(t,n,i,r){return t=n?t:V(t),i&&(t="^(?=.*?"+e.map(t.match(/"[^"]+"|[^ ]+/g)||[""],function(e){if('"'===e.charAt(0))var t=e.match(/^"(.*)"$/),e=t?t[1]:e;return e.replace('"',"")}).join(")(?=.*?")+").*$"),RegExp(t,r?"i":"")}function Bb(e){var t,n,i,r,o,a,s,l,u=e.aoColumns,d=c.ext.type.search;for(t=!1,n=0,r=e.aoData.length;n<r;n++)if(l=e.aoData[n],!l._aFilterData){for(a=[],i=0,o=u.length;i<o;i++)t=u[i],t.bSearchable?(s=B(e,n,i,"filter"),d[t.sType]&&(s=d[t.sType](s)),null===s&&(s=""),"string"!=typeof s&&s.toString&&(s=s.toString())):s="",s.indexOf&&-1!==s.indexOf("&")&&(U.innerHTML=s,s=G?U.textContent:U.innerText),s.replace&&(s=s.replace(/[\r\n]/g,"")),a.push(s);l._aFilterData=a,l._sFilterRow=a.join("  "),t=!0}return t}function Cb(e){return{search:e.sSearch,smart:e.bSmart,regex:e.bRegex,caseInsensitive:e.bCaseInsensitive}}function Db(e){return{sSearch:e.search,bSmart:e.smart,bRegex:e.regex,bCaseInsensitive:e.caseInsensitive}}function ub(t){var n=t.sTableId,i=t.aanFeatures.i,r=e("<div/>",{class:t.oClasses.sInfo,id:i?null:n+"_info"});return i||(t.aoDrawCallback.push({fn:Eb,sName:"information"}),r.attr("role","status").attr("aria-live","polite"),e(t.nTable).attr("aria-describedby",n+"_info")),r[0]}function Eb(t){var n=t.aanFeatures.i;if(0!==n.length){var i=t.oLanguage,r=t._iDisplayStart+1,o=t.fnDisplayEnd(),a=t.fnRecordsTotal(),s=t.fnRecordsDisplay(),l=s?i.sInfo:i.sInfoEmpty;s!==a&&(l+=" "+i.sInfoFiltered),l+=i.sInfoPostFix,l=Fb(t,l),i=i.fnInfoCallback,null!==i&&(l=i.call(t.oInstance,t,r,o,a,s,l)),e(n).html(l)}}function Fb(e,t){var n=e.fnFormatNumber,i=e._iDisplayStart+1,r=e._iDisplayLength,o=e.fnRecordsDisplay(),a=-1===r;return t.replace(/_START_/g,n.call(e,i)).replace(/_END_/g,n.call(e,e.fnDisplayEnd())).replace(/_MAX_/g,n.call(e,e.fnRecordsTotal())).replace(/_TOTAL_/g,n.call(e,o)).replace(/_PAGE_/g,n.call(e,a?1:Math.ceil(i/r))).replace(/_PAGES_/g,n.call(e,a?1:Math.ceil(o/r)))}function ha(e){var t,n,i,r=e.iInitDisplayStart,o=e.aoColumns;n=e.oFeatures;var a=e.bDeferLoading;if(e.bInitialised){for(pb(e),mb(e),fa(e,e.aoHeader),fa(e,e.aoFooter),C(e,!0),n.bAutoWidth&&Ha(e),t=0,n=o.length;t<n;t++)i=o[t],i.sWidth&&(i.nTh.style.width=v(i.sWidth));s(e,null,"preInit",[e]),T(e),o=y(e),("ssp"!=o||a)&&("ajax"==o?ua(e,[],function(n){var i=va(e,n);for(t=0;t<i.length;t++)N(e,i[t]);e.iInitDisplayStart=r,T(e),C(e,!1),wa(e,n)},e):(C(e,!1),wa(e)))}else setTimeout(function(){ha(e)},200)}function wa(e,t){e._bInitComplete=!0,(t||e.oInit.aaData)&&Z(e),s(e,null,"plugin-init",[e,t]),s(e,"aoInitComplete","init",[e,t])}function Ta(e,t){var n=parseInt(t,10);e._iDisplayLength=n,Ua(e),s(e,null,"length",[e,n])}function qb(t){for(var n=t.oClasses,i=t.sTableId,r=t.aLengthMenu,o=e.isArray(r[0]),a=o?r[0]:r,r=o?r[1]:r,o=e("<select/>",{name:i+"_length","aria-controls":i,class:n.sLengthSelect}),s=0,l=a.length;s<l;s++)o[0][s]=new Option(r[s],a[s]);var c=e("<div><label/></div>").addClass(n.sLength);return t.aanFeatures.l||(c[0].id=i+"_length"),c.children().append(t.oLanguage.sLengthMenu.replace("_MENU_",o[0].outerHTML)),e("select",c).val(t._iDisplayLength).on("change.DT",function(){Ta(t,e(this).val()),O(t)}),e(t.nTable).on("length.dt.DT",function(n,i,r){t===i&&e("select",c).val(r)}),c[0]}function vb(t){var n=t.sPaginationType,i=c.ext.pager[n],r="function"==typeof i,o=function(e){O(e)},n=e("<div/>").addClass(t.oClasses.sPaging+n)[0],a=t.aanFeatures;return r||i.fnInit(t,n,o),a.p||(n.id=t.sTableId+"_paginate",t.aoDrawCallback.push({fn:function(e){if(r){var t,n=e._iDisplayStart,s=e._iDisplayLength,l=e.fnRecordsDisplay(),c=-1===s,n=c?0:Math.ceil(n/s),s=c?1:Math.ceil(l/s),l=i(n,s),c=0;for(t=a.p.length;c<t;c++)Pa(e,"pageButton")(e,a.p[c],c,l,n,s)}else i.fnUpdate(e,o)},sName:"pagination"})),n}function Va(e,t,n){var i=e._iDisplayStart,r=e._iDisplayLength,o=e.fnRecordsDisplay();return 0===o||-1===r?i=0:"number"==typeof t?(i=t*r)>o&&(i=0):"first"==t?i=0:"previous"==t?0>(i=0<=r?i-r:0)&&(i=0):"next"==t?i+r<o&&(i+=r):"last"==t?i=Math.floor((o-1)/r)*r:K(e,0,"Unknown paging action: "+t,5),t=e._iDisplayStart!==i,e._iDisplayStart=i,t&&(s(e,null,"page",[e]),n&&O(e)),t}function sb(t){return e("<div/>",{id:t.aanFeatures.r?null:t.sTableId+"_processing",class:t.oClasses.sProcessing}).html(t.oLanguage.sProcessing).insertBefore(t.nTable)[0]}function C(t,n){t.oFeatures.bProcessing&&e(t.aanFeatures.r).css("display",n?"block":"none"),s(t,null,"processing",[t,n])}function tb(t){var n=e(t.nTable);n.attr("role","grid");var i=t.oScroll;if(""===i.sX&&""===i.sY)return t.nTable;var r=i.sX,o=i.sY,a=t.oClasses,s=n.children("caption"),l=s.length?s[0]._captionSide:null,c=e(n[0].cloneNode(!1)),u=e(n[0].cloneNode(!1)),d=n.children("tfoot");d.length||(d=null),c=e("<div/>",{class:a.sScrollWrapper}).append(e("<div/>",{class:a.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,width:r?r?v(r):null:"100%"}).append(e("<div/>",{class:a.sScrollHeadInner}).css({"box-sizing":"content-box",width:i.sXInner||"100%"}).append(c.removeAttr("id").css("margin-left",0).append("top"===l?s:null).append(n.children("thead"))))).append(e("<div/>",{class:a.sScrollBody}).css({position:"relative",overflow:"auto",width:r?v(r):null}).append(n)),d&&c.append(e("<div/>",{class:a.sScrollFoot}).css({overflow:"hidden",border:0,width:r?r?v(r):null:"100%"}).append(e("<div/>",{class:a.sScrollFootInner}).append(u.removeAttr("id").css("margin-left",0).append("bottom"===l?s:null).append(n.children("tfoot")))));var n=c.children(),h=n[0],a=n[1],p=d?n[2]:null;return r&&e(a).on("scroll.DT",function(){var e=this.scrollLeft;h.scrollLeft=e,d&&(p.scrollLeft=e)}),e(a).css(o&&i.bCollapse?"max-height":"height",o),t.nScrollHead=h,t.nScrollBody=a,t.nScrollFoot=p,t.aoDrawCallback.push({fn:ma,sName:"scrolling"}),c[0]}function ma(t){var n,r,o,a,s,l=t.oScroll,c=l.sX,u=l.sXInner,d=l.sY,l=l.iBarWidth,h=e(t.nScrollHead),p=h[0].style,f=h.children("div"),g=f[0].style,m=f.children("table"),f=t.nScrollBody,_=e(f),y=f.style,x=e(t.nScrollFoot).children("div"),b=x.children("table"),w=e(t.nTHead),C=e(t.nTable),S=C[0],T=S.style,M=t.nTFoot?e(t.nTFoot):null,E=t.oBrowser,D=E.bScrollOversize,k=A(t.aoColumns,"nTh"),L=[],N=[],P=[],O=[],R=function(e){e=e.style,e.paddingTop="0",e.paddingBottom="0",e.borderTopWidth="0",e.borderBottomWidth="0",e.height=0};r=f.scrollHeight>f.clientHeight,t.scrollBarVis!==r&&t.scrollBarVis!==i?(t.scrollBarVis=r,Z(t)):(t.scrollBarVis=r,C.children("thead, tfoot").remove(),M&&(o=M.clone().prependTo(C),n=M.find("tr"),o=o.find("tr")),a=w.clone().prependTo(C),w=w.find("tr"),r=a.find("tr"),a.find("th, td").removeAttr("tabindex"),c||(y.width="100%",h[0].style.width="100%"),e.each(ta(t,a),function(e,n){s=$(t,e),n.style.width=t.aoColumns[s].sWidth}),M&&I(function(e){e.style.width=""},o),h=C.outerWidth(),""===c?(T.width="100%",D&&(C.find("tbody").height()>f.offsetHeight||"scroll"==_.css("overflow-y"))&&(T.width=v(C.outerWidth()-l)),h=C.outerWidth()):""!==u&&(T.width=v(u),h=C.outerWidth()),I(R,r),I(function(t){P.push(t.innerHTML),L.push(v(e(t).css("width")))},r),I(function(t,n){-1!==e.inArray(t,k)&&(t.style.width=L[n])},w),e(r).height(0),M&&(I(R,o),I(function(t){O.push(t.innerHTML),N.push(v(e(t).css("width")))},o),I(function(e,t){e.style.width=N[t]},n),e(o).height(0)),I(function(e,t){e.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+P[t]+"</div>",e.style.width=L[t]},r),M&&I(function(e,t){e.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+O[t]+"</div>",e.style.width=N[t]},o),C.outerWidth()<h?(n=f.scrollHeight>f.offsetHeight||"scroll"==_.css("overflow-y")?h+l:h,D&&(f.scrollHeight>f.offsetHeight||"scroll"==_.css("overflow-y"))&&(T.width=v(n-l)),(""===c||""!==u)&&K(t,1,"Possible column misalignment",6)):n="100%",y.width=v(n),p.width=v(n),M&&(t.nScrollFoot.style.width=v(n)),!d&&D&&(y.height=v(S.offsetHeight+l)),c=C.outerWidth(),m[0].style.width=v(c),g.width=v(c),u=C.height()>f.clientHeight||"scroll"==_.css("overflow-y"),d="padding"+(E.bScrollbarLeft?"Left":"Right"),g[d]=u?l+"px":"0px",M&&(b[0].style.width=v(c),x[0].style.width=v(c),x[0].style[d]=u?l+"px":"0px"),C.children("colgroup").insertBefore(C.children("thead")),_.scroll(),!t.bSorted&&!t.bFiltered||t._drawHold||(f.scrollTop=0))}function I(e,t,n){for(var i,r,o=0,a=0,s=t.length;a<s;){for(i=t[a].firstChild,r=n?n[a].firstChild:null;i;)1===i.nodeType&&(n?e(i,r,o):e(i,o),o++),i=i.nextSibling,r=n?r.nextSibling:null;a++}}function Ha(n){var i,r,o=n.nTable,a=n.aoColumns,s=n.oScroll,l=s.sY,c=s.sX,u=s.sXInner,d=a.length,h=na(n,"bVisible"),p=e("th",n.nTHead),f=o.getAttribute("width"),g=o.parentNode,m=!1,_=n.oBrowser,s=_.bScrollOversize;for((i=o.style.width)&&-1!==i.indexOf("%")&&(f=i),i=0;i<h.length;i++)r=a[h[i]],null!==r.sWidth&&(r.sWidth=Gb(r.sWidthOrig,g),m=!0);if(s||!m&&!c&&!l&&d==ba(n)&&d==p.length)for(i=0;i<d;i++)null!==(h=$(n,i))&&(a[h].sWidth=v(p.eq(i).width()));else{d=e(o).clone().css("visibility","hidden").removeAttr("id"),d.find("tbody tr").remove();var y=e("<tr/>").appendTo(d.find("tbody"));for(d.find("thead, tfoot").remove(),d.append(e(n.nTHead).clone()).append(e(n.nTFoot).clone()),d.find("tfoot th, tfoot td").css("width",""),p=ta(n,d.find("thead")[0]),i=0;i<h.length;i++)r=a[h[i]],p[i].style.width=null!==r.sWidthOrig&&""!==r.sWidthOrig?v(r.sWidthOrig):"",r.sWidthOrig&&c&&e(p[i]).append(e("<div/>").css({width:r.sWidthOrig,margin:0,padding:0,border:0,height:1}));if(n.aoData.length)for(i=0;i<h.length;i++)m=h[i],r=a[m],e(Hb(n,m)).clone(!1).append(r.sContentPadding).appendTo(y);for(e("[name]",d).removeAttr("name"),r=e("<div/>").css(c||l?{position:"absolute",top:0,left:0,height:1,right:0,overflow:"hidden"}:{}).append(d).appendTo(g),c&&u?d.width(u):c?(d.css("width","auto"),d.removeAttr("width"),d.width()<g.clientWidth&&f&&d.width(g.clientWidth)):l?d.width(g.clientWidth):f&&d.width(f),i=l=0;i<h.length;i++)g=e(p[i]),u=g.outerWidth()-g.width(),g=_.bBounding?Math.ceil(p[i].getBoundingClientRect().width):g.outerWidth(),l+=g,a[h[i]].sWidth=v(g-u);o.style.width=v(l),r.remove()}f&&(o.style.width=v(f)),!f&&!c||n._reszEvt||(o=function(){e(t).on("resize.DT-"+n.sInstance,j(function(){Z(n)}))},s?setTimeout(o,1e3):o(),n._reszEvt=!0)}function Gb(t,i){if(!t)return 0;var r=e("<div/>").css("width",v(t)).appendTo(i||n.body),o=r[0].offsetWidth;return r.remove(),o}function Hb(t,n){var i=Ib(t,n);if(0>i)return null;var r=t.aoData[i];return r.nTr?r.anCells[n]:e("<td/>").html(B(t,i,n,"display"))[0]}function Ib(e,t){for(var n,i=-1,r=-1,o=0,a=e.aoData.length;o<a;o++)n=B(e,o,t,"display")+"",n=n.replace(q,""),n=n.replace(/&nbsp;/g," "),n.length>i&&(i=n.length,r=o);return r}function v(e){return null===e?"0px":"number"==typeof e?0>e?"0px":e+"px":e.match(/\d$/)?e+"px":e}function W(t){var n,r,o,a,s,l,u=[],d=t.aoColumns;n=t.aaSortingFixed,r=e.isPlainObject(n);var h=[];for(o=function(t){t.length&&!e.isArray(t[0])?h.push(t):e.merge(h,t)},e.isArray(n)&&o(n),r&&n.pre&&o(n.pre),o(t.aaSorting),r&&n.post&&o(n.post),t=0;t<h.length;t++)for(l=h[t][0],o=d[l].aDataSort,n=0,r=o.length;n<r;n++)a=o[n],s=d[a].sType||"string",h[t]._idx===i&&(h[t]._idx=e.inArray(h[t][1],d[a].asSorting)),u.push({src:l,col:a,dir:h[t][1],index:h[t]._idx,type:s,formatter:c.ext.type.order[s+"-pre"]});return u}function ob(e){var t,n,i,r,o=[],a=c.ext.type.order,s=e.aoData,l=0,u=e.aiDisplayMaster;for(Ia(e),r=W(e),t=0,n=r.length;t<n;t++)i=r[t],i.formatter&&l++,Jb(e,i.col);if("ssp"!=y(e)&&0!==r.length){for(t=0,n=u.length;t<n;t++)o[u[t]]=t;l===r.length?u.sort(function(e,t){var n,i,a,l,c=r.length,u=s[e]._aSortData,d=s[t]._aSortData;for(a=0;a<c;a++)if(l=r[a],n=u[l.col],i=d[l.col],0!==(n=n<i?-1:n>i?1:0))return"asc"===l.dir?n:-n;return n=o[e],i=o[t],n<i?-1:n>i?1:0}):u.sort(function(e,t){var n,i,l,c,u=r.length,d=s[e]._aSortData,h=s[t]._aSortData;for(l=0;l<u;l++)if(c=r[l],n=d[c.col],i=h[c.col],c=a[c.type+"-"+c.dir]||a["string-"+c.dir],0!==(n=c(n,i)))return n;return n=o[e],i=o[t],n<i?-1:n>i?1:0})}e.bSorted=!0}function Kb(e){for(var t,n,i=e.aoColumns,r=W(e),e=e.oLanguage.oAria,o=0,a=i.length;o<a;o++){n=i[o];var s=n.asSorting;t=n.sTitle.replace(/<.*?>/g,"");var l=n.nTh;l.removeAttribute("aria-sort"),n.bSortable&&(0<r.length&&r[0].col==o?(l.setAttribute("aria-sort","asc"==r[0].dir?"ascending":"descending"),n=s[r[0].index+1]||s[0]):n=s[0],t+="asc"===n?e.sSortAscending:e.sSortDescending),l.setAttribute("aria-label",t)}}function Xa(t,n,r,o){var a=t.aaSorting,s=t.aoColumns[n].asSorting,l=function(t,n){var r=t._idx;return r===i&&(r=e.inArray(t[1],s)),r+1<s.length?r+1:n?null:0};"number"==typeof a[0]&&(a=t.aaSorting=[a]),r&&t.oFeatures.bSortMulti?(r=e.inArray(n,A(a,"0")),-1!==r?(n=l(a[r],!0),null===n&&1===a.length&&(n=0),null===n?a.splice(r,1):(a[r][1]=s[n],a[r]._idx=n)):(a.push([n,s[0],0]),a[a.length-1]._idx=0)):a.length&&a[0][0]==n?(n=l(a[0]),a.length=1,a[0][1]=s[n],a[0]._idx=n):(a.length=0,a.push([n,s[0]]),a[0]._idx=0),T(t),"function"==typeof o&&o(t)}function Oa(e,t,n,i){var r=e.aoColumns[n];Ya(t,{},function(t){!1!==r.bSortable&&(e.oFeatures.bProcessing?(C(e,!0),setTimeout(function(){Xa(e,n,t.shiftKey,i),"ssp"!==y(e)&&C(e,!1)},0)):Xa(e,n,t.shiftKey,i))})}function ya(t){var n,i,r=t.aLastSort,o=t.oClasses.sSortColumn,a=W(t),s=t.oFeatures;if(s.bSort&&s.bSortClasses){for(s=0,n=r.length;s<n;s++)i=r[s].src,e(A(t.aoData,"anCells",i)).removeClass(o+(2>s?s+1:3));for(s=0,n=a.length;s<n;s++)i=a[s].src,e(A(t.aoData,"anCells",i)).addClass(o+(2>s?s+1:3))}t.aLastSort=a}function Jb(e,t){var n,i=e.aoColumns[t],r=c.ext.order[i.sSortDataType];r&&(n=r.call(e.oInstance,e,t,aa(e,t)));for(var o,a=c.ext.type.order[i.sType+"-pre"],s=0,l=e.aoData.length;s<l;s++)i=e.aoData[s],i._aSortData||(i._aSortData=[]),(!i._aSortData[t]||r)&&(o=r?n[s]:B(e,s,t,"sort"),i._aSortData[t]=a?a(o):o)}function za(t){if(t.oFeatures.bStateSave&&!t.bDestroying){var n={time:+new Date,start:t._iDisplayStart,length:t._iDisplayLength,order:e.extend(!0,[],t.aaSorting),search:Cb(t.oPreviousSearch),columns:e.map(t.aoColumns,function(e,n){return{visible:e.bVisible,search:Cb(t.aoPreSearchCols[n])}})};s(t,"aoStateSaveParams","stateSaveParams",[t,n]),t.oSavedState=n,t.fnStateSaveCallback.call(t.oInstance,t,n)}}function Lb(t,n,r){var o,a,l=t.aoColumns,n=function(n){if(n&&n.time){var u=s(t,"aoStateLoadParams","stateLoadParams",[t,c]);if(-1===e.inArray(!1,u)&&!(0<(u=t.iStateDuration)&&n.time<+new Date-1e3*u||n.columns&&l.length!==n.columns.length)){if(t.oLoadedState=e.extend(!0,{},c),n.start!==i&&(t._iDisplayStart=n.start,t.iInitDisplayStart=n.start),n.length!==i&&(t._iDisplayLength=n.length),n.order!==i&&(t.aaSorting=[],e.each(n.order,function(e,n){t.aaSorting.push(n[0]>=l.length?[0,n[1]]:n)})),n.search!==i&&e.extend(t.oPreviousSearch,Db(n.search)),n.columns)for(o=0,a=n.columns.length;o<a;o++)u=n.columns[o],u.visible!==i&&(l[o].bVisible=u.visible),u.search!==i&&e.extend(t.aoPreSearchCols[o],Db(u.search));s(t,"aoStateLoaded","stateLoaded",[t,c])}}r()};if(t.oFeatures.bStateSave){var c=t.fnStateLoadCallback.call(t.oInstance,t,n);c!==i&&n(c)}else r()}function Aa(t){var n=c.settings,t=e.inArray(t,A(n,"nTable"));return-1!==t?n[t]:null}function K(e,n,i,r){if(i="DataTables warning: "+(e?"table id="+e.sTableId+" - ":"")+i,r&&(i+=". For more information about this error, please see http://datatables.net/tn/"+r),n)t.console&&console.log;else if(n=c.ext,n=n.sErrMode||n.errMode,e&&s(e,null,"error",[e,r,i]),"alert"==n)alert(i);else{if("throw"==n)throw Error(i);"function"==typeof n&&n(e,r,i)}}function F(t,n,r,o){e.isArray(r)?e.each(r,function(i,r){e.isArray(r)?F(t,n,r[0],r[1]):F(t,n,r)}):(o===i&&(o=r),n[r]!==i&&(t[o]=n[r]))}function Mb(t,n,i){var r,o;for(o in n)n.hasOwnProperty(o)&&(r=n[o],e.isPlainObject(r)?(e.isPlainObject(t[o])||(t[o]={}),e.extend(!0,t[o],r)):t[o]=i&&"data"!==o&&"aaData"!==o&&e.isArray(r)?r.slice():r);return t}function Ya(t,n,i){e(t).on("click.DT",n,function(e){t.blur(),i(e)}).on("keypress.DT",n,function(e){13===e.which&&(e.preventDefault(),i(e))}).on("selectstart.DT",function(){return!1})}function z(e,t,n,i){n&&e[t].push({fn:n,sName:i})}function s(t,n,i,r){var o=[];return n&&(o=e.map(t[n].slice().reverse(),function(e){return e.fn.apply(t.oInstance,r)})),null!==i&&(n=e.Event(i+".dt"),e(t.nTable).trigger(n,r),o.push(n.result)),o}function Ua(e){var t=e._iDisplayStart,n=e.fnDisplayEnd(),i=e._iDisplayLength;t>=n&&(t=n-i),t-=t%i,(-1===i||0>t)&&(t=0),e._iDisplayStart=t}function Pa(t,n){var i=t.renderer,r=c.ext.renderer[n];return e.isPlainObject(i)&&i[n]?r[i[n]]||r._:"string"==typeof i?r[i]||r._:r._}function y(e){return e.oFeatures.bServerSide?"ssp":e.ajax||e.sAjaxSource?"ajax":"dom"}function ia(e,t){var n=[],n=fe.numbers_length,i=Math.floor(n/2);return t<=n?n=E(0,t):e<=i?(n=E(0,n-2),n.push("ellipsis"),n.push(t-1)):(e>=t-1-i?n=E(t-(n-2),t):(n=E(e-i+2,e+i-1),n.push("ellipsis"),n.push(t-1)),n.splice(0,0,"ellipsis"),n.splice(0,0,0)),n.DT_el="span",n}function fb(t){e.each({num:function(e){return ge(e,t)},"num-fmt":function(e){return ge(e,t,g)},"html-num":function(e){return ge(e,t,h)},"html-num-fmt":function(e){return ge(e,t,h,g)}},function(e,n){r.type.order[e+t+"-pre"]=n,e.match(/^html\-/)&&(r.type.search[e+t]=r.type.search.html)})}function Ob(e){return function(){var t=[Aa(this[c.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return c.ext.internal[e].apply(this,t)}}var r,o,a,l,c=function(t){this.$=function(e,t){return this.api(!0).$(e,t)},this._=function(e,t){return this.api(!0).rows(e,t).data()},this.api=function(e){return new o(e?Aa(this[r.iApiIndex]):this)},this.fnAddData=function(t,n){var r=this.api(!0),o=e.isArray(t)&&(e.isArray(t[0])||e.isPlainObject(t[0]))?r.rows.add(t):r.row.add(t);return(n===i||n)&&r.draw(),o.flatten().toArray()},this.fnAdjustColumnSizing=function(e){var t=this.api(!0).columns.adjust(),n=t.settings()[0],r=n.oScroll;e===i||e?t.draw(!1):(""!==r.sX||""!==r.sY)&&ma(n)},this.fnClearTable=function(e){var t=this.api(!0).clear();(e===i||e)&&t.draw()},this.fnClose=function(e){this.api(!0).row(e).child.hide()},this.fnDeleteRow=function(e,t,n){var r=this.api(!0),e=r.rows(e),o=e.settings()[0],a=o.aoData[e[0][0]];return e.remove(),t&&t.call(this,o,a),(n===i||n)&&r.draw(),a},this.fnDestroy=function(e){this.api(!0).destroy(e)},this.fnDraw=function(e){this.api(!0).draw(e)},this.fnFilter=function(e,t,n,r,o,a){o=this.api(!0),null===t||t===i?o.search(e,n,r,a):o.column(t).search(e,n,r,a),o.draw()},this.fnGetData=function(e,t){var n=this.api(!0);if(e!==i){var r=e.nodeName?e.nodeName.toLowerCase():"";return t!==i||"td"==r||"th"==r?n.cell(e,t).data():n.row(e).data()||null}return n.data().toArray()},this.fnGetNodes=function(e){var t=this.api(!0);return e!==i?t.row(e).node():t.rows().nodes().flatten().toArray()},this.fnGetPosition=function(e){var t=this.api(!0),n=e.nodeName.toUpperCase();return"TR"==n?t.row(e).index():"TD"==n||"TH"==n?(e=t.cell(e).index(),[e.row,e.columnVisible,e.column]):null},this.fnIsOpen=function(e){return this.api(!0).row(e).child.isShown()},this.fnOpen=function(e,t,n){return this.api(!0).row(e).child(t,n).show().child()[0]},this.fnPageChange=function(e,t){var n=this.api(!0).page(e);(t===i||t)&&n.draw(!1)},this.fnSetColumnVis=function(e,t,n){e=this.api(!0).column(e).visible(t),(n===i||n)&&e.columns.adjust().draw()},this.fnSettings=function(){return Aa(this[r.iApiIndex])},this.fnSort=function(e){this.api(!0).order(e).draw()},this.fnSortListener=function(e,t,n){this.api(!0).order.listener(e,t,n)},this.fnUpdate=function(e,t,n,r,o){var a=this.api(!0);return n===i||null===n?a.row(t).data(e):a.cell(t,n).data(e),(o===i||o)&&a.columns.adjust(),(r===i||r)&&a.draw(),0},this.fnVersionCheck=r.fnVersionCheck;var n=this,a=t===i,l=this.length;a&&(t={}),this.oApi=this.internal=r.internal;for(var u in c.ext.internal)u&&(this[u]=Ob(u));return this.each(function(){var r,o={},u=1<l?Mb(o,t,!0):t,d=0,o=this.getAttribute("id"),h=!1,p=c.defaults,f=e(this);if("table"!=this.nodeName.toLowerCase())K(null,0,"Non-table node initialisation ("+this.nodeName+")",2);else{gb(p),hb(p.column),J(p,p,!0),J(p.column,p.column,!0),J(p,e.extend(u,f.data()));var g=c.settings,d=0;for(r=g.length;d<r;d++){var m=g[d];if(m.nTable==this||m.nTHead.parentNode==this||m.nTFoot&&m.nTFoot.parentNode==this){var v=u.bRetrieve!==i?u.bRetrieve:p.bRetrieve;if(a||v)return m.oInstance;if(u.bDestroy!==i?u.bDestroy:p.bDestroy){m.oInstance.fnDestroy();break}return void K(m,0,"Cannot reinitialise DataTable",3)}if(m.sTableId==this.id){g.splice(d,1);break}}null!==o&&""!==o||(this.id=o="DataTables_Table_"+c.ext._unique++);var _=e.extend(!0,{},c.models.oSettings,{sDestroyWidth:f[0].style.width,sInstance:o,sTableId:o});_.nTable=this,_.oApi=n.internal,_.oInit=u,g.push(_),_.oInstance=1===n.length?n:f.dataTable(),gb(u),u.oLanguage&&Fa(u.oLanguage),u.aLengthMenu&&!u.iDisplayLength&&(u.iDisplayLength=e.isArray(u.aLengthMenu[0])?u.aLengthMenu[0][0]:u.aLengthMenu[0]),u=Mb(e.extend(!0,{},p),u),F(_.oFeatures,u,"bPaginate bLengthChange bFilter bSort bSortMulti bInfo bProcessing bAutoWidth bSortClasses bServerSide bDeferRender".split(" ")),F(_,u,["asStripeClasses","ajax","fnServerData","fnFormatNumber","sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer","searchDelay","rowId",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"],["bJQueryUI","bJUI"]]),F(_.oScroll,u,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]),F(_.oLanguage,u,"fnInfoCallback"),z(_,"aoDrawCallback",u.fnDrawCallback,"user"),z(_,"aoServerParams",u.fnServerParams,"user"),z(_,"aoStateSaveParams",u.fnStateSaveParams,"user"),z(_,"aoStateLoadParams",u.fnStateLoadParams,"user"),z(_,"aoStateLoaded",u.fnStateLoaded,"user"),z(_,"aoRowCallback",u.fnRowCallback,"user"),z(_,"aoRowCreatedCallback",u.fnCreatedRow,"user"),z(_,"aoHeaderCallback",u.fnHeaderCallback,"user"),z(_,"aoFooterCallback",u.fnFooterCallback,"user"),z(_,"aoInitComplete",u.fnInitComplete,"user"),z(_,"aoPreDrawCallback",u.fnPreDrawCallback,"user"),_.rowIdFn=R(u.rowId),ib(_);var x=_.oClasses;u.bJQueryUI?(e.extend(x,c.ext.oJUIClasses,u.oClasses),u.sDom===p.sDom&&"lfrtip"===p.sDom&&(_.sDom='<"H"lfr>t<"F"ip>'),_.renderer?e.isPlainObject(_.renderer)&&!_.renderer.header&&(_.renderer.header="jqueryui"):_.renderer="jqueryui"):e.extend(x,c.ext.classes,u.oClasses),f.addClass(x.sTable),_.iInitDisplayStart===i&&(_.iInitDisplayStart=u.iDisplayStart,_._iDisplayStart=u.iDisplayStart),null!==u.iDeferLoading&&(_.bDeferLoading=!0,o=e.isArray(u.iDeferLoading),_._iRecordsDisplay=o?u.iDeferLoading[0]:u.iDeferLoading,_._iRecordsTotal=o?u.iDeferLoading[1]:u.iDeferLoading);var b=_.oLanguage;e.extend(!0,b,u.oLanguage),b.sUrl&&(e.ajax({dataType:"json",url:b.sUrl,success:function(t){Fa(t),J(p.oLanguage,t),e.extend(!0,b,t),ha(_)},error:function(){ha(_)}}),h=!0),null===u.asStripeClasses&&(_.asStripeClasses=[x.sStripeOdd,x.sStripeEven]);var o=_.asStripeClasses,w=f.children("tbody").find("tr").eq(0);if(-1!==e.inArray(!0,e.map(o,function(e){return w.hasClass(e)}))&&(e("tbody tr",this).removeClass(o.join(" ")),_.asDestroyStripes=o.slice()),o=[],g=this.getElementsByTagName("thead"),0!==g.length&&(ea(_.aoHeader,g[0]),o=ta(_)),null===u.aoColumns)for(g=[],d=0,r=o.length;d<r;d++)g.push(null);else g=u.aoColumns;for(d=0,r=g.length;d<r;d++)Ga(_,o?o[d]:null);if(kb(_,u.aoColumnDefs,g,function(e,t){la(_,e,t)}),w.length){var C=function(e,t){return null!==e.getAttribute("data-"+t)?t:null};e(w[0]).children("th, td").each(function(e,t){var n=_.aoColumns[e];if(n.mData===e){var r=C(t,"sort")||C(t,"order"),o=C(t,"filter")||C(t,"search");null===r&&null===o||(n.mData={_:e+".display",sort:null!==r?e+".@data-"+r:i,type:null!==r?e+".@data-"+r:i,filter:null!==o?e+".@data-"+o:i},la(_,e))}})}var S=_.oFeatures,o=function(){if(u.aaSorting===i){var t=_.aaSorting;for(d=0,r=t.length;d<r;d++)t[d][1]=_.aoColumns[d].asSorting[0]}ya(_),S.bSort&&z(_,"aoDrawCallback",function(){if(_.bSorted){var t=W(_),n={};e.each(t,function(e,t){n[t.src]=t.dir}),s(_,null,"order",[_,t,n]),Kb(_)}}),z(_,"aoDrawCallback",function(){(_.bSorted||"ssp"===y(_)||S.bDeferRender)&&ya(_)},"sc");var t=f.children("caption").each(function(){this._captionSide=e(this).css("caption-side")}),n=f.children("thead");if(0===n.length&&(n=e("<thead/>").appendTo(f)),_.nTHead=n[0],n=f.children("tbody"),0===n.length&&(n=e("<tbody/>").appendTo(f)),_.nTBody=n[0],n=f.children("tfoot"),0===n.length&&t.length>0&&(""!==_.oScroll.sX||""!==_.oScroll.sY)&&(n=e("<tfoot/>").appendTo(f)),0===n.length||0===n.children().length?f.addClass(x.sNoFooter):n.length>0&&(_.nTFoot=n[0],ea(_.aoFooter,_.nTFoot)),u.aaData)for(d=0;d<u.aaData.length;d++)N(_,u.aaData[d]);else(_.bDeferLoading||"dom"==y(_))&&oa(_,e(_.nTBody).children("tr"));_.aiDisplay=_.aiDisplayMaster.slice(),_.bInitialised=!0,!1===h&&ha(_)};u.bStateSave?(S.bStateSave=!0,z(_,"aoDrawCallback",za,"state_save"),Lb(_,u,o)):o()}}),n=null,this},u={},d=/[\r\n]/g,h=/<.*?>/g,p=/^\d{2,4}[\.\/\-]\d{1,2}[\.\/\-]\d{1,2}([T ]{1}\d{1,2}[:\.]\d{2}([\.:]\d{2})?)?$/,f=RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\|\\$|\\^|\\-)","g"),g=/[',$£€¥%\u2009\u202F\u20BD\u20a9\u20BArfk]/gi,m=function(e){return!e||!0===e||"-"===e},_=function(e){var t=parseInt(e,10);return!isNaN(t)&&isFinite(e)?t:null},x=function(e,t){return u[t]||(u[t]=RegExp(V(t),"g")),"string"==typeof e&&"."!==t?e.replace(/\./g,"").replace(u[t],"."):e},b=function(e,t,n){var i="string"==typeof e;return!!m(e)||(t&&i&&(e=x(e,t)),n&&i&&(e=e.replace(g,"")),!isNaN(parseFloat(e))&&isFinite(e))},w=function(e,t,n){return!!m(e)||(m(e)||"string"==typeof e?!!b(e.replace(h,""),t,n)||null:null)},A=function(e,t,n){var r=[],o=0,a=e.length;if(n!==i)for(;o<a;o++)e[o]&&e[o][t]&&r.push(e[o][t][n]);else for(;o<a;o++)e[o]&&r.push(e[o][t]);return r},M=function(e,t,n,r){var o=[],a=0,s=t.length;if(r!==i)for(;a<s;a++)e[t[a]][n]&&o.push(e[t[a]][n][r]);else for(;a<s;a++)o.push(e[t[a]][n]);return o},E=function(e,t){var n,r=[];t===i?(t=0,n=e):(n=t,t=e);for(var o=t;o<n;o++)r.push(o);return r},D=function(e){for(var t=[],n=0,i=e.length;n<i;n++)e[n]&&t.push(e[n]);return t},k=function(e){var t,n,i,r=[],o=e.length,a=0;n=0;e:for(;n<o;n++){for(t=e[n],i=0;i<a;i++)if(r[i]===t)continue e;r.push(t),a++}return r};c.util={throttle:function(e,t){var n,r,o=t!==i?t:200;return function(){var t=this,a=+new Date,s=arguments;n&&a<n+o?(clearTimeout(r),r=setTimeout(function(){n=i,e.apply(t,s)},o)):(n=a,e.apply(t,s))}},escapeRegex:function(e){return e.replace(f,"\\$1")}};var L=function(e,t,n){e[t]!==i&&(e[n]=e[t])},P=/\[.*?\]$/,H=/\(\)$/,V=c.util.escapeRegex,U=e("<div>")[0],G=U.textContent!==i,q=/<.*?>/g,j=c.util.throttle,X=[],Q=Array.prototype,ee=function(t){var n,i,r=c.settings,o=e.map(r,function(e){return e.nTable});return t?t.nTable&&t.oApi?[t]:t.nodeName&&"table"===t.nodeName.toLowerCase()?(n=e.inArray(t,o),-1!==n?[r[n]]:null):t&&"function"==typeof t.settings?t.settings().toArray():("string"==typeof t?i=e(t):t instanceof e&&(i=t),i?i.map(function(){return n=e.inArray(this,o),-1!==n?r[n]:null}).toArray():void 0):[]};o=function(t,n){if(!(this instanceof o))return new o(t,n);var i=[],r=function(e){(e=ee(e))&&(i=i.concat(e))};if(e.isArray(t))for(var a=0,s=t.length;a<s;a++)r(t[a]);else r(t);this.context=k(i),n&&e.merge(this,n),this.selector={rows:null,cols:null,opts:null},o.extend(this,this,X)},c.Api=o,e.extend(o.prototype,{any:function(){return 0!==this.count()},concat:Q.concat,context:[],count:function(){return this.flatten().length},each:function(e){for(var t=0,n=this.length;t<n;t++)e.call(this,this[t],t,this);return this},eq:function(e){var t=this.context;return t.length>e?new o(t[e],this[e]):null},filter:function(e){var t=[];if(Q.filter)t=Q.filter.call(this,e,this);else for(var n=0,i=this.length;n<i;n++)e.call(this,this[n],n,this)&&t.push(this[n]);return new o(this.context,t)},flatten:function(){var e=[];return new o(this.context,e.concat.apply(e,this.toArray()))},join:Q.join,indexOf:Q.indexOf||function(e,t){for(var n=t||0,i=this.length;n<i;n++)if(this[n]===e)return n;return-1},iterator:function(e,t,n,r){var a,s,l,c,u,d,h,p=[],f=this.context,g=this.selector;for("string"==typeof e&&(r=n,n=t,t=e,e=!1),s=0,l=f.length;s<l;s++){var m=new o(f[s]);if("table"===t)(a=n.call(m,f[s],s))!==i&&p.push(a);else if("columns"===t||"rows"===t)(a=n.call(m,f[s],this[s],s))!==i&&p.push(a);else if("column"===t||"column-rows"===t||"row"===t||"cell"===t)for(h=this[s],"column-rows"===t&&(d=oe(f[s],g.opts)),c=0,u=h.length;c<u;c++)a=h[c],(a="cell"===t?n.call(m,f[s],a.row,a.column,s,c):n.call(m,f[s],a,s,c,d))!==i&&p.push(a)}return p.length||r?(e=new o(f,e?p.concat.apply([],p):p),t=e.selector,t.rows=g.rows,t.cols=g.cols,t.opts=g.opts,e):this},lastIndexOf:Q.lastIndexOf||function(e,t){return this.indexOf.apply(this.toArray.reverse(),arguments)},length:0,map:function(e){var t=[];if(Q.map)t=Q.map.call(this,e,this);else for(var n=0,i=this.length;n<i;n++)t.push(e.call(this,this[n],n));return new o(this.context,t)},pluck:function(e){return this.map(function(t){return t[e]})},pop:Q.pop,push:Q.push,reduce:Q.reduce||function(e,t){return jb(this,e,t,0,this.length,1)},reduceRight:Q.reduceRight||function(e,t){return jb(this,e,t,this.length-1,-1,-1)},reverse:Q.reverse,selector:null,shift:Q.shift,sort:Q.sort,splice:Q.splice,toArray:function(){return Q.slice.call(this)},to$:function(){return e(this)},toJQuery:function(){return e(this)},unique:function(){return new o(this.context,k(this))},unshift:Q.unshift}),o.extend=function(t,n,i){if(i.length&&n&&(n instanceof o||n.__dt_wrapper)){var r,a,s;for(r=0,a=i.length;r<a;r++)s=i[r],n[s.name]="function"==typeof s.val?function(e,t,n){return function(){var i=t.apply(e,arguments);return o.extend(i,i,n.methodExt),i}}(t,s.val,s):e.isPlainObject(s.val)?{}:s.val,n[s.name].__dt_wrapper=!0,o.extend(t,n[s.name],s.propExt)}},o.register=a=function(t,n){if(e.isArray(t))for(var i=0,r=t.length;i<r;i++)o.register(t[i],n);else for(var a,s,l=t.split("."),c=X,i=0,r=l.length;i<r;i++){a=(s=-1!==l[i].indexOf("()"))?l[i].replace("()",""):l[i];var u;e:{u=0;for(var d=c.length;u<d;u++)if(c[u].name===a){u=c[u];break e}u=null}u||(u={name:a,val:{},methodExt:[],propExt:[]},c.push(u)),i===r-1?u.val=n:c=s?u.methodExt:u.propExt}},o.registerPlural=l=function(t,n,r){o.register(t,r),o.register(n,function(){var t=r.apply(this,arguments);return t===this?this:t instanceof o?t.length?e.isArray(t[0])?new o(t.context,t[0]):t[0]:i:t})},a("tables()",function(t){var n;if(t){n=o;var i=this.context;if("number"==typeof t)t=[i[t]];else var r=e.map(i,function(e){return e.nTable}),t=e(r).filter(t).map(function(){var t=e.inArray(this,r);return i[t]}).toArray();n=new n(t)}else n=this;return n}),a("table()",function(e){var e=this.tables(e),t=e.context;return t.length?new o(t[0]):e}),l("tables().nodes()","table().node()",function(){return this.iterator("table",function(e){return e.nTable},1)}),l("tables().body()","table().body()",function(){return this.iterator("table",function(e){return e.nTBody},1)}),l("tables().header()","table().header()",function(){return this.iterator("table",function(e){return e.nTHead},1)}),l("tables().footer()","table().footer()",function(){return this.iterator("table",function(e){return e.nTFoot},1)}),l("tables().containers()","table().container()",function(){return this.iterator("table",function(e){return e.nTableWrapper},1)}),a("draw()",function(e){return this.iterator("table",function(t){"page"===e?O(t):("string"==typeof e&&(e="full-hold"!==e),T(t,!1===e))})}),a("page()",function(e){return e===i?this.page.info().page:this.iterator("table",function(t){Va(t,e)})}),a("page.info()",function(){if(0===this.context.length)return i;var e=this.context[0],t=e._iDisplayStart,n=e.oFeatures.bPaginate?e._iDisplayLength:-1,r=e.fnRecordsDisplay(),o=-1===n;return{page:o?0:Math.floor(t/n),pages:o?1:Math.ceil(r/n),start:t,end:e.fnDisplayEnd(),length:n,recordsTotal:e.fnRecordsTotal(),recordsDisplay:r,serverSide:"ssp"===y(e)}}),a("page.len()",function(e){return e===i?0!==this.context.length?this.context[0]._iDisplayLength:i:this.iterator("table",function(t){Ta(t,e)})});var te=function(e,t,n){if(n){var i=new o(e);i.one("draw",function(){n(i.ajax.json())})}if("ssp"==y(e))T(e,t);else{C(e,!0);var r=e.jqXHR;r&&4!==r.readyState&&r.abort(),ua(e,[],function(n){pa(e);for(var n=va(e,n),i=0,r=n.length;i<r;i++)N(e,n[i]);T(e,t),C(e,!1)})}};a("ajax.json()",function(){var e=this.context;if(0<e.length)return e[0].json}),a("ajax.params()",function(){var e=this.context;if(0<e.length)return e[0].oAjaxData}),a("ajax.reload()",function(e,t){return this.iterator("table",function(n){te(n,!1===t,e)})}),a("ajax.url()",function(t){var n=this.context;return t===i?0===n.length?i:(n=n[0],n.ajax?e.isPlainObject(n.ajax)?n.ajax.url:n.ajax:n.sAjaxSource):this.iterator("table",function(n){e.isPlainObject(n.ajax)?n.ajax.url=t:n.ajax=t})}),a("ajax.url().load()",function(e,t){return this.iterator("table",function(n){te(n,!1===t,e)})});var ne=function(t,n,o,a,s){var l,c,u,d,h,p,f=[];for(u=typeof n,n&&"string"!==u&&"function"!==u&&n.length!==i||(n=[n]),u=0,d=n.length;u<d;u++)for(c=n[u]&&n[u].split&&!n[u].match(/[\[\(:]/)?n[u].split(","):[n[u]],h=0,p=c.length;h<p;h++)(l=o("string"==typeof c[h]?e.trim(c[h]):c[h]))&&l.length&&(f=f.concat(l));if(t=r.selector[t],t.length)for(u=0,d=t.length;u<d;u++)f=t[u](a,s,f);return k(f)},ie=function(t){return t||(t={}),t.filter&&t.search===i&&(t.search=t.filter),e.extend({search:"none",order:"current",page:"all"},t)},re=function(e){for(var t=0,n=e.length;t<n;t++)if(0<e[t].length)return e[0]=e[t],e[0].length=1,e.length=1,e.context=[e.context[t]],e;return e.length=0,e},oe=function(t,n){var i,r,o,a=[],s=t.aiDisplay;i=t.aiDisplayMaster;var l=n.search;if(r=n.order,o=n.page,"ssp"==y(t))return"removed"===l?[]:E(0,i.length);if("current"==o)for(i=t._iDisplayStart,r=t.fnDisplayEnd();i<r;i++)a.push(s[i]);else if("current"==r||"applied"==r)a="none"==l?i.slice():"applied"==l?s.slice():e.map(i,function(t){return-1===e.inArray(t,s)?t:null});else if("index"==r||"original"==r)for(i=0,r=t.aoData.length;i<r;i++)"none"==l?a.push(i):(-1===(o=e.inArray(i,s))&&"removed"==l||0<=o&&"applied"==l)&&a.push(i);return a};a("rows()",function(t,n){t===i?t="":e.isPlainObject(t)&&(n=t,t="");var n=ie(n),r=this.iterator("table",function(r){var o,a=n;return ne("row",t,function(t){var n=_(t);if(null!==n&&!a)return[n];if(o||(o=oe(r,a)),null!==n&&-1!==e.inArray(n,o))return[n];if(null===t||t===i||""===t)return o;if("function"==typeof t)return e.map(o,function(e){var n=r.aoData[e];return t(e,n._aData,n.nTr)?e:null});if(n=D(M(r.aoData,o,"nTr")),t.nodeName)return t._DT_RowIndex!==i?[t._DT_RowIndex]:t._DT_CellIndex?[t._DT_CellIndex.row]:(n=e(t).closest("*[data-dt-row]"),n.length?[n.data("dt-row")]:[]);if("string"==typeof t&&"#"===t.charAt(0)){var s=r.aIds[t.replace(/^#/,"")];if(s!==i)return[s.idx]}return e(n).filter(t).map(function(){return this._DT_RowIndex}).toArray()},r,a)},1);return r.selector.rows=t,r.selector.opts=n,r}),a("rows().nodes()",function(){return this.iterator("row",function(e,t){return e.aoData[t].nTr||i},1)}),a("rows().data()",function(){return this.iterator(!0,"rows",function(e,t){return M(e.aoData,t,"_aData")},1)}),l("rows().cache()","row().cache()",function(e){return this.iterator("row",function(t,n){var i=t.aoData[n];return"search"===e?i._aFilterData:i._aSortData},1)}),l("rows().invalidate()","row().invalidate()",function(e){return this.iterator("row",function(t,n){da(t,n,e)})}),l("rows().indexes()","row().index()",function(){return this.iterator("row",function(e,t){return t},1)}),l("rows().ids()","row().id()",function(e){for(var t=[],n=this.context,i=0,r=n.length;i<r;i++)for(var a=0,s=this[i].length;a<s;a++){var l=n[i].rowIdFn(n[i].aoData[this[i][a]]._aData);t.push((!0===e?"#":"")+l)}return new o(n,t)}),l("rows().remove()","row().remove()",function(){var e=this;return this.iterator("row",function(t,n,r){var o,a,s,l,c,u=t.aoData,d=u[n];for(u.splice(n,1),o=0,a=u.length;o<a;o++)if(s=u[o],c=s.anCells,null!==s.nTr&&(s.nTr._DT_RowIndex=o),null!==c)for(s=0,l=c.length;s<l;s++)c[s]._DT_CellIndex.row=o;qa(t.aiDisplayMaster,n),qa(t.aiDisplay,n),qa(e[r],n,!1),Ua(t),(n=t.rowIdFn(d._aData))!==i&&delete t.aIds[n]}),this.iterator("table",function(e){for(var t=0,n=e.aoData.length;t<n;t++)e.aoData[t].idx=t}),this}),a("rows.add()",function(t){var n=this.iterator("table",function(e){var n,i,r,o=[];for(i=0,r=t.length;i<r;i++)n=t[i],n.nodeName&&"TR"===n.nodeName.toUpperCase()?o.push(oa(e,n)[0]):o.push(N(e,n));return o},1),i=this.rows(-1);return i.pop(),e.merge(i,n),i}),a("row()",function(e,t){return re(this.rows(e,t))}),a("row().data()",function(e){var t=this.context;return e===i?t.length&&this.length?t[0].aoData[this[0]]._aData:i:(t[0].aoData[this[0]]._aData=e,da(t[0],this[0],"data"),this)}),a("row().node()",function(){var e=this.context;return e.length&&this.length?e[0].aoData[this[0]].nTr||null:null}),a("row.add()",function(t){t instanceof e&&t.length&&(t=t[0]);var n=this.iterator("table",function(e){return t.nodeName&&"TR"===t.nodeName.toUpperCase()?oa(e,t)[0]:N(e,t)});return this.row(n[0])});var ae=function(e,t){var n=e.context;n.length&&(n=n[0].aoData[t!==i?t:e[0]])&&n._details&&(n._details.remove(),n._detailsShow=i,n._details=i)},se=function(e,t){var n=e.context;if(n.length&&e.length){var i=n[0].aoData[e[0]];if(i._details){(i._detailsShow=t)?i._details.insertAfter(i.nTr):i._details.detach();var r=n[0],a=new o(r),s=r.aoData;a.off("draw.dt.DT_details column-visibility.dt.DT_details destroy.dt.DT_details"),0<A(s,"_details").length&&(a.on("draw.dt.DT_details",function(e,t){r===t&&a.rows({page:"current"}).eq(0).each(function(e){e=s[e],e._detailsShow&&e._details.insertAfter(e.nTr)})}),a.on("column-visibility.dt.DT_details",function(e,t){if(r===t)for(var n,i=ba(t),o=0,a=s.length;o<a;o++)n=s[o],n._details&&n._details.children("td[colspan]").attr("colspan",i)}),a.on("destroy.dt.DT_details",function(e,t){if(r===t)for(var n=0,i=s.length;n<i;n++)s[n]._details&&ae(a,n)}))}}};a("row().child()",function(t,n){var r=this.context;if(t===i)return r.length&&this.length?r[0].aoData[this[0]]._details:i;if(!0===t)this.child.show();else if(!1===t)ae(this);else if(r.length&&this.length){var o=r[0],r=r[0].aoData[this[0]],a=[],s=function(t,n){if(e.isArray(t)||t instanceof e)for(var i=0,r=t.length;i<r;i++)s(t[i],n);else t.nodeName&&"tr"===t.nodeName.toLowerCase()?a.push(t):(i=e("<tr><td/></tr>").addClass(n),e("td",i).addClass(n).html(t)[0].colSpan=ba(o),a.push(i[0]))};s(t,n),r._details&&r._details.detach(),r._details=e(a),r._detailsShow&&r._details.insertAfter(r.nTr)}return this}),a(["row().child.show()","row().child().show()"],function(){return se(this,!0),this}),a(["row().child.hide()","row().child().hide()"],function(){return se(this,!1),this}),a(["row().child.remove()","row().child().remove()"],function(){return ae(this),this}),a("row().child.isShown()",function(){var e=this.context;return!(!e.length||!this.length)&&(e[0].aoData[this[0]]._detailsShow||!1)});var le=/^([^:]+):(name|visIdx|visible)$/,ce=function(e,t,n,i,r){for(var n=[],i=0,o=r.length;i<o;i++)n.push(B(e,r[i],t));return n};a("columns()",function(t,n){t===i?t="":e.isPlainObject(t)&&(n=t,t="");var n=ie(n),r=this.iterator("table",function(i){var r=t,o=n,a=i.aoColumns,s=A(a,"sName"),l=A(a,"nTh");return ne("column",r,function(t){var n=_(t);if(""===t)return E(a.length);if(null!==n)return[n>=0?n:a.length+n];if("function"==typeof t){var r=oe(i,o);return e.map(a,function(e,n){return t(n,ce(i,n,0,0,r),l[n])?n:null})}var c="string"==typeof t?t.match(le):"";if(c)switch(c[2]){case"visIdx":case"visible":if((n=parseInt(c[1],10))<0){var u=e.map(a,function(e,t){return e.bVisible?t:null});return[u[u.length+n]]}return[$(i,n)];case"name":return e.map(s,function(e,t){return e===c[1]?t:null});default:return[]}return t.nodeName&&t._DT_CellIndex?[t._DT_CellIndex.column]:(n=e(l).filter(t).map(function(){return e.inArray(this,l)}).toArray(),n.length||!t.nodeName?n:(n=e(t).closest("*[data-dt-column]"),n.length?[n.data("dt-column")]:[]))},i,o)},1);return r.selector.cols=t,r.selector.opts=n,r}),l("columns().header()","column().header()",function(){return this.iterator("column",function(e,t){return e.aoColumns[t].nTh},1)}),l("columns().footer()","column().footer()",function(){return this.iterator("column",function(e,t){return e.aoColumns[t].nTf},1)}),l("columns().data()","column().data()",function(){return this.iterator("column-rows",ce,1)}),l("columns().dataSrc()","column().dataSrc()",function(){return this.iterator("column",function(e,t){return e.aoColumns[t].mData},1)}),l("columns().cache()","column().cache()",function(e){return this.iterator("column-rows",function(t,n,i,r,o){return M(t.aoData,o,"search"===e?"_aFilterData":"_aSortData",n)},1)}),l("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(e,t,n,i,r){return M(e.aoData,r,"anCells",t)},1)}),l("columns().visible()","column().visible()",function(t,n){var r=this.iterator("column",function(n,r){if(t===i)return n.aoColumns[r].bVisible;var o,a,s,l=n.aoColumns,c=l[r],u=n.aoData;if(t!==i&&c.bVisible!==t){if(t){var d=e.inArray(!0,A(l,"bVisible"),r+1);for(o=0,a=u.length;o<a;o++)s=u[o].nTr,l=u[o].anCells,s&&s.insertBefore(l[r],l[d]||null)}else e(A(n.aoData,"anCells",r)).detach();c.bVisible=t,fa(n,n.aoHeader),fa(n,n.aoFooter),za(n)}});return t!==i&&(this.iterator("column",function(e,i){s(e,null,"column-visibility",[e,i,t,n])}),(n===i||n)&&this.columns.adjust()),r}),l("columns().indexes()","column().index()",function(e){return this.iterator("column",function(t,n){return"visible"===e?aa(t,n):n},1)}),a("columns.adjust()",function(){return this.iterator("table",function(e){Z(e)},1)}),a("column.index()",function(e,t){if(0!==this.context.length){var n=this.context[0];if("fromVisible"===e||"toData"===e)return $(n,t);if("fromData"===e||"toVisible"===e)return aa(n,t)}}),a("column()",function(e,t){return re(this.columns(e,t))}),a("cells()",function(t,n,r){if(e.isPlainObject(t)&&(t.row===i?(r=t,t=null):(r=n,n=null)),e.isPlainObject(n)&&(r=n,n=null),null===n||n===i)return this.iterator("table",function(n){var o,a,s,l,c,u,d,h=t,p=ie(r),f=n.aoData,g=oe(n,p),m=D(M(f,g,"anCells")),v=e([].concat.apply([],m)),_=n.aoColumns.length;return ne("cell",h,function(t){var r="function"==typeof t;if(null===t||t===i||r){for(a=[],s=0,l=g.length;s<l;s++)for(o=g[s],c=0;c<_;c++)u={row:o,column:c},r?(d=f[o],t(u,B(n,o,c),d.anCells?d.anCells[c]:null)&&a.push(u)):a.push(u);return a}return e.isPlainObject(t)?[t]:(r=v.filter(t).map(function(e,t){return{row:t._DT_CellIndex.row,column:t._DT_CellIndex.column}}).toArray(),r.length||!t.nodeName?r:(d=e(t).closest("*[data-dt-row]"),d.length?[{row:d.data("dt-row"),column:d.data("dt-column")}]:[]))},n,p)});var o,a,s,l,c,u=this.columns(n,r),d=this.rows(t,r),h=this.iterator("table",function(e,t){for(o=[],a=0,s=d[t].length;a<s;a++)for(l=0,c=u[t].length;l<c;l++)o.push({row:d[t][a],column:u[t][l]});return o},1);return e.extend(h.selector,{cols:n,rows:t,opts:r}),h}),l("cells().nodes()","cell().node()",function(){return this.iterator("cell",function(e,t,n){return(e=e.aoData[t])&&e.anCells?e.anCells[n]:i},1)}),a("cells().data()",function(){return this.iterator("cell",function(e,t,n){return B(e,t,n)},1)}),l("cells().cache()","cell().cache()",function(e){return e="search"===e?"_aFilterData":"_aSortData",this.iterator("cell",function(t,n,i){return t.aoData[n][e][i]},1)}),l("cells().render()","cell().render()",function(e){return this.iterator("cell",function(t,n,i){return B(t,n,i,e)},1)}),l("cells().indexes()","cell().index()",function(){return this.iterator("cell",function(e,t,n){return{row:t,column:n,columnVisible:aa(e,n)}},1)}),l("cells().invalidate()","cell().invalidate()",function(e){return this.iterator("cell",function(t,n,i){da(t,n,e,i)})}),a("cell()",function(e,t,n){return re(this.cells(e,t,n))}),a("cell().data()",function(e){var t=this.context,n=this[0];return e===i?t.length&&n.length?B(t[0],n[0].row,n[0].column):i:(lb(t[0],n[0].row,n[0].column,e),da(t[0],n[0].row,"data",n[0].column),this)}),a("order()",function(t,n){var r=this.context;return t===i?0!==r.length?r[0].aaSorting:i:("number"==typeof t?t=[[t,n]]:t.length&&!e.isArray(t[0])&&(t=Array.prototype.slice.call(arguments)),this.iterator("table",function(e){e.aaSorting=t.slice()}))}),a("order.listener()",function(e,t,n){return this.iterator("table",function(i){Oa(i,e,t,n)})}),a("order.fixed()",function(t){if(!t){var n=this.context,n=n.length?n[0].aaSortingFixed:i;return e.isArray(n)?{pre:n}:n}return this.iterator("table",function(n){n.aaSortingFixed=e.extend(!0,{},t)})}),a(["columns().order()","column().order()"],function(t){var n=this;return this.iterator("table",function(i,r){var o=[];e.each(n[r],function(e,n){o.push([n,t])}),i.aaSorting=o})}),a("search()",function(t,n,r,o){var a=this.context;return t===i?0!==a.length?a[0].oPreviousSearch.sSearch:i:this.iterator("table",function(i){i.oFeatures.bFilter&&ga(i,e.extend({},i.oPreviousSearch,{sSearch:t+"",bRegex:null!==n&&n,bSmart:null===r||r,bCaseInsensitive:null===o||o}),1)})}),l("columns().search()","column().search()",function(t,n,r,o){return this.iterator("column",function(a,s){var l=a.aoPreSearchCols;if(t===i)return l[s].sSearch;a.oFeatures.bFilter&&(e.extend(l[s],{sSearch:t+"",bRegex:null!==n&&n,bSmart:null===r||r,bCaseInsensitive:null===o||o}),ga(a,a.oPreviousSearch,1))})}),a("state()",function(){return this.context.length?this.context[0].oSavedState:null}),a("state.clear()",function(){return this.iterator("table",function(e){e.fnStateSaveCallback.call(e.oInstance,e,{})})}),a("state.loaded()",function(){return this.context.length?this.context[0].oLoadedState:null}),a("state.save()",function(){return this.iterator("table",function(e){za(e)})}),c.versionCheck=c.fnVersionCheck=function(e){for(var t,n,i=c.version.split("."),e=e.split("."),r=0,o=e.length;r<o;r++)if(t=parseInt(i[r],10)||0,n=parseInt(e[r],10)||0,t!==n)return t>n;return!0},c.isDataTable=c.fnIsDataTable=function(t){var n=e(t).get(0),i=!1;return t instanceof c.Api||(e.each(c.settings,function(t,r){var o=r.nScrollHead?e("table",r.nScrollHead)[0]:null,a=r.nScrollFoot?e("table",r.nScrollFoot)[0]:null;r.nTable!==n&&o!==n&&a!==n||(i=!0)}),i)},c.tables=c.fnTables=function(t){var n=!1;e.isPlainObject(t)&&(n=t.api,t=t.visible);var i=e.map(c.settings,function(n){if(!t||t&&e(n.nTable).is(":visible"))return n.nTable});return n?new o(i):i},c.camelToHungarian=J,a("$()",function(t,n){var i=this.rows(n).nodes(),i=e(i);return e([].concat(i.filter(t).toArray(),i.find(t).toArray()))}),e.each(["on","one","off"],function(t,n){a(n+"()",function(){var t=Array.prototype.slice.call(arguments);t[0]=e.map(t[0].split(/\s/),function(e){return e.match(/\.dt\b/)?e:e+".dt"}).join(" ");var i=e(this.tables().nodes());return i[n].apply(i,t),this})}),a("clear()",function(){return this.iterator("table",function(e){pa(e)})}),a("settings()",function(){return new o(this.context,this.context)}),a("init()",function(){var e=this.context;return e.length?e[0].oInit:null}),a("data()",function(){return this.iterator("table",function(e){return A(e.aoData,"_aData")}).flatten()}),a("destroy()",function(n){return n=n||!1,this.iterator("table",function(i){var r,a=i.nTableWrapper.parentNode,l=i.oClasses,u=i.nTable,d=i.nTBody,h=i.nTHead,p=i.nTFoot,f=e(u),d=e(d),g=e(i.nTableWrapper),m=e.map(i.aoData,function(e){return e.nTr});i.bDestroying=!0,s(i,"aoDestroyCallback","destroy",[i]),n||new o(i).columns().visible(!0),g.off(".DT").find(":not(tbody *)").off(".DT"),e(t).off(".DT-"+i.sInstance),u!=h.parentNode&&(f.children("thead").detach(),f.append(h)),p&&u!=p.parentNode&&(f.children("tfoot").detach(),f.append(p)),i.aaSorting=[],i.aaSortingFixed=[],ya(i),e(m).removeClass(i.asStripeClasses.join(" ")),e("th, td",h).removeClass(l.sSortable+" "+l.sSortableAsc+" "+l.sSortableDesc+" "+l.sSortableNone),i.bJUI&&(e("th span."+l.sSortIcon+", td span."+l.sSortIcon,h).detach(),e("th, td",h).each(function(){var t=e("div."+l.sSortJUIWrapper,this);e(this).append(t.contents()),t.detach()})),d.children().detach(),d.append(m),h=n?"remove":"detach",f[h](),g[h](),!n&&a&&(a.insertBefore(u,i.nTableReinsertBefore),f.css("width",i.sDestroyWidth).removeClass(l.sTable),(r=i.asDestroyStripes.length)&&d.children().each(function(t){e(this).addClass(i.asDestroyStripes[t%r])})),-1!==(a=e.inArray(i,c.settings))&&c.settings.splice(a,1)})}),e.each(["column","row","cell"],function(e,t){a(t+"s().every()",function(e){var n=this.selector.opts,r=this;return this.iterator(t,function(o,a,s,l,c){e.call(r[t](a,"cell"===t?s:n,"cell"===t?n:i),a,s,l,c)})})}),a("i18n()",function(t,n,r){var o=this.context[0],t=R(t)(o.oLanguage);return t===i&&(t=n),r!==i&&e.isPlainObject(t)&&(t=t[r]!==i?t[r]:t._),t.replace("%d",r)}),c.version="1.10.13",c.settings=[],c.models={},c.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0},c.models.oRow={nTr:null,anCells:null,_aData:[],_aSortData:null,_aFilterData:null,_sFilterRow:null,_sRowStripe:"",src:null,idx:-1},c.models.oColumn={idx:null,aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bVisible:null,_sManualType:null,_bAttrSrc:!1,fnCreatedCell:null,fnGetData:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null},c.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:[],ajax:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bJQueryUI:!1,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollCollapse:!1,bServerSide:!1,bSort:!0,bSortMulti:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:null,fnServerParams:null,fnStateLoadCallback:function(e){try{return JSON.parse((-1===e.iStateDuration?sessionStorage:localStorage).getItem("DataTables_"+e.sInstance+"_"+location.pathname))}catch(e){}},fnStateLoadParams:null,fnStateLoaded:null,fnStateSaveCallback:function(e,t){try{(-1===e.iStateDuration?sessionStorage:localStorage).setItem("DataTables_"+e.sInstance+"_"+location.pathname,JSON.stringify(t))}catch(e){}},fnStateSaveParams:null,iStateDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iTabIndex:0,oClasses:{},oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sDecimal:"",sThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sSearchPlaceholder:"",sUrl:"",sZeroRecords:"No matching records found"},oSearch:e.extend({},c.models.oSearch),sAjaxDataProp:"data",sAjaxSource:null,sDom:"lfrtip",searchDelay:null,sPaginationType:"simple_numbers",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET",renderer:null,rowId:"DT_RowId"},Y(c.defaults),c.defaults.column={aDataSort:null,iDataSort:-1,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bVisible:!0,fnCreatedCell:null,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null},Y(c.defaults.column),c.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortMulti:null,bSortClasses:null,bStateSave:null},oScroll:{bCollapse:null,iBarWidth:0,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1,bScrollbarLeft:!1,bBounding:!1,barWidth:0},ajax:null,aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aIds:{},aoColumns:[],aoHeader:[],aoFooter:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:[],asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,searchDelay:null,sPaginationType:"two_button",iStateDuration:0,aoStateSave:[],aoStateLoad:[],oSavedState:null,oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,json:i,oAjaxData:i,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return"ssp"==y(this)?1*this._iRecordsTotal:this.aiDisplayMaster.length},fnRecordsDisplay:function(){return"ssp"==y(this)?1*this._iRecordsDisplay:this.aiDisplay.length},fnDisplayEnd:function(){var e=this._iDisplayLength,t=this._iDisplayStart,n=t+e,i=this.aiDisplay.length,r=this.oFeatures,o=r.bPaginate;return r.bServerSide?!1===o||-1===e?t+i:Math.min(t+e,this._iRecordsDisplay):!o||n>i||-1===e?i:n},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null,aLastSort:[],oPlugins:{},rowIdFn:null,rowId:null},c.ext=r={buttons:{},classes:{},builder:"-source-",errMode:"alert",feature:[],search:[],selector:{cell:[],column:[],row:[]},internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},header:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:c.fnVersionCheck,iApiIndex:0,oJUIClasses:{},sVersion:c.version},e.extend(r,{afnFiltering:r.search,aTypes:r.type.detect,ofnSearch:r.type.search,oSort:r.type.order,afnSortData:r.order,aoFeatures:r.feature,oApi:r.internal,oStdClasses:r.classes,oPagination:r.pager}),e.extend(c.ext.classes,{sTable:"dataTable",sNoFooter:"no-footer",sPageButton:"paginate_button",sPageButtonActive:"current",sPageButtonDisabled:"disabled",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sFilterInput:"",sLengthSelect:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sHeaderTH:"",sFooterTH:"",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sJUIHeader:"",sJUIFooter:""});var ue="",ue="",de=ue+"ui-state-default",he=ue+"css_right ui-icon ui-icon-",pe=ue+"fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix";e.extend(c.ext.oJUIClasses,c.ext.classes,{sPageButton:"fg-button ui-button "+de,sPageButtonActive:"ui-state-disabled",sPageButtonDisabled:"ui-state-disabled",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sSortAsc:de+" sorting_asc",sSortDesc:de+" sorting_desc",sSortable:de+" sorting",sSortableAsc:de+" sorting_asc_disabled",sSortableDesc:de+" sorting_desc_disabled",sSortableNone:de+" sorting_disabled",sSortJUIAsc:he+"triangle-1-n",sSortJUIDesc:he+"triangle-1-s",sSortJUI:he+"carat-2-n-s",sSortJUIAscAllowed:he+"carat-1-n",sSortJUIDescAllowed:he+"carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sSortIcon:"DataTables_sort_icon",sScrollHead:"dataTables_scrollHead "+de,sScrollFoot:"dataTables_scrollFoot "+de,sHeaderTH:de,sFooterTH:de,sJUIHeader:pe+" ui-corner-tl ui-corner-tr",sJUIFooter:pe+" ui-corner-bl ui-corner-br"});var fe=c.ext.pager;e.extend(fe,{simple:function(){return["previous","next"]},full:function(){return["first","previous","next","last"]},numbers:function(e,t){return[ia(e,t)]},simple_numbers:function(e,t){return["previous",ia(e,t),"next"]},full_numbers:function(e,t){return["first","previous",ia(e,t),"next","last"]},first_last_numbers:function(e,t){return["first",ia(e,t),"last"]},_numbers:ia,numbers_length:7}),e.extend(!0,c.ext.renderer,{pageButton:{_:function(t,r,o,a,s,l){var c,u,d,h=t.oClasses,p=t.oLanguage.oPaginate,f=t.oLanguage.oAria.paginate||{},g=0,m=function(n,i){var r,a,d,v,_=function(e){Va(t,e.data.action,!0)};for(r=0,a=i.length;r<a;r++)if(v=i[r],e.isArray(v))d=e("<"+(v.DT_el||"div")+"/>").appendTo(n),m(d,v);else{switch(c=null,u="",v){case"ellipsis":n.append('<span class="ellipsis">&#x2026;</span>');break;case"first":c=p.sFirst,u=v+(s>0?"":" "+h.sPageButtonDisabled);break;case"previous":c=p.sPrevious,u=v+(s>0?"":" "+h.sPageButtonDisabled);break;case"next":c=p.sNext,u=v+(s<l-1?"":" "+h.sPageButtonDisabled);break;case"last":c=p.sLast,u=v+(s<l-1?"":" "+h.sPageButtonDisabled);break;default:c=v+1,u=s===v?h.sPageButtonActive:""}null!==c&&(d=e("<a>",{class:h.sPageButton+" "+u,"aria-controls":t.sTableId,"aria-label":f[v],"data-dt-idx":g,tabindex:t.iTabIndex,id:0===o&&"string"==typeof v?t.sTableId+"_"+v:null}).html(c).appendTo(n),Ya(d,{action:v},_),g++)}};try{d=e(r).find(n.activeElement).data("dt-idx")}catch(e){}m(e(r).empty(),a),d!==i&&e(r).find("[data-dt-idx="+d+"]").focus()}}}),e.extend(c.ext.type.detect,[function(e,t){var n=t.oLanguage.sDecimal;return b(e,n)?"num"+n:null},function(e){if(e&&!(e instanceof Date)&&!p.test(e))return null;var t=Date.parse(e);return null!==t&&!isNaN(t)||m(e)?"date":null},function(e,t){var n=t.oLanguage.sDecimal;return b(e,n,!0)?"num-fmt"+n:null},function(e,t){var n=t.oLanguage.sDecimal;return w(e,n)?"html-num"+n:null},function(e,t){var n=t.oLanguage.sDecimal;return w(e,n,!0)?"html-num-fmt"+n:null},function(e){return m(e)||"string"==typeof e&&-1!==e.indexOf("<")?"html":null}]),e.extend(c.ext.type.search,{html:function(e){return m(e)?e:"string"==typeof e?e.replace(d," ").replace(h,""):""},string:function(e){return m(e)?e:"string"==typeof e?e.replace(d," "):e}});var ge=function(e,t,n,i){return 0===e||e&&"-"!==e?(t&&(e=x(e,t)),e.replace&&(n&&(e=e.replace(n,"")),i&&(e=e.replace(i,""))),1*e):-1/0};e.extend(r.type.order,{"date-pre":function(e){return Date.parse(e)||-1/0},"html-pre":function(e){return m(e)?"":e.replace?e.replace(/<.*?>/g,"").toLowerCase():e+""},"string-pre":function(e){return m(e)?"":"string"==typeof e?e.toLowerCase():e.toString?e.toString():""},"string-asc":function(e,t){return e<t?-1:e>t?1:0},"string-desc":function(e,t){return e<t?1:e>t?-1:0}}),fb(""),e.extend(!0,c.ext.renderer,{header:{_:function(t,n,i,r){e(t.nTable).on("order.dt.DT",function(e,o,a,s){t===o&&(e=i.idx,n.removeClass(i.sSortingClass+" "+r.sSortAsc+" "+r.sSortDesc).addClass("asc"==s[e]?r.sSortAsc:"desc"==s[e]?r.sSortDesc:i.sSortingClass))})},jqueryui:function(t,n,i,r){e("<div/>").addClass(r.sSortJUIWrapper).append(n.contents()).append(e("<span/>").addClass(r.sSortIcon+" "+i.sSortingClassJUI)).appendTo(n),e(t.nTable).on("order.dt.DT",function(e,o,a,s){t===o&&(e=i.idx,n.removeClass(r.sSortAsc+" "+r.sSortDesc).addClass("asc"==s[e]?r.sSortAsc:"desc"==s[e]?r.sSortDesc:i.sSortingClass),n.find("span."+r.sSortIcon).removeClass(r.sSortJUIAsc+" "+r.sSortJUIDesc+" "+r.sSortJUI+" "+r.sSortJUIAscAllowed+" "+r.sSortJUIDescAllowed).addClass("asc"==s[e]?r.sSortJUIAsc:"desc"==s[e]?r.sSortJUIDesc:i.sSortingClassJUI))})}}});var me=function(e){return"string"==typeof e?e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):e};return c.render={number:function(e,t,n,i,r){return{display:function(o){if("number"!=typeof o&&"string"!=typeof o)return o;var a=0>o?"-":"",s=parseFloat(o);return isNaN(s)?me(o):(s=s.toFixed(n),o=Math.abs(s),s=parseInt(o,10),o=n?t+(o-s).toFixed(n).substring(2):"",a+(i||"")+s.toString().replace(/\B(?=(\d{3})+(?!\d))/g,e)+o+(r||""))}}},text:function(){return{display:me}}},e.extend(c.ext.internal,{_fnExternApiFunc:Ob,_fnBuildAjax:ua,_fnAjaxUpdate:nb,_fnAjaxParameters:wb,_fnAjaxUpdateDraw:xb,_fnAjaxDataSrc:va,_fnAddColumn:Ga,_fnColumnOptions:la,_fnAdjustColumnSizing:Z,_fnVisibleToColumnIndex:$,_fnColumnIndexToVisible:aa,_fnVisbleColumns:ba,_fnGetColumns:na,_fnColumnTypes:Ia,_fnApplyColumnDefs:kb,_fnHungarianMap:Y,_fnCamelToHungarian:J,_fnLanguageCompat:Fa,_fnBrowserDetect:ib,_fnAddData:N,_fnAddTr:oa,_fnNodeToDataIndex:function(e,t){return t._DT_RowIndex!==i?t._DT_RowIndex:null},_fnNodeToColumnIndex:function(t,n,i){return e.inArray(i,t.aoData[n].anCells)},_fnGetCellData:B,_fnSetCellData:lb,_fnSplitObjNotation:La,_fnGetObjectDataFn:R,_fnSetObjectDataFn:S,_fnGetDataMaster:Ma,_fnClearTable:pa,_fnDeleteIndex:qa,_fnInvalidate:da,_fnGetRowElements:Ka,_fnCreateTr:Ja,_fnBuildHead:mb,_fnDrawHead:fa,_fnDraw:O,_fnReDraw:T,_fnAddOptionsHtml:pb,_fnDetectHeader:ea,_fnGetUniqueThs:ta,_fnFeatureHtmlFilter:rb,_fnFilterComplete:ga,_fnFilterCustom:Ab,_fnFilterColumn:zb,_fnFilter:yb,_fnFilterCreateSearch:Ra,_fnEscapeRegex:V,_fnFilterData:Bb,_fnFeatureHtmlInfo:ub,_fnUpdateInfo:Eb,_fnInfoMacros:Fb,_fnInitialise:ha,_fnInitComplete:wa,_fnLengthChange:Ta,_fnFeatureHtmlLength:qb,_fnFeatureHtmlPaginate:vb,_fnPageChange:Va,_fnFeatureHtmlProcessing:sb,_fnProcessingDisplay:C,_fnFeatureHtmlTable:tb,_fnScrollDraw:ma,_fnApplyToChildren:I,_fnCalculateColumnWidths:Ha,_fnThrottle:j,_fnConvertToWidth:Gb,_fnGetWidestNode:Hb,_fnGetMaxLenString:Ib,_fnStringToCss:v,_fnSortFlatten:W,_fnSort:ob,_fnSortAria:Kb,_fnSortListener:Xa,_fnSortAttachListener:Oa,_fnSortingClasses:ya,_fnSortData:Jb,_fnSaveState:za,_fnLoadState:Lb,_fnSettingsFromNode:Aa,_fnLog:K,_fnMap:F,_fnBindAction:Ya,_fnCallbackReg:z,_fnCallbackFire:s,_fnLengthOverflow:Ua,_fnRenderer:Pa,_fnDataSource:y,_fnRowAttributes:Na,_fnCalculateEnd:function(){}}),e.fn.dataTable=c,c.$=e,e.fn.dataTableSettings=c.settings,e.fn.dataTableExt=c.ext,e.fn.DataTable=function(t){return e(this).dataTable(t).api()},e.each(c,function(t,n){e.fn.DataTable[t]=n}),e.fn.dataTable})},function(e,t,n){!function(t,i){e.exports=i(n(14))}(0,function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=97)}([function(t,n){t.exports=e},function(e,t,n){!function(e){"use strict";var n={};n.exports=t,function(e){if(!t)var t=1e-6;if(!n)var n="undefined"!=typeof Float32Array?Float32Array:Array;if(!i)var i=Math.random;var r={};r.setMatrixArrayType=function(e){n=e},void 0!==e&&(e.glMatrix=r);var o=Math.PI/180;r.toRadian=function(e){return e*o};var a={};a.create=function(){var e=new n(2);return e[0]=0,e[1]=0,e},a.clone=function(e){var t=new n(2);return t[0]=e[0],t[1]=e[1],t},a.fromValues=function(e,t){var i=new n(2);return i[0]=e,i[1]=t,i},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},a.set=function(e,t,n){return e[0]=t,e[1]=n,e},a.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e},a.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e},a.sub=a.subtract,a.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e},a.mul=a.multiply,a.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e},a.div=a.divide,a.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e},a.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e},a.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e},a.scaleAndAdd=function(e,t,n,i){return e[0]=t[0]+n[0]*i,e[1]=t[1]+n[1]*i,e},a.distance=function(e,t){var n=t[0]-e[0],i=t[1]-e[1];return Math.sqrt(n*n+i*i)},a.dist=a.distance,a.squaredDistance=function(e,t){var n=t[0]-e[0],i=t[1]-e[1];return n*n+i*i},a.sqrDist=a.squaredDistance,a.length=function(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)},a.len=a.length,a.squaredLength=function(e){var t=e[0],n=e[1];return t*t+n*n},a.sqrLen=a.squaredLength,a.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},a.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},a.normalize=function(e,t){var n=t[0],i=t[1],r=n*n+i*i;return r>0&&(r=1/Math.sqrt(r),e[0]=t[0]*r,e[1]=t[1]*r),e},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},a.cross=function(e,t,n){var i=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=i,e},a.lerp=function(e,t,n,i){var r=t[0],o=t[1];return e[0]=r+i*(n[0]-r),e[1]=o+i*(n[1]-o),e},a.random=function(e,t){t=t||1;var n=2*i()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e},a.transformMat2=function(e,t,n){var i=t[0],r=t[1];return e[0]=n[0]*i+n[2]*r,e[1]=n[1]*i+n[3]*r,e},a.transformMat2d=function(e,t,n){var i=t[0],r=t[1];return e[0]=n[0]*i+n[2]*r+n[4],e[1]=n[1]*i+n[3]*r+n[5],e},a.transformMat3=function(e,t,n){var i=t[0],r=t[1];return e[0]=n[0]*i+n[3]*r+n[6],e[1]=n[1]*i+n[4]*r+n[7],e},a.transformMat4=function(e,t,n){var i=t[0],r=t[1];return e[0]=n[0]*i+n[4]*r+n[12],e[1]=n[1]*i+n[5]*r+n[13],e},a.forEach=function(){var e=a.create();return function(t,n,i,r,o,a){var s,l;for(n||(n=2),i||(i=0),l=r?Math.min(r*n+i,t.length):t.length,s=i;s<l;s+=n)e[0]=t[s],e[1]=t[s+1],o(e,e,a),t[s]=e[0],t[s+1]=e[1];return t}}(),a.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},void 0!==e&&(e.vec2=a);var s={};s.create=function(){var e=new n(3);return e[0]=0,e[1]=0,e[2]=0,e},s.clone=function(e){var t=new n(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},s.fromValues=function(e,t,i){var r=new n(3);return r[0]=e,r[1]=t,r[2]=i,r},s.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},s.set=function(e,t,n,i){return e[0]=t,e[1]=n,e[2]=i,e},s.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e},s.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e},s.sub=s.subtract,s.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e},s.mul=s.multiply,s.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e},s.div=s.divide,s.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e},s.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e},s.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e},s.scaleAndAdd=function(e,t,n,i){return e[0]=t[0]+n[0]*i,e[1]=t[1]+n[1]*i,e[2]=t[2]+n[2]*i,e},s.distance=function(e,t){var n=t[0]-e[0],i=t[1]-e[1],r=t[2]-e[2];return Math.sqrt(n*n+i*i+r*r)},s.dist=s.distance,s.squaredDistance=function(e,t){var n=t[0]-e[0],i=t[1]-e[1],r=t[2]-e[2];return n*n+i*i+r*r},s.sqrDist=s.squaredDistance,s.length=function(e){var t=e[0],n=e[1],i=e[2];return Math.sqrt(t*t+n*n+i*i)},s.len=s.length,s.squaredLength=function(e){var t=e[0],n=e[1],i=e[2];return t*t+n*n+i*i},s.sqrLen=s.squaredLength,s.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},s.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},s.normalize=function(e,t){var n=t[0],i=t[1],r=t[2],o=n*n+i*i+r*r;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e},s.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},s.cross=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=n[0],s=n[1],l=n[2];return e[0]=r*l-o*s,e[1]=o*a-i*l,e[2]=i*s-r*a,e},s.lerp=function(e,t,n,i){var r=t[0],o=t[1],a=t[2];return e[0]=r+i*(n[0]-r),e[1]=o+i*(n[1]-o),e[2]=a+i*(n[2]-a),e},s.random=function(e,t){t=t||1;var n=2*i()*Math.PI,r=2*i()-1,o=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*o,e[1]=Math.sin(n)*o,e[2]=r*t,e},s.transformMat4=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=n[3]*i+n[7]*r+n[11]*o+n[15];return a=a||1,e[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])/a,e[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])/a,e[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])/a,e},s.transformMat3=function(e,t,n){var i=t[0],r=t[1],o=t[2];return e[0]=i*n[0]+r*n[3]+o*n[6],e[1]=i*n[1]+r*n[4]+o*n[7],e[2]=i*n[2]+r*n[5]+o*n[8],e},s.transformQuat=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=n[0],s=n[1],l=n[2],c=n[3],u=c*i+s*o-l*r,d=c*r+l*i-a*o,h=c*o+a*r-s*i,p=-a*i-s*r-l*o;return e[0]=u*c+p*-a+d*-l-h*-s,e[1]=d*c+p*-s+h*-a-u*-l,e[2]=h*c+p*-l+u*-s-d*-a,e},s.rotateX=function(e,t,n,i){var r=[],o=[];return r[0]=t[0]-n[0],r[1]=t[1]-n[1],r[2]=t[2]-n[2],o[0]=r[0],o[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),o[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},s.rotateY=function(e,t,n,i){var r=[],o=[];return r[0]=t[0]-n[0],r[1]=t[1]-n[1],r[2]=t[2]-n[2],o[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),o[1]=r[1],o[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},s.rotateZ=function(e,t,n,i){var r=[],o=[];return r[0]=t[0]-n[0],r[1]=t[1]-n[1],r[2]=t[2]-n[2],o[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),o[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),o[2]=r[2],e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},s.forEach=function(){var e=s.create();return function(t,n,i,r,o,a){var s,l;for(n||(n=3),i||(i=0),l=r?Math.min(r*n+i,t.length):t.length,s=i;s<l;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}(),s.angle=function(e,t){var n=s.fromValues(e[0],e[1],e[2]),i=s.fromValues(t[0],t[1],t[2]);s.normalize(n,n),s.normalize(i,i);var r=s.dot(n,i);return r>1?0:Math.acos(r)},s.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},void 0!==e&&(e.vec3=s);var l={};l.create=function(){var e=new n(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},l.clone=function(e){var t=new n(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},l.fromValues=function(e,t,i,r){var o=new n(4);return o[0]=e,o[1]=t,o[2]=i,o[3]=r,o},l.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},l.set=function(e,t,n,i,r){return e[0]=t,e[1]=n,e[2]=i,e[3]=r,e},l.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},l.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e},l.sub=l.subtract,l.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e},l.mul=l.multiply,l.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e},l.div=l.divide,l.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e},l.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e},l.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e},l.scaleAndAdd=function(e,t,n,i){return e[0]=t[0]+n[0]*i,e[1]=t[1]+n[1]*i,e[2]=t[2]+n[2]*i,e[3]=t[3]+n[3]*i,e},l.distance=function(e,t){var n=t[0]-e[0],i=t[1]-e[1],r=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(n*n+i*i+r*r+o*o)},l.dist=l.distance,l.squaredDistance=function(e,t){var n=t[0]-e[0],i=t[1]-e[1],r=t[2]-e[2],o=t[3]-e[3];return n*n+i*i+r*r+o*o},l.sqrDist=l.squaredDistance,l.length=function(e){var t=e[0],n=e[1],i=e[2],r=e[3];return Math.sqrt(t*t+n*n+i*i+r*r)},l.len=l.length,l.squaredLength=function(e){var t=e[0],n=e[1],i=e[2],r=e[3];return t*t+n*n+i*i+r*r},l.sqrLen=l.squaredLength,l.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},l.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},l.normalize=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=n*n+i*i+r*r+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a),e},l.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},l.lerp=function(e,t,n,i){var r=t[0],o=t[1],a=t[2],s=t[3];return e[0]=r+i*(n[0]-r),e[1]=o+i*(n[1]-o),e[2]=a+i*(n[2]-a),e[3]=s+i*(n[3]-s),e},l.random=function(e,t){return t=t||1,e[0]=i(),e[1]=i(),e[2]=i(),e[3]=i(),l.normalize(e,e),l.scale(e,e,t),e},l.transformMat4=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3];return e[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*a,e[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*a,e[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*a,e[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*a,e},l.transformQuat=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=n[0],s=n[1],l=n[2],c=n[3],u=c*i+s*o-l*r,d=c*r+l*i-a*o,h=c*o+a*r-s*i,p=-a*i-s*r-l*o;return e[0]=u*c+p*-a+d*-l-h*-s,e[1]=d*c+p*-s+h*-a-u*-l,e[2]=h*c+p*-l+u*-s-d*-a,e},l.forEach=function(){var e=l.create();return function(t,n,i,r,o,a){var s,l;for(n||(n=4),i||(i=0),l=r?Math.min(r*n+i,t.length):t.length,s=i;s<l;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}(),l.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},void 0!==e&&(e.vec4=l);var c={};c.create=function(){var e=new n(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},c.clone=function(e){var t=new n(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},c.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},c.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},c.transpose=function(e,t){if(e===t){var n=t[1];e[1]=t[2],e[2]=n}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},c.invert=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=n*o-r*i;return a?(a=1/a,e[0]=o*a,e[1]=-i*a,e[2]=-r*a,e[3]=n*a,e):null},c.adjoint=function(e,t){var n=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=n,e},c.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},c.multiply=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3],s=n[0],l=n[1],c=n[2],u=n[3];return e[0]=i*s+o*l,e[1]=r*s+a*l,e[2]=i*c+o*u,e[3]=r*c+a*u,e},c.mul=c.multiply,c.rotate=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=i*l+o*s,e[1]=r*l+a*s,e[2]=i*-s+o*l,e[3]=r*-s+a*l,e},c.scale=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3],s=n[0],l=n[1];return e[0]=i*s,e[1]=r*s,e[2]=o*l,e[3]=a*l,e},c.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},c.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))},c.LDU=function(e,t,n,i){return e[2]=i[2]/i[0],n[0]=i[0],n[1]=i[1],n[3]=i[3]-e[2]*n[1],[e,t,n]},void 0!==e&&(e.mat2=c);var u={};u.create=function(){var e=new n(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},u.clone=function(e){var t=new n(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},u.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},u.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},u.invert=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=n*o-i*r;return l?(l=1/l,e[0]=o*l,e[1]=-i*l,e[2]=-r*l,e[3]=n*l,e[4]=(r*s-o*a)*l,e[5]=(i*a-n*s)*l,e):null},u.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},u.multiply=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=n[0],u=n[1],d=n[2],h=n[3],p=n[4],f=n[5];return e[0]=i*c+o*u,e[1]=r*c+a*u,e[2]=i*d+o*h,e[3]=r*d+a*h,e[4]=i*p+o*f+s,e[5]=r*p+a*f+l,e},u.mul=u.multiply,u.rotate=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=Math.sin(n),u=Math.cos(n);return e[0]=i*u+o*c,e[1]=r*u+a*c,e[2]=i*-c+o*u,e[3]=r*-c+a*u,e[4]=s,e[5]=l,e},u.scale=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=n[0],u=n[1];return e[0]=i*c,e[1]=r*c,e[2]=o*u,e[3]=a*u,e[4]=s,e[5]=l,e},u.translate=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=n[0],u=n[1];return e[0]=i,e[1]=r,e[2]=o,e[3]=a,e[4]=i*c+o*u+s,e[5]=r*c+a*u+l,e},u.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},u.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},void 0!==e&&(e.mat2d=u);var d={};d.create=function(){var e=new n(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},d.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},d.clone=function(e){var t=new n(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},d.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},d.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},d.transpose=function(e,t){if(e===t){var n=t[1],i=t[2],r=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=i,e[7]=r}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},d.invert=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],d=u*a-s*c,h=-u*o+s*l,p=c*o-a*l,f=n*d+i*h+r*p;return f?(f=1/f,e[0]=d*f,e[1]=(-u*i+r*c)*f,e[2]=(s*i-r*a)*f,e[3]=h*f,e[4]=(u*n-r*l)*f,e[5]=(-s*n+r*o)*f,e[6]=p*f,e[7]=(-c*n+i*l)*f,e[8]=(a*n-i*o)*f,e):null},d.adjoint=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8];return e[0]=a*u-s*c,e[1]=r*c-i*u,e[2]=i*s-r*a,e[3]=s*l-o*u,e[4]=n*u-r*l,e[5]=r*o-n*s,e[6]=o*c-a*l,e[7]=i*l-n*c,e[8]=n*a-i*o,e},d.determinant=function(e){var t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],s=e[6],l=e[7],c=e[8];return t*(c*o-a*l)+n*(-c*r+a*s)+i*(l*r-o*s)},d.multiply=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=t[8],h=n[0],p=n[1],f=n[2],g=n[3],m=n[4],v=n[5],_=n[6],y=n[7],x=n[8];return e[0]=h*i+p*a+f*c,e[1]=h*r+p*s+f*u,e[2]=h*o+p*l+f*d,e[3]=g*i+m*a+v*c,e[4]=g*r+m*s+v*u,e[5]=g*o+m*l+v*d,e[6]=_*i+y*a+x*c,e[7]=_*r+y*s+x*u,e[8]=_*o+y*l+x*d,e},d.mul=d.multiply,d.translate=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=t[8],h=n[0],p=n[1];return e[0]=i,e[1]=r,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e[6]=h*i+p*a+c,e[7]=h*r+p*s+u,e[8]=h*o+p*l+d,e},d.rotate=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=t[8],h=Math.sin(n),p=Math.cos(n);return e[0]=p*i+h*a,e[1]=p*r+h*s,e[2]=p*o+h*l,e[3]=p*a-h*i,e[4]=p*s-h*r,e[5]=p*l-h*o,e[6]=c,e[7]=u,e[8]=d,e},d.scale=function(e,t,n){var i=n[0],r=n[1];return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=r*t[3],e[4]=r*t[4],e[5]=r*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},d.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},d.fromQuat=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=n+n,s=i+i,l=r+r,c=n*a,u=i*a,d=i*s,h=r*a,p=r*s,f=r*l,g=o*a,m=o*s,v=o*l;return e[0]=1-d-f,e[3]=u-v,e[6]=h+m,e[1]=u+v,e[4]=1-c-f,e[7]=p-g,e[2]=h-m,e[5]=p+g,e[8]=1-c-d,e},d.normalFromMat4=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],d=t[9],h=t[10],p=t[11],f=t[12],g=t[13],m=t[14],v=t[15],_=n*s-i*a,y=n*l-r*a,x=n*c-o*a,b=i*l-r*s,w=i*c-o*s,C=r*c-o*l,S=u*g-d*f,T=u*m-h*f,A=u*v-p*f,M=d*m-h*g,E=d*v-p*g,I=h*v-p*m,D=_*I-y*E+x*M+b*A-w*T+C*S;return D?(D=1/D,e[0]=(s*I-l*E+c*M)*D,e[1]=(l*A-a*I-c*T)*D,e[2]=(a*E-s*A+c*S)*D,e[3]=(r*E-i*I-o*M)*D,e[4]=(n*I-r*A+o*T)*D,e[5]=(i*A-n*E-o*S)*D,e[6]=(g*C-m*w+v*b)*D,e[7]=(m*x-f*C-v*y)*D,e[8]=(f*w-g*x+v*_)*D,e):null},d.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},d.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},void 0!==e&&(e.mat3=d);var h={};h.create=function(){var e=new n(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},h.clone=function(e){var t=new n(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},h.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},h.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},h.transpose=function(e,t){if(e===t){var n=t[1],i=t[2],r=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=i,e[9]=o,e[11]=t[14],e[12]=r,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},h.invert=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],d=t[9],h=t[10],p=t[11],f=t[12],g=t[13],m=t[14],v=t[15],_=n*s-i*a,y=n*l-r*a,x=n*c-o*a,b=i*l-r*s,w=i*c-o*s,C=r*c-o*l,S=u*g-d*f,T=u*m-h*f,A=u*v-p*f,M=d*m-h*g,E=d*v-p*g,I=h*v-p*m,D=_*I-y*E+x*M+b*A-w*T+C*S;return D?(D=1/D,e[0]=(s*I-l*E+c*M)*D,e[1]=(r*E-i*I-o*M)*D,e[2]=(g*C-m*w+v*b)*D,e[3]=(h*w-d*C-p*b)*D,e[4]=(l*A-a*I-c*T)*D,e[5]=(n*I-r*A+o*T)*D,e[6]=(m*x-f*C-v*y)*D,e[7]=(u*C-h*x+p*y)*D,e[8]=(a*E-s*A+c*S)*D,e[9]=(i*A-n*E-o*S)*D,e[10]=(f*w-g*x+v*_)*D,e[11]=(d*x-u*w-p*_)*D,e[12]=(s*T-a*M-l*S)*D,e[13]=(n*M-i*T+r*S)*D,e[14]=(g*y-f*b-m*_)*D,e[15]=(u*b-d*y+h*_)*D,e):null},h.adjoint=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],d=t[9],h=t[10],p=t[11],f=t[12],g=t[13],m=t[14],v=t[15];return e[0]=s*(h*v-p*m)-d*(l*v-c*m)+g*(l*p-c*h),e[1]=-(i*(h*v-p*m)-d*(r*v-o*m)+g*(r*p-o*h)),e[2]=i*(l*v-c*m)-s*(r*v-o*m)+g*(r*c-o*l),e[3]=-(i*(l*p-c*h)-s*(r*p-o*h)+d*(r*c-o*l)),e[4]=-(a*(h*v-p*m)-u*(l*v-c*m)+f*(l*p-c*h)),e[5]=n*(h*v-p*m)-u*(r*v-o*m)+f*(r*p-o*h),e[6]=-(n*(l*v-c*m)-a*(r*v-o*m)+f*(r*c-o*l)),e[7]=n*(l*p-c*h)-a*(r*p-o*h)+u*(r*c-o*l),e[8]=a*(d*v-p*g)-u*(s*v-c*g)+f*(s*p-c*d),e[9]=-(n*(d*v-p*g)-u*(i*v-o*g)+f*(i*p-o*d)),e[10]=n*(s*v-c*g)-a*(i*v-o*g)+f*(i*c-o*s),e[11]=-(n*(s*p-c*d)-a*(i*p-o*d)+u*(i*c-o*s)),e[12]=-(a*(d*m-h*g)-u*(s*m-l*g)+f*(s*h-l*d)),e[13]=n*(d*m-h*g)-u*(i*m-r*g)+f*(i*h-r*d),e[14]=-(n*(s*m-l*g)-a*(i*m-r*g)+f*(i*l-r*s)),e[15]=n*(s*h-l*d)-a*(i*h-r*d)+u*(i*l-r*s),e},h.determinant=function(e){var t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],s=e[6],l=e[7],c=e[8],u=e[9],d=e[10],h=e[11],p=e[12],f=e[13],g=e[14],m=e[15];return(t*a-n*o)*(d*m-h*g)-(t*s-i*o)*(u*m-h*f)+(t*l-r*o)*(u*g-d*f)+(n*s-i*a)*(c*m-h*p)-(n*l-r*a)*(c*g-d*p)+(i*l-r*s)*(c*f-u*p)},h.multiply=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=t[8],h=t[9],p=t[10],f=t[11],g=t[12],m=t[13],v=t[14],_=t[15],y=n[0],x=n[1],b=n[2],w=n[3];return e[0]=y*i+x*s+b*d+w*g,e[1]=y*r+x*l+b*h+w*m,e[2]=y*o+x*c+b*p+w*v,e[3]=y*a+x*u+b*f+w*_,y=n[4],x=n[5],b=n[6],w=n[7],e[4]=y*i+x*s+b*d+w*g,e[5]=y*r+x*l+b*h+w*m,e[6]=y*o+x*c+b*p+w*v,e[7]=y*a+x*u+b*f+w*_,y=n[8],x=n[9],b=n[10],w=n[11],e[8]=y*i+x*s+b*d+w*g,e[9]=y*r+x*l+b*h+w*m,e[10]=y*o+x*c+b*p+w*v,e[11]=y*a+x*u+b*f+w*_,y=n[12],x=n[13],b=n[14],w=n[15],e[12]=y*i+x*s+b*d+w*g,e[13]=y*r+x*l+b*h+w*m,e[14]=y*o+x*c+b*p+w*v,e[15]=y*a+x*u+b*f+w*_,e},h.multiplyAffine=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[4],s=t[5],l=t[6],c=t[8],u=t[9],d=t[10],h=t[12],p=t[13],f=t[14],g=n[0],m=n[1],v=n[2];return e[0]=g*i+m*a+v*c,e[1]=g*r+m*s+v*u,e[2]=g*o+m*l+v*d,g=n[4],m=n[5],v=n[6],e[4]=g*i+m*a+v*c,e[5]=g*r+m*s+v*u,e[6]=g*o+m*l+v*d,g=n[8],m=n[9],v=n[10],e[8]=g*i+m*a+v*c,e[9]=g*r+m*s+v*u,e[10]=g*o+m*l+v*d,g=n[12],m=n[13],v=n[14],e[12]=g*i+m*a+v*c+h,e[13]=g*r+m*s+v*u+p,e[14]=g*o+m*l+v*d+f,e},h.mul=h.multiply,h.mulAffine=h.multiplyAffine,h.translate=function(e,t,n){var i,r,o,a,s,l,c,u,d,h,p,f,g=n[0],m=n[1],v=n[2];return t===e?(e[12]=t[0]*g+t[4]*m+t[8]*v+t[12],e[13]=t[1]*g+t[5]*m+t[9]*v+t[13],e[14]=t[2]*g+t[6]*m+t[10]*v+t[14],e[15]=t[3]*g+t[7]*m+t[11]*v+t[15]):(i=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=t[8],h=t[9],p=t[10],f=t[11],e[0]=i,e[1]=r,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e[6]=c,e[7]=u,e[8]=d,e[9]=h,e[10]=p,e[11]=f,e[12]=i*g+s*m+d*v+t[12],e[13]=r*g+l*m+h*v+t[13],e[14]=o*g+c*m+p*v+t[14],e[15]=a*g+u*m+f*v+t[15]),e},h.scale=function(e,t,n){var i=n[0],r=n[1],o=n[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},h.rotate=function(e,n,i,r){var o,a,s,l,c,u,d,h,p,f,g,m,v,_,y,x,b,w,C,S,T,A,M,E,I=r[0],D=r[1],k=r[2],L=Math.sqrt(I*I+D*D+k*k);return Math.abs(L)<t?null:(L=1/L,I*=L,D*=L,k*=L,o=Math.sin(i),a=Math.cos(i),s=1-a,l=n[0],c=n[1],u=n[2],d=n[3],h=n[4],p=n[5],f=n[6],g=n[7],m=n[8],v=n[9],_=n[10],y=n[11],x=I*I*s+a,b=D*I*s+k*o,w=k*I*s-D*o,C=I*D*s-k*o,S=D*D*s+a,T=k*D*s+I*o,A=I*k*s+D*o,M=D*k*s-I*o,E=k*k*s+a,e[0]=l*x+h*b+m*w,e[1]=c*x+p*b+v*w,e[2]=u*x+f*b+_*w,e[3]=d*x+g*b+y*w,e[4]=l*C+h*S+m*T,e[5]=c*C+p*S+v*T,e[6]=u*C+f*S+_*T,e[7]=d*C+g*S+y*T,e[8]=l*A+h*M+m*E,e[9]=c*A+p*M+v*E,e[10]=u*A+f*M+_*E,e[11]=d*A+g*M+y*E,n!==e&&(e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e)},h.rotateX=function(e,t,n){var i=Math.sin(n),r=Math.cos(n),o=t[4],a=t[5],s=t[6],l=t[7],c=t[8],u=t[9],d=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*r+c*i,e[5]=a*r+u*i,e[6]=s*r+d*i,e[7]=l*r+h*i,e[8]=c*r-o*i,e[9]=u*r-a*i,e[10]=d*r-s*i,e[11]=h*r-l*i,e},h.rotateY=function(e,t,n){var i=Math.sin(n),r=Math.cos(n),o=t[0],a=t[1],s=t[2],l=t[3],c=t[8],u=t[9],d=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*r-c*i,e[1]=a*r-u*i,e[2]=s*r-d*i,e[3]=l*r-h*i,e[8]=o*i+c*r,e[9]=a*i+u*r,e[10]=s*i+d*r,e[11]=l*i+h*r,e},h.rotateZ=function(e,t,n){var i=Math.sin(n),r=Math.cos(n),o=t[0],a=t[1],s=t[2],l=t[3],c=t[4],u=t[5],d=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*r+c*i,e[1]=a*r+u*i,e[2]=s*r+d*i,e[3]=l*r+h*i,e[4]=c*r-o*i,e[5]=u*r-a*i,e[6]=d*r-s*i,e[7]=h*r-l*i,e},h.fromRotationTranslation=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3],s=i+i,l=r+r,c=o+o,u=i*s,d=i*l,h=i*c,p=r*l,f=r*c,g=o*c,m=a*s,v=a*l,_=a*c;return e[0]=1-(p+g),e[1]=d+_,e[2]=h-v,e[3]=0,e[4]=d-_,e[5]=1-(u+g),e[6]=f+m,e[7]=0,e[8]=h+v,e[9]=f-m,e[10]=1-(u+p),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e},h.fromQuat=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=n+n,s=i+i,l=r+r,c=n*a,u=i*a,d=i*s,h=r*a,p=r*s,f=r*l,g=o*a,m=o*s,v=o*l;return e[0]=1-d-f,e[1]=u+v,e[2]=h-m,e[3]=0,e[4]=u-v,e[5]=1-c-f,e[6]=p+g,e[7]=0,e[8]=h+m,e[9]=p-g,e[10]=1-c-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},h.frustum=function(e,t,n,i,r,o,a){var s=1/(n-t),l=1/(r-i),c=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*l,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(r+i)*l,e[10]=(a+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*c,e[15]=0,e},h.perspective=function(e,t,n,i,r){var o=1/Math.tan(t/2),a=1/(i-r);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(r+i)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*r*i*a,e[15]=0,e},h.ortho=function(e,t,n,i,r,o,a){var s=1/(t-n),l=1/(i-r),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*s,e[13]=(r+i)*l,e[14]=(a+o)*c,e[15]=1,e},h.lookAt=function(e,n,i,r){var o,a,s,l,c,u,d,p,f,g,m=n[0],v=n[1],_=n[2],y=r[0],x=r[1],b=r[2],w=i[0],C=i[1],S=i[2];return Math.abs(m-w)<t&&Math.abs(v-C)<t&&Math.abs(_-S)<t?h.identity(e):(d=m-w,p=v-C,f=_-S,g=1/Math.sqrt(d*d+p*p+f*f),d*=g,p*=g,f*=g,o=x*f-b*p,a=b*d-y*f,s=y*p-x*d,g=Math.sqrt(o*o+a*a+s*s),g?(g=1/g,o*=g,a*=g,s*=g):(o=0,a=0,s=0),l=p*s-f*a,c=f*o-d*s,u=d*a-p*o,g=Math.sqrt(l*l+c*c+u*u),g?(g=1/g,l*=g,c*=g,u*=g):(l=0,c=0,u=0),e[0]=o,e[1]=l,e[2]=d,e[3]=0,e[4]=a,e[5]=c,e[6]=p,e[7]=0,e[8]=s,e[9]=u,e[10]=f,e[11]=0,e[12]=-(o*m+a*v+s*_),e[13]=-(l*m+c*v+u*_),e[14]=-(d*m+p*v+f*_),e[15]=1,e)},h.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},h.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},void 0!==e&&(e.mat4=h);var p={};p.create=function(){var e=new n(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},p.rotationTo=function(){var e=s.create(),t=s.fromValues(1,0,0),n=s.fromValues(0,1,0);return function(i,r,o){var a=s.dot(r,o);return a<-.999999?(s.cross(e,t,r),s.length(e)<1e-6&&s.cross(e,n,r),s.normalize(e,e),p.setAxisAngle(i,e,Math.PI),i):a>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(s.cross(e,r,o),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=1+a,p.normalize(i,i))}}(),p.setAxes=function(){var e=d.create();return function(t,n,i,r){return e[0]=i[0],e[3]=i[1],e[6]=i[2],e[1]=r[0],e[4]=r[1],e[7]=r[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],p.normalize(t,p.fromMat3(t,e))}}(),p.clone=l.clone,p.fromValues=l.fromValues,p.copy=l.copy,p.set=l.set,p.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},p.setAxisAngle=function(e,t,n){n*=.5;var i=Math.sin(n);return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=Math.cos(n),e},p.add=l.add,p.multiply=function(e,t,n){var i=t[0],r=t[1],o=t[2],a=t[3],s=n[0],l=n[1],c=n[2],u=n[3];return e[0]=i*u+a*s+r*c-o*l,e[1]=r*u+a*l+o*s-i*c,e[2]=o*u+a*c+i*l-r*s,e[3]=a*u-i*s-r*l-o*c,e},p.mul=p.multiply,p.scale=l.scale,p.rotateX=function(e,t,n){n*=.5;var i=t[0],r=t[1],o=t[2],a=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=i*l+a*s,e[1]=r*l+o*s,e[2]=o*l-r*s,e[3]=a*l-i*s,e},p.rotateY=function(e,t,n){n*=.5;var i=t[0],r=t[1],o=t[2],a=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=i*l-o*s,e[1]=r*l+a*s,e[2]=o*l+i*s,e[3]=a*l-r*s,e},p.rotateZ=function(e,t,n){n*=.5;var i=t[0],r=t[1],o=t[2],a=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=i*l+r*s,e[1]=r*l-i*s,e[2]=o*l+a*s,e[3]=a*l-o*s,e},p.calculateW=function(e,t){var n=t[0],i=t[1],r=t[2];return e[0]=n,e[1]=i,e[2]=r,e[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r)),e},p.dot=l.dot,p.lerp=l.lerp,p.slerp=function(e,t,n,i){var r,o,a,s,l,c=t[0],u=t[1],d=t[2],h=t[3],p=n[0],f=n[1],g=n[2],m=n[3];return o=c*p+u*f+d*g+h*m,o<0&&(o=-o,p=-p,f=-f,g=-g,m=-m),1-o>1e-6?(r=Math.acos(o),a=Math.sin(r),s=Math.sin((1-i)*r)/a,l=Math.sin(i*r)/a):(s=1-i,l=i),e[0]=s*c+l*p,e[1]=s*u+l*f,e[2]=s*d+l*g,e[3]=s*h+l*m,e},p.invert=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],a=n*n+i*i+r*r+o*o,s=a?1/a:0;return e[0]=-n*s,e[1]=-i*s,e[2]=-r*s,e[3]=o*s,e},p.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},p.length=l.length,p.len=p.length,p.squaredLength=l.squaredLength,p.sqrLen=p.squaredLength,p.normalize=l.normalize,p.fromMat3=function(e,t){var n,i=t[0]+t[4]+t[8];if(i>0)n=Math.sqrt(i+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var r=0;t[4]>t[0]&&(r=1),t[8]>t[3*r+r]&&(r=2);var o=(r+1)%3,a=(r+2)%3;n=Math.sqrt(t[3*r+r]-t[3*o+o]-t[3*a+a]+1),e[r]=.5*n,n=.5/n,e[3]=(t[3*o+a]-t[3*a+o])*n,e[o]=(t[3*o+r]+t[3*r+o])*n,e[a]=(t[3*a+r]+t[3*r+a])*n}return e},p.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},void 0!==e&&(e.quat=p)}(n.exports)}()},function(e,t,r){function n(e){return!e||"none"===e}function i(e){return e instanceof HTMLCanvasElement||e instanceof HTMLImageElement||e instanceof Image}function a(e){return e.getZr&&e.setOption}var o=r(29),s=r(51),l=r(7),c=r(6),u=r(9),d=r(19),h=r(30),p=r(12),f=r(0),g=r(31),m=r(84),v=r(60),_=r(154),y=r(183),x=r(184),b=r(213),w=r(4),C=r(156);f.util.extend(h.prototype,C),u.import(r(209)),u.import(r(164)),u.import(r(163)),u.import(r(166)),u.import(r(168));var S=g.prototype.addToScene,T=g.prototype.removeFromScene;g.prototype.addToScene=function(e){if(S.call(this,e),this.__zr){var t=this.__zr;e.traverse(function(e){e.__zr=t,e.addAnimatorsToZr&&e.addAnimatorsToZr(t)})}},g.prototype.removeFromScene=function(e){T.call(this,e),e.traverse(function(e){var t=e.__zr;e.__zr=null,t&&e.removeAnimatorsFromZr&&e.removeAnimatorsFromZr(t)})},d.prototype.setTextureImage=function(e,t,i,r){if(null==i&&(i=r),this.shader){var o,a=i.getZr(),s=this;return s.shader.disableTexture(e),n(t)||(o=A.loadTexture(t,i,r,function(t){s.shader.enableTexture(e),s.set(e,t),a&&a.refresh()})),o}};var A={};A.Renderer=s,A.Node=h,A.Mesh=o,A.Shader=u,A.Material=d,A.Texture=c,A.Texture2D=l,A.Geometry=p,A.SphereGeometry=r(75),A.PlaneGeometry=r(53),A.CubeGeometry=r(74),A.AmbientLight=r(182),A.DirectionalLight=r(76),A.PointLight=r(77),A.SpotLight=r(78),A.PerspectiveCamera=r(43),A.OrthographicCamera=r(42),A.Vector2=r(24),A.Vector3=r(3),A.Vector4=r(189),A.Quaternion=r(55),A.Matrix2=r(186),A.Matrix2d=r(187),A.Matrix3=r(188),A.Matrix4=r(10),A.Plane=r(79),A.Ray=r(56),A.BoundingBox=r(13),A.Frustum=r(54);var M=v.createBlank("rgba(255,255,255,0)").image;A.loadTexture=function(e,t,n,r){"function"==typeof n&&(r=n,n={}),n=n||{};for(var o=Object.keys(n).sort(),s="",l=0;l<o.length;l++)s+=o[l]+"_"+n[o[l]]+"_";var c=t.__textureCache=t.__textureCache||new m(20);if(a(e)){var u=e.__textureid__,d=c.get(s+u);if(d)d.texture.surface.setECharts(e),r&&r(d.texture);else{var h=new _(e);h.onupdate=function(){t.getZr().refresh()},d={texture:h.getTexture()};for(var l=0;l<o.length;l++)d.texture[o[l]]=n[o[l]];u=e.__textureid__||"__ecgl_ec__"+d.texture.__GUID__,e.__textureid__=u,c.put(s+u,d),r&&r(d.texture)}return d.texture}if(i(e)){var u=e.__textureid__,d=c.get(s+u);if(!d){d={texture:new A.Texture2D({image:e})};for(var l=0;l<o.length;l++)d.texture[o[l]]=n[o[l]];u=e.__textureid__||"__ecgl_image__"+d.texture.__GUID__,e.__textureid__=u,c.put(s+u,d),r&&r(d.texture)}return d.texture}var d=c.get(s+e);if(d)d.callbacks?d.callbacks.push(r):r&&r(d.texture);else if(e.match(/.hdr$|^data:application\/octet-stream/)){d={callbacks:[r]};var p=v.loadTexture(e,{exposure:n.exposure,fileType:"hdr"},function(){p.dirty(),d.callbacks.forEach(function(e){e&&e(p)}),d.callbacks=null});d.texture=p,c.put(s+e,d)}else{for(var p=new A.Texture2D({image:new Image}),l=0;l<o.length;l++)p[o[l]]=n[o[l]];d={texture:p,callbacks:[r]};var f=p.image;f.onload=function(){p.image=f,p.dirty(),d.callbacks.forEach(function(e){e&&e(p)}),d.callbacks=null},f.src=e,p.image=M,c.put(s+e,d)}return d.texture},A.createAmbientCubemap=function(e,t,n,i){e=e||{};var r=e.texture,o=w.firstNotNull(e.exposure,1),a=new y({intensity:w.firstNotNull(e.specularIntensity,1)}),s=new x({intensity:w.firstNotNull(e.diffuseIntensity,1),coefficients:[.844,.712,.691,-.037,.083,.167,.343,.288,.299,-.041,-.021,-.009,-.003,-.041,-.064,-.011,-.007,-.004,-.031,.034,.081,-.06,-.049,-.06,.046,.056,.05]});return a.cubemap=A.loadTexture(r,n,{exposure:o},function(){a.cubemap.flipY=!1,a.prefilter(t,32),s.coefficients=b.projectEnvironmentMap(t,a.cubemap,{lod:1}),i&&i()}),{specular:a,diffuse:s}},A.createBlankTexture=v.createBlank,A.isImage=i,A.additiveBlend=function(e){e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE)},A.parseColor=function(e,t){return e instanceof Array?(t||(t=[]),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):(t=f.color.parse(e||"#000",t)||[0,0,0,0],t[0]/=255,t[1]/=255,t[2]/=255,t)},A.directionFromAlphaBeta=function(e,t){var n=e/180*Math.PI+Math.PI/2,i=-t/180*Math.PI+Math.PI/2,r=[],o=Math.sin(n);return r[0]=o*Math.cos(i),r[1]=-Math.cos(n),r[2]=o*Math.sin(i),r},A.getShadowResolution=function(e){var t=1024;switch(e){case"low":t=512;break;case"medium":break;case"high":t=2048;break;case"ultra":t=4096}return t},A.COMMON_SHADERS=["lambert","color","realistic"],A.createShader=function(e){var t=u.source(e+".vertex"),n=u.source(e+".fragment");return new u({vertex:t,fragment:n})},A.setMaterialFromModel=function(e,t,n,i){var r=n.getModel(e+"Material"),o=r.get("baseTexture"),a=w.firstNotNull(r.get("textureTiling"),1),s=w.firstNotNull(r.get("textureOffset"),1);"number"==typeof a&&(a=[a,a]),"number"==typeof s&&(s=[s,s]);var l={anisotropic:8,wrapS:A.Texture.REPEAT,wrapT:A.Texture.REPEAT};if("realistic"===e){var c=w.firstNotNull(r.get("roughness"),.5),u=r.get("metalness")||0,d=r.get("roughnessTexture"),h=r.get("metalnessTexture");null==u&&(u=null==h?0:.5),null==c&&(c=.5),t.setTextureImage("diffuseMap",o,i,l),t.setTextureImage("roughnessMap",d,i,l),t.setTextureImage("metalnessMap",h,i,l),t.set({roughness:c,metalness:u,uvRepeat:a,uvOffset:s})}else"lambert"===e?(t.setTextureImage("diffuseMap",o,i,l),t.set({uvRepeat:a,uvOffset:s})):"color"===e&&(t.setTextureImage("diffuseMap",o,i,l),t.set({uvRepeat:a,uvOffset:s}))},e.exports=A},function(e,t,i){"use strict";function n(e,t,n){return e<t?t:e>n?n:e}var r=i(1),o=r.vec3,a=function(e,t,n){e=e||0,t=t||0,n=n||0,this._array=o.fromValues(e,t,n),this._dirty=!0};a.prototype={constructor:a,add:function(e){return o.add(this._array,this._array,e._array),this._dirty=!0,this},set:function(e,t,n){return this._array[0]=e,this._array[1]=t,this._array[2]=n,this._dirty=!0,this},setArray:function(e){return this._array[0]=e[0],this._array[1]=e[1],this._array[2]=e[2],this._dirty=!0,this},clone:function(){return new a(this.x,this.y,this.z)},copy:function(e){return o.copy(this._array,e._array),this._dirty=!0,this},cross:function(e,t){return o.cross(this._array,e._array,t._array),this._dirty=!0,this},dist:function(e){return o.dist(this._array,e._array)},distance:function(e){return o.distance(this._array,e._array)},div:function(e){return o.div(this._array,this._array,e._array),this._dirty=!0,this},divide:function(e){return o.divide(this._array,this._array,e._array),this._dirty=!0,this},dot:function(e){return o.dot(this._array,e._array)},len:function(){return o.len(this._array)},length:function(){return o.length(this._array)},lerp:function(e,t,n){return o.lerp(this._array,e._array,t._array,n),this._dirty=!0,this},min:function(e){return o.min(this._array,this._array,e._array),this._dirty=!0,this},max:function(e){return o.max(this._array,this._array,e._array),this._dirty=!0,this},mul:function(e){return o.mul(this._array,this._array,e._array),this._dirty=!0,this},multiply:function(e){return o.multiply(this._array,this._array,e._array),this._dirty=!0,this},negate:function(){return o.negate(this._array,this._array),this._dirty=!0,this},normalize:function(){return o.normalize(this._array,this._array),this._dirty=!0,this},random:function(e){return o.random(this._array,e),this._dirty=!0,this},scale:function(e){return o.scale(this._array,this._array,e),this._dirty=!0,this},scaleAndAdd:function(e,t){return o.scaleAndAdd(this._array,this._array,e._array,t),this._dirty=!0,this},sqrDist:function(e){return o.sqrDist(this._array,e._array)},squaredDistance:function(e){return o.squaredDistance(this._array,e._array)},sqrLen:function(){return o.sqrLen(this._array)},squaredLength:function(){return o.squaredLength(this._array)},sub:function(e){return o.sub(this._array,this._array,e._array),this._dirty=!0,this},subtract:function(e){return o.subtract(this._array,this._array,e._array),this._dirty=!0,this},transformMat3:function(e){return o.transformMat3(this._array,this._array,e._array),this._dirty=!0,this},transformMat4:function(e){return o.transformMat4(this._array,this._array,e._array),this._dirty=!0,this},transformQuat:function(e){return o.transformQuat(this._array,this._array,e._array),this._dirty=!0,this},applyProjection:function(e){var t=this._array;if(e=e._array,0===e[15]){var n=-1/t[2];t[0]=e[0]*t[0]*n,t[1]=e[5]*t[1]*n,t[2]=(e[10]*t[2]+e[14])*n}else t[0]=e[0]*t[0]+e[12],t[1]=e[5]*t[1]+e[13],t[2]=e[10]*t[2]+e[14];return this._dirty=!0,this},eulerFromQuat:function(e,t){a.eulerFromQuat(this,e,t)},eulerFromMat3:function(e,t){a.eulerFromMat3(this,e,t)},toString:function(){return"["+Array.prototype.join.call(this._array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this._array)}};var s=Object.defineProperty;if(s){var l=a.prototype;s(l,"x",{get:function(){return this._array[0]},set:function(e){this._array[0]=e,this._dirty=!0}}),s(l,"y",{get:function(){return this._array[1]},set:function(e){this._array[1]=e,this._dirty=!0}}),s(l,"z",{get:function(){return this._array[2]},set:function(e){this._array[2]=e,this._dirty=!0}})}a.add=function(e,t,n){return o.add(e._array,t._array,n._array),e._dirty=!0,e},a.set=function(e,t,n,i){o.set(e._array,t,n,i),e._dirty=!0},a.copy=function(e,t){return o.copy(e._array,t._array),e._dirty=!0,e},a.cross=function(e,t,n){return o.cross(e._array,t._array,n._array),e._dirty=!0,e},a.dist=function(e,t){return o.distance(e._array,t._array)},a.distance=a.dist,a.div=function(e,t,n){return o.divide(e._array,t._array,n._array),e._dirty=!0,e},a.divide=a.div,a.dot=function(e,t){return o.dot(e._array,t._array)},a.len=function(e){return o.length(e._array)},a.lerp=function(e,t,n,i){return o.lerp(e._array,t._array,n._array,i),e._dirty=!0,e},a.min=function(e,t,n){return o.min(e._array,t._array,n._array),e._dirty=!0,e},a.max=function(e,t,n){return o.max(e._array,t._array,n._array),e._dirty=!0,e},a.mul=function(e,t,n){return o.multiply(e._array,t._array,n._array),e._dirty=!0,e},a.multiply=a.mul,a.negate=function(e,t){return o.negate(e._array,t._array),e._dirty=!0,e},a.normalize=function(e,t){return o.normalize(e._array,t._array),e._dirty=!0,e},a.random=function(e,t){return o.random(e._array,t),e._dirty=!0,e},a.scale=function(e,t,n){return o.scale(e._array,t._array,n),e._dirty=!0,e},a.scaleAndAdd=function(e,t,n,i){return o.scaleAndAdd(e._array,t._array,n._array,i),e._dirty=!0,e},a.sqrDist=function(e,t){return o.sqrDist(e._array,t._array)},a.squaredDistance=a.sqrDist,a.sqrLen=function(e){return o.sqrLen(e._array)},a.squaredLength=a.sqrLen,a.sub=function(e,t,n){return o.subtract(e._array,t._array,n._array),e._dirty=!0,e},a.subtract=a.sub,a.transformMat3=function(e,t,n){return o.transformMat3(e._array,t._array,n._array),e._dirty=!0,e},a.transformMat4=function(e,t,n){return o.transformMat4(e._array,t._array,n._array),e._dirty=!0,e},a.transformQuat=function(e,t,n){return o.transformQuat(e._array,t._array,n._array),e._dirty=!0,e};var c=Math.atan2,u=Math.asin,d=Math.abs;a.eulerFromQuat=function(e,t,i){e._dirty=!0,t=t._array;var r=e._array,o=t[0],a=t[1],s=t[2],l=t[3],d=o*o,h=a*a,p=s*s,f=l*l,i=(i||"XYZ").toUpperCase();switch(i){case"XYZ":r[0]=c(2*(o*l-a*s),f-d-h+p),r[1]=u(n(2*(o*s+a*l),-1,1)),r[2]=c(2*(s*l-o*a),f+d-h-p);break;case"YXZ":r[0]=u(n(2*(o*l-a*s),-1,1)),r[1]=c(2*(o*s+a*l),f-d-h+p),r[2]=c(2*(o*a+s*l),f-d+h-p);break;case"ZXY":r[0]=u(n(2*(o*l+a*s),-1,1)),r[1]=c(2*(a*l-s*o),f-d-h+p),r[2]=c(2*(s*l-o*a),f-d+h-p);break;case"ZYX":r[0]=c(2*(o*l+s*a),f-d-h+p),r[1]=u(n(2*(a*l-o*s),-1,1)),r[2]=c(2*(o*a+s*l),f+d-h-p);break;case"YZX":r[0]=c(2*(o*l-s*a),f-d+h-p),r[1]=c(2*(a*l-o*s),f+d-h-p),r[2]=u(n(2*(o*a+s*l),-1,1));break;case"XZY":r[0]=c(2*(o*l+a*s),f-d+h-p),r[1]=c(2*(o*s+a*l),f+d-h-p),r[2]=u(n(2*(s*l-o*a),-1,1))}return e},a.eulerFromMat3=function(e,t,i){var r=t._array,o=r[0],a=r[3],s=r[6],l=r[1],h=r[4],p=r[7],f=r[2],g=r[5],m=r[8],v=e._array,i=(i||"XYZ").toUpperCase();switch(i){case"XYZ":v[1]=u(n(s,-1,1)),d(s)<.99999?(v[0]=c(-p,m),v[2]=c(-a,o)):(v[0]=c(g,h),v[2]=0);break;case"YXZ":v[0]=u(-n(p,-1,1)),d(p)<.99999?(v[1]=c(s,m),v[2]=c(l,h)):(v[1]=c(-f,o),v[2]=0);break;case"ZXY":v[0]=u(n(g,-1,1)),d(g)<.99999?(v[1]=c(-f,m),v[2]=c(-a,h)):(v[1]=0,v[2]=c(l,o));break;case"ZYX":v[1]=u(-n(f,-1,1)),d(f)<.99999?(v[0]=c(g,m),v[2]=c(l,o)):(v[0]=0,v[2]=c(-a,h));break;case"YZX":v[2]=u(n(l,-1,1)),d(l)<.99999?(v[0]=c(-p,h),v[1]=c(-f,o)):(v[0]=0,v[1]=c(s,m));break;case"XZY":v[2]=u(-n(a,-1,1)),d(a)<.99999?(v[0]=c(g,h),v[1]=c(s,o)):(v[0]=c(-p,m),v[1]=0)}return e._dirty=!0,e},a.POSITIVE_X=new a(1,0,0),a.NEGATIVE_X=new a(-1,0,0),a.POSITIVE_Y=new a(0,1,0),a.NEGATIVE_Y=new a(0,-1,0),a.POSITIVE_Z=new a(0,0,1),a.NEGATIVE_Z=new a(0,0,-1),a.UP=new a(0,1,0),a.ZERO=new a(0,0,0),e.exports=a},function(e,t){var n={firstNotNull:function(){for(var e=0,t=arguments.length;e<t;e++)if(null!=arguments[e])return arguments[e]}};e.exports=n},function(e,t,n){"use strict";var i=n(181),r=n(52),o=n(23),a=function(){this.__GUID__=o.genGUID()};a.__initializers__=[function(e){o.extend(this,e)}],o.extend(a,i),o.extend(a.prototype,r),e.exports=a},function(e,t,n){"use strict";var i=n(5),r=n(8),o=n(44),a=i.extend({width:512,height:512,type:r.UNSIGNED_BYTE,format:r.RGBA,wrapS:r.CLAMP_TO_EDGE,wrapT:r.CLAMP_TO_EDGE,minFilter:r.LINEAR_MIPMAP_LINEAR,magFilter:r.LINEAR,useMipmap:!0,anisotropic:1,flipY:!0,unpackAlignment:4,premultiplyAlpha:!1,dynamic:!1,NPOT:!1},function(){this._cache=new o},{getWebGLTexture:function(e){var t=this._cache;return t.use(e.__GLID__),t.miss("webgl_texture")&&t.put("webgl_texture",e.createTexture()),this.dynamic?this.update(e):t.isDirty()&&(this.update(e),t.fresh()),t.get("webgl_texture")},bind:function(){},unbind:function(){},dirty:function(){this._cache.dirtyAll()},update:function(e){},beforeUpdate:function(e){e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,this.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,this.unpackAlignment),this.fallBack()},fallBack:function(){var e=this.isPowerOfTwo();this.format===r.DEPTH_COMPONENT&&(this.useMipmap=!1),e&&this.useMipmap?(this.NPOT=!1,this._minFilterOriginal&&(this.minFilter=this._minFilterOriginal),this._magFilterOriginal&&(this.magFilter=this._magFilterOriginal),this._wrapSOriginal&&(this.wrapS=this._wrapSOriginal),this._wrapTOriginal&&(this.wrapT=this._wrapTOriginal)):(this.NPOT=!0,this._minFilterOriginal=this.minFilter,this._magFilterOriginal=this.magFilter,this._wrapSOriginal=this.wrapS,this._wrapTOriginal=this.wrapT,this.minFilter==r.NEAREST_MIPMAP_NEAREST||this.minFilter==r.NEAREST_MIPMAP_LINEAR?this.minFilter=r.NEAREST:this.minFilter!=r.LINEAR_MIPMAP_LINEAR&&this.minFilter!=r.LINEAR_MIPMAP_NEAREST||(this.minFilter=r.LINEAR),this.wrapS=r.CLAMP_TO_EDGE,this.wrapT=r.CLAMP_TO_EDGE)},nextHighestPowerOfTwo:function(e){--e;for(var t=1;t<32;t<<=1)e|=e>>t;return e+1},dispose:function(e){var t=this._cache;t.use(e.__GLID__);var n=t.get("webgl_texture");n&&e.deleteTexture(n),t.deleteContext(e.__GLID__)},isRenderable:function(){},isPowerOfTwo:function(){}});a.BYTE=r.BYTE,a.UNSIGNED_BYTE=r.UNSIGNED_BYTE,a.SHORT=r.SHORT,a.UNSIGNED_SHORT=r.UNSIGNED_SHORT,a.INT=r.INT,a.UNSIGNED_INT=r.UNSIGNED_INT,a.FLOAT=r.FLOAT,a.HALF_FLOAT=36193,a.UNSIGNED_INT_24_8_WEBGL=34042,a.DEPTH_COMPONENT=r.DEPTH_COMPONENT,a.DEPTH_STENCIL=r.DEPTH_STENCIL,a.ALPHA=r.ALPHA,a.RGB=r.RGB,a.RGBA=r.RGBA,a.LUMINANCE=r.LUMINANCE,a.LUMINANCE_ALPHA=r.LUMINANCE_ALPHA,a.COMPRESSED_RGB_S3TC_DXT1_EXT=33776,a.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777,a.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778,a.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779,a.NEAREST=r.NEAREST,a.LINEAR=r.LINEAR,a.NEAREST_MIPMAP_NEAREST=r.NEAREST_MIPMAP_NEAREST,a.LINEAR_MIPMAP_NEAREST=r.LINEAR_MIPMAP_NEAREST,a.NEAREST_MIPMAP_LINEAR=r.NEAREST_MIPMAP_LINEAR,a.LINEAR_MIPMAP_LINEAR=r.LINEAR_MIPMAP_LINEAR,a.REPEAT=r.REPEAT,a.CLAMP_TO_EDGE=r.CLAMP_TO_EDGE,a.MIRRORED_REPEAT=r.MIRRORED_REPEAT,e.exports=a},function(e,t,n){var i=n(6),r=n(17),o=n(8),a=n(80),s=a.isPowerOfTwo,l=i.extend(function(){return{image:null,pixels:null,mipmaps:[]}},{update:function(e){e.bindTexture(e.TEXTURE_2D,this._cache.get("webgl_texture")),this.beforeUpdate(e);var t=this.format,n=this.type;e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,this.wrapS),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,this.wrapT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,this.magFilter),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,this.minFilter);var i=r.getExtension(e,"EXT_texture_filter_anisotropic");if(i&&this.anisotropic>1&&e.texParameterf(e.TEXTURE_2D,i.TEXTURE_MAX_ANISOTROPY_EXT,this.anisotropic),36193===n&&(r.getExtension(e,"OES_texture_half_float")||(n=o.FLOAT)),this.mipmaps.length)for(var a=this.width,s=this.height,l=0;l<this.mipmaps.length;l++){var c=this.mipmaps[l];this._updateTextureData(e,c,l,a,s,t,n),a/=2,s/=2}else this._updateTextureData(e,this,0,this.width,this.height,t,n),this.useMipmap&&!this.NPOT&&e.generateMipmap(e.TEXTURE_2D);e.bindTexture(e.TEXTURE_2D,null)},_updateTextureData:function(e,t,n,r,o,a,s){t.image?e.texImage2D(e.TEXTURE_2D,n,a,a,s,t.image):a<=i.COMPRESSED_RGBA_S3TC_DXT5_EXT&&a>=i.COMPRESSED_RGB_S3TC_DXT1_EXT?e.compressedTexImage2D(e.TEXTURE_2D,n,a,r,o,0,t.pixels):e.texImage2D(e.TEXTURE_2D,n,a,r,o,0,a,s,t.pixels)},generateMipmap:function(e){this.useMipmap&&!this.NPOT&&(e.bindTexture(e.TEXTURE_2D,this._cache.get("webgl_texture")),e.generateMipmap(e.TEXTURE_2D))},isPowerOfTwo:function(){var e,t;return this.image?(e=this.image.width,t=this.image.height):(e=this.width,t=this.height),s(e)&&s(t)},isRenderable:function(){return this.image?"CANVAS"===this.image.nodeName||"VIDEO"===this.image.nodeName||this.image.complete:!(!this.width||!this.height)},bind:function(e){e.bindTexture(e.TEXTURE_2D,this.getWebGLTexture(e))},unbind:function(e){e.bindTexture(e.TEXTURE_2D,null)},load:function(e){var t=new Image,n=this;return t.onload=function(){n.dirty(),n.trigger("success",n),t.onload=null},t.onerror=function(){n.trigger("error",n),t.onerror=null},t.src=e,this.image=t,this}});e.exports=l},function(e,t){e.exports={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444}},function(t,r,o){"use strict";function n(){return{locations:{},attriblocations:{}}}function i(e,t,n){if(!e.getShaderParameter(t,e.COMPILE_STATUS))return[e.getShaderInfoLog(t),a(n)].join("\n")}function a(e){for(var t=e.split("\n"),n=0,i=t.length;n<i;n++)t[n]=n+1+": "+t[n];return t.join("\n")}var s=o(5),l=o(23),c=o(44),u=o(18),d=o(1),h=(o(17),d.mat2),p=d.mat3,f=d.mat4,g=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\w\,]+)?(\[.*?\])?\s*(:\s*([\S\s]+?))?;/g,m=/#define\s+(\w+)?(\s+[\w-.]+)?\s*;?\s*\n/g,v={bool:"1i",int:"1i",sampler2D:"t",samplerCube:"t",float:"1f",vec2:"2f",vec3:"3f",vec4:"4f",ivec2:"2i",ivec3:"3i",ivec4:"4i",mat2:"m2",mat3:"m3",mat4:"m4"},_={bool:function(){return!0},int:function(){return 0},float:function(){return 0},sampler2D:function(){return null},samplerCube:function(){return null},vec2:function(){return[0,0]},vec3:function(){return[0,0,0]},vec4:function(){return[0,0,0,0]},ivec2:function(){return[0,0]},ivec3:function(){return[0,0,0]},ivec4:function(){return[0,0,0,0]},mat2:function(){return h.create()},mat3:function(){return p.create()},mat4:function(){return f.create()},array:function(){return[]}},y=["POSITION","NORMAL","BINORMAL","TANGENT","TEXCOORD","TEXCOORD_0","TEXCOORD_1","COLOR","JOINT","WEIGHT"],x=["SKIN_MATRIX","VIEWPORT_SIZE","VIEWPORT","DEVICEPIXELRATIO","WINDOW_SIZE","NEAR","FAR","TIME"],b=["WORLD","VIEW","PROJECTION","WORLDVIEW","VIEWPROJECTION","WORLDVIEWPROJECTION","WORLDINVERSE","VIEWINVERSE","PROJECTIONINVERSE","WORLDVIEWINVERSE","VIEWPROJECTIONINVERSE","WORLDVIEWPROJECTIONINVERSE","WORLDTRANSPOSE","VIEWTRANSPOSE","PROJECTIONTRANSPOSE","WORLDVIEWTRANSPOSE","VIEWPROJECTIONTRANSPOSE","WORLDVIEWPROJECTIONTRANSPOSE","WORLDINVERSETRANSPOSE","VIEWINVERSETRANSPOSE","PROJECTIONINVERSETRANSPOSE","WORLDVIEWINVERSETRANSPOSE","VIEWPROJECTIONINVERSETRANSPOSE","WORLDVIEWPROJECTIONINVERSETRANSPOSE"],w={},C=s.extend(function(){return{vertex:"",fragment:"",precision:"highp",attribSemantics:{},matrixSemantics:{},uniformSemantics:{},matrixSemanticKeys:[],uniformTemplates:{},attributeTemplates:{},vertexDefines:{},fragmentDefines:{},extensions:["OES_standard_derivatives","EXT_shader_texture_lod"],lightGroup:0,lightNumber:{},_textureSlot:0,_attacheMaterialNumber:0,_uniformList:[],_textureStatus:{},_vertexProcessed:"",_fragmentProcessed:"",_currentLocationsMap:{}}},function(){this._cache=new c,this._codeDirty=!0,this._updateShaderString()},{isEqual:function(e){return!(!e||(this===e?this._codeDirty:(e._codeDirty&&e._updateShaderString(),this._codeDirty&&this._updateShaderString(),e._vertexProcessed!==this._vertexProcessed||e._fragmentProcessed!==this._fragmentProcessed)))},setVertex:function(e){this.vertex=e,this._updateShaderString(),this.dirty()},setFragment:function(e){this.fragment=e,this._updateShaderString(),this.dirty()},bind:function(e){var t=this._cache;if(t.use(e.__GLID__,n),this._currentLocationsMap=t.get("locations"),this._textureSlot=0,this._codeDirty&&this._updateShaderString(),t.isDirty("program")){var i=this._buildProgram(e,this._vertexProcessed,this._fragmentProcessed);if(t.fresh("program"),i)return i}e.useProgram(t.get("program"))},dirty:function(){var e=this._cache;this._codeDirty=!0,e.dirtyAll("program");for(var t=0;t<e._caches.length;t++)if(e._caches[t]){var n=e._caches[t];n.locations={},n.attriblocations={}}},_updateShaderString:function(e){this.vertex===this._vertexPrev&&this.fragment===this._fragmentPrev||(this._parseImport(),this.attribSemantics={},this.matrixSemantics={},this._textureStatus={},this._parseUniforms(),this._parseAttributes(),this._parseDefines(),this._vertexPrev=this.vertex,this._fragmentPrev=this.fragment),this._addDefineExtensionAndPrecision(e),this._vertexProcessed=this._unrollLoop(this._vertexProcessed,this.vertexDefines),this._fragmentProcessed=this._unrollLoop(this._fragmentProcessed,this.fragmentDefines),this._codeDirty=!1},define:function(e,t,n){var i=this.vertexDefines,r=this.fragmentDefines;"vertex"!==e&&"fragment"!==e&&"both"!==e&&arguments.length<3&&(n=t,t=e,e="both"),n=null!=n?n:null,"vertex"!==e&&"both"!==e||i[t]!==n&&(i[t]=n,this.dirty()),"fragment"!==e&&"both"!==e||r[t]!==n&&(r[t]=n,"both"!==e&&this.dirty())},undefine:function(e,t){"vertex"!==e&&"fragment"!==e&&"both"!==e&&arguments.length<2&&(t=e,e="both"),"vertex"!==e&&"both"!==e||this.isDefined("vertex",t)&&(delete this.vertexDefines[t],this.dirty()),"fragment"!==e&&"both"!==e||this.isDefined("fragment",t)&&(delete this.fragmentDefines[t],"both"!==e&&this.dirty())},isDefined:function(e,t){switch(e){case"vertex":return void 0!==this.vertexDefines[t];case"fragment":return void 0!==this.fragmentDefines[t]}},getDefine:function(e,t){switch(e){case"vertex":return this.vertexDefines[t];case"fragment":return this.fragmentDefines[t]}},enableTexture:function(e){if(e instanceof Array)for(var t=0;t<e.length;t++)this.enableTexture(e[t]);else{var n=this._textureStatus[e];n&&(n.enabled||(n.enabled=!0,this.dirty()))}},enableTexturesAll:function(){var e=this._textureStatus;for(var t in e)e[t].enabled=!0;this.dirty()},disableTexture:function(e){if(e instanceof Array)for(var t=0;t<e.length;t++)this.disableTexture(e[t]);else{var n=this._textureStatus[e];n&&(!n.enabled||(n.enabled=!1,this.dirty()))}},disableTexturesAll:function(){var e=this._textureStatus;for(var t in e)e[t].enabled=!1;this.dirty()},isTextureEnabled:function(e){var t=this._textureStatus;return t[e]&&t[e].enabled},getEnabledTextures:function(){var e=[],t=this._textureStatus;for(var n in t)t[n].enabled&&e.push(n);return e},hasUniform:function(e){var t=this._currentLocationsMap[e];return null!==t&&void 0!==t},currentTextureSlot:function(){return this._textureSlot},resetTextureSlot:function(e){this._textureSlot=e||0},useCurrentTextureSlot:function(e,t){var n=this._textureSlot;return this.useTextureSlot(e,t,n),this._textureSlot++,n},useTextureSlot:function(e,t,n){t&&(e.activeTexture(e.TEXTURE0+n),t.isRenderable()?t.bind(e):t.unbind(e))},setUniform:function(e,t,n,i){var r=this._currentLocationsMap,o=r[n];if(null===o||void 0===o)return!1;switch(t){case"m4":e.uniformMatrix4fv(o,!1,i);break;case"2i":e.uniform2i(o,i[0],i[1]);break;case"2f":e.uniform2f(o,i[0],i[1]);break;case"3i":e.uniform3i(o,i[0],i[1],i[2]);break;case"3f":e.uniform3f(o,i[0],i[1],i[2]);break;case"4i":e.uniform4i(o,i[0],i[1],i[2],i[3]);break;case"4f":e.uniform4f(o,i[0],i[1],i[2],i[3]);break;case"1i":e.uniform1i(o,i);break;case"1f":e.uniform1f(o,i);break;case"1fv":e.uniform1fv(o,i);break;case"1iv":e.uniform1iv(o,i);break;case"2iv":e.uniform2iv(o,i);break;case"2fv":e.uniform2fv(o,i);break;case"3iv":e.uniform3iv(o,i);break;case"3fv":e.uniform3fv(o,i);break;case"4iv":e.uniform4iv(o,i);break;case"4fv":e.uniform4fv(o,i);break;case"m2":case"m2v":e.uniformMatrix2fv(o,!1,i);break;case"m3":case"m3v":e.uniformMatrix3fv(o,!1,i);break;case"m4v":if(i instanceof Array){for(var a=new u.Float32Array(16*i.length),s=0,l=0;l<i.length;l++)for(var c=i[l],d=0;d<16;d++)a[s++]=c[d];e.uniformMatrix4fv(o,!1,a)}else i instanceof u.Float32Array&&e.uniformMatrix4fv(o,!1,i)}return!0},setUniformOfSemantic:function(e,t,n){var i=this.uniformSemantics[t];return!!i&&this.setUniform(e,i.type,i.symbol,n)},enableAttributes:function(e,t,n){var i,r=this._cache.get("program"),o=this._cache.get("attriblocations");(i=n?n.__enabledAttributeList:w[e.__GLID__])||(i=n?n.__enabledAttributeList=[]:w[e.__GLID__]=[]);for(var a=[],s=0;s<t.length;s++){var l=t[s];if(this.attributeTemplates[l]){var c=o[l];if(void 0===c){if(-1===(c=e.getAttribLocation(r,l))){a[s]=-1;continue}o[l]=c}a[s]=c,i[c]?i[c]=2:i[c]=1}else a[s]=-1}for(var s=0;s<i.length;s++)switch(i[s]){case 1:e.enableVertexAttribArray(s),i[s]=3;break;case 2:i[s]=3;break;case 3:e.disableVertexAttribArray(s),i[s]=0}return a},_parseImport:function(){this._vertexProcessedWithoutDefine=C.parseImport(this.vertex),this._fragmentProcessedWithoutDefine=C.parseImport(this.fragment)},_addDefineExtensionAndPrecision:function(e){e=e||this.extensions;for(var t=[],n=0;n<e.length;n++)t.push("#extension GL_"+e[n]+" : enable");var i=this._getDefineStr(this.vertexDefines);this._vertexProcessed=i+"\n"+this._vertexProcessedWithoutDefine;var i=this._getDefineStr(this.fragmentDefines),r=i+"\n"+this._fragmentProcessedWithoutDefine;this._fragmentProcessed=t.join("\n")+"\n"+["precision",this.precision,"float"].join(" ")+";\n"+["precision",this.precision,"int"].join(" ")+";\n"+["precision",this.precision,"sampler2D"].join(" ")+";\n"+r},_getDefineStr:function(e){var t=this.lightNumber,n=this._textureStatus,i=[];for(var r in t){var o=t[r];o>0&&i.push("#define "+r.toUpperCase()+"_COUNT "+o)}for(var a in n)n[a].enabled&&i.push("#define "+a.toUpperCase()+"_ENABLED");for(var a in e){var s=e[a];null===s?i.push("#define "+a):i.push("#define "+a+" "+s.toString())}return i.join("\n")},_unrollLoop:function(e,t){function r(e,i,r,o){var a="";isNaN(i)&&(i=i in t?t[i]:n[i]),isNaN(r)&&(r=r in t?t[r]:n[r]);for(var s=parseInt(i);s<parseInt(r);s++)a+="{"+o.replace(/float\s*\(\s*_idx_\s*\)/g,s.toFixed(1)).replace(/_idx_/g,s)+"}";return a}var n={};for(var i in this.lightNumber)n[i+"_COUNT"]=this.lightNumber[i];return e.replace(/for\s*?\(int\s*?_idx_\s*\=\s*([\w-]+)\;\s*_idx_\s*<\s*([\w-]+);\s*_idx_\s*\+\+\s*\)\s*\{\{([\s\S]+?)(?=\}\})\}\}/g,r)},_parseUniforms:function(){function e(e,r,o,a,s,l){if(r&&o){var c,u=v[r],d=!0;if(u){if(n._uniformList.push(o),"sampler2D"!==r&&"samplerCube"!==r||(n._textureStatus[o]={enabled:!1,shaderType:i}),a&&(u+="v"),l)if(y.indexOf(l)>=0)n.attribSemantics[l]={symbol:o,type:u},d=!1;else if(b.indexOf(l)>=0){var h=!1,p=l;l.match(/TRANSPOSE$/)&&(h=!0,p=l.slice(0,-9)),n.matrixSemantics[l]={symbol:o,type:u,isTranspose:h,semanticNoTranspose:p},d=!1}else if(x.indexOf(l)>=0)n.uniformSemantics[l]={symbol:o,type:u},d=!1;else if("unconfigurable"===l)d=!1;else{if(!(c=n._parseDefaultValue(r,l)))throw new Error('Unkown semantic "'+l+'"');l=""}d&&(t[o]={type:u,value:a?_.array:c||_[r],semantic:l||null})}return["uniform",r,o,a].join(" ")+";\n"}}var t={},n=this,i="vertex";this._uniformList=[],this._vertexProcessedWithoutDefine=this._vertexProcessedWithoutDefine.replace(g,e),i="fragment",this._fragmentProcessedWithoutDefine=this._fragmentProcessedWithoutDefine.replace(g,e),n.matrixSemanticKeys=Object.keys(this.matrixSemantics),this.uniformTemplates=t},_parseDefaultValue:function(e,t){var n=/\[\s*(.*)\s*\]/;if("vec2"!==e&&"vec3"!==e&&"vec4"!==e)return"bool"===e?function(){return"true"===t.toLowerCase()}:"float"===e?function(){return parseFloat(t)}:"int"===e?function(){return parseInt(t)}:void 0;var i=n.exec(t)[1];if(i){var r=i.split(/\s*,\s*/);return function(){return new u.Float32Array(r)}}},createUniforms:function(){var e={};for(var t in this.uniformTemplates){var n=this.uniformTemplates[t];e[t]={type:n.type,value:n.value()}}return e},attached:function(){this._attacheMaterialNumber++},detached:function(){this._attacheMaterialNumber--},isAttachedToAny:function(){return 0!==this._attacheMaterialNumber},_parseAttributes:function(){function e(e,i,r,o,a){if(i&&r){var s=1;switch(i){case"vec4":s=4;break;case"vec3":s=3;break;case"vec2":s=2;break;case"float":s=1}if(t[r]={type:"float",size:s,semantic:a||null},a){if(y.indexOf(a)<0)throw new Error('Unkown semantic "'+a+'"');n.attribSemantics[a]={symbol:r,type:i}}}return["attribute",i,r].join(" ")+";\n"}var t={},n=this;this._vertexProcessedWithoutDefine=this._vertexProcessedWithoutDefine.replace(/attribute\s+(float|int|vec2|vec3|vec4)\s+(\w*)\s*(:\s*(\w+))?;/g,e),this.attributeTemplates=t},_parseDefines:function(){function e(e,i,r){var o="vertex"===n?t.vertexDefines:t.fragmentDefines;return o[i]||(o[i]="false"!=r&&("true"==r||(r?parseFloat(r):null))),""}var t=this,n="vertex";this._vertexProcessedWithoutDefine=this._vertexProcessedWithoutDefine.replace(m,e),n="fragment",this._fragmentProcessedWithoutDefine=this._fragmentProcessedWithoutDefine.replace(m,e)},_buildProgram:function(e,t,n){var r=this._cache;r.get("program")&&e.deleteProgram(r.get("program"));var o=e.createProgram(),a=e.createShader(e.VERTEX_SHADER);e.shaderSource(a,t),e.compileShader(a);var s=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(s,n),e.compileShader(s);var l=i(e,a,t);if(l)return l;if(l=i(e,s,n))return l;if(e.attachShader(o,a),e.attachShader(o,s),this.attribSemantics.POSITION)e.bindAttribLocation(o,0,this.attribSemantics.POSITION.symbol);else{var c=Object.keys(this.attributeTemplates);e.bindAttribLocation(o,0,c[0])}if(e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS))return"Could not link program\nVALIDATE_STATUS: "+e.getProgramParameter(o,e.VALIDATE_STATUS)+", gl error ["+e.getError()+"]";for(var u=0;u<this._uniformList.length;u++){var d=this._uniformList[u];r.get("locations")[d]=e.getUniformLocation(o,d)}e.deleteShader(a),e.deleteShader(s),r.put("program",o)},clone:function(){var e=new C({vertex:this.vertex,fragment:this.fragment,vertexDefines:l.clone(this.vertexDefines),fragmentDefines:l.clone(this.fragmentDefines)});for(var t in this._textureStatus)e._textureStatus[t]=l.clone(this._textureStatus[t]);return e},dispose:function(e){var t=this._cache;t.use(e.__GLID__);var n=t.get("program");n&&e.deleteProgram(n),t.deleteContext(e.__GLID__),this._locations={}}});C.parseImport=function(e){return e=e.replace(/(@import)\s*([0-9a-zA-Z_\-\.]*)/g,function(e,t,n){var e=C.source(n);return e?C.parseImport(e):""})},C.import=function(e){e.replace(/(@export)\s*([0-9a-zA-Z_\-\.]*)\s*\n([\s\S]*?)@end/g,function(e,t,n,i){var i=i.replace(/(^[\s\t\xa0\u3000]+)|([\u3000\xa0\s\t]+\x24)/g,"");if(i){for(var r,o=n.split("."),a=C.codes,s=0;s<o.length-1;)r=o[s++],a[r]||(a[r]={}),a=a[r];r=o[s],a[r]=i}return i})},C.codes={},C.source=function(e){for(var t=e.split("."),n=C.codes,i=0;n&&i<t.length;)n=n[t[i++]];return"string"!=typeof n?"":n},t.exports=C},function(e,t,n){"use strict";var i=n(1),r=n(3),o=i.mat4,a=i.vec3,s=i.mat3,l=i.quat,c=function(){this._axisX=new r,this._axisY=new r,this._axisZ=new r,this._array=o.create(),this._dirty=!0};c.prototype={constructor:c,setArray:function(e){for(var t=0;t<this._array.length;t++)this._array[t]=e[t];return this._dirty=!0,this},adjoint:function(){return o.adjoint(this._array,this._array),this._dirty=!0,this},clone:function(){return(new c).copy(this)},copy:function(e){return o.copy(this._array,e._array),this._dirty=!0,this},determinant:function(){return o.determinant(this._array)},fromQuat:function(e){return o.fromQuat(this._array,e._array),this._dirty=!0,this},fromRotationTranslation:function(e,t){return o.fromRotationTranslation(this._array,e._array,t._array),this._dirty=!0,this},fromMat2d:function(e){return c.fromMat2d(this,e),this},frustum:function(e,t,n,i,r,a){return o.frustum(this._array,e,t,n,i,r,a),this._dirty=!0,this},identity:function(){return o.identity(this._array),this._dirty=!0,this},invert:function(){return o.invert(this._array,this._array),this._dirty=!0,this},lookAt:function(e,t,n){return o.lookAt(this._array,e._array,t._array,n._array),this._dirty=!0,this},mul:function(e){return o.mul(this._array,this._array,e._array),this._dirty=!0,this},mulLeft:function(e){return o.mul(this._array,e._array,this._array),this._dirty=!0,this},multiply:function(e){return o.multiply(this._array,this._array,e._array),this._dirty=!0,this},multiplyLeft:function(e){return o.multiply(this._array,e._array,this._array),this._dirty=!0,this},ortho:function(e,t,n,i,r,a){return o.ortho(this._array,e,t,n,i,r,a),this._dirty=!0,this},perspective:function(e,t,n,i){return o.perspective(this._array,e,t,n,i),this._dirty=!0,this},rotate:function(e,t){return o.rotate(this._array,this._array,e,t._array),this._dirty=!0,this},rotateX:function(e){return o.rotateX(this._array,this._array,e),this._dirty=!0,this},rotateY:function(e){return o.rotateY(this._array,this._array,e),this._dirty=!0,this},rotateZ:function(e){return o.rotateZ(this._array,this._array,e),this._dirty=!0,this},scale:function(e){return o.scale(this._array,this._array,e._array),this._dirty=!0,this},translate:function(e){return o.translate(this._array,this._array,e._array),this._dirty=!0,this},transpose:function(){return o.transpose(this._array,this._array),this._dirty=!0,this},decomposeMatrix:function(){var e=a.create(),t=a.create(),n=a.create(),i=s.create();return function(r,o,c){var u=this._array;a.set(e,u[0],u[1],u[2]),a.set(t,u[4],u[5],u[6]),a.set(n,u[8],u[9],u[10]);var d=a.length(e),h=a.length(t),p=a.length(n);r&&(r.x=d,r.y=h,r.z=p,r._dirty=!0),c.set(u[12],u[13],u[14]),s.fromMat4(i,u),i[0]/=d,i[1]/=d,i[2]/=d,i[3]/=h,i[4]/=h,i[5]/=h,i[6]/=p,i[7]/=p,i[8]/=p,l.fromMat3(o._array,i),l.normalize(o._array,o._array),o._dirty=!0,c._dirty=!0}}(),toString:function(){return"["+Array.prototype.join.call(this._array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this._array)}};var u=Object.defineProperty;if(u){var d=c.prototype;u(d,"z",{get:function(){var e=this._array;return this._axisZ.set(e[8],e[9],e[10]),this._axisZ},set:function(e){var t=this._array;e=e._array,t[8]=e[0],t[9]=e[1],t[10]=e[2],this._dirty=!0}}),u(d,"y",{get:function(){var e=this._array;return this._axisY.set(e[4],e[5],e[6]),this._axisY},set:function(e){var t=this._array;e=e._array,t[4]=e[0],t[5]=e[1],t[6]=e[2],this._dirty=!0}}),u(d,"x",{get:function(){var e=this._array;return this._axisX.set(e[0],e[1],e[2]),this._axisX},set:function(e){var t=this._array;e=e._array,t[0]=e[0],t[1]=e[1],t[2]=e[2],this._dirty=!0}})}c.adjoint=function(e,t){return o.adjoint(e._array,t._array),e._dirty=!0,e},c.copy=function(e,t){return o.copy(e._array,t._array),e._dirty=!0,e},c.determinant=function(e){return o.determinant(e._array)},c.identity=function(e){return o.identity(e._array),e._dirty=!0,e},c.ortho=function(e,t,n,i,r,a,s){return o.ortho(e._array,t,n,i,r,a,s),e._dirty=!0,e},c.perspective=function(e,t,n,i,r){return o.perspective(e._array,t,n,i,r),e._dirty=!0,e},c.lookAt=function(e,t,n,i){return o.lookAt(e._array,t._array,n._array,i._array),e._dirty=!0,e},c.invert=function(e,t){return o.invert(e._array,t._array),e._dirty=!0,e},c.mul=function(e,t,n){return o.mul(e._array,t._array,n._array),e._dirty=!0,e},c.multiply=c.mul,c.fromQuat=function(e,t){return o.fromQuat(e._array,t._array),e._dirty=!0,e},c.fromRotationTranslation=function(e,t,n){return o.fromRotationTranslation(e._array,t._array,n._array),e._dirty=!0,e},c.fromMat2d=function(e,t){e._dirty=!0;var t=t._array,e=e._array;return e[0]=t[0],e[4]=t[2],e[12]=t[4],e[1]=t[1],e[5]=t[3],e[13]=t[5],e},c.rotate=function(e,t,n,i){return o.rotate(e._array,t._array,n,i._array),e._dirty=!0,e},c.rotateX=function(e,t,n){return o.rotateX(e._array,t._array,n),e._dirty=!0,e},c.rotateY=function(e,t,n){return o.rotateY(e._array,t._array,n),e._dirty=!0,e},c.rotateZ=function(e,t,n){return o.rotateZ(e._array,t._array,n),e._dirty=!0,e},c.scale=function(e,t,n){return o.scale(e._array,t._array,n._array),e._dirty=!0,e},c.transpose=function(e,t){return o.transpose(e._array,t._array),e._dirty=!0,e},c.translate=function(e,t,n){return o.translate(e._array,t._array,n._array),e._dirty=!0,e},e.exports=c},function(e,t,n){"use strict";var i=n(5),r=n(6),o=n(20),a=n(17),s=n(8),l=n(44),c=s.FRAMEBUFFER,u=s.RENDERBUFFER,d=s.DEPTH_ATTACHMENT,h=s.COLOR_ATTACHMENT0,p=i.extend({depthBuffer:!0,viewport:null,_width:0,_height:0,_textures:null,_boundRenderer:null},function(){this._cache=new l,this._textures={}},{getTextureWidth:function(){return this._width},getTextureHeight:function(){return this._height},bind:function(e){if(!e.__currentFrameBuffer||e.__currentFrameBuffer!==this){e.__currentFrameBuffer=this;var t=e.gl;t.bindFramebuffer(c,this._getFrameBufferGL(t)),this._boundRenderer=e;var n=this._cache;n.put("viewport",e.viewport);var i,r,o=!1;for(var a in this._textures){o=!0;var s=this._textures[a];s&&(i=s.texture.width,r=s.texture.height,this._doAttach(t,s.texture,a,s.target))}this._width=i,this._height=r,!o&&this.depthBuffer,this.viewport?e.setViewport(this.viewport):e.setViewport(0,0,i,r,1);var l=n.get("attached_textures");if(l)for(var a in l)if(!this._textures[a]){var h=l[a];this._doDetach(t,a,h)}if(!n.get("depthtexture_attached")&&this.depthBuffer){n.miss("renderbuffer")&&n.put("renderbuffer",t.createRenderbuffer());var p=n.get("renderbuffer");i===n.get("renderbuffer_width")&&r===n.get("renderbuffer_height")||(t.bindRenderbuffer(u,p),t.renderbufferStorage(u,t.DEPTH_COMPONENT16,i,r),n.put("renderbuffer_width",i),n.put("renderbuffer_height",r),t.bindRenderbuffer(u,null)),n.get("renderbuffer_attached")||(t.framebufferRenderbuffer(c,d,u,p),n.put("renderbuffer_attached",!0))}}},unbind:function(e){e.__currentFrameBuffer=null;var t=e.gl;t.bindFramebuffer(c,null),this._boundRenderer=null,this._cache.use(t.__GLID__);var n=this._cache.get("viewport");n&&e.setViewport(n),this.updateMipmap(t)},updateMipmap:function(e){for(var t in this._textures){var n=this._textures[t];if(n){var i=n.texture;if(!i.NPOT&&i.useMipmap&&i.minFilter===r.LINEAR_MIPMAP_LINEAR){var a=i instanceof o?s.TEXTURE_CUBE_MAP:s.TEXTURE_2D;e.bindTexture(a,i.getWebGLTexture(e)),e.generateMipmap(a),e.bindTexture(a,null)}}}},checkStatus:function(e){return e.checkFramebufferStatus(c)},_getFrameBufferGL:function(e){var t=this._cache;return t.use(e.__GLID__),t.miss("framebuffer")&&t.put("framebuffer",e.createFramebuffer()),t.get("framebuffer")},attach:function(e,t,n){if(!e.width)throw new Error("The texture attached to color buffer is not a valid.");t=t||h,n=n||s.TEXTURE_2D;var i,r=this._boundRenderer,o=r&&r.gl;if(o){var a=this._cache;a.use(o.__GLID__),i=a.get("attached_textures")}var l=this._textures[t];if(!l||l.target!==n||l.texture!==e||!i||null==i[t]){var c=!0;o&&(c=this._doAttach(o,e,t,n),this.viewport||r.setViewport(0,0,e.width,e.height,1)),c&&(this._textures[t]=this._textures[t]||{},this._textures[t].texture=e,this._textures[t].target=n)}},_doAttach:function(e,t,n,i){var r=t.getWebGLTexture(e),o=this._cache.get("attached_textures");if(o&&o[n]){var l=o[n];if(l.texture===t&&l.target===i)return}n=+n;var h=!0;if((n===d||n===s.DEPTH_STENCIL_ATTACHMENT)&&(a.getExtension(e,"WEBGL_depth_texture")||(h=!1),t.format!==s.DEPTH_COMPONENT&&t.format!==s.DEPTH_STENCIL&&(h=!1),h)){var p=this._cache.get("renderbuffer");p&&(e.framebufferRenderbuffer(c,d,u,null),e.deleteRenderbuffer(p),this._cache.put("renderbuffer",!1)),this._cache.put("renderbuffer_attached",!1),this._cache.put("depthtexture_attached",!0)}return e.framebufferTexture2D(c,n,i,r,0),o||(o={},this._cache.put("attached_textures",o)),o[n]=o[n]||{},o[n].texture=t,o[n].target=i,h},_doDetach:function(e,t,n){e.framebufferTexture2D(c,t,n,null,0);var i=this._cache.get("attached_textures");i&&i[t]&&(i[t]=null),t!==d&&t!==s.DEPTH_STENCIL_ATTACHMENT||this._cache.put("depthtexture_attached",!1)},detach:function(e,t){if(this._textures[e]=null,this._boundRenderer){var n=this._boundRenderer.gl;this._cache.use(n.__GLID__),this._doDetach(n,e,t)}},dispose:function(e){var t=this._cache;t.use(e.__GLID__);var n=t.get("renderbuffer");n&&e.deleteRenderbuffer(n);var i=t.get("framebuffer");i&&e.deleteFramebuffer(i),t.deleteContext(e.__GLID__),this._textures={}}});p.DEPTH_ATTACHMENT=d,p.COLOR_ATTACHMENT0=h,p.STENCIL_ATTACHMENT=s.STENCIL_ATTACHMENT,p.DEPTH_STENCIL_ATTACHMENT=s.DEPTH_STENCIL_ATTACHMENT,e.exports=p},function(e,t,i){"use strict";function n(e){return"attr_"+e}var r=i(176),o=i(13),a=i(1),s=i(18),l=i(8),c=a.mat4,u=a.vec3,d=r.StaticAttribute,h=u.create,p=u.add,f=u.set,g=r.extend(function(){return{attributes:{position:new d("position","float",3,"POSITION"),texcoord0:new d("texcoord0","float",2,"TEXCOORD_0"),texcoord1:new d("texcoord1","float",2,"TEXCOORD_1"),normal:new d("normal","float",3,"NORMAL"),tangent:new d("tangent","float",4,"TANGENT"),color:new d("color","float",4,"COLOR"),weight:new d("weight","float",3,"WEIGHT"),joint:new d("joint","float",4,"JOINT"),barycentric:new d("barycentric","float",3,null)},hint:l.STATIC_DRAW,indices:null,_normalType:"vertex",_enabledAttributes:null}},{updateBoundingBox:function(){var e=this.boundingBox;e||(e=this.boundingBox=new o);var t=this.attributes.position.value;if(t&&t.length){var n=e.min,i=e.max,r=n._array,a=i._array;u.set(r,t[0],t[1],t[2]),u.set(a,t[0],t[1],t[2]);for(var s=3;s<t.length;){var l=t[s++],c=t[s++],d=t[s++];l<r[0]&&(r[0]=l),c<r[1]&&(r[1]=c),d<r[2]&&(r[2]=d),l>a[0]&&(a[0]=l),c>a[1]&&(a[1]=c),d>a[2]&&(a[2]=d)}n._dirty=!0,i._dirty=!0}},dirty:function(){for(var e=this.getEnabledAttributes(),t=0;t<e.length;t++)this.dirtyAttribute(e[t]);this.dirtyIndices(),this._enabledAttributes=null},dirtyIndices:function(){this._cache.dirtyAll("indices")},dirtyAttribute:function(e){this._cache.dirtyAll(n(e)),this._cache.dirtyAll("attributes")},getTriangleIndices:function(e,t){if(e<this.triangleCount&&e>=0){t||(t=h());var n=this.indices;return t[0]=n[3*e],t[1]=n[3*e+1],t[2]=n[3*e+2],t}},setTriangleIndices:function(e,t){var n=this.indices;n[3*e]=t[0],n[3*e+1]=t[1],n[3*e+2]=t[2]},isUseIndices:function(){return this.indices},initIndicesFromArray:function(e){var t,n=this.vertexCount>65535?s.Uint32Array:s.Uint16Array;if(e[0]&&e[0].length){var i=0;t=new n(3*e.length);for(var r=0;r<e.length;r++)for(var o=0;o<3;o++)t[i++]=e[r][o]}else t=new n(e);this.indices=t},createAttribute:function(e,t,n,i){var r=new d(e,t,n,i);return this.attributes[e]&&this.removeAttribute(e),this.attributes[e]=r,this._attributeList.push(e),r},removeAttribute:function(e){var t=this._attributeList,n=t.indexOf(e);return n>=0&&(t.splice(n,1),delete this.attributes[e],!0)},getEnabledAttributes:function(){var e=this._enabledAttributes,t=this._attributeList;if(e)return e;for(var n=[],i=this.vertexCount,r=0;r<t.length;r++){var o=t[r],a=this.attributes[o];a.value&&a.value.length===i*a.size&&n.push(o)}return this._enabledAttributes=n,n},getBufferChunks:function(e){var t=this._cache;t.use(e.__GLID__);var i=t.isDirty("attributes"),r=t.isDirty("indices");if(i||r){this._updateBuffer(e,i,r);for(var o=this.getEnabledAttributes(),a=0;a<o.length;a++)t.fresh(n(o[a]));t.fresh("attributes"),t.fresh("indices")}return t.get("chunks")},_updateBuffer:function(e,t,i){var o=this._cache,a=o.get("chunks"),s=!1;a||(a=[],a[0]={attributeBuffers:[],indicesBuffer:null},o.put("chunks",a),s=!0);var l=a[0],c=l.attributeBuffers,u=l.indicesBuffer;if(t||s){var d=this.getEnabledAttributes(),h={};if(!s)for(var p=0;p<c.length;p++)h[c[p].name]=c[p];for(var f=0;f<d.length;f++){var g,m=d[f],v=this.attributes[m];s||(g=h[m]);var _;_=g?g.buffer:e.createBuffer(),o.isDirty(n(m))&&(e.bindBuffer(e.ARRAY_BUFFER,_),e.bufferData(e.ARRAY_BUFFER,v.value,this.hint)),c[f]=new r.AttributeBuffer(m,v.type,_,v.size,v.semantic)}for(var p=f;p<c.length;p++)e.deleteBuffer(c[p].buffer);c.length=f}this.isUseIndices()&&(i||s)&&(u||(u=new r.IndicesBuffer(e.createBuffer()),l.indicesBuffer=u),u.count=this.indices.length,e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,u.buffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,this.hint))},generateVertexNormals:function(){if(this.vertexCount){var e=this.indices,t=this.attributes,n=t.position.value,i=t.normal.value;if(i&&i.length===n.length)for(var r=0;r<i.length;r++)i[r]=0;else i=t.normal.value=new s.Float32Array(n.length);for(var o=h(),a=h(),l=h(),c=h(),d=h(),p=h(),g=0;g<e.length;){var m=e[g++],v=e[g++],_=e[g++];f(o,n[3*m],n[3*m+1],n[3*m+2]),f(a,n[3*v],n[3*v+1],n[3*v+2]),f(l,n[3*_],n[3*_+1],n[3*_+2]),u.sub(c,o,a),u.sub(d,a,l),u.cross(p,c,d);for(var r=0;r<3;r++)i[3*m+r]=i[3*m+r]+p[r],i[3*v+r]=i[3*v+r]+p[r],i[3*_+r]=i[3*_+r]+p[r]}for(var r=0;r<i.length;)f(p,i[r],i[r+1],i[r+2]),u.normalize(p,p),i[r++]=p[0],i[r++]=p[1],i[r++]=p[2];this.dirty()}},generateFaceNormals:function(){if(this.vertexCount){this.isUniqueVertex()||this.generateUniqueVertex();var e=this.indices,t=this.attributes,n=t.position.value,i=t.normal.value,r=h(),o=h(),a=h(),s=h(),l=h(),c=h();i||(i=t.normal.value=new Float32Array(n.length));for(var d=0;d<e.length;){var p=e[d++],g=e[d++],m=e[d++];f(r,n[3*p],n[3*p+1],n[3*p+2]),f(o,n[3*g],n[3*g+1],n[3*g+2]),f(a,n[3*m],n[3*m+1],n[3*m+2]),u.sub(s,r,o),u.sub(l,o,a),u.cross(c,s,l),u.normalize(c,c);for(var v=0;v<3;v++)i[3*p+v]=c[v],i[3*g+v]=c[v],i[3*m+v]=c[v]}this.dirty()}},generateTangents:function(){if(this.vertexCount){var e=this.vertexCount,t=this.attributes;t.tangent.value||(t.tangent.value=new Float32Array(4*e));for(var n=t.texcoord0.value,i=t.position.value,r=t.tangent.value,o=t.normal.value,a=[],s=[],l=0;l<e;l++)a[l]=[0,0,0],s[l]=[0,0,0];for(var c=[0,0,0],d=[0,0,0],f=this.indices,l=0;l<f.length;){var g=f[l++],m=f[l++],v=f[l++],_=n[2*g],y=n[2*m],x=n[2*v],b=n[2*g+1],w=n[2*m+1],C=n[2*v+1],S=i[3*g],T=i[3*m],A=i[3*v],M=i[3*g+1],E=i[3*m+1],I=i[3*v+1],D=i[3*g+2],k=i[3*m+2],L=i[3*v+2],N=T-S,P=A-S,O=E-M,R=I-M,z=k-D,F=L-D,B=y-_,H=x-_,V=w-b,W=C-b,U=1/(B*W-V*H);c[0]=(W*N-V*P)*U,c[1]=(W*O-V*R)*U,c[2]=(W*z-V*F)*U,d[0]=(B*P-H*N)*U,d[1]=(B*R-H*O)*U,d[2]=(B*F-H*z)*U,p(a[g],a[g],c),p(a[m],a[m],c),p(a[v],a[v],c),p(s[g],s[g],d),p(s[m],s[m],d),p(s[v],s[v],d)}for(var $=h(),G=h(),q=h(),l=0;l<e;l++){q[0]=o[3*l],q[1]=o[3*l+1],q[2]=o[3*l+2];var j=a[l];u.scale($,q,u.dot(q,j)),u.sub($,j,$),u.normalize($,$),u.cross(G,q,j),r[4*l]=$[0],r[4*l+1]=$[1],r[4*l+2]=$[2],r[4*l+3]=u.dot(G,s[l])<0?-1:1}this.dirty()}},isUniqueVertex:function(){return!this.isUseIndices()||this.vertexCount===this.indices.length},generateUniqueVertex:function(){if(this.vertexCount){for(var e=[],t=0,n=this.vertexCount;t<n;t++)e[t]=0;this.indices.length>65535&&(this.indices=new s.Uint32Array(this.indices));for(var i=0,r=this.attributes,o=this.indices,t=0;t<o.length;t++)i=Math.max(i,o[t]+1);for(var a=this.getEnabledAttributes(),l=0;l<a.length;l++){var c=a[l],u=r[c].value;r[c].init(this.indices.length);for(var d=r[c].value,t=0;t<u.length;t++)d[t]=u[t]}for(var t=0;t<o.length;t++){var h=o[t];if(e[h]>0){for(var l=0;l<a.length;l++)for(var c=a[l],p=r[c].value,f=r[c].size,g=0;g<f;g++)p[i*f+g]=p[h*f+g];o[t]=i,i++}e[h]++}this.dirty()}},generateBarycentric:function(){if(this.vertexCount){this.isUniqueVertex()||this.generateUniqueVertex();var e=this.attributes,t=e.barycentric.value,n=this.indices;if(!t||t.length!==3*n.length){t=e.barycentric.value=new Float32Array(3*n.length);for(var i=0;i<n.length;)for(var r=0;r<3;r++){var o=n[i++];t[3*o+r]=1}this.dirty()}}},applyTransform:function(e){var t=this.attributes,n=t.position.value,i=t.normal.value,r=t.tangent.value;e=e._array;var o=c.create();c.invert(o,e),c.transpose(o,o);var a=u.transformMat4,s=u.forEach;s(n,3,0,null,a,e),i&&s(i,3,0,null,a,o),r&&s(r,4,0,null,a,o),this.boundingBox&&this.updateBoundingBox()},dispose:function(e){var t=this._cache;t.use(e.__GLID__);var n=t.get("chunks");if(n)for(var i=0;i<n.length;i++)for(var r=n[i],o=0;o<r.attributeBuffers.length;o++){var a=r.attributeBuffers[o];e.deleteBuffer(a.buffer)}t.deleteContext(e.__GLID__)}});Object.defineProperty&&(Object.defineProperty(g.prototype,"vertexCount",{enumerable:!1,get:function(){var e=this.attributes[this.mainAttribute];return e&&e.value?e.value.length/e.size:0}}),Object.defineProperty(g.prototype,"triangleCount",{enumerable:!1,get:function(){var e=this.indices;return e?e.length/3:0}})),g.Attribute=r.StaticAttribute,e.exports=g},function(e,t,n){"use strict";var i=n(3),r=n(1),o=r.vec3,a=o.copy,s=o.set,l=function(e,t){this.min=e||new i(1/0,1/0,1/0),this.max=t||new i(-1/0,-1/0,-1/0)};l.prototype={constructor:l,updateFromVertices:function(e){if(e.length>0){var t=this.min,n=this.max,i=t._array,r=n._array;a(i,e[0]),a(r,e[0]);for(var o=1;o<e.length;o++){var s=e[o];s[0]<i[0]&&(i[0]=s[0]),s[1]<i[1]&&(i[1]=s[1]),s[2]<i[2]&&(i[2]=s[2]),s[0]>r[0]&&(r[0]=s[0]),s[1]>r[1]&&(r[1]=s[1]),s[2]>r[2]&&(r[2]=s[2])}t._dirty=!0,n._dirty=!0}},union:function(e){var t=this.min,n=this.max;return o.min(t._array,t._array,e.min._array),o.max(n._array,n._array,e.max._array),t._dirty=!0,n._dirty=!0,this},intersection:function(e){var t=this.min,n=this.max;return o.max(t._array,t._array,e.min._array),o.min(n._array,n._array,e.max._array),t._dirty=!0,n._dirty=!0,this},intersectBoundingBox:function(e){var t=this.min._array,n=this.max._array,i=e.min._array,r=e.max._array;return!(t[0]>r[0]||t[1]>r[1]||t[2]>r[2]||n[0]<i[0]||n[1]<i[1]||n[2]<i[2])},containBoundingBox:function(e){var t=this.min._array,n=this.max._array,i=e.min._array,r=e.max._array;return t[0]<=i[0]&&t[1]<=i[1]&&t[2]<=i[2]&&n[0]>=r[0]&&n[1]>=r[1]&&n[2]>=r[2]},containPoint:function(e){var t=this.min._array,n=this.max._array,i=e._array;return t[0]<=i[0]&&t[1]<=i[1]&&t[2]<=i[2]&&n[0]>=i[0]&&n[1]>=i[1]&&n[2]>=i[2]},isFinite:function(){var e=this.min._array,t=this.max._array;return isFinite(e[0])&&isFinite(e[1])&&isFinite(e[2])&&isFinite(t[0])&&isFinite(t[1])&&isFinite(t[2])},applyTransform:function(){var e=o.create(),t=o.create(),n=o.create(),i=o.create(),r=o.create(),a=o.create();return function(o){var s=this.min._array,l=this.max._array,c=o._array;return e[0]=c[0]*s[0],e[1]=c[1]*s[0],e[2]=c[2]*s[0],t[0]=c[0]*l[0],t[1]=c[1]*l[0],t[2]=c[2]*l[0],n[0]=c[4]*s[1],n[1]=c[5]*s[1],n[2]=c[6]*s[1],i[0]=c[4]*l[1],i[1]=c[5]*l[1],i[2]=c[6]*l[1],r[0]=c[8]*s[2],r[1]=c[9]*s[2],r[2]=c[10]*s[2],a[0]=c[8]*l[2],a[1]=c[9]*l[2],a[2]=c[10]*l[2],s[0]=Math.min(e[0],t[0])+Math.min(n[0],i[0])+Math.min(r[0],a[0])+c[12],s[1]=Math.min(e[1],t[1])+Math.min(n[1],i[1])+Math.min(r[1],a[1])+c[13],s[2]=Math.min(e[2],t[2])+Math.min(n[2],i[2])+Math.min(r[2],a[2])+c[14],l[0]=Math.max(e[0],t[0])+Math.max(n[0],i[0])+Math.max(r[0],a[0])+c[12],l[1]=Math.max(e[1],t[1])+Math.max(n[1],i[1])+Math.max(r[1],a[1])+c[13],l[2]=Math.max(e[2],t[2])+Math.max(n[2],i[2])+Math.max(r[2],a[2])+c[14],this.min._dirty=!0,this.max._dirty=!0,this}}(),applyProjection:function(e){var t=this.min._array,n=this.max._array,i=e._array,r=t[0],o=t[1],a=t[2],s=n[0],l=n[1],c=t[2],u=n[0],d=n[1],h=n[2];if(1===i[15])t[0]=i[0]*r+i[12],t[1]=i[5]*o+i[13],n[2]=i[10]*a+i[14],n[0]=i[0]*u+i[12],n[1]=i[5]*d+i[13],t[2]=i[10]*h+i[14];else{var p=-1/a;t[0]=i[0]*r*p,t[1]=i[5]*o*p,n[2]=(i[10]*a+i[14])*p,p=-1/c,n[0]=i[0]*s*p,n[1]=i[5]*l*p,p=-1/h,t[2]=(i[10]*h+i[14])*p}return this.min._dirty=!0,this.max._dirty=!0,this},updateVertices:function(){var e=this.vertices;if(!e){for(var e=[],t=0;t<8;t++)e[t]=o.fromValues(0,0,0);this.vertices=e}var n=this.min._array,i=this.max._array;return s(e[0],n[0],n[1],n[2]),s(e[1],n[0],i[1],n[2]),s(e[2],i[0],n[1],n[2]),s(e[3],i[0],i[1],n[2]),s(e[4],n[0],n[1],i[2]),s(e[5],n[0],i[1],i[2]),s(e[6],i[0],n[1],i[2]),s(e[7],i[0],i[1],i[2]),this},copy:function(e){var t=this.min,n=this.max;return a(t._array,e.min._array),a(n._array,e.max._array),t._dirty=!0,n._dirty=!0,this},clone:function(){var e=new l;return e.copy(this),e}},e.exports=l},function(e,t){function r(e){if(null==e||"object"!=typeof e)return e;var t=e,n=P.call(e);if("[object Array]"===n){t=[];for(var i=0,o=e.length;i<o;i++)t[i]=r(e[i])}else if(N[n])t=e.constructor.from(e);else if(!k[n]&&!R(e)&&!S(e)){t={};for(var a in e)e.hasOwnProperty(a)&&(t[a]=r(e[a]))}return t}function n(e,t,i){if(!w(t)||!w(e))return i?r(t):e;for(var o in t)if(t.hasOwnProperty(o)){var a=e[o],s=t[o];!w(s)||!w(a)||x(s)||x(a)||S(s)||S(a)||E(s)||E(a)||R(s)||R(a)?!i&&o in e||(e[o]=r(t[o],!0)):n(a,s,i)}return e}function i(e,t){for(var i=e[0],r=1,o=e.length;r<o;r++)i=n(i,e[r],t);return i}function a(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function o(e,t,n){for(var i in t)t.hasOwnProperty(i)&&(n?null!=t[i]:null==e[i])&&(e[i]=t[i]);return e}function s(){return document.createElement("canvas")}function u(){return I||(I=U.createCanvas().getContext("2d")),I}function l(e,t){if(e){if(e.indexOf)return e.indexOf(t);for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n}return-1}function h(e,t){function r(){}var n=e.prototype;r.prototype=t.prototype,e.prototype=new r;for(var i in n)e.prototype[i]=n[i];e.prototype.constructor=e,e.superClass=t}function c(e,t,n){e="prototype"in e?e.prototype:e,t="prototype"in t?t.prototype:t,o(e,t,n)}function d(e){if(e)return"string"!=typeof e&&"number"==typeof e.length}function f(e,t,n){if(e&&t)if(e.forEach&&e.forEach===z)e.forEach(t,n);else if(e.length===+e.length)for(var i=0,r=e.length;i<r;i++)t.call(n,e[i],i,e);else for(var o in e)e.hasOwnProperty(o)&&t.call(n,e[o],o,e)}function _(e,t,n){if(e&&t){if(e.map&&e.map===H)return e.map(t,n);for(var i=[],r=0,o=e.length;r<o;r++)i.push(t.call(n,e[r],r,e));return i}}function p(e,t,n,i){if(e&&t){if(e.reduce&&e.reduce===V)return e.reduce(t,n,i);for(var r=0,o=e.length;r<o;r++)n=t.call(i,n,e[r],r,e);return n}}function m(e,t,n){if(e&&t){if(e.filter&&e.filter===F)return e.filter(t,n);for(var i=[],r=0,o=e.length;r<o;r++)t.call(n,e[r],r,e)&&i.push(e[r]);return i}}function g(e,t,n){if(e&&t)for(var i=0,r=e.length;i<r;i++)if(t.call(n,e[i],i,e))return e[i]}function v(e,t){var n=B.call(arguments,2);return function(){return e.apply(t,n.concat(B.call(arguments)))}}function y(e){var t=B.call(arguments,1);return function(){return e.apply(this,t.concat(B.call(arguments)))}}function x(e){return"[object Array]"===P.call(e)}function T(e){return"function"==typeof e}function b(e){return"[object String]"===P.call(e)}function w(e){var t=typeof e;return"function"===t||!!e&&"object"==t}function E(e){return!!k[P.call(e)]}function S(e){return"object"==typeof e&&"number"==typeof e.nodeType&&"object"==typeof e.ownerDocument}function A(e){return e!==e}function M(e){for(var t=0,n=arguments.length;t<n;t++)if(null!=arguments[t])return arguments[t]}function C(){return Function.call.apply(B,arguments)}function L(e,t){if(!e)throw new Error(t)}function D(e){e[W]=!0}function R(e){return e[W]}var I,k={"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1,"[object CanvasGradient]":1,"[object CanvasPattern]":1,"[object Image]":1,"[object Canvas]":1},N={"[object Int8Array]":1,"[object Uint8Array]":1,"[object Uint8ClampedArray]":1,"[object Int16Array]":1,"[object Uint16Array]":1,"[object Int32Array]":1,"[object Uint32Array]":1,"[object Float32Array]":1,"[object Float64Array]":1},P=Object.prototype.toString,O=Array.prototype,z=O.forEach,F=O.filter,B=O.slice,H=O.map,V=O.reduce,W="__ec_primitive__",U={inherits:h,mixin:c,clone:r,merge:n,mergeAll:i,extend:a,defaults:o,getContext:u,createCanvas:s,indexOf:l,slice:C,find:g,isArrayLike:d,each:f,map:_,reduce:p,filter:m,bind:v,curry:y,isArray:x,isString:b,isObject:w,isFunction:T,isBuiltInObject:E,isDom:S,eqNaN:A,retrieve:M,assert:L,setAsPrimitive:D,noop:function(){}};e.exports=U},function(e,t){e.exports=function(e,t,n){t.eachSeriesByType(e,function(e){var t=e.getData(),n=e.visualColorAccessPath.split(".");n[n.length-1]="opacity";var i=e.get(n);t.setVisual("opacity",null==i?1:i),t.hasItemOption&&t.each(function(e){var i=t.getItemModel(e),r=i.get(n);null!=r&&t.setItemVisual(e,r)})})}},function(e,t,n){"use strict";var i=n(30),r=i.extend(function(){return{color:[1,1,1],intensity:1,castShadow:!0,shadowResolution:512,group:0}},{type:"",clone:function(){var e=i.prototype.clone.call(this);return e.color=Array.prototype.slice.call(this.color),e.intensity=this.intensity,e.castShadow=this.castShadow,e.shadowResolution=this.shadowResolution,e}});e.exports=r},function(e,t,n){"use strict";var i=["OES_texture_float","OES_texture_half_float","OES_texture_float_linear","OES_texture_half_float_linear","OES_standard_derivatives","OES_vertex_array_object","OES_element_index_uint","WEBGL_compressed_texture_s3tc","WEBGL_depth_texture","EXT_texture_filter_anisotropic","EXT_shader_texture_lod","WEBGL_draw_buffers","EXT_frag_depth"],r=["MAX_TEXTURE_SIZE","MAX_CUBE_MAP_TEXTURE_SIZE"],o={},a={},s={initialize:function(e){var t=e.__GLID__;if(!o[t]){o[t]={},a[t]={};for(var n=0;n<i.length;n++){var s=i[n];this._createExtension(e,s)}for(var n=0;n<r.length;n++){var l=r[n];a[t][l]=e.getParameter(e[l])}}},getExtension:function(e,t){var n=e.__GLID__;if(o[n])return void 0===o[n][t]&&this._createExtension(e,t),o[n][t]},getParameter:function(e,t){var n=e.__GLID__;if(a[n])return a[n][t]},dispose:function(e){delete o[e.__GLID__],delete a[e.__GLID__]},_createExtension:function(e,t){var n=e.getExtension(t);n||(n=e.getExtension("MOZ_"+t)),n||(n=e.getExtension("WEBKIT_"+t)),o[e.__GLID__][t]=n}};e.exports=s},function(e,t,n){"use strict";var i=!0;try{var r=document.createElement("canvas");if(!r.getContext("webgl")&&!r.getContext("experimental-webgl"))throw new Error}catch(e){i=!1}var o={};o.supportWebGL=function(){return i},o.Int8Array="undefined"==typeof Int8Array?Array:Int8Array,o.Uint8Array="undefined"==typeof Uint8Array?Array:Uint8Array,o.Uint16Array="undefined"==typeof Uint16Array?Array:Uint16Array,o.Uint32Array="undefined"==typeof Uint32Array?Array:Uint32Array,o.Int16Array="undefined"==typeof Int16Array?Array:Int16Array,o.Float32Array="undefined"==typeof Float32Array?Array:Float32Array,o.Float64Array="undefined"==typeof Float64Array?Array:Float64Array,e.exports=o},function(e,t,n){"use strict";var i=n(5),r=n(6),o=i.extend({name:"",depthTest:!0,depthMask:!0,transparent:!1,blend:null,_enabledUniforms:null},function(){this.name||(this.name="MATERIAL_"+this.__GUID__),this.shader&&this.attachShader(this.shader),this.uniforms||(this.uniforms={})},{bind:function(e,t,n,i){for(var t=t||this.shader,o=i===t,a=t.currentTextureSlot(),s=0;s<this._enabledUniforms.length;s++){var l=this._enabledUniforms[s],c=this.uniforms[l],u=c.value;if(!(n&&o&&n.uniforms[l].value===u||void 0===u))if(null!==u){if(!(u instanceof Array)||u.length)if(u instanceof r){var d=t.currentTextureSlot(),h=t.setUniform(e,"1i",l,d);if(!h)continue;t.useCurrentTextureSlot(e,u)}else if(u instanceof Array){if(0===u.length)continue;var p=u[0];if(p instanceof r){if(!t.hasUniform(l))continue;for(var f=[],g=0;g<u.length;g++){var m=u[g],d=t.currentTextureSlot();f.push(d),t.useCurrentTextureSlot(e,m)}t.setUniform(e,"1iv",l,f)}else t.setUniform(e,c.type,l,u)}else t.setUniform(e,c.type,l,u)}else if("t"===c.type){var d=t.currentTextureSlot(),h=t.setUniform(e,"1i",l,d);h&&t.useCurrentTextureSlot(e,null)}}t.resetTextureSlot(a)},setUniform:function(e,t){var n=this.uniforms[e];n&&(n.value=t)},setUniforms:function(e){for(var t in e){var n=e[t];this.setUniform(t,n)}},isUniformEnabled:function(e){return this._enabledUniforms.indexOf(e)>=0},set:function(e,t){if("object"==typeof e)for(var n in e){var i=e[n];this.set(n,i)}else{var r=this.uniforms[e];r&&(r.value=t)}},get:function(e){var t=this.uniforms[e];if(t)return t.value},attachShader:function(e,t){this.shader&&this.shader.detached();var n=this.uniforms;this.uniforms=e.createUniforms(),this.shader=e;var i=this.uniforms;if(this._enabledUniforms=Object.keys(i),this._enabledUniforms.sort(),t)for(var r in n)i[r]&&(i[r].value=n[r].value);e.attached()},detachShader:function(){this.shader.detached(),this.shader=null,this.uniforms={}},clone:function(){var e=new this.constructor({name:this.name,shader:this.shader});for(var t in this.uniforms)e.uniforms[t].value=this.uniforms[t].value;return e.depthTest=this.depthTest,e.depthMask=this.depthMask,e.transparent=this.transparent,e.blend=this.blend,e},dispose:function(e,t){if(t)for(var n in this.uniforms){var i=this.uniforms[n].value;if(i)if(i instanceof r)i.dispose(e);else if(i instanceof Array)for(var o=0;o<i.length;o++)i[o]instanceof r&&i[o].dispose(e)}var a=this.shader;a&&(this.detachShader(),a.isAttachedToAny()||a.dispose(e))}});e.exports=o},function(e,t,i){function n(e){return"CANVAS"===e.nodeName||"VIDEO"===e.nodeName||e.complete}var r=i(6),o=i(17),a=i(8),s=i(23),l=i(80),c=l.isPowerOfTwo,u=["px","nx","py","ny","pz","nz"],d=r.extend(function(){return{image:{px:null,nx:null,py:null,ny:null,pz:null,nz:null},pixels:{px:null,nx:null,py:null,ny:null,pz:null,nz:null},mipmaps:[]}},{update:function(e){e.bindTexture(e.TEXTURE_CUBE_MAP,this._cache.get("webgl_texture")),this.beforeUpdate(e);var t=this.format,n=this.type;e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_S,this.wrapS),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_T,this.wrapT),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,this.magFilter),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,this.minFilter);var i=o.getExtension(e,"EXT_texture_filter_anisotropic");if(i&&this.anisotropic>1&&e.texParameterf(e.TEXTURE_CUBE_MAP,i.TEXTURE_MAX_ANISOTROPY_EXT,this.anisotropic),36193===n&&(o.getExtension(e,"OES_texture_half_float")||(n=a.FLOAT)),this.mipmaps.length)for(var r=this.width,s=this.height,l=0;l<this.mipmaps.length;l++){var c=this.mipmaps[l];this._updateTextureData(e,c,l,r,s,t,n),r/=2,s/=2}else this._updateTextureData(e,this,0,this.width,this.height,t,n),!this.NPOT&&this.useMipmap&&e.generateMipmap(e.TEXTURE_CUBE_MAP);e.bindTexture(e.TEXTURE_CUBE_MAP,null)},_updateTextureData:function(e,t,n,i,r,o,a){for(var s=0;s<6;s++){var l=u[s],c=t.image&&t.image[l];c?e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+s,n,o,o,a,c):e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+s,n,o,i,r,0,o,a,t.pixels&&t.pixels[l])}},generateMipmap:function(e){this.useMipmap&&!this.NPOT&&(e.bindTexture(e.TEXTURE_CUBE_MAP,this._cache.get("webgl_texture")),e.generateMipmap(e.TEXTURE_CUBE_MAP))},bind:function(e){e.bindTexture(e.TEXTURE_CUBE_MAP,this.getWebGLTexture(e))},unbind:function(e){e.bindTexture(e.TEXTURE_CUBE_MAP,null)},isPowerOfTwo:function(){return this.image.px?c(this.image.px.width)&&c(this.image.px.height):c(this.width)&&c(this.height)},isRenderable:function(){return this.image.px?n(this.image.px)&&n(this.image.nx)&&n(this.image.py)&&n(this.image.ny)&&n(this.image.pz)&&n(this.image.nz):!(!this.width||!this.height)},load:function(e){var t=0,n=this;return s.each(e,function(e,i){var r=new Image;r.onload=function(){t--,0===t&&(n.dirty(),n.trigger("success",n)),r.onload=null},r.onerror=function(){t--,r.onerror=null},t++,r.src=e,n.image[i]=r}),this}});e.exports=d},function(e,t,n){"use strict";var i=n(5),r=n(42),o=n(53),a=n(9),s=n(19),l=n(29),c=n(17),u=n(8);a.import(n(204));var d=new o,h=new l({geometry:d,frustumCulling:!1}),p=new r,f=i.extend(function(){return{fragment:"",outputs:null,material:null,blendWithPrevious:!1,clearColor:!1,clearDepth:!0}},function(){var e=new a({vertex:a.source("qtek.compositor.vertex"),fragment:this.fragment}),t=new s({shader:e});e.enableTexturesAll(),this.material=t},{setUniform:function(e,t){var n=this.material.uniforms[e];n&&(n.value=t)},getUniform:function(e){var t=this.material.uniforms[e];if(t)return t.value},attachOutput:function(e,t){this.outputs||(this.outputs={}),t=t||u.COLOR_ATTACHMENT0,this.outputs[t]=e},detachOutput:function(e){for(var t in this.outputs)this.outputs[t]===e&&(this.outputs[t]=null)},bind:function(e,t){if(this.outputs)for(var n in this.outputs){var i=this.outputs[n];i&&t.attach(i,n)}t&&t.bind(e)},unbind:function(e,t){t.unbind(e)},render:function(e,t){var n=e.gl;if(t){this.bind(e,t);var i=c.getExtension(n,"EXT_draw_buffers");if(i&&this.outputs){var r=[];for(var o in this.outputs)(o=+o)>=n.COLOR_ATTACHMENT0&&o<=n.COLOR_ATTACHMENT0+8&&r.push(o);i.drawBuffersEXT(r)}}this.trigger("beforerender",this,e);var a=this.clearDepth?n.DEPTH_BUFFER_BIT:0;if(n.depthMask(!0),this.clearColor){a|=n.COLOR_BUFFER_BIT,n.colorMask(!0,!0,!0,!0);var s=this.clearColor;s instanceof Array&&n.clearColor(s[0],s[1],s[2],s[3])}n.clear(a),this.blendWithPrevious?(n.enable(n.BLEND),this.material.transparent=!0):(n.disable(n.BLEND),this.material.transparent=!1),this.renderQuad(e),this.trigger("afterrender",this,e),t&&this.unbind(e,t)},renderQuad:function(e){h.material=this.material,e.renderQueue([h],p)},dispose:function(e){this.material.dispose(e)}});e.exports=f},function(e,t,n){var i=n(12),r=n(1).vec3,o=n(0),a=n(28),s=[[0,0],[1,1]],l=i.extend(function(){return{segmentScale:1,dynamic:!0,useNativeLine:!0,attributes:{position:new i.Attribute("position","float",3,"POSITION"),positionPrev:new i.Attribute("positionPrev","float",3),positionNext:new i.Attribute("positionNext","float",3),offset:new i.Attribute("offset","float",1),color:new i.Attribute("color","float",4,"COLOR")}}},{resetOffset:function(){this._vertexOffset=0,this._triangleOffset=0},setVertexCount:function(e){var t=this.attributes;this.vertexCount!==e&&(t.position.init(e),t.color.init(e),this.useNativeLine||(t.positionPrev.init(e),t.positionNext.init(e),t.offset.init(e)),e>65535?this.indices instanceof Uint16Array&&(this.indices=new Uint32Array(this.indices)):this.indices instanceof Uint32Array&&(this.indices=new Uint16Array(this.indices)))},setTriangleCount:function(e){this.triangleCount!==e&&(this.indices=0===e?null:this.vertexCount>65535?new Uint32Array(3*e):new Uint16Array(3*e))},_getCubicCurveApproxStep:function(e,t,n,i){return 1/(r.dist(e,t)+r.dist(n,t)+r.dist(i,n)+1)*this.segmentScale},getCubicCurveVertexCount:function(e,t,n,i){var r=this._getCubicCurveApproxStep(e,t,n,i),o=Math.ceil(1/r);return this.useNativeLine?2*o:2*o+2},getCubicCurveTriangleCount:function(e,t,n,i){var r=this._getCubicCurveApproxStep(e,t,n,i),o=Math.ceil(1/r);return this.useNativeLine?0:2*o},getLineVertexCount:function(){return this.getPolylineVertexCount(s)},getLineTriangleCount:function(){return this.getPolylineTriangleCount(s)},getPolylineVertexCount:function(e){var t="number"!=typeof e[0],n=t?e.length:e.length/3;return this.useNativeLine?2*(n-1):2*(n-1)+2},getPolylineTriangleCount:function(e){var t="number"!=typeof e[0],n=t?e.length:e.length/3;return this.useNativeLine?0:2*(n-1)},addCubicCurve:function(e,t,n,i,r,o){null==o&&(o=1);for(var a=e[0],s=e[1],l=e[2],c=t[0],u=t[1],d=t[2],h=n[0],p=n[1],f=n[2],g=i[0],m=i[1],v=i[2],_=this._getCubicCurveApproxStep(e,t,n,i),y=_*_,x=y*_,b=3*_,w=3*y,C=6*y,S=6*x,T=a-2*c+h,A=s-2*u+p,M=l-2*d+f,E=3*(c-h)-a+g,I=3*(u-p)-s+m,D=3*(d-f)-l+v,k=a,L=s,N=l,P=(c-a)*b+T*w+E*x,O=(u-s)*b+A*w+I*x,R=(d-l)*b+M*w+D*x,z=T*C+E*S,F=A*C+I*S,B=M*C+D*S,H=E*S,V=I*S,W=D*S,U=0,$=0,G=Math.ceil(1/_),q=new Float32Array(3*(G+1)),q=[],j=0,$=0;$<G+1;$++)q[j++]=k,q[j++]=L,q[j++]=N,k+=P,L+=O,N+=R,P+=z,O+=F,R+=B,z+=H,F+=V,B+=W,(U+=_)>1&&(k=P>0?Math.min(k,g):Math.max(k,g),L=O>0?Math.min(L,m):Math.max(L,m),N=R>0?Math.min(N,v):Math.max(N,v));this.addPolyline(q,r,o,!1)},addLine:function(e,t,n,i){this.addPolyline([e,t],n,i,!1)},addPolyline:function(e,t,n,i){if(e.length){var r="number"!=typeof e[0],o=this.attributes.position,a=this.attributes.positionPrev,s=this.attributes.positionNext,l=this.attributes.color,c=this.attributes.offset,u=this.indices;null==n&&(n=1);for(var d,h,p=this._vertexOffset,f=r?e.length:e.length/3,g=f,m=0;m<g;m++){if(r)d=e[m],h=i?t[m]:t;else{var v=3*m;if(d=d||[],d[0]=e[v],d[1]=e[v+1],d[2]=e[v+2],i){var _=4*m;h=h||[],h[0]=t[_],h[1]=t[_+1],h[2]=t[_+2],h[3]=t[_+3]}else h=t}if(this.useNativeLine?m>1&&(o.copy(p,p-1),l.copy(p,p-1),p++):(m<g-1&&(a.set(p+2,d),a.set(p+3,d)),m>0&&(s.set(p-2,d),s.set(p-1,d)),o.set(p,d),o.set(p+1,d),l.set(p,h),l.set(p+1,h),c.set(p,n/2),c.set(p+1,-n/2),p+=2),this.useNativeLine)l.set(p,h),o.set(p,d),p++;else if(m>0){var y=3*this._triangleOffset,u=this.indices;u[y]=p-4,u[y+1]=p-3,u[y+2]=p-2,u[y+3]=p-3,u[y+4]=p-1,u[y+5]=p-2,this._triangleOffset+=2}}if(!this.useNativeLine){var x=this._vertexOffset,b=this._vertexOffset+2*f;a.copy(x,x+2),a.copy(x+1,x+3),s.copy(b-1,b-3),s.copy(b-2,b-4)}this._vertexOffset=p}}});o.util.defaults(l.prototype,a),e.exports=l},function(e,t,n){"use strict";var i=0,r=Array.prototype,o=r.forEach,a={genGUID:function(){return++i},relative2absolute:function(e,t){if(!t||e.match(/^\//))return e;for(var n=e.split("/"),i=t.split("/"),r=n[0];"."===r||".."===r;)".."===r&&i.pop(),n.shift(),r=n[0];return i.join("/")+"/"+n.join("/")},extend:function(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},defaults:function(e,t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n]);return e},extendWithPropList:function(e,t,n){if(t)for(var i=0;i<n.length;i++){var r=n[i];e[r]=t[r]}return e},defaultsWithPropList:function(e,t,n){if(t)for(var i=0;i<n.length;i++){var r=n[i];null==e[r]&&(e[r]=t[r])}return e},each:function(e,t,n){if(e&&t)if(e.forEach&&e.forEach===o)e.forEach(t,n);else if(e.length===+e.length)for(var i=0,r=e.length;i<r;i++)t.call(n,e[i],i,e);else for(var a in e)e.hasOwnProperty(a)&&t.call(n,e[a],a,e)},isObject:function(e){return e===Object(e)},isArray:function(e){return e instanceof Array},isArrayLike:function(e){return!!e&&e.length===+e.length},clone:function(e){if(a.isObject(e)){if(a.isArray(e))return e.slice();if(a.isArrayLike(e)){for(var t=new e.constructor(e.length),n=0;n<e.length;n++)t[n]=e[n];return t}return a.extend({},e)}return e}};e.exports=a},function(e,t,n){"use strict";var i=n(1),r=i.vec2,o=function(e,t){e=e||0,t=t||0,this._array=r.fromValues(e,t),this._dirty=!0};if(o.prototype={constructor:o,add:function(e){return r.add(this._array,this._array,e._array),this._dirty=!0,this},set:function(e,t){return this._array[0]=e,this._array[1]=t,this._dirty=!0,this},setArray:function(e){return this._array[0]=e[0],this._array[1]=e[1],this._dirty=!0,this},clone:function(){return new o(this.x,this.y)},copy:function(e){return r.copy(this._array,e._array),this._dirty=!0,this},cross:function(e,t){return r.cross(e._array,this._array,t._array),e._dirty=!0,this},dist:function(e){return r.dist(this._array,e._array)},distance:function(e){return r.distance(this._array,e._array)},div:function(e){return r.div(this._array,this._array,e._array),this._dirty=!0,this},divide:function(e){return r.divide(this._array,this._array,e._array),this._dirty=!0,this},dot:function(e){return r.dot(this._array,e._array)},len:function(){return r.len(this._array)},length:function(){return r.length(this._array)},lerp:function(e,t,n){return r.lerp(this._array,e._array,t._array,n),this._dirty=!0,this},min:function(e){return r.min(this._array,this._array,e._array),this._dirty=!0,this},max:function(e){return r.max(this._array,this._array,e._array),this._dirty=!0,this},mul:function(e){return r.mul(this._array,this._array,e._array),this._dirty=!0,this},multiply:function(e){return r.multiply(this._array,this._array,e._array),this._dirty=!0,this},negate:function(){return r.negate(this._array,this._array),this._dirty=!0,this},normalize:function(){return r.normalize(this._array,this._array),this._dirty=!0,this},random:function(e){return r.random(this._array,e),this._dirty=!0,this},scale:function(e){return r.scale(this._array,this._array,e),this._dirty=!0,this},scaleAndAdd:function(e,t){return r.scaleAndAdd(this._array,this._array,e._array,t),this._dirty=!0,this},sqrDist:function(e){return r.sqrDist(this._array,e._array)},squaredDistance:function(e){return r.squaredDistance(this._array,e._array)},sqrLen:function(){return r.sqrLen(this._array)},squaredLength:function(){return r.squaredLength(this._array)},sub:function(e){return r.sub(this._array,this._array,e._array),this._dirty=!0,this},subtract:function(e){return r.subtract(this._array,this._array,e._array),this._dirty=!0,this},transformMat2:function(e){return r.transformMat2(this._array,this._array,e._array),this._dirty=!0,this},transformMat2d:function(e){return r.transformMat2d(this._array,this._array,e._array),this._dirty=!0,this},transformMat3:function(e){return r.transformMat3(this._array,this._array,e._array),this._dirty=!0,this},transformMat4:function(e){return r.transformMat4(this._array,this._array,e._array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this._array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this._array)}},Object.defineProperty){var a=o.prototype;Object.defineProperty(a,"x",{get:function(){return this._array[0]},set:function(e){this._array[0]=e,this._dirty=!0}}),Object.defineProperty(a,"y",{get:function(){return this._array[1]},set:function(e){this._array[1]=e,this._dirty=!0}})}o.add=function(e,t,n){return r.add(e._array,t._array,n._array),e._dirty=!0,e},o.set=function(e,t,n){return r.set(e._array,t,n),e._dirty=!0,e},o.copy=function(e,t){return r.copy(e._array,t._array),e._dirty=!0,e},o.cross=function(e,t,n){return r.cross(e._array,t._array,n._array),e._dirty=!0,e},o.dist=function(e,t){return r.distance(e._array,t._array)},o.distance=o.dist,o.div=function(e,t,n){return r.divide(e._array,t._array,n._array),e._dirty=!0,e},o.divide=o.div,o.dot=function(e,t){return r.dot(e._array,t._array)},o.len=function(e){return r.length(e._array)},o.lerp=function(e,t,n,i){return r.lerp(e._array,t._array,n._array,i),e._dirty=!0,e},o.min=function(e,t,n){return r.min(e._array,t._array,n._array),e._dirty=!0,e},o.max=function(e,t,n){return r.max(e._array,t._array,n._array),e._dirty=!0,e},o.mul=function(e,t,n){return r.multiply(e._array,t._array,n._array),e._dirty=!0,e},o.multiply=o.mul,o.negate=function(e,t){return r.negate(e._array,t._array),e._dirty=!0,e},o.normalize=function(e,t){return r.normalize(e._array,t._array),e._dirty=!0,e},o.random=function(e,t){return r.random(e._array,t),e._dirty=!0,e},o.scale=function(e,t,n){return r.scale(e._array,t._array,n),e._dirty=!0,e},o.scaleAndAdd=function(e,t,n,i){return r.scaleAndAdd(e._array,t._array,n._array,i),e._dirty=!0,e},o.sqrDist=function(e,t){return r.sqrDist(e._array,t._array)},o.squaredDistance=o.sqrDist,o.sqrLen=function(e){return r.sqrLen(e._array)},o.squaredLength=o.sqrLen,o.sub=function(e,t,n){return r.subtract(e._array,t._array,n._array),e._dirty=!0,e},o.subtract=o.sub,o.transformMat2=function(e,t,n){return r.transformMat2(e._array,t._array,n._array),e._dirty=!0,e},o.transformMat2d=function(e,t,n){return r.transformMat2d(e._array,t._array,n._array),e._dirty=!0,e},o.transformMat3=function(e,t,n){return r.transformMat3(e._array,t._array,n._array),e._dirty=!0,e},o.transformMat4=function(e,t,n){return r.transformMat4(e._array,t._array,n._array),e._dirty=!0,e},e.exports=o},function(e,t,n){var i=n(0);e.exports=function(e,t){var n=e.getData(),r=e.getRawValue(t),o=i.util.isArray(r)?function(t){var n=e.getData(),r=[],o=e.coordinateSystem,a=e.get("dimensions")||[],s=o&&o.dimensions||[],l=n.dimensions;return i.util.each(t,function(e,t){var o,c=n.getDimensionInfo(t),u=c&&c.type,d=a[t]||s[t]||l[t];(o="ordinal"===u?e+"":"time"===u?i.format.formatTime("yyyy/MM/dd hh:mm:ss",e):i.format.addCommas(e))&&r.push(i.format.encodeHTML(d+": "+o))}),r.join("<br />")}(r):i.format.encodeHTML(i.format.addCommas(r)),a=n.getName(t),s=n.getItemVisual(t,"color");i.util.isObject(s)&&s.colorStops&&(s=(s.colorStops[0]||{}).color),s=s||"transparent";var l='<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:'+i.format.encodeHTML(s)+'"></span>',c=e.name;return"\0-"===c&&(c=""),(c&&l+i.format.encodeHTML(c)+"<br />")+(a&&a+"<br />")+o}},function(e,t){e.exports={defaultOption:{shading:null,realisticMaterial:{textureTiling:1,textureOffset:0,baseTexture:null},lambertMaterial:{textureTiling:1,textureOffset:0,baseTexture:null},colorMaterial:{textureTiling:1,textureOffset:0,baseTexture:null}}}},function(e,t,i){function n(e){e=e||"perspective",this.layer=null,this.scene=new o,this.viewport={x:0,y:0,width:0,height:0},this.setCameraType(e),this._compositor=new p,this._temporalSS=new f,this._shadowMapPass=new a;for(var t=[],n=0,i=0;i<30;i++){for(var r=[],s=0;s<6;s++)r.push(4*g(n,2)-2),r.push(4*g(n,3)-2),n++;t.push(r)}this._pcfKernels=t,this.scene.on("beforerender",function(e,t,n){this.needsTemporalSS()&&this._temporalSS.jitterProjection(e,n)},this)}var r=i(0),o=i(31),a=i(191),s=i(43),l=i(42),c=i(10),u=i(3),d=i(24),h=i(52),p=i(147),f=i(150),g=i(47);n.prototype.setCameraType=function(e){var t=this.camera;t&&t.update(),"perspective"===e?this.camera instanceof s||(this.camera=new s,t&&this.camera.setLocalTransform(t.localTransform)):this.camera instanceof l||(this.camera=new l,t&&this.camera.setLocalTransform(t.localTransform))},n.prototype.setViewport=function(e,t,n,i,r){this.camera instanceof s&&(this.camera.aspect=n/i),r=r||1,this.viewport.x=e,this.viewport.y=t,this.viewport.width=n,this.viewport.height=i,this.viewport.devicePixelRatio=r,this._compositor.resize(n*r,i*r),this._temporalSS.resize(n*r,i*r)},n.prototype.containPoint=function(e,t){var n=this.viewport;return t=this.layer.renderer.getHeight()-t,e>=n.x&&t>=n.y&&e<=n.x+n.width&&t<=n.y+n.height};var m=new d;n.prototype.castRay=function(e,t,n){var i=this.layer.renderer,r=i.viewport;return i.viewport=this.viewport,i.screenToNDC(e,t,m),this.camera.castRay(m,n),i.viewport=r,n},n.prototype.prepareRender=function(){this.scene.update(),this.camera.update(),this._needsSortProgressively=!1;for(var e=0;e<this.scene.transparentQueue.length;e++){var t=this.scene.transparentQueue[e],n=t.geometry;n.needsSortVerticesProgressively&&n.needsSortVerticesProgressively()&&(this._needsSortProgressively=!0),n.needsSortTrianglesProgressively&&n.needsSortTrianglesProgressively()&&(this._needsSortProgressively=!0)}this._frame=0,this._temporalSS.resetFrame()},n.prototype.render=function(e,t){this._doRender(e,t,this._frame),this._frame++},n.prototype.needsAccumulate=function(){return this.needsTemporalSS()||this._needsSortProgressively},n.prototype.needsTemporalSS=function(){var e=this._enableTemporalSS;return"auto"==e&&(e=this._enablePostEffect),e},n.prototype.hasDOF=function(){return this._enableDOF},n.prototype.isAccumulateFinished=function(){return this.needsTemporalSS()?this._temporalSS.isFinished():this._frame>30},n.prototype._doRender=function(e,t,n){var i=this.scene,r=this.camera,o=new u,a=new c,s=r.getWorldPosition();n=n||0;for(var l=0;l<i.transparentQueue.length;l++){var d=i.transparentQueue[l],h=d.geometry;c.invert(a,d.worldTransform),u.transformMat4(o,s,a),h.needsSortTriangles&&h.needsSortTriangles()&&h.doSortTriangles(o,n),h.needsSortVertices&&h.needsSortVertices()&&h.doSortVertices(o,n)}if(t||(this._shadowMapPass.kernelPCF=this._pcfKernels[0],this._shadowMapPass.render(e,i,r,!0)),this._updateShadowPCFKernel(n),e.gl.clearColor(0,0,0,0),this._enablePostEffect){var p=this._compositor.getSourceFrameBuffer();p.bind(e),e.gl.clear(e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT),e.render(i,r,!0),p.unbind(e),this._enableSSAO&&(this._compositor.updateSSAO(e,r,this._temporalSS.getFrame()),this._compositor.blendSSAO(e,this._compositor.getSourceTexture())),this.needsTemporalSS()&&t?(this._compositor.composite(e,r,this._temporalSS.getSourceFrameBuffer(),this._temporalSS.getFrame()),e.setViewport(this.viewport),this._temporalSS.render(e)):(e.setViewport(this.viewport),this._compositor.composite(e,r,null,0))}else if(this.needsTemporalSS()&&t){var p=this._temporalSS.getSourceFrameBuffer();p.bind(e),e.saveClear(),e.clearBit=e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT,e.render(i,r,!0),e.restoreClear(),p.unbind(e),e.setViewport(this.viewport),this._temporalSS.render(e)}else e.setViewport(this.viewport),e.render(i,r,!0)},n.prototype._updateShadowPCFKernel=function(e){for(var t=this._pcfKernels[e%this._pcfKernels.length],n=this.scene.opaqueQueue,i=0;i<n.length;i++)n[i].receiveShadow&&(n[i].material.set("pcfKernel",t),n[i].material.shader.define("fragment","PCF_KERNEL_SIZE",t.length/2))},n.prototype.dispose=function(e){this._compositor.dispose(e.gl),this._temporalSS.dispose(e.gl),this._shadowMapPass.dispose(e)},n.prototype.setPostEffect=function(e,t){var n=this._compositor;this._enablePostEffect=e.get("enable");var i=e.getModel("bloom"),r=e.getModel("depthOfField"),o=e.getModel("SSAO"),a=e.getModel("FXAA"),s=e.getModel("colorCorrection");a.get("enable")?n.enableFXAA():n.disableFXAA(),i.get("enable")?n.enableBloom():n.disableBloom(),r.get("enable")?n.enableDOF():n.disableDOF(),s.get("enable")?n.enableColorCorrection():n.disableColorCorrection(),this._enableDOF=r.get("enable"),this._enableSSAO=o.get("enable"),this._enableSSAO?n.enableSSAO():n.disableSSAO(),n.setBloomIntensity(i.get("intensity")),n.setSSAORadius(o.get("radius")),n.setSSAOQuality(o.get("quality")),n.setSSAOIntensity(o.get("intensity")),n.setDOFBlurQuality(r.get("quality")),n.setDOFFocalDistance(r.get("focalDistance")),n.setDOFFocalRange(r.get("focalRange")),n.setDOFBlurSize(r.get("blurRadius")),n.setDOFFStop(r.get("fstop")),n.setColorLookupTexture(s.get("lookupTexture"),t),n.setExposure(s.get("exposure")),["brightness","contrast","saturation"].forEach(function(e){n.setColorCorrection(e,s.get(e))})},n.prototype.setDOFFocusOnPoint=function(e){if(this._enablePostEffect){if(e>this.camera.far||e<this.camera.near)return;return this._compositor.setDOFFocalDistance(e),!0}},n.prototype.setTemporalSuperSampling=function(e){this._enableTemporalSS=e.get("enable")},n.prototype.isLinearSpace=function(){return this._enablePostEffect},n.prototype.add=function(e){this.scene.add(e)},n.prototype.remove=function(e){this.scene.remove(e)},n.prototype.removeAll=function(e){this.scene.removeAll(e)},r.util.extend(n.prototype,h),e.exports=n},function(e,t){e.exports={convertToDynamicArray:function(e){e&&this.resetOffset();var t=this.attributes;for(var n in t)e||!t[n].value?t[n].value=[]:t[n].value=Array.prototype.slice.call(t[n].value);e||!this.indices?this.indices=[]:this.indices=Array.prototype.slice.call(this.indices)},convertToTypedArray:function(){var e=this.attributes;for(var t in e)e[t].value&&e[t].value.length>0?e[t].value=new Float32Array(e[t].value):e[t].value=null;this.indices&&this.indices.length>0&&(this.indices=this.vertexCount>65535?new Uint32Array(this.indices):new Uint16Array(this.indices)),this.dirty()}}},function(e,t,n){"use strict";var i=n(70),r=n(8),o=i.extend({skeleton:null,joints:null},function(){this.joints||(this.joints=[])},{render:function(e,t){if(t=t||this.material.shader,this.skeleton){var n=this.skeleton.getSubSkinMatrices(this.__GUID__,this.joints);t.setUniformOfSemantic(e,"SKIN_MATRIX",n)}return i.prototype.render.call(this,e,t)}});o.POINTS=r.POINTS,o.LINES=r.LINES,o.LINE_LOOP=r.LINE_LOOP,o.LINE_STRIP=r.LINE_STRIP,o.TRIANGLES=r.TRIANGLES,o.TRIANGLE_STRIP=r.TRIANGLE_STRIP,o.TRIANGLE_FAN=r.TRIANGLE_FAN,o.BACK=r.BACK,o.FRONT=r.FRONT,o.FRONT_AND_BACK=r.FRONT_AND_BACK,o.CW=r.CW,o.CCW=r.CCW,e.exports=o},function(t,n,i){"use strict";var r=i(5),o=i(3),a=i(55),s=i(10),l=i(1),c=i(13),u=l.mat4,d=0,h=r.extend({name:"",position:null,rotation:null,scale:null,worldTransform:null,localTransform:null,autoUpdateLocalTransform:!0,_parent:null,_scene:null,_needsUpdateWorldTransform:!0,_inIterating:!1,__depth:0},function(){this.name||(this.name=(this.type||"NODE")+"_"+d++),this.position||(this.position=new o),this.rotation||(this.rotation=new a),this.scale||(this.scale=new o(1,1,1)),this.worldTransform=new s,this.localTransform=new s,this._children=[]},{invisible:!1,isRenderable:function(){return!1},setName:function(e){var t=this._scene;if(t){var n=t._nodeRepository;delete n[this.name],n[e]=this}this.name=e},add:function(e){this._inIterating;var t=e._parent;if(t!==this){t&&t.remove(e),e._parent=this,this._children.push(e);var n=this._scene;n&&n!==e.scene&&e.traverse(this._addSelfToScene,this),e._needsUpdateWorldTransform=!0}},remove:function(e){this._inIterating;var t=this._children,n=t.indexOf(e);n<0||(t.splice(n,1),e._parent=null,this._scene&&e.traverse(this._removeSelfFromScene,this))},removeAll:function(){for(var e=this._children,t=0;t<e.length;t++)e[t]._parent=null,this._scene&&e[t].traverse(this._removeSelfFromScene,this);this._children=[]},getScene:function(){return this._scene},getParent:function(){return this._parent},_removeSelfFromScene:function(e){e._scene.removeFromScene(e),e._scene=null},_addSelfToScene:function(e){this._scene.addToScene(e),e._scene=this._scene},isAncestor:function(e){for(var t=e._parent;t;){if(t===this)return!0;t=t._parent}return!1},children:function(){return this._children.slice()},childAt:function(e){return this._children[e]},getChildByName:function(e){for(var t=this._children,n=0;n<t.length;n++)if(t[n].name===e)return t[n]},getDescendantByName:function(e){for(var t=this._children,n=0;n<t.length;n++){var i=t[n];if(i.name===e)return i;var r=i.getDescendantByName(e);if(r)return r}},queryNode:function(e){if(e){for(var t=e.split("/"),n=this,i=0;i<t.length;i++){var r=t[i];if(r){for(var o=!1,a=n._children,s=0;s<a.length;s++){var l=a[s];if(l.name===r){n=l,o=!0;break}}if(!o)return}}return n}},getPath:function(e){if(!this._parent)return"/";for(var t=this._parent,n=this.name;t._parent&&(n=t.name+"/"+n,t._parent!=e);)t=t._parent;return!t._parent&&e?null:n},traverse:function(e,t,n){this._inIterating=!0,null!=n&&this.constructor!==n||e.call(t,this);for(var i=this._children,r=0,o=i.length;r<o;r++)i[r].traverse(e,t,n);this._inIterating=!1},eachChild:function(e,t,n){this._inIterating=!0;for(var i=this._children,r=null==n,o=0,a=i.length;o<a;o++){var s=i[o];(r||s.constructor===n)&&e.call(t,s,o)}this._inIterating=!1},setLocalTransform:function(e){u.copy(this.localTransform._array,e._array),this.decomposeLocalTransform()},decomposeLocalTransform:function(e){var t=e?null:this.scale;this.localTransform.decomposeMatrix(t,this.rotation,this.position)},setWorldTransform:function(e){u.copy(this.worldTransform._array,e._array),this.decomposeWorldTransform()},decomposeWorldTransform:function(){var e=u.create();return function(t){var n=this.localTransform,i=this.worldTransform;this._parent?(u.invert(e,this._parent.worldTransform._array),u.multiply(n._array,e,i._array)):u.copy(n._array,i._array);var r=t?null:this.scale;n.decomposeMatrix(r,this.rotation,this.position)}}(),transformNeedsUpdate:function(){return this.position._dirty||this.rotation._dirty||this.scale._dirty},updateLocalTransform:function(){var e=this.position,t=this.rotation,n=this.scale;if(this.transformNeedsUpdate()){var i=this.localTransform._array;u.fromRotationTranslation(i,t._array,e._array),u.scale(i,i,n._array),t._dirty=!1,n._dirty=!1,e._dirty=!1,this._needsUpdateWorldTransform=!0}},updateWorldTransform:function(){var e=this.localTransform._array,t=this.worldTransform._array;this._parent?u.multiplyAffine(t,this._parent.worldTransform._array,e):u.copy(t,e)},update:function(e){this.autoUpdateLocalTransform?this.updateLocalTransform():e=!0,(e||this._needsUpdateWorldTransform)&&(this.updateWorldTransform(),e=!0,this._needsUpdateWorldTransform=!1);for(var t=this._children,n=0,i=t.length;n<i;n++)t[n].update(e)},getBoundingBox:function(){function e(e){return!e.invisible}return function(t,n){n=n||new c,t=t||e;var i=this._children;0===i.length&&(n.max.set(-1/0,-1/0,-1/0),n.min.set(1/0,1/0,1/0));for(var r=new c,o=0;o<i.length;o++){var a=i[o];t(a)&&(a.getBoundingBox(t,r),a.updateLocalTransform(),r.isFinite()&&r.applyTransform(a.localTransform),0===o?n.copy(r):n.union(r))}return n}}(),getWorldPosition:function(e){if(this.transformNeedsUpdate()){for(var t=this;t&&t.getParent()&&t.getParent().transformNeedsUpdate();)t=t.getParent();t.update()}var n=this.worldTransform._array;if(e){var i=e._array;return i[0]=n[12],i[1]=n[13],i[2]=n[14],e}return new o(n[12],n[13],n[14])},clone:function(){var e=new this.constructor,t=this._children;e.setName(this.name),e.position.copy(this.position),e.rotation.copy(this.rotation),e.scale.copy(this.scale);for(var n=0;n<t.length;n++)e.add(t[n].clone());return e},rotateAround:function(){var e=new o,t=new s;return function(n,i,r){e.copy(this.position).subtract(n);var o=this.localTransform;o.identity(),o.translate(n),o.rotate(r,i),t.fromRotationTranslation(this.rotation,e),o.multiply(t),o.scale(this.scale),this.decomposeLocalTransform(),this._needsUpdateWorldTransform=!0}}(),lookAt:function(){var e=new s;return function(t,n){e.lookAt(this.position,t,n||this.localTransform.y).invert(),this.setLocalTransform(e)}}()});t.exports=h},function(e,t,i){"use strict";function n(e,t){if(t.castShadow&&!e.castShadow)return!0}var r=i(30),o=i(16),a=i(13),s=r.extend(function(){return{material:null,autoUpdate:!0,opaqueQueue:[],transparentQueue:[],lights:[],viewBoundingBoxLastFrame:new a,_lightUniforms:{},_lightNumber:{},_opaqueObjectCount:0,_transparentObjectCount:0,_nodeRepository:{}}},function(){this._scene=this},{addToScene:function(e){e.name&&(this._nodeRepository[e.name]=e)},removeFromScene:function(e){e.name&&delete this._nodeRepository[e.name]},getNode:function(e){return this._nodeRepository[e]},cloneNode:function(e){var t=e.clone(),n={},i=function(r,o){r.skeleton&&(o.skeleton=r.skeleton.clone(e,t),o.joints=r.joints.slice()),r.material&&(n[r.material.__GUID__]={oldMat:r.material});for(var a=0;a<r._children.length;a++)i(r._children[a],o._children[a])};i(e,t);for(var r in n)n[r].newMat=n[r].oldMat.clone();return t.traverse(function(e){e.material&&(e.material=n[e.material.__GUID__].newMat)}),t},update:function(e,t){if(this.autoUpdate||e){r.prototype.update.call(this,e);var n=this.lights,i=this.material&&this.material.transparent;if(this._opaqueObjectCount=0,this._transparentObjectCount=0,n.length=0,this._updateRenderQueue(this,i),this.opaqueQueue.length=this._opaqueObjectCount,this.transparentQueue.length=this._transparentObjectCount,!t){var o=this._lightNumber;for(var a in o)for(var s in o[a])o[a][s]=0;for(var l=0;l<n.length;l++){var c=n[l],a=c.group;o[a]||(o[a]={}),o[a][c.type]=o[a][c.type]||0,o[a][c.type]++}this._updateLightUniforms()}}},_updateRenderQueue:function(e,t){if(!e.invisible)for(var n=0;n<e._children.length;n++){var i=e._children[n];i instanceof o&&this.lights.push(i),i.isRenderable()&&(i.material.transparent||t?this.transparentQueue[this._transparentObjectCount++]=i:this.opaqueQueue[this._opaqueObjectCount++]=i),i._children.length>0&&this._updateRenderQueue(i)}},_updateLightUniforms:function(){var e=this.lights;e.sort(n);var t=this._lightUniforms;for(var i in t)for(var r in t[i])t[i][r].value.length=0;for(var o=0;o<e.length;o++){var a=e[o],i=a.group;for(var r in a.uniformTemplates){var s=a.uniformTemplates[r];t[i]||(t[i]={}),t[i][r]||(t[i][r]={type:"",value:[]});var l=s.value(a),c=t[i][r];switch(c.type=s.type+"v",s.type){case"1i":case"1f":case"t":c.value.push(l);break;case"2f":case"3f":case"4f":for(var u=0;u<l.length;u++)c.value.push(l[u])}}}},isShaderLightNumberChanged:function(e){var t=e.lightGroup;for(var n in this._lightNumber[t])if(this._lightNumber[t][n]!==e.lightNumber[n])return!0;for(var n in e.lightNumber)if(this._lightNumber[t][n]!==e.lightNumber[n])return!0;return!1},setShaderLightNumber:function(e){var t=e.lightGroup;for(var n in this._lightNumber[t])e.lightNumber[n]=this._lightNumber[t][n];e.dirty()},setLightUniforms:function(e,t){var n=e.lightGroup;for(var i in this._lightUniforms[n]){var r=this._lightUniforms[n][i];if("tv"===r.type)for(var o=0;o<r.value.length;o++){var a=r.value[o],s=e.currentTextureSlot(),l=e.setUniform(t,"1i",i,s);l&&e.useCurrentTextureSlot(t,a)}else e.setUniform(t,r.type,i,r.value)}},dispose:function(){this.material=null,this.opaqueQueue=[],this.transparentQueue=[],this.lights=[],this._lightUniforms={},this._lightNumber={},this._nodeRepository={}}});e.exports=s},function(e,t,n){"use strict";var i=n(5),r=i.extend(function(){return{name:"",inputLinks:{},outputLinks:{},_prevOutputTextures:{},_outputTextures:{},_outputReferences:{},_rendering:!1,_rendered:!1,_compositor:null}},{updateParameter:function(e,t){var n=this.outputs[e],i=n.parameters,r=n._parametersCopy;if(r||(r=n._parametersCopy={}),i)for(var o in i)"width"!==o&&"height"!==o&&(r[o]=i[o]);var a,s;return a=i.width instanceof Function?i.width.call(this,t):i.width,s=i.height instanceof Function?i.height.call(this,t):i.height,r.width===a&&r.height===s||this._outputTextures[e]&&this._outputTextures[e].dispose(t.gl),r.width=a,r.height=s,r},setParameter:function(e,t){},getParameter:function(e){},setParameters:function(e){for(var t in e)this.setParameter(t,e[t])},render:function(){},getOutput:function(e,t){if(null==t)return t=e,this._outputTextures[t];var n=this.outputs[t];return n?this._rendered?n.outputLastFrame?this._prevOutputTextures[t]:this._outputTextures[t]:this._rendering?(this._prevOutputTextures[t]||(this._prevOutputTextures[t]=this._compositor.allocateTexture(n.parameters||{})),this._prevOutputTextures[t]):(this.render(e),this._outputTextures[t]):void 0},removeReference:function(e){0==--this._outputReferences[e]&&(this.outputs[e].keepLastFrame?(this._prevOutputTextures[e]&&this._compositor.releaseTexture(this._prevOutputTextures[e]),this._prevOutputTextures[e]=this._outputTextures[e]):this._compositor.releaseTexture(this._outputTextures[e]))},link:function(e,t,n){this.inputLinks[e]={node:t,pin:n},t.outputLinks[n]||(t.outputLinks[n]=[]),t.outputLinks[n].push({node:this,pin:e}),this.pass.material.shader.enableTexture(e)},clear:function(){this.inputLinks={},this.outputLinks={}},updateReference:function(e){if(!this._rendering){this._rendering=!0;for(var t in this.inputLinks){var n=this.inputLinks[t];n.node.updateReference(n.pin)}this._rendering=!1}e&&this._outputReferences[e]++},beforeFrame:function(){this._rendered=!1;for(var e in this.outputLinks)this._outputReferences[e]=0},afterFrame:function(){for(var e in this.outputLinks)if(this._outputReferences[e]>0){var t=this.outputs[e];t.keepLastFrame?(this._prevOutputTextures[e]&&this._compositor.releaseTexture(this._prevOutputTextures[e]),this._prevOutputTextures[e]=this._outputTextures[e]):this._compositor.releaseTexture(this._outputTextures[e])}}});e.exports=r},function(e,t){e.exports=function(e){this.updateTooltip=function(e,t,n,i){t>=0?this.showTooltip(e,t,n,i):this.hideTooltip()},this.showTooltip=function(t,n,i,r){var o=t.getDataParams(n),a=t.formatTooltip(n);e.dispatchAction({type:"showTip",x:i,y:r,tooltip:{formatterParams:o,content:a}})},this.hideTooltip=function(){e.dispatchAction({type:"hideTip"})}}},function(e,t,i){function n(){}var r=i(2),o=i(57),a=i(58),s=i(0);n.prototype={constructor:n,setScene:function(e){this._scene=e,this._skybox&&this._skybox.attachScene(this._scene)},initLight:function(e){this._lightRoot=e,this.mainLight=new r.DirectionalLight({shadowBias:.005}),this.ambientLight=new r.AmbientLight,e.add(this.mainLight),e.add(this.ambientLight)},updateLight:function(e){var t=this.mainLight,n=this.ambientLight,i=e.getModel("light"),o=i.getModel("main"),a=i.getModel("ambient");t.intensity=o.get("intensity"),n.intensity=a.get("intensity"),t.color=r.parseColor(o.get("color")).slice(0,3),n.color=r.parseColor(a.get("color")).slice(0,3);var s=o.get("alpha")||0,l=o.get("beta")||0;t.position.setArray(r.directionFromAlphaBeta(s,l)),t.lookAt(r.Vector3.ZERO),t.castShadow=o.get("shadow"),t.shadowResolution=r.getShadowResolution(o.get("shadowQuality"))},updateAmbientCubemap:function(e,t,n){var i=t.getModel("light.ambientCubemap"),a=i.get("texture");if(a){this._cubemapLightsCache=this._cubemapLightsCache||{};var s=this._cubemapLightsCache[a];if(!s){var l=this;s=this._cubemapLightsCache[a]=r.createAmbientCubemap(i.option,e,n,function(){l._skybox instanceof o&&l._skybox.setEnvironmentMap(s.specular.cubemap),n.getZr().refresh()})}this._lightRoot.add(s.diffuse),this._lightRoot.add(s.specular),this._currentCubemapLights=s}else this._currentCubemapLights&&(this._lightRoot.remove(this._currentCubemapLights.diffuse),this._lightRoot.remove(this._currentCubemapLights.specular),this._currentCubemapLights=null)},updateSkybox:function(e,t,i){function n(){return c._skybox instanceof a||(c._skybox&&c._skybox.dispose(e.gl),c._skybox=new a),c._skybox}var l=t.get("environment"),c=this;if(l&&"none"!==l)if("auto"===l)if(this._currentCubemapLights){var u=function(){return c._skybox instanceof o||(c._skybox&&c._skybox.dispose(e.gl),c._skybox=new o),c._skybox}(),d=this._currentCubemapLights.specular.cubemap;u.setEnvironmentMap(d),this._scene&&u.attachScene(this._scene),u.material.set("lod",2)}else this._skybox&&this._skybox.detachScene();else if("object"==typeof l&&l.colorStops||"string"==typeof l&&s.color.parse(l)){var h=n(),p=new r.Texture2D({anisotropic:8,flipY:!1});h.setEnvironmentMap(p);var f=p.image=document.createElement("canvas");f.width=f.height=16;var g=f.getContext("2d"),m=new s.graphic.Rect({shape:{x:0,y:0,width:16,height:16},style:{fill:l}});m.brush(g),h.attachScene(this._scene)}else{var h=n(),p=r.loadTexture(l,i,{anisotropic:8,flipY:!1});h.setEnvironmentMap(p),h.attachScene(this._scene)}else this._skybox&&this._skybox.detachScene(this._scene),this._skybox=null;var v=t.coordinateSystem;if(this._skybox)if(!v||!v.viewGL||"auto"===l||l.match&&l.match(/.hdr$/))this._skybox.material.shader.undefine("fragment","SRGB_DECODE");else{var _=v.viewGL.isLinearSpace()?"define":"undefine";this._skybox.material.shader[_]("fragment","SRGB_DECODE")}}},e.exports=n},function(e,t){e.exports={defaultOption:{light:{main:{shadow:!1,shadowQuality:"high",color:"#fff",intensity:1,alpha:0,beta:0},ambient:{color:"#fff",intensity:.2},ambientCubemap:{texture:null,exposure:1,diffuseIntensity:.5,specularIntensity:.5}}}}},function(e,t){e.exports={defaultOption:{postEffect:{enable:!1,bloom:{enable:!0,intensity:.1},depthOfField:{enable:!1,focalRange:20,focalDistance:50,blurRadius:10,fstop:2.8,quality:"medium"},SSAO:{enable:!1,radius:2,quality:"medium",intensity:1},colorCorrection:{enable:!0,exposure:0,brightness:0,contrast:1,saturation:1,lookupTexture:""},FXAA:{enable:!1}},temporalSuperSampling:{enable:"auto"}}}},function(e,t){e.exports={defaultOption:{viewControl:{autoRotate:!1,damping:.8,rotateSensitivity:1,zoomSensitivity:1,panSensitivity:1,autoRotateAfterStill:3,distance:150,minDistance:40,maxDistance:400,center:[0,0,0],alpha:0,beta:0,minAlpha:-90,maxAlpha:90}},setView:function(e){e=e||{},this.option.viewControl=this.option.viewControl||{},null!=e.alpha&&(this.option.viewControl.alpha=e.alpha),null!=e.beta&&(this.option.viewControl.beta=e.beta),null!=e.distance&&(this.option.viewControl.distance=e.distance),null!=e.center&&(this.option.viewControl.center=e.center)}}},function(e,t,n){var i=n(5),r=n(24),o=n(3),a=(n(55),n(4)),s=i.extend(function(){return{zr:null,viewGL:null,_center:new o,minDistance:.5,maxDistance:1.5,minAlpha:-90,maxAlpha:90,minBeta:-1/0,maxBeta:1/0,autoRotateAfterStill:0,_mode:"rotate",damping:.8,rotateSensitivity:1,zoomSensitivity:1,panSensitivity:1,_camera:null,_needsUpdate:!1,_rotating:!1,_phi:0,_theta:0,_mouseX:0,_mouseY:0,_rotateVelocity:new r,_panVelocity:new r,_distance:500,_zoomSpeed:0,_stillTimeout:0,_animators:[]}},function(){this._mouseDownHandler=this._mouseDownHandler.bind(this),this._mouseWheelHandler=this._mouseWheelHandler.bind(this),this._mouseMoveHandler=this._mouseMoveHandler.bind(this),this._mouseUpHandler=this._mouseUpHandler.bind(this),this._pinchHandler=this._pinchHandler.bind(this),this._update=this._update.bind(this)},{init:function(){var e=this.zr;e&&(e.on("mousedown",this._mouseDownHandler),e.on("globalout",this._mouseUpHandler),e.on("mousewheel",this._mouseWheelHandler),e.on("pinch",this._pinchHandler),e.animation.on("frame",this._update))},dispose:function(){var e=this.zr;e&&(e.off("mousedown",this._mouseDownHandler),e.off("mousemove",this._mouseMoveHandler),e.off("mouseup",this._mouseUpHandler),e.off("mousewheel",this._mouseWheelHandler),e.off("pinch",this._pinchHandler),e.off("globalout",this._mouseUpHandler),e.animation.off("frame",this._update)),this.stopAllAnimation()},getDistance:function(){return this._distance},setDistance:function(e){this._distance=e,this._needsUpdate=!0},getAlpha:function(){return this._theta/Math.PI*180},getBeta:function(){return-this._phi/Math.PI*180},getCenter:function(){return this._center.toArray()},setAlpha:function(e){e=Math.max(Math.min(this.maxAlpha,e),this.minAlpha),this._theta=e/180*Math.PI,this._needsUpdate=!0},setBeta:function(e){e=Math.max(Math.min(this.maxBeta,e),this.minBeta),this._phi=-e/180*Math.PI,this._needsUpdate=!0},setCenter:function(e){this._center.setArray(e)},setCamera:function(e){this._camera=e,this._needsUpdate=!0},setViewGL:function(e){this.viewGL=e},getCamera:function(){return this._camera},setFromViewControlModel:function(e,t){this.autoRotate=e.get("autoRotate"),this.autoRotateAfterStill=e.get("autoRotateAfterStill"),this.damping=e.get("damping"),this.minDistance=e.get("minDistance")+t,this.maxDistance=e.get("maxDistance")+t;var n=e.get("distance")+t;this._distance!==n&&this.setDistance(n),this.minAlpha=a.firstNotNull(e.get("minAlpha"),-90),this.maxAlpha=a.firstNotNull(e.get("maxAlpha"),90),this.minBeta=a.firstNotNull(e.get("minBeta"),-1/0),this.maxBeta=a.firstNotNull(e.get("maxBeta"),1/0),this.rotateSensitivity=a.firstNotNull(e.get("rotateSensitivity"),1),this.zoomSensitivity=a.firstNotNull(e.get("zoomSensitivity"),1),this.panSensitivity=a.firstNotNull(e.get("panSensitivity"),1),this.setAlpha(e.get("alpha")||0),this.setBeta(e.get("beta")||0),this.setCenter(e.get("center")||[0,0,0])},animateTo:function(e){var t=this.zr,n=this,i={},r={};return null!=e.distance&&(i.distance=this.getDistance(),r.distance=e.distance),null!=e.alpha&&(i.alpha=this.getAlpha(),r.alpha=e.alpha),null!=e.distance&&(i.distance=this.getDistance(),r.distance=e.distance),this._addAnimator(t.animation.animate(this).when(e.time||1e3,r).during(function(){n._needsUpdate=!0})).start(e.easing||"linear")},stopAllAnimation:function(){for(var e=0;e<this._animators.length;e++)this._animators[e].stop();this._animators.length=0},_isAnimating:function(){return this._animators.length>0},_update:function(e){this._rotating?(this._phi-=1e-4*e,this._needsUpdate=!0):this._rotateVelocity.len()>0&&(this._needsUpdate=!0),(Math.abs(this._zoomSpeed)>.1||this._panVelocity.len()>0)&&(this._needsUpdate=!0),this._needsUpdate&&(this._updateDistance(Math.min(e,30)),this._updatePan(Math.min(e,30)),this._updateRotate(Math.min(e,30)),this._updateTransform(),this._camera.update(),this.zr&&this.zr.refresh(),this.trigger("update"),this._needsUpdate=!1)},_updateRotate:function(e){var t=this._rotateVelocity;this._phi=t.y*e/20+this._phi,this._theta=t.x*e/20+this._theta,this.setAlpha(this.getAlpha()),this.setBeta(this.getBeta()),this._vectorDamping(t,this.damping)},_updateDistance:function(e){this._setDistance(this._distance+this._zoomSpeed*e/20),this._zoomSpeed*=this.damping},_setDistance:function(e){this._distance=Math.max(Math.min(e,this.maxDistance),this.minDistance)},_updatePan:function(e){var t=this._panVelocity,n=this._distance,i=this._camera,r=i.worldTransform.y,o=i.worldTransform.x;this._center.scaleAndAdd(o,-t.x*n/200).scaleAndAdd(r,-t.y*n/200),this._vectorDamping(t,0)},_updateTransform:function(){var e=this._camera,t=new o,n=this._theta+Math.PI/2,i=this._phi+Math.PI/2,r=Math.sin(n);t.x=r*Math.cos(i),t.y=-Math.cos(n),t.z=r*Math.sin(i),e.position.copy(this._center).scaleAndAdd(t,this._distance),e.rotation.identity().rotateY(-this._phi).rotateX(-this._theta)},_startCountingStill:function(){clearTimeout(this._stillTimeout);var e=this.autoRotateAfterStill,t=this;!isNaN(e)&&e>0&&(this._stillTimeout=setTimeout(function(){t._rotating=!0},1e3*e))},_vectorDamping:function(e,t){var n=e.len();n*=t,n<1e-4&&(n=0),e.normalize().scale(n)},_decomposeTransform:function(){if(this._camera){var e=new o;e.eulerFromQuat(this._camera.rotation.normalize(),"ZYX"),this._theta=-e.x,this._phi=-e.y,this.setBeta(this.getBeta()),this.setAlpha(this.getAlpha()),this._setDistance(this._camera.position.dist(this._center))}},_mouseDownHandler:function(e){if(!e.target&&!this._isAnimating()){var t=e.offsetX,n=e.offsetY;this.viewGL&&!this.viewGL.containPoint(t,n)||(this.zr.on("mousemove",this._mouseMoveHandler),this.zr.on("mouseup",this._mouseUpHandler),0===e.event.button?this._mode="rotate":1===e.event.button&&(this._mode="pan"),this._rotateVelocity.set(0,0),this._rotating=!1,this.autoRotate&&this._startCountingStill(),this._mouseX=e.offsetX,this._mouseY=e.offsetY)}},_mouseMoveHandler:function(e){this._isAnimating()||("rotate"===this._mode?(this._rotateVelocity.y=(e.offsetX-this._mouseX)/this.zr.getHeight()*2*this.rotateSensitivity,this._rotateVelocity.x=(e.offsetY-this._mouseY)/this.zr.getWidth()*2*this.rotateSensitivity):"pan"===this._mode&&(this._panVelocity.x=(e.offsetX-this._mouseX)/this.zr.getWidth()*this.panSensitivity*400,this._panVelocity.y=(-e.offsetY+this._mouseY)/this.zr.getHeight()*this.panSensitivity*400),this._mouseX=e.offsetX,this._mouseY=e.offsetY,e.event.preventDefault())},_mouseWheelHandler:function(e){if(!this._isAnimating()){var t=e.event.wheelDelta||-e.event.detail;this._zoomHandler(e,t)}},_pinchHandler:function(e){this._isAnimating()||this._zoomHandler(e,e.pinchScale>1?1:-1)},_zoomHandler:function(e,t){if(0!==t){var n=e.offsetX,i=e.offsetY;if(!this.viewGL||this.viewGL.containPoint(n,i)){var r=Math.max(Math.min(this._distance-this.minDistance,this.maxDistance-this._distance));this._zoomSpeed=(t>0?-1:1)*Math.max(r/20*this.zoomSensitivity,.5),this._rotating=!1,this.autoRotate&&"rotate"===this._mode&&this._startCountingStill(),e.event.preventDefault()}}},_mouseUpHandler:function(){this.zr.off("mousemove",this._mouseMoveHandler),this.zr.off("mouseup",this._mouseUpHandler)},_addAnimator:function(e){var t=this._animators;return t.push(e),e.done(function(){var n=t.indexOf(e);n>=0&&t.splice(n,1)}),e}});Object.defineProperty(s.prototype,"autoRotate",{get:function(e){return this._autoRotate},set:function(e){this._autoRotate=e,this._rotating=e}}),e.exports=s},function(e,t){e.exports="@export ecgl.lines3D.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\nattribute vec3 position: POSITION;\nattribute vec4 a_Color : COLOR;\nvarying vec4 v_Color;\n\nvoid main()\n{\n    gl_Position = worldViewProjection * vec4(position, 1.0);\n    v_Color = a_Color;\n}\n\n@end\n\n@export ecgl.lines3D.fragment\n\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\n\nvarying vec4 v_Color;\n\n@import qtek.util.srgb\n\nvoid main()\n{\n#ifdef SRGB_DECODE\n    gl_FragColor = sRGBToLinear(color * v_Color);\n#else\n    gl_FragColor = color * v_Color;\n#endif\n}\n@end\n\n\n\n@export ecgl.lines3D.clipNear\n\nvec4 clipNear(vec4 p1, vec4 p2) {\n    float n = (p1.w - near) / (p1.w - p2.w);\n        return vec4(mix(p1.xy, p2.xy, n), -near, near);\n}\n\n@end\n\n@export ecgl.lines3D.expandLine\n    vec4 prevProj = worldViewProjection * vec4(positionPrev, 1.0);\n    vec4 currProj = worldViewProjection * vec4(position, 1.0);\n    vec4 nextProj = worldViewProjection * vec4(positionNext, 1.0);\n\n    if (currProj.w < 0.0) {\n        if (prevProj.w < 0.0) {\n            currProj = clipNear(currProj, nextProj);\n        }\n        else {\n            currProj = clipNear(currProj, prevProj);\n        }\n    }\n\n    vec2 prevScreen = (prevProj.xy / abs(prevProj.w) + 1.0) * 0.5 * viewport.zw;\n    vec2 currScreen = (currProj.xy / abs(currProj.w) + 1.0) * 0.5 * viewport.zw;\n    vec2 nextScreen = (nextProj.xy / abs(nextProj.w) + 1.0) * 0.5 * viewport.zw;\n\n    vec2 dir;\n    float len = offset;\n        if (position == positionPrev) {\n        dir = normalize(nextScreen - currScreen);\n    }\n        else if (position == positionNext) {\n        dir = normalize(currScreen - prevScreen);\n    }\n    else {\n        vec2 dirA = normalize(currScreen - prevScreen);\n        vec2 dirB = normalize(nextScreen - currScreen);\n\n        vec2 tanget = normalize(dirA + dirB);\n\n                float miter = 1.0 / max(dot(tanget, dirA), 0.5);\n        len *= miter;\n        dir = tanget;\n    }\n\n    dir = vec2(-dir.y, dir.x) * len;\n    currScreen += dir;\n\n    currProj.xy = (currScreen / viewport.zw - 0.5) * 2.0 * abs(currProj.w);\n@end\n\n\n@export ecgl.meshLines3D.vertex\n\nattribute vec3 position: POSITION;\nattribute vec3 positionPrev;\nattribute vec3 positionNext;\nattribute float offset;\nattribute vec4 a_Color : COLOR;\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform vec4 viewport : VIEWPORT;\nuniform float near : NEAR;\n\nvarying vec4 v_Color;\n\n@import ecgl.wireframe.common.vertexHeader\n\n@import ecgl.lines3D.clipNear\n\nvoid main()\n{\n    @import ecgl.lines3D.expandLine\n\n    gl_Position = currProj;\n\n    v_Color = a_Color;\n\n    @import ecgl.wireframe.common.vertexMain\n}\n@end\n\n\n@export ecgl.meshLines3D.fragment\n\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\n\nvarying vec4 v_Color;\n\n@import ecgl.wireframe.common.fragmentHeader\n\n@import qtek.util.srgb\n\nvoid main()\n{\n#ifdef SRGB_DECODE\n    gl_FragColor = sRGBToLinear(color * v_Color);\n#else\n    gl_FragColor = color * v_Color;\n#endif\n\n    @import ecgl.wireframe.common.fragmentMain\n}\n\n@end"},function(e,t,i){"use strict";function n(e,t,n,i,r){var o=0,a=0;null==i&&(i=1/0),null==r&&(r=1/0);var s=0;t.eachChild(function(l,c){var u,d,h=l.position,p=l.getBoundingRect(),f=t.childAt(c+1),g=f&&f.getBoundingRect();if("horizontal"===e){var m=p.width+(g?-g.x+p.x:0);u=o+m,u>i||l.newline?(o=0,u=m,a+=s+n,s=p.height):s=Math.max(s,p.height)}else{var v=p.height+(g?-g.y+p.y:0);d=a+v,d>r||l.newline?(o+=s+n,a=0,d=v,s=p.width):s=Math.max(s,p.width)}l.newline||(h[0]=o,h[1]=a,"horizontal"===e?o=u+n:a=d+n)})}var r=i(14),l=i(83),c=i(68),u=i(175),d=c.parsePercent,h=r.each,p={},f=p.LOCATION_PARAMS=["left","right","top","bottom","width","height"],g=p.HV_NAMES=[["width","left","right"],["height","top","bottom"]];p.box=n,p.vbox=r.curry(n,"vertical"),p.hbox=r.curry(n,"horizontal"),p.getAvailableSize=function(e,t,n){var i=t.width,r=t.height,o=d(e.x,i),a=d(e.y,r),s=d(e.x2,i),l=d(e.y2,r);return(isNaN(o)||isNaN(parseFloat(e.x)))&&(o=0),(isNaN(s)||isNaN(parseFloat(e.x2)))&&(s=i),(isNaN(a)||isNaN(parseFloat(e.y)))&&(a=0),(isNaN(l)||isNaN(parseFloat(e.y2)))&&(l=r),n=u.normalizeCssArray(n||0),{width:Math.max(s-o-n[1]-n[3],0),height:Math.max(l-a-n[0]-n[2],0)}},p.getLayoutRect=function(e,t,n){n=u.normalizeCssArray(n||0);var i=t.width,r=t.height,o=d(e.left,i),a=d(e.top,r),s=d(e.right,i),c=d(e.bottom,r),h=d(e.width,i),p=d(e.height,r),f=n[2]+n[0],g=n[1]+n[3],m=e.aspect;switch(isNaN(h)&&(h=i-s-g-o),isNaN(p)&&(p=r-c-f-a),isNaN(h)&&isNaN(p)&&(m>i/r?h=.8*i:p=.8*r),null!=m&&(isNaN(h)&&(h=m*p),isNaN(p)&&(p=h/m)),isNaN(o)&&(o=i-s-h-g),isNaN(a)&&(a=r-c-p-f),e.left||e.right){case"center":o=i/2-h/2-n[3];break;case"right":o=i-h-g}switch(e.top||e.bottom){case"middle":case"center":a=r/2-p/2-n[0];break;case"bottom":a=r-p-f}o=o||0,a=a||0,isNaN(h)&&(h=i-o-(s||0)),isNaN(p)&&(p=r-a-(c||0));var v=new l(o+n[3],a+n[0],h,p);return v.margin=n,v},p.positionElement=function(e,t,n,i,o){var a=!o||!o.hv||o.hv[0],s=!o||!o.hv||o.hv[1],c=o&&o.boundingMode||"all";if(a||s){var u;if("raw"===c)u="group"===e.type?new l(0,0,+t.width||0,+t.height||0):e.getBoundingRect();else if(u=e.getBoundingRect(),e.needLocalTransform()){var d=e.getLocalTransform();u=u.clone(),u.applyTransform(d)}t=p.getLayoutRect(r.defaults({width:u.width,height:u.height},t),n,i);var h=e.position,f=a?t.x-u.x:0,g=s?t.y-u.y:0;e.attr("position","raw"===c?[f,g]:[h[0]+f,h[1]+g])}},p.sizeCalculable=function(e,t){return null!=e[g[t][0]]||null!=e[g[t][1]]&&null!=e[g[t][2]]},p.mergeLayoutParam=function(e,t,i){function n(n,i){var r={},s=0,c={},u=0;if(h(n,function(t){c[t]=e[t]}),h(n,function(e){a(t,e)&&(r[e]=c[e]=t[e]),o(r,e)&&s++,o(c,e)&&u++}),l[i])return o(t,n[1])?c[n[2]]=null:o(t,n[2])&&(c[n[1]]=null),c;if(2!==u&&s){if(s>=2)return r;for(var d=0;d<n.length;d++){var p=n[d];if(!a(r,p)&&a(e,p)){r[p]=e[p];break}}return r}return c}function a(e,t){return e.hasOwnProperty(t)}function o(e,t){return null!=e[t]&&"auto"!==e[t]}function s(e,t,n){h(e,function(e){t[e]=n[e]})}!r.isObject(i)&&(i={});var l=i.ignoreSize;!r.isArray(l)&&(l=[l,l]);var c=n(g[0],0),u=n(g[1],1);s(g[0],e,c),s(g[1],e,u)},p.getLayoutParams=function(e){return p.copyLayoutParams({},e)},p.copyLayoutParams=function(e,t){return t&&e&&h(f,function(n){t.hasOwnProperty(n)&&(e[n]=t[n])}),e},e.exports=p},function(e,t){e.exports=function(e,t,n,i,r){i.eachRawSeriesByType(e,function(e){var r=e.getData(),o=e.get("symbol")||t,a=e.get("symbolSize");r.setVisual({legendSymbol:n||o,symbol:o,symbolSize:a}),i.isSeriesFiltered(e)||("function"==typeof a&&r.each(function(t){var n=e.getRawValue(t),i=e.getDataParams(t);r.setItemVisual(t,"symbolSize",a(n,i))}),r.each(function(e){var t=r.getItemModel(e),n=t.getShallow("symbol",!0),i=t.getShallow("symbolSize",!0);null!=n&&r.setItemVisual(e,"symbol",n),null!=i&&r.setItemVisual(e,"symbolSize",i)}))})}},function(e,t,n){"use strict";var i=n(69),r=i.extend({left:-1,right:1,near:-1,far:1,top:1,bottom:-1},{updateProjectionMatrix:function(){this.projectionMatrix.ortho(this.left,this.right,this.bottom,this.top,this.near,this.far)},decomposeProjectionMatrix:function(){var e=this.projectionMatrix._array;this.left=(-1-e[12])/e[0],this.right=(1-e[12])/e[0],this.top=(1-e[13])/e[5],this.bottom=(-1-e[13])/e[5],this.near=-(-1-e[14])/e[10],this.far=-(1-e[14])/e[10]},clone:function(){var e=i.prototype.clone.call(this);return e.left=this.left,e.right=this.right,e.near=this.near,e.far=this.far,e.top=this.top,e.bottom=this.bottom,e}});e.exports=r},function(e,t,n){"use strict";var i=n(69),r=i.extend({fov:50,aspect:1,near:.1,far:2e3},{updateProjectionMatrix:function(){var e=this.fov/180*Math.PI;this.projectionMatrix.perspective(e,this.aspect,this.near,this.far)},decomposeProjectionMatrix:function(){var e=this.projectionMatrix._array,t=2*Math.atan(1/e[5]);this.fov=t/Math.PI*180,this.aspect=e[5]/e[0],this.near=e[14]/(e[10]-1),this.far=e[14]/(e[10]+1)},clone:function(){var e=i.prototype.clone.call(this);return e.fov=this.fov,e.aspect=this.aspect,e.near=this.near,e.far=this.far,e}});e.exports=r},function(e,t,n){"use strict";var i=function(){this._contextId=0,this._caches=[],this._context={}};i.prototype={use:function(e,t){var n=this._caches;n[e]||(n[e]={},t&&(n[e]=t())),this._contextId=e,this._context=n[e]},put:function(e,t){this._context[e]=t},get:function(e){return this._context[e]},dirty:function(e){e=e||"";var t="__dt__"+e;this.put(t,!0)},dirtyAll:function(e){e=e||"";for(var t="__dt__"+e,n=this._caches,i=0;i<n.length;i++)n[i]&&(n[i][t]=!0)},fresh:function(e){e=e||"";var t="__dt__"+e;this.put(t,!1)},freshAll:function(e){e=e||"";for(var t="__dt__"+e,n=this._caches,i=0;i<n.length;i++)n[i]&&(n[i][t]=!1)},isDirty:function(e){e=e||"";var t="__dt__"+e,n=this._context;return!n.hasOwnProperty(t)||!0===n[t]},deleteContext:function(e){delete this._caches[e],this._context={}},delete:function(e){delete this._context[e]},clearAll:function(){this._caches={}},getContext:function(){return this._context},eachContext:function(e,t){Object.keys(this._caches).forEach(function(n){e&&e.call(t,n)})},miss:function(e){return!this._context.hasOwnProperty(e)}},i.prototype.constructor=i,e.exports=i},function(e,t,r){function n(e,t){return e&&t&&e[0]===t[0]&&e[1]===t[1]}function i(e,t){this._mesh=new l({renderOrder:10}),this.rootNode=new a.Node,this.rootNode.add(this._mesh),this.is2D=e,this._labelsBuilder=new c(256,256,t),this._labelsBuilder.getMesh().renderOrder=100,this.rootNode.add(this._labelsBuilder.getMesh()),this._api=t,this._spriteImageCanvas=document.createElement("canvas"),this._tooltip=new d(t)}var o=r(0),a=r(2),s=r(67),l=r(102),c=r(46),u=r(10),d=r(33);i.prototype={constructor:i,update:function(e,t,i){var r=e.getData(),o=this._getSymbolInfo(r),l=i.getDevicePixelRatio();o.maxSize=Math.min(2*o.maxSize,200);var c=[];o.aspect>1?(c[0]=o.maxSize,c[1]=o.maxSize/o.aspect):(c[1]=o.maxSize,c[0]=o.maxSize*o.aspect);var u=e.getModel("itemStyle").getItemStyle();c[0]=c[0]||1,c[1]=c[1]||1,this._symbolType===o.type&&n(this._symbolSize,c)&&this._lineWidth===u.lineWidth||(s.createSymbolSprite(o.type,c,{fill:"#fff",lineWidth:u.lineWidth,stroke:"transparent",shadowColor:"transparent",marginBias:10},this._spriteImageCanvas),s.createSDFFromCanvas(this._spriteImageCanvas,32,20,this._mesh.material.get("sprite").image),this._symbolType=o.type,this._symbolSize=c,this._lineWidth=u.lineWidth);var d=this._mesh.geometry,h=r.getLayout("points"),p=d.attributes;p.position.init(r.count()),p.size.init(r.count()),p.color.init(r.count());for(var f=p.position.value,g=[],m=this.is2D,v=this._spriteImageCanvas.width/o.maxSize*l,_=0;_<r.count();_++){var y=3*_,x=2*_;m?(f[y]=h[x],f[y+1]=h[x+1],f[y+2]=-10):(f[y]=h[y],f[y+1]=h[y+1],f[y+2]=h[y+2]);var b=r.getItemVisual(_,"color"),w=r.getItemVisual(_,"opacity");a.parseColor(b,g),g[3]*=w,p.color.set(_,g),g[3];var c=r.getItemVisual(_,"symbolSize");c=c instanceof Array?Math.max(c[0],c[1]):c,isNaN(c)&&(c=0),p.size.value[_]=c*v}this._mesh.sizeScale=v,d.dirty();var C="lighter"===e.get("blendMode")?a.additiveBlend:null,S=this._mesh.material;S.blend=C,S.set("lineWidth",u.lineWidth/20);var T=a.parseColor(u.stroke);S.set("color",[1,1,1,1]),S.set("strokeColor",T),this.is2D?(S.transparent=!0,S.depthMask=!1,S.depthTest=!1,d.sortVertices=!1):(S.depthTest=!0,S.transparent=!0,S.depthMask=!1,d.sortVertices=!0);var A=e.coordinateSystem;if(A&&A.viewGL){var M=A.viewGL.isLinearSpace()?"define":"undefine";this._mesh.material.shader[M]("fragment","SRGB_DECODE")}this._updateHandler(e,t,i),m||(this._labelsBuilder.updateData(r),this._labelsBuilder.getLabelPosition=function(e,t,n){var i=3*e;return[h[i],h[i+1],h[i+2]]},this._labelsBuilder.getLabelDistance=function(e,t,n){return d.attributes.size.get(e)/v/2+n},this._labelsBuilder.updateLabels()),this._api=i},_updateHandler:function(e,t,n){var i,r=e.getData(),o=this._mesh,a=-1,s=e.coordinateSystem&&"cartesian3D"===e.coordinateSystem.type;s&&(i=e.coordinateSystem.model),o.off("mousemove"),o.off("mouseout"),o.on("mousemove",function(t){var o=t.vertexIndex;this.highlight(r,o),o!==a&&(this.downplay(r,a),this.highlight(r,o),this._labelsBuilder.updateLabels([o]),s&&n.dispatchAction({type:"grid3DShowAxisPointer",value:[r.get("x",o),r.get("y",o),r.get("z",o)],grid3DIndex:i.componentIndex})),this._tooltip.updateTooltip(e,o,t.offsetX,t.offsetY),a=o},this),o.on("mouseout",function(e){this.downplay(r,e.vertexIndex),this._labelsBuilder.updateLabels(),a=-1,s&&n.dispatchAction({type:"grid3DHideAxisPointer",grid3DIndex:i.componentIndex}),this._tooltip.hideTooltip()},this)},updateView:function(e){var t=new u;u.mul(t,e.viewMatrix,this._mesh.worldTransform),u.mul(t,e.projectionMatrix,t),this._mesh.updateNDCPosition(t,this.is2D,this._api)},updateLayout:function(e,t,n){var i=e.getData(),r=this._mesh.geometry.attributes.position.value,o=i.getLayout("points");if(this.is2D)for(var a=0;a<o.length/2;a++){var s=3*a,l=2*a;r[s]=o[l],r[s+1]=o[l+1]}else for(var a=0;a<o.length;a++)r[a]=o[a];this._mesh.geometry.dirty()},highlight:function(e,t){var n=e.getItemModel(t),i=n.getModel("emphasis.itemStyle"),r=i.get("color"),s=i.get("opacity");if(null==r){var l=e.getItemVisual(t,"color");r=o.color.lift(l,-.4)}null==s&&(s=e.getItemVisual(t,"opacity"));var c=a.parseColor(r);c[3]*=s,this._mesh.geometry.attributes.color.set(t,c),this._mesh.geometry.dirtyAttribute("color"),this._api.getZr().refresh()},downplay:function(e,t){var n=e.getItemVisual(t,"color"),i=e.getItemVisual(t,"opacity"),r=a.parseColor(n);r[3]*=i,this._mesh.geometry.attributes.color.set(t,r),this._mesh.geometry.dirtyAttribute("color"),this._api.getZr().refresh()},setPositionTexture:function(e){this._mesh.material.set("positionTexture",e),this._mesh.material.shader[e?"enableTexture":"disableTexture"]("positionTexture")},getPointsMesh:function(){return this._mesh},_getSymbolInfo:function(e){var t,n=e.getItemVisual(0,"symbol")||"circle",i=0;return e.each(function(r){var o,a=e.getItemVisual(r,"symbolSize"),s=e.getItemVisual(r,"symbol");if(a instanceof Array)o=a[0]/a[1],i=Math.max(Math.max(a[0],a[1]),i);else{if(isNaN(a))return;o=1,i=Math.max(a,i)}n=s,t=o}),{maxSize:i,type:n,aspect:t}}},e.exports=i},function(e,t,i){function n(e,t,n){this._labelsMesh=new a,this._labelTextureSurface=new o({width:512,height:512,devicePixelRatio:n.getDevicePixelRatio(),onupdate:function(){n.getZr().refresh()}}),this._api=n,this._labelsMesh.material.set("textureAtlas",this._labelTextureSurface.getTexture())}var r=i(0),o=i(66),a=i(50);n.prototype.getLabelPosition=function(e,t,n){return[0,0,0]},n.prototype.getLabelDistance=function(e,t,n){return 0},n.prototype.getMesh=function(){return this._labelsMesh},n.prototype.updateData=function(e){this._labelsVisibilitiesBits&&this._labelsVisibilitiesBits.length===e.count()||(this._labelsVisibilitiesBits=new Uint8Array(e.count()));var t=["label","show"],n=["emphasis","label","show"];e.each(function(i){var r=e.getItemModel(i),o=r.get(t),a=r.get(n);null==a&&(a=o);var s=(o?1:0)|(a?2:0);this._labelsVisibilitiesBits[i]=s},!1,this),this._data=e},n.prototype.updateLabels=function(e){if(this._data){e=e||[];for(var t=e.length>0,n={},i=0;i<e.length;i++)n[e[i]]=!0;this._labelsMesh.geometry.convertToDynamicArray(!0),this._labelTextureSurface.clear();var o=["label"],a=["emphasis","label"],s=this._data.hostModel,l=this._data,c=s.getModel(o),u=s.getModel(a,c),d={left:"right",right:"left",top:"center",bottom:"center"},h={left:"middle",right:"middle",top:"bottom",bottom:"top"};l.each(function(e){var i=!1;if(t&&n[e]&&(i=!0),this._labelsVisibilitiesBits[e]&(i?2:1)){var p=l.getItemModel(e),f=p.getModel(i?a:o,i?u:c),g=f.get("distance")||0,m=f.get("position"),v=f.getModel("textStyle"),_=this._api.getDevicePixelRatio(),y=s.getFormattedLabel(e,i?"emphasis":"normal"),x=new r.graphic.Text({style:{text:y,font:v.getFont(),fill:v.get("color")||l.getItemVisual(e,"color")||"#000",opacity:v.get("opacity"),stroke:v.get("borderColor"),lineWidth:2*v.get("borderWidth"),textAlign:"left",textVerticalAlign:"top"}}),b=x.getBoundingRect(),w=this._labelTextureSurface.add(x),C=d[m]||"center",S=h[m]||"bottom";this._labelsMesh.geometry.addSprite(this.getLabelPosition(e,m,g),[b.width*_,b.height*_],w,C,S,this.getLabelDistance(e,m,g)*_)}},!1,this),this._labelsMesh.material.set("uvScale",this._labelTextureSurface.getCoordsScale()),this._labelTextureSurface.getZr().refreshImmediately(),this._labelsMesh.geometry.convertToTypedArray(),this._labelsMesh.geometry.dirty()}},e.exports=n},function(e,t){function r(e,t){for(var n=0,i=1/t,r=e;r>0;)n+=i*(r%t),r=Math.floor(r/t),i/=t;return n}e.exports=r},function(e,t,n){var i=n(0),r={};r.getFormattedLabel=function(e,t,n,r,o){n=n||"normal";var a=e.getData(r),s=a.getItemModel(t),l=e.getDataParams(t,r);null!=o&&l.value instanceof Array&&(l.value=l.value[o]);var c=s.get("normal"===n?["label","formatter"]:["emphasis","label","formatter"]);null==c&&(c=s.get(["label","formatter"]));var u;return"function"==typeof c?(l.status=n,u=c(l)):"string"==typeof c&&(u=i.format.formatTpl(c,l)),u},e.exports=r},function(e,n,i){var r=i(1).vec3,o=i(65),a=r.create(),s=r.create(),l=r.create();e.exports={needsSortTriangles:function(){return this.indices&&this.sortTriangles},needsSortTrianglesProgressively:function(){return this.needsSortTriangles()&&this.triangleCount>=2e4},doSortTriangles:function(e,t){var n=this.indices;if(0===t){var i=this.attributes.position,e=e._array;this._triangleZList&&this._triangleZList.length===this.triangleCount||(this._triangleZList=new Float32Array(this.triangleCount),this._sortedTriangleIndices=new Uint32Array(this.triangleCount),this._indicesTmp=new n.constructor(n.length),this._triangleZListTmp=new Float32Array(this.triangleCount));for(var o=0,c=0;c<n.length;){i.get(n[c++],a),i.get(n[c++],s),i.get(n[c++],l);var u=r.sqrDist(a,e),d=r.sqrDist(s,e),h=r.sqrDist(l,e),p=Math.min(u,d);p=Math.min(p,h),this._triangleZList[o++]=p}}for(var f=this._sortedTriangleIndices,c=0;c<f.length;c++)f[c]=c;if(this.triangleCount<2e4)0===t&&this._simpleSort(!0);else for(var c=0;c<3;c++)this._progressiveQuickSort(3*t+c);for(var g=this._indicesTmp,m=this._triangleZListTmp,v=this._triangleZList,c=0;c<this.triangleCount;c++){var _=3*f[c],y=3*c;g[y++]=n[_++],g[y++]=n[_++],g[y]=n[_],m[c]=v[f[c]]}var x=this._indicesTmp;this._indicesTmp=this.indices,this.indices=x;var x=this._triangleZListTmp;this._triangleZListTmp=this._triangleZList,this._triangleZList=x,this.dirtyIndices()},_simpleSort:function(e){function t(e,t){return n[t]-n[e]}var n=this._triangleZList,i=this._sortedTriangleIndices;e?i.sort(t):o.sort(i,t,0,i.length-1)},_progressiveQuickSort:function(e){var t=this._triangleZList,n=this._sortedTriangleIndices;this._quickSort=this._quickSort||new o,this._quickSort.step(n,function(e,n){return t[n]-t[e]},e)}}},function(e,t,n){var i=n(2),r=n(161);i.Shader.import(n(165)),e.exports=i.Mesh.extend(function(){return{geometry:new r({dynamic:!0}),material:new i.Material({shader:i.createShader("ecgl.labels3D"),transparent:!0,depthMask:!1}),culling:!1,castShadow:!1,ignorePicking:!0}})},function(e,t,n){"use strict";var i=n(5),r=n(17),o=n(8),a=(n(18),n(13)),s=n(10),l=n(81),c=n(19),u=n(24);n(9).import(n(206));var d=n(1),h=d.mat4,p=d.vec3,f=h.create,g=0,m={},v=i.extend(function(){return{canvas:null,_width:100,_height:100,devicePixelRatio:window.devicePixelRatio||1,clearColor:[0,0,0,0],clearBit:17664,alpha:!0,depth:!0,stencil:!1,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,throwError:!0,gl:null,viewport:{},__currentFrameBuffer:null,_viewportStack:[],_clearStack:[],_sceneRendering:null}},function(){this.canvas||(this.canvas=document.createElement("canvas"));var e=this.canvas;try{var t={alpha:this.alpha,depth:this.depth,stencil:this.stencil,antialias:this.antialias,premultipliedAlpha:this.premultipliedAlpha,preserveDrawingBuffer:this.preserveDrawingBuffer};if(this.gl=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),!this.gl)throw new Error;null==this.gl.__GLID__&&(this.gl.__GLID__=g++,r.initialize(this.gl)),this.resize()}catch(e){throw"Error creating WebGL Context "+e}},{resize:function(e,t){var n=this.canvas,i=this.devicePixelRatio;null!=e?(n.style.width=e+"px",n.style.height=t+"px",n.width=e*i,n.height=t*i,this._width=e,this._height=t):(this._width=n.width/i,this._height=n.height/i),this.setViewport(0,0,this._width,this._height)},getWidth:function(){return this._width},getHeight:function(){return this._height},getViewportAspect:function(){var e=this.viewport;return e.width/e.height},setDevicePixelRatio:function(e){this.devicePixelRatio=e,this.resize(this._width,this._height)},getDevicePixelRatio:function(){return this.devicePixelRatio},getExtension:function(e){return r.getExtension(this.gl,e)},setViewport:function(e,t,n,i,r){if("object"==typeof e){var o=e;e=o.x,t=o.y,n=o.width,i=o.height,r=o.devicePixelRatio}r=r||this.devicePixelRatio,this.gl.viewport(e*r,t*r,n*r,i*r),this.viewport={x:e,y:t,width:n,height:i,devicePixelRatio:r}},saveViewport:function(){this._viewportStack.push(this.viewport)},restoreViewport:function(){this._viewportStack.length>0&&this.setViewport(this._viewportStack.pop())},saveClear:function(){this._clearStack.push({clearBit:this.clearBit,clearColor:this.clearColor})},restoreClear:function(){if(this._clearStack.length>0){var e=this._clearStack.pop();this.clearColor=e.clearColor,this.clearBit=e.clearBit}},bindSceneRendering:function(e){this._sceneRendering=e},beforeRenderObject:function(){},afterRenderObject:function(){},render:function(e,t,n,i){var r=this.gl;this._sceneRendering=e;var o=this.clearColor;if(this.clearBit){r.colorMask(!0,!0,!0,!0),r.depthMask(!0);var a=this.viewport,s=!1,l=a.devicePixelRatio;(a.width!==this._width||a.height!==this._height||l&&l!==this.devicePixelRatio||a.x||a.y)&&(s=!0,r.enable(r.SCISSOR_TEST),r.scissor(a.x*l,a.y*l,a.width*l,a.height*l)),r.clearColor(o[0],o[1],o[2],o[3]),r.clear(this.clearBit),s&&r.disable(r.SCISSOR_TEST)}n||e.update(!1),t.getScene()||t.update(!0);var c=e.opaqueQueue,u=e.transparentQueue,d=e.material;if(e.trigger("beforerender",this,e,t),u.length>0)for(var g=f(),m=p.create(),v=0;v<u.length;v++){var _=u[v];h.multiplyAffine(g,t.viewMatrix._array,_.worldTransform._array),p.transformMat4(m,_.position._array,g),_.__depth=m[2]}c.sort(this.opaqueSortFunc),u.sort(this.transparentSortFunc),e.trigger("beforerender:opaque",this,c),e.viewBoundingBoxLastFrame.min.set(1/0,1/0,1/0),e.viewBoundingBoxLastFrame.max.set(-1/0,-1/0,-1/0),r.disable(r.BLEND),r.enable(r.DEPTH_TEST);var y=this.renderQueue(c,t,d,i);e.trigger("afterrender:opaque",this,c,y),e.trigger("beforerender:transparent",this,u),r.enable(r.BLEND);var x=this.renderQueue(u,t,d);e.trigger("afterrender:transparent",this,u,x);var b={};for(var w in y)b[w]=y[w]+x[w];return e.trigger("afterrender",this,e,t,b),this._sceneRendering=null,b},resetRenderStatus:function(){this._currentShader=null},renderQueue:function(e,t,n,i){var r={triangleCount:0,vertexCount:0,drawCallCount:0,meshCount:e.length,renderedMeshCount:0},o=this.viewport,a=o.devicePixelRatio,s=[o.x*a,o.y*a,o.width*a,o.height*a],u=this.devicePixelRatio,d=this.__currentFrameBuffer?[this.__currentFrameBuffer.getTextureWidth(),this.__currentFrameBuffer.getTextureHeight()]:[this._width*u,this._height*u],p=[s[2],s[3]],f=Date.now();h.copy(_.VIEW,t.viewMatrix._array),h.copy(_.PROJECTION,t.projectionMatrix._array),h.multiply(_.VIEWPROJECTION,t.projectionMatrix._array,_.VIEW),h.copy(_.VIEWINVERSE,t.worldTransform._array),h.invert(_.PROJECTIONINVERSE,_.PROJECTION),h.invert(_.VIEWPROJECTIONINVERSE,_.VIEWPROJECTION);var g,v,y,x,b,w,C,S=this.gl,T=this._sceneRendering;if(i){var A=new c({shader:l.get("qtek.prez")}),M=A.shader;C=[],M.bind(S),S.colorMask(!1,!1,!1,!1),S.depthMask(!0),S.enable(S.DEPTH_TEST);for(var E=0;E<e.length;E++){var I=e[E],D=I.worldTransform._array,k=I.geometry;if(h.multiplyAffine(_.WORLDVIEW,_.VIEW,D),!(k.boundingBox&&this.isFrustumCulled(I,T,t,_.WORLDVIEW,_.PROJECTION)||I.skeleton)){h.multiply(_.WORLDVIEWPROJECTION,_.VIEWPROJECTION,D),I.cullFace!==b&&(b=I.cullFace,S.cullFace(b)),I.frontFace!==w&&(w=I.frontFace,S.frontFace(w)),I.culling!==x&&(x=I.culling,x?S.enable(S.CULL_FACE):S.disable(S.CULL_FACE));var L=M.matrixSemantics.WORLDVIEWPROJECTION;M.setUniform(S,L.type,L.symbol,_.WORLDVIEWPROJECTION),I.render(S,A.shader),C.push(I)}}S.depthFunc(S.LEQUAL),S.colorMask(!0,!0,!0,!0),S.depthMask(!1),this._currentShader=null}else C=e;x=null,b=null,w=null;for(var E=0;E<C.length;E++){var I=C[E],k=I.geometry,D=I.worldTransform._array;if(h.multiplyAffine(_.WORLDVIEW,_.VIEW,D),!k.boundingBox||i||!this.isFrustumCulled(I,T,t,_.WORLDVIEW,_.PROJECTION)){var N=n||I.material;N!==g&&N.updateShader&&N.updateShader(S);var P=N.shader;if(h.copy(_.WORLD,D),h.multiply(_.WORLDVIEWPROJECTION,_.VIEWPROJECTION,D),(P.matrixSemantics.WORLDINVERSE||P.matrixSemantics.WORLDINVERSETRANSPOSE)&&h.invert(_.WORLDINVERSE,D),(P.matrixSemantics.WORLDVIEWINVERSE||P.matrixSemantics.WORLDVIEWINVERSETRANSPOSE)&&h.invert(_.WORLDVIEWINVERSE,_.WORLDVIEW),(P.matrixSemantics.WORLDVIEWPROJECTIONINVERSE||P.matrixSemantics.WORLDVIEWPROJECTIONINVERSETRANSPOSE)&&h.invert(_.WORLDVIEWPROJECTIONINVERSE,_.WORLDVIEWPROJECTION),I.beforeRender(S),this.beforeRenderObject(I,g,null),P.isEqual(null))P=null;else{T&&T.isShaderLightNumberChanged(P)&&T.setShaderLightNumber(P);var O=P.bind(S);if(O){if(m[P.__GUID__])continue;if(m[P.__GUID__]=!0,this.throwError)throw new Error(O);this.trigger("error",O)}P.setUniformOfSemantic(S,"VIEWPORT",s),P.setUniformOfSemantic(S,"WINDOW_SIZE",d),P.setUniformOfSemantic(S,"NEAR",t.near),P.setUniformOfSemantic(S,"FAR",t.far),P.setUniformOfSemantic(S,"DEVICEPIXELRATIO",a),P.setUniformOfSemantic(S,"TIME",f),P.setUniformOfSemantic(S,"VIEWPORT_SIZE",p),T&&T.setLightUniforms(P,S)}g!==N&&(i||(N.depthTest!==v&&(N.depthTest?S.enable(S.DEPTH_TEST):S.disable(S.DEPTH_TEST),v=N.depthTest),N.depthMask!==y&&(S.depthMask(N.depthMask),y=N.depthMask)),N.bind(S,P,g,null),g=N,N.transparent&&(N.blend?N.blend(S):(S.blendEquationSeparate(S.FUNC_ADD,S.FUNC_ADD),S.blendFuncSeparate(S.SRC_ALPHA,S.ONE_MINUS_SRC_ALPHA,S.ONE,S.ONE_MINUS_SRC_ALPHA))));for(var R=P.matrixSemanticKeys,z=0;z<R.length;z++){var F=R[z],L=P.matrixSemantics[F],B=_[F];if(L.isTranspose){var H=_[L.semanticNoTranspose];h.transpose(B,H)}P.setUniform(S,L.type,L.symbol,B)}I.cullFace!==b&&(b=I.cullFace,S.cullFace(b)),I.frontFace!==w&&(w=I.frontFace,S.frontFace(w)),I.culling!==x&&(x=I.culling,x?S.enable(S.CULL_FACE):S.disable(S.CULL_FACE));var V=I.render(S,P);V&&(r.triangleCount+=V.triangleCount,r.vertexCount+=V.vertexCount,r.drawCallCount+=V.drawCallCount,r.renderedMeshCount++),this.afterRenderObject(I,V),I.afterRender(S,V)}}return i&&S.depthFunc(S.LESS),r},isFrustumCulled:function(){var e=new a,t=new s;return function(n,i,r,o,a){var s=n.boundingBox||n.geometry.boundingBox;if(t._array=o,e.copy(s),e.applyTransform(t),i&&n.isRenderable()&&n.castShadow&&i.viewBoundingBoxLastFrame.union(e),n.frustumCulling){if(!e.intersectBoundingBox(r.frustum.boundingBox))return!0;t._array=a,e.max._array[2]>0&&e.min._array[2]<0&&(e.max._array[2]=-1e-20),e.applyProjection(t);var l=e.min._array,c=e.max._array;if(c[0]<-1||l[0]>1||c[1]<-1||l[1]>1||c[2]<-1||l[2]>1)return!0}return!1}}(),disposeScene:function(e){this.disposeNode(e,!0,!0),e.dispose()},disposeNode:function(e,t,n){var i={},r=this.gl;e.getParent()&&e.getParent().remove(e),e.traverse(function(e){e.geometry&&t&&e.geometry.dispose(r),e.material&&(i[e.material.__GUID__]=e.material),e.dispose&&e.dispose(r)});for(var o in i)i[o].dispose(r,n)},disposeShader:function(e){e.dispose(this.gl)},disposeGeometry:function(e){e.dispose(this.gl)},disposeTexture:function(e){e.dispose(this.gl)},disposeFrameBuffer:function(e){e.dispose(this.gl)},dispose:function(){r.dispose(this.gl)},screenToNDC:function(e,t,n){n||(n=new u),t=this._height-t;var i=this.viewport,r=n._array;return r[0]=(e-i.x)/i.width,r[0]=2*r[0]-1,r[1]=(t-i.y)/i.height,r[1]=2*r[1]-1,n}});v.opaqueSortFunc=v.prototype.opaqueSortFunc=function(e,t){return e.renderOrder===t.renderOrder?e.material.shader===t.material.shader?e.material===t.material?e.geometry.__GUID__-t.geometry.__GUID__:e.material.__GUID__-t.material.__GUID__:e.material.shader.__GUID__-t.material.shader.__GUID__:e.renderOrder-t.renderOrder},v.transparentSortFunc=v.prototype.transparentSortFunc=function(e,t){return e.renderOrder===t.renderOrder?e.__depth===t.__depth?e.material.shader===t.material.shader?e.material===t.material?e.geometry.__GUID__-t.geometry.__GUID__:e.material.__GUID__-t.material.__GUID__:e.material.shader.__GUID__-t.material.shader.__GUID__:e.__depth-t.__depth:e.renderOrder-t.renderOrder};var _={WORLD:f(),VIEW:f(),PROJECTION:f(),WORLDVIEW:f(),VIEWPROJECTION:f(),WORLDVIEWPROJECTION:f(),WORLDINVERSE:f(),VIEWINVERSE:f(),PROJECTIONINVERSE:f(),WORLDVIEWINVERSE:f(),VIEWPROJECTIONINVERSE:f(),WORLDVIEWPROJECTIONINVERSE:f(),WORLDTRANSPOSE:f(),VIEWTRANSPOSE:f(),PROJECTIONTRANSPOSE:f(),WORLDVIEWTRANSPOSE:f(),VIEWPROJECTIONTRANSPOSE:f(),WORLDVIEWPROJECTIONTRANSPOSE:f(),WORLDINVERSETRANSPOSE:f(),VIEWINVERSETRANSPOSE:f(),PROJECTIONINVERSETRANSPOSE:f(),WORLDVIEWINVERSETRANSPOSE:f(),VIEWPROJECTIONINVERSETRANSPOSE:f(),WORLDVIEWPROJECTIONINVERSETRANSPOSE:f()};v.COLOR_BUFFER_BIT=o.COLOR_BUFFER_BIT,v.DEPTH_BUFFER_BIT=o.DEPTH_BUFFER_BIT,v.STENCIL_BUFFER_BIT=o.STENCIL_BUFFER_BIT,e.exports=v},function(e,t){function r(e,t){this.action=e,this.context=t}var n={trigger:function(e){if(this.hasOwnProperty("__handlers__")&&this.__handlers__.hasOwnProperty(e)){var t=this.__handlers__[e],n=t.length,i=-1,r=arguments;switch(r.length){case 1:for(;++i<n;)t[i].action.call(t[i].context);return;case 2:for(;++i<n;)t[i].action.call(t[i].context,r[1]);return;case 3:for(;++i<n;)t[i].action.call(t[i].context,r[1],r[2]);return;case 4:for(;++i<n;)t[i].action.call(t[i].context,r[1],r[2],r[3]);return;case 5:for(;++i<n;)t[i].action.call(t[i].context,r[1],r[2],r[3],r[4]);return;default:for(;++i<n;)t[i].action.apply(t[i].context,Array.prototype.slice.call(r,1));return}}},on:function(e,t,n){if(e&&t){var i=this.__handlers__||(this.__handlers__={});if(i[e]){if(this.has(e,t))return}else i[e]=[];var o=new r(t,n||this);return i[e].push(o),this}},once:function(e,t,i){function n(){r.off(e,n),t.apply(this,arguments)}if(e&&t){var r=this;return this.on(e,n,i)}},before:function(e,t,n){if(e&&t)return e="before"+e,this.on(e,t,n)},after:function(e,t,n){if(e&&t)return e="after"+e,this.on(e,t,n)},success:function(e,t){return this.once("success",e,t)},error:function(e,t){return this.once("error",e,t)},off:function(e,t){var n=this.__handlers__||(this.__handlers__={});if(!t)return void(n[e]=[]);if(n[e]){for(var i=n[e],r=[],o=0;o<i.length;o++)t&&i[o].action!==t&&r.push(i[o]);n[e]=r}return this},has:function(e,t){var n=this.__handlers__;if(!n||!n[e])return!1;for(var i=n[e],r=0;r<i.length;r++)if(i[r].action===t)return!0}};e.exports=n},function(e,t,n){"use strict";var i=n(12),r=n(13),o=i.extend({widthSegments:1,heightSegments:1},function(){this.build()},{build:function(){for(var e=this.heightSegments,t=this.widthSegments,n=this.attributes,i=[],o=[],a=[],s=[],l=0;l<=e;l++)for(var c=l/e,u=0;u<=t;u++){var d=u/t;if(i.push([2*d-1,2*c-1,0]),o&&o.push([d,c]),a&&a.push([0,0,1]),u<t&&l<e){var h=u+l*(t+1);s.push([h,h+1,h+t+1]),s.push([h+t+1,h+1,h+t+2])}}n.position.fromArray(i),n.texcoord0.fromArray(o),n.normal.fromArray(a),this.initIndicesFromArray(s),this.boundingBox=new r,this.boundingBox.min.set(-1,-1,0),this.boundingBox.max.set(1,1,0)}});e.exports=o},function(e,t,n){"use strict";var i=(n(3),n(13)),r=n(79),o=n(1),a=o.vec3,s=a.set,l=a.copy,c=a.transformMat4,u=Math.min,d=Math.max,h=function(){this.planes=[];for(var e=0;e<6;e++)this.planes.push(new r);this.boundingBox=new i,this.vertices=[];for(var e=0;e<8;e++)this.vertices[e]=a.fromValues(0,0,0)};h.prototype={setFromProjection:function(e){var t=this.planes,n=e._array,i=n[0],r=n[1],o=n[2],a=n[3],l=n[4],c=n[5],u=n[6],d=n[7],h=n[8],p=n[9],f=n[10],g=n[11],m=n[12],v=n[13],_=n[14],y=n[15];s(t[0].normal._array,a-i,d-l,g-h),t[0].distance=-(y-m),t[0].normalize(),s(t[1].normal._array,a+i,d+l,g+h),t[1].distance=-(y+m),t[1].normalize(),s(t[2].normal._array,a+r,d+c,g+p),t[2].distance=-(y+v),t[2].normalize(),s(t[3].normal._array,a-r,d-c,g-p),t[3].distance=-(y-v),t[3].normalize(),s(t[4].normal._array,a-o,d-u,g-f),t[4].distance=-(y-_),t[4].normalize(),s(t[5].normal._array,a+o,d+u,g+f),t[5].distance=-(y+_),t[5].normalize();var x=this.boundingBox;if(0===y){var b=c/i,w=-_/(f-1),C=-_/(f+1),S=-C/c,T=-w/c;x.min.set(-S*b,-S,C),x.max.set(S*b,S,w);var A=this.vertices;s(A[0],-S*b,-S,C),s(A[1],-S*b,S,C),s(A[2],S*b,-S,C),s(A[3],S*b,S,C),s(A[4],-T*b,-T,w),s(A[5],-T*b,T,w),s(A[6],T*b,-T,w),s(A[7],T*b,T,w)}else{var M=(-1-m)/i,E=(1-m)/i,I=(1-v)/c,D=(-1-v)/c,k=(-1-_)/f,L=(1-_)/f;x.min.set(M,D,L),x.max.set(E,I,k);var N=x.min._array,P=x.max._array,A=this.vertices;s(A[0],N[0],N[1],N[2]),s(A[1],N[0],P[1],N[2]),s(A[2],P[0],N[1],N[2]),s(A[3],P[0],P[1],N[2]),s(A[4],N[0],N[1],P[2]),s(A[5],N[0],P[1],P[2]),s(A[6],P[0],N[1],P[2]),s(A[7],P[0],P[1],P[2])}},getTransformedBoundingBox:function(){var e=a.create();return function(t,n){var i=this.vertices,r=n._array,o=t.min,a=t.max,s=o._array,h=a._array,p=i[0];c(e,p,r),l(s,e),l(h,e);for(var f=1;f<8;f++)p=i[f],c(e,p,r),s[0]=u(e[0],s[0]),s[1]=u(e[1],s[1]),s[2]=u(e[2],s[2]),h[0]=d(e[0],h[0]),h[1]=d(e[1],h[1]),h[2]=d(e[2],h[2]);return o._dirty=!0,a._dirty=!0,t}}()},e.exports=h},function(e,t,n){"use strict";var i=n(1),r=i.quat,o=function(e,t,n,i){e=e||0,t=t||0,n=n||0,i=void 0===i?1:i,this._array=r.fromValues(e,t,n,i),this._dirty=!0};o.prototype={constructor:o,add:function(e){return r.add(this._array,this._array,e._array),this._dirty=!0,this},calculateW:function(){return r.calculateW(this._array,this._array),this._dirty=!0,this},set:function(e,t,n,i){return this._array[0]=e,this._array[1]=t,this._array[2]=n,this._array[3]=i,this._dirty=!0,this},setArray:function(e){return this._array[0]=e[0],this._array[1]=e[1],this._array[2]=e[2],this._array[3]=e[3],this._dirty=!0,this},clone:function(){return new o(this.x,this.y,this.z,this.w)},conjugate:function(){return r.conjugate(this._array,this._array),this._dirty=!0,this},copy:function(e){return r.copy(this._array,e._array),this._dirty=!0,this},dot:function(e){return r.dot(this._array,e._array)},fromMat3:function(e){return r.fromMat3(this._array,e._array),this._dirty=!0,this},fromMat4:function(){var e=i.mat3,t=e.create();return function(n){return e.fromMat4(t,n._array),e.transpose(t,t),r.fromMat3(this._array,t),this._dirty=!0,this}}(),identity:function(){return r.identity(this._array),this._dirty=!0,this},invert:function(){return r.invert(this._array,this._array),this._dirty=!0,this},len:function(){return r.len(this._array)},length:function(){return r.length(this._array)},lerp:function(e,t,n){return r.lerp(this._array,e._array,t._array,n),this._dirty=!0,this},mul:function(e){return r.mul(this._array,this._array,e._array),this._dirty=!0,this},mulLeft:function(e){return r.multiply(this._array,e._array,this._array),this._dirty=!0,this},multiply:function(e){return r.multiply(this._array,this._array,e._array),this._dirty=!0,this},multiplyLeft:function(e){return r.multiply(this._array,e._array,this._array),this._dirty=!0,this},normalize:function(){return r.normalize(this._array,this._array),this._dirty=!0,this},rotateX:function(e){return r.rotateX(this._array,this._array,e),this._dirty=!0,this},rotateY:function(e){return r.rotateY(this._array,this._array,e),this._dirty=!0,this},rotateZ:function(e){return r.rotateZ(this._array,this._array,e),this._dirty=!0,this},rotationTo:function(e,t){return r.rotationTo(this._array,e._array,t._array),this._dirty=!0,this},setAxes:function(e,t,n){return r.setAxes(this._array,e._array,t._array,n._array),this._dirty=!0,this},setAxisAngle:function(e,t){return r.setAxisAngle(this._array,e._array,t),this._dirty=!0,this},slerp:function(e,t,n){return r.slerp(this._array,e._array,t._array,n),this._dirty=!0,this},sqrLen:function(){return r.sqrLen(this._array)},squaredLength:function(){return r.squaredLength(this._array)},fromEuler:function(e,t){return o.fromEuler(this,e,t)},toString:function(){return"["+Array.prototype.join.call(this._array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this._array)}};var a=Object.defineProperty;if(a){var s=o.prototype;a(s,"x",{get:function(){return this._array[0]},set:function(e){this._array[0]=e,this._dirty=!0}}),a(s,"y",{get:function(){return this._array[1]},set:function(e){this._array[1]=e,this._dirty=!0}}),a(s,"z",{get:function(){return this._array[2]},set:function(e){this._array[2]=e,this._dirty=!0}}),a(s,"w",{get:function(){return this._array[3]},set:function(e){this._array[3]=e,this._dirty=!0}})}o.add=function(e,t,n){return r.add(e._array,t._array,n._array),e._dirty=!0,e},o.set=function(e,t,n,i,o){r.set(e._array,t,n,i,o),e._dirty=!0},o.copy=function(e,t){return r.copy(e._array,t._array),e._dirty=!0,e},o.calculateW=function(e,t){return r.calculateW(e._array,t._array),e._dirty=!0,e},o.conjugate=function(e,t){return r.conjugate(e._array,t._array),e._dirty=!0,e},o.identity=function(e){return r.identity(e._array),e._dirty=!0,e},o.invert=function(e,t){return r.invert(e._array,t._array),e._dirty=!0,e},o.dot=function(e,t){return r.dot(e._array,t._array)},o.len=function(e){return r.length(e._array)},o.lerp=function(e,t,n,i){return r.lerp(e._array,t._array,n._array,i),e._dirty=!0,e},o.slerp=function(e,t,n,i){return r.slerp(e._array,t._array,n._array,i),e._dirty=!0,e},o.mul=function(e,t,n){return r.multiply(e._array,t._array,n._array),e._dirty=!0,e},o.multiply=o.mul,o.rotateX=function(e,t,n){return r.rotateX(e._array,t._array,n),e._dirty=!0,e},o.rotateY=function(e,t,n){return r.rotateY(e._array,t._array,n),e._dirty=!0,e},o.rotateZ=function(e,t,n){return r.rotateZ(e._array,t._array,n),e._dirty=!0,e},o.setAxisAngle=function(e,t,n){return r.setAxisAngle(e._array,t._array,n),e._dirty=!0,e},o.normalize=function(e,t){return r.normalize(e._array,t._array),e._dirty=!0,e},o.sqrLen=function(e){return r.sqrLen(e._array)},o.squaredLength=o.sqrLen,o.fromMat3=function(e,t){return r.fromMat3(e._array,t._array),e._dirty=!0,e},o.setAxes=function(e,t,n,i){return r.setAxes(e._array,t._array,n._array,i._array),e._dirty=!0,e},o.rotationTo=function(e,t,n){return r.rotationTo(e._array,t._array,n._array),e._dirty=!0,e},o.fromEuler=function(e,t,n){e._dirty=!0,t=t._array;var i=e._array,r=Math.cos(t[0]/2),o=Math.cos(t[1]/2),a=Math.cos(t[2]/2),s=Math.sin(t[0]/2),l=Math.sin(t[1]/2),c=Math.sin(t[2]/2),n=(n||"XYZ").toUpperCase();switch(n){case"XYZ":i[0]=s*o*a+r*l*c,i[1]=r*l*a-s*o*c,i[2]=r*o*c+s*l*a,i[3]=r*o*a-s*l*c;break;case"YXZ":i[0]=s*o*a+r*l*c,i[1]=r*l*a-s*o*c,i[2]=r*o*c-s*l*a,i[3]=r*o*a+s*l*c;break;case"ZXY":i[0]=s*o*a-r*l*c,i[1]=r*l*a+s*o*c,i[2]=r*o*c+s*l*a,i[3]=r*o*a-s*l*c;break;case"ZYX":i[0]=s*o*a-r*l*c,i[1]=r*l*a+s*o*c,i[2]=r*o*c-s*l*a,i[3]=r*o*a+s*l*c;break;case"YZX":i[0]=s*o*a+r*l*c,i[1]=r*l*a+s*o*c,i[2]=r*o*c-s*l*a,i[3]=r*o*a-s*l*c;break;case"XZY":i[0]=s*o*a-r*l*c,i[1]=r*l*a-s*o*c,i[2]=r*o*c+s*l*a,i[3]=r*o*a+s*l*c}},e.exports=o},function(e,t,n){"use strict";var i=n(3),r=n(1),o=r.vec3,a=function(e,t){this.origin=e||new i,this.direction=t||new i};a.prototype={constructor:a,intersectPlane:function(e,t){var n=e.normal._array,r=e.distance,a=this.origin._array,s=this.direction._array,l=o.dot(n,s);if(0===l)return null;t||(t=new i);var c=(o.dot(n,a)-r)/l;return o.scaleAndAdd(t._array,a,s,-c),t._dirty=!0,t},mirrorAgainstPlane:function(e){var t=o.dot(e.normal._array,this.direction._array);o.scaleAndAdd(this.direction._array,this.direction._array,e.normal._array,2*-t),this.direction._dirty=!0},distanceToPoint:function(){var e=o.create();return function(t){o.sub(e,t,this.origin._array);var n=o.dot(e,this.direction._array);if(n<0)return o.distance(this.origin._array,t);var i=o.lenSquared(e);return Math.sqrt(i-n*n)}}(),intersectSphere:function(){var e=o.create();return function(t,n,r){var a=this.origin._array,s=this.direction._array;t=t._array,o.sub(e,t,a);var l=o.dot(e,s),c=o.squaredLength(e),u=c-l*l,d=n*n;if(!(u>d)){var h=Math.sqrt(d-u),p=l-h,f=l+h;return r||(r=new i),p<0?f<0?null:(o.scaleAndAdd(r._array,a,s,f),r):(o.scaleAndAdd(r._array,a,s,p),r)}}}(),intersectBoundingBox:function(e,t){var n,r,a,s,l,c,u=this.direction._array,d=this.origin._array,h=e.min._array,p=e.max._array,f=1/u[0],g=1/u[1],m=1/u[2];if(f>=0?(n=(h[0]-d[0])*f,r=(p[0]-d[0])*f):(r=(h[0]-d[0])*f,n=(p[0]-d[0])*f),g>=0?(a=(h[1]-d[1])*g,s=(p[1]-d[1])*g):(s=(h[1]-d[1])*g,a=(p[1]-d[1])*g),n>s||a>r)return null;if((a>n||n!==n)&&(n=a),(s<r||r!==r)&&(r=s),m>=0?(l=(h[2]-d[2])*m,c=(p[2]-d[2])*m):(c=(h[2]-d[2])*m,l=(p[2]-d[2])*m),n>c||l>r)return null;if((l>n||n!==n)&&(n=l),(c<r||r!==r)&&(r=c),r<0)return null;var v=n>=0?n:r;return t||(t=new i),o.scaleAndAdd(t._array,d,u,v),t},intersectTriangle:function(){var e=o.create(),t=o.create(),n=o.create(),r=o.create();return function(a,s,l,c,u,d){var h=this.direction._array,p=this.origin._array;a=a._array,s=s._array,l=l._array,o.sub(e,s,a),o.sub(t,l,a),o.cross(r,t,h);var f=o.dot(e,r);if(c){if(f>-1e-5)return null}else if(f>-1e-5&&f<1e-5)return null;o.sub(n,p,a);var g=o.dot(r,n)/f;if(g<0||g>1)return null;o.cross(r,e,n);var m=o.dot(h,r)/f;if(m<0||m>1||g+m>1)return null;o.cross(r,e,t);var v=-o.dot(n,r)/f;return v<0?null:(u||(u=new i),d&&i.set(d,1-g-m,g,m),o.scaleAndAdd(u._array,p,h,v),u)}}(),applyTransform:function(e){i.add(this.direction,this.direction,this.origin),i.transformMat4(this.origin,this.origin,e),i.transformMat4(this.direction,this.direction,e),i.sub(this.direction,this.direction,this.origin),i.normalize(this.direction,this.direction)},copy:function(e){i.copy(this.origin,e.origin),i.copy(this.direction,e.direction)},clone:function(){var e=new a;return e.copy(this),e}},e.exports=a},function(e,t,n){var i=n(29),r=n(74),o=n(9),a=n(19);o.import(n(208));var s=i.extend(function(){var e=new o({vertex:o.source("qtek.skybox.vertex"),fragment:o.source("qtek.skybox.fragment")}),t=new a({shader:e,depthMask:!1});return{scene:null,geometry:new r,material:t,environmentMap:null,culling:!1}},function(){var e=this.scene;e&&this.attachScene(e),this.environmentMap&&this.setEnvironmentMap(this.environmentMap)},{attachScene:function(e){this.scene&&this.detachScene(),this.scene=e,e.on("beforerender",this._beforeRenderScene,this)},detachScene:function(){this.scene&&this.scene.off("beforerender",this._beforeRenderScene),this.scene=null},dispose:function(e){this.detachScene(),this.geometry.dispose(e),this.material.dispose(e)},setEnvironmentMap:function(e){this.material.set("environmentMap",e)},getEnvironmentMap:function(){return this.material.get("environmentMap")},_beforeRenderScene:function(e,t,n){this.renderSkybox(e,n)},renderSkybox:function(e,t){this.position.copy(t.getWorldPosition()),this.update(),e.gl.disable(e.gl.BLEND),e.renderQueue([this],t)}});e.exports=s},function(e,t,n){var i=n(29),r=n(75),o=n(9),a=n(19);o.import(n(192));var s=i.extend(function(){var e=new o({vertex:o.source("qtek.basic.vertex"),fragment:o.source("qtek.basic.fragment")});e.enableTexture("diffuseMap");var t=new a({shader:e,depthMask:!1});return{scene:null,geometry:new r({widthSegments:30,heightSegments:30}),material:t,environmentMap:null,culling:!1}},function(){var e=this.scene;e&&this.attachScene(e),this.environmentMap&&this.setEnvironmentMap(this.environmentMap)},{attachScene:function(e){this.scene&&this.detachScene(),this.scene=e,e.on("beforerender",this._beforeRenderScene,this)},detachScene:function(){this.scene&&this.scene.off("beforerender",this._beforeRenderScene),this.scene=null},_beforeRenderScene:function(e,t,n){this.position.copy(n.getWorldPosition()),this.update(),e.renderQueue([this],n)},setEnvironmentMap:function(e){this.material.set("diffuseMap",e)},getEnvironmentMap:function(){return this.material.get("diffuseMap")},dispose:function(e){this.detachScene(),this.geometry.dispose(e),this.material.dispose(e)}});e.exports=s},function(e,t,n){var i=n(5),r=n(3),o=n(43),a=n(11),s=["px","nx","py","ny","pz","nz"],l=i.extend(function(){var e={position:new r,far:1e3,near:.1,texture:null,shadowMapPass:null},t=e._cameras={px:new o({fov:90}),nx:new o({fov:90}),py:new o({fov:90}),ny:new o({fov:90}),pz:new o({fov:90}),nz:new o({fov:90})};return t.px.lookAt(r.POSITIVE_X,r.NEGATIVE_Y),t.nx.lookAt(r.NEGATIVE_X,r.NEGATIVE_Y),t.py.lookAt(r.POSITIVE_Y,r.POSITIVE_Z),t.ny.lookAt(r.NEGATIVE_Y,r.NEGATIVE_Z),t.pz.lookAt(r.POSITIVE_Z,r.NEGATIVE_Y),t.nz.lookAt(r.NEGATIVE_Z,r.NEGATIVE_Y),e._frameBuffer=new a,e},{getCamera:function(e){return this._cameras[e]},render:function(e,t,n){var i=e.gl;n||t.update();for(var o=this.texture.width,a=2*Math.atan(o/(o-.5))/Math.PI*180,l=0;l<6;l++){var c=s[l],u=this._cameras[c];if(r.copy(u.position,this.position),u.far=this.far,u.near=this.near,u.fov=a,this.shadowMapPass){u.update();var d=t.getBoundingBox(function(e){return!e.invisible});d.applyTransform(u.viewMatrix),t.viewBoundingBoxLastFrame.copy(d),this.shadowMapPass.render(e,t,u,!0)}this._frameBuffer.attach(this.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+l),this._frameBuffer.bind(e),e.render(t,u,!0),this._frameBuffer.unbind(e)}},dispose:function(e){this._frameBuffer.dispose(e)}});e.exports=l},function(e,t,n){"use strict";var i=n(7),r=n(20),o=n(73),a=n(59),s=n(58),l=n(31),c=n(211),u=n(212),d={loadTexture:function(e,t,n,o){var a;if("function"==typeof t?(n=t,o=n,t={}):t=t||{},"string"==typeof e){if(e.match(/.hdr$/)||"hdr"===t.fileType)return a=new i({width:0,height:0}),d._fetchTexture(e,function(e){u.parseRGBE(e,a,t.exposure),a.dirty(),n&&n(a)},o),a;e.match(/.dds$/)||"dds"===t.fileType?(a=new i({width:0,height:0}),d._fetchTexture(e,function(e){c.parse(e,a),a.dirty(),n&&n(a)},o)):(a=new i,a.load(e),a.success(n),a.error(o))}else if("object"==typeof e&&void 0!==e.px){var a=new r;a.load(e),a.success(n),a.error(o)}return a},loadPanorama:function(e,t,n,i,r,o){var a=this;"function"==typeof i?(r=i,o=r,i={}):i=i||{},d.loadTexture(t,i,function(t){t.flipY=i.flipY||!1,a.panoramaToCubeMap(e,t,n,i),t.dispose(e.gl),r&&r(n)},o)},panoramaToCubeMap:function(e,t,n,i){var r=new a,o=new s({scene:new l});return o.material.set("diffuseMap",t),i=i||{},i.encodeRGBM&&o.material.shader.define("fragment","RGBM_ENCODE"),r.texture=n,r.render(e,o.scene),r.texture=null,r.dispose(e),n},_fetchTexture:function(e,t,n){o.get({url:e,responseType:"arraybuffer",onload:t,onerror:n})},createChessboard:function(e,t,n,r){e=e||512,t=t||64,n=n||"black",r=r||"white";var o=Math.ceil(e/t),a=document.createElement("canvas");a.width=e,a.height=e;var s=a.getContext("2d");s.fillStyle=r,s.fillRect(0,0,e,e),s.fillStyle=n;for(var l=0;l<o;l++)for(var c=0;c<o;c++){var u=c%2?l%2:l%2-1;u&&s.fillRect(l*t,c*t,t,t)}return new i({image:a,anisotropic:8})},createBlank:function(e){var t=document.createElement("canvas");t.width=1,t.height=1;var n=t.getContext("2d");return n.fillStyle=e,n.fillRect(0,0,1,1),new i({image:t})}};e.exports=d},function(e,i,l){function n(e){this.rootNode=new u.Node,this._currentMap="",this._triangulationResults={},this._shadersMap=u.COMMON_SHADERS.reduce(function(e,t){return e[t]=u.createShader("ecgl."+t),e[t].define("fragment","DOUBLE_SIDE"),e},{}),this._linesShader=u.createShader("ecgl.meshLines3D");var t={};u.COMMON_SHADERS.forEach(function(e){t[e]=new u.Material({shader:u.createShader("ecgl."+e)})}),this._groundMaterials=t,this._groundMesh=new u.Mesh({geometry:new u.PlaneGeometry,castShadow:!1,$ignorePicking:!0}),this._groundMesh.rotation.rotateX(-Math.PI/2),this._groundMesh.scale.set(1e3,1e3,1),this._labelsBuilder=new m(1024,1024,e),this._labelsBuilder.getMesh().renderOrder=100,this._labelsBuilder.getMesh().material.depthTest=!1,this._api=e}var c=l(0),u=l(2),d=l(157),h=l(22),p=l(4),f=l(1),g=l(49),m=l(46),v=f.vec3;u.Shader.import(l(39)),n.prototype={constructor:n,update:function(e,t,n){var i=e.coordinateSystem,r=e.get("instancing");(i.map!==this._currentMap||r&&!this._polygonMesh||!r&&!this._polygonMeshesMap)&&(this._triangulation(i),this._currentMap=i.map,this._initMeshes(e),this.rootNode.add(this._labelsBuilder.getMesh()));var o=this._getShader(e.get("shading")),a=i.viewGL.isLinearSpace()?"define":"undefine";o[a]("fragment","SRGB_DECODE");var s=e.getData();r&&this._updateInstancingMesh(e,o,n),this._updateRegionMesh(e,o,n,r),this._updateGroundPlane(e),this._groundMesh.material.shader[a]("fragment","SRGB_DECODE"),this._labelsBuilder.updateData(s),this._labelsBuilder.getLabelPosition=function(e,t,n){var r=s.getItemModel(e),o=s.getName(e),a=i.getRegion(o),l=a.center,c=r.get("height")+n;return i.dataToPoint([l[0],l[1],c])},this._data=s,this._labelsBuilder.updateLabels(),this._updateDebugWireframe(e)},_updateInstancingMesh:function(e,t,n){var i=e.coordinateSystem,r=0,o=0;i.regions.forEach(function(e){var t=this._getRegionPolygonGeoInfo(e);r+=t.vertexCount,o+=t.triangleCount},this);var a=this._polygonMesh,s=a.geometry;["position","normal","texcoord0","color"].forEach(function(e){s.attributes[e].init(r)}),s.indices=r>65535?new Uint32Array(3*o):new Uint16Array(3*o),a.material.shader!==t&&a.material.attachShader(t,!0)},_updateRegionMesh:function(e,t,n,i){var r=e.getData(),o=e.coordinateSystem,a=0,s=0;i&&u.setMaterialFromModel(t.__shading,this._polygonMesh.material,e,n);var l=!1;o.regions.forEach(function(c){var d=r.indexOfName(c.name),h=i?this._polygonMesh:this._polygonMeshesMap[c.name],f=i?this._linesMesh:this._linesMeshesMap[c.name];h.material.shader!==t&&h.material.attachShader(t,!0);var g=e.getRegionModel(c.name),m=g.getModel("itemStyle"),v=m.get("areaColor"),_=p.firstNotNull(m.get("opacity"),1),y=r.getItemVisual(d,"color",!0);null!=y&&r.hasValue(d)&&(v=y),r.setItemVisual(d,"color",v),r.setItemVisual(d,"opacity",_),v=u.parseColor(v);var x=u.parseColor(m.get("borderColor"));v[3]*=_,x[3]*=_;var b=v[3]<.99;i||(u.setMaterialFromModel(t.__shading,h.material,g,n),h.material.set({color:v}),h.material.transparent=b,h.material.depthMask=!b),l=l||b;var w=p.firstNotNull(g.get("height",!0),o.size[1]);if(i){var C=this._updatePolygonGeometry(h.geometry,c,w,a,s,v);a=C.vertexOffset,s=C.triangleOffset}else this._updatePolygonGeometry(h.geometry,c,w);var S=m.get("borderWidth"),T=S>0;i||(T&&(S*=n.getDevicePixelRatio(),this._updateLinesGeometry(f.geometry,c,w,S,o.transform)),f.invisible=!T,f.material.set({color:x})),i||(this._moveRegionToCenter(h,f,T),h.dataIndex=d,h.on("mouseover",this._onmouseover,this),h.on("mouseout",this._onmouseout,this))},this),i&&(this._polygonMesh.material.transparent=l,this._polygonMesh.material.depthMask=!l,this._polygonMesh.geometry.updateBoundingBox())},_updateDebugWireframe:function(e){var t=e.getModel("debug.wireframe");if(t.get("show")){var n=u.parseColor(t.get("lineStyle.color")),i=p.firstNotNull(t.get("lineStyle.width"),1),r=function(e){e.geometry.generateBarycentric(),e.material.shader.define("both","WIREFRAME_TRIANGLE"),e.material.set("wireframeLineColor",n),e.material.set("wireframeLineWidth",i)};this._polygonMeshesMap?e.coordinateSystem.regions.forEach(function(e){r(this._polygonMeshesMap[e.name])},this):r(this._polygonMesh)}},_onmouseover:function(e){e.target&&null!=e.target.dataIndex&&(this.highlight(e.target.dataIndex),this._labelsBuilder.updateLabels([e.target.dataIndex]))},_onmouseout:function(e){e.target&&null!=e.target.dataIndex&&(this.downplay(e.target.dataIndex),e.relatedTarget||this._labelsBuilder.updateLabels())},_updateGroundPlane:function(e){var t=e.getModel("groundPlane"),n=e.get("shading"),i=this._groundMaterials[n];i||(i=this._groundMaterials.lambert),this._groundMesh.material=i,this._groundMesh.material.set("color",u.parseColor(t.get("color"))),this._groundMesh.invisible=!t.get("show")},_initMeshes:function(e){function t(){var e=new u.Mesh({material:new u.Material({shader:i}),culling:!1,geometry:new u.Geometry({sortTriangles:!0})});return c.util.extend(e.geometry,g),e}function r(e){return new u.Mesh({material:new u.Material({shader:e}),castShadow:!1,ignorePicking:!0,geometry:new h({useNativeLine:!1})})}this.rootNode.removeAll();var n=e.coordinateSystem,i=this._getShader(e.get("shading"));if(e.get("instancing")){var o=t(),a=r(this._linesShader);this.rootNode.add(o),this.rootNode.add(a),o.material.shader.define("both","VERTEX_COLOR"),this._polygonMesh=o,this._linesMesh=a,this._polygonMeshesMap=null,this._linesMeshesMap=null}else{var s={},l={};n.regions.forEach(function(e){s[e.name]=t(),l[e.name]=r(this._linesShader),this.rootNode.add(s[e.name]),this.rootNode.add(l[e.name])},this),this._polygonMeshesMap=s,this._linesMeshesMap=l}this.rootNode.add(this._groundMesh)},_getShader:function(e){var t=this._shadersMap[e];return t||(t=this._shadersMap.lambert),t.__shading=e,t},_triangulation:function(e){this._triangulationResults={};var t=(this._triangulator,[1/0,1/0,1/0]),n=[-1/0,-1/0,-1/0];e.regions.forEach(function(i){for(var r=[],o=0;o<i.geometries.length;o++){var a=i.geometries[o].exterior,s=i.geometries[o].interiors,l=[],c=[];if(!(a.length<3)){for(var u=0,h=0;h<a.length;h++){var p=a[h];l[u++]=p[0],l[u++]=p[1]}for(var h=0;h<s.length;h++)if(!(s[h].length.length<3)){for(var f=l.length/2,g=0;g<s[h].length;g++){var p=s[h][g];l.push(p[0]),l.push(p[1])}c.push(f)}for(var m=d(l,c),_=new Float32Array(l.length/2*3),y=[],x=[1/0,1/0,1/0],b=[-1/0,-1/0,-1/0],w=0,h=0;h<l.length;)y[0]=l[h++],y[1]=0,y[2]=l[h++],v.transformMat4(y,y,e.transform),v.min(x,x,y),v.max(b,b,y),_[w++]=y[0],_[w++]=y[1],_[w++]=y[2];v.min(t,t,x),v.max(n,n,b),r.push({points:_,minAll:t,maxAll:n,indices:m})}}this._triangulationResults[i.name]=r},this)},_getRegionPolygonGeoInfo:function(e){for(var t=this._triangulationResults[e.name],n=0,i=0,r=0;r<t.length;r++)n+=t[r].points.length/3,i+=t[r].indices.length/3;return{vertexCount:2*n+4*n,triangleCount:2*i+2*n}},_updatePolygonGeometry:function(e,t,n,i,r,a){function o(e,t,n){for(var r=e.points,o=r.length,s=[],c=[],h=0;h<o;h+=3)s[0]=r[h],s[1]=t,s[2]=r[h+2],c[0]=(r[h]-_[0])/x,c[1]=(r[h+2]-_[2])/x,l.set(i,s),p&&d.set(i,a),u.set(i++,c)}function s(e,t,n){var a=i;o(e,t,n);for(var s=0;s<e.indices.length;s++)f[3*r+s]=e.indices[s]+a;r+=e.indices.length/3}var l=e.attributes.position,c=e.attributes.normal,u=e.attributes.texcoord0,d=e.attributes.color,h=this._triangulationResults[t.name],p=d.value&&a,f=e.indices,g=null!=i;if(!g){var m=this._getRegionPolygonGeoInfo(t);i=r=0,l.init(m.vertexCount),c.init(m.vertexCount),u.init(m.vertexCount),f=e.indices=m.vertexCount>65535?new Uint32Array(3*m.triangleCount):new Uint16Array(3*m.triangleCount)}for(var _=h[0].minAll,y=h[0].maxAll,x=Math.max(y[0]-_[0],y[2]-_[2]),b=[0,1,0],w=[0,-1,0],C=0;C<h.length;C++){var S=i,T=h[C];s(T,0,0),s(T,n,0);for(var A=T.points.length/3,M=0;M<A;M++)c.set(S+M,w),c.set(S+M+A,b);for(var E=[0,3,1,1,3,2],I=[[],[],[],[]],D=[],k=[],L=[],N=[],M=0;M<A;M++){for(var P=(M+1)%A,O=0;O<4;O++){var R=3*(0===O||3===O?M:P);I[O][0]=T.points[R],I[O][1]=O>1?n:0,I[O][2]=T.points[R+2],l.set(i+O,I[O]),N[0]=(I[O][0]-_[0])/x,N[1]=(I[O][2]-_[2])/x,O>1&&(N[0]-=n/x),u.set(i+O,N)}v.sub(D,I[1],I[0]),v.sub(k,I[3],I[0]),v.cross(L,D,k),v.normalize(L,L);for(var O=0;O<4;O++)c.set(i+O,L),p&&d.set(i+O,a);for(var O=0;O<6;O++)f[3*r+O]=E[O]+i;i+=4,r+=2}}return g||e.updateBoundingBox(),{vertexOffset:i,triangleOffset:r}},_getRegionLinesGeoInfo:function(e,t){var n=0,i=0;return e.geometries.forEach(function(e){var r=e.exterior,o=e.interiors;n+=t.getPolylineVertexCount(r),i+=t.getPolylineTriangleCount(r);for(var a=0;a<o.length;a++)n+=t.getPolylineVertexCount(o[a]),i+=t.getPolylineTriangleCount(o[a])},this),{vertexCount:n,triangleCount:i}},_updateLinesGeometry:function(e,t,n,i,r){function a(e){for(var t=new Float32Array(3*e.length),i=0,o=[],a=0;a<e.length;a++)o[0]=e[a][0],o[1]=n+.1,o[2]=e[a][1],v.transformMat4(o,o,r),t[i++]=o[0],t[i++]=o[1],t[i++]=o[2];return t}var o=this._getRegionLinesGeoInfo(t,e);e.resetOffset(),e.setVertexCount(o.vertexCount),e.setTriangleCount(o.triangleCount);var s=[1,1,1,1];t.geometries.forEach(function(t){var n=t.exterior,r=t.interiors;e.addPolyline(a(n),s,i);for(var o=0;o<r.length;o++)e.addPolyline(a(r[o]),s,i)}),e.updateBoundingBox()},_moveRegionToCenter:function(e,t,n){var i=e.geometry,r=t.geometry,o=e.geometry.boundingBox,a=o.min.clone().add(o.max).scale(.5),s=a._array;o.min.sub(a),o.max.sub(a);for(var l=i.attributes.position.value,c=0;c<l.length;)l[c++]-=s[0],l[c++]-=s[1],l[c++]-=s[2];if(e.position.copy(a),n){r.boundingBox.min.sub(a),r.boundingBox.max.sub(a);for(var u=r.attributes.position.value,c=0;c<u.length;)u[c++]-=s[0],u[c++]-=s[1],u[c++]-=s[2];t.position.copy(a)}},highlight:function(e){var t=this._data;if(t){var n=t.getItemModel(e),i=n.getModel("emphasis.itemStyle"),r=i.get("areaColor"),o=i.get("opacity");if(null==r){var a=t.getItemVisual(e,"color");r=c.color.lift(a,-.4)}null==o&&(o=t.getItemVisual(e,"opacity"));var s=u.parseColor(r);s[3]*=o;var l=this._polygonMeshesMap[t.getName(e)];l&&l.material.set("color",s),this._api.getZr().refresh()}},downplay:function(e){var t=this._data;if(t){var n=t.getItemVisual(e,"color"),i=t.getItemVisual(e,"opacity"),r=u.parseColor(n);r[3]*=i;var o=this._polygonMeshesMap[t.getName(e)];o&&o.material.set("color",r),this._api.getZr().refresh()}}},e.exports=n},function(e,t){e.exports=function(e,t,n){var i,r=e.scale;return"ordinal"===r.type&&("function"==typeof n?(i=r.getTicks()[t],!n(i,r.getLabel(i))):t%(n+1))}},function(e,t,n){var i=n(0);e.exports={getFilledRegions:function(e,t){var n=(e||[]).slice(),t=i.getMap(t),r=t&&t.geoJson;if(!r)return[];for(var o={},a=r.features,s=0;s<n.length;s++)o[n[s].name]=n[s];for(var s=0;s<a.length;s++){var l=a[s].properties.name;o[l]||n.push({name:l})}return n},defaultOption:{show:!0,zlevel:-10,map:"",left:0,top:0,width:"100%",height:"100%",boxWidth:100,boxHeight:3,boxDepth:"auto",environment:"auto",groundPlane:{show:!1,color:"#aaa"},instancing:!1,shading:"lambert",light:{main:{alpha:40,beta:30}},viewControl:{alpha:40,beta:0,distance:100,minAlpha:5,minBeta:-80,maxBeta:80},label:{show:!1,distance:2,textStyle:{fontSize:20,color:"#000",borderWidth:1,borderColor:"#fff"}},itemStyle:{areaColor:"#fff",borderWidth:0,borderColor:"#333"},emphasis:{itemStyle:{areaColor:"#639fc0"},label:{show:!0}}}}},function(e,t,i){function n(e,t){var n=e.getBoxLayoutParams(),i=s.getLayoutRect(n,{width:t.getWidth(),height:t.getHeight()});i.y=t.getHeight()-i.y-i.height,this.viewGL.setViewport(i.x,i.y,i.width,i.height,t.getDevicePixelRatio());var r=this.getGeoBoundingRect(),o=r.width/r.height*.75,a=e.get("boxWidth"),l=e.get("boxDepth"),c=e.get("boxHeight");null==c&&(c=5),isNaN(a)&&isNaN(l)&&(a=100),isNaN(l)?l=a/o:isNaN(a)&&(a=l/o),this.setSize(a,c,l)}var o=i(139),a=i(0),s=i(40),l=i(27),c=i(4),u={dimensions:o.prototype.dimensions,create:function(e,t){function r(e,r){var s=e.get("map"),c=a.getMap(s);e.__viewGL=e.__viewGL||new l;var u=new o(s+r,s,c&&c.geoJson,c&&c.specialAreas,e.get("nameMap"));u.viewGL=e.__viewGL,e.coordinateSystem=u,i.push(u),u.resize=n,u.resize(e,t)}var i=[];if(!a.getMap)throw new Error("geo3D component depends on geo component");e.eachComponent("geo3D",function(e,t){r(e,t)}),e.eachSeriesByType("map3D",function(e,t){r(e,t)}),e.eachSeries(function(t){if("geo3D"===t.get("coordinateSystem")){var n=t.getReferringComponents("geo3D")[0];if(n||(n=e.getComponent("geo3D")),!n)throw new Error('geo "'+c.firstNotNull(t.get("geo3DIndex"),t.get("geo3DId"),0)+'" not found');t.coordinateSystem=n.coordinateSystem}})}};a.registerCoordinateSystem("geo3D",u),e.exports=u},function(e,t){function r(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function n(e,t,n,i,o){var a=n,s=e[t];r(e,t,i);for(var l=n;l<i;l++)o(e[l],s)<0&&(r(e,l,a),a++);return r(e,i,a),a}function i(e,t,r,o){if(r<o){var a=Math.floor((r+o)/2),s=n(e,a,r,o,t);i(e,t,r,s-1),i(e,t,s+1,o)}}function a(){this._parts=[]}a.prototype.step=function(e,t,r){var o=e.length;if(0===r){this._parts=[],this._sorted=!1;var a=Math.floor(o/2);this._parts.push({pivot:a,left:0,right:o-1}),this._currentSortPartIdx=0}if(!this._sorted){var s=this._parts;if(0===s.length)return this._sorted=!0,!0;if(s.length<512){for(var l=0;l<s.length;l++)s[l].pivot=n(e,s[l].pivot,s[l].left,s[l].right,t);for(var c=[],l=0;l<s.length;l++){var u=s[l].left,d=s[l].pivot-1;d>u&&c.push({pivot:Math.floor((d+u)/2),left:u,right:d});var u=s[l].pivot+1,d=s[l].right;d>u&&c.push({pivot:Math.floor((d+u)/2),left:u,right:d})}s=this._parts=c}else for(var l=0;l<Math.floor(s.length/10);l++){var h=s.length-1-this._currentSortPartIdx;if(i(e,t,s[h].left,s[h].right),++this._currentSortPartIdx===s.length)return this._sorted=!0,!0}return!1}},a.sort=i,e.exports=a},function(e,t,r){function n(e,t,n,i,r,o,a){this._zr=e,this._x=0,this._y=0,this._rowHeight=0,this.width=i,this.height=r,this.offsetX=t,this.offsetY=n,this.dpr=a,this.gap=o}function i(e){e=e||{},e.width=e.width||512,e.height=e.height||512,e.devicePixelRatio=e.devicePixelRatio||1,e.gap=null==e.gap?2:e.gap;var t=document.createElement("canvas");t.width=e.width*e.devicePixelRatio,t.height=e.height*e.devicePixelRatio,this._canvas=t,this._texture=new a({image:t,flipY:!1});var i=this;this._zr=o.zrender.init(t);var r=this._zr.refreshImmediately;this._zr.refreshImmediately=function(){r.call(this),i._texture.dirty(),i.onupdate&&i.onupdate()},this._dpr=e.devicePixelRatio,this._coords={},this.onupdate=e.onupdate,this._gap=e.gap,this._textureAtlasNodes=[new n(this._zr,0,0,e.width,e.height,this._gap,this._dpr)],this._nodeWidth=e.width,this._nodeHeight=e.height}var o=r(0),a=r(7);n.prototype={constructor:n,clear:function(){this._x=0,this._y=0,this._rowHeight=0},add:function(e,t,n){var i=e.getBoundingRect();null==t&&(t=i.width),null==n&&(n=i.height),t*=this.dpr,n*=this.dpr,this._fitElement(e,t,n);var r=this._x,o=this._y,a=this.width*this.dpr,s=this.height*this.dpr,l=this.gap;if(r+t+l>a&&(r=this._x=0,o+=this._rowHeight+l,this._y=o,this._rowHeight=0),this._x+=t+l,this._rowHeight=Math.max(this._rowHeight,n),o+n+l>s)return null;e.position[0]+=this.offsetX*this.dpr+r,e.position[1]+=this.offsetY*this.dpr+o,this._zr.add(e);var c=[this.offsetX/this.width,this.offsetY/this.height];return[[r/a+c[0],o/s+c[1]],[(r+t)/a+c[0],(o+n)/s+c[1]]]},_fitElement:function(e,t,n){var i=e.getBoundingRect(),r=t/i.width,o=n/i.height;e.position=[-i.x*r,-i.y*o],e.scale=[r,o],e.update()}},i.prototype={clear:function(){for(var e=0;e<this._textureAtlasNodes.length;e++)this._textureAtlasNodes[e].clear();this._zr.clear(),this._coords={}},getWidth:function(){return this._width},getHeight:function(){return this._height},getTexture:function(){return this._texture},getDevicePixelRatio:function(){return this._dpr},getZr:function(){return this._zr},_getCurrentNode:function(){return this._textureAtlasNodes[this._textureAtlasNodes.length-1]},_expand:function(){var e=4096/this._dpr,t=this._textureAtlasNodes,i=t.length,r=i*this._nodeWidth%e,o=Math.floor(i*this._nodeWidth/e)*this._nodeHeight;if(!(o>=e)){var a=(r+this._nodeWidth)*this._dpr,s=(o+this._nodeHeight)*this._dpr;try{this._zr.resize({width:a,height:s})}catch(e){this._canvas.width=a,this._canvas.height=s}var l=new n(this._zr,r,o,this._nodeWidth,this._nodeHeight,this._gap,this._dpr);return this._textureAtlasNodes.push(l),l}},add:function(e,t,n){if(this._coords[e.id])return this._coords[e.id];var i=this._getCurrentNode().add(e,t,n);if(!i){var r=this._expand();if(!r)return;i=r.add(e,t,n)}return this._coords[e.id]=i,i},getCoordsScale:function(){var e=this._dpr;return[this._nodeWidth/this._canvas.width*e,this._nodeHeight/this._canvas.height*e]},getCoords:function(e){return this._coords[e]}},e.exports=i},function(e,t,r){function n(e,t,n){var t=t||document.createElement("canvas");t.width=e,t.height=e;var i=t.getContext("2d");return n&&n(i),t}function i(e,t,n,i){o.util.isArray(t)||(t=[t,t]);var r=s.getMarginByStyle(n,i),a=t[0]+r.left+r.right,l=t[1]+r.top+r.bottom,c=o.helper.createSymbol(e,0,0,t[0],t[1]),u=Math.max(a,l);c.position=[r.left,r.top],a>l?c.position[1]+=(u-l)/2:c.position[0]+=(u-a)/2;var d=c.getBoundingRect();return c.position[0]-=d.x,c.position[1]-=d.y,c.setStyle(n),c.update(),c.__size=u,c}function a(e,t,i){function n(e){return e<128?1:-1}for(var r=t.width,o=t.height,a=e.canvas.width,s=e.canvas.height,l=r/a,c=o/s,u=e.createImageData(a,s),d=0;d<s;d++)for(var h=0;h<a;h++){var p=function(e,a){var s=1/0;e=Math.floor(e*l),a=Math.floor(a*c);for(var u=a*r+e,d=t.data[4*u],h=n(d),p=Math.max(a-i,0);p<Math.min(a+i,o);p++)for(var f=Math.max(e-i,0);f<Math.min(e+i,r);f++){var u=p*r+f,g=t.data[4*u],m=n(g),v=f-e,_=p-a;if(h!==m){var y=v*v+_*_;y<s&&(s=y)}}return h*Math.sqrt(s)}(h,d),f=p/i*.5+.5,g=4*(d*a+h);u.data[g++]=255*(1-f),u.data[g++]=255*(1-f),u.data[g++]=255*(1-f),u.data[g++]=255}return u}var o=r(0),s={getMarginByStyle:function(e){var t=e.marginBias||0,n=0;e.stroke&&"none"!==e.stroke&&(n=null==e.lineWidth?1:e.lineWidth);var i=e.shadowBlur||0,r=e.shadowOffsetX||0,o=e.shadowOffsetY||0,a={};return a.left=Math.max(n/2,-r+i)+t,a.right=Math.max(n/2,r+i)+t,a.top=Math.max(n/2,-o+i)+t,a.bottom=Math.max(n/2,o+i)+t,a},createSymbolSprite:function(e,t,r,o){var a=i(e,t,r),l=s.getMarginByStyle(r);return{image:n(a.__size,o,function(e){a.brush(e)}),margin:l}},createSDFFromCanvas:function(e,t,i,r){return n(t,r,function(t){var n=e.getContext("2d"),r=n.getImageData(0,0,e.width,e.height);t.putImageData(a(t,r,i),0,0)})},createSimpleSprite:function(e,t){return n(e,t,function(t){var n=e/2;t.beginPath(),t.arc(n,n,60,0,2*Math.PI,!1),t.closePath();var i=t.createRadialGradient(n,n,0,n,n,n);i.addColorStop(0,"rgba(255, 255, 255, 1)"),i.addColorStop(.5,"rgba(255, 255, 255, 0.5)"),i.addColorStop(1,"rgba(255, 255, 255, 0)"),t.fillStyle=i,t.fill()})}};e.exports=s},function(e,t){function r(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}function n(e){return Math.floor(Math.log(e)/Math.LN10)}var i={};i.linearMap=function(e,t,n,i){var r=t[1]-t[0],o=n[1]-n[0];if(0===r)return 0===o?n[0]:(n[0]+n[1])/2;if(i)if(r>0){if(e<=t[0])return n[0];if(e>=t[1])return n[1]}else{if(e>=t[0])return n[0];if(e<=t[1])return n[1]}else{if(e===t[0])return n[0];if(e===t[1])return n[1]}return(e-t[0])/r*o+n[0]},i.parsePercent=function(e,t){switch(e){case"center":case"middle":e="50%";break;case"left":case"top":e="0%";break;case"right":case"bottom":e="100%"}return"string"==typeof e?r(e).match(/%$/)?parseFloat(e)/100*t:parseFloat(e):null==e?NaN:+e},i.round=function(e,t,n){return null==t&&(t=10),t=Math.min(Math.max(0,t),20),e=(+e).toFixed(t),n?e:+e},i.asc=function(e){return e.sort(function(e,t){return e-t}),e},i.getPrecision=function(e){if(e=+e,isNaN(e))return 0;for(var t=1,n=0;Math.round(e*t)/t!==e;)t*=10,n++;return n},i.getPrecisionSafe=function(e){var t=e.toString(),n=t.indexOf("e");if(n>0){var i=+t.slice(n+1);return i<0?-i:0}var r=t.indexOf(".");return r<0?0:t.length-1-r},i.getPixelPrecision=function(e,t){var n=Math.log,i=Math.LN10,r=Math.floor(n(e[1]-e[0])/i),o=Math.round(n(Math.abs(t[1]-t[0]))/i),a=Math.min(Math.max(-r+o,0),20);return isFinite(a)?a:20},i.MAX_SAFE_INTEGER=9007199254740991,i.remRadian=function(e){var t=2*Math.PI;return(e%t+t)%t},i.isRadianAroundZero=function(e){return e>-1e-4&&e<1e-4};var o=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d\d)(?::(\d\d)(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;i.getTimezoneOffset=function(){return(new Date).getTimezoneOffset()},i.parseDate=function(e){if(e instanceof Date)return e;if("string"==typeof e){var t=o.exec(e);if(!t)return new Date(NaN);var n=i.getTimezoneOffset(),r=t[8]?"Z"===t[8].toUpperCase()?n:60*+t[8].slice(0,3)+n:0;return new Date(+t[1],+(t[2]||1)-1,+t[3]||1,+t[4]||0,+(t[5]||0)-r,+t[6]||0,+t[7]||0)}return null==e?new Date(NaN):new Date(Math.round(e))},i.quantity=function(e){return Math.pow(10,n(e))},i.nice=function(e,t){var i,r=n(e),o=Math.pow(10,r),a=e/o;return i=t?a<1.5?1:a<2.5?2:a<4?3:a<7?5:10:a<1?1:a<2?2:a<3?3:a<5?5:10,e=i*o,r>=-20?+e.toFixed(r<0?-r:0):e},i.reformIntervals=function(e){function t(e,n,i){return e.interval[i]<n.interval[i]||e.interval[i]===n.interval[i]&&(e.close[i]-n.close[i]==(i?-1:1)||!i&&t(e,n,1))}e.sort(function(e,n){return t(e,n,0)?-1:1});for(var n=-1/0,i=1,r=0;r<e.length;){for(var o=e[r].interval,a=e[r].close,s=0;s<2;s++)o[s]<=n&&(o[s]=n,a[s]=s?1:1-i),n=o[s],i=a[s];o[0]===o[1]&&a[0]*a[1]!=1?e.splice(r,1):r++}return e},i.isNumeric=function(e){return e-parseFloat(e)>=0},e.exports=i},function(e,t,n){"use strict";var i=n(30),r=n(10),o=n(54),a=n(56),s=n(1),l=s.vec3,c=s.vec4,u=i.extend(function(){return{projectionMatrix:new r,invProjectionMatrix:new r,viewMatrix:new r,frustum:new o}},function(){this.update(!0)},{update:function(e){i.prototype.update.call(this,e),r.invert(this.viewMatrix,this.worldTransform),this.updateProjectionMatrix(),r.invert(this.invProjectionMatrix,this.projectionMatrix),this.frustum.setFromProjection(this.projectionMatrix)},setViewMatrix:function(e){r.invert(this.worldTransform,e),this.decomposeWorldTransform()},decomposeProjectionMatrix:function(){},setProjectionMatrix:function(e){r.copy(this.projectionMatrix,e),r.invert(this.invProjectionMatrix,e),this.decomposeProjectionMatrix()},updateProjectionMatrix:function(){},castRay:function(){var e=c.create();return function(t,n){var i=void 0!==n?n:new a,r=t._array[0],o=t._array[1];return c.set(e,r,o,-1,1),c.transformMat4(e,e,this.invProjectionMatrix._array),c.transformMat4(e,e,this.worldTransform._array),l.scale(i.origin._array,e,1/e[3]),c.set(e,r,o,1,1),c.transformMat4(e,e,this.invProjectionMatrix._array),c.transformMat4(e,e,this.worldTransform._array),l.scale(e,e,1/e[3]),l.sub(i.direction._array,e,i.origin._array),l.normalize(i.direction._array,i.direction._array),i.direction._dirty=!0,i.origin._dirty=!0,i}}()});e.exports=u},function(e,t,i){"use strict";function n(e,t,n){this.availableAttributes=e,this.availableAttributeSymbols=t,this.indicesBuffer=n,this.vao=null}var r,o=i(30),a=i(8),s=i(17),l=0,c=null,u=!0,d=function(){this.triangleCount=0,this.vertexCount=0,this.drawCallCount=0},h=o.extend({material:null,geometry:null,mode:a.TRIANGLES,_drawCache:null,_renderInfo:null},function(){this._drawCache={},this._renderInfo=new d},{renderOrder:0,lineWidth:1,culling:!0,cullFace:a.BACK,frontFace:a.CCW,frustumCulling:!0,receiveShadow:!0,castShadow:!0,ignorePicking:!1,isRenderable:function(){return this.geometry&&this.material&&!this.invisible&&this.geometry.vertexCount>0},beforeRender:function(e){},afterRender:function(e,t){},getBoundingBox:function(e,t){return t=o.prototype.getBoundingBox.call(this,e,t),this.geometry&&this.geometry.boundingBox&&t.union(this.geometry.boundingBox),t},render:function(e,t){var t=t||this.material.shader,i=this.geometry,o=this.mode,d=i.vertexCount,h=i.isUseIndices(),p=s.getExtension(e,"OES_element_index_uint"),f=p&&d>65535,g=f?e.UNSIGNED_INT:e.UNSIGNED_SHORT,m=s.getExtension(e,"OES_vertex_array_object"),v=!i.dynamic,_=this._renderInfo;_.vertexCount=d,_.triangleCount=0,_.drawCallCount=0;var y=!1;if(r=e.__GLID__+"-"+i.__GUID__+"-"+t.__GUID__,r!==l?y=!0:(d>65535&&!p&&h||m&&v||i._cache.isDirty())&&(y=!0),l=r,y){var x=this._drawCache[r];if(!x){var b=i.getBufferChunks(e);if(!b)return;x=[];for(var w=0;w<b.length;w++){for(var C=b[w],S=C.attributeBuffers,T=C.indicesBuffer,A=[],M=[],E=0;E<S.length;E++){var I,D=S[E],k=D.name,L=D.semantic;if(L){var N=t.attribSemantics[L];I=N&&N.symbol}else I=k;I&&t.attributeTemplates[I]&&(A.push(D),M.push(I))}var P=new n(A,M,T);x.push(P)}v&&(this._drawCache[r]=x)}for(var O=0;O<x.length;O++){var P=x[O],R=!0;m&&v&&(null==P.vao?P.vao=m.createVertexArrayOES():R=!1,m.bindVertexArrayOES(P.vao));var A=P.availableAttributes,T=P.indicesBuffer;if(R)for(var z=t.enableAttributes(e,P.availableAttributeSymbols,m&&v&&P.vao),E=0;E<A.length;E++){var F=z[E];if(-1!==F){var B,D=A[E],H=D.buffer,V=D.size;switch(D.type){case"float":B=e.FLOAT;break;case"byte":B=e.BYTE;break;case"ubyte":B=e.UNSIGNED_BYTE;break;case"short":B=e.SHORT;break;case"ushort":B=e.UNSIGNED_SHORT;break;default:B=e.FLOAT}e.bindBuffer(e.ARRAY_BUFFER,H),e.vertexAttribPointer(F,V,B,!1,0,0)}}o!=a.LINES&&o!=a.LINE_STRIP&&o!=a.LINE_LOOP||e.lineWidth(this.lineWidth),c=T,u=i.isUseIndices(),u?(R&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,T.buffer),e.drawElements(o,T.count,g,0),_.triangleCount+=T.count/3):e.drawArrays(o,0,d),m&&v&&m.bindVertexArrayOES(null),_.drawCallCount++}}else u?(e.drawElements(o,c.count,g,0),_.triangleCount=c.count/3):e.drawArrays(o,0,d),_.drawCallCount=1;return _},clone:function(){var e=["castShadow","receiveShadow","mode","culling","cullFace","frontFace","frustumCulling"];return function(){var t=o.prototype.clone.call(this);t.geometry=this.geometry,t.material=this.material;for(var n=0;n<e.length;n++){var i=e[n];t[i]!==this[i]&&(t[i]=this[i])}return t}}()});h.beforeFrame=function(){l=0},h.POINTS=a.POINTS,h.LINES=a.LINES,h.LINE_LOOP=a.LINE_LOOP,h.LINE_STRIP=a.LINE_STRIP,h.TRIANGLES=a.TRIANGLES,h.TRIANGLE_STRIP=a.TRIANGLE_STRIP,h.TRIANGLE_FAN=a.TRIANGLE_FAN,h.BACK=a.BACK,h.FRONT=a.FRONT,h.FRONT_AND_BACK=a.FRONT_AND_BACK,h.CW=a.CW,h.CCW=a.CCW,h.RenderInfo=d,e.exports=h},function(e,t,n){"use strict";var i=n(178),r=n(72),o=n(11),a=i.extend(function(){return{_outputs:[],_texturePool:new r,_frameBuffer:new o({depthBuffer:!1})}},{addNode:function(e){i.prototype.addNode.call(this,e),e._compositor=this},render:function(e,t){if(this._dirty){this.update(),this._dirty=!1,this._outputs.length=0;for(var n=0;n<this.nodes.length;n++)this.nodes[n].outputs||this._outputs.push(this.nodes[n])}for(var n=0;n<this.nodes.length;n++)this.nodes[n].beforeFrame();for(var n=0;n<this._outputs.length;n++)this._outputs[n].updateReference();for(var n=0;n<this._outputs.length;n++)this._outputs[n].render(e,t);for(var n=0;n<this.nodes.length;n++)this.nodes[n].afterFrame()},allocateTexture:function(e){return this._texturePool.get(e)},releaseTexture:function(e){this._texturePool.put(e)},getFrameBuffer:function(){return this._frameBuffer},dispose:function(e){this._texturePool.clear(e.gl||e)}});e.exports=a},function(e,t,r){"use strict";function n(e){l.defaultsWithPropList(e,u,d),i(e);for(var t="",n=0;n<d.length;n++)t+=e[d[n]].toString();return t}function i(e){var t=a(e.width,e.height);e.format===s.DEPTH_COMPONENT&&(e.useMipmap=!1),t&&e.useMipmap||(e.minFilter==s.NEAREST_MIPMAP_NEAREST||e.minFilter==s.NEAREST_MIPMAP_LINEAR?e.minFilter=s.NEAREST:e.minFilter!=s.LINEAR_MIPMAP_LINEAR&&e.minFilter!=s.LINEAR_MIPMAP_NEAREST||(e.minFilter=s.LINEAR),e.wrapS=s.CLAMP_TO_EDGE,e.wrapT=s.CLAMP_TO_EDGE)}function a(e,t){return 0==(e&e-1)&&0==(t&t-1)}var o=r(7),s=r(8),l=r(23),c=function(){this._pool={},this._allocatedTextures=[]};c.prototype={constructor:c,get:function(e){var t=n(e);this._pool.hasOwnProperty(t)||(this._pool[t]=[]);var i=this._pool[t];if(!i.length){var r=new o(e);return this._allocatedTextures.push(r),r}return i.pop()},put:function(e){var t=n(e);this._pool.hasOwnProperty(t)||(this._pool[t]=[]),this._pool[t].push(e)},clear:function(e){for(var t=0;t<this._allocatedTextures.length;t++)this._allocatedTextures[t].dispose(e);this._pool={},this._allocatedTextures=[]}};var u={width:512,height:512,type:s.UNSIGNED_BYTE,format:s.RGBA,wrapS:s.CLAMP_TO_EDGE,wrapT:s.CLAMP_TO_EDGE,minFilter:s.LINEAR_MIPMAP_LINEAR,magFilter:s.LINEAR,useMipmap:!0,anisotropic:1,flipY:!0,unpackAlignment:4,premultiplyAlpha:!1},d=Object.keys(u);e.exports=c},function(e,t,i){"use strict";function n(e){var t=new XMLHttpRequest;t.open("get",e.url),t.responseType=e.responseType||"text",e.onprogress&&(t.onprogress=function(t){if(t.lengthComputable){var n=t.loaded/t.total;e.onprogress(n,t.loaded,t.total)}else e.onprogress(null)}),t.onload=function(n){e.onload&&e.onload(t.response)},e.onerror&&(t.onerror=e.onerror),t.send(null)}e.exports={get:n}},function(e,t,i){"use strict";function n(e,t,n){u.identity();var i=new o({widthSegments:t,heightSegments:n});switch(e){case"px":a.translate(u,u,s.POSITIVE_X),a.rotateY(u,u,Math.PI/2);break;case"nx":a.translate(u,u,s.NEGATIVE_X),a.rotateY(u,u,-Math.PI/2);break;case"py":a.translate(u,u,s.POSITIVE_Y),a.rotateX(u,u,-Math.PI/2);break;case"ny":a.translate(u,u,s.NEGATIVE_Y),a.rotateX(u,u,Math.PI/2);break;case"pz":a.translate(u,u,s.POSITIVE_Z);break;case"nz":a.translate(u,u,s.NEGATIVE_Z),a.rotateY(u,u,Math.PI)}return i.applyTransform(u),i}var r=i(12),o=i(53),a=i(10),s=i(3),l=i(13),c=i(18),u=new a,d=r.extend({widthSegments:1,heightSegments:1,depthSegments:1,inside:!1},function(){this.build()},{build:function(){var e={px:n("px",this.depthSegments,this.heightSegments),nx:n("nx",this.depthSegments,this.heightSegments),py:n("py",this.widthSegments,this.depthSegments),ny:n("ny",this.widthSegments,this.depthSegments),pz:n("pz",this.widthSegments,this.heightSegments),nz:n("nz",this.widthSegments,this.heightSegments)},t=["position","texcoord0","normal"],i=0,r=0;for(var o in e)i+=e[o].vertexCount,r+=e[o].indices.length;for(var a=0;a<t.length;a++)this.attributes[t[a]].init(i);this.indices=new c.Uint16Array(r);var s=0,u=0;for(var o in e){for(var d=e[o],a=0;a<t.length;a++)for(var h=t[a],p=d.attributes[h].value,f=d.attributes[h].size,g="normal"===h,m=0;m<p.length;m++){var v=p[m];this.inside&&g&&(v=-v),this.attributes[h].value[m+f*u]=v}for(var m=0;m<d.indices.length;m++)this.indices[m+s]=u+d.indices[m];s+=d.indices.length,u+=d.vertexCount}this.boundingBox=new l,this.boundingBox.max.set(1,1,1),this.boundingBox.min.set(-1,-1,-1)}});e.exports=d},function(e,t,n){"use strict";var i=n(12),r=n(1),o=(r.vec3,r.vec2,n(13)),a=i.extend({widthSegments:20,heightSegments:20,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI,radius:1},function(){this.build()},{build:function(){var e=this.heightSegments,t=this.widthSegments,n=this.attributes.position,i=this.attributes.texcoord0,r=this.attributes.normal,a=(t+1)*(e+1);n.init(a),i.init(a),r.init(a);var s,l,c,u,d,h,p,f=a>65535?Uint32Array:Uint16Array,g=this.indices=new f(t*e*6),m=this.radius,v=this.phiStart,_=this.phiLength,y=this.thetaStart,x=this.thetaLength,m=this.radius,b=[],w=[],C=0,S=1/m;for(p=0;p<=e;p++)for(h=0;h<=t;h++)u=h/t,d=p/e,s=-m*Math.cos(v+u*_)*Math.sin(y+d*x),l=m*Math.cos(y+d*x),c=m*Math.sin(v+u*_)*Math.sin(y+d*x),b[0]=s,b[1]=l,b[2]=c,w[0]=u,w[1]=d,n.set(C,b),i.set(C,w),b[0]*=S,b[1]*=S,b[2]*=S,r.set(C,b),C++;var T,A,M,E,I=t+1,D=0;for(p=0;p<e;p++)for(h=0;h<t;h++)A=p*I+h,T=p*I+h+1,E=(p+1)*I+h+1,M=(p+1)*I+h,g[D++]=T,g[D++]=A,g[D++]=E,g[D++]=A,g[D++]=M,g[D++]=E;this.boundingBox=new o,this.boundingBox.max.set(m,m,m),this.boundingBox.min.set(-m,-m,-m)}});e.exports=a},function(e,t,n){"use strict";var i=n(16),r=n(3),o=i.extend({shadowBias:.001,shadowSlopeScale:2,shadowCascade:1,cascadeSplitLogFactor:.2},{type:"DIRECTIONAL_LIGHT",uniformTemplates:{directionalLightDirection:{type:"3f",value:function(e){return e.__dir=e.__dir||new r,e.__dir.copy(e.worldTransform.z).negate()._array}},directionalLightColor:{type:"3f",value:function(e){var t=e.color,n=e.intensity;return[t[0]*n,t[1]*n,t[2]*n]}}},clone:function(){var e=i.prototype.clone.call(this);return e.shadowBias=this.shadowBias,e.shadowSlopeScale=this.shadowSlopeScale,e}});e.exports=o},function(e,t,n){"use strict";var i=n(16),r=i.extend({range:100,castShadow:!1},{type:"POINT_LIGHT",uniformTemplates:{pointLightPosition:{type:"3f",value:function(e){return e.getWorldPosition()._array}},pointLightRange:{type:"1f",value:function(e){return e.range}},pointLightColor:{type:"3f",value:function(e){var t=e.color,n=e.intensity;return[t[0]*n,t[1]*n,t[2]*n]}}},clone:function(){var e=i.prototype.clone.call(this);return e.range=this.range,e}});e.exports=r},function(e,t,n){"use strict";var i=n(16),r=n(3),o=i.extend({range:20,umbraAngle:30,penumbraAngle:45,falloffFactor:2,shadowBias:2e-4,shadowSlopeScale:2},{type:"SPOT_LIGHT",uniformTemplates:{spotLightPosition:{type:"3f",value:function(e){return e.getWorldPosition()._array}},spotLightRange:{type:"1f",value:function(e){return e.range}},spotLightUmbraAngleCosine:{type:"1f",value:function(e){return Math.cos(e.umbraAngle*Math.PI/180)}},spotLightPenumbraAngleCosine:{type:"1f",value:function(e){return Math.cos(e.penumbraAngle*Math.PI/180)}},spotLightFalloffFactor:{type:"1f",value:function(e){return e.falloffFactor}},spotLightDirection:{type:"3f",value:function(e){return e.__dir=e.__dir||new r,e.__dir.copy(e.worldTransform.z).negate()._array}},spotLightColor:{type:"3f",value:function(e){var t=e.color,n=e.intensity;return[t[0]*n,t[1]*n,t[2]*n]}}},clone:function(){var e=i.prototype.clone.call(this);return e.range=this.range,e.umbraAngle=this.umbraAngle,e.penumbraAngle=this.penumbraAngle,e.falloffFactor=this.falloffFactor,e.shadowBias=this.shadowBias,e.shadowSlopeScale=this.shadowSlopeScale,e}});e.exports=o},function(e,t,n){"use strict";var i=n(3),r=n(1),o=r.vec3,a=r.mat4,s=r.vec4,l=function(e,t){this.normal=e||new i(0,1,0),this.distance=t||0};l.prototype={constructor:l,distanceToPoint:function(e){return o.dot(e._array,this.normal._array)-this.distance},projectPoint:function(e,t){t||(t=new i);var n=this.distanceToPoint(e);return o.scaleAndAdd(t._array,e._array,this.normal._array,-n),t._dirty=!0,t},normalize:function(){var e=1/o.len(this.normal._array);o.scale(this.normal._array,e),this.distance*=e},intersectFrustum:function(e){for(var t=e.vertices,n=this.normal._array,i=o.dot(t[0]._array,n)>this.distance,r=1;r<8;r++)if(o.dot(t[r]._array,n)>this.distance!=i)return!0},intersectLine:function(){var e=o.create();return function(t,n,r){var a=this.distanceToPoint(t),s=this.distanceToPoint(n);if(a>0&&s>0||a<0&&s<0)return null;var l=this.normal._array,c=this.distance,u=t._array;o.sub(e,n._array,t._array),o.normalize(e,e);var d=o.dot(l,e);if(0===d)return null;r||(r=new i);var h=(o.dot(l,u)-c)/d;return o.scaleAndAdd(r._array,u,e,-h),r._dirty=!0,r}}(),applyTransform:function(){var e=a.create(),t=s.create(),n=s.create();return n[3]=1,function(i){i=i._array,o.scale(n,this.normal._array,this.distance),s.transformMat4(n,n,i),this.distance=o.dot(n,this.normal._array),a.invert(e,i),a.transpose(e,e),t[3]=0,o.copy(t,this.normal._array),s.transformMat4(t,t,e),o.copy(this.normal._array,t)}}(),copy:function(e){o.copy(this.normal._array,e.normal._array),this.normal._dirty=!0,this.distance=e.distance},clone:function(){var e=new l;return e.copy(this),e}},e.exports=l},function(e,t){var n={};n.isPowerOfTwo=function(e){return 0==(e&e-1)},n.nextPowerOfTwo=function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},n.nearestPowerOfTwo=function(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))},e.exports=n},function(e,t,r){function n(){this._pool={}}function i(e,t,n){a[e]={vertex:t,fragment:n}}var o=r(9),a=(r(23),{});n.prototype.get=function(e,t){var n=[],i={},r={};"string"==typeof t?n=Array.prototype.slice.call(arguments,1):"[object Object]"==Object.prototype.toString.call(t)?(n=t.textures||[],i=t.vertexDefines||{},r=t.fragmentDefines||{}):t instanceof Array&&(n=t);var s=Object.keys(i),l=Object.keys(r);n.sort(),s.sort(),l.sort();var c=[e];c=c.concat(n);for(var u=0;u<s.length;u++)c.push(s[u],i[s[u]]);for(var u=0;u<l.length;u++)c.push(l[u],r[l[u]]);var d=c.join("_");if(this._pool[d])return this._pool[d];var h=a[e];if(h){for(var p=new o({vertex:h.vertex,fragment:h.fragment}),u=0;u<n.length;u++)p.enableTexture(n[u]);for(var e in i)p.define("vertex",e,i[e]);for(var e in r)p.define("fragment",e,r[e]);return this._pool[d]=p,p}},n.prototype.clear=function(){this._pool={}};var s=new n;e.exports={createLibrary:function(){return new n},get:function(){return s.get.apply(s,arguments)},template:i,clear:function(){return s.clear()}}},function(e,t){e.exports="undefined"!=typeof window&&(window.requestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(e){setTimeout(e,16)}},function(e,t,i){"use strict";function n(e,t,n,i){n<0&&(e+=n,n=-n),i<0&&(t+=i,i=-i),this.x=e,this.y=t,this.width=n,this.height=i}var r=i(224),o=i(223),a=r.applyTransform,s=Math.min,l=Math.max;n.prototype={constructor:n,union:function(e){var t=s(e.x,this.x),n=s(e.y,this.y);this.width=l(e.x+e.width,this.x+this.width)-t,this.height=l(e.y+e.height,this.y+this.height)-n,this.x=t,this.y=n},applyTransform:function(){var e=[],t=[],n=[],i=[];return function(r){if(r){e[0]=n[0]=this.x,e[1]=i[1]=this.y,t[0]=i[0]=this.x+this.width,t[1]=n[1]=this.y+this.height,a(e,e,r),a(t,t,r),a(n,n,r),a(i,i,r),this.x=s(e[0],t[0],n[0],i[0]),this.y=s(e[1],t[1],n[1],i[1]);var o=l(e[0],t[0],n[0],i[0]),c=l(e[1],t[1],n[1],i[1]);this.width=o-this.x,this.height=c-this.y}}}(),calculateTransform:function(e){var t=this,n=e.width/t.width,i=e.height/t.height,r=o.create();return o.translate(r,r,[-t.x,-t.y]),o.scale(r,r,[n,i]),o.translate(r,r,[e.x,e.y]),r},intersect:function(e){if(!e)return!1;e instanceof n||(e=n.create(e));var t=this,i=t.x,r=t.x+t.width,o=t.y,a=t.y+t.height,s=e.x,l=e.x+e.width,c=e.y,u=e.y+e.height;return!(r<s||l<i||a<c||u<o)},contain:function(e,t){var n=this;return e>=n.x&&e<=n.x+n.width&&t>=n.y&&t<=n.y+n.height},clone:function(){return new n(this.x,this.y,this.width,this.height)},copy:function(e){this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height},plain:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}}},n.create=function(e){return new n(e.x,e.y,e.width,e.height)},e.exports=n},function(e,t){var n=function(){this.head=null,this.tail=null,this._len=0},i=n.prototype;i.insert=function(e){var t=new r(e);return this.insertEntry(t),t},i.insertEntry=function(e){this.head?(this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e):this.head=this.tail=e,this._len++},i.remove=function(e){var t=e.prev,n=e.next;t?t.next=n:this.head=n,n?n.prev=t:this.tail=t,e.next=e.prev=null,this._len--},i.len=function(){return this._len},i.clear=function(){this.head=this.tail=null,this._len=0};var r=function(e){this.value=e,this.next,this.prev},o=function(e){this._list=new n,this._map={},this._maxSize=e||10,this._lastRemovedEntry=null},a=o.prototype;a.put=function(e,t){var n=this._list,i=this._map,o=null;if(null==i[e]){var a=n.len(),s=this._lastRemovedEntry;if(a>=this._maxSize&&a>0){var l=n.head;n.remove(l),delete i[l.key],o=l.value,this._lastRemovedEntry=l}s?s.value=t:s=new r(t),s.key=e,n.insertEntry(s),i[e]=s}return o},a.get=function(e){var t=this._map[e],n=this._list;if(null!=t)return t!==n.tail&&(n.remove(t),n.insertEntry(t)),t.value},a.clear=function(){this._list.clear(),this._map={}},e.exports=o},function(e,t,n){var i=n(0);n(100),n(99),n(98),i.registerVisual(i.util.curry(n(15),"bar3D")),i.registerProcessor(function(e,t){e.eachSeriesByType("bar3d",function(e){var t=e.getData();t.filterSelf(function(e){return t.hasValue(e)})})})},function(e,t,n){var i=n(0);n(106),n(107),i.registerVisual(i.util.curry(n(41),"graphGL","circle",null)),i.registerVisual(i.util.curry(n(15),"graphGL")),i.registerVisual(function(e){var t={};e.eachSeriesByType("graphGL",function(e){var n=e.getCategoriesData(),i=e.getData(),r={};n.each(function(i){var o=n.getName(i);r[o]=i;var a=n.getItemModel(i),s=a.get("itemStyle.color")||e.getColorFromPalette(o,t);n.setItemVisual(i,"color",s)}),n.count()&&i.each(function(e){var t=i.getItemModel(e),o=t.getShallow("category");null!=o&&("string"==typeof o&&(o=r[o]),i.getItemVisual(e,"color",!0)||i.setItemVisual(e,"color",n.getItemVisual(o,"color")))})})}),i.registerVisual(function(e){e.eachSeriesByType("graphGL",function(e){var t=e.getGraph(),n=e.getEdgeData(),i="lineStyle.color".split("."),r="lineStyle.opacity".split(".");n.setVisual("color",e.get(i)),n.setVisual("opacity",e.get(r)),n.each(function(e){var o=n.getItemModel(e),a=t.getEdgeByIndex(e),s=o.get(i),l=o.get(r);switch(s){case"source":s=a.node1.getVisual("color");break;case"target":s=a.node2.getVisual("color")}a.setVisual("color",s),a.setVisual("opacity",l)})})}),i.registerAction({type:"graphGLRoam",event:"graphglroam",update:"series.graphGL:roam"},function(e,t){t.eachComponent({mainType:"series",query:e},function(t){t.setView(e)})}),i.registerAction({type:"graphGLStartLayout",event:"graphgllayoutstarted",update:"series.graphGL:startLayout"},function(){}),i.registerAction({type:"graphGLStopLayout",event:"graphgllayoutstopped",update:"series.graphGL:stopLayout"},function(){})},function(e,t,n){var i=n(0);n(111),n(112),i.registerVisual(i.util.curry(n(41),"line3D","circle",null)),i.registerVisual(i.util.curry(n(15),"line3D")),i.registerLayout(function(e,t){e.eachSeriesByType("line3D",function(e){var t=e.getData(),n=e.coordinateSystem;if(n){if("cartesian3D"!==n.type)return;var i=new Float32Array(3*t.count()),r=[],o=[];n&&t.each(["x","y","z"],function(e,t,a,s){r[0]=e,r[1]=t,r[2]=a,n.dataToPoint(r,o),i[3*s]=o[0],i[3*s+1]=o[1],i[3*s+2]=o[2]}),t.setLayout("points",i)}})})},function(e,t,n){var i=n(0);n(117),n(114),n(113),i.registerVisual(i.util.curry(n(15),"lines3D")),i.registerAction({type:"lines3DPauseEffect",event:"lines3deffectpaused",update:"series.lines3D:pauseEffect"},function(){}),i.registerAction({type:"lines3DResumeEffect",event:"lines3deffectresumed",update:"series.lines3D:resumeEffect"},function(){}),i.registerAction({type:"lines3DToggleEffect",event:"lines3deffectchanged",update:"series.lines3D:toggleEffect"},function(){})},function(e,t,n){var i=n(0);n(119),n(120),n(64),i.registerVisual(i.util.curry(n(15),"map3D")),i.registerAction({type:"map3DChangeCamera",event:"map3dcamerachanged",update:"series:updateCamera"},function(e,t){t.eachComponent({mainType:"series",subType:"map3D",query:e},function(t){t.setView(e)})})},function(e,t,n){var i=n(0);n(121),n(122),i.registerVisual(i.util.curry(n(41),"scatter3D","circle",null)),i.registerVisual(i.util.curry(n(15),"scatter3D")),i.registerLayout(function(e,t){e.eachSeriesByType("scatter3D",function(e){var t=e.getData(),n=e.coordinateSystem;if(n){if(n.dimensions.length<3)return;var i=new Float32Array(3*t.count()),r=[],o=[],a="globe"===n.type,s="geo3D"===n.type,l=e.get("distanceToGlobe"),c=e.get("distanceToGeo3D");n&&t.each(["x","y","z"],function(e,t,u,d){r[0]=e,r[1]=t,r[2]=a?l:s?n.size[1]+c:u,n.dataToPoint(r,o),i[3*d]=o[0],i[3*d+1]=o[1],i[3*d+2]=o[2]}),t.setLayout("points",i)}})})},function(e,t,n){var i=n(0);n(123),n(124),i.registerVisual(i.util.curry(n(41),"scatterGL","circle",null)),i.registerVisual(i.util.curry(n(15),"scatterGL")),i.registerLayout(function(e,t){e.eachSeriesByType("scatterGL",function(e){var t=e.getData(),n=e.coordinateSystem;if(n){var i=n.dimensions,r=new Float32Array(2*t.count());if(1===i.length)t.each(i[0],function(e,t){var i=n.dataToPoint(e);r[2*t]=i[0],r[2*t+1]=i[1]});else if(2===i.length){var o=[];t.each(i,function(e,t,i){o[0]=e,o[1]=t;var a=n.dataToPoint(o);r[2*i]=a[0],r[2*i+1]=a[1]})}t.setLayout("points",r)}})})},function(e,t,n){var i=n(0);n(125),n(126),n(127),i.registerVisual(i.util.curry(n(15),"surface"))},function(e,t,n){var i=n(0);n(128),n(129),n(64),i.registerAction({type:"geo3DChangeCamera",event:"geo3dcamerachanged",update:"series:updateCamera"},function(e,t){t.eachComponent({mainType:"geo3D",query:e},function(t){t.setView(e)})})},function(e,t,n){var i=n(0);n(130),n(131),n(141),i.registerAction({type:"globeChangeCamera",event:"globecamerachanged",update:"series:updateCamera"},function(e,t){t.eachComponent({mainType:"globe",query:e},function(t){t.setView(e)})})},function(e,t,n){n(132),n(135),n(136),n(144);var i=n(0);i.registerAction({type:"grid3DChangeCamera",event:"grid3dcamerachanged",update:"series:updateCamera"},function(e,t){t.eachComponent({mainType:"grid3D",query:e},function(t){t.setView(e)})}),i.registerAction({type:"grid3DShowAxisPointer",event:"grid3dshowaxispointer",update:"grid3D:showAxisPointer"},function(e,t){}),i.registerAction({type:"grid3DHideAxisPointer",event:"grid3dhideaxispointer",update:"grid3D:hideAxisPointer"},function(e,t){})},function(e,t,o){function n(e){throw new Error(e+" version is too old, needs "+d[e]+" or higher")}function i(e,t){e.replace(".","")-0<d[t].replace(".","")-0&&n(t)}function a(e){this._layers={},this._zr=e}var s={version:"1.0.0-alpha.2",dependencies:{echarts:"3.5.3",qtek:"0.3.3"}},l=o(0),c=o(217),u=o(145),d=s.dependencies;i(c,"qtek"),i(l.version,"echarts"),a.prototype.update=function(e,t){function r(e){var t=e.get("zlevel"),r=n._layers,o=r[t];if(!o){if(o=r[t]=new u("gl-"+t,i),i.painter.isSingleCanvas()){o.virtual=!0;var a=new l.graphic.Image({z:1e4,style:{image:o.renderer.canvas},silent:!0});o.__hostImage=a,i.add(a)}i.painter.insertLayer(t,o)}return o.__hostImage&&o.__hostImage.setStyle({width:o.renderer.getWidth(),height:o.renderer.getHeight()}),o}var n=this,i=t.getZr();if(i.getWidth()&&i.getHeight()){for(var o in this._layers)this._layers[o].removeViewsAll();e.eachComponent(function(n,i){if("series"!==n){var o=t.getViewOfComponentModel(i),a=i.coordinateSystem;if(o.__ecgl__){var s;if(a){if(!a.viewGL)return;s=a.viewGL}else{if(!i.viewGL)return;s=a.viewGL}var s=a.viewGL,l=r(i);l.addView(s),o.afterRender&&o.afterRender(i,e,t,l)}}}),e.eachSeries(function(n){var i=t.getViewOfSeriesModel(n),o=n.coordinateSystem;if(i.__ecgl__){if(o&&!o.viewGL&&!i.viewGL)return;var a=o&&o.viewGL||i.viewGL,s=r(n);s.addView(a),i.afterRender&&i.afterRender(n,e,t,s);var l=n.get("silent");i.groupGL&&i.groupGL.traverse(function(e){e.isRenderable&&e.isRenderable()&&(e.ignorePicking=null!=e.$ignorePicking?e.$ignorePicking:l)})}})}},l.registerPostUpdate(function(e,t){var n=t.getZr();(n.__egl=n.__egl||new a(n)).update(e,t)}),l.registerPreprocessor(o(153)),l.graphicGL=o(2),e.exports=a},function(e,t,n){n(96),n(95),n(93),n(94),n(85),n(87),n(90),n(88),n(92),n(89),n(91),n(86)},function(e,t,n){var i=n(0),r=n(26),o=n(48),a=n(25),s=i.extendSeriesModel({type:"series.bar3D",dependencies:["globe"],visualColorAccessPath:"itemStyle.color",getInitialData:function(e,t){var n=i.helper.completeDimensions(["x","y","z"],e.data,{defaultNames:["x","y","z","value"]}),r=new i.List(n,this);return r.initData(e.data),r},getFormattedLabel:function(e,t,n,i){var r=o.getFormattedLabel(this,e,t,n,i);return null==r&&(r=this.getData().get("z",e)),r},formatTooltip:function(e){return a(this,e)},defaultOption:{coordinateSystem:"cartesian3D",globeIndex:0,grid3DIndex:0,zlevel:-10,bevelSize:0,bevelSmoothness:2,onGridPlane:"xy",shading:"color",minHeight:0,maxHeight:100,itemStyle:{opacity:1},label:{show:!1,distance:2,textStyle:{fontSize:20,borderWidth:1,borderColor:"#fff"}},emphasis:{label:{show:!0}}}});i.util.merge(s.prototype,r),e.exports=s},function(e,t,i){function n(e){var t=o.createShader("ecgl."+e);return t.define("both","VERTEX_COLOR"),t}var r=i(0),o=i(2),a=(i(4),i(158)),s=i(46),l=i(33),c=i(1).vec3;e.exports=r.extendChartView({type:"bar3D",__ecgl__:!0,init:function(e,t){this.groupGL=new o.Node;var i=new o.Mesh({geometry:new a,renderOrder:10}),r={};o.COMMON_SHADERS.forEach(function(e){r[e]=new o.Material({shader:n(e)})}),this._materials=r,this._barMesh=i,this._api=t,this._labelsBuilder=new s(256,256,t);var u=this;this._labelsBuilder.getLabelPosition=function(e,t,n){if(u._data){var i=u._data.getItemLayout(e),r=i[0],o=i[1],a=i[2][1];return c.scaleAndAdd([],r,o,n+a)}return[0,0]},this._labelsBuilder.getMesh().renderOrder=100,this._tooltip=new l(t)},render:function(e,t,n){this.groupGL.add(this._barMesh),this.groupGL.add(this._labelsBuilder.getMesh());var i=e.coordinateSystem;if(this._doRender(e,n),i&&i.viewGL){i.viewGL.add(this.groupGL);var r=i.viewGL.isLinearSpace()?"define":"undefine";this._barMesh.material.shader[r]("fragment","SRGB_DECODE")}this._data=e.getData(),this._labelsBuilder.updateData(this._data),this._labelsBuilder.updateLabels()},_doRender:function(e,t){var n=e.getData(),i=e.get("shading"),r="color"!==i,a=this,s=this._barMesh;this._materials[i]?s.material=this._materials[i]:s.material=this._materials.lambert,o.setMaterialFromModel(i,s.material,e,t),s.geometry.enableNormal=r,s.geometry.resetOffset();var l=e.get("bevelSize"),c=e.get("bevelSmoothness");s.geometry.bevelSegments=c,s.geometry.bevelSize=l;var u=[],d=new Float32Array(4*n.count()),h=0,p=0,f=!1;n.each(function(e){if(n.hasValue(e)){var t=n.getItemVisual(e,"color"),i=n.getItemVisual(e,"opacity");null==i&&(i=1),o.parseColor(t,u),u[3]*=i,d[h++]=u[0],d[h++]=u[1],d[h++]=u[2],d[h++]=u[3],u[3]>0&&p++,u[3]<.99&&(f=!0)}}),s.geometry.setBarCount(p);var g=n.getLayout("orient"),m=this._barIndexOfData=new Int32Array(n.count()),p=0;n.each(function(e){if(!n.hasValue(e))return void(m[e]=-1);var t=n.getItemLayout(e),i=t[0],r=t[1],o=t[2],s=4*e;u[0]=d[s++],u[1]=d[s++],u[2]=d[s++],u[3]=d[s++],u[3]>0&&a._barMesh.geometry.addBar(i,r,g,o,u,e),m[e]=p++}),s.geometry.dirty(),s.geometry.updateBoundingBox();var v=s.material;v.transparent=f,v.depthMask=!f,s.geometry.sortTriangles=f,this._initHandler(e,t)},_initHandler:function(e,t){var n=e.getData(),i=this._barMesh,r="cartesian3D"===e.coordinateSystem.type,o=-1;i.off("mousemove"),i.off("mouseout"),i.on("mousemove",function(a){var s=i.geometry.getDataIndexOfVertex(a.triangle[0]);s!==o&&(this._downplay(o),this._highlight(s),this._labelsBuilder.updateLabels([s]),r&&t.dispatchAction({type:"grid3DShowAxisPointer",value:[n.get("x",s),n.get("y",s),n.get("z",s)]})),this._tooltip.updateTooltip(e,s,a.offsetX,a.offsetY),o=s},this),i.on("mouseout",function(e){this._downplay(o),this._labelsBuilder.updateLabels(),o=-1,r&&t.dispatchAction({type:"grid3DHideAxisPointer"}),this._tooltip.hideTooltip()},this)},_highlight:function(e){var t=this._data;if(t){var n=this._barIndexOfData[e];if(!(n<0)){var i=t.getItemModel(e),a=i.getModel("emphasis.itemStyle"),s=a.get("color"),l=a.get("opacity");if(null==s){var c=t.getItemVisual(e,"color");s=r.color.lift(c,-.4)}null==l&&(l=t.getItemVisual(e,"opacity"));var u=o.parseColor(s);u[3]*=l,this._barMesh.geometry.setColor(n,u),this._api.getZr().refresh()}}},_downplay:function(e){var t=this._data;if(t){var n=this._barIndexOfData[e];if(!(n<0)){var i=t.getItemVisual(e,"color"),r=t.getItemVisual(e,"opacity"),a=o.parseColor(i);a[3]*=r,this._barMesh.geometry.setColor(n,a),this._api.getZr().refresh()}}},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll()}})},function(e,t,r){function n(e,t){var n=e.getData(),i=n.getDataExtent("z",!0),r=[e.get("minHeight"),e.get("maxHeight")],l=Math.abs(i[1]-i[0])<1e-10,c=e.get("barSize");if(null==c){var u=t.radius*Math.PI*2;c=[u/720,u/720]}else o.util.isArray(c)||(c=[c,c]);n.each(["x","y","z"],function(e,a,u,d){var h=l?r[1]:o.number.linearMap(u,i,r),p=t.dataToPoint([e,a,0]),f=t.dataToPoint([e,a,h]),g=s.sub([],f,p),m=[c[0],h,c[1]];n.setItemLayout(d,[p,g,m])}),n.setLayout("orient",a.UP._array)}function i(e,t){var n=e.getData(),i=n.getDataExtent("z",!0),r=[e.get("minHeight"),e.get("maxHeight")],a=Math.abs(i[1]-i[0])<1e-10,s=e.get("barSize");if(null==s){var l=Math.min(t.size[0],t.size[2]);s=[l/Math.sqrt(n.count()),l/Math.sqrt(n.count())]}else o.util.isArray(s)||(s=[s,s]);var c=[0,1,0];n.each(["x","y","z"],function(e,l,u,d){var h=a?r[1]:o.number.linearMap(u,i,r),p=t.dataToPoint([e,l,t.size[1]]),f=[s[0],h,s[1]];n.setItemLayout(d,[p,c,f])}),n.setLayout("orient",[1,0,0])}var o=r(0),a=r(3),s=r(1).vec3,l=r(101);o.registerLayout(function(e,t){e.eachSeriesByType("bar3D",function(e){var t=e.coordinateSystem,r=t&&t.type;"globe"===r?n(e,t):"cartesian3D"===r?l(e,t):"geo3D"===r&&i(e,t)})})},function(e,t,i){function n(e,t){var n=e.getData(),i=(e.get("onGridPlane"),e.get("barSize"));if(null==i){var a,s,l=t.size,c=t.getAxis("x"),u=t.getAxis("y");a="category"===c.type?.7*c.getBandWidth():.6*Math.round(l[0]/Math.sqrt(n.count())),s="category"===u.type?.7*u.getBandWidth():.6*Math.round(l[1]/Math.sqrt(n.count())),i=[a,s]}else r.util.isArray(i)||(i=[i,i]);var d=[0,1,0];n.each(["x","y","z"],function(e,r,a,s){var l=t.dataToPoint([e,r,0]),c=t.dataToPoint([e,r,a]),u=o.dist(l,c);0===Math.abs(u)&&(u=.1);var h=[i[0],u,i[1]];n.setItemLayout(s,[l,d,h])}),n.setLayout("orient",[1,0,0])}var r=i(0),o=i(1).vec3;e.exports=n},function(e,t,n){var i=n(2),r=n(162),o=n(0),a=n(1),s=a.vec4;i.Shader.import(n(103));var l=i.Mesh.extend(function(){var e=new i.Geometry({dynamic:!0});o.util.extend(e,r),e.createAttribute("color","float",4,"COLOR"),e.createAttribute("strokeColor","float",4),e.createAttribute("size","float",1);var t=new i.Material({shader:i.createShader("ecgl.sdfSprite"),transparent:!0,depthMask:!1});t.shader.enableTexture("sprite"),t.shader.define("both","VERTEX_COLOR");var n=new i.Texture2D({image:document.createElement("canvas"),flipY:!1});return t.set("sprite",n),e.pick=this._pick.bind(this),{geometry:e,material:t,mode:i.Mesh.POINTS,sizeScale:1}},{_pick:function(e,t,n,r,o,a){var s=this._positionNDC;if(s)for(var l=n.viewport,c=2/l.width,u=2/l.height,d=this.geometry.vertexCount-1;d>=0;d--){var h;h=this.geometry.indices?this.geometry.indices[d]:d;var p=s[2*h],f=s[2*h+1],g=this.geometry.attributes.size.get(h)/this.sizeScale,m=g/2;if(e>p-m*c&&e<p+m*c&&t>f-m*u&&t<f+m*u){var v=new i.Vector3,_=new i.Vector3;this.geometry.attributes.position.get(h,v._array),i.Vector3.transformMat4(_,v,this.worldTransform),a.push({vertexIndex:h,point:v,pointWorld:_,target:this,distance:_.distance(r.getWorldPosition())})}}},updateNDCPosition:function(e,t,n){var i=this._positionNDC,r=this.geometry;if(i&&i.length/2===r.vertexCount||(i=this._positionNDC=new Float32Array(2*r.vertexCount)),!t)for(var o=s.create(),a=0;a<r.vertexCount;a++)r.attributes.position.get(a,o),o[3]=1,s.transformMat4(o,o,e._array),s.scale(o,o,1/o[3]),i[2*a]=o[0],i[2*a+1]=o[1]}});e.exports=l},function(e,t){e.exports="@export ecgl.sdfSprite.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform float elapsedTime : 0;\n\nattribute vec3 position : POSITION;\n\n#ifdef VERTEX_COLOR\nattribute vec4 a_FillColor: COLOR;\nvarying vec4 v_Color;\n#endif\n\nattribute float size;\n\n#ifdef ANIMATING\nattribute float delay;\n#endif\n\n#ifdef POSITIONTEXTURE_ENABLED\nuniform sampler2D positionTexture;\n#endif\n\nvarying float v_Size;\n\nvoid main()\n{\n\n#ifdef POSITIONTEXTURE_ENABLED\n        gl_Position = worldViewProjection * vec4(texture2D(positionTexture, position.xy).xy, -10.0, 1.0);\n#else\n    gl_Position = worldViewProjection * vec4(position, 1.0);\n#endif\n\n#ifdef ANIMATING\n    gl_PointSize = size * (sin((elapsedTime + delay) * 3.14) * 0.5 + 1.0);\n#else\n    gl_PointSize = size;\n#endif\n\n#ifdef VERTEX_COLOR\n    v_Color = a_FillColor;\n    #endif\n\n    v_Size = size;\n}\n\n@end\n\n@export ecgl.sdfSprite.fragment\n\nuniform vec4 color: [1, 1, 1, 1];\nuniform vec4 strokeColor: [1, 1, 1, 1];\nuniform float smoothing: 0.07;\n\nuniform float lineWidth: 0.0;\n\n#ifdef VERTEX_COLOR\nvarying vec4 v_Color;\n#endif\n\nvarying float v_Size;\n\nuniform sampler2D sprite;\n\n@import qtek.util.srgb\n\nvoid main()\n{\n    gl_FragColor = color;\n\n    vec4 _strokeColor = strokeColor;\n\n#ifdef VERTEX_COLOR\n    gl_FragColor *= v_Color;\n        #endif\n\n#ifdef SPRITE_ENABLED\n    float d = texture2D(sprite, gl_PointCoord).r;\n        gl_FragColor.a *= smoothstep(0.5 - smoothing, 0.5 + smoothing, d);\n\n    if (lineWidth > 0.0) {\n                float sLineWidth = lineWidth / 2.0;\n\n        float outlineMaxValue0 = 0.5 + sLineWidth;\n        float outlineMaxValue1 = 0.5 + sLineWidth + smoothing;\n        float outlineMinValue0 = 0.5 - sLineWidth - smoothing;\n        float outlineMinValue1 = 0.5 - sLineWidth;\n\n                if (d <= outlineMaxValue1 && d >= outlineMinValue0) {\n            float a = _strokeColor.a;\n            if (d <= outlineMinValue1) {\n                a = a * smoothstep(outlineMinValue0, outlineMinValue1, d);\n            }\n            else {\n                a = a * smoothstep(outlineMaxValue1, outlineMaxValue0, d);\n            }\n            gl_FragColor.rgb = mix(gl_FragColor.rgb * gl_FragColor.a, _strokeColor.rgb, a);\n            gl_FragColor.a = gl_FragColor.a * (1.0 - a) + a;\n        }\n    }\n#endif\n\n#ifdef SRGB_DECODE\n    gl_FragColor = sRGBToLinear(gl_FragColor);\n#endif\n\n    if (gl_FragColor.a == 0.0) {\n        discard;\n    }\n}\n@end"},function(e,t,n){var i=n(7),r=n(6),o=n(110),a=o.toString();a=a.slice(a.indexOf("{")+1,a.lastIndexOf("}"));var s={barnesHutOptimize:!0,barnesHutTheta:1.5,repulsionByDegree:!0,linLogMode:!1,strongGravityMode:!1,gravity:1,scaling:1,edgeWeightInfluence:1,jitterTolerence:.1,preventOverlap:!1,dissuadeHubs:!1,gravityCenter:null},l=function(e){for(var t in s)this[t]=s[t];if(e)for(var t in e)this[t]=e[t];this._nodes=[],this._edges=[],this._disposed=!1,this._positionTex=new i({type:r.FLOAT,flipY:!1,minFilter:r.NEAREST,magFilter:r.NEAREST})};l.prototype.initData=function(e,t){var n=new Blob([a]),i=window.URL.createObjectURL(n);this._worker=new Worker(i),this._worker.onmessage=this._$onupdate.bind(this),this._nodes=e,this._edges=t,this._frame=0;for(var r=e.length,o=t.length,s=new Float32Array(2*r),l=new Float32Array(r),c=new Float32Array(r),u=new Float32Array(2*o),d=new Float32Array(o),h=0;h<e.length;h++){var p=e[h];s[2*h]=p.x,s[2*h+1]=p.y,l[h]=null==p.mass?1:p.mass,c[h]=null==p.size?1:p.size}for(var h=0;h<t.length;h++){var f=t[h],g=f.node1,m=f.node2;u[2*h]=g,u[2*h+1]=m,d[h]=null==f.weight?1:f.weight}var v=Math.ceil(Math.sqrt(e.length)),_=v,y=new Float32Array(v*_*4),x=this._positionTex;x.width=v,x.height=_,x.pixels=y,this._worker.postMessage({cmd:"init",nodesPosition:s,nodesMass:l,nodesSize:c,edges:u,edgesWeight:d}),this._globalSpeed=1/0},l.prototype.updateOption=function(e){var t={};for(var n in s)t[n]=s[n];var i=this._nodes,r=this._edges,o=i.length;if(t.jitterTolerence=o>5e4?10:o>5e3?1:.1,t.scaling=o>100?2:10,t.barnesHutOptimize=o>1e3,e)for(var n in s)null!=e[n]&&(t[n]=e[n]);if(!t.gravityCenter){for(var a=[1/0,1/0],l=[-1/0,-1/0],c=0;c<i.length;c++)a[0]=Math.min(i[c].x,a[0]),a[1]=Math.min(i[c].y,a[1]),l[0]=Math.max(i[c].x,l[0]),l[1]=Math.max(i[c].y,l[1]);t.gravityCenter=[.5*(a[0]+l[0]),.5*(a[1]+l[1])]}for(var c=0;c<r.length;c++){var u=r[c].node1,d=r[c].node2;i[u].degree=(i[u].degree||0)+1,i[d].degree=(i[d].degree||0)+1}this._worker&&this._worker.postMessage({cmd:"updateConfig",config:t})},l.prototype.update=function(e,t,n){null==t&&(t=1),t=Math.max(t,1),this._frame+=t,this._onupdate=n,this._worker&&this._worker.postMessage({cmd:"update",steps:Math.round(t)})},l.prototype._$onupdate=function(e){if(!this._disposed){var t=new Float32Array(e.data.buffer);this._globalSpeed=e.data.globalSpeed,this._positionArr=t,this._updateTexture(t),this._onupdate&&this._onupdate()}},l.prototype.getNodePositionTexture=function(){return this._positionTex},l.prototype.getNodeUV=function(e,t){t=t||[];var n=this._positionTex.width,i=this._positionTex.height;return t[0]=e%n/(n-1),t[1]=Math.floor(e/n)/(i-1),t},l.prototype.getNodes=function(){return this._nodes},l.prototype.getEdges=function(){return this._edges},l.prototype.isFinished=function(e){return this._globalSpeed<e&&this._frame>10},l.prototype.getNodePosition=function(e,t){if(t||(t=new Float32Array(2*this._nodes.length)),this._positionArr)for(var n=0;n<this._positionArr.length;n++)t[n]=this._positionArr[n];return t},l.prototype._updateTexture=function(e){for(var t=this._positionTex.pixels,n=0,i=0;i<e.length;)t[n++]=e[i++],t[n++]=e[i++],t[n++]=1,t[n++]=1;this._positionTex.dirty()},l.prototype.dispose=function(e){this._disposed=!0,this._worker=null},e.exports=l},function(e,t,i){function n(e){var t={type:o.Texture.FLOAT,minFilter:o.Texture.NEAREST,magFilter:o.Texture.NEAREST};this._positionSourceTex=new o.Texture2D(t),this._positionSourceTex.flipY=!1,this._positionTex=new o.Texture2D(t),this._positionPrevTex=new o.Texture2D(t),this._forceTex=new o.Texture2D(t),this._forcePrevTex=new o.Texture2D(t),this._weightedSumTex=new o.Texture2D(t),this._weightedSumTex.width=this._weightedSumTex.height=1,this._globalSpeedTex=new o.Texture2D(t),this._globalSpeedPrevTex=new o.Texture2D(t),this._globalSpeedTex.width=this._globalSpeedTex.height=1,this._globalSpeedPrevTex.width=this._globalSpeedPrevTex.height=1,this._nodeRepulsionPass=new a({fragment:o.Shader.source("ecgl.forceAtlas2.updateNodeRepulsion")}),this._positionPass=new a({fragment:o.Shader.source("ecgl.forceAtlas2.updatePosition")}),this._globalSpeedPass=new a({fragment:o.Shader.source("ecgl.forceAtlas2.calcGlobalSpeed")}),this._copyPass=new a({fragment:o.Shader.source("qtek.compositor.output")});var n=function(e){e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ONE)};this._edgeForceMesh=new o.Mesh({geometry:new o.Geometry({attributes:{node1:new o.Geometry.Attribute("node1","float",2),node2:new o.Geometry.Attribute("node2","float",2),weight:new o.Geometry.Attribute("weight","float",1)},dynamic:!0,mainAttribute:"node1"}),material:new o.Material({transparent:!0,shader:o.createShader("ecgl.forceAtlas2.updateEdgeAttraction"),blend:n,depthMask:!1,depthText:!1}),mode:o.Mesh.POINTS}),this._weightedSumMesh=new o.Mesh({geometry:new o.Geometry({attributes:{node:new o.Geometry.Attribute("node","float",2)},dynamic:!0,mainAttribute:"node"}),material:new o.Material({transparent:!0,shader:o.createShader("ecgl.forceAtlas2.calcWeightedSum"),blend:n,depthMask:!1,depthText:!1}),mode:o.Mesh.POINTS}),this._framebuffer=new s({depthBuffer:!1}),this._dummyCamera=new o.OrthographicCamera({left:-1,right:1,top:1,bottom:-1,near:0,far:100}),this._globalSpeed=0}var r=i(0),o=i(2),a=i(21),s=i(11);o.Shader.import(i(109));var l={repulsionByDegree:!0,linLogMode:!1,strongGravityMode:!1,gravity:1,scaling:1,edgeWeightInfluence:1,jitterTolerence:.1,preventOverlap:!1,dissuadeHubs:!1,gravityCenter:null};n.prototype.updateOption=function(e){for(var t in l)this[t]=l[t];var n=this._nodes.length;if(this.jitterTolerence=n>5e4?10:n>5e3?1:.1,this.scaling=n>100?2:10,e)for(var t in l)null!=e[t]&&(this[t]=e[t]);if(this.repulsionByDegree)for(var i=this._positionSourceTex.pixels,r=0;r<this._nodes.length;r++)i[4*r+2]=(this._nodes[r].degree||0)+1},n.prototype._updateGravityCenter=function(e){var t=this._nodes,n=this._edges;if(this.gravityCenter)this._gravityCenter=this.gravityCenter;else{for(var i=[1/0,1/0],r=[-1/0,-1/0],o=0;o<t.length;o++)i[0]=Math.min(t[o].x,i[0]),i[1]=Math.min(t[o].y,i[1]),r[0]=Math.max(t[o].x,r[0]),r[1]=Math.max(t[o].y,r[1]);this._gravityCenter=[.5*(i[0]+r[0]),.5*(i[1]+r[1])]}for(var o=0;o<n.length;o++){var a=n[o].node1,s=n[o].node2;t[a].degree=(t[a].degree||0)+1,t[s].degree=(t[s].degree||0)+1}},n.prototype.initData=function(e,t){this._nodes=e,this._edges=t,this._updateGravityCenter();var n=Math.ceil(Math.sqrt(e.length)),i=n,r=new Float32Array(n*i*4);this._resize(n,i);for(var o=0,a=0;a<e.length;a++){var s=e[a];r[o++]=s.x||0,r[o++]=s.y||0,r[o++]=s.mass||1,r[o++]=s.size||1}this._positionSourceTex.pixels=r;var l=this._edgeForceMesh.geometry,c=t.length;l.attributes.node1.init(2*c),l.attributes.node2.init(2*c),l.attributes.weight.init(2*c);for(var u=[],a=0;a<t.length;a++){var d=l.attributes,h=t[a].weight;null==h&&(h=1),d.node1.set(a,this.getNodeUV(t[a].node1,u)),d.node2.set(a,this.getNodeUV(t[a].node2,u)),d.weight.set(a,h),d.node1.set(a+c,this.getNodeUV(t[a].node2,u)),d.node2.set(a+c,this.getNodeUV(t[a].node1,u)),d.weight.set(a+c,h)}var p=this._weightedSumMesh.geometry;p.attributes.node.init(e.length);for(var a=0;a<e.length;a++)p.attributes.node.set(a,this.getNodeUV(a,u));l.dirty(),p.dirty(),this._nodeRepulsionPass.material.shader.define("fragment","NODE_COUNT",e.length),this._nodeRepulsionPass.material.setUniform("textureSize",[n,i]),this._inited=!1,this._frame=0},n.prototype.getNodes=function(){return this._nodes},n.prototype.getEdges=function(){return this._edges},n.prototype.step=function(e){this._inited||(this._initFromSource(e),this._inited=!0),this._frame++,this._framebuffer.attach(this._forceTex),this._framebuffer.bind(e);var t=this._nodeRepulsionPass;t.setUniform("strongGravityMode",this.strongGravityMode),t.setUniform("gravity",this.gravity),t.setUniform("gravityCenter",this._gravityCenter),t.setUniform("scaling",this.scaling),t.setUniform("preventOverlap",this.preventOverlap),t.setUniform("positionTex",this._positionPrevTex),t.render(e);var n=this._edgeForceMesh;n.material.set("linLogMode",this.linLogMode),n.material.set("edgeWeightInfluence",this.edgeWeightInfluence),n.material.set("preventOverlap",this.preventOverlap),n.material.set("positionTex",this._positionPrevTex),e.gl.enable(e.gl.BLEND),e.renderQueue([n],this._dummyCamera),this._framebuffer.attach(this._weightedSumTex),e.gl.clearColor(0,0,0,0),e.gl.clear(e.gl.COLOR_BUFFER_BIT),e.gl.enable(e.gl.BLEND);var i=this._weightedSumMesh;i.material.set("positionTex",this._positionPrevTex),i.material.set("forceTex",this._forceTex),i.material.set("forcePrevTex",this._forcePrevTex),e.renderQueue([i],this._dummyCamera),this._framebuffer.attach(this._globalSpeedTex);var r=this._globalSpeedPass;r.setUniform("globalSpeedPrevTex",this._globalSpeedPrevTex),r.setUniform("weightedSumTex",this._weightedSumTex),r.setUniform("jitterTolerence",this.jitterTolerence),e.gl.disable(e.gl.BLEND),r.render(e);var o=this._positionPass;this._framebuffer.attach(this._positionTex),o.setUniform("globalSpeedTex",this._globalSpeedTex),o.setUniform("positionTex",this._positionPrevTex),o.setUniform("forceTex",this._forceTex),o.setUniform("forcePrevTex",this._forcePrevTex),o.render(e),this._framebuffer.unbind(e),this._swapTexture()},n.prototype.update=function(e,t,n){null==t&&(t=1),t=Math.max(t,1);for(var i=0;i<t;i++)this.step(e);n&&n()},n.prototype.getNodePositionTexture=function(){return this._inited?this._positionPrevTex:this._positionSourceTex},n.prototype.getNodeUV=function(e,t){t=t||[];var n=this._positionTex.width,i=this._positionTex.height;return t[0]=e%n/(n-1),t[1]=Math.floor(e/n)/(i-1)||0,t},n.prototype.getNodePosition=function(e,t){var n=this._positionArr,i=this._positionTex.width,r=this._positionTex.height,o=i*r;n&&n.length===4*o||(n=this._positionArr=new Float32Array(4*o)),this._framebuffer.bind(e),this._framebuffer.attach(this._positionPrevTex),e.gl.readPixels(0,0,i,r,e.gl.RGBA,e.gl.FLOAT,n),this._framebuffer.unbind(e),t||(t=new Float32Array(2*this._nodes.length));for(var a=0;a<this._nodes.length;a++)t[2*a]=n[4*a],t[2*a+1]=n[4*a+1];return t},n.prototype.getTextureData=function(e,t){var n=this["_"+t+"Tex"],i=n.width,r=n.height;this._framebuffer.bind(e),this._framebuffer.attach(n);var o=new Float32Array(i*r*4);return e.gl.readPixels(0,0,i,r,e.gl.RGBA,e.gl.FLOAT,o),this._framebuffer.unbind(e),o},n.prototype.getTextureSize=function(){return{width:this._positionTex.width,height:this._positionTex.height}},n.prototype.isFinished=function(e,t){var n=this.getTextureData(e,"globalSpeed");return this._inited&&n[0]<t&&this._frame>10},n.prototype._swapTexture=function(){var e=this._positionPrevTex;this._positionPrevTex=this._positionTex,this._positionTex=e;var e=this._forcePrevTex;this._forcePrevTex=this._forceTex,this._forceTex=e;var e=this._globalSpeedPrevTex;this._globalSpeedPrevTex=this._globalSpeedTex,this._globalSpeedTex=e},n.prototype._initFromSource=function(e){this._framebuffer.attach(this._positionPrevTex),this._framebuffer.bind(e),this._copyPass.setUniform("texture",this._positionSourceTex),this._copyPass.render(e),e.gl.clearColor(0,0,0,0),this._framebuffer.attach(this._forcePrevTex),e.gl.clear(e.gl.COLOR_BUFFER_BIT),this._framebuffer.attach(this._globalSpeedPrevTex),e.gl.clear(e.gl.COLOR_BUFFER_BIT),this._framebuffer.unbind(e)},n.prototype._resize=function(e,t){["_positionSourceTex","_positionTex","_positionPrevTex","_forceTex","_forcePrevTex"].forEach(function(n){this[n].width=e,this[n].height=t,this[n].dirty()},this)},n.prototype.dispose=function(e){var t=e.gl;this._framebuffer.dispose(t),this._copyPass.dispose(t),this._nodeRepulsionPass.dispose(t),this._positionPass.disable(t),this._globalSpeedPass.dispose(t),this._edgeForceMesh.material.shader.dispose(t),this._edgeForceMesh.geometry.dispose(t),this._weightedSumMesh.material.shader.dispose(t),this._weightedSumMesh.geometry.dispose(t),this._positionSourceTex.dispose(t),this._positionTex.dispose(t),this._positionPrevTex.dispose(t),this._forceTex.dispose(t),this._forcePrevTex.dispose(t),this._weightedSumTex.dispose(t),this._globalSpeedTex.disable(t),this._globalSpeedPrevTex.disable(t)},r.ForceAtlas2GPU=n,e.exports=n},function(e,t,n){var o=n(0),a=n(108),s=o.extendSeriesModel({type:"series.graphGL",visualColorAccessPath:"itemStyle.color",init:function(e){s.superApply(this,"init",arguments),this.legendDataProvider=function(){return this._categoriesData},this._updateCategoriesData()},mergeOption:function(e){s.superApply(this,"mergeOption",arguments),this._updateCategoriesData()},getInitialData:function(e,t){function r(e,n){function i(e){return e=this.parsePath(e),e&&"label"===e[0]?a:this.parentModel}e.wrapMethod("getItemModel",function(e){var t=l._categoriesModels,n=e.getShallow("category"),i=t[n];return i&&(i.parentModel=e.parentModel,e.parentModel=i),e});var r=l.getModel("edgeLabel"),a=new o.Model({label:r.option},r.parentModel,t);n.wrapMethod("getItemModel",function(e){return e.customizeGetParent(i),e})}var n=e.edges||e.links||[],s=e.data||e.nodes||[],l=this;if(s&&n)return a(s,n,this,!0,r).data},getGraph:function(){return this.getData().graph},getEdgeData:function(){return this.getGraph().edgeData},getCategoriesData:function(){return this._categoriesData},formatTooltip:function(e,t,n){if("edge"===n){var i=this.getData(),r=this.getDataParams(e,n),a=i.graph.getEdgeByIndex(e),l=i.getName(a.node1.dataIndex),c=i.getName(a.node2.dataIndex),u=[];return null!=l&&u.push(l),null!=c&&u.push(c),u=o.format.encodeHTML(u.join(" > ")),r.value&&(u+=" : "+o.format.encodeHTML(r.value)),u}return s.superApply(this,"formatTooltip",arguments)},_updateCategoriesData:function(){var e=(this.option.categories||[]).map(function(e){return null!=e.value?e:o.util.extend({value:0},e)}),t=new o.List(["value"],this);t.initData(e),this._categoriesData=t,this._categoriesModels=t.mapArray(function(e){return t.getItemModel(e,!0)})},setView:function(e){null!=e.zoom&&(this.option.zoom=e.zoom),null!=e.offset&&(this.option.offset=e.offset)},isAnimationEnabled:function(){return s.superCall(this,"isAnimationEnabled")&&!("force"===this.get("layout")&&this.get("force.layoutAnimation"))},defaultOption:{zlevel:10,z:2,legendHoverLink:!0,layout:"forceAtlas2",forceAtlas2:{initLayout:null,GPU:!0,steps:1,stopThreshold:1,repulsionByDegree:!0,linLogMode:!1,strongGravityMode:!1,gravity:1,edgeWeightInfluence:1,edgeWeight:[1,4],nodeWeight:[1,4],preventOverlap:!1,gravityCenter:null},focusNodeAdjacency:!1,left:"center",top:"center",symbol:"circle",symbolSize:5,roam:!1,center:null,zoom:1,label:{show:!1,formatter:"{b}",position:"right"},itemStyle:{},lineStyle:{color:"#aaa",width:1,opacity:.5},emphasis:{label:{show:!0}}}});e.exports=s},function(e,t,n){var i=n(0),r=n(40),o=n(2),a=n(27),s=n(159),l=n(4),c=n(105),u=n(104),d=n(82),h=n(1).vec2,p=n(155),f=n(45);o.Shader.import(n(167));var g=1;i.extendChartView({type:"graphGL",__ecgl__:!0,init:function(e,t){this.groupGL=new o.Node,this.viewGL=new a("orthographic"),this.viewGL.add(this.groupGL),this._pointsBuilder=new f(!0,t),this._forceEdgesMesh=new o.Mesh({material:new o.Material({shader:o.createShader("ecgl.forceAtlas2.edges"),transparent:!0,depthMask:!1,depthTest:!1}),geometry:new o.Geometry({attributes:{node:new o.Geometry.Attribute("node","float",2),color:new o.Geometry.Attribute("color","float",4,"COLOR")},dynamic:!0,mainAttribute:"node"}),renderOrder:-1,mode:o.Mesh.LINES}),this._edgesMesh=new o.Mesh({material:new o.Material({shader:o.createShader("ecgl.meshLines2D"),transparent:!0,depthMask:!1,depthTest:!1}),geometry:new s({useNativeLine:!1,dynamic:!0}),culling:!1}),this._layoutId=0,this._control=new p({zr:t.getZr(),viewGL:this.viewGL}),this._control.setTarget(this.groupGL),this._control.init()},render:function(e,t,n){this.groupGL.add(this._pointsBuilder.rootNode),this._model=e,this._api=n,this._initLayout(e,t,n),this._pointsBuilder.update(e,t,n),this._updateForceNodesGeometry(e.getData()),this._forceLayoutInstance instanceof c||this.groupGL.remove(this._forceEdgesMesh),this._updateCamera(e,n),this._control.off("update"),this._control.on("update",function(){n.dispatchAction({type:"graphGLRoam",seriesId:e.id,zoom:this._control.getZoom(),offset:this._control.getOffset()})},this),this._control.setZoom(l.firstNotNull(e.get("zoom"),1)),this._control.setOffset(e.get("offset")||[0,0])},_updateForceEdgesGeometry:function(e,t){var n=this._forceEdgesMesh.geometry,i=t.getEdgeData(),r=0,a=this._forceLayoutInstance,s=2*i.count();n.attributes.node.init(s),n.attributes.color.init(s),i.each(function(t){var s=e[t];n.attributes.node.set(r,a.getNodeUV(s.node1)),n.attributes.node.set(r+1,a.getNodeUV(s.node2));var c=i.getItemVisual(s.dataIndex,"color"),u=o.parseColor(c);u[3]*=l.firstNotNull(i.getItemVisual(s.dataIndex,"opacity"),1),n.attributes.color.set(r,u),n.attributes.color.set(r+1,u),r+=2}),n.dirty()},_updateEdgesGeometry:function(e){var t=this._edgesMesh.geometry,n=this._model.getEdgeData(),i=this._model.getData().getLayout("points");t.resetOffset(),t.setVertexCount(e.length*t.getLineVertexCount()),t.setTriangleCount(e.length*t.getLineTriangleCount());for(var r=[],a=[],s=["lineStyle","width"],c=0;c<e.length;c++){var u=e[c],d=2*u.node1,h=2*u.node2;r[0]=i[d],r[1]=i[d+1],a[0]=i[h],a[1]=i[h+1];var p=n.getItemVisual(c,"color"),f=o.parseColor(p);f[3]*=l.firstNotNull(n.getItemVisual(c,"opacity"),1);var g=n.getItemModel(c),m=l.firstNotNull(g.get(s),1)*this._api.getDevicePixelRatio();t.addLine(r,a,f,m)}t.dirty()},_updateForceNodesGeometry:function(e){for(var t=this._pointsBuilder.getPointsMesh(),n=[],i=0;i<e.count();i++)t.geometry.attributes.position.get(i,n),this._forceLayoutInstance.getNodeUV(i,n),t.geometry.attributes.position.set(i,n);t.geometry.dirty()},_initLayout:function(e,t,n){var o=e.get("layout"),a=e.getGraph(),s=e.getBoxLayoutParams(),d=r.getLayoutRect(s,{width:n.getWidth(),height:n.getHeight()});"force"===o&&(o="forceAtlas2"),this.stopLayout();var h=e.getData(),p=e.getData();if("forceAtlas2"===o){var f=e.getModel("forceAtlas2"),g=this._forceLayoutInstance,m=[],v=[],_=h.getDataExtent("value"),y=p.getDataExtent("value"),x=l.firstNotNull(f.get("edgeWeight"),1),b=l.firstNotNull(f.get("nodeWeight"),1);"number"==typeof x&&(x=[x,x]),"number"==typeof b&&(b=[b,b]);var w=0,C={},S=new Float32Array(2*h.count());if(a.eachNode(function(e){var t,n,r=e.dataIndex,o=h.get("value",r);if(h.hasItemOption){var a=h.getItemModel(r);t=a.get("x"),n=a.get("y")}null==t&&(t=d.x+Math.random()*d.width,n=d.y+Math.random()*d.height),S[2*w]=t,S[2*w+1]=n,C[e.id]=w++;var s=i.number.linearMap(o,_,b);isNaN(s)&&(s=isNaN(b[0])?1:b[0]),m.push({x:t,y:n,mass:s})}),h.setLayout("points",S),a.eachEdge(function(e){var t=e.dataIndex,n=h.get("value",t),r=i.number.linearMap(n,y,x);isNaN(r)&&(r=isNaN(x[0])?1:x[0]),v.push({node1:C[e.node1.id],node2:C[e.node2.id],weight:r})}),!g){var T=f.get("GPU");this._forceLayoutInstance&&((!T||this._forceLayoutInstance instanceof c)&&(T||this._forceLayoutInstance instanceof u)||(this._forceLayoutInstanceToDispose=this._forceLayoutInstance)),g=this._forceLayoutInstance=T?new c:new u}g.initData(m,v),g.updateOption(f.option),this._updateForceEdgesGeometry(g.getEdges(),e),this._updatePositionTexture(),n.dispatchAction({type:"graphGLStartLayout"})}else{var S=new Float32Array(2*h.count());a.eachNode(function(e){var t,n,i=e.dataIndex;if(h.hasItemOption){var r=h.getItemModel(i);t=r.get("x"),n=r.get("y")}S[2*w]=t,S[2*w+1]=n}),h.setLayout("points",S)}},startLayout:function(){var e=this.viewGL,t=this._api,n=this._forceLayoutInstance,i=this._model.getModel("forceAtlas2");if(this.groupGL.remove(this._edgesMesh),this.groupGL.add(this._forceEdgesMesh),this._forceLayoutInstance){var r=this,o=this._layoutId=g++,a=i.getShallow("stopThreshold"),s=i.getShallow("steps"),l=function(i){if(i===r._layoutId)return n.isFinished(e.layer.renderer,a)?void t.dispatchAction({type:"graphGLStopLayout"}):void n.update(e.layer.renderer,s,function(){r._updatePositionTexture(),t.getZr().refresh(),d(function(){l(i)})})};d(function(){r._forceLayoutInstanceToDispose&&(r._forceLayoutInstanceToDispose.dispose(e.layer.renderer),r._forceLayoutInstanceToDispose=null),l(o)})}},_updatePositionTexture:function(){var e=this._forceLayoutInstance.getNodePositionTexture();this._pointsBuilder.setPositionTexture(e),this._forceEdgesMesh.material.set("positionTex",e)},stopLayout:function(){if(this._layoutId=0,this.groupGL.remove(this._forceEdgesMesh),this.groupGL.add(this._edgesMesh),this._forceLayoutInstance&&this.viewGL.layer){var e=this._forceLayoutInstance.getNodePosition(this.viewGL.layer.renderer);this._model.getData().setLayout("points",e),this._updateEdgesGeometry(this._forceLayoutInstance.getEdges()),this._api.getZr().refresh()}},_updateCamera:function(e,t){this.viewGL.setViewport(0,0,t.getWidth(),t.getHeight(),t.getDevicePixelRatio());for(var n=this.viewGL.camera,i=e.getData(),r=i.getLayout("points"),o=h.create(1/0,1/0),a=h.create(-1/0,-1/0),s=[],l=0;l<r.length;)s[0]=r[l++],s[1]=r[l++],h.min(o,o,s),h.max(a,a,s);var c=a[0]-o[0],u=a[1]-o[1];c*=1.4,u*=1.4,o[0]-=.2*c,o[1]-=.2*u,n.left=o[0],n.top=o[1],n.bottom=u+o[1],n.right=c+o[0],n.near=0,n.far=100},dispose:function(){var e=this.viewGL.layer.renderer;this._forceLayoutInstance&&this._forceLayoutInstance.dispose(e),this.groupGL.removeAll(),this.stopLayout()},remove:function(){this.groupGL.removeAll(),this._control.dispose()}})},function(e,t,n){var i=n(0),r=n(173),o=n(174),a=n(4);e.exports=function(e,t,n,s,l){for(var c=new r(s),u=0;u<e.length;u++)c.addNode(a.firstNotNull(e[u].id,e[u].name,u),u);for(var d=[],h=[],p=0,u=0;u<t.length;u++){var f=t[u],g=f.source,m=f.target;c.addEdge(g,m,p)&&(h.push(f),d.push(a.firstNotNull(f.id,g+" > "+m)),p++)}var v,_=i.helper.completeDimensions(["value"],e);v=new i.List(_,n),v.initData(e);var y=new i.List(["value"],n);return y.initData(h,d),l&&l(v,y),o({mainData:v,struct:c,structAttr:"graph",datas:{node:v,edge:y},datasAttr:{node:"data",edge:"edgeData"}}),c.update(),c}},function(e,t){e.exports="@export ecgl.forceAtlas2.updateNodeRepulsion\n\n#define NODE_COUNT 0\n\nuniform sampler2D positionTex;\n\nuniform vec2 textureSize;\nuniform float gravity;\nuniform float scaling;\nuniform vec2 gravityCenter;\n\nuniform bool strongGravityMode;\nuniform bool preventOverlap;\n\nvarying vec2 v_Texcoord;\n\nvoid main() {\n\n    vec4 n0 = texture2D(positionTex, v_Texcoord);\n\n    vec2 force = vec2(0.0);\n    for (int i = 0; i < NODE_COUNT; i++) {\n        vec2 uv = vec2(\n            mod(float(i), textureSize.x) / (textureSize.x - 1.0),\n            floor(float(i) / textureSize.x) / (textureSize.y - 1.0)\n        );\n        vec4 n1 = texture2D(positionTex, uv);\n\n        vec2 dir = n0.xy - n1.xy;\n        float d2 = dot(dir, dir);\n\n        if (d2 > 0.0) {\n            float factor = 0.0;\n            if (preventOverlap) {\n                float d = sqrt(d2);\n                d = d - n0.w - n1.w;\n                if (d > 0.0) {\n                    factor = scaling * n0.z * n1.z / (d * d);\n                }\n                else if (d < 0.0) {\n                                        factor = scaling * 100.0 * n0.z * n1.z;\n                }\n            }\n            else {\n                                factor = scaling * n0.z * n1.z / d2;\n            }\n            force += dir * factor;\n        }\n    }\n\n        vec2 dir = gravityCenter - n0.xy;\n    float d = 1.0;\n    if (!strongGravityMode) {\n        d = length(dir);\n    }\n\n    force += dir * n0.z * gravity / (d + 1.0);\n\n    gl_FragColor = vec4(force, 0.0, 1.0);\n}\n@end\n\n@export ecgl.forceAtlas2.updateEdgeAttraction.vertex\n\nattribute vec2 node1;\nattribute vec2 node2;\nattribute float weight;\n\nuniform sampler2D positionTex;\nuniform float edgeWeightInfluence;\nuniform bool preventOverlap;\nuniform bool linLogMode;\n\nuniform vec2 windowSize: WINDOW_SIZE;\n\nvarying vec2 v_Force;\n\nvoid main() {\n\n    vec4 n0 = texture2D(positionTex, node1);\n    vec4 n1 = texture2D(positionTex, node2);\n\n    vec2 dir = n1.xy - n0.xy;\n    float d = length(dir);\n    float w;\n    if (edgeWeightInfluence == 0.0) {\n        w = 1.0;\n    }\n    else if (edgeWeightInfluence == 1.0) {\n        w = weight;\n    }\n    else {\n        w = pow(weight, edgeWeightInfluence);\n    }\n            vec2 offset = vec2(1.0 / windowSize.x, 1.0 / windowSize.y);\n    vec2 scale = vec2((windowSize.x - 1.0) / windowSize.x, (windowSize.y - 1.0) / windowSize.y);\n    vec2 pos = node1 * scale * 2.0 - 1.0;\n    gl_Position = vec4(pos + offset, 0.0, 1.0);\n    gl_PointSize = 1.0;\n\n    float factor;\n    if (preventOverlap) {\n        d = d - n1.w - n0.w;\n    }\n    if (d <= 0.0) {\n        v_Force = vec2(0.0);\n        return;\n    }\n\n    if (linLogMode) {\n                factor = w * log(d) / d;\n    }\n    else {\n        factor = w;\n    }\n    v_Force = dir * factor;\n}\n@end\n\n@export ecgl.forceAtlas2.updateEdgeAttraction.fragment\n\nvarying vec2 v_Force;\n\nvoid main() {\n    gl_FragColor = vec4(v_Force, 0.0, 0.0);\n}\n@end\n\n@export ecgl.forceAtlas2.calcWeightedSum.vertex\n\nattribute vec2 node;\n\nvarying vec2 v_NodeUv;\n\nvoid main() {\n\n    v_NodeUv = node;\n    gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\n    gl_PointSize = 1.0;\n}\n@end\n\n@export ecgl.forceAtlas2.calcWeightedSum.fragment\n\nvarying vec2 v_NodeUv;\n\nuniform sampler2D positionTex;\nuniform sampler2D forceTex;\nuniform sampler2D forcePrevTex;\n\nvoid main() {\n    vec2 force = texture2D(forceTex, v_NodeUv).rg;\n    vec2 forcePrev = texture2D(forcePrevTex, v_NodeUv).rg;\n\n    float mass = texture2D(positionTex, v_NodeUv).z;\n    float swing = length(force - forcePrev) * mass;\n    float traction = length(force + forcePrev) * 0.5 * mass;\n\n    gl_FragColor = vec4(swing, traction, 0.0, 0.0);\n}\n@end\n\n@export ecgl.forceAtlas2.calcGlobalSpeed\n\nuniform sampler2D globalSpeedPrevTex;\nuniform sampler2D weightedSumTex;\nuniform float jitterTolerence;\n\nvoid main() {\n    vec2 weightedSum = texture2D(weightedSumTex, vec2(0.5)).xy;\n    float prevGlobalSpeed = texture2D(globalSpeedPrevTex, vec2(0.5)).x;\n    float globalSpeed = jitterTolerence * jitterTolerence\n                * weightedSum.y / weightedSum.x;\n    if (prevGlobalSpeed > 0.0) {\n        globalSpeed = min(globalSpeed / prevGlobalSpeed, 1.5) * prevGlobalSpeed;\n    }\n    gl_FragColor = vec4(globalSpeed, 0.0, 0.0, 1.0);\n}\n@end\n\n@export ecgl.forceAtlas2.updatePosition\n\nuniform sampler2D forceTex;\nuniform sampler2D forcePrevTex;\nuniform sampler2D positionTex;\nuniform sampler2D globalSpeedTex;\n\nvarying vec2 v_Texcoord;\n\nvoid main() {\n    vec2 force = texture2D(forceTex, v_Texcoord).xy;\n    vec2 forcePrev = texture2D(forcePrevTex, v_Texcoord).xy;\n    vec4 node = texture2D(positionTex, v_Texcoord);\n\n    float globalSpeed = texture2D(globalSpeedTex, vec2(0.5)).r;\n    float swing = length(force - forcePrev);\n    float speed = 0.1 * globalSpeed / (0.1 + globalSpeed * sqrt(swing));\n\n        float df = length(force);\n    if (df > 0.0) {\n        speed = min(df * speed, 10.0) / df;\n\n        gl_FragColor = vec4(node.xy + speed * force, node.zw);\n    }\n    else {\n        gl_FragColor = node;\n    }\n}\n@end\n\n@export ecgl.forceAtlas2.edges.vertex\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\nattribute vec2 node;\nattribute vec4 a_Color : COLOR;\nvarying vec4 v_Color;\n\nuniform sampler2D positionTex;\n\nvoid main()\n{\n    gl_Position = worldViewProjection * vec4(\n        texture2D(positionTex, node).xy, -10.0, 1.0\n    );\n    v_Color = a_Color;\n}\n@end\n\n@export ecgl.forceAtlas2.edges.fragment\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\nvarying vec4 v_Color;\nvoid main() {\n    gl_FragColor = color * v_Color;\n}\n@end"},function(e,t){function r(){function e(){this.subRegions=[],this.nSubRegions=0,this.node=null,this.mass=0,this.centerOfMass=null,this.bbox=new Float32Array(4),this.size=0}function t(){this.position=new Float32Array(2),this.force=i.create(),this.forcePrev=i.create(),this.mass=1,this.inDegree=0,this.outDegree=0}function r(e,t){this.source=e,this.target=t,this.weight=1}function n(){this.autoSettings=!0,this.barnesHutOptimize=!0,this.barnesHutTheta=1.5,this.repulsionByDegree=!0,this.linLogMode=!1,this.strongGravityMode=!1,this.gravity=1,this.scaling=1,this.edgeWeightInfluence=1,this.jitterTolerence=.1,this.preventOverlap=!1,this.dissuadeHubs=!1,this.rootRegion=new e,this.rootRegion.centerOfMass=i.create(),this.nodes=[],this.edges=[],this.bbox=new Float32Array(4),this.gravityCenter=null,this._massArr=null,this._swingingArr=null,this._sizeArr=null,this._globalSpeed=0}var i={create:function(){return new Float32Array(2)},dist:function(e,t){var n=t[0]-e[0],i=t[1]-e[1];return Math.sqrt(n*n+i*i)},len:function(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)},scaleAndAdd:function(e,t,n,i){return e[0]=t[0]+n[0]*i,e[1]=t[1]+n[1]*i,e},scale:function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e},add:function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e},sub:function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e},normalize:function(e,t){var n=t[0],i=t[1],r=n*n+i*i;return r>0&&(r=1/Math.sqrt(r),e[0]=t[0]*r,e[1]=t[1]*r),e},negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e},set:function(e,t,n){return e[0]=t,e[1]=n,e}},o=e.prototype;o.beforeUpdate=function(){for(var e=0;e<this.nSubRegions;e++)this.subRegions[e].beforeUpdate();this.mass=0,this.centerOfMass&&(this.centerOfMass[0]=0,this.centerOfMass[1]=0),this.nSubRegions=0,this.node=null},o.afterUpdate=function(){this.subRegions.length=this.nSubRegions;for(var e=0;e<this.nSubRegions;e++)this.subRegions[e].afterUpdate()},o.addNode=function(e){if(0===this.nSubRegions){if(null==this.node)return void(this.node=e);this._addNodeToSubRegion(this.node),this.node=null}this._addNodeToSubRegion(e),this._updateCenterOfMass(e)},o.findSubRegion=function(e,t){for(var n=0;n<this.nSubRegions;n++){var i=this.subRegions[n];if(i.contain(e,t))return i}},o.contain=function(e,t){return this.bbox[0]<=e&&this.bbox[2]>=e&&this.bbox[1]<=t&&this.bbox[3]>=t},o.setBBox=function(e,t,n,i){this.bbox[0]=e,this.bbox[1]=t,this.bbox[2]=n,this.bbox[3]=i,this.size=(n-e+i-t)/2},o._newSubRegion=function(){var t=this.subRegions[this.nSubRegions];return t||(t=new e,this.subRegions[this.nSubRegions]=t),this.nSubRegions++,t},o._addNodeToSubRegion=function(e){var t=this.findSubRegion(e.position[0],e.position[1]),n=this.bbox;if(!t){var i=(n[0]+n[2])/2,r=(n[1]+n[3])/2,o=(n[2]-n[0])/2,a=(n[3]-n[1])/2,s=e.position[0]>=i?1:0,l=e.position[1]>=r?1:0,t=this._newSubRegion();t.setBBox(s*o+n[0],l*a+n[1],(s+1)*o+n[0],(l+1)*a+n[1])}t.addNode(e)},o._updateCenterOfMass=function(e){null==this.centerOfMass&&(this.centerOfMass=new Float32Array(2));var t=this.centerOfMass[0]*this.mass,n=this.centerOfMass[1]*this.mass;t+=e.position[0]*e.mass,n+=e.position[1]*e.mass,this.mass+=e.mass,this.centerOfMass[0]=t/this.mass,this.centerOfMass[1]=n/this.mass};var a=n.prototype;a.initNodes=function(e,n,i){var r=n.length;this.nodes.length=0;for(var o=void 0!==i,a=0;a<r;a++){var s=new t;s.position[0]=e[2*a],s.position[1]=e[2*a+1],s.mass=n[a],o&&(s.size=i[a]),this.nodes.push(s)}this._massArr=n,this._swingingArr=new Float32Array(r),o&&(this._sizeArr=i)},a.initEdges=function(e,t){var n=e.length/2;this.edges.length=0;for(var i=0;i<n;i++){var o=e[2*i],a=e[2*i+1],s=this.nodes[o],l=this.nodes[a];if(!s||!l)return;s.outDegree++,l.inDegree++;var c=new r(s,l);t&&(c.weight=t[i]),this.edges.push(c)}},a.updateSettings=function(){if(this.repulsionByDegree)for(var e=0;e<this.nodes.length;e++){var t=this.nodes[e];t.mass=t.inDegree+t.outDegree+1}else for(var e=0;e<this.nodes.length;e++){var t=this.nodes[e];t.mass=this._massArr[e]}},a.update=function(){var e=this.nodes.length;if(this.updateSettings(),this.updateBBox(),this.barnesHutOptimize){this.rootRegion.setBBox(this.bbox[0],this.bbox[1],this.bbox[2],this.bbox[3]),this.rootRegion.beforeUpdate();for(var t=0;t<e;t++)this.rootRegion.addNode(this.nodes[t]);this.rootRegion.afterUpdate()}for(var t=0;t<e;t++){var n=this.nodes[t];i.copy(n.forcePrev,n.force),i.set(n.force,0,0)}for(var t=0;t<e;t++){var r=this.nodes[t];if(this.barnesHutOptimize)this.applyRegionToNodeRepulsion(this.rootRegion,r);else for(var o=t+1;o<e;o++){var a=this.nodes[o];this.applyNodeToNodeRepulsion(r,a,!1)}this.gravity>0&&(this.strongGravityMode?this.applyNodeStrongGravity(r):this.applyNodeGravity(r))}for(var t=0;t<this.edges.length;t++)this.applyEdgeAttraction(this.edges[t]);for(var s=0,l=0,c=i.create(),t=0;t<e;t++){var n=this.nodes[t],u=i.dist(n.force,n.forcePrev);s+=u*n.mass,i.add(c,n.force,n.forcePrev),l+=.5*i.len(c)*n.mass,this._swingingArr[t]=u}var d=this.jitterTolerence*this.jitterTolerence*l/s;this._globalSpeed>0&&(d=Math.min(d/this._globalSpeed,1.5)*this._globalSpeed),this._globalSpeed=d;for(var t=0;t<e;t++){var n=this.nodes[t],u=this._swingingArr[t],h=.1*d/(1+d*Math.sqrt(u)),p=i.len(n.force);p>0&&(h=Math.min(p*h,10)/p,i.scaleAndAdd(n.position,n.position,n.force,h))}},a.applyRegionToNodeRepulsion=function(){var e=i.create();return function(t,n){if(t.node)this.applyNodeToNodeRepulsion(t.node,n,!0);else{i.sub(e,n.position,t.centerOfMass);var r=e[0]*e[0]+e[1]*e[1];if(r>this.barnesHutTheta*t.size*t.size){var o=this.scaling*n.mass*t.mass/r;i.scaleAndAdd(n.force,n.force,e,o)}else for(var a=0;a<t.nSubRegions;a++)this.applyRegionToNodeRepulsion(t.subRegions[a],n)}}}(),a.applyNodeToNodeRepulsion=function(){var e=i.create();return function(t,n,r){if(t!=n){i.sub(e,t.position,n.position);var o=e[0]*e[0]+e[1]*e[1];if(0!==o){var a;if(this.preventOverlap){var s=Math.sqrt(o);if((s=s-t.size-n.size)>0)a=this.scaling*t.mass*n.mass/(s*s);else{if(!(s<0))return;a=100*this.scaling*t.mass*n.mass}}else a=this.scaling*t.mass*n.mass/o;i.scaleAndAdd(t.force,t.force,e,a),i.scaleAndAdd(n.force,n.force,e,-a)}}}}(),a.applyEdgeAttraction=function(){var e=i.create();return function(t){var n=t.source,r=t.target;i.sub(e,n.position,r.position);var o,a=i.len(e);o=0===this.edgeWeightInfluence?1:1===this.edgeWeightInfluence?t.weight:Math.pow(t.weight,this.edgeWeightInfluence);var s;this.preventOverlap&&(a=a-n.size-r.size)<=0||(s=this.linLogMode?-o*Math.log(a+1)/(a+1):-o,i.scaleAndAdd(n.force,n.force,e,s),i.scaleAndAdd(r.force,r.force,e,-s))}}(),a.applyNodeGravity=function(){var e=i.create();return function(t){i.sub(e,this.gravityCenter,t.position);var n=i.len(e);i.scaleAndAdd(t.force,t.force,e,this.gravity*t.mass/(n+1))}}(),a.applyNodeStrongGravity=function(){var e=i.create();return function(t){i.sub(e,this.gravityCenter,t.position),i.scaleAndAdd(t.force,t.force,e,this.gravity*t.mass)}}(),a.updateBBox=function(){for(var e=1/0,t=1/0,n=-1/0,i=-1/0,r=0;r<this.nodes.length;r++){var o=this.nodes[r].position;e=Math.min(e,o[0]),t=Math.min(t,o[1]),n=Math.max(n,o[0]),i=Math.max(i,o[1])}this.bbox[0]=e,this.bbox[1]=t,this.bbox[2]=n,this.bbox[3]=i},a.getGlobalSpeed=function(){return this._globalSpeed};var s=null;self.onmessage=function(e){switch(e.data.cmd){case"init":s=new n,s.initNodes(e.data.nodesPosition,e.data.nodesMass,e.data.nodesSize),s.initEdges(e.data.edges,e.data.edgesWeight);break;case"updateConfig":if(s)for(var t in e.data.config)s[t]=e.data.config[t];break;case"update":var i=e.data.steps;if(s){for(var r=0;r<i;r++)s.update();for(var o=s.nodes.length,a=new Float32Array(2*o),r=0;r<o;r++){var l=s.nodes[r];a[2*r]=l.position[0],a[2*r+1]=l.position[1]}self.postMessage({buffer:a.buffer,globalSpeed:s.getGlobalSpeed()},[a.buffer])}else{var c=new Float32Array;self.postMessage({buffer:c.buffer,globalSpeed:s.getGlobalSpeed()},[c.buffer])}}}}e.exports=r},function(e,t,n){var i=n(0),r=n(25),o=i.extendSeriesModel({type:"series.line3D",dependencies:["grid3D"],visualColorAccessPath:"lineStyle.color",getInitialData:function(e,t){var n=i.helper.completeDimensions(["x","y","z"],e.data),r=new i.List(n,this);return r.initData(e.data),r},formatTooltip:function(e){return r(this,e)},defaultOption:{coordinateSystem:"cartesian3D",zlevel:-10,grid3DIndex:0,lineStyle:{width:2}}});e.exports=o},function(e,t,n){var i=n(0),r=n(2),o=n(4),a=n(22),s=n(10),l=n(3),c=n(1).vec3,u=n(221),d=n(33);r.Shader.import(n(39)),e.exports=i.extendChartView({type:"line3D",__ecgl__:!0,init:function(e,t){this.groupGL=new r.Node;var n=new r.Mesh({geometry:new a({useNativeLine:!1,sortTriangles:!0}),material:new r.Material({shader:r.createShader("ecgl.meshLines3D")}),renderOrder:10});this._line3DMesh=n,this._line3DMesh.geometry.pick=this._pick.bind(this),this._api=t,this._tooltip=new d(t)},render:function(e,t,n){this.groupGL.add(this._line3DMesh);var i=e.coordinateSystem;i&&i.viewGL&&i.viewGL.add(this.groupGL),this._doRender(e,n),this._data=e.getData(),this._camera=i.viewGL.camera,this.updateCamera()},updateCamera:function(){this._updateNDCPosition()},_doRender:function(e,t){var n=e.getData(),i=this._line3DMesh;i.geometry.resetOffset();var a=n.getLayout("points"),s=[],l=new Float32Array(a.length/3*4),c=0,u=!1;n.each(function(e){var t=n.getItemVisual(e,"color"),i=n.getItemVisual(e,"opacity");null==i&&(i=1),r.parseColor(t,s),s[3]*=i,l[c++]=s[0],l[c++]=s[1],l[c++]=s[2],l[c++]=s[3],s[3]<.99&&(u=!0)}),i.geometry.setVertexCount(i.geometry.getPolylineVertexCount(a)),i.geometry.setTriangleCount(i.geometry.getPolylineTriangleCount(a)),i.geometry.addPolyline(a,l,o.firstNotNull(e.get("lineStyle.width"),1),!0),i.geometry.dirty(),i.geometry.updateBoundingBox();var d=i.material;d.transparent=u,d.depthMask=!u;var h=e.getModel("debug.wireframe");h.get("show")?(i.geometry.createAttribute("barycentric","float",3),i.geometry.generateBarycentric(),i.material.shader.define("both","WIREFRAME_TRIANGLE"),i.material.set("wireframeLineColor",r.parseColor(h.get("lineStyle.color"))),i.material.set("wireframeLineWidth",o.firstNotNull(h.get("lineStyle.width"),1))):i.material.shader.undefine("both","WIREFRAME_TRIANGLE"),this._points=a,this._initHandler(e,t)},_initHandler:function(e,t){var n=e.getData(),i=e.coordinateSystem,r=this._line3DMesh,o=-1;r.off("mousemove"),r.off("mouseout"),r.on("mousemove",function(r){var a=i.pointToData(r.point._array),s=n.indicesOfNearest("x",a[0])[0];s!==o&&(this._downplay(o),this._highlight(s),t.dispatchAction({type:"grid3DShowAxisPointer",value:[n.get("x",s),n.get("y",s),n.get("z",s)]})),this._tooltip.updateTooltip(e,s,r.offsetX,r.offsetY),o=s},this),r.on("mouseout",function(e){this._downplay(o),o=-1,t.dispatchAction({type:"grid3DHideAxisPointer"}),this._tooltip.hideTooltip()},this)},_highlight:function(e){this._data},_downplay:function(e){this._data},_updateNDCPosition:function(){var e=new s,t=this._camera;s.multiply(e,t.projectionMatrix,t.viewMatrix);var n=this._positionNDC,i=this._points,r=i.length/3;n&&n.length/2===r||(n=this._positionNDC=new Float32Array(2*r));for(var o=[],a=0;a<r;a++){var l=3*a,u=2*a;o[0]=i[l],o[1]=i[l+1],o[2]=i[l+2],o[3]=1,c.transformMat4(o,o,e._array),n[u]=o[0]/o[3],n[u+1]=o[1]/o[3]}},_pick:function(e,t,n,i,r,o){var a=this._positionNDC,s=this._data.hostModel,c=s.get("lineStyle.width"),d=-1,h=n.viewport.width,p=n.viewport.height,f=.5*h,g=.5*p;e=(e+1)*f,t=(t+1)*g;for(var m=1;m<a.length/2;m++){var v=(a[2*(m-1)]+1)*f,_=(a[2*(m-1)+1]+1)*g,y=(a[2*m]+1)*f,x=(a[2*m+1]+1)*g;u.containStroke(v,_,y,x,c,e,t)&&(d=(v-e)*(v-e)+(_-t)*(_-t)<(y-e)*(y-e)+(x-t)*(x-t)?m-1:m)}if(d>=0){var b=3*d,w=new l(this._points[b],this._points[b+1],this._points[b+2]);o.push({dataIndex:d,point:w,pointWorld:w.clone(),target:this._line3DMesh,distance:this._camera.getWorldPosition().dist(w)})}},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll()}})},function(e,t,n){var i=n(0);i.extendSeriesModel({type:"series.lines3D",dependencies:["globe"],visualColorAccessPath:"lineStyle.color",getInitialData:function(e,t){var n=new i.List(["value"],this);return n.hasItemOption=!1,n.initData(e.data,[],function(e,t,i,r){if(e instanceof Array)return NaN;n.hasItemOption=!0;var o=e.value;return null!=o?o instanceof Array?o[r]:o:void 0}),n},defaultOption:{coordinateSystem:"globe",globeIndex:0,geo3DIndex:0,zlevel:-10,polyline:!1,effect:{show:!1,period:4,trailWidth:4,trailLength:.2},distanceToGlobe:0,silent:!0,blendMode:"source-over",lineStyle:{width:1,opacity:.5}}})},function(e,t,i){function n(e){return null!=e.radius?e.radius:null!=e.size?Math.max(e.size[0],e.size[1],e.size[2]):100}var r=i(0),o=i(2),a=i(22),s=i(116);o.Shader.import(i(39)),e.exports=r.extendChartView({type:"lines3D",__ecgl__:!0,init:function(e,t){this.groupGL=new o.Node,this._nativeLinesMaterial=new o.Material({shader:o.createShader("ecgl.lines3D"),transparent:!0,depthMask:!1}),this._projectedLinesMaterial=new o.Material({shader:o.createShader("ecgl.meshLines3D"),transparent:!0,depthMask:!1}),this._linesMesh=new o.Mesh({geometry:new a}),this._trailMesh=new s},render:function(e,t,i){this.groupGL.add(this._linesMesh);var r=e.coordinateSystem,a=e.getData();if(r&&r.viewGL){r.viewGL.add(this.groupGL),"cubicBezier"===a.getLayout("lineType")&&this._generateBezierCurves(e,t,i);var s=r.viewGL.isLinearSpace()?"define":"undefine";this._linesMesh.material.shader[s]("fragment","SRGB_DECODE")}var l=this._trailMesh;if(l.stopAnimation(),e.get("effect.show")){var c=e.get("effect.trailLength"),u=c+1;this.groupGL.add(l),l.setScale(n(r)),l.setData(a,i);var d=1e3*e.get("effect.period"),h=l.__percent?-d*l.__percent/u:0;l.__percent=0,this._curveEffectsAnimator=l.animate("",{loop:!0}).when(d*u,{__percent:u}).delay(h).during(function(){l.setAnimationPercent(l.__percent)}).start()}else this.groupGL.remove(l),this._curveEffectsAnimator=null;this._linesMesh.material.blend=this._trailMesh.material.blend="lighter"===e.get("blendMode")?o.additiveBlend:null},puaseEffect:function(){this._curveEffectsAnimator&&this._curveEffectsAnimator.pause()},resumeEffect:function(){this._curveEffectsAnimator&&this._curveEffectsAnimator.resume()},toggleEffect:function(){var e=this._curveEffectsAnimator;e&&(e.isPaused()?e.resume():e.pause())},_generateBezierCurves:function(e,t,i){var r=e.getData(),a=e.coordinateSystem,s=this._linesMesh.geometry;s.expandLine=!0;var l=n(a);s.segmentScale=l/20;var c="lineStyle.width".split("."),u=i.getDevicePixelRatio(),d=!0,h=0;r.each(function(e){var t=r.getItemModel(e),n=t.get(c);null==n&&(n=1),r.setItemVisual(e,"lineWidth",n),h=Math.max(n,h)});var d=!1;s.useNativeLine=d;var p=0,f=0;r.each(function(e){var t=r.getItemLayout(e);p+=s.getCubicCurveVertexCount(t[0],t[1],t[2],t[3]),f+=s.getCubicCurveTriangleCount(t[0],t[1],t[2],t[3])}),this._linesMesh.material=d?this._nativeLinesMaterial:this._projectedLinesMaterial,this._linesMesh.mode=d?o.Mesh.LINES:o.Mesh.TRIANGLES,s.setVertexCount(p),s.setTriangleCount(f),s.resetOffset();var g=[];r.each(function(e){var t=r.getItemLayout(e),n=r.getItemVisual(e,"color"),i=r.getItemVisual(e,"opacity"),a=r.getItemVisual(e,"lineWidth")*u;null==i&&(i=1),g=o.parseColor(n,g),g[3]*=i,s.addCubicCurve(t[0],t[1],t[2],t[3],g,a)}),s.dirty()},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll()}})},function(e,t,n){var i=n(12),r=n(1).vec3,o=i.derive(function(){return{attributes:{uv:new i.Attribute("offset","float",2),currT:new i.Attribute("offset","float",1),start:new i.Attribute("offset","float",1),prevT:new i.Attribute("offset","float",1),nextT:new i.Attribute("offset","float",1),offset:new i.Attribute("offset","float",1),color:new i.Attribute("color","float",4,"COLOR")},mainAttribute:"uv",scale:1,trailLength:.3,_vertexOffset:0,_triangleOffset:0}},{reset:function(){this._vertexOffset=0,this._triangleOffset=0},setVertexCount:function(e){if(this.vertexCount!==e){for(var t in this.attributes)this.attributes[t].init(e);e>65535?this.indices instanceof Uint16Array&&(this.indices=new Uint32Array(this.indices)):this.indices instanceof Uint32Array&&(this.indices=new Uint16Array(this.indices))}},setTriangleCount:function(e){this.triangleCount!==e&&(this.indices=0===e?null:this.vertexCount>65535?new Uint32Array(3*e):new Uint16Array(3*e))},getCurveVertexCount:function(e,t,n,i){var o=(r.dist(e,t)+r.dist(n,t)+r.dist(i,n))*this.trailLength;return 2*Math.max(Math.min(Math.round((o+1)/this.scale*500),50),5)},getCurveTriangleCount:function(e,t,n,i){return 2*(this.getCurveVertexCount(e,t,n,i)/2-1)},addCurveTrail:function(e,t,n,i,r,o,a){for(var s,l=this.attributes,c=Math.random(),u=0,d=0,h=this.getCurveVertexCount(e,t,n,i)/2,p=this._vertexOffset,f=a[3],g=0;g<h;g++){s=u-1/h*this.trailLength;var m=1-Math.pow(g/h,2);a[3]=Math.max(f*m,0);for(var v=0;v<2;v++)l.currT.set(p,u),l.prevT.set(p,d),l.offset.set(p,(2*v-1)*o/2*m),l.color.set(p,a),l.uv.set(p,r),l.start.set(p,c),g<h-1?l.nextT.set(p,s):l.nextT.set(p,u),p++;if(d=u,u=s,g>0){var _=3*this._triangleOffset,y=this.indices;y[_]=p-4,y[_+1]=p-3,y[_+2]=p-2,y[_+3]=p-3,y[_+4]=p-1,y[_+5]=p-2,this._triangleOffset+=2}}this._vertexOffset=p}});e.exports=o},function(e,t,n){var i=(n(0),n(2)),r=(n(67),n(115));i.Shader.import(n(118)),e.exports=i.Mesh.extend(function(){var e=new i.Material({shader:new i.Shader({vertex:i.Shader.source("ecgl.trail.vertex"),fragment:i.Shader.source("ecgl.trail.fragment")}),transparent:!0,depthMask:!1}),t=new i.Texture2D({type:i.Texture.FLOAT,minFilter:i.Texture.NEAREST,magFilter:i.Texture.NEAREST,width:1024});return{geometry:new r({dynamic:!0}),material:e,culling:!1,$ignorePicking:!0,_pointsTexture:t}},{setData:function(e,t){var n=e.hostModel,r=this.geometry,o=n.getModel("effect"),a=o.get("trailWidth")*t.getDevicePixelRatio(),s=o.get("trailLength");r.trailLength=s,this.material.set("trailLength",s),r.reset();var l=0,c=0;e.each(function(t){var n=e.getItemLayout(t);l+=r.getCurveVertexCount(n[0],n[1],n[2],n[3]),c+=r.getCurveTriangleCount(n[0],n[1],n[2],n[3])}),r.setVertexCount(l),r.setTriangleCount(c);var u=[],d=this._pointsTexture.width,h=Math.ceil(e.count()/(d/4)),p=this._pointsTexture;p.height=h,p.pixels&&p.pixels.length===d*h*4||(p.pixels=new Float32Array(d*h*4));var f=p.pixels,g=o.get("trailColor"),m=o.get("trailOpacity"),v=null!=g,_=null!=m;e.each(function(t){var n=e.getItemLayout(t),o=_?m:e.getItemVisual(t,"opacity"),s=e.getItemVisual(t,"color");null==o&&(o=1),u=i.parseColor(v?g:s,u),u[3]*=o;for(var l=4*t%d/(d-1),c=Math.floor(4*t/d)/(h-1)||0,p=0;p<4;p++)f[4*(4*t+p)]=n[p][0],f[4*(4*t+p)+1]=n[p][1],f[4*(4*t+p)+2]=n[p][2];r.addCurveTrail(n[0],n[1],n[2],n[3],[l,c],a,u)}),this.material.set("pointsTexture",p),p.dirty(),r.dirty()},setScale:function(e){this.geometry.scale=e},setAnimationPercent:function(e){this.material.set("percent",e)}})},function(e,t,r){function n(e,t){var n=e.getData(),i=e.get("polyline"),r=s.create(),o=s.create(),a=s.create(),c=s.create(),u=e.get("distanceToGlobe")||0,d=t.radius+u;n.setLayout("lineType",i?"polyline":"cubicBezier");var h=[],p=[];n.each(function(e){var i=n.getItemModel(e),f=i.option instanceof Array?i.option:i.getShallow("coords",!0);if(l.copy(h,f[0]),l.copy(p,f[1]),h[2]=p[2]=u,!(f instanceof Array&&f.length>0&&f[0]instanceof Array))throw new Error("Invalid coords "+JSON.stringify(f)+". Lines must have 2d coords array in data item.");var g=[],m=g[0]=s.create(),v=g[1]=s.create(),_=g[2]=s.create(),y=g[3]=s.create();t.dataToPoint(h,m),t.dataToPoint(p,y),s.normalize(r,m),s.sub(o,y,m),s.normalize(o,o),s.cross(a,o,r),s.normalize(a,a),s.cross(o,r,a),s.add(v,r,o),s.normalize(v,v),s.normalize(r,y),s.sub(o,m,y),s.normalize(o,o),s.cross(a,o,r),s.normalize(a,a),s.cross(o,r,a),s.add(_,r,o),s.normalize(_,_),s.add(c,m,y),s.normalize(c,c);var x=s.dot(m,c),b=s.dot(c,v),w=(d-x)/b*2;s.scaleAndAdd(v,m,v,w),s.scaleAndAdd(_,y,_,w),n.setItemLayout(e,g)})}function i(e,t){var n=e.getData(),i=e.get("polyline");n.setLayout("lineType",i?"polyline":"cubicBezier");var r=[];n.each(function(e){var i=n.getItemModel(e),o=i.option instanceof Array?i.option:i.getShallow("coords",!0);if(!(o instanceof Array&&o.length>0&&o[0]instanceof Array))throw new Error("Invalid coords "+JSON.stringify(o)+". Lines must have 2d coords array in data item.");var a=[],l=a[0]=s.create(),c=a[1]=s.create(),u=a[2]=s.create(),d=a[3]=s.create();t.dataToPoint(o[0],l),t.dataToPoint(o[1],d);var h=s.dist(l,d);s.lerp(c,l,d,.3),s.lerp(u,l,d,.3),s.set(r,0,1,0),s.scaleAndAdd(c,c,r,Math.min(.1*h,10)),s.scaleAndAdd(u,u,r,Math.min(.1*h,10)),n.setItemLayout(e,a)})}var o=r(0),a=r(1),s=a.vec3,l=a.vec2;o.registerLayout(function(e,t){e.eachSeriesByType("lines3D",function(e){var t=e.coordinateSystem;"globe"===t.type?n(e,t):"geo3D"===t.type&&i(e,t)})})},function(e,t){e.exports="@export ecgl.trail.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform float percent : 0.0;\nuniform float trailLength: 0.3;\n\nuniform sampler2D pointsTexture;\nuniform float textureWidth : 1024;\n\nuniform vec4 viewport : VIEWPORT;\nuniform float near : NEAR;\n\nattribute vec2 uv;\nattribute vec4 color : COLOR;\n\nattribute float start;\nattribute float prevT;\nattribute float currT;\nattribute float nextT;\nattribute float offset;\n\nvarying vec4 v_Color;\n\n@import ecgl.lines3D.clipNear\n\nvec3 getPointAt(in float off, in vec3 p0, in vec3 p1, in vec3 p2, in vec3 p3) {\n    float t = max(min(mod(start + percent, (1.0 + trailLength)) + off, 1.0), 0.0);\n    float onet = 1.0 - t;\n    return onet * onet * (onet * p0 + 3.0 * t * p1)\n        + t * t * (t * p3 + 3.0 * onet * p2);\n}\n\nvoid main()\n{\n    vec2 unit = vec2(1.0 / textureWidth, 0.0);\n    vec3 p0 = texture2D(pointsTexture, uv).rgb;\n    vec3 p1 = texture2D(pointsTexture, uv + unit).rgb;\n    vec3 p2 = texture2D(pointsTexture, uv + unit * 2.0).rgb;\n    vec3 p3 = texture2D(pointsTexture, uv + unit * 3.0).rgb;\n\n    vec3 positionPrev = getPointAt(prevT, p0, p1, p2, p3);\n    vec3 position = getPointAt(currT, p0, p1, p2, p3);\n    vec3 positionNext = getPointAt(nextT, p0, p1, p2, p3);\n\n    @import ecgl.lines3D.expandLine\n\n    gl_Position = currProj;\n\n    v_Color = color;\n}\n\n@end\n\n@export ecgl.trail.fragment\n\nvarying vec4 v_Color;\n\nuniform sampler2D sprite;\n\nvoid main()\n{\n    gl_FragColor = v_Color;\n\n#ifdef SPRITE_ENABLED\n    gl_FragColor *= texture2D(sprite, gl_PointCoord);\n#endif\n\n}\n@end"},function(e,t,n){var i=n(0),r=n(37),o=n(36),a=n(35),s=n(26),l=n(63),c=n(48),u=n(25),d=i.extendSeriesModel({type:"series.map3D",layoutMode:"box",coordinateSystem:null,visualColorAccessPath:"itemStyle.areaColor",getInitialData:function(e){e.data=this.getFilledRegions(e.data,e.map);var t=i.helper.completeDimensions(["value"],e.data),n=new i.List(t,this);n.initData(e.data);var r={};return n.each(function(e){var t=n.getName(e),i=n.getItemModel(e);r[t]=i}),this._regionModelMap=r,n},formatTooltip:function(e){return u(this,e)},getRegionModel:function(e){return this._regionModelMap[e]||new i.Model(null,this)},getFormattedLabel:function(e,t){var n=c.getFormattedLabel(this,e,t);return null==n&&(n=this.getData().getName(e)),n},defaultOption:{data:null}});i.util.merge(d.prototype,l),i.util.merge(d.prototype,r),i.util.merge(d.prototype,o),i.util.merge(d.prototype,a),i.util.merge(d.prototype,s),e.exports=d},function(e,t,n){var i=n(0),r=n(2),o=n(38),a=n(34),s=n(61);e.exports=i.extendChartView({type:"map3D",__ecgl__:!0,init:function(e,t){this._geo3DBuilder=new s(t),this.groupGL=new r.Node,this._sceneHelper=new a,this._sceneHelper.initLight(this.groupGL),this._control=new o({zr:t.getZr()}),this._control.init()},render:function(e,t,n){this.groupGL.add(this._geo3DBuilder.rootNode);var i=e.coordinateSystem;if(i&&i.viewGL){i.viewGL.add(this.groupGL);var r=this._control;r.setCamera(i.viewGL.camera);var o=e.getModel("viewControl");r.setFromViewControlModel(o,0),this._sceneHelper.setScene(i.viewGL.scene),this._sceneHelper.updateLight(e),i.viewGL.setPostEffect(e.getModel("postEffect"),n),i.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._geo3DBuilder.update(e,t,n),r.off("update"),r.on("update",function(){n.dispatchAction({type:"map3DChangeCamera",alpha:r.getAlpha(),beta:r.getBeta(),distance:r.getDistance(),from:this.uid,map3DId:e.id})})}},afterRender:function(e,t,n,i){var r=i.renderer;this._sceneHelper.updateAmbientCubemap(r,e,n),this._sceneHelper.updateSkybox(r,e,n)},dispose:function(){this.groupGL.removeAll(),this._control.dispose()}})},function(e,t,n){var i=n(0),r=n(48),o=n(25);i.extendSeriesModel({type:"series.scatter3D",dependencies:["globe","grid3D","geo3D"],visualColorAccessPath:"itemStyle.color",getInitialData:function(e,t){var n=i.helper.completeDimensions(["x","y","z"],e.data,{defaultNames:["x","y","z","value"]}),r=new i.List(n,this);return r.initData(e.data),r},getFormattedLabel:function(e,t,n,i){var o=r.getFormattedLabel(this,e,t,n,i);if(null==o){var a=this.getData(),s=a.dimensions[a.dimensions.length-1];o=a.get(s,e)}return o},formatTooltip:function(e){return o(this,e)},defaultOption:{coordinateSystem:"cartesian3D",zlevel:-10,grid3DIndex:0,globeIndex:0,symbol:"circle",symbolSize:10,distanceToGlobe:1.5,distanceToGeo3D:.5,blendMode:"source-over",label:{show:!1,position:"right",distance:5,textStyle:{fontSize:14,color:"#000",borderColor:"#fff",borderWidth:1}},itemStyle:{opacity:.8},emphasis:{label:{show:!0}}}})},function(e,t,n){var i=n(0),r=n(2),o=n(45);i.extendChartView({type:"scatter3D",__ecgl__:!0,init:function(e,t){this.groupGL=new r.Node;var n=new o(!1,t);this._pointsBuilder=n},render:function(e,t,n){this.groupGL.add(this._pointsBuilder.rootNode);var i=e.coordinateSystem;i&&i.viewGL&&(i.viewGL.add(this.groupGL),this._pointsBuilder.update(e,t,n),this._pointsBuilder.updateView(i.viewGL.camera),this._camera=i.viewGL.camera)},updateLayout:function(e,t,n){this._pointsBuilder.updateLayout(e,t,n),this._pointsBuilder.updateView(this._camera)},updateCamera:function(){this._pointsBuilder.updateView(this._camera)},dispose:function(){this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}})},function(e,t,n){var i=n(0);i.extendSeriesModel({type:"series.scatterGL",dependencies:["grid","polar","geo","singleAxis"],visualColorAccessPath:"itemStyle.color",getInitialData:function(){return i.helper.createList(this)},defaultOption:{coordinateSystem:"cartesian2d",zlevel:10,symbol:"circle",symbolSize:10,blendMode:"source-over",itemStyle:{opacity:.8}}})},function(e,t,n){var i=n(0),r=n(2),o=n(27),a=n(45);i.extendChartView({type:"scatterGL",__ecgl__:!0,init:function(e,t){this.groupGL=new r.Node,this.viewGL=new o("orthographic"),this.viewGL.add(this.groupGL),this._pointsBuilder=new a(!0,t)},render:function(e,t,n){this.groupGL.add(this._pointsBuilder.rootNode),this._updateCamera(n.getWidth(),n.getHeight(),n.getDevicePixelRatio()),this._pointsBuilder.update(e,t,n)},updateLayout:function(e,t,n){this._pointsBuilder.updateLayout(e,t,n)},_updateCamera:function(e,t,n){this.viewGL.setViewport(0,0,e,t,n);var i=this.viewGL.camera;i.left=i.top=0,i.bottom=t,i.right=e,i.near=0,i.far=100},dispose:function(){this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}})},function(e,t,n){var o=n(0),a=n(26),s=n(25),l=o.extendSeriesModel({type:"series.surface",dependencies:["globe","grid3D","geo3D"],visualColorAccessPath:"itemStyle.color",formatTooltip:function(e){return s(this,e)},getInitialData:function(e,t){function r(e){return!(isNaN(e.min)||isNaN(e.max)||isNaN(e.step))}function i(e){var t=o.number.getPrecisionSafe;return Math.max(t(e.min),t(e.max),t(e.step))+1}var n=e.data;if(!n)if(n=[],e.parametric){var a=e.parametricEquation||{},s=a.u||{},l=a.v||{};["u","v"].forEach(function(e){r(a[e])}),["x","y","z"].forEach(function(e){a[e]});for(var c=i(s),u=i(l),d=l.min;d<l.max+.999*l.step;d+=l.step)for(var h=s.min;h<s.max+.999*s.step;h+=s.step){var p=o.number.round(Math.min(h,s.max),c),f=o.number.round(Math.min(d,l.max),u),g=a.x(p,f),m=a.y(p,f),v=a.z(p,f);n.push([g,m,v,p,f])}}else{var _=e.equation||{},y=_.x||{},x=_.y||{};if(["x","y"].forEach(function(e){r(_[e])}),"function"!=typeof _.z)return;for(var b=i(y),w=i(x),m=x.min;m<x.max+.999*x.step;m+=x.step)for(var g=y.min;g<y.max+.999*y.step;g+=y.step){var C=o.number.round(Math.min(g,y.max),b),S=o.number.round(Math.min(m,x.max),w),v=_.z(C,S);n.push([C,S,v])}}var T=["x","y","z"];e.parametric&&T.push("u","v"),T=o.helper.completeDimensions(T,e.data,{defaultNames:["x","y","z","value"]});var A=new o.List(T,this);return A.initData(n),A},defaultOption:{coordinateSystem:"cartesian3D",zlevel:-10,grid3DIndex:0,shading:"lambert",parametric:!1,wireframe:{show:!0,lineStyle:{color:"#222",width:1}},equation:{x:{min:-1,max:1,step:.1},y:{min:-1,max:1,step:.1},z:null},parametricEquation:{u:{min:-1,max:1,step:.1},v:{min:-1,max:1,step:.1},x:null,y:null,z:null},itemStyle:{}}});o.util.merge(l.prototype,a),e.exports=l},function(e,t,i){function n(e){return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])}var o=i(0),a=i(2),s=(i(4),i(1).vec3),l=i(49),c=i(33);o.extendChartView({type:"surface",__ecgl__:!0,init:function(e,t){this.groupGL=new a.Node;var n={};a.COMMON_SHADERS.forEach(function(e){n[e]=new a.Material({shader:a.createShader("ecgl."+e)}),n[e].shader.define("both","VERTEX_COLOR"),n[e].shader.define("fragment","DOUBLE_SIDE")}),this._materials=n;var i=new a.Mesh({geometry:new a.Geometry({dynamic:!0,sortTriangles:!0}),material:n.lambert,culling:!1,renderOrder:10});i.geometry.createAttribute("barycentric","float",4,null),o.util.extend(i.geometry,l),this._surfaceMesh=i},render:function(e,t,n){this.groupGL.add(this._surfaceMesh);var i=e.coordinateSystem,r=e.get("shading"),o=e.getData();if(this._materials[r]?this._surfaceMesh.material=this._materials[r]:this._surfaceMesh.material=this._materials.lambert,a.setMaterialFromModel(r,this._surfaceMesh.material,e,n),i&&i.viewGL){i.viewGL.add(this.groupGL);var s=i.viewGL.isLinearSpace()?"define":"undefine";this._surfaceMesh.material.shader[s]("fragment","SRGB_DECODE")}var l=e.get("parametric"),u=this._getDataShape(o,l),d=e.getModel("wireframe"),h=d.get("lineStyle.width"),p=d.get("show")&&h>0;this._updateSurfaceMesh(this._surfaceMesh,e,u,p);var f=this._surfaceMesh.material;p?(f.shader.define("WIREFRAME_QUAD"),f.set("wireframeLineWidth",h),f.set("wireframeLineColor",a.parseColor(d.get("lineStyle.color")).slice(0,3))):f.shader.undefine("WIREFRAME_QUAD"),this._initHandler(e,n),this._tooltip=new c(n)},_initHandler:function(e,t){function r(e,t){for(var n=1/0,r=-1,o=[],a=0;a<e.length;a++){i.geometry.attributes.position.get(e[a],o);var l=s.dist(t._array,o);l<n&&(n=l,r=e[a])}return r}var n=e.getData(),i=this._surfaceMesh,o=e.coordinateSystem,a=-1;i.off("mousemove"),i.off("mouseout"),i.on("mousemove",function(a){var l=r(a.triangle,a.point);if(l>=0){var c=[];i.geometry.attributes.position.get(l,c);var u=o.pointToData(c);t.dispatchAction({type:"grid3DShowAxisPointer",value:u});for(var d=1/0,h=-1,p=[],f=0;f<n.count();f++){p[0]=n.get("x",f),p[1]=n.get("y",f),p[2]=n.get("z",f);var g=s.squaredDistance(p,u);g<d&&(h=f,d=g)}this._tooltip.updateTooltip(e,h,a.offsetX,a.offsetY)}else this._tooltip.hideTooltip()},this),i.on("mouseout",function(e){a=-1,t.dispatchAction({type:"grid3DHideAxisPointer"}),this._tooltip.hideTooltip()},this)},_updateSurfaceMesh:function(e,t,i,r){var o=e.geometry,l=t.getData(),c=l.getLayout("points"),u=0;l.each(function(e){l.hasValue(e)||u++});var d=u||r,h=o.attributes.position,p=o.attributes.normal,f=o.attributes.texcoord0,g=o.attributes.barycentric,m=o.attributes.color,v=i.row,_=i.column,y=t.get("shading"),x="color"!==y;if(d){var b=(v-1)*(_-1)*4;h.init(b),r&&g.init(b)}else h.value=new Float32Array(c);m.init(o.vertexCount),f.init(o.vertexCount);var w=[0,3,1,1,3,2],C=[[1,1,0,0],[0,1,0,1],[1,0,0,1],[1,0,1,0]],S=o.indices=new(o.vertexCount>65535?Uint32Array:Uint16Array)((v-1)*(_-1)*6),T=function(e,t,n){n[1]=e*_+t,n[0]=e*_+t+1,n[3]=(e+1)*_+t+1,n[2]=(e+1)*_+t},A=!1;if(d){var M=[],E=[],I=0;x?p.init(o.vertexCount):p.value=null;for(var D=[[],[],[]],k=[],L=[],N=s.create(),P=function(e,t,n){var i=3*t;return n[0]=e[i],n[1]=e[i+1],n[2]=e[i+2],n},O=new Float32Array(c.length),R=new Float32Array(c.length/3*4),z=0;z<l.count();z++)if(l.hasValue(z)){var F=a.parseColor(l.getItemVisual(z,"color")),B=l.getItemVisual(z,"opacity");F[3]*=B,F[3]<.99&&(A=!0);for(var H=0;H<4;H++)R[4*z+H]=F[H]}for(var V=[1e7,1e7,1e7],z=0;z<v-1;z++)for(var W=0;W<_-1;W++){var U=z*(_-1)+W,$=4*U;T(z,W,M);for(var G=!1,H=0;H<4;H++)P(c,M[H],E),n(E)&&(G=!0);for(var H=0;H<4;H++)G?h.set($+H,V):(P(c,M[H],E),h.set($+H,E)),r&&g.set($+H,C[H]);for(var H=0;H<6;H++)S[I++]=w[H]+$;if(x&&!G)for(var H=0;H<2;H++){for(var q=3*H,j=0;j<3;j++){var Y=M[w[q]+j];P(c,Y,D[j])}s.sub(k,D[0],D[1]),s.sub(L,D[1],D[2]),s.cross(N,k,L);for(var j=0;j<3;j++){var X=3*M[w[q]+j];O[X]=O[X]+N[0],O[X+1]=O[X+1]+N[1],O[X+2]=O[X+2]+N[2]}}}if(x)for(var z=0;z<O.length/3;z++)P(O,z,N),s.normalize(N,N),O[3*z]=N[0],O[3*z+1]=N[1],O[3*z+2]=N[2];for(var F=[],Z=[],z=0;z<v-1;z++)for(var W=0;W<_-1;W++){var U=z*(_-1)+W,$=4*U;T(z,W,M);for(var H=0;H<4;H++){for(var j=0;j<4;j++)F[j]=R[4*M[H]+j];m.set($+H,F),x&&(P(O,M[H],N),p.set($+H,N));var Y=M[H];Z[0]=Y%v/(v-1),Z[1]=Math.floor(Y/_)/(_-1),f.set($+H,Z)}U++}}else{for(var Z=[],z=0;z<l.count();z++){Z[0]=z%v/(v-1),Z[1]=Math.floor(z/_)/(_-1);var F=a.parseColor(l.getItemVisual(z,"color")),B=l.getItemVisual(z,"opacity");F[3]*=B,F[3]<.99&&(A=!0),m.set(z,F),f.set(z,Z)}for(var M=[],K=0,z=0;z<v-1;z++)for(var W=0;W<_-1;W++){T(z,W,M);for(var H=0;H<6;H++)S[K++]=M[w[H]]}x?o.generateVertexNormals():p.value=null}o.updateBoundingBox(),o.dirty(),e.material.transparent=A,e.material.depthMask=!A},_getDataShape:function(e,t){for(var n=-1/0,i=0,r=0,o=t?"u":"x",a=0;a<e.count();a++){var s=e.get(o,a);s<n&&(r=0,i++),n=s,r++}return{row:i+1,column:r}},dispose:function(){this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}})},function(e,t,n){n(0).registerLayout(function(e,t){e.eachSeriesByType("surface",function(e){var t=e.coordinateSystem;!t||t.type;var n=e.getData(),i=new Float32Array(3*n.count()),r=[NaN,NaN,NaN];t&&"cartesian3D"===t.type&&n.each(["x","y","z"],function(e,o,a,s){var l;l=n.hasValue(s)?t.dataToPoint([e,o,a]):r,i[3*s]=l[0],i[3*s+1]=l[1],i[3*s+2]=l[2]}),n.setLayout("points",i)})})},function(e,t,n){var i=n(0),r=n(37),o=n(36),a=n(35),s=n(26),l=n(63),c=i.extendComponentModel({type:"geo3D",layoutMode:"box",coordinateSystem:null,optionUpdated:function(){var e=this.option;e.regions=this.getFilledRegions(e.regions,e.map);var t=i.helper.completeDimensions(["value"],e.data),n=new i.List(t,this);n.initData(e.regions);var r={};n.each(function(e){var t=n.getName(e),i=n.getItemModel(e);r[t]=i}),this._regionModelMap=r,this._data=n},getData:function(){return this._data},getRegionModel:function(e){return this._regionModelMap[e]||new i.Model(null,this)},getFormattedLabel:function(e,t){var n=this._data.getName(e),i=this.getRegionModel(n),r=i.get("normal"===t?["label","formatter"]:["emphasis","label","formatter"]);null==r&&(r=i.get(["label","formatter"]));var o={name:n};if("function"==typeof r)return o.status=t,r(o);if("string"==typeof r){var a=o.seriesName;return r.replace("{a}",null!=a?a:"")}return n},defaultOption:{regions:[]}});i.util.merge(c.prototype,l),i.util.merge(c.prototype,r),i.util.merge(c.prototype,o),i.util.merge(c.prototype,a),i.util.merge(c.prototype,s),e.exports=c},function(e,t,n){var i=n(61),r=n(0),o=n(2),a=n(38),s=n(34);e.exports=r.extendComponentView({type:"geo3D",__ecgl__:!0,init:function(e,t){this._geo3DBuilder=new i(t),this.groupGL=new o.Node,this._lightRoot=new o.Node,this._sceneHelper=new s(this._lightRoot),this._sceneHelper.initLight(this._lightRoot),this._control=new a({zr:t.getZr()}),this._control.init()},render:function(e,t,n){this.groupGL.add(this._geo3DBuilder.rootNode);var i=e.coordinateSystem;if(i&&i.viewGL){i.viewGL.add(this._lightRoot),e.get("show")?i.viewGL.add(this.groupGL):i.viewGL.remove(this.groupGL);var r=this._control;r.setCamera(i.viewGL.camera),r.setViewGL(i.viewGL);var o=e.getModel("viewControl");r.setFromViewControlModel(o,0),this._sceneHelper.setScene(i.viewGL.scene),this._sceneHelper.updateLight(e),i.viewGL.setPostEffect(e.getModel("postEffect"),n),i.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._geo3DBuilder.update(e,t,n);var a=e.get("silent");this.groupGL&&this.groupGL.traverse(function(e){e.isRenderable&&e.isRenderable()&&(e.ignorePicking=null!=e.$ignorePicking?e.$ignorePicking:a)}),r.off("update"),r.on("update",function(){n.dispatchAction({type:"geo3DChangeCamera",alpha:r.getAlpha(),beta:r.getBeta(),distance:r.getDistance(),center:r.getCenter(),from:this.uid,geo3DId:e.id})})}},afterRender:function(e,t,n,i){var r=i.renderer;this._sceneHelper.updateAmbientCubemap(r,e,n),this._sceneHelper.updateSkybox(r,e,n)},dispose:function(){this._control.dispose()}})},function(e,i,r){function n(e,t){e.id=e.id||e.name||t+""}var o=r(0),a=r(37),s=r(36),l=r(35),c=r(26),u=o.extendComponentModel({type:"globe",layoutMode:"box",coordinateSystem:null,init:function(){u.superApply(this,"init",arguments),o.util.each(this.option.layers,function(e,t){o.util.merge(e,this.defaultLayerOption),n(e,t)},this)},mergeOption:function(e){function t(e){return o.util.reduce(e,function(e,t,i){return n(t,i),e[t.id]=t,e},{})}var i=this.option.layers;if(this.option.layers=null,u.superApply(this,"mergeOption",arguments),i&&i.length){var r=t(e.layers),a=t(i);for(var s in r)a[s]?o.util.merge(a[s],r[s],!0):i.push(e.layers[s]);this.option.layers=i}o.util.each(this.option.layers,function(e){o.util.merge(e,this.defaultLayerOption)},this)},defaultLayerOption:{show:!0,type:"overlay"},defaultOption:{show:!0,zlevel:-10,left:0,top:0,width:"100%",height:"100%",environment:"auto",baseColor:"#fff",baseTexture:"",heightTexture:"",displacementTexture:"",displacementScale:0,displacementQuality:"medium",globeRadius:100,shading:"lambert",light:{main:{time:""}},viewControl:{autoRotate:!0},layers:[]}});o.util.merge(u.prototype,a),o.util.merge(u.prototype,s),o.util.merge(u.prototype,l),o.util.merge(u.prototype,c),e.exports=u},function(e,t,n){var i=n(0),r=n(2),o=n(38),a=n(34),s=n(169),l=n(4);e.exports=i.extendComponentView({type:"globe",__ecgl__:!0,_displacementScale:0,init:function(e,t){this.groupGL=new r.Node;var n={};r.COMMON_SHADERS.forEach(function(e){n[e]=new r.Material({shader:r.createShader("ecgl."+e)})}),this._materials=n,this._sphereGeometry=new r.SphereGeometry({widthSegments:200,heightSegments:100,dynamic:!0}),this._overlayGeometry=new r.SphereGeometry({widthSegments:80,heightSegments:40}),this._planeGeometry=new r.PlaneGeometry,this._earthMesh=new r.Mesh({name:"earth"}),this._lightRoot=new r.Node,this._sceneHelper=new a,this._sceneHelper.initLight(this._lightRoot),this.groupGL.add(this._earthMesh),this._control=new o({zr:t.getZr()}),this._control.init(),this._layerMeshes={}},render:function(e,t,n){var i=e.coordinateSystem,o=e.get("shading");i.viewGL.add(this._lightRoot),e.get("show")?i.viewGL.add(this.groupGL):i.viewGL.remove(this.groupGL),this._sceneHelper.setScene(i.viewGL.scene),i.viewGL.setPostEffect(e.getModel("postEffect"),n),i.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling"));var a=this._earthMesh;if(a.geometry=this._sphereGeometry,this._materials[o]?a.material=this._materials[o]:a.material=this._materials.lambert,"realistic"===o){var s=e.getModel("realisticMaterial");a.material.set({roughness:l.firstNotNull(s.get("roughness"),.5),metalness:s.get("metalness")||0})}a.material.set("color",r.parseColor(e.get("baseColor"))),a.scale.set(i.radius,i.radius,i.radius);var c=a.material.setTextureImage("diffuseMap",e.get("baseTexture"),n,{flipY:!1,anisotropic:8});c&&c.surface&&c.surface.attachToMesh(a);var u=a.material.setTextureImage("bumpMap",e.get("heightTexture"),n,{flipY:!1,anisotropic:8});u&&u.surface&&u.surface.attachToMesh(a),a.material.shader[e.get("postEffect.enable")?"define":"undefine"]("fragment","SRGB_DECODE"),this._updateLight(e,n),this._displaceVertices(e,n),this._updateViewControl(e,n),this._updateLayers(e,n)},afterRender:function(e,t,n,i){var r=i.renderer;this._sceneHelper.updateAmbientCubemap(r,e,n),this._sceneHelper.updateSkybox(r,e,n)},_updateLayers:function(e,t){var n=e.coordinateSystem,o=e.get("layers"),a=n.radius,s=[],c=[],u=[],d=[];i.util.each(o,function(e){var o=new i.Model(e),h=o.get("type"),p=r.loadTexture(o.get("texture"),t,{flipY:!1,anisotropic:8});if(p.surface&&p.surface.attachToMesh(this._earthMesh),"blend"===h){var f=o.get("blendTo"),g=l.firstNotNull(o.get("intensity"),1);"emission"===f?(u.push(p),d.push(g)):(s.push(p),c.push(g))}else{var m=o.get("id"),v=this._layerMeshes[m];v||(v=this._layerMeshes[m]=new r.Mesh({geometry:this._overlayGeometry,castShadow:!1,ignorePicking:!0})),"lambert"===o.get("shading")?(v.material=v.__lambertMaterial||new r.Material({shader:r.createShader("ecgl.lambert"),transparent:!0,depthMask:!1}),v.__lambertMaterial=v.material):(v.material=v.__colorMaterial||new r.Material({shader:r.createShader("ecgl.color"),transparent:!0,depthMask:!1}),v.__colorMaterial=v.material),v.material.shader.enableTexture("diffuseMap");var _=o.get("distance"),y=a+(null==_?n.radius/100:_);v.scale.set(y,y,y),a=y;var x=this._blankTexture||(this._blankTexture=r.createBlankTexture("rgba(255, 255, 255, 0)"));v.material.set("diffuseMap",x),r.loadTexture(o.get("texture"),t,{flipY:!1,anisotropic:8},function(e){e.surface&&e.surface.attachToMesh(v),v.material.set("diffuseMap",e),t.getZr().refresh()}),o.get("show")?this.groupGL.add(v):this.groupGL.remove(v)}},this);var h=this._earthMesh.material;h.shader.define("fragment","LAYER_DIFFUSEMAP_COUNT",s.length),h.shader.define("fragment","LAYER_EMISSIVEMAP_COUNT",u.length),h.set("layerDiffuseMap",s),h.set("layerDiffuseIntensity",c),h.set("layerEmissiveMap",u),h.set("layerEmissionIntensity",d);var p=e.getModel("debug.wireframe");if(p.get("show")){h.shader.define("both","WIREFRAME_TRIANGLE");var f=r.parseColor(p.get("lineStyle.color")),g=l.firstNotNull(p.get("lineStyle.width"),1);h.set("wireframeLineWidth",g),h.set("wireframeLineColor",f)}else h.shader.undefine("both","WIREFRAME_TRIANGLE")},_updateViewControl:function(e,t){function r(){return{type:"globeChangeCamera",alpha:a.getAlpha(),beta:a.getBeta(),distance:a.getDistance()-n.radius,center:a.getCenter(),from:this.uid,globeId:e.id}}var n=e.coordinateSystem,i=e.getModel("viewControl"),o=n.viewGL.camera,a=this._control;a.setCamera(o),a.setViewGL(n.viewGL),a.setFromViewControlModel(i,n.radius),a.off("update"),a.on("update",function(){t.dispatchAction(r())})},_displaceVertices:function(e,t){var n=e.get("displacementTexture")||e.get("heightTexture"),i=e.get("displacementScale"),o=e.get("displacementQuality"),a=e.get("debug.wireframe.show");if(n&&"none"!==n||(i=0),i!==this._displacementScale||o!==this._displacementQuality||a!==this._showDebugWireframe){this._displacementScale=i,this._displacementQuality=o,this._showDebugWireframe=a;var s=this._sphereGeometry,l={low:100,medium:200,high:400,ultra:800}[o]||200,c=l/2;(s.widthSegments!==l||a)&&(s.widthSegments=l,s.heightSegments=c,s.build());var u;if(r.isImage(n))u=n,this._doDisplaceVertices(s,u,i),a&&s.generateBarycentric();else{u=new Image;var d=this;u.onload=function(){d._doDisplaceVertices(s,u,i),a&&s.generateBarycentric()},u.src=n}}},_doDisplaceVertices:function(e,t,n){var i=e.attributes.position.value,r=e.attributes.texcoord0.value,o=e.__originalPosition;o&&o.length===i.length||(o=new Float32Array(i.length),o.set(i),e.__originalPosition=o);var a=document.createElement("canvas"),s=a.getContext("2d"),l=t.width,c=t.height;a.width=l,a.height=c,s.drawImage(t,0,0,l,c);for(var u=s.getImageData(0,0,l,c).data,d=0;d<e.vertexCount;d++){var h=3*d,p=2*d,f=o[h+1],g=o[h+2],m=o[h+3],v=r[p++],_=r[p++],y=Math.round(v*(l-1)),x=Math.round(_*(c-1)),b=x*l+y,w=u[4*b]/255*n;i[h+1]=f+f*w,i[h+2]=g+g*w,i[h+3]=m+m*w}e.generateVertexNormals(),e.dirty(),e.updateBoundingBox()},_updateLight:function(e,t){var n=this._earthMesh;this._sceneHelper.updateLight(e);var i=this._sceneHelper.mainLight,r=e.get("light.main.time")||new Date,o=s.getPosition(Date.parse(r),0,0),a=Math.cos(o.altitude);i.position.y=-a*Math.cos(o.azimuth),i.position.x=Math.sin(o.altitude),i.position.z=a*Math.sin(o.azimuth),i.lookAt(n.getWorldPosition())},dispose:function(e,t){this.groupGL.removeAll(),this._control.dispose()}})},function(e,t,i){function n(e,t){return t.type||(t.data?"category":"value")}var r=i(0),o=i(138),a=r.extendComponentModel({type:"cartesian3DAxis",axis:null,getCoordSysModel:function(){return this.ecModel.queryComponents({mainType:"grid3D",index:this.option.gridIndex,id:this.option.gridId})[0]}});r.helper.mixinAxisModelCommonMethods(a),o("x",a,n,{name:"X"}),o("y",a,n,{name:"Y"}),o("z",a,n,{name:"Z"})},function(e,t,i){function n(e,t){var n=new o.Mesh({geometry:new a({useNativeLine:!1}),material:t,castShadow:!1,ignorePicking:!0,renderOrder:2}),i=new l;i.material.depthMask=!1;var r=new o.Node;r.add(n),r.add(i),this.rootNode=r,this.dim=e,this.linesMesh=n,this.labelsMesh=i,this.axisLineCoords=null,this.labelElements=[]}var r=i(0),o=i(2),a=i(22),s=i(4),l=i(50),c=s.firstNotNull,u=i(62),d={x:0,y:2,z:1},h={x:"y",y:"x",z:"y"};n.prototype.update=function(e,t,n,i){var a=e.coordinateSystem,s=a.getAxis(this.dim),l=t[this.dim],p=this.linesMesh.geometry,f=this.labelsMesh.geometry;p.convertToDynamicArray(!0),f.convertToDynamicArray(!0);var g=s.model,m=s.getExtent(),v=i.getDevicePixelRatio(),_=g.getModel("axisLine",e.getModel("axisLine")),y=g.getModel("axisTick",e.getModel("axisTick")),x=g.getModel("axisLabel",e.getModel("axisLabel")),b=_.get("lineStyle.color");if(_.get("show")){var w=_.getModel("lineStyle"),C=[0,0,0],S=[0,0,0],T=d[s.dim];C[T]=m[0],S[T]=m[1],this.axisLineCoords=[C,S];var A=o.parseColor(b),M=c(w.get("width"),1),E=c(w.get("opacity"),1);A[3]*=E,p.addLine(C,S,A,M*v)}if(y.get("show")){var I=y.getModel("lineStyle"),D=o.parseColor(c(I.get("color"),b)),M=c(I.get("width"),1);D[3]*=c(I.get("opacity"),1);var k=s.getTicksCoords(),L=y.get("interval");null!=L&&"auto"!==L||(L=l);for(var N=y.get("length"),P=0;P<k.length;P++)if(!u(s,P,L)){var O=k[P],C=[0,0,0],S=[0,0,0],T=d[s.dim],R=d[h[s.dim]];C[T]=S[T]=O,S[R]=N,p.addLine(C,S,D,M*v)}}this.labelElements=[];var v=i.getDevicePixelRatio();if(x.get("show"))for(var z=s.getLabelsCoords(),F=g.get("data"),B=x.getModel("textStyle"),L=l,H=x.get("margin"),V=g.getFormattedLabels(),W=s.scale.getTicks(),P=0;P<z.length;P++)if(!u(s,P,L)){var O=z[P],U=[0,0,0],T=d[s.dim],R=d[h[s.dim]];U[T]=U[T]=O,U[R]=H;var $=B;F&&F[W[P]]&&F[W[P]].textStyle&&($=new r.Model(F[W[P]].textStyle,B,g.ecModel));var G=c($.get("color"),b),E=c($.get("opacity"),1),q=$.get("borderColor"),M=$.get("borderWidth"),j=new r.graphic.Text({style:{text:V[P],fill:"function"==typeof G?G("category"===s.type?V[P]:"value"===s.type?W[P]+"":W[P],P):G,stroke:q,lineWidth:M,font:$.getFont(),textVerticalAlign:"top",textAlign:"left"}}),Y=n.add(j),X=j.getBoundingRect();f.addSprite(U,[X.width*v,X.height*v],Y),this.labelElements.push(j)}if(g.get("name")){var Z=g.getModel("nameTextStyle"),U=[0,0,0],T=d[s.dim],R=d[h[s.dim]],K=c(Z.get("color"),b),E=c(Z.get("opacity"),1),q=Z.get("borderColor"),M=Z.get("borderWidth");U[T]=U[T]=(m[0]+m[1])/2,U[R]=g.get("nameGap");var j=new r.graphic.Text({style:{text:g.get("name"),fill:K,stroke:q,lineWidth:M,font:Z.getFont(),textVerticalAlign:"top",textAlign:"left",opacity:E}}),Y=n.add(j),X=j.getBoundingRect();f.addSprite(U,[X.width*v,X.height*v],Y),j.__idx=this.labelElements.length,this.nameLabelElement=j}this.labelsMesh.material.set("textureAtlas",n.getTexture()),this.labelsMesh.material.set("uvScale",n.getCoordsScale()),p.convertToTypedArray(),f.convertToTypedArray()},n.prototype.setSpriteAlign=function(e,t,n){for(var i=n.getDevicePixelRatio(),r=this.labelsMesh.geometry,o=0;o<this.labelElements.length;o++){var a=this.labelElements[o],s=a.getBoundingRect();r.setSpriteAlign(o,[s.width*i,s.height*i],e,t)}var l=this.nameLabelElement;if(l){var s=l.getBoundingRect();r.setSpriteAlign(l.__idx,[s.width*i,s.height*i],e,t),r.dirty()}this.textAlign=e,this.textVerticalAlign=t},e.exports=n},function(e,t,r){function n(e,t,n,i){var r=[0,0,0],o=i<0?n.getExtentMin():n.getExtentMax();r[h[n.dim]]=o,e.position.setArray(r),e.rotation.identity(),t.distance=-Math.abs(o),t.normal.set(0,0,0),"x"===n.dim?(e.rotation.rotateY(i*Math.PI/2),t.normal.x=-i):"z"===n.dim?(e.rotation.rotateX(-i*Math.PI/2),t.normal.y=-i):(i>0&&e.rotation.rotateY(Math.PI),t.normal.z=-i)}function i(e,t,n){this.rootNode=new a.Node;var i=new a.Mesh({geometry:new l({useNativeLine:!1}),material:t,castShadow:!1,ignorePicking:!0,renderOrder:1}),r=new a.Mesh({geometry:new c,material:n,castShadow:!1,culling:!1,ignorePicking:!0,renderOrder:0});this.rootNode.add(r),this.rootNode.add(i),this.faceInfo=e,this.plane=new a.Plane,this.linesMesh=i,this.quadsMesh=r}var o=r(0),a=r(2),s=r(4),l=r(22),c=r(160),u=s.firstNotNull,d=r(62),h={x:0,y:2,z:1};i.prototype.update=function(e,t,i,r){var o=t.coordinateSystem,a=[o.getAxis(this.faceInfo[0]),o.getAxis(this.faceInfo[1])],s=this.linesMesh.geometry,l=this.quadsMesh.geometry;s.convertToDynamicArray(!0),l.convertToDynamicArray(!0),this._updateSplitLines(s,a,t,e,r),this._udpateSplitAreas(l,a,t,e,r),s.convertToTypedArray(),l.convertToTypedArray();var c=o.getAxis(this.faceInfo[2]);n(this.rootNode,this.plane,c,this.faceInfo[3])},i.prototype._updateSplitLines=function(e,t,n,i,r){var s=r.getDevicePixelRatio();t.forEach(function(r,l){var c=r.model,h=t[1-l].getExtent();if(!r.scale.isBlank()){var p=c.getModel("splitLine",n.getModel("splitLine"));if(p.get("show")){var f=p.getModel("lineStyle"),g=f.get("color"),m=u(f.get("opacity"),1),v=u(f.get("width"),1),_=p.get("interval");null!=_&&"auto"!==_||(_=i[r.dim]),g=o.util.isArray(g)?g:[g];for(var y=r.getTicksCoords(),x=0,b=0;b<y.length;b++)if(!d(r,b,_)){var w=y[b],C=a.parseColor(g[x%g.length]);C[3]*=m;var S=[0,0,0],T=[0,0,0];S[l]=T[l]=w,S[1-l]=h[0],T[1-l]=h[1],e.addLine(S,T,C,v*s),x++}}}})},i.prototype._udpateSplitAreas=function(e,t,n,i,r){t.forEach(function(r,s){var l=r.model,c=t[1-s].getExtent();if(!r.scale.isBlank()){var h=l.getModel("splitArea",n.getModel("splitArea"));if(h.get("show")){var p=h.getModel("areaStyle"),f=p.get("color"),g=u(p.get("opacity"),1),m=h.get("interval");null!=m&&"auto"!==m||(m=i[r.dim]),f=o.util.isArray(f)?f:[f];for(var v=r.getTicksCoords(),_=0,y=[0,0,0],x=[0,0,0],b=0;b<v.length;b++){var w=v[b],C=[0,0,0],S=[0,0,0];if(C[s]=S[s]=w,C[1-s]=c[0],S[1-s]=c[1],0!==b){if(!d(r,b,m)){var T=a.parseColor(f[_%f.length]);T[3]*=g,e.addQuad([y,C,S,x],T),y=C,x=S,_++}}else y=C,x=S}}}})},e.exports=i},function(e,t,n){var i=n(0),r=n(37),o=n(36),a=n(35),s=i.extendComponentModel({type:"grid3D",dependencies:["xAxis3D","yAxis3D","zAxis3D"],defaultOption:{show:!0,zlevel:-10,left:0,top:0,width:"100%",height:"100%",environment:"auto",boxWidth:100,boxHeight:100,boxDepth:100,axisPointer:{show:!0,lineStyle:{color:"rgba(0, 0, 0, 0.8)",width:1},label:{show:!0,formatter:null,margin:8,textStyle:{fontSize:16}}},axisLine:{show:!0,lineStyle:{color:"#333",width:2,type:"solid"}},axisTick:{show:!0,inside:!1,length:3,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,margin:8,textStyle:{fontSize:12}},splitLine:{show:!0,lineStyle:{color:["#ccc"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}},light:{main:{alpha:30,beta:40},ambient:{intensity:.4}},viewControl:{alpha:20,beta:40,autoRotate:!1,distance:200,minDistance:40,maxDistance:400}}});i.util.merge(s.prototype,r),i.util.merge(s.prototype,o),i.util.merge(s.prototype,a),e.exports=s},function(e,n,i){var o=i(0),a=i(2),s=i(38),l=i(22),c=i(4),u=c.firstNotNull,d=i(66),h=i(34),p=i(134),f=i(133),g=i(50);a.Shader.import(i(39)),["x","y","z"].forEach(function(e){o.extendComponentView({type:e+"Axis3D"})});var m={x:0,y:2,z:1};e.exports=o.extendComponentView({type:"grid3D",__ecgl__:!0,init:function(e,t){var n=[["y","z","x",-1,"left"],["y","z","x",1,"right"],["x","y","z",-1,"bottom"],["x","y","z",1,"top"],["x","z","y",-1,"far"],["x","z","y",1,"near"]],i=["x","y","z"],r=new a.Material({shader:a.createShader("ecgl.color"),depthMask:!1,transparent:!0}),o=new a.Material({shader:a.createShader("ecgl.meshLines3D"),depthMask:!1,transparent:!0});r.shader.define("fragment","DOUBLE_SIDE"),r.shader.define("both","VERTEX_COLOR"),this.groupGL=new a.Node,this._control=new s({zr:t.getZr()}),this._control.init(),this._faces=n.map(function(e){var t=new p(e,o,r);return this.groupGL.add(t.rootNode),t},this),this._axes=i.map(function(e){var t=new f(e,o);return this.groupGL.add(t.rootNode),t},this);var c=t.getDevicePixelRatio();this._axisLabelSurface=new d({width:256,height:256,devicePixelRatio:c}),this._axisLabelSurface.onupdate=function(){t.getZr().refresh()},this._axisPointerLineMesh=new a.Mesh({geometry:new l({useNativeLine:!1}),material:o,castShadow:!1,ignorePicking:!0,renderOrder:3}),this.groupGL.add(this._axisPointerLineMesh),this._axisPointerLabelsSurface=new d({width:128,height:128,devicePixelRatio:c}),this._axisPointerLabelsMesh=new g({ignorePicking:!0,renderOrder:4,castShadow:!1}),this._axisPointerLabelsMesh.material.set("textureAtlas",this._axisPointerLabelsSurface.getTexture()),this.groupGL.add(this._axisPointerLabelsMesh),this._lightRoot=new a.Node,this._sceneHelper=new h,this._sceneHelper.initLight(this._lightRoot)},render:function(e,t,n){this._model=e,this._api=n;var i=e.coordinateSystem;i.viewGL.add(this._lightRoot),e.get("show")?i.viewGL.add(this.groupGL):i.viewGL.remove(this.groupGL);var r=this._control;r.setCamera(i.viewGL.camera),r.setViewGL(i.viewGL);var o=e.getModel("viewControl");r.setFromViewControlModel(o,0),this._axisLabelSurface.clear();var a=["x","y","z"].reduce(function(t,n){var r=i.getAxis(n),o=r.model;return t[n]=u(o.get("axisLabel.interval"),e.get("axisLabel.interval")),"ordinal"===r.scale.type&&(null!=t[n]&&"auto"!=t[n]||(t[n]=Math.floor(r.scale.getTicks().length/8))),t},{});this._faces.forEach(function(i){i.update(a,e,t,n)},this),this._axes.forEach(function(t){t.update(e,a,this._axisLabelSurface,n)},this),r.off("update"),r.on("update",this._onCameraChange.bind(this,e,n),this),this._sceneHelper.setScene(i.viewGL.scene),this._sceneHelper.updateLight(e),i.viewGL.setPostEffect(e.getModel("postEffect"),n),i.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._initMouseHandler(e)},afterRender:function(e,t,n,i){var r=i.renderer;this._sceneHelper.updateAmbientCubemap(r,e,n),this._sceneHelper.updateSkybox(r,e,n)},showAxisPointer:function(e,t,n,i){this._doShowAxisPointer(),this._updateAxisPointer(i.value)},hideAxisPointer:function(e,t,n,i){this._doHideAxisPointer()},_initMouseHandler:function(e){var t=e.coordinateSystem,n=t.viewGL;e.get("show")&&e.get("axisPointer.show")?n.on("mousemove",this._updateAxisPointerOnMousePosition,this):n.off("mousemove",this._updateAxisPointerOnMousePosition)},_updateAxisPointerOnMousePosition:function(e){if(!e.target){for(var t,n=this._model,i=n.coordinateSystem,r=i.viewGL,o=r.castRay(e.offsetX,e.offsetY,new a.Ray),s=0;s<this._faces.length;s++){var l=this._faces[s];if(!l.rootNode.invisible){l.plane.normal.dot(r.camera.worldTransform.z)<0&&l.plane.normal.negate();var c=o.intersectPlane(l.plane),u=i.getAxis(l.faceInfo[0]),d=i.getAxis(l.faceInfo[1]),h=m[l.faceInfo[0]],p=m[l.faceInfo[1]];u.contain(c._array[h])&&d.contain(c._array[p])&&(t=c)}}if(t){var f=i.pointToData(t._array,[],!0);this._updateAxisPointer(f),this._doShowAxisPointer()}else this._doHideAxisPointer()}},_onCameraChange:function(e,t){this._updateFaceVisibility(),this._updateAxisLinePosition();var n=this._control;t.dispatchAction({type:"grid3DChangeCamera",alpha:n.getAlpha(),beta:n.getBeta(),distance:n.getDistance(),center:n.getCenter(),from:this.uid,grid3DId:e.id})},_updateFaceVisibility:function(){var e=this._control.getCamera(),t=new a.Vector3;e.update();for(var n=0;n<this._faces.length/2;n++){for(var i=[],r=0;r<2;r++)this._faces[2*n+r].rootNode.getWorldPosition(t),t.transformMat4(e.viewMatrix),i[r]=t.z;var o=i[0]>i[1]?0:1,s=this._faces[2*n+o],l=this._faces[2*n+1-o];s.rootNode.invisible=!0,l.rootNode.invisible=!1}},_updateAxisLinePosition:function(){var e=this._model.coordinateSystem,t=e.getAxis("x"),n=e.getAxis("y"),i=e.getAxis("z"),r=i.getExtentMax(),o=i.getExtentMin(),a=t.getExtentMin(),s=t.getExtentMax(),l=n.getExtentMax(),c=n.getExtentMin(),u=this._axes[0].rootNode,d=this._axes[1].rootNode,h=this._axes[2].rootNode,p=this._faces,f=p[4].rootNode.invisible?c:l,g=p[2].rootNode.invisible?r:o,m=p[0].rootNode.invisible?a:s,v=p[2].rootNode.invisible?r:o,_=p[0].rootNode.invisible?s:a,y=p[4].rootNode.invisible?c:l;u.rotation.identity(),d.rotation.identity(),h.rotation.identity(),p[4].rootNode.invisible&&(this._axes[0].flipped=!0,u.rotation.rotateX(Math.PI)),p[0].rootNode.invisible&&(this._axes[1].flipped=!0,d.rotation.rotateZ(Math.PI)),p[4].rootNode.invisible&&(this._axes[2].flipped=!0,h.rotation.rotateY(Math.PI)),u.position.set(0,g,f),d.position.set(m,v,0),h.position.set(_,0,y),u.update(),d.update(),h.update(),this._updateAxisLabelAlign()},_updateAxisLabelAlign:function(){var e=this._control.getCamera(),t=[new a.Vector4,new a.Vector4],n=new a.Vector4;this.groupGL.getWorldPosition(n),n.w=1,n.transformMat4(e.viewMatrix).transformMat4(e.projectionMatrix),n.x/=n.w,n.y/=n.w,this._axes.forEach(function(i){for(var r=i.axisLineCoords,o=(i.labelsMesh.geometry,0);o<t.length;o++)t[o].setArray(r[o]),t[o].w=1,t[o].transformMat4(i.rootNode.worldTransform).transformMat4(e.viewMatrix).transformMat4(e.projectionMatrix),t[o].x/=t[o].w,t[o].y/=t[o].w;var a,s,l=t[1].x-t[0].x,c=t[1].y-t[0].y,u=(t[1].x+t[0].x)/2,d=(t[1].y+t[0].y)/2;Math.abs(c/l)<.5?(a="center",s=d>n.y?"bottom":"top"):(s="middle",a=u>n.x?"left":"right"),i.setSpriteAlign(a,s,this._api)},this)},_doShowAxisPointer:function(){this._axisPointerLineMesh.invisible&&(this._axisPointerLineMesh.invisible=!1,this._api.getZr().refresh())},_doHideAxisPointer:function(){this._axisPointerLineMesh.invisible||(this._axisPointerLineMesh.invisible=!0,this._api.getZr().refresh())},_updateAxisPointer:function(e){function t(e){return c.firstNotNull(e.model.get("axisPointer.show"),l.get("show"))}function r(e){var t=e.model.getModel("axisPointer",l),n=t.getModel("lineStyle"),i=a.parseColor(n.get("color")),r=u(n.get("width"),1),o=u(n.get("opacity"),1);return i[3]*=o,{color:i,lineWidth:r}}var n=this._model.coordinateSystem,i=n.dataToPoint(e),o=this._axisPointerLineMesh,s=o.geometry,l=this._model.getModel("axisPointer"),d=this._api.getDevicePixelRatio();s.convertToDynamicArray(!0);for(var h=0;h<this._faces.length;h++){var p=this._faces[h];if(!p.rootNode.invisible){for(var f=p.faceInfo,g=f[3]<0?n.getAxis(f[2]).getExtentMin():n.getAxis(f[2]).getExtentMax(),v=m[f[2]],_=0;_<2;_++){var y=f[_],x=f[1-_],b=n.getAxis(y),w=n.getAxis(x);if(t(b)){var C=[0,0,0],S=[0,0,0],T=m[y],A=m[x];C[T]=S[T]=i[T],C[v]=S[v]=g,C[A]=w.getExtentMin(),S[A]=w.getExtentMax();var M=r(b);s.addLine(C,S,M.color,M.lineWidth*d)}}if(t(n.getAxis(f[2]))){var C=i.slice(),S=i.slice();S[v]=g;var M=r(n.getAxis(f[2]));s.addLine(C,S,M.color,M.lineWidth*d)}}}s.convertToTypedArray(),this._updateAxisPointerLabelsMesh(e),this._api.getZr().refresh()},_updateAxisPointerLabelsMesh:function(e){var t=this._model,n=this._axisPointerLabelsMesh,i=this._axisPointerLabelsSurface,r=t.coordinateSystem,a=t.getModel("axisPointer");n.geometry.convertToDynamicArray(!0),i.clear();var s={x:"y",y:"x",z:"y"};this._axes.forEach(function(t,l){var c=r.getAxis(t.dim),d=c.model,h=d.getModel("axisPointer",a),p=h.getModel("label"),f=h.get("lineStyle.color");if(p.get("show")&&h.get("show")){var g=e[l],v=p.get("formatter"),_=c.scale.getLabel(g);if(null!=v)_=v(_,e);else if("interval"===c.scale.type||"log"===c.scale.type){var y=o.number.getPrecisionSafe(c.scale.getTicks()[0]);_=g.toFixed(y+2)}var x=p.getModel("textStyle"),b=x.get("color"),w=u(x.get("opacity"),1),C=x.get("borderColor"),S=x.get("borderWidth"),T=new o.graphic.Text({style:{text:_,textFont:x.getFont(),fill:b||f,stroke:C,lineWidth:S,opacity:w,textAlign:"left",textVerticalAlign:"top"}}),A=i.add(T),M=T.getBoundingRect(),E=this._api.getDevicePixelRatio(),I=t.rootNode.position.toArray();I[m[s[t.dim]]]+=(t.flipped?-1:1)*p.get("margin"),I[m[t.dim]]=c.dataToCoord(e[l]),n.geometry.addSprite(I,[M.width*E,M.height*E],A,t.textAlign,t.textVerticalAlign)}},this),i.getZr().refreshImmediately(),n.material.set("uvScale",i.getCoordsScale()),n.geometry.convertToTypedArray()},dispose:function(){this.groupGL.removeAll(),this._control.dispose()}})},function(e,t,n){var i=n(0),r={show:!0,grid3DIndex:0,inverse:!1,name:"",nameLocation:"middle",nameTextStyle:{fontSize:16},nameGap:20,axisPointer:{},axisLine:{},axisTick:{},axisLabel:{},splitArea:{}},o=i.util.merge({boundaryGap:!0,axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"},axisPointer:{label:{show:!1}}},r),a=i.util.merge({boundaryGap:[0,0],splitNumber:5,axisPointer:{label:{}}},r),s=i.util.defaults({scale:!0,min:"dataMin",max:"dataMax"},a),l=i.util.defaults({logBase:10},a);l.scale=!0,e.exports={categoryAxis:o,valueAxis:a,timeAxis:s,logAxis:l}},function(e,t,n){var i=n(0),r=n(137),o=["value","category","time","log"];e.exports=function(e,t,n,a){i.util.each(o,function(o){t.extend({type:e+"Axis3D."+o,mergeDefaultAndTheme:function(t,r){var a=r.getTheme();i.util.merge(t,a.get(o+"Axis")),i.util.merge(t,this.getDefaultOption()),t.type=n(e,t)},defaultOption:i.util.merge(i.util.clone(r[o+"Axis"]),a||{},!0)})}),t.superClass.registerSubTypeDefaulter(e+"Axis3D",i.util.curry(n,e))}},function(e,t,i){function n(e,t,n,i,r){this.name=e,this.map=t,this.regions=[],this._nameCoordMap={},this.loadGeoJson(n,i,r),this.transform=s.create(),this.invTransform=s.create()}var r=i(0),o=i(1),a=o.vec3,s=o.mat4,l=[i(172),i(171)];n.prototype={constructor:n,type:"geo3D",dimensions:["lng","lat","alt"],containPoint:function(){},loadGeoJson:function(e,t,n){try{this.regions=e?r.parseGeoJSON(e):[]}catch(e){throw"Invalid geoJson format\n"+e}t=t||{},n=n||{};for(var i=this.regions,o={},a=0;a<i.length;a++){var s=i[a].name;s=n[s]||s,i[a].name=s,o[s]=i[a],this.addGeoCoord(s,i[a].center);var c=t[s];c&&i[a].transformTo(c.left,c.top,c.width,c.height)}this._regionsMap=o,this._geoRect=null,l.forEach(function(e){e(this)},this)},getGeoBoundingRect:function(){if(this._geoRect)return this._geoRect;for(var e,t=this.regions,n=0;n<t.length;n++){var i=t[n].getBoundingRect();e=e||i.clone(),e.union(i)}return this._geoRect=e||new r.graphic.BoundingRect(0,0,0,0)},addGeoCoord:function(e,t){this._nameCoordMap[e]=t},getRegion:function(e){return this._regionsMap[e]},getRegionByCoord:function(e){for(var t=this.regions,n=0;n<t.length;n++)if(t[n].contain(e))return t[n]},setSize:function(e,t,n){this.size=[e,t,n];var i=this.getGeoBoundingRect(),r=e/i.width,o=-n/i.height,a=-e/2-i.x*r,l=n/2-i.y*o,c=[a,0,l],u=[r,1,o],d=this.transform;s.identity(d),s.translate(d,d,c),s.scale(d,d,u),s.invert(this.invTransform,d)},dataToPoint:function(e,t){return t=t||[],t[0]=e[0],t[2]=e[1],t[1]=e[2],isNaN(t[1])&&(t[1]=this.size[1]),a.transformMat4(t,t,this.transform),t},pointToData:function(e,t){return t=t||[],t[0]=e[0],t[1]=e[1],t[2]=e[2],a.transformMat4(t,t,this.invTransform),t}},e.exports=n},function(e,t,i){function n(e){this.radius=e||100,this.viewGL=null}var r=i(1),o=r.vec3;n.prototype={constructor:n,dimensions:["lng","lat","alt"],type:"globe",containPoint:function(){},dataToPoint:function(e,t){var n=e[0],i=e[1],r=e[2]||0;n=n*Math.PI/180,i=i*Math.PI/180;var o=r+this.radius,a=Math.cos(i)*o;return t=t||[],t[0]=-a*Math.cos(n+Math.PI),t[1]=Math.sin(i)*o,t[2]=a*Math.sin(n+Math.PI),t},pointToData:function(e,t){var n=e[0],i=e[1],r=e[2],a=o.len(e);n/=a,i/=a,r/=a;var s=Math.asin(i),l=Math.atan2(r,-n);l<0&&(l=2*Math.PI+l);var c=180*s/Math.PI,u=180*l/Math.PI-180;return t=t||[],t[0]=u,t[1]=c,t[2]=a-this.radius,t}},e.exports=n},function(e,t,i){function n(e,t){var n=e.getBoxLayoutParams(),i=a.getLayoutRect(n,{width:t.getWidth(),height:t.getHeight()});i.y=t.getHeight()-i.y-i.height,this.viewGL.setViewport(i.x,i.y,i.width,i.height,t.getDevicePixelRatio()),this.radius=e.get("globeRadius")}var r=i(140),o=i(0),a=i(40),s=i(27),l=i(4),c={dimensions:r.prototype.dimensions,create:function(e,t){var i=[];return e.eachComponent("globe",function(e){e.__viewGL=e.__viewGL||new s;var o=new r;o.viewGL=e.__viewGL,e.coordinateSystem=o,o.model=e,i.push(o),o.resize=n,o.resize(e,t)}),e.eachSeries(function(t){if("globe"===t.get("coordinateSystem")){var n=t.getReferringComponents("globe")[0];if(n||(n=e.getComponent("globe")),!n)throw new Error('globe "'+l.firstNotNull(t.get("globe3DIndex"),t.get("globe3DId"),0)+'" not found');var i=n.coordinateSystem;t.coordinateSystem=i}}),i}};o.registerCoordinateSystem("globe",c),e.exports=c},function(e,t,i){function n(e,t,n){r.Axis.call(this,e,t,n)}var r=i(0);n.prototype={constructor:n,getExtentMin:function(){var e=this._extent;return Math.min(e[0],e[1])},getExtentMax:function(){var e=this._extent;return Math.max(e[0],e[1])}},r.util.inherits(n,r.Axis),e.exports=n},function(e,t,i){function n(e){o.call(this,e),this.size=[0,0,0]}var r=i(0),o=i(170);n.prototype={constructor:n,type:"cartesian3D",dimensions:["x","y","z"],model:null,containPoint:function(e){return this.getAxis("x").contain(e[0])&&this.getAxis("y").contain(e[2])&&this.getAxis("z").contain(e[1])},containData:function(e){return this.getAxis("x").containData(e[0])&&this.getAxis("y").containData(e[1])&&this.getAxis("z").containData(e[2])},dataToPoint:function(e,t,n){return t=t||[],t[0]=this.getAxis("x").dataToCoord(e[0],n),t[2]=this.getAxis("y").dataToCoord(e[1],n),t[1]=this.getAxis("z").dataToCoord(e[2],n),t},pointToData:function(e,t,n){return t=t||[],t[0]=this.getAxis("x").coordToData(e[0],n),t[1]=this.getAxis("y").coordToData(e[2],n),t[2]=this.getAxis("z").coordToData(e[1],n),t}},r.util.inherits(n,o),e.exports=n},function(e,t,i){function n(e,t){var n=e.getBoxLayoutParams(),i=c.getLayoutRect(n,{width:t.getWidth(),height:t.getHeight()});i.y=t.getHeight()-i.y-i.height,this.viewGL.setViewport(i.x,i.y,i.width,i.height,t.getDevicePixelRatio());var r=e.get("boxWidth"),o=e.get("boxHeight"),a=e.get("boxDepth");this.getAxis("x").setExtent(-r/2,r/2),this.getAxis("y").setExtent(a/2,-a/2),this.getAxis("z").setExtent(-o/2,o/2),this.size=[r,o,a]}var o=i(143),a=i(142),l=i(0),c=i(40),u=i(27),d=(i(4),{dimensions:o.prototype.dimensions,create:function(e,t){function r(e,t,n){c[e][t]=c[e][t]||[1/0,-1/0],c[e][t][0]=Math.min(n[0],c[e][t][0]),c[e][t][1]=Math.max(n[1],c[e][t][1])}function s(e,t){return d.map(function(n){var i=e.getReferringComponents(n)[0];return null==i&&(i=t.getComponent(n)),i})}var i=[];e.eachComponent("grid3D",function(e){e.__viewGL=e.__viewGL||new u;var t=new o;t.model=e,t.viewGL=e.__viewGL,e.coordinateSystem=t,i.push(t),t.resize=n});var c={x:[],y:[],z:[]};e.eachSeries(function(e){if("cartesian3D"===e.get("coordinateSystem")){var t=e.getData();o.prototype.dimensions.forEach(function(n){var i=n+"Axis3D",o=e.getReferringComponents(i)[0];o&&r(n,o.componentIndex,t.getDataExtent(e.coordDimToDataDim(n)[0]))})}}),["xAxis3D","yAxis3D","zAxis3D"].forEach(function(t){e.eachComponent(t,function(e){var n=t.charAt(0),i=e.getReferringComponents("grid3D")[0],r=i.coordinateSystem,o=r.getAxis(n);if(!o){var s=l.helper.createScale(c[n][e.componentIndex]||[1/0,-1/0],e);o=new a(n,s),o.type=e.get("type");var u="category"===o.type;o.onBand=u&&e.get("boundaryGap"),o.inverse=e.get("inverse"),e.axis=o,o.model=e,r.addAxis(o)}})});var d=["xAxis3D","yAxis3D","zAxis3D"];return e.eachSeries(function(t){if("cartesian3D"===t.get("coordinateSystem")){var n=t.getReferringComponents("grid3D")[0];if(null==n){var i=s(t,e),n=i[0].getCoordSysModel();i.forEach(function(e){e.getCoordSysModel()})}var r=n.coordinateSystem;t.coordinateSystem=r}}),e.eachComponent("grid3D",function(e){e.coordinateSystem.resize(e,t)}),i}});l.registerCoordinateSystem("grid3D",d),e.exports=d},function(t,r,s){function n(e){var t=e.__zr;e.__zr=null,t&&e.removeAnimatorsFromZr&&e.removeAnimatorsFromZr(t)}function i(e){return e.__GUID__}function a(e,t,n){var i=0,r=[];for(var o in t)t[o].count?i++:r.push(t[o].target);for(var a=0;a<Math.min(i-n,r.length);a++)r[a].dispose(e)}function o(e,t){var n=i(t);e[n]=e[n]||{count:0,target:t},e[n].count++}var l=s(0),c=s(51),u=s(190),d=s(6),h=s(52),p=s(82),f=function(e,t){this.id=e,this.zr=t;try{this.renderer=new c({clearBit:0,devicePixelRatio:t.painter.dpr,preserveDrawingBuffer:!0}),this.renderer.resize(t.painter.getWidth(),t.painter.getHeight())}catch(e){return this.renderer=null,this.dom=document.createElement("div"),this.dom.style.cssText="position:absolute; left: 0; top: 0; right: 0; bottom: 0;",this.dom.className="ecgl-nowebgl",void(this.dom.innerHTML="Sorry, your browser does support WebGL")}this.onglobalout=this.onglobalout.bind(this),t.on("globalout",this.onglobalout),this.dom=this.renderer.canvas;var n=this.dom.style;n.position="absolute",n.left="0",n.top="0",this.views=[],this._picking=new u({renderer:this.renderer}),this._viewsToDispose=[],this._accumulatingId=0};f.prototype.addView=function(e){if(e.layer!==this){var t=this._viewsToDispose.indexOf(e);t>=0&&this._viewsToDispose.splice(t,1),this.views.push(e),e.layer=this;var n=this.zr;e.scene.traverse(function(e){e.__zr=n,e.addAnimatorsToZr&&e.addAnimatorsToZr(n)})}},f.prototype.removeView=function(e){if(e.layer===this){var t=this.views.indexOf(e);t>=0&&(this.views.splice(t,1),e.scene.traverse(n,this),e.layer=null,this._viewsToDispose.push(e))}},f.prototype.removeViewsAll=function(){this.views.forEach(function(e){e.scene.traverse(n,this),e.layer=null,this._viewsToDispose.push(e)},this),this.views.length=0},f.prototype.resize=function(e,t){this.renderer.resize(e,t)},f.prototype.clear=function(){var e=this.renderer.gl;e.clearColor(0,0,0,0),e.depthMask(!0),e.colorMask(!0,!0,!0,!0),e.clear(e.DEPTH_BUFFER_BIT|e.COLOR_BUFFER_BIT)},f.prototype.clearDepth=function(){var e=this.renderer.gl;e.clear(e.DEPTH_BUFFER_BIT)},f.prototype.clearColor=function(){var e=this.renderer.gl;e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)},f.prototype.needsRefresh=function(){this.zr.refresh()},f.prototype.refresh=function(){for(var e=0;e<this.views.length;e++)this.views[e].prepareRender();this._doRender(!1),this._trackAndClean();for(var e=0;e<this._viewsToDispose.length;e++)this._viewsToDispose[e].dispose(this.renderer);this._viewsToDispose.length=0,this._startAccumulating()},f.prototype._doRender=function(e){this.clear(),this.renderer.saveViewport();for(var t=0;t<this.views.length;t++)this.views[t].render(this.renderer,e);this.renderer.restoreViewport()},f.prototype._stopAccumulating=function(){this._accumulatingId=0,clearTimeout(this._accumulatingTimeout)};var g=1;f.prototype._startAccumulating=function(){function e(i){if(t._accumulatingId&&i===t._accumulatingId){for(var r=!0,o=0;o<t.views.length;o++)r=t.views[o].isAccumulateFinished()&&n;r||(t._doRender(!0),p(function(){e(i)}))}}var t=this;this._stopAccumulating();for(var n=!1,i=0;i<this.views.length;i++)n=this.views[i].needsAccumulate()||n;n&&(this._accumulatingId=g++,this._accumulatingTimeout=setTimeout(function(){e(t._accumulatingId)},50))},f.prototype._trackAndClean=function(){function e(e){for(var r=0;r<e.length;r++){var a=e[r],s=a.geometry,l=a.material,c=l.shader;o(i,s),o(t,c);for(var u in l.uniforms){var h=l.uniforms[u].value;if(h instanceof d)o(n,h);else if(h instanceof Array)for(var p=0;p<h.length;p++)h[p]instanceof d&&o(n,h[p])}}}var t=this._shadersMap=this._shadersMap||{},n=this._texturesMap=this._texturesMap||{},i=this._geometriesMap=this._geometriesMap||{};for(var r in t)t[r].count=0;for(var r in n)n[r].count=0;for(var r in i)i[r].count=0;for(var s=0;s<this.views.length;s++){var l=this.views[s],c=l.scene;e(c.opaqueQueue),e(c.transparentQueue);for(var u=0;u<c.lights.length;u++)c.lights[u].cubemap&&o(n,c.lights[u].cubemap)}var h=this.renderer.gl;a(h,t,60),a(h,n,20),a(h,i,20)},f.prototype.dispose=function(){this._stopAccumulating(),this.renderer.disposeScene(this.scene),this.zr.off("globalout",this.onglobalout)},f.prototype.onmousedown=function(e){e=e.event;var t=this.pickObject(e.offsetX,e.offsetY);t&&this._dispatchEvent("mousedown",e,t),this._downX=e.offsetX,this._downY=e.offsetY},f.prototype.onmousemove=function(e){e=e.event;var t=this.pickObject(e.offsetX,e.offsetY),n=t&&t.target,i=this._hovered;this._hovered=t,i&&n!==i.target&&(i.relatedTarget=n,this._dispatchEvent("mouseout",e,i),this.zr.setCursorStyle("default")),this._dispatchEvent("mousemove",e,t),t&&(this.zr.setCursorStyle("pointer"),i&&n===i.target||this._dispatchEvent("mouseover",e,t))},f.prototype.onmouseup=function(e){e=e.event;var t=this.pickObject(e.offsetX,e.offsetY);this._dispatchEvent("mouseup",e,t),this._upX=e.offsetX,this._upY=e.offsetY},f.prototype.onclick=function(e){var t=this._upX-this._downX,n=this._upY-this._downY;if(!(Math.sqrt(t*t+n*n)>20)){e=e.event;var i=this.pickObject(e.offsetX,e.offsetY);this._dispatchEvent("click",e,i);var r=this._clickToSetFocusPoint(e);r&&r.view.setDOFFocusOnPoint(r.distance)&&this.zr.refresh()}},f.prototype._clickToSetFocusPoint=function(e){for(var t=this.renderer,n=t.viewport,i=this.views.length-1;i>=0;i--){var r=this.views[i];if(r.hasDOF()&&r.containPoint(e.offsetX,e.offsetY)){this._picking.scene=r.scene,this._picking.camera=r.camera,t.viewport=r.viewport;var o=this._picking.pick(e.offsetX,e.offsetY,!0);if(o)return o.view=r,o}}t.viewport=n},f.prototype.onglobalout=function(e){var t=this._hovered;t&&this._dispatchEvent("mouseout",e,{target:t.target})},f.prototype.pickObject=function(e,t){for(var n=[],i=this.renderer,r=i.viewport,o=0;o<this.views.length;o++){var a=this.views[o];a.containPoint(e,t)&&(this._picking.scene=a.scene,this._picking.camera=a.camera,i.viewport=a.viewport,this._picking.pickAll(e,t,n))}return i.viewport=r,n.sort(function(e,t){return e.distance-t.distance}),n[0]},f.prototype._dispatchEvent=function(e,t,n){n||(n={});var i=n.target;for(n.cancelBubble=!1,n.event=t,n.type=e,n.offsetX=t.offsetX,n.offsetY=t.offsetY;i&&(i.trigger(e,n),i=i.getParent(),!n.cancelBubble););this._dispatchToView(e,n)},f.prototype._dispatchToView=function(e,t){for(var n=0;n<this.views.length;n++)this.views[n].containPoint(t.offsetX,t.offsetY)&&this.views[n].trigger(e,t)},l.util.extend(f.prototype,h),t.exports=f},function(e,t){e.exports="@export ecgl.dof.diskBlur\n\n#define POISSON_KERNEL_SIZE 16;\n\nuniform sampler2D texture;\nuniform sampler2D coc;\nvarying vec2 v_Texcoord;\n\nuniform float blurSize : 10.0;\nuniform vec2 textureSize : [512.0, 512.0];\n\nuniform vec2 poissonKernel[POISSON_KERNEL_SIZE];\n\nuniform float percent;\n\nfloat nrand(const in vec2 n) {\n    return fract(sin(dot(n.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\n@import qtek.util.rgbm\n@import qtek.util.float\n\n\nvoid main()\n{\n    vec2 offset = blurSize / textureSize;\n\n    float rnd = 6.28318 * nrand(v_Texcoord + 0.07 * percent );\n    float cosa = cos(rnd);\n    float sina = sin(rnd);\n    vec4 basis = vec4(cosa, -sina, sina, cosa);\n\n#if !defined(BLUR_NEARFIELD) && !defined(BLUR_COC)\n    offset *= abs(decodeFloat(texture2D(coc, v_Texcoord)) * 2.0 - 1.0);\n#endif\n\n#ifdef BLUR_COC\n    float cocSum = 0.0;\n#else\n    vec4 color = vec4(0.0);\n#endif\n\n\n    float weightSum = 0.0;\n\n    for (int i = 0; i < POISSON_KERNEL_SIZE; i++) {\n        vec2 ofs = poissonKernel[i];\n\n        ofs = vec2(dot(ofs, basis.xy), dot(ofs, basis.zw));\n\n        vec2 uv = v_Texcoord + ofs * offset;\n        vec4 texel = texture2D(texture, uv);\n\n        float w = 1.0;\n#ifdef BLUR_COC\n        float fCoc = decodeFloat(texel) * 2.0 - 1.0;\n                cocSum += clamp(fCoc, -1.0, 0.0) * w;\n#else\n        texel = decodeHDR(texel);\n    #if !defined(BLUR_NEARFIELD)\n        float fCoc = decodeFloat(texture2D(coc, uv)) * 2.0 - 1.0;\n                        w *= abs(fCoc);\n    #endif\n        color += texel * w;\n#endif\n\n        weightSum += w;\n    }\n\n#ifdef BLUR_COC\n    gl_FragColor = encodeFloat(clamp(cocSum / weightSum, -1.0, 0.0) * 0.5 + 0.5);\n#else\n    color /= weightSum;\n        gl_FragColor = encodeHDR(color);\n#endif\n}\n\n@end"},function(e,t,i){function n(){this._sourceTexture=new o({type:a.HALF_FLOAT}),this._depthTexture=new o({format:a.DEPTH_COMPONENT,type:a.UNSIGNED_INT}),this._framebuffer=new s,this._framebuffer.attach(this._sourceTexture),this._framebuffer.attach(this._depthTexture,s.DEPTH_ATTACHMENT);var e=new l;this._compositor=e.parse(h);var t=this._compositor.getNodeByName("source");t.texture=this._sourceTexture;var n=this._compositor.getNodeByName("coc");n.setParameter("depth",this._depthTexture),this._sourceNode=t,this._cocNode=n,this._compositeNode=this._compositor.getNodeByName("composite"),this._fxaaNode=this._compositor.getNodeByName("FXAA"),this._ssaoPass=new c({depthTexture:this._depthTexture}),this._dofBlurNodes=["dof_far_blur","dof_near_blur","dof_coc_blur"].map(function(e){return this._compositor.getNodeByName(e)},this),this._dofBlurKernel=0,this._dofBlurKernelSize=new Float32Array(0)}var r=(i(71),i(9)),o=i(7),a=i(6),s=i(11),l=i(185),c=i(149),u=i(152),d=i(2),h=i(151);r.import(i(194)),r.import(i(201)),r.import(i(202)),r.import(i(195)),r.import(i(197)),r.import(i(203)),r.import(i(199)),r.import(i(196)),r.import(i(200)),r.import(i(193)),r.import(i(198)),r.import(i(146)),n.prototype.resize=function(e,t,n){n=n||1;var e=e*n,t=t*n,i=this._sourceTexture,r=this._depthTexture;i.width===e&&i.height===t||(i.width=e,i.height=t,i.dirty(),r.width=e,r.height=t,r.dirty())},n.prototype.updateSSAO=function(e,t,n){this._ssaoPass.update(e,t,n)},n.prototype.blendSSAO=function(e,t){this._ssaoPass.blend(e,t)},n.prototype.getSourceFrameBuffer=function(){return this._framebuffer},n.prototype.getSourceTexture=function(){return this._sourceTexture},n.prototype.disableSSAO=function(){this._sourceNode.texture=this._sourceTexture},n.prototype.enableSSAO=function(){this._sourceNode.texture=this._ssaoPass.getTargetTexture()},n.prototype.disableFXAA=function(){this._compositor.removeNode(this._fxaaNode),this._compositeNode.outputs&&(this._compositeNode.__outputs=this._compositeNode.outputs),this._compositeNode.outputs=null},n.prototype.enableFXAA=function(){this._compositor.addNode(this._fxaaNode),this._compositeNode.__outputs&&(this._compositeNode.outputs=this._compositeNode.__outputs)},n.prototype.enableBloom=function(){this._compositeNode.inputs.bloom="bloom_composite"},n.prototype.disableBloom=function(){this._compositeNode.inputs.bloom=null},n.prototype.enableDOF=function(){this._compositeNode.inputs.texture="dof_composite"},n.prototype.disableDOF=function(){this._compositeNode.inputs.texture="source"},n.prototype.enableColorCorrection=function(){this._compositeNode.shaderDefine("COLOR_CORRECTION"),this._enableColorCorrection=!0},n.prototype.disableColorCorrection=function(){this._compositeNode.shaderUndefine("COLOR_CORRECTION"),this._enableColorCorrection=!1},n.prototype.setBloomIntensity=function(e){this._compositeNode.setParameter("bloomIntensity",e)},n.prototype.setSSAORadius=function(e){this._ssaoPass.setParameter("radius",e)},n.prototype.setSSAOIntensity=function(e){this._ssaoPass.setParameter("ssaoIntensity",e)},n.prototype.setSSAOQuality=function(e){var t={low:8,medium:16,high:64,ultra:128}[e]||16;this._ssaoPass.setParameter("kernelSize",t)},n.prototype.setDOFFocalDistance=function(e){this._cocNode.setParameter("focalDist",e)},n.prototype.setDOFFocalRange=function(e){this._cocNode.setParameter("focalRange",e)},n.prototype.setDOFFStop=function(e){this._cocNode.setParameter("fstop",e)},n.prototype.setDOFBlurSize=function(e){for(var t=0;t<this._dofBlurNodes.length;t++)this._dofBlurNodes[t].setParameter("blurSize",e)},n.prototype.setDOFBlurQuality=function(e){var t={low:4,medium:8,high:16,ultra:32}[e]||8;this._dofBlurKernelSize=t;for(var n=0;n<this._dofBlurNodes.length;n++)this._dofBlurNodes[n].shaderDefine("POISSON_KERNEL_SIZE",t);this._dofBlurKernel=new Float32Array(2*t)},n.prototype.setExposure=function(e){this._compositeNode.setParameter("exposure",Math.pow(2,e))},n.prototype.setColorLookupTexture=function(e,t){this._compositeNode.pass.material.setTextureImage("lut",this._enableColorCorrection?e:"none",t,{minFilter:d.Texture.NEAREST,magFilter:d.Texture.NEAREST,flipY:!1})},n.prototype.setColorCorrection=function(e,t){this._compositeNode.setParameter(e,t)},n.prototype.composite=function(e,t,n,i){for(var r=this._dofBlurKernel,o=this._dofBlurKernelSize,a=Math.floor(u.length/2/o),s=i%a,l=0;l<2*o;l++)r[l]=u[l+s*o*2];for(var l=0;l<this._dofBlurNodes.length;l++)this._dofBlurNodes[l].setParameter("percent",i/30),this._dofBlurNodes[l].setParameter("poissonKernel",r);this._cocNode.setParameter("zNear",t.near),this._cocNode.setParameter("zFar",t.far),this._compositor.render(e,n)},n.prototype.dispose=function(e){this._sourceTexture.dispose(e),this._depthTexture.dispose(e),this._framebuffer.dispose(e),this._compositor.dispose(e)},e.exports=n},function(e,t){e.exports="@export ecgl.ssao.estimate\n\nuniform sampler2D depthTex;\n\nuniform sampler2D noiseTex;\n\nuniform vec2 depthTexSize;\n\nuniform vec2 noiseTexSize;\n\nuniform mat4 projection;\n\nuniform mat4 projectionInv;\n\nuniform mat4 viewInverseTranspose;\n\nuniform vec3 kernel[KERNEL_SIZE];\n\nuniform float radius : 1;\n\nuniform float power : 2;\n\nuniform float bias: 1e-2;\n\nvarying vec2 v_Texcoord;\n\n#ifdef DEPTH_ENCODED\n@import qtek.util.decode_float\n#endif\n\nvec3 ssaoEstimator(in vec3 originPos) {\n    float occlusion = 0.0;\n\n    for (int i = 0; i < KERNEL_SIZE; i++) {\n        vec3 samplePos = kernel[i] * radius + originPos;\n\n        vec4 texCoord = projection * vec4(samplePos, 1.0);\n        texCoord.xy /= texCoord.w;\n\n        vec4 depthTexel = texture2D(depthTex, texCoord.xy * 0.5 + 0.5);\n\n        float sampleDepth = depthTexel.r * 2.0 - 1.0;\n\n        sampleDepth = projection[3][2] / (sampleDepth * projection[2][3] - projection[2][2]);\n\n        float rangeCheck = smoothstep(0.0, 1.0, radius / abs(originPos.z - sampleDepth));\n        occlusion += rangeCheck * step(samplePos.z, sampleDepth - bias);\n    }\n    occlusion = 1.0 - clamp((occlusion / float(KERNEL_SIZE) - 0.6) * 2.5, 0.0, 1.0);\n    return vec3(pow(occlusion, power));\n}\n\nvoid main()\n{\n\n    vec4 depthTexel = texture2D(depthTex, v_Texcoord);\n    if (depthTexel.r > 0.99999) {\n                discard;\n    }\n\n#ifdef DEPTH_ENCODED\n    depthTexel.rgb /= depthTexel.a;\n    float z = decodeFloat(depthTexel) * 2.0 - 1.0;\n#else\n    float z = depthTexel.r * 2.0 - 1.0;\n#endif\n\n    vec4 projectedPos = vec4(v_Texcoord * 2.0 - 1.0, z, 1.0);\n    vec4 p4 = projectionInv * projectedPos;\n\n    vec3 position = p4.xyz / p4.w;\n\n    vec2 noiseTexCoord = depthTexSize / vec2(noiseTexSize) * v_Texcoord;\n    vec3 rvec = texture2D(noiseTex, noiseTexCoord).rgb * 2.0 - 1.0;\n\n    gl_FragColor = vec4(vec3(ssaoEstimator(position)), 1.0);\n}\n\n@end\n\n\n@export ecgl.ssao.blur\n\nuniform sampler2D ssaoTexture;\nuniform sampler2D sourceTexture;\n\nuniform float ssaoIntensity: 1.0;\n\nuniform vec2 textureSize;\n\nvarying vec2 v_Texcoord;\n\nvoid main ()\n{\n\n    vec2 texelSize = 1.0 / textureSize;\n\n    float ao = float(0.0);\n    vec2 hlim = vec2(float(-BLUR_SIZE) * 0.5 + 0.5);\n    float centerAo = texture2D(ssaoTexture, v_Texcoord).r;\n    float weightAll = 0.0;\n    float boxWeight = 1.0 / float(BLUR_SIZE) * float(BLUR_SIZE);\n    for (int x = 0; x < BLUR_SIZE; x++) {\n        for (int y = 0; y < BLUR_SIZE; y++) {\n            vec2 coord = (vec2(float(x), float(y)) + hlim) * texelSize + v_Texcoord;\n            float sampleAo = texture2D(ssaoTexture, coord).r;\n                                    float closeness = 1.0 - distance(sampleAo, centerAo) / sqrt(3.0);\n            float weight = boxWeight * closeness;\n            ao += weight * sampleAo;\n            weightAll += weight;\n        }\n    }\n\n    vec4 color = texture2D(sourceTexture, v_Texcoord);\n    color.rgb *= clamp(1.0 - (1.0 - ao / weightAll) * ssaoIntensity, 0.0, 1.0);\n    gl_FragColor = color;\n}\n@end"},function(e,t,r){function n(e){for(var t=new Uint8Array(e*e*4),n=0,i=new l,r=0;r<e;r++)for(var o=0;o<e;o++)i.set(2*Math.random()-1,2*Math.random()-1,0).normalize(),t[n++]=255*(.5*i.x+.5),t[n++]=255*(.5*i.y+.5),t[n++]=0,t[n++]=255;return t}function i(e){return new c({pixels:n(e),wrapS:u.REPEAT,wrapT:u.REPEAT,width:e,height:e})}function a(e,t){var n=new Float32Array(3*e);t=t||0;for(var i=0;i<e;i++){var r=2*f(i+t,2)*Math.PI,o=f(i+t,3)*Math.PI,a=Math.random(),s=Math.cos(r)*Math.sin(o)*a,l=Math.cos(o)*a,c=Math.sin(r)*Math.sin(o)*a;n[3*i]=s,n[3*i+1]=l,n[3*i+2]=c}return n}function o(e){e=e||{},this._ssaoPass=new d({fragment:h.source("ecgl.ssao.estimate")}),this._blendPass=new d({fragment:h.source("ecgl.ssao.blur")}),this._framebuffer=new p,this._ssaoTexture=new c,this._targetTexture=new c({type:u.HALF_FLOAT}),this._depthTexture=e.depthTexture,this.setNoiseSize(4),this.setKernelSize(e.kernelSize||16),this.setParameter("blurSize",Math.round(e.blurSize||4)),null!=e.radius&&this.setParameter("radius",e.radius),null!=e.power&&this.setParameter("power",e.power)}var s=r(10),l=r(3),c=r(7),u=r(6),d=r(21),h=r(9),p=r(11),f=r(47);h.import(r(148)),o.prototype.setDepthTexture=function(e){this._depthTexture=e},o.prototype.update=function(e,t,n){var i=e.getWidth(),r=e.getHeight(),o=this._ssaoPass;o.setUniform("kernel",this._kernels[n%this._kernels.length]),o.setUniform("depthTex",this._depthTexture),o.setUniform("depthTexSize",[this._depthTexture.width,this._depthTexture.height]);var a=new s;s.transpose(a,t.worldTransform),o.setUniform("projection",t.projectionMatrix._array),o.setUniform("projectionInv",t.invProjectionMatrix._array),o.setUniform("viewInverseTranspose",a._array);var l=this._ssaoTexture;i===l.width&&r===l.height||(l.width=i,l.height=r,l.dirty()),this._framebuffer.attach(l),this._framebuffer.bind(e),e.gl.clearColor(1,1,1,1),e.gl.clear(e.gl.COLOR_BUFFER_BIT),o.render(e),this._framebuffer.unbind(e)},o.prototype.getTargetTexture=function(){return this._targetTexture},o.prototype.blend=function(e,t){var n=this._blendPass,i=this._depthTexture.width,r=this._depthTexture.height,o=this._targetTexture;t.width===o.width&&t.height===o.height||(o.width=t.width,o.height=t.height,o.dirty()),this._framebuffer.attach(o),this._framebuffer.bind(e),n.setUniform("textureSize",[i,r]),n.setUniform("ssaoTexture",this._ssaoTexture),n.setUniform("sourceTexture",t),n.render(e),this._framebuffer.unbind(e)},o.prototype.setParameter=function(e,t){"noiseTexSize"===e?this.setNoiseSize(t):"kernelSize"===e?this.setKernelSize(t):"blurSize"===e?this._blendPass.material.shader.define("fragment","BLUR_SIZE",t):"ssaoIntensity"===e?this._blendPass.material.set("ssaoIntensity",t):this._ssaoPass.setUniform(e,t)},o.prototype.setKernelSize=function(e){this._ssaoPass.material.shader.define("fragment","KERNEL_SIZE",e),this._kernels=this._kernels||[];for(var t=0;t<30;t++)this._kernels[t]=a(e,t*e)},o.prototype.setNoiseSize=function(e){var t=this._ssaoPass.getUniform("noiseTex");t?(t.data=n(e),t.width=t.height=e,t.dirty()):(t=i(e),this._ssaoPass.setUniform("noiseTex",i(e))),this._ssaoPass.setUniform("noiseTexSize",[e,e])},e.exports=o},function(e,t,i){function n(){for(var e=[],t=0;t<30;t++)e.push([r(t,2),r(t,3)]);this._haltonSequence=e,this._frame=0,this._sourceTex=new s,this._sourceFb=new a,this._sourceFb.attach(this._sourceTex),this._prevFrameTex=new s,this._outputTex=new s;var n=this._blendPass=new o({fragment:l.source("qtek.compositor.blend")});n.material.shader.disableTexturesAll(),n.material.shader.enableTexture(["texture1","texture2"]),this._blendFb=new a({depthBuffer:!1}),this._outputPass=new o({fragment:l.source("qtek.compositor.output"),blendWithPrevious:!0}),this._outputPass.material.shader.define("fragment","OUTPUT_ALPHA"),this._outputPass.material.blend=function(e){e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)}}var r=i(47),o=i(21),a=i(11),s=i(7),l=i(9);n.prototype={constructor:n,jitterProjection:function(e,t){var n=e.viewport,i=n.devicePixelRatio||e.getDevicePixelRatio(),r=n.width*i,o=n.height*i,a=this._haltonSequence[this._frame];t.projectionMatrix._array[8]+=(2*a[0]-1)/r,t.projectionMatrix._array[9]+=(2*a[1]-1)/o},resetFrame:function(){this._frame=0},getFrame:function(){return this._frame},getSourceFrameBuffer:function(){return this._sourceFb},resize:function(e,t){this._sourceTex.width===e&&this._sourceTex.height===t||(this._prevFrameTex.width=e,this._prevFrameTex.height=t,this._outputTex.width=e,this._outputTex.height=t,this._sourceTex.width=e,this._sourceTex.height=t,this._prevFrameTex.dirty(),this._outputTex.dirty(),this._sourceTex.dirty())},isFinished:function(){return this._frame>=this._haltonSequence.length},render:function(e){var t=this._blendPass;0===this._frame?(t.setUniform("weight1",0),t.setUniform("weight2",1)):(t.setUniform("weight1",.9),t.setUniform("weight2",.1)),t.setUniform("texture1",this._prevFrameTex),t.setUniform("texture2",this._sourceTex),this._blendFb.attach(this._outputTex),this._blendFb.bind(e),t.render(e),this._blendFb.unbind(e),this._outputPass.setUniform("texture",this._outputTex),this._outputPass.render(e);var n=this._prevFrameTex;this._prevFrameTex=this._outputTex,this._outputTex=n,this._frame++},dispose:function(e){this._sourceFb.dispose(e),this._blendFb.dispose(e),this._prevFrameTex.dispose(e),this._outputTex.dispose(e),this._sourceTex.dispose(e),this._outputPass.dispose(e),this._blendPass.dispose(e)}},e.exports=n},function(e,t){e.exports={type:"compositor",nodes:[{name:"source",type:"texture",outputs:{color:{}}},{name:"source_half",shader:"#source(qtek.compositor.downsample)",inputs:{texture:"source"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"}},{name:"bright",shader:"#source(qtek.compositor.bright)",inputs:{texture:"source_half"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{threshold:2,scale:4,textureSize:"expr([width * 1.0 / 2, height / 2])"}},{name:"bright2",shader:"#source(qtek.compositor.bright)",inputs:{texture:"source_half"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{threshold:20,scale:.01}},{name:"bright_downsample_4",shader:"#source(qtek.compositor.downsample)",inputs:{texture:"bright"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 2, height / 2] )"}},{name:"bright_downsample_8",shader:"#source(qtek.compositor.downsample)",inputs:{texture:"bright_downsample_4"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 4, height / 4] )"}},{name:"bright_downsample_16",shader:"#source(qtek.compositor.downsample)",inputs:{texture:"bright_downsample_8"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 16)",height:"expr(height * 1.0 / 16)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 8, height / 8] )"}},{name:"bright_downsample_32",shader:"#source(qtek.compositor.downsample)",inputs:{texture:"bright_downsample_16"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 32)",height:"expr(height * 1.0 / 32)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 16, height / 16] )"}},{name:"bright_upsample_16_blur_h",shader:"#source(qtek.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_32"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 16)",height:"expr(height * 1.0 / 16)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 32, height / 32] )"}},{name:"bright_upsample_16_blur_v",shader:"#source(qtek.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_16_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 16)",height:"expr(height * 1.0 / 16)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 32, height * 1.0 / 32] )"}},{name:"bright_upsample_8_blur_h",shader:"#source(qtek.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_16"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 16, height * 1.0 / 16] )"}},{name:"bright_upsample_8_blur_v",shader:"#source(qtek.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_8_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 16, height * 1.0 / 16] )"}},{name:"bright_upsample_8_blend",shader:"#source(qtek.compositor.blend)",inputs:{texture1:"bright_upsample_8_blur_v",texture2:"bright_upsample_16_blur_v"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"bright_upsample_4_blur_h",shader:"#source(qtek.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_8"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 8, height * 1.0 / 8] )"}},{name:"bright_upsample_4_blur_v",shader:"#source(qtek.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_4_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 8, height * 1.0 / 8] )"}},{name:"bright_upsample_4_blend",shader:"#source(qtek.compositor.blend)",inputs:{texture1:"bright_upsample_4_blur_v",texture2:"bright_upsample_8_blend"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"bright_upsample_2_blur_h",shader:"#source(qtek.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_4"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 4, height * 1.0 / 4] )"}},{name:"bright_upsample_2_blur_v",shader:"#source(qtek.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_2_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 4, height * 1.0 / 4] )"}},{name:"bright_upsample_2_blend",shader:"#source(qtek.compositor.blend)",inputs:{texture1:"bright_upsample_2_blur_v",texture2:"bright_upsample_4_blend"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"bright_upsample_full_blur_h",shader:"#source(qtek.compositor.gaussian_blur)",inputs:{texture:"bright"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 2, height * 1.0 / 2] )"}},{name:"bright_upsample_full_blur_v",shader:"#source(qtek.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_full_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 2, height * 1.0 / 2] )"}},{name:"bloom_composite",shader:"#source(qtek.compositor.blend)",inputs:{texture1:"bright_upsample_full_blur_v",texture2:"bright_upsample_2_blend"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"coc",shader:"#source(qtek.compositor.dof.coc)",outputs:{color:{parameters:{minFilter:"NEAREST",magFilter:"NEAREST",width:"expr(width * 1.0)",height:"expr(height * 1.0)"}}},parameters:{focalDist:50,focalRange:30}},{name:"dof_far_blur",shader:"#source(ecgl.dof.diskBlur)",inputs:{texture:"source",coc:"coc"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"}},{name:"dof_near_blur",shader:"#source(ecgl.dof.diskBlur)",inputs:{texture:"source",coc:"coc"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"},defines:{BLUR_NEARFIELD:null}},{name:"dof_coc_blur",shader:"#source(ecgl.dof.diskBlur)",inputs:{texture:"coc"},outputs:{color:{parameters:{minFilter:"NEAREST",magFilter:"NEAREST",width:"expr(width * 1.0)",height:"expr(height * 1.0)"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"},defines:{BLUR_COC:null}},{name:"dof_composite",shader:"#source(qtek.compositor.dof.composite)",inputs:{original:"source",blurred:"dof_far_blur",nearfield:"dof_near_blur",coc:"coc",nearcoc:"dof_coc_blur"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}}},{name:"lensflare",shader:"#source(qtek.compositor.lensflare)",inputs:{texture:"bright2"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr([width * 1.0 / 2, height * 1.0 / 2])",lensColor:"#lenscolor"}},{name:"lensflare_blur_h",shader:"#source(qtek.compositor.gaussian_blur)",inputs:{texture:"lensflare"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr([width * 1.0 / 2, height * 1.0 / 2])"}},{name:"lensflare_blur_v",shader:"#source(qtek.compositor.gaussian_blur)",inputs:{texture:"lensflare_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr([width * 1.0 / 2, height * 1.0 / 2])"}},{name:"composite",shader:"#source(qtek.compositor.hdr.composite)",inputs:{texture:"source",bloom:"bloom_composite"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)"}}},parameters:{bloomIntensity:.03},defines:{PREMULTIPLY_ALPHA:null}},{name:"FXAA",shader:"#source(qtek.compositor.fxaa)",inputs:{texture:"composite"}}]}},function(e,t){e.exports=[0,0,-.321585265978,-.154972575841,.458126042375,.188473391593,.842080129861,.527766490688,.147304551086,-.659453822776,-.331943915203,-.940619700594,.0479226680259,.54812163202,.701581552186,-.709825561388,-.295436780218,.940589268233,-.901489676764,.237713156085,.973570876096,-.109899459384,-.866792314779,-.451805525005,.330975007087,.800048655954,-.344275183665,.381779221166,-.386139432542,-.437418421534,-.576478634965,-.0148463392551,.385798197415,-.262426961053,-.666302061145,.682427250835,-.628010632582,-.732836215494,.10163141741,-.987658134403,.711995289051,-.320024291314,.0296005138058,.950296523438,.0130612307608,-.351024443122,-.879596633704,-.10478487883,.435712737232,.504254490347,.779203817497,.206477676721,.388264289969,-.896736162545,-.153106280781,-.629203242522,-.245517550697,.657969239148,.126830499058,.26862328493,-.634888119007,-.302301223431,.617074219636,.779817204925]},function(e,t,r){function n(e,t){if(e&&e[t]&&(e[t].normal||e[t].emphasis)){var n=e[t].normal,i=e[t].emphasis;n&&(e[t]=n),i&&(e.emphasis=e.emphasis||{},e.emphasis[t]=i)}}function i(e){n(e,"itemStyle"),n(e,"lineStyle"),n(e,"areaStyle"),n(e,"label")}var o=r(0);e.exports=function(e){o.util.each(e.series,function(e){i(e)}),n(e.geo3D)}},function(e,t,i){function n(e){return"_on"+e}var r=i(7),o=i(3),a=i(24),s=["mousedown","mouseup","mousemove","mouseover","mouseout","click","dblclick","contextmenu"],l=function(e){var t=this;this._texture=new r({anisotropic:32,flipY:!1,surface:this,dispose:function(e){t.dispose(),r.prototype.dispose.call(this,e)}}),s.forEach(function(e){this[n(e)]=function(t){t.triangle&&this._meshes.forEach(function(n){this.dispatchEvent(e,n,t.triangle,t.point)},this)}},this),this._meshes=[],e&&this.setECharts(e),this.onupdate=null};l.prototype={constructor:l,getTexture:function(){return this._texture},setECharts:function(e){this._chart=e;var t=e.getDom();if(t instanceof HTMLCanvasElement){var n=this,i=e.getZr(),r=i.__oldRefreshImmediately||i.refreshImmediately;i.refreshImmediately=function(){r.call(this),n._texture.dirty(),n.onupdate&&n.onupdate()},i.__oldRefreshImmediately=r}else t=document.createElement("canvas");this._texture.image=t,this._texture.dirty(),this.onupdate&&this.onupdate()},dispatchEvent:function(){var e=new o,t=new o,n=new o,i=new a,r=new a,s=new a,l=new a,c=new o;return function(u,d,h,p){var f=d.geometry,g=f.attributes.position,m=f.attributes.texcoord0,v=o.dot,_=o.cross;g.get(h[0],e._array),g.get(h[1],t._array),g.get(h[2],n._array),m.get(h[0],i._array),m.get(h[1],r._array),m.get(h[2],s._array),_(c,t,n);var y=v(e,c),x=v(p,c)/y;_(c,n,e);var b=v(p,c)/y;_(c,e,t);var w=v(p,c)/y;a.scale(l,i,x),a.scaleAndAdd(l,l,r,b),a.scaleAndAdd(l,l,s,w);var C=l.x*this._chart.getWidth(),S=l.y*this._chart.getHeight();this._chart.getZr().handler.dispatch(u,{zrX:C,zrY:S})}}(),attachToMesh:function(e){this._meshes.indexOf(e)>=0||(s.forEach(function(t){e.on(t,this[n(t)],this)},this),this._meshes.push(e))},detachFromMesh:function(e){var t=this._meshes.indexOf(e);t>=0&&this._meshes.splice(t,1),s.forEach(function(t){e.off(t,this[n(t)])},this)},dispose:function(){this._meshes.forEach(function(e){this.detachFromMesh(e)},this)}},e.exports=l},function(e,t,n){var i=n(5),r=(n(4),i.extend(function(){return{zr:null,viewGL:null,minZoom:.2,maxZoom:5,_needsUpdate:!1,_dx:0,_dy:0,_zoom:1}},function(){this._mouseDownHandler=this._mouseDownHandler.bind(this),this._mouseWheelHandler=this._mouseWheelHandler.bind(this),this._mouseMoveHandler=this._mouseMoveHandler.bind(this),this._mouseUpHandler=this._mouseUpHandler.bind(this),this._update=this._update.bind(this)},{init:function(){var e=this.zr;e.on("mousedown",this._mouseDownHandler),e.on("mousewheel",this._mouseWheelHandler),e.on("globalout",this._mouseUpHandler),e.animation.on("frame",this._update)},setTarget:function(e){this._target=e},setZoom:function(e){this._zoom=Math.max(Math.min(e,this.maxZoom),this.minZoom),this._needsUpdate=!0},setOffset:function(e){this._dx=e[0],this._dy=e[1],this._needsUpdate=!0},getZoom:function(){return this._zoom},getOffset:function(){return[this._dx,this._dy]},_update:function(){if(this._target&&this._needsUpdate){var e=this._target,t=this._zoom;e.position.x=this._dx,e.position.y=this._dy,e.scale.set(t,t,t),this.zr.refresh(),this._needsUpdate=!1,this.trigger("update")}},_mouseDownHandler:function(e){if(!e.target){var t=e.offsetX,n=e.offsetY;if(!this.viewGL||this.viewGL.containPoint(t,n)){this.zr.on("mousemove",this._mouseMoveHandler),this.zr.on("mouseup",this._mouseUpHandler);var i=this._convertPos(t,n);this._x=i.x,this._y=i.y}}},_convertPos:function(e,t){var n=this.viewGL.camera,i=this.viewGL.viewport;return{x:(e-i.x)/i.width*(n.right-n.left)+n.left,y:(t-i.y)/i.height*(n.bottom-n.top)+n.top}},_mouseMoveHandler:function(e){var t=this._convertPos(e.offsetX,e.offsetY);this._dx+=t.x-this._x,this._dy+=t.y-this._y,this._x=t.x,this._y=t.y,this._needsUpdate=!0},_mouseUpHandler:function(e){this.zr.off("mousemove",this._mouseMoveHandler),this.zr.off("mouseup",this._mouseUpHandler)},_mouseWheelHandler:function(e){e=e.event;var t=e.wheelDelta||-e.detail;if(0!==t){var n=e.offsetX,i=e.offsetY;if(!this.viewGL||this.viewGL.containPoint(n,i)){var r=t>0?1.1:.9,o=Math.max(Math.min(this._zoom*r,this.maxZoom),this.minZoom);r=o/this._zoom;var a=this._convertPos(n,i),s=(a.x-this._dx)*(r-1),l=(a.y-this._dy)*(r-1);this._dx-=s,this._dy-=l,this._zoom=o,this._needsUpdate=!0}}},dispose:function(){var e=this.zr;e.off("mousedown",this._mouseDownHandler),e.off("mousemove",this._mouseMoveHandler),e.off("mouseup",this._mouseUpHandler),e.off("mousewheel",this._mouseWheelHandler),e.off("globalout",this._mouseUpHandler),e.animation.off("frame",this._update)}}));e.exports=r},function(e,t,n){var i=n(218),r={_animators:null,getAnimators:function(){return this._animators=this._animators||[],this._animators},animate:function(e,t){this._animators=this._animators||[];var n,r=this;if(e){for(var o=e.split("."),a=r,s=0,l=o.length;s<l;s++)a&&(a=a[o[s]]);a&&(n=a)}else n=r;if(null==n)throw new Error("Target "+e+" not exists");var c=this._animators,u=new i(n,t),d=this;return u.during(function(){d.__zr&&d.__zr.refresh()}).done(function(){var e=c.indexOf(u);e>=0&&c.splice(e,1)}),c.push(u),this.__zr&&this.__zr.animation.addAnimator(u),u},stopAnimation:function(e){this._animators=this._animators||[];for(var t=this._animators,n=t.length,i=0;i<n;i++)t[i].stop(e);return t.length=0,this},addAnimatorsToZr:function(e){if(this._animators)for(var t=0;t<this._animators.length;t++)e.animation.addAnimator(this._animators[t])},removeAnimatorsFromZr:function(e){if(this._animators)for(var t=0;t<this._animators.length;t++)e.animation.removeAnimator(this._animators[t])}};e.exports=r},function(e,t,r){"use strict";function n(e,t,n){n=n||2;var r=t&&t.length,a=r?t[0]*n:e.length,s=i(e,0,a,n,!0),l=[];if(!s)return l;var u,d,h,p,f,g,m;if(r&&(s=c(e,t,s,n)),e.length>80*n){u=h=e[0],d=p=e[1];for(var v=n;v<a;v+=n)f=e[v],g=e[v+1],f<u&&(u=f),g<d&&(d=g),f>h&&(h=f),g>p&&(p=g);m=Math.max(h-u,p-d)}return o(s,l,n,u,d,m),l}function i(e,t,n,i,r){var o,a;if(r===R(e,t,n,i)>0)for(o=t;o<n;o+=i)a=C(o,e[o],e[o+1],a);else for(o=n-i;o>=t;o-=i)a=C(o,e[o],e[o+1],a);return a&&b(a,a.next)&&(L(a),a=a.next),a}function a(e,t){if(!e)return e;t||(t=e);var n,i=e;do{if(n=!1,i.steiner||!b(i,i.next)&&0!==T(i.prev,i,i.next))i=i.next;else{if(L(i),(i=t=i.prev)===i.next)return null;n=!0}}while(n||i!==t);return t}function o(e,t,n,i,r,c,d){if(e){!d&&c&&p(e,i,r,c);for(var f,g,m=e;e.prev!==e.next;)if(f=e.prev,g=e.next,c?u(e,i,r,c):s(e))t.push(f.i/n),t.push(e.i/n),t.push(g.i/n),L(e),e=g.next,m=g.next;else if((e=g)===m){d?1===d?(e=l(e,t,n),o(e,t,n,i,r,c,2)):2===d&&h(e,t,n,i,r,c):o(a(e),t,n,i,r,c,1);break}}}function s(e){var t=e.prev,n=e,i=e.next;if(T(t,n,i)>=0)return!1;for(var r=e.next.next;r!==e.prev;){if(y(t.x,t.y,n.x,n.y,i.x,i.y,r.x,r.y)&&T(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function u(e,t,n,i){var r=e.prev,o=e,a=e.next;if(T(r,o,a)>=0)return!1;for(var s=r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,l=r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,c=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,u=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,d=g(s,l,t,n,i),h=g(c,u,t,n,i),p=e.nextZ;p&&p.z<=h;){if(p!==e.prev&&p!==e.next&&y(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&T(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=e.prevZ;p&&p.z>=d;){if(p!==e.prev&&p!==e.next&&y(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&T(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function l(e,t,n){var i=e;do{var r=i.prev,o=i.next.next;!b(r,o)&&w(r,i,i.next,o)&&S(r,o)&&S(o,r)&&(t.push(r.i/n),t.push(i.i/n),t.push(o.i/n),L(i),L(i.next),i=e=o),i=i.next}while(i!==e);return i}function h(e,t,n,i,r,s){var l=e;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&x(l,c)){var u=M(l,c);return l=a(l,l.next),u=a(u,u.next),o(l,t,n,i,r,s),void o(u,t,n,i,r,s)}c=c.next}l=l.next}while(l!==e)}function c(e,t,n,r){var o,s,l,c,u,h=[];for(o=0,s=t.length;o<s;o++)l=t[o]*r,c=o<s-1?t[o+1]*r:e.length,u=i(e,l,c,r,!1),u===u.next&&(u.steiner=!0),h.push(v(u));for(h.sort(d),o=0;o<h.length;o++)f(h[o],n),n=a(n,n.next);return n}function d(e,t){return e.x-t.x}function f(e,t){if(t=_(e,t)){var n=M(t,e);a(n,n.next)}}function _(e,t){var n,i=t,r=e.x,o=e.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&s>a){if(a=s,s===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!n)return null;if(r===a)return n.prev;var l,c=n,u=n.x,d=n.y,h=1/0;for(i=n.next;i!==c;)r>=i.x&&i.x>=u&&r!==i.x&&y(o<d?r:a,o,u,d,o<d?a:r,o,i.x,i.y)&&((l=Math.abs(o-i.y)/(r-i.x))<h||l===h&&i.x>n.x)&&S(i,e)&&(n=i,h=l),i=i.next;return n}function p(e,t,n,i){var r=e;do{null===r.z&&(r.z=g(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,m(r)}function m(e){var t,n,i,r,o,a,s,l,c=1;do{for(n=e,e=null,o=null,a=0;n;){for(a++,i=n,s=0,t=0;t<c&&(s++,i=i.nextZ);t++);for(l=c;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:e=r,r.prevZ=o,o=r;n=i}o.nextZ=null,c*=2}while(a>1);return e}function g(e,t,n,i,r){return e=32767*(e-n)/r,t=32767*(t-i)/r,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1}function v(e){var t=e,n=e;do{t.x<n.x&&(n=t),t=t.next}while(t!==e);return n}function y(e,t,n,i,r,o,a,s){return(r-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(i-s)-(n-a)*(t-s)>=0&&(n-a)*(o-s)-(r-a)*(i-s)>=0}function x(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!E(e,t)&&S(e,t)&&S(t,e)&&A(e,t)}function T(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function b(e,t){return e.x===t.x&&e.y===t.y}function w(e,t,n,i){return!!(b(e,t)&&b(n,i)||b(e,i)&&b(n,t))||T(e,t,n)>0!=T(e,t,i)>0&&T(n,i,e)>0!=T(n,i,t)>0}function E(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&w(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function S(e,t){return T(e.prev,e,e.next)<0?T(e,t,e.next)>=0&&T(e,e.prev,t)>=0:T(e,t,e.prev)<0||T(e,e.next,t)<0}function A(e,t){var n=e,i=!1,r=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}function M(e,t){var n=new D(e.i,e.x,e.y),i=new D(t.i,t.x,t.y),r=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function C(e,t,n,i){var r=new D(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function L(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function D(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function R(e,t,n,i){for(var r=0,o=t,a=n-i;o<n;o+=i)r+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return r}e.exports=n,n.deviation=function(e,t,n,i){var r=t&&t.length,o=r?t[0]*n:e.length,a=Math.abs(R(e,0,o,n));if(r)for(var s=0,l=t.length;s<l;s++){var c=t[s]*n,u=s<l-1?t[s+1]*n:e.length;a-=Math.abs(R(e,c,u,n))}var d=0;for(s=0;s<i.length;s+=3){var h=i[s]*n,p=i[s+1]*n,f=i[s+2]*n;d+=Math.abs((e[h]-e[f])*(e[p+1]-e[h+1])-(e[h]-e[p])*(e[f+1]-e[h+1]))}return 0===a&&0===d?0:Math.abs((d-a)/a)}},function(e,t,n){var i=n(0),r=n(28),o=n(49),a=n(12),s=n(1),l=s.vec3,c=s.mat3,u=a.extend(function(){return{attributes:{position:new a.Attribute("position","float",3,"POSITION"),normal:new a.Attribute("normal","float",3,"NORMAL"),color:new a.Attribute("color","float",4,"COLOR")},dynamic:!0,enableNormal:!1,bevelSize:1,bevelSegments:0,_dataIndices:null,_vertexOffset:0,_triangleOffset:0}},{resetOffset:function(){this._vertexOffset=0,this._triangleOffset=0},setBarCount:function(e){var t=this.enableNormal,n=this.getBarVertexCount()*e,i=this.getBarTriangleCount()*e;this.vertexCount!==n&&(this.attributes.position.init(n),t?this.attributes.normal.init(n):this.attributes.normal.value=null,this.attributes.color.init(n)),this.triangleCount!==i&&(this.indices=n>65535?new Uint32Array(3*i):new Uint16Array(3*i),this._dataIndices=new Uint32Array(n))},getBarVertexCount:function(){var e=this.bevelSize>0?this.bevelSegments:0;return e>0?this._getBevelBarVertexCount(e):this.enableNormal?24:8},getBarTriangleCount:function(){var e=this.bevelSize>0?this.bevelSegments:0;return e>0?this._getBevelBarTriangleCount(e):12},_getBevelBarVertexCount:function(e){return 4*(e+1)*(e+1)*2},_getBevelBarTriangleCount:function(e){return(4*e+3+1)*(2*e+1)*2+4},setColor:function(e,t){for(var n=this.getBarVertexCount(),i=n*e,r=n*(e+1),o=i;o<r;o++)this.attributes.color.set(o,t);this.dirtyAttribute("color")},getDataIndexOfVertex:function(e){return this._dataIndices?this._dataIndices[e]:null},addBar:function(){for(var e=l.create,t=l.scaleAndAdd,n=e(),i=e(),r=e(),o=e(),a=e(),s=e(),c=e(),u=[],d=[],h=0;h<8;h++)u[h]=e();for(var p=[[0,1,5,4],[2,3,7,6],[4,5,6,7],[3,2,1,0],[0,4,7,3],[1,2,6,5]],f=[0,1,2,0,2,3],g=[],h=0;h<p.length;h++)for(var m=p[h],v=0;v<2;v++){for(var _=[],y=0;y<3;y++)_.push(m[f[3*v+y]]);g.push(_)}return function(e,h,m,v,_,y){var x=this._vertexOffset;if(this.bevelSize>0&&this.bevelSegments>0)this._addBevelBar(e,h,m,v,this.bevelSize,this.bevelSegments,_);else{l.copy(r,h),l.normalize(r,r),l.cross(o,m,r),l.normalize(o,o),l.cross(i,r,o),l.normalize(o,o),l.negate(a,i),l.negate(s,r),l.negate(c,o),t(u[0],e,i,v[0]/2),t(u[0],u[0],o,v[2]/2),t(u[1],e,i,v[0]/2),t(u[1],u[1],c,v[2]/2),t(u[2],e,a,v[0]/2),t(u[2],u[2],c,v[2]/2),t(u[3],e,a,v[0]/2),t(u[3],u[3],o,v[2]/2),t(n,e,r,v[1]),t(u[4],n,i,v[0]/2),t(u[4],u[4],o,v[2]/2),t(u[5],n,i,v[0]/2),t(u[5],u[5],c,v[2]/2),t(u[6],n,a,v[0]/2),t(u[6],u[6],c,v[2]/2),t(u[7],n,a,v[0]/2),t(u[7],u[7],o,v[2]/2);var b=this.attributes;if(this.enableNormal){d[0]=i,d[1]=a,d[2]=r,d[3]=s,d[4]=o,d[5]=c;for(var w=this._vertexOffset,C=0;C<p.length;C++){for(var S=3*this._triangleOffset,T=0;T<6;T++)this.indices[S++]=w+f[T];w+=4,this._triangleOffset+=2}for(var C=0;C<p.length;C++)for(var A=d[C],T=0;T<4;T++){var M=p[C][T];b.position.set(this._vertexOffset,u[M]),b.normal.set(this._vertexOffset,A),b.color.set(this._vertexOffset++,_)}}else{for(var C=0;C<g.length;C++){for(var S=3*this._triangleOffset,T=0;T<3;T++)this.indices[S+T]=g[C][T]+this._vertexOffset;this._triangleOffset++}for(var C=0;C<u.length;C++)b.position.set(this._vertexOffset,u[C]),b.color.set(this._vertexOffset++,_)}}for(var E=this._vertexOffset,C=x;C<E;C++)this._dataIndices[C]=y}}(),_addBevelBar:function(){var e=l.create(),t=l.create(),n=l.create(),i=c.create(),r=[],o=[1,-1,-1,1],a=[1,1,-1,-1],s=[2,0];return function(c,u,d,h,p,f,g){l.copy(t,u),l.normalize(t,t),l.cross(n,d,t),l.normalize(n,n),l.cross(e,t,n),l.normalize(n,n),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=t[0],i[4]=t[1],i[5]=t[2],i[6]=n[0],i[7]=n[1],i[8]=n[2];for(var m=0;m<3;m++)r[m]=Math.max(h[m]-2*p,0);for(var v=(h[0]-r[0])/2,_=(h[1]-r[1])/2,y=(h[2]-r[2])/2,x=[],b=[],w=this._vertexOffset,C=[],m=0;m<2;m++){C[m]=C[m]=[];for(var S=0;S<=f;S++)for(var T=0;T<4;T++){(0===S&&0===m||1===m&&S===f)&&C[m].push(w);for(var A=0;A<=f;A++){var M=A/f*Math.PI/2+Math.PI/2*T,E=S/f*Math.PI/2+Math.PI/2*m;b[0]=v*Math.cos(M)*Math.sin(E),b[1]=_*Math.cos(E),b[2]=y*Math.sin(M)*Math.sin(E),x[0]=b[0]+o[T]*r[0]/2,x[1]=b[1]+_+s[m]*r[1]/2,x[2]=b[2]+a[T]*r[2]/2,Math.abs(v-_)<1e-6&&Math.abs(_-y)<1e-6||(b[0]/=v*v,b[1]/=_*_,b[2]/=y*y),l.normalize(b,b),l.transformMat3(x,x,i),l.transformMat3(b,b,i),l.add(x,x,c),this.attributes.position.set(w,x),this.enableNormal&&this.attributes.normal.set(w,b),this.attributes.color.set(w,g),w++}}}for(var I=4*f+3,D=2*f+1,k=I+1,T=0;T<D;T++)for(var m=0;m<=I;m++){var L=T*k+m+this._vertexOffset,N=T*k+(m+1)%k+this._vertexOffset,P=(T+1)*k+(m+1)%k+this._vertexOffset,O=(T+1)*k+m+this._vertexOffset;this.setTriangleIndices(this._triangleOffset++,[P,L,N]),this.setTriangleIndices(this._triangleOffset++,[P,O,L])}this.setTriangleIndices(this._triangleOffset++,[C[0][0],C[0][2],C[0][1]]),this.setTriangleIndices(this._triangleOffset++,[C[0][0],C[0][3],C[0][2]]),this.setTriangleIndices(this._triangleOffset++,[C[1][0],C[1][1],C[1][2]]),this.setTriangleIndices(this._triangleOffset++,[C[1][0],C[1][2],C[1][3]]),this._vertexOffset=w}}()});i.util.defaults(u.prototype,r),i.util.defaults(u.prototype,o),e.exports=u},function(e,t,n){var i=n(12),r=n(1).vec2,o=n(0),a=n(28),s=[[0,0],[1,1]],l=i.extend(function(){return{segmentScale:4,dynamic:!0,useNativeLine:!0,attributes:{position:new i.Attribute("position","float",2,"POSITION"),normal:new i.Attribute("normal","float",2),offset:new i.Attribute("offset","float",1),color:new i.Attribute("color","float",4,"COLOR")}}},{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0},setVertexCount:function(e){var t=this.attributes;this.vertexCount!==e&&(t.position.init(e),t.color.init(e),this.useNativeLine||(t.offset.init(e),t.normal.init(e)),e>65535?this.indices instanceof Uint16Array&&(this.indices=new Uint32Array(this.indices)):this.indices instanceof Uint32Array&&(this.indices=new Uint16Array(this.indices)))},setTriangleCount:function(e){this.triangleCount!==e&&(this.indices=0===e?null:this.vertexCount>65535?new Uint32Array(3*e):new Uint16Array(3*e))},_getCubicCurveApproxStep:function(e,t,n,i){return 1/(r.dist(e,t)+r.dist(n,t)+r.dist(i,n)+1)*this.segmentScale},getCubicCurveVertexCount:function(e,t,n,i){var r=this._getCubicCurveApproxStep(e,t,n,i),o=Math.ceil(1/r);return this.useNativeLine?2*o:2*o+2},getCubicCurveTriangleCount:function(e,t,n,i){var r=this._getCubicCurveApproxStep(e,t,n,i),o=Math.ceil(1/r);return this.useNativeLine?0:2*o},getLineVertexCount:function(){return this.getPolylineVertexCount(s)},getLineTriangleCount:function(){return this.getPolylineTriangleCount(s)},getPolylineVertexCount:function(e){var t="number"!=typeof e[0],n=t?e.length:e.length/2;return this.useNativeLine?2*(n-1):2*(n-1)+2},getPolylineTriangleCount:function(e){var t="number"!=typeof e[0],n=t?e.length:e.length/2;return this.useNativeLine?0:2*(n-1)},addCubicCurve:function(e,t,n,i,r,o){null==o&&(o=1);for(var a=e[0],s=e[1],l=t[0],c=t[1],u=n[0],d=n[1],h=i[0],p=i[1],f=this._getCubicCurveApproxStep(e,t,n,i),g=f*f,m=g*f,v=3*f,_=3*g,y=6*g,x=6*m,b=a-2*l+u,w=s-2*c+d,C=3*(l-u)-a+h,S=3*(c-d)-s+p,T=a,A=s,M=(l-a)*v+b*_+C*m,E=(c-s)*v+w*_+S*m,I=b*y+C*x,D=w*y+S*x,k=C*x,L=S*x,N=0,P=0,O=Math.ceil(1/f),R=new Float32Array(3*(O+1)),R=[],z=0,P=0;P<O+1;P++)R[z++]=T,R[z++]=A,T+=M,A+=E,M+=I,E+=D,I+=k,D+=L,(N+=f)>1&&(T=M>0?Math.min(T,h):Math.max(T,h),A=E>0?Math.min(A,p):Math.max(A,p));this.addPolyline(R,r,o,!1)},addLine:function(e,t,n,i){this.addPolyline([e,t],n,i,!1)},addPolyline:function(e,t,n,i){if(e.length){var o="number"!=typeof e[0],a=this.attributes.position,s=this.attributes.color,l=this.attributes.offset,c=this.attributes.normal,u=this.indices;null==n&&(n=1);for(var d,h=this._vertexOffset,p=o?e.length:e.length/2,f=p,g=[],m=[],v=[],_=r.create(),y=r.create(),x=r.create(),b=r.create(),w=0;w<f;w++){if(o)g=e[w],d=i?t[w]:t;else{var C=2*w;if(g=g||[],g[0]=e[C],g[1]=e[C+1],i){var S=4*w;d=d||[],d[0]=t[S],d[1]=t[S+1],d[2]=t[S+2],d[3]=t[S+3]}else d=t}if(this.useNativeLine)w>1&&(a.copy(h,h-1),s.copy(h,h-1),h++);else{var T;if(w<f-1){if(o)r.copy(m,e[w+1]);else{var C=2*(w+1);m=m||[],m[0]=e[C],m[1]=e[C+1]}if(w>0){r.sub(_,g,v),r.sub(y,m,g),r.normalize(_,_),r.normalize(y,y),r.add(b,_,y),r.normalize(b,b);var A=n/2*Math.min(1/r.dot(_,b),2);x[0]=-b[1],x[1]=b[0],T=A}else r.sub(_,m,g),r.normalize(_,_),x[0]=-_[1],x[1]=_[0],T=n/2}else r.sub(_,g,v),r.normalize(_,_),x[0]=-_[1],x[1]=_[0],T=n/2;c.set(h,x),c.set(h+1,x),l.set(h,T),l.set(h+1,-T),r.copy(v,g),a.set(h,g),a.set(h+1,g),s.set(h,d),s.set(h+1,d),h+=2}if(this.useNativeLine)s.set(h,d),a.set(h,g),h++;else if(w>0){var M=3*this._faceOffset,u=this.indices;u[M]=h-4,u[M+1]=h-3,u[M+2]=h-2,u[M+3]=h-3,u[M+4]=h-1,u[M+5]=h-2,this._faceOffset+=2}}this._vertexOffset=h}}});o.util.defaults(l.prototype,a),e.exports=l},function(e,t,n){var i=n(12),r=n(1).vec3,o=n(0),a=n(28),s=i.extend(function(){return{segmentScale:1,useNativeLine:!0,attributes:{position:new i.Attribute("position","float",3,"POSITION"),normal:new i.Attribute("normal","float",3,"NORMAL"),color:new i.Attribute("color","float",4,"COLOR")}}},{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0},setQuadCount:function(e){var t=this.attributes,n=this.getQuadVertexCount()*e,i=this.getQuadTriangleCount()*e;this.vertexCount!==n&&(t.position.init(n),t.normal.init(n),t.color.init(n)),this.triangleCount!==i&&(this.indices=n>65535?new Uint32Array(3*i):new Uint16Array(3*i))},getQuadVertexCount:function(){return 4},getQuadTriangleCount:function(){return 2},addQuad:function(){var e=r.create(),t=r.create(),n=r.create(),i=[0,3,1,3,2,1];return function(o,a){var s=this.attributes.position,l=this.attributes.normal,c=this.attributes.color;r.sub(e,o[1],o[0]),r.sub(t,o[2],o[1]),r.cross(n,e,t),r.normalize(n,n);for(var u=0;u<4;u++)s.set(this._vertexOffset+u,o[u]),c.set(this._vertexOffset+u,a),l.set(this._vertexOffset+u,n);for(var d=3*this._faceOffset,u=0;u<6;u++)this.indices[d+u]=i[u]+this._vertexOffset;this._vertexOffset+=4,this._faceOffset+=2}}()});o.util.defaults(s.prototype,a),e.exports=s},function(e,t,n){var i=n(0),r=n(12),o=n(28),a=[0,1,2,0,2,3],s=r.extend(function(){return{attributes:{position:new r.Attribute("position","float",3,"POSITION"),texcoord:new r.Attribute("texcoord","float",2,"TEXCOORD_0"),offset:new r.Attribute("offset","float",2),color:new r.Attribute("color","float",4,"COLOR")}}},{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0},setSpriteCount:function(e){this._spriteCount=e;var t=4*e,n=2*e;this.vertexCount!==t&&(this.attributes.position.init(t),this.attributes.offset.init(t),this.attributes.color.init(t)),this.triangleCount!==n&&(this.indices=t>65535?new Uint32Array(3*n):new Uint16Array(3*n))},setSpriteAlign:function(e,t,n,i,r){null==n&&(n="left"),null==i&&(i="top");var o,a,s,l;switch(r=r||0,n){case"left":o=r,s=t[0]+r;break;case"center":case"middle":o=-t[0]/2,s=t[0]/2;break;case"right":o=-t[0]-r,s=-r}switch(i){case"bottom":a=r,l=t[1]+r;break;case"middle":a=-t[1]/2,l=t[1]/2;break;case"top":a=-t[1]-r,l=-r}var c=4*e,u=this.attributes.offset;u.set(c,[o,l]),u.set(c+1,[s,l]),u.set(c+2,[s,a]),u.set(c+3,[o,a])},addSprite:function(e,t,n,i,r,o){var s=this._vertexOffset;this.setSprite(this._vertexOffset/4,e,t,n,i,r,o);for(var l=0;l<a.length;l++)this.indices[3*this._faceOffset+l]=a[l]+s;return this._faceOffset+=2,this._vertexOffset+=4,s/4},setSprite:function(e,t,n,i,r,o,a){for(var s=4*e,l=this.attributes,c=0;c<4;c++)l.position.set(s+c,t);var u=l.texcoord;u.set(s,[i[0][0],i[0][1]]),u.set(s+1,[i[1][0],i[0][1]]),u.set(s+2,[i[1][0],i[1][1]]),u.set(s+3,[i[0][0],i[1][1]]),this.setSpriteAlign(e,n,r,o,a)}});i.util.defaults(s.prototype,o),e.exports=s},function(e,n,i){var r=i(1).vec3,o=i(65);e.exports={needsSortVertices:function(){return this.sortVertices},needsSortVerticesProgressively:function(){return this.needsSortVertices()&&this.vertexCount>=2e4},doSortVertices:function(e,t){var n=this.indices,i=r.create();if(!n){n=this.indices=this.vertexCount>65535?new Uint32Array(this.vertexCount):new Uint16Array(this.vertexCount);for(var o=0;o<n.length;o++)n[o]=o}if(0===t){var a=this.attributes.position,e=e._array,s=0;this._zList&&this._zList.length===this.vertexCount||(this._zList=new Float32Array(this.vertexCount));for(var o=0;o<this.vertexCount;o++){a.get(o,i);var l=r.sqrDist(i,e);isNaN(l)&&(l=1e7,s++),this._zList[o]=l}this._noneCount=s}if(this.vertexCount<2e4)0===t&&this._simpleSort(this._noneCount/this.vertexCount>.05);else for(var o=0;o<3;o++)this._progressiveQuickSort(3*t+o);this.dirtyIndices()},_simpleSort:function(e){function t(e,t){return n[t]-n[e]}var n=this._zList,i=this.indices;e?i.sort(t):o.sort(i,t,0,i.length-1)},_progressiveQuickSort:function(e){var t=this._zList,n=this.indices;this._quickSort=this._quickSort||new o,this._quickSort.step(n,function(e,n){return t[n]-t[e]},e)}}},function(e,t){e.exports="@export ecgl.color.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform vec2 uvRepeat: [1, 1];\n\nattribute vec2 texcoord : TEXCOORD_0;\nattribute vec3 position: POSITION;\n\n@import ecgl.wireframe.common.vertexHeader\n\n#ifdef VERTEX_COLOR\nattribute vec4 a_Color : COLOR;\nvarying vec4 v_Color;\n#endif\n\nvarying vec2 v_Texcoord;\n\nvoid main()\n{\n    gl_Position = worldViewProjection * vec4(position, 1.0);\n    v_Texcoord = texcoord * uvRepeat;\n\n#ifdef VERTEX_COLOR\n    v_Color = a_Color;\n#endif\n\n    @import ecgl.wireframe.common.vertexMain\n\n}\n\n@end\n\n@export ecgl.color.fragment\n\n#define LAYER_DIFFUSEMAP_COUNT 0\n#define LAYER_EMISSIVEMAP_COUNT 0\n\nuniform sampler2D diffuseMap;\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\n\n#ifdef VERTEX_COLOR\nvarying vec4 v_Color;\n#endif\n\n#if (LAYER_DIFFUSEMAP_COUNT > 0)\nuniform float layerDiffuseIntensity[LAYER_DIFFUSEMAP_COUNT];\nuniform sampler2D layerDiffuseMap[LAYER_DIFFUSEMAP_COUNT];\n#endif\n\n#if (LAYER_EMISSIVEMAP_COUNT > 0)\nuniform float layerEmissionIntensity[LAYER_EMISSIVEMAP_COUNT];\nuniform sampler2D layerEmissiveMap[LAYER_EMISSIVEMAP_COUNT];\n#endif\n\nvarying vec2 v_Texcoord;\n\n@import ecgl.wireframe.common.fragmentHeader\n\n@import qtek.util.srgb\n\nvoid main()\n{\n#ifdef SRGB_DECODE\n    gl_FragColor = sRGBToLinear(color);\n#else\n    gl_FragColor = color;\n#endif\n\n#ifdef VERTEX_COLOR\n    gl_FragColor *= v_Color;\n#endif\n\n    vec4 albedoTexel = vec4(1.0);\n#ifdef DIFFUSEMAP_ENABLED\n    albedoTexel = texture2D(diffuseMap, v_Texcoord);\n    #ifdef SRGB_DECODE\n    albedoTexel = sRGBToLinear(albedoTexel);\n    #endif\n#endif\n\n#if (LAYER_DIFFUSEMAP_COUNT > 0)\n    for (int _idx_ = 0; _idx_ < LAYER_DIFFUSEMAP_COUNT; _idx_++) {{\n        float intensity = layerDiffuseIntensity[_idx_];\n        vec4 texel2 = texture2D(layerDiffuseMap[_idx_], v_Texcoord);\n        #ifdef SRGB_DECODE\n        texel2 = sRGBToLinear(texel2);\n        #endif\n                albedoTexel.rgb = mix(albedoTexel.rgb, texel2.rgb * intensity, texel2.a);\n        albedoTexel.a = texel2.a + (1.0 - texel2.a) * albedoTexel.a;\n    }}\n#endif\n    gl_FragColor *= albedoTexel;\n\n#if (LAYER_EMISSIVEMAP_COUNT > 0)\n    for (int _idx_ = 0; _idx_ < LAYER_EMISSIVEMAP_COUNT; _idx_++) {{\n                vec4 texel2 = texture2D(layerEmissiveMap[_idx_], v_Texcoord);\n        float intensity = layerEmissionIntensity[_idx_];\n        gl_FragColor.rgb += texel2.rgb * texel2.a * intensity;\n    }}\n#endif\n\n\n    @import ecgl.wireframe.common.fragmentMain\n\n}\n@end"},function(e,t){e.exports="@export ecgl.wireframe.common.vertexHeader\n\n#ifdef WIREFRAME_QUAD\nattribute vec4 barycentric;\nvarying vec4 v_Barycentric;\n#elif defined(WIREFRAME_TRIANGLE)\nattribute vec3 barycentric;\nvarying vec3 v_Barycentric;\n#endif\n\n@end\n\n@export ecgl.wireframe.common.vertexMain\n\n#if defined(WIREFRAME_QUAD) || defined(WIREFRAME_TRIANGLE)\n    v_Barycentric = barycentric;\n#endif\n\n@end\n\n\n@export ecgl.wireframe.common.fragmentHeader\n\nuniform float wireframeLineWidth : 1;\nuniform vec3 wireframeLineColor: [0.5, 0.5, 0.5];\n\n#ifdef WIREFRAME_QUAD\nvarying vec4 v_Barycentric;\nfloat edgeFactor () {\n    vec4 d = fwidth(v_Barycentric);\n    vec4 a4 = smoothstep(vec4(0.0), d * wireframeLineWidth, v_Barycentric);\n    return min(min(min(a4.x, a4.y), a4.z), a4.w);\n}\n#elif defined(WIREFRAME_TRIANGLE)\nvarying vec3 v_Barycentric;\nfloat edgeFactor () {\n    vec3 d = fwidth(v_Barycentric);\n    vec3 a3 = smoothstep(vec3(0.0), d * wireframeLineWidth, v_Barycentric);\n    return min(min(a3.x, a3.y), a3.z);\n}\n#endif\n\n@end\n\n\n@export ecgl.wireframe.common.fragmentMain\n\n#if defined(WIREFRAME_QUAD) || defined(WIREFRAME_TRIANGLE)\n    if (wireframeLineWidth > 0.) {\n        vec3 lineColor = wireframeLineColor;\n#ifdef SRGB_DECODE\n        lineColor = sRGBToLinear(vec4(lineColor, 1.0)).rgb;\n#endif\n\n        gl_FragColor.rgb = mix(lineColor, gl_FragColor.rgb, edgeFactor());\n    }\n#endif\n@end\n\n"},function(e,t){e.exports="@export ecgl.labels3D.vertex\n\nattribute vec3 position: POSITION;\nattribute vec2 texcoord: TEXCOORD_0;\nattribute vec2 offset;\n#ifdef VERTEX_COLOR\nattribute vec4 a_Color : COLOR;\nvarying vec4 v_Color;\n#endif\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform vec4 viewport : VIEWPORT;\n\nvarying vec2 v_Texcoord;\n\nvoid main()\n{\n    vec4 proj = worldViewProjection * vec4(position, 1.0);\n\n    vec2 screen = (proj.xy / abs(proj.w) + 1.0) * 0.5 * viewport.zw;\n\n    screen += offset;\n\n    proj.xy = (screen / viewport.zw - 0.5) * 2.0 * abs(proj.w);\n    gl_Position = proj;\n#ifdef VERTEX_COLOR\n    v_Color = a_Color;\n#endif\n    v_Texcoord = texcoord;\n\n    gl_PointSize = 10.0;\n}\n@end\n\n\n@export ecgl.labels3D.fragment\n\nuniform vec3 color : [1.0, 1.0, 1.0];\nuniform float alpha : 1.0;\nuniform sampler2D textureAtlas;\nuniform vec2 uvScale: [1.0, 1.0];\n\n#ifdef VERTEX_COLOR\nvarying vec4 v_Color;\n#endif\nvarying float v_Miter;\n\nvarying vec2 v_Texcoord;\n\nvoid main()\n{\n    gl_FragColor = vec4(color, alpha) * texture2D(textureAtlas, v_Texcoord * uvScale);\n#ifdef VERTEX_COLOR\n    gl_FragColor *= v_Color;\n#endif\n}\n\n@end"},function(e,t){e.exports="/**\n * http: */\n\n@export ecgl.lambert.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform mat4 worldInverseTranspose : WORLDINVERSETRANSPOSE;\nuniform mat4 world : WORLD;\n\nuniform vec2 uvRepeat : [1.0, 1.0];\nuniform vec2 uvOffset : [0.0, 0.0];\n\nattribute vec3 position : POSITION;\nattribute vec2 texcoord : TEXCOORD_0;\nattribute vec3 normal : NORMAL;\n\n@import ecgl.wireframe.common.vertexHeader\n\n#ifdef VERTEX_COLOR\nattribute vec4 a_Color : COLOR;\nvarying vec4 v_Color;\n#endif\n\nvarying vec2 v_Texcoord;\n\nvarying vec3 v_Normal;\nvarying vec3 v_WorldPosition;\n\nvoid main()\n{\n    v_Texcoord = texcoord * uvRepeat + uvOffset;\n\n    gl_Position = worldViewProjection * vec4(position, 1.0);\n\n    v_Normal = normalize((worldInverseTranspose * vec4(normal, 0.0)).xyz);\n    v_WorldPosition = (world * vec4(position, 1.0)).xyz;\n\n#ifdef VERTEX_COLOR\n    v_Color = a_Color;\n#endif\n\n    @import ecgl.wireframe.common.vertexMain\n}\n\n@end\n\n\n@export ecgl.lambert.fragment\n\n#define LAYER_DIFFUSEMAP_COUNT 0\n#define LAYER_EMISSIVEMAP_COUNT 0\n#define PI 3.14159265358979\n\nvarying vec2 v_Texcoord;\n\nvarying vec3 v_Normal;\nvarying vec3 v_WorldPosition;\n\n#ifdef DIFFUSEMAP_ENABLED\nuniform sampler2D diffuseMap;\n#endif\n\n#if (LAYER_DIFFUSEMAP_COUNT > 0)\nuniform float layerDiffuseIntensity[LAYER_DIFFUSEMAP_COUNT];\nuniform sampler2D layerDiffuseMap[LAYER_DIFFUSEMAP_COUNT];\n#endif\n\n#if (LAYER_EMISSIVEMAP_COUNT > 0)\nuniform float layerEmissionIntensity[LAYER_EMISSIVEMAP_COUNT];\nuniform sampler2D layerEmissiveMap[LAYER_EMISSIVEMAP_COUNT];\n#endif\n\nuniform float emissionIntensity: 1.0;\n\n#ifdef BUMPMAP_ENABLED\nuniform sampler2D bumpMap;\nuniform float bumpScale : 1.0;\n\n\nvec3 perturbNormalArb(vec3 surfPos, vec3 surfNormal, vec3 baseNormal)\n{\n    vec2 dSTdx = dFdx(v_Texcoord);\n    vec2 dSTdy = dFdy(v_Texcoord);\n\n    float Hll = bumpScale * texture2D(bumpMap, v_Texcoord).x;\n    float dHx = bumpScale * texture2D(bumpMap, v_Texcoord + dSTdx).x - Hll;\n    float dHy = bumpScale * texture2D(bumpMap, v_Texcoord + dSTdy).x - Hll;\n\n    vec3 vSigmaX = dFdx(surfPos);\n    vec3 vSigmaY = dFdy(surfPos);\n    vec3 vN = surfNormal;\n\n    vec3 R1 = cross(vSigmaY, vN);\n    vec3 R2 = cross(vN, vSigmaX);\n\n    float fDet = dot(vSigmaX, R1);\n\n    vec3 vGrad = sign(fDet) * (dHx * R1 + dHy * R2);\n    return normalize(abs(fDet) * baseNormal - vGrad);\n\n}\n#endif\n\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\n\nuniform mat4 viewInverse : VIEWINVERSE;\n\n#ifdef AMBIENT_LIGHT_COUNT\n@import qtek.header.ambient_light\n#endif\n#ifdef AMBIENT_SH_LIGHT_COUNT\n@import qtek.header.ambient_sh_light\n#endif\n\n#ifdef DIRECTIONAL_LIGHT_COUNT\n@import qtek.header.directional_light\n#endif\n\n#ifdef VERTEX_COLOR\nvarying vec4 v_Color;\n#endif\n\n@import qtek.util.srgb\n\n@import ecgl.wireframe.common.fragmentHeader\n\n@import qtek.plugin.compute_shadow_map\n\nvoid main()\n{\n#ifdef SRGB_DECODE\n    gl_FragColor = sRGBToLinear(color);\n#else\n    gl_FragColor = color;\n#endif\n\n#ifdef VERTEX_COLOR\n        #ifdef SRGB_DECODE\n    gl_FragColor *= sRGBToLinear(v_Color);\n    #else\n    gl_FragColor *= v_Color;\n    #endif\n#endif\n\n    vec4 albedoTexel = vec4(1.0);\n#ifdef DIFFUSEMAP_ENABLED\n    albedoTexel = texture2D(diffuseMap, v_Texcoord);\n    #ifdef SRGB_DECODE\n    albedoTexel = sRGBToLinear(albedoTexel);\n    #endif\n#endif\n\n#if (LAYER_DIFFUSEMAP_COUNT > 0)\n    for (int _idx_ = 0; _idx_ < LAYER_DIFFUSEMAP_COUNT; _idx_++) {{\n        float intensity = layerDiffuseIntensity[_idx_];\n        vec4 texel2 = texture2D(layerDiffuseMap[_idx_], v_Texcoord);\n        #ifdef SRGB_DECODE\n        texel2 = sRGBToLinear(texel2);\n        #endif\n                albedoTexel.rgb = mix(albedoTexel.rgb, texel2.rgb * intensity, texel2.a);\n        albedoTexel.a = texel2.a + (1.0 - texel2.a) * albedoTexel.a;\n    }}\n#endif\n    gl_FragColor *= albedoTexel;\n\n    vec3 N = v_Normal;\n#ifdef DOUBLE_SIDE\n    vec3 eyePos = viewInverse[3].xyz;\n    vec3 V = normalize(eyePos - v_WorldPosition);\n\n    if (dot(N, V) < 0.0) {\n        N = -N;\n    }\n#endif\n\n    float ambientFactor = 1.0;\n\n#ifdef BUMPMAP_ENABLED\n    N = perturbNormalArb(v_WorldPosition, v_Normal, N);\n        ambientFactor = dot(v_Normal, N);\n#endif\n\n    vec3 diffuseColor = vec3(0.0, 0.0, 0.0);\n\n#ifdef AMBIENT_LIGHT_COUNT\n    for(int i = 0; i < AMBIENT_LIGHT_COUNT; i++)\n    {\n                        diffuseColor += ambientLightColor[i] * ambientFactor;\n    }\n#endif\n#ifdef AMBIENT_SH_LIGHT_COUNT\n    for(int _idx_ = 0; _idx_ < AMBIENT_SH_LIGHT_COUNT; _idx_++)\n    {{\n        diffuseColor += calcAmbientSHLight(_idx_, N) * ambientSHLightColor[_idx_];\n    }}\n#endif\n#ifdef DIRECTIONAL_LIGHT_COUNT\n#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)\n    float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];\n    if(shadowEnabled)\n    {\n        computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);\n    }\n#endif\n    for(int i = 0; i < DIRECTIONAL_LIGHT_COUNT; i++)\n    {\n        vec3 lightDirection = -directionalLightDirection[i];\n        vec3 lightColor = directionalLightColor[i];\n\n        float shadowContrib = 1.0;\n#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)\n        if (shadowEnabled)\n        {\n            shadowContrib = shadowContribsDir[i];\n        }\n#endif\n\n        float ndl = dot(N, normalize(lightDirection)) * shadowContrib;\n\n        diffuseColor += lightColor * clamp(ndl, 0.0, 1.0);\n    }\n#endif\n\n    gl_FragColor.rgb *= diffuseColor;\n\n#if (LAYER_EMISSIVEMAP_COUNT > 0)\n    for (int _idx_ = 0; _idx_ < LAYER_EMISSIVEMAP_COUNT; _idx_++) {{\n        vec4 texel2 = texture2D(layerEmissiveMap[_idx_], v_Texcoord) * layerEmissionIntensity[_idx_];\n        float intensity = layerEmissionIntensity[_idx_];\n        gl_FragColor.rgb += texel2.rgb * texel2.a * intensity;\n    }}\n#endif\n\n    @import ecgl.wireframe.common.fragmentMain\n}\n\n@end"},function(e,t){e.exports="@export ecgl.lines2D.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\nattribute vec2 position: POSITION;\nattribute vec4 a_Color : COLOR;\nvarying vec4 v_Color;\n\n#ifdef POSITIONTEXTURE_ENABLED\nuniform sampler2D positionTexture;\n#endif\n\nvoid main()\n{\n    gl_Position = worldViewProjection * vec4(position, -10.0, 1.0);\n\n    v_Color = a_Color;\n}\n\n@end\n\n@export ecgl.lines2D.fragment\n\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\n\nvarying vec4 v_Color;\n\nvoid main()\n{\n    gl_FragColor = color * v_Color;\n}\n@end\n\n\n@export ecgl.meshLines2D.vertex\n\nattribute vec2 position: POSITION;\nattribute vec2 normal;\nattribute float offset;\nattribute vec4 a_Color : COLOR;\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform vec4 viewport : VIEWPORT;\n\nvarying vec4 v_Color;\nvarying float v_Miter;\n\nvoid main()\n{\n    vec4 p2 = worldViewProjection * vec4(position + normal, -10.0, 1.0);\n    gl_Position = worldViewProjection * vec4(position, -10.0, 1.0);\n\n    p2.xy /= p2.w;\n    gl_Position.xy /= gl_Position.w;\n\n        vec2 N = normalize(p2.xy - gl_Position.xy);\n    gl_Position.xy += N * offset / viewport.zw * 2.0;\n\n    gl_Position.xy *= gl_Position.w;\n\n    v_Color = a_Color;\n}\n@end\n\n\n@export ecgl.meshLines2D.fragment\n\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\n\nvarying vec4 v_Color;\nvarying float v_Miter;\n\nvoid main()\n{\n        gl_FragColor = color * v_Color;\n}\n\n@end"},function(e,t){e.exports="@export ecgl.realistic.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform mat4 worldInverseTranspose : WORLDINVERSETRANSPOSE;\nuniform mat4 world : WORLD;\n\nuniform vec2 uvRepeat : [1.0, 1.0];\nuniform vec2 uvOffset : [0.0, 0.0];\n\nattribute vec3 position : POSITION;\nattribute vec2 texcoord : TEXCOORD_0;\nattribute vec3 normal : NORMAL;\n\n@import ecgl.wireframe.common.vertexHeader\n\n#ifdef VERTEX_COLOR\nattribute vec4 a_Color : COLOR;\nvarying vec4 v_Color;\n#endif\n\nvarying vec2 v_Texcoord;\n\nvarying vec3 v_Normal;\nvarying vec3 v_WorldPosition;\n\nvoid main()\n{\n    v_Texcoord = texcoord * uvRepeat + uvOffset;\n\n    gl_Position = worldViewProjection * vec4(position, 1.0);\n\n    v_Normal = normalize((worldInverseTranspose * vec4(normal, 0.0)).xyz);\n    v_WorldPosition = (world * vec4(position, 1.0)).xyz;\n\n#ifdef VERTEX_COLOR\n    v_Color = a_Color;\n#endif\n\n    @import ecgl.wireframe.common.vertexMain\n\n}\n\n@end\n\n\n@export ecgl.realistic.fragment\n\n#define LAYER_DIFFUSEMAP_COUNT 0\n#define LAYER_EMISSIVEMAP_COUNT 0\n#define PI 3.14159265358979\n\n#ifdef VERTEX_COLOR\nvarying vec4 v_Color;\n#endif\n\nvarying vec2 v_Texcoord;\nvarying vec3 v_Normal;\nvarying vec3 v_WorldPosition;\n\n#ifdef DIFFUSEMAP_ENABLED\nuniform sampler2D diffuseMap;\n#endif\n\n#if (LAYER_DIFFUSEMAP_COUNT > 0)\nuniform float layerDiffuseIntensity[LAYER_DIFFUSEMAP_COUNT];\nuniform sampler2D layerDiffuseMap[LAYER_DIFFUSEMAP_COUNT];\n#endif\n\n#if (LAYER_EMISSIVEMAP_COUNT > 0)\nuniform float layerEmissionIntensity[LAYER_EMISSIVEMAP_COUNT];\nuniform sampler2D layerEmissiveMap[LAYER_EMISSIVEMAP_COUNT];\n#endif\n\nuniform float emissionIntensity: 1.0;\n\n#ifdef BUMPMAP_ENABLED\nuniform sampler2D bumpMap;\nuniform float bumpScale : 1.0;\n\n\nvec3 perturbNormalArb(vec3 surfPos, vec3 surfNormal, vec3 baseNormal)\n{\n    vec2 dSTdx = dFdx(v_Texcoord);\n    vec2 dSTdy = dFdy(v_Texcoord);\n\n    float Hll = bumpScale * texture2D(bumpMap, v_Texcoord).x;\n    float dHx = bumpScale * texture2D(bumpMap, v_Texcoord + dSTdx).x - Hll;\n    float dHy = bumpScale * texture2D(bumpMap, v_Texcoord + dSTdy).x - Hll;\n\n    vec3 vSigmaX = dFdx(surfPos);\n    vec3 vSigmaY = dFdy(surfPos);\n    vec3 vN = surfNormal;\n\n    vec3 R1 = cross(vSigmaY, vN);\n    vec3 R2 = cross(vN, vSigmaX);\n\n    float fDet = dot(vSigmaX, R1);\n\n    vec3 vGrad = sign(fDet) * (dHx * R1 + dHy * R2);\n    return normalize(abs(fDet) * baseNormal - vGrad);\n\n}\n#endif\n\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\n\nuniform float metalness : 0.0;\nuniform float roughness : 0.5;\n\nuniform mat4 viewInverse : VIEWINVERSE;\n\n#ifdef AMBIENT_LIGHT_COUNT\n@import qtek.header.ambient_light\n#endif\n\n#ifdef AMBIENT_SH_LIGHT_COUNT\n@import qtek.header.ambient_sh_light\n#endif\n\n#ifdef AMBIENT_CUBEMAP_LIGHT_COUNT\n@import qtek.header.ambient_cubemap_light\n#endif\n\n#ifdef DIRECTIONAL_LIGHT_COUNT\n@import qtek.header.directional_light\n#endif\n\n@import qtek.util.srgb\n\n@import qtek.util.rgbm\n\n@import ecgl.wireframe.common.fragmentHeader\n\n@import qtek.plugin.compute_shadow_map\n\nvec3 F_Schlick(float ndv, vec3 spec) {\n    return spec + (1.0 - spec) * pow(1.0 - ndv, 5.0);\n}\n\nfloat D_Phong(float g, float ndh) {\n        float a = pow(8192.0, g);\n    return (a + 2.0) / 8.0 * pow(ndh, a);\n}\nvoid main()\n{\n    vec4 albedoColor = color;\n\n    vec3 eyePos = viewInverse[3].xyz;\n    vec3 V = normalize(eyePos - v_WorldPosition);\n#ifdef VERTEX_COLOR\n        #ifdef SRGB_DECODE\n    albedoColor *= sRGBToLinear(v_Color);\n    #else\n    albedoColor *= v_Color;\n    #endif\n#endif\n\n    vec4 albedoTexel = vec4(1.0);\n#ifdef DIFFUSEMAP_ENABLED\n    albedoTexel = texture2D(diffuseMap, v_Texcoord);\n    #ifdef SRGB_DECODE\n    albedoTexel = sRGBToLinear(albedoTexel);\n    #endif\n#endif\n\n#if (LAYER_DIFFUSEMAP_COUNT > 0)\n    for (int _idx_ = 0; _idx_ < LAYER_DIFFUSEMAP_COUNT; _idx_++) {{\n        float intensity = layerDiffuseIntensity[_idx_];\n        vec4 texel2 = texture2D(layerDiffuseMap[_idx_], v_Texcoord);\n        #ifdef SRGB_DECODE\n        texel2 = sRGBToLinear(texel2);\n        #endif\n                albedoTexel.rgb = mix(albedoTexel.rgb, texel2.rgb * intensity, texel2.a);\n        albedoTexel.a = texel2.a + (1.0 - texel2.a) * albedoTexel.a;\n    }}\n#endif\n    albedoColor *= albedoTexel;\n\n    vec3 baseColor = albedoColor.rgb;\n    albedoColor.rgb = baseColor * (1.0 - metalness);\n    vec3 specFactor = mix(vec3(0.04), baseColor, metalness);\n\n    float g = 1.0 - roughness;\n\n    vec3 N = v_Normal;\n\n#ifdef DOUBLE_SIDE\n    if (dot(N, V) < 0.0) {\n        N = -N;\n    }\n#endif\n\n    float ambientFactor = 1.0;\n\n#ifdef BUMPMAP_ENABLED\n    N = perturbNormalArb(v_WorldPosition, v_Normal, N);\n        ambientFactor = dot(v_Normal, N);\n#endif\n\n    vec3 diffuseTerm = vec3(0.0);\n    vec3 specularTerm = vec3(0.0);\n\n    float ndv = clamp(dot(N, V), 0.0, 1.0);\n    vec3 fresnelTerm = F_Schlick(ndv, specFactor);\n\n#ifdef AMBIENT_LIGHT_COUNT\n    for(int _idx_ = 0; _idx_ < AMBIENT_LIGHT_COUNT; _idx_++)\n    {{\n                        diffuseTerm += ambientLightColor[_idx_] * ambientFactor;\n    }}\n#endif\n\n#ifdef AMBIENT_SH_LIGHT_COUNT\n    for(int _idx_ = 0; _idx_ < AMBIENT_SH_LIGHT_COUNT; _idx_++)\n    {{\n        diffuseTerm += calcAmbientSHLight(_idx_, N) * ambientSHLightColor[_idx_];\n    }}\n#endif\n\n#ifdef DIRECTIONAL_LIGHT_COUNT\n#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)\n    float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];\n    if(shadowEnabled)\n    {\n        computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);\n    }\n#endif\n    for(int _idx_ = 0; _idx_ < DIRECTIONAL_LIGHT_COUNT; _idx_++)\n    {{\n        vec3 L = -directionalLightDirection[_idx_];\n        vec3 lc = directionalLightColor[_idx_];\n\n        vec3 H = normalize(L + V);\n        float ndl = clamp(dot(N, normalize(L)), 0.0, 1.0);\n        float ndh = clamp(dot(N, H), 0.0, 1.0);\n\n        float shadowContrib = 1.0;\n#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)\n        if (shadowEnabled)\n        {\n            shadowContrib = shadowContribsDir[_idx_];\n        }\n#endif\n\n        vec3 li = lc * ndl * shadowContrib;\n\n        diffuseTerm += li;\n        specularTerm += li * fresnelTerm * D_Phong(g, ndh);\n    }}\n#endif\n\n\n#ifdef AMBIENT_CUBEMAP_LIGHT_COUNT\n    vec3 L = reflect(-V, N);\n    float rough2 = clamp(1.0 - g, 0.0, 1.0);\n        float bias2 = rough2 * 5.0;\n        vec2 brdfParam2 = texture2D(ambientCubemapLightBRDFLookup[0], vec2(rough2, ndv)).xy;\n    vec3 envWeight2 = specFactor * brdfParam2.x + brdfParam2.y;\n    vec3 envTexel2;\n    for(int _idx_ = 0; _idx_ < AMBIENT_CUBEMAP_LIGHT_COUNT; _idx_++)\n    {{\n        envTexel2 = RGBMDecode(textureCubeLodEXT(ambientCubemapLightCubemap[_idx_], L, bias2), 51.5);\n                specularTerm += ambientCubemapLightColor[_idx_] * envTexel2 * envWeight2;\n    }}\n#endif\n\n    gl_FragColor.rgb = albedoColor.rgb * diffuseTerm + specularTerm;\n    gl_FragColor.a = albedoColor.a;\n\n    #ifdef SRGB_ENCODE\n    gl_FragColor = linearTosRGB(gl_FragColor);\n    #endif\n\n#if (LAYER_EMISSIVEMAP_COUNT > 0)\n    for (int _idx_ = 0; _idx_ < LAYER_EMISSIVEMAP_COUNT; _idx_++)\n    {{\n                vec4 texel2 = texture2D(layerEmissiveMap[_idx_], v_Texcoord) * layerEmissionIntensity[_idx_];\n        float intensity = layerEmissionIntensity[_idx_];\n        gl_FragColor.rgb += texel2.rgb * texel2.a * intensity;\n    }}\n#endif\n\n    @import ecgl.wireframe.common.fragmentMain\n}\n\n@end"},function(e,t){function r(e){return e.valueOf()/y-.5+x}function n(e){return r(e)-b}function i(e,t){return v(p(e)*f(w)-g(t)*p(w),f(e))}function a(e,t){return m(p(t)*f(w)+f(t)*p(w)*p(e))}function o(e,t,n){return v(p(e),f(e)*p(t)-g(n)*f(t))}function s(e,t,n){return m(p(t)*p(n)+f(t)*f(n)*f(e))}function u(e,t){return _*(280.16+360.9856235*e)-t}function l(e){return _*(357.5291+.98560028*e)}function h(e){return e+_*(1.9148*p(e)+.02*p(2*e)+3e-4*p(3*e))+102.9372*_+d}function c(e){var t=l(e),n=h(t);return{dec:a(n,0),ra:i(n,0)}}var d=Math.PI,p=Math.sin,f=Math.cos,g=Math.tan,m=Math.asin,v=Math.atan2,_=d/180,y=864e5,x=2440588,b=2451545,w=23.4397*_,C={};C.getPosition=function(e,t,i){var r=_*-i,a=_*t,l=n(e),d=c(l),h=u(l,r)-d.ra;return{azimuth:o(h,a,d.dec),altitude:s(h,a,d.dec)}},e.exports=C},function(e,t,i){"use strict";function n(e){return this._axes[e]}var r=i(14),o=function(e){this._axes={},this._dimList=[],this.name=e||""};o.prototype={constructor:o,type:"cartesian",getAxis:function(e){return this._axes[e]},getAxes:function(){return r.map(this._dimList,n,this)},getAxesByScale:function(e){return e=e.toLowerCase(),r.filter(this.getAxes(),function(t){return t.scale.type===e})},addAxis:function(e){var t=e.dim;this._axes[t]=e,this._dimList.push(t)},dataToCoord:function(e){return this._dataCoordConvert(e,"dataToCoord")},coordToData:function(e){return this._dataCoordConvert(e,"coordToData")},_dataCoordConvert:function(e,t){for(var n=this._dimList,i=e instanceof Array?[]:{},r=0;r<n.length;r++){var o=n[r],a=this._axes[o];i[o]=a[t](e[o])}return i}},e.exports=o},function(e,t,n){var i=n(14),r={Russia:[100,60],"United States":[-99,38],"United States of America":[-99,38]};e.exports=function(e){i.each(e.regions,function(e){var t=r[e.name];if(t){var n=e.center;n[0]=t[0],n[1]=t[1]}})}},function(e,t,n){var i=n(14),r={"南海诸岛":[32,80],"广东":[0,-10],"香港":[10,5],"澳门":[-10,10],"天津":[5,5]};e.exports=function(e){i.each(e.regions,function(e){var t=r[e.name];if(t){var n=e.center;n[0]+=t[0]/10.5,n[1]+=-t[1]/14}})}},function(e,t,r){"use strict";function n(e,t){this.id=null==e?"":e,this.inEdges=[],this.outEdges=[],this.edges=[],this.hostGraph,this.dataIndex=null==t?-1:t}function i(e,t,n){this.node1=e,this.node2=t,this.dataIndex=null==n?-1:n}var o=r(14),a=function(e){this._directed=e||!1,this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={},this.data,this.edgeData},s=a.prototype;s.type="graph",s.isDirected=function(){return this._directed},s.addNode=function(e,t){e=e||""+t;var i=this._nodesMap;if(!i[e]){var r=new n(e,t);return r.hostGraph=this,this.nodes.push(r),i[e]=r,r}},s.getNodeByIndex=function(e){var t=this.data.getRawIndex(e);return this.nodes[t]},s.getNodeById=function(e){return this._nodesMap[e]},s.addEdge=function(e,t,r){var o=this._nodesMap,a=this._edgesMap;if("number"==typeof e&&(e=this.nodes[e]),"number"==typeof t&&(t=this.nodes[t]),e instanceof n||(e=o[e]),t instanceof n||(t=o[t]),e&&t){var s=e.id+"-"+t.id;if(!a[s]){var l=new i(e,t,r);return l.hostGraph=this,this._directed&&(e.outEdges.push(l),t.inEdges.push(l)),e.edges.push(l),e!==t&&t.edges.push(l),this.edges.push(l),a[s]=l,l}}},s.getEdgeByIndex=function(e){var t=this.edgeData.getRawIndex(e);return this.edges[t]},s.getEdge=function(e,t){e instanceof n&&(e=e.id),t instanceof n&&(t=t.id);var i=this._edgesMap;return this._directed?i[e+"-"+t]:i[e+"-"+t]||i[t+"-"+e]},s.eachNode=function(e,t){for(var n=this.nodes,i=n.length,r=0;r<i;r++)n[r].dataIndex>=0&&e.call(t,n[r],r)},s.eachEdge=function(e,t){for(var n=this.edges,i=n.length,r=0;r<i;r++)n[r].dataIndex>=0&&n[r].node1.dataIndex>=0&&n[r].node2.dataIndex>=0&&e.call(t,n[r],r)},s.breadthFirstTraverse=function(e,t,i,r){if(t instanceof n||(t=this._nodesMap[t]),t){for(var o="out"===i?"outEdges":"in"===i?"inEdges":"edges",a=0;a<this.nodes.length;a++)this.nodes[a].__visited=!1;if(!e.call(r,t,null))for(var s=[t];s.length;)for(var l=s.shift(),c=l[o],a=0;a<c.length;a++){var u=c[a],d=u.node1===l?u.node2:u.node1;if(!d.__visited){if(e.call(d,d,l))return;s.push(d),d.__visited=!0}}}},s.update=function(){for(var e=this.data,t=this.edgeData,n=this.nodes,i=this.edges,r=0,o=n.length;r<o;r++)n[r].dataIndex=-1;for(var r=0,o=e.count();r<o;r++)n[e.getRawIndex(r)].dataIndex=r;t.filterSelf(function(e){var n=i[t.getRawIndex(e)];return n.node1.dataIndex>=0&&n.node2.dataIndex>=0});for(var r=0,o=i.length;r<o;r++)i[r].dataIndex=-1;for(var r=0,o=t.count();r<o;r++)i[t.getRawIndex(r)].dataIndex=r},s.clone=function(){for(var e=new a(this._directed),t=this.nodes,n=this.edges,i=0;i<t.length;i++)e.addNode(t[i].id,t[i].dataIndex);for(var i=0;i<n.length;i++){var r=n[i];e.addEdge(r.node1.id,r.node2.id,r.dataIndex)}return e},n.prototype={constructor:n,degree:function(){return this.edges.length},inDegree:function(){return this.inEdges.length},outDegree:function(){return this.outEdges.length},getModel:function(e){if(!(this.dataIndex<0))return this.hostGraph.data.getItemModel(this.dataIndex).getModel(e)}},i.prototype.getModel=function(e){if(!(this.dataIndex<0))return this.hostGraph.edgeData.getItemModel(this.dataIndex).getModel(e)};var l=function(e,t){return{getValue:function(n){var i=this[e][t];return i.get(i.getDimension(n||"value"),this.dataIndex)},setVisual:function(n,i){this.dataIndex>=0&&this[e][t].setItemVisual(this.dataIndex,n,i)},getVisual:function(n,i){return this[e][t].getItemVisual(this.dataIndex,n,i)},setLayout:function(n,i){this.dataIndex>=0&&this[e][t].setItemLayout(this.dataIndex,n,i)},getLayout:function(){return this[e][t].getItemLayout(this.dataIndex)},getGraphicEl:function(){return this[e][t].getItemGraphicEl(this.dataIndex)},getRawIndex:function(){return this[e][t].getRawIndex(this.dataIndex)}}};o.mixin(n,l("hostGraph","data")),o.mixin(i,l("hostGraph","edgeData")),a.Node=n,a.Edge=i,e.exports=a},function(e,t,r){function n(e){var t=e.mainData,n=e.datas;n||(n={main:t},e.datasAttr={main:"data"}),e.datas=e.mainData=null,l(t,n,e),d(n,function(n){d(t.TRANSFERABLE_METHODS,function(t){n.wrapMethod(t,c.curry(i,e))})}),t.wrapMethod("cloneShallow",c.curry(o,e)),d(t.CHANGABLE_METHODS,function(n){t.wrapMethod(n,c.curry(a,e))}),c.assert(n[t.dataType]===t)}function i(e,t){if(u(this)){var n=c.extend({},this[p]);n[this.dataType]=t,l(t,n,e)}else h(t,this.dataType,this[f],e);return t}function a(e,t){return e.struct&&e.struct.update(this),t}function o(e,t){return d(t[p],function(n,i){n!==t&&h(n.cloneShallow(),i,t,e)}),t}function s(e){var t=this[f];return null==e||null==t?t:t[p][e]}function u(e){return e[f]===e}function l(e,t,n){e[p]={},d(t,function(t,i){h(t,i,e,n)})}function h(e,t,n,i){n[p][t]=e,e[f]=n,e.dataType=t,i.struct&&(e[i.structAttr]=i.struct,i.struct[i.datasAttr[t]]=e),e.getLinkedData=s}var c=r(14),d=c.each,p="\0__link_datas",f="\0__link_mainData";e.exports=n},function(e,t,n){var i=n(14),r=n(68),o=n(222),a={};a.addCommas=function(e){return isNaN(e)?"-":(e=(e+"").split("."),e[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(e.length>1?"."+e[1]:""))},a.toCamelCase=function(e,t){return e=(e||"").toLowerCase().replace(/-(.)/g,function(e,t){return t.toUpperCase()}),t&&e&&(e=e.charAt(0).toUpperCase()+e.slice(1)),e},a.normalizeCssArray=function(e){var t=e.length;return"number"==typeof e?[e,e,e,e]:2===t?[e[0],e[1],e[0],e[1]]:3===t?[e[0],e[1],e[2],e[1]]:e};var s=a.encodeHTML=function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},l=["a","b","c","d","e","f","g"],c=function(e,t){return"{"+e+(null==t?"":t)+"}"};a.formatTpl=function(e,t,n){i.isArray(t)||(t=[t]);var r=t.length;if(!r)return"";for(var o=t[0].$vars||[],a=0;a<o.length;a++){var u=l[a],d=c(u,0);e=e.replace(c(u),n?s(d):d)}for(var h=0;h<r;h++)for(var p=0;p<o.length;p++){var d=t[h][o[p]];e=e.replace(c(l[p],h),n?s(d):d)}return e},a.formatTplSimple=function(e,t,n){return i.each(t,function(t,i){e=e.replace("{"+i+"}",n?s(t):t)}),e};var u=function(e){return e<10?"0"+e:e};a.formatTime=function(e,t,n){"week"!==e&&"month"!==e&&"quarter"!==e&&"half-year"!==e&&"year"!==e||(e="MM-dd\nyyyy");var i=r.parseDate(t),o=n?"UTC":"",a=i["get"+o+"FullYear"](),s=i["get"+o+"Month"]()+1,l=i["get"+o+"Date"](),c=i["get"+o+"Hours"](),d=i["get"+o+"Minutes"](),h=i["get"+o+"Seconds"]();return e=e.replace("MM",u(s)).toLowerCase().replace("yyyy",a).replace("yy",a%100).replace("dd",u(l)).replace("d",l).replace("hh",u(c)).replace("h",c).replace("mm",u(d)).replace("m",d).replace("ss",u(h)).replace("s",h)},a.capitalFirst=function(e){return e?e.charAt(0).toUpperCase()+e.substr(1):e},a.truncateText=o.truncateText,e.exports=a},function(e,t,r){"use strict";function n(e){var t;switch(e){case"byte":t=h.Int8Array;break;case"ubyte":t=h.Uint8Array;break;case"short":t=h.Int16Array;break;case"ushort":t=h.Uint16Array;break;default:t=h.Float32Array}return t}function i(e,t,n,i){this.name=e,this.type=t,this.size=n,i&&(this.semantic=i)}function a(e,t,n,r){switch(i.call(this,e,t,n,r),this.value=null,n){case 1:this.get=function(e){return this.value[e]},this.set=function(e,t){this.value[e]=t},this.copy=function(e,t){this.value[e]=this.value[e]};break;case 2:this.get=function(e,t){var n=this.value;return t[0]=n[2*e],t[1]=n[2*e+1],t},this.set=function(e,t){var n=this.value;n[2*e]=t[0],n[2*e+1]=t[1]},this.copy=function(e,t){var n=this.value;t*=2,e*=2,n[e]=n[t],n[e+1]=n[t+1]};break;case 3:this.get=function(e,t){var n=3*e,i=this.value;return t[0]=i[n++],t[1]=i[n++],t[2]=i[n++],t},this.set=function(e,t){var n=3*e,i=this.value;i[n++]=t[0],i[n++]=t[1],i[n++]=t[2]},this.copy=function(e,t){var n=this.value;t*=3,e*=3,n[e]=n[t],n[e+1]=n[t+1],n[e+2]=n[t+2]};break;case 4:this.get=function(e,t){var n=this.value,i=4*e;return t[0]=n[i++],t[1]=n[i++],t[2]=n[i++],t[3]=n[i++],t},this.set=function(e,t){var n=this.value,i=4*e;n[i++]=t[0],n[i++]=t[1],n[i++]=t[2],n[i++]=t[3]},this.copy=function(e,t){var n=this.value;t*=4,e*=4,n[e]=n[t],n[e+1]=n[t+1],n[e+2]=n[t+2],n[e+3]=n[t+3]}}}function o(e,t,n,i,r){this.name=e,this.type=t,this.buffer=n,this.size=i,this.semantic=r,this.symbol="",this.needsRemove=!1}function s(e){this.buffer=e,this.count=0}function u(){}var l=r(5),c=r(8),d=r(44),h=r(18);i.prototype.clone=function(e){return new this.constructor(this.name,this.type,this.size,this.semantic)},a.prototype.constructor=new i,a.prototype.init=function(e){if(!this.value||this.value.length!=e*this.size){var t=n(this.type);this.value=new t(e*this.size)}},a.prototype.fromArray=function(e){var t,i=n(this.type);if(e[0]&&e[0].length){var r=0,o=this.size;t=new i(e.length*o);for(var a=0;a<e.length;a++)for(var s=0;s<o;s++)t[r++]=e[a][s]}else t=new i(e);this.value=t};var p=l.extend({boundingBox:null,attributes:{},indices:null,dynamic:!1},function(){this._cache=new d,this._attributeList=Object.keys(this.attributes)},{pickByRay:null,pick:null,mainAttribute:"position",dirty:u,createAttribute:u,removeAttribute:u,getTriangleIndices:u,setTriangleIndices:u,isUseIndices:u,getEnabledAttributes:u,getBufferChunks:u,generateVertexNormals:u,generateFaceNormals:u,isUniqueVertex:u,generateUniqueVertex:u,generateTangents:u,generateBarycentric:u,applyTransform:u,dispose:u});p.STATIC_DRAW=c.STATIC_DRAW,p.DYNAMIC_DRAW=c.DYNAMIC_DRAW,p.STREAM_DRAW=c.STREAM_DRAW,p.AttributeBuffer=o,p.IndicesBuffer=s,p.Attribute=i,p.StaticAttribute=a,e.exports=p},function(e,t,n){"use strict";var i=n(21),r=n(32),o=r.extend(function(){return{name:"",inputs:{},outputs:null,shader:"",inputLinks:{},outputLinks:{},pass:null,_prevOutputTextures:{},_outputTextures:{},_outputReferences:{},_rendering:!1,_rendered:!1,_compositor:null}},function(){var e=new i({fragment:this.shader});this.pass=e},{render:function(e,t){this.trigger("beforerender",e),this._rendering=!0;var n=e.gl;for(var i in this.inputLinks){var r=this.inputLinks[i],o=r.node.getOutput(e,r.pin);this.pass.setUniform(i,o)}if(this.outputs){this.pass.outputs={};var a={};for(var s in this.outputs){var l=this.updateParameter(s,e);isNaN(l.width)&&this.updateParameter(s,e);var c=this.outputs[s],u=this._compositor.allocateTexture(l);this._outputTextures[s]=u;var d=c.attachment||n.COLOR_ATTACHMENT0;"string"==typeof d&&(d=n[d]),a[d]=u}this._compositor.getFrameBuffer().bind(e);for(var d in a)this._compositor.getFrameBuffer().attach(a[d],d);this.pass.render(e),this._compositor.getFrameBuffer().updateMipmap(e.gl)}else this.pass.outputs=null,this._compositor.getFrameBuffer().unbind(e),this.pass.render(e,t);for(var i in this.inputLinks){var r=this.inputLinks[i];r.node.removeReference(r.pin)}this._rendering=!1,this._rendered=!0,this.trigger("afterrender",e)},updateParameter:function(e,t){var n=this.outputs[e],i=n.parameters,r=n._parametersCopy;if(r||(r=n._parametersCopy={}),i)for(var o in i)"width"!==o&&"height"!==o&&(r[o]=i[o]);var a,s;return a=i.width instanceof Function?i.width.call(this,t):i.width,s=i.height instanceof Function?i.height.call(this,t):i.height,r.width===a&&r.height===s||this._outputTextures[e]&&this._outputTextures[e].dispose(t.gl),r.width=a,r.height=s,r},setParameter:function(e,t){this.pass.setUniform(e,t)},getParameter:function(e){return this.pass.getUniform(e)},setParameters:function(e){for(var t in e)this.setParameter(t,e[t])},setShader:function(e){var t=this.pass.material;t.shader.setFragment(e),t.attachShader(t.shader,!0)},shaderDefine:function(e,t){this.pass.material.shader.define("fragment",e,t)},shaderUndefine:function(e){this.pass.material.shader.undefine("fragment",e)},removeReference:function(e){0==--this._outputReferences[e]&&(this.outputs[e].keepLastFrame?(this._prevOutputTextures[e]&&this._compositor.releaseTexture(this._prevOutputTextures[e]),this._prevOutputTextures[e]=this._outputTextures[e]):this._compositor.releaseTexture(this._outputTextures[e]))},link:function(e,t,n){this.inputLinks[e]={node:t,pin:n},t.outputLinks[n]||(t.outputLinks[n]=[]),t.outputLinks[n].push({node:this,pin:e}),this.pass.material.shader.enableTexture(e)},clear:function(){r.prototype.clear.call(this),this.pass.material.shader.disableTexturesAll()},updateReference:function(e){if(!this._rendering){this._rendering=!0;for(var t in this.inputLinks){var n=this.inputLinks[t];n.node.updateReference(n.pin)}this._rendering=!1}e&&this._outputReferences[e]++},beforeFrame:function(){this._rendered=!1;for(var e in this.outputLinks)this._outputReferences[e]=0},afterFrame:function(){for(var e in this.outputLinks)if(this._outputReferences[e]>0){var t=this.outputs[e];t.keepLastFrame?(this._prevOutputTextures[e]&&this._compositor.releaseTexture(this._prevOutputTextures[e]),this._prevOutputTextures[e]=this._outputTextures[e]):this._compositor.releaseTexture(this._outputTextures[e])}}});e.exports=o},function(e,t,n){"use strict";var i=n(5),r=n(32),o=i.extend(function(){return{nodes:[]}},{dirty:function(){this._dirty=!0},addNode:function(e){this.nodes.indexOf(e)>=0||(this.nodes.push(e),this._dirty=!0)},removeNode:function(e){"string"==typeof e&&(e=this.getNodeByName(e));var t=this.nodes.indexOf(e);t>=0&&(this.nodes.splice(t,1),this._dirty=!0)},getNodeByName:function(e){for(var t=0;t<this.nodes.length;t++)if(this.nodes[t].name===e)return this.nodes[t]},update:function(){for(var e=0;e<this.nodes.length;e++)this.nodes[e].clear();for(var e=0;e<this.nodes.length;e++){var t=this.nodes[e];if(t.inputs)for(var n in t.inputs)if(t.inputs[n]&&(!t.pass||t.pass.material.isUniformEnabled(n))){var i=t.inputs[n],r=this.findPin(i);r&&t.link(n,r.node,r.pin)}}},findPin:function(e){var t;if(("string"==typeof e||e instanceof r)&&(e={node:e}),"string"==typeof e.node)for(var n=0;n<this.nodes.length;n++){var i=this.nodes[n];i.name===e.node&&(t=i)}else t=e.node;if(t){var o=e.pin;if(o||t.outputs&&(o=Object.keys(t.outputs)[0]),t.outputs[o])return{node:t,pin:o}}}});e.exports=o},function(e,t,n){"use strict";var i=n(32),r=n(17),o=n(8),a=n(11),s=i.extend({name:"scene",scene:null,camera:null,autoUpdateScene:!0,preZ:!1},function(){this.frameBuffer=new a},{render:function(e){this._rendering=!0;var t=e.gl;this.trigger("beforerender");var n;if(this.outputs){var i=this.frameBuffer;for(var a in this.outputs){var s=this.updateParameter(a,e),l=this.outputs[a],c=this._compositor.allocateTexture(s);this._outputTextures[a]=c;var u=l.attachment||t.COLOR_ATTACHMENT0;"string"==typeof u&&(u=t[u]),i.attach(c,u)}i.bind(e);var d=r.getExtension(t,"EXT_draw_buffers");if(d){var h=[];for(var u in this.outputs)(u=parseInt(u))>=t.COLOR_ATTACHMENT0&&u<=t.COLOR_ATTACHMENT0+8&&h.push(u);d.drawBuffersEXT(h)}e.saveClear(),e.clearBit=o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT,n=e.render(this.scene,this.camera,!this.autoUpdateScene,this.preZ),e.restoreClear(),i.unbind(e)}else n=e.render(this.scene,this.camera,!this.autoUpdateScene,this.preZ);this.trigger("afterrender",n),this._rendering=!1,this._rendered=!0}});e.exports=s},function(e,t,n){"use strict";var i=n(32),r=i.extend(function(){return{texture:null,outputs:{color:{}}}},function(){},{getOutput:function(e,t){return this.texture},beforeFrame:function(){},afterFrame:function(){}});e.exports=r},function(e,t,r){"use strict";function n(e,t,n){"object"==typeof t&&(n=t,t=null);var r,o=this;if(!(e instanceof Function)){r=[];for(var s in e)e.hasOwnProperty(s)&&r.push(s)}var l=function(t){if(o.apply(this,arguments),e instanceof Function?i(this,e.call(this,t)):a(this,e,r),this.constructor===l)for(var n=l.__initializers__,s=0;s<n.length;s++)n[s].apply(this,arguments)};l.__super__=o,o.__initializers__?l.__initializers__=o.__initializers__.slice():l.__initializers__=[],t&&l.__initializers__.push(t);var c=function(){};return c.prototype=o.prototype,l.prototype=new c,l.prototype.constructor=l,i(l.prototype,n),l.extend=o.extend,l.derive=o.extend,l}function i(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function a(e,t,n){for(var i=0;i<n.length;i++){var r=n[i];e[r]=t[r]}}e.exports={extend:n,derive:n}},function(e,t,n){"use strict";var i=n(16),r=i.extend({castShadow:!1},{type:"AMBIENT_LIGHT",uniformTemplates:{ambientLightColor:{type:"3f",value:function(e){var t=e.color,n=e.intensity;return[t[0]*n,t[1]*n,t[2]*n]}}}});e.exports=r},function(e,t,n){"use strict";var i=n(16),r=n(210),o=i.extend({cubemap:null,castShadow:!1,_normalDistribution:null,_brdfLookup:null},{type:"AMBIENT_CUBEMAP_LIGHT",prefilter:function(e,t){this._brdfLookup||(this._normalDistribution=r.generateNormalDistribution(),this._brdfLookup=r.integrateBRDF(e,this._normalDistribution));var n=this.cubemap;if(!n.__prefiltered){var i=r.prefilterEnvironmentMap(e,n,{encodeRGBM:!0,width:t,height:t},this._normalDistribution,this._brdfLookup);this.cubemap=i.environmentMap,this.cubemap.__prefiltered=!0,n.dispose(e.gl)}},uniformTemplates:{ambientCubemapLightColor:{type:"3f",value:function(e){var t=e.color,n=e.intensity;return[t[0]*n,t[1]*n,t[2]*n]}},ambientCubemapLightCubemap:{type:"t",value:function(e){return e.cubemap}},ambientCubemapLightBRDFLookup:{type:"t",value:function(e){return e._brdfLookup}}}});e.exports=o},function(e,t,n){"use strict";var i=n(16),r=n(18),o=i.extend({castShadow:!1,coefficients:[]},function(){this._coefficientsTmpArr=new r.Float32Array(27)},{type:"AMBIENT_SH_LIGHT",uniformTemplates:{ambientSHLightColor:{type:"3f",value:function(e){var t=e.color,n=e.intensity;return[t[0]*n,t[1]*n,t[2]*n]}},ambientSHLightCoefficients:{type:"3f",value:function(e){for(var t=e._coefficientsTmpArr,n=0;n<e.coefficients.length;n++)t[n]=e.coefficients[n];return t}}}});e.exports=o},function(e,t,r){"use strict";function n(e,t){return function(n){var i=n.getDevicePixelRatio(),r=n.getWidth(),o=n.getHeight(),a=t(r,o,i);this.setParameter(e,a)}}function i(e,t){return function(e){var n=e.getDevicePixelRatio(),i=e.getWidth(),r=e.getHeight();return t(i,r,n)}}function a(e){var t=/^expr\((.*)\)$/.exec(e);if(t)try{var n=new Function("width","height","dpr","return "+t[1]);return n(1,1),n}catch(e){throw new Error("Invalid expression.")}}var o=r(5),s=r(73),l=r(23),c=r(71),u=(r(32),r(179)),d=r(180),h=r(177),p=r(9),f=r(6),g=r(7),m=r(20),v=/#source\((.*?)\)/,_=/#url\((.*?)\)/,y=o.extend({rootPath:"",textureRootPath:"",shaderRootPath:"",scene:null,camera:null},{load:function(e){var t=this;this.rootPath||(this.rootPath=e.slice(0,e.lastIndexOf("/"))),s.get({url:e,onprogress:function(e,n,i){t.trigger("progress",e,n,i)},onerror:function(e){t.trigger("error",e)},responseType:"text",onload:function(e){t.parse(JSON.parse(e))}})},parse:function(e){var t=this,n=new c,i={textures:{},shaders:{},parameters:{}},r=function(r,o){for(var a=0;a<e.nodes.length;a++){var s=e.nodes[a],l=t._createNode(s,i);l&&n.addNode(l)}t.trigger("success",n)};for(var o in e.parameters){var a=e.parameters[o];i.parameters[o]=this._convertParameter(a)}return this._loadShaders(e,function(n){t._loadTextures(e,i,function(e){i.textures=e,i.shaders=n,r()})}),n},_createNode:function(e,t){var i,r,o,s=e.type||"filter";if("filter"===s){var l=e.shader.trim(),c=v.exec(l);if(c?i=p.source(c[1].trim()):"#"===l.charAt(0)&&(i=t.shaders[l.substr(1)]),i||(i=l),!i)return}if(e.inputs){r={};for(var f in e.inputs)"string"==typeof e.inputs[f]?r[f]=e.inputs[f]:r[f]={node:e.inputs[f].node,pin:e.inputs[f].pin}}if(e.outputs){o={};for(var f in e.outputs){var g=e.outputs[f];if(o[f]={},null!=g.attachment&&(o[f].attachment=g.attachment),null!=g.keepLastFrame&&(o[f].keepLastFrame=g.keepLastFrame),null!=g.outputLastFrame&&(o[f].outputLastFrame=g.outputLastFrame),"string"==typeof g.parameters){var m=g.parameters;"#"===m.charAt(0)&&(o[f].parameters=t.parameters[m.substr(1)])}else g.parameters&&(o[f].parameters=this._convertParameter(g.parameters))}}var _;if(_="scene"===s?new u({name:e.name,scene:this.scene,camera:this.camera,outputs:o}):"texture"===s?new d({name:e.name,outputs:o}):new h({name:e.name,shader:i,inputs:r,outputs:o})){if(e.parameters)for(var f in e.parameters){var y=e.parameters[f];"string"==typeof y&&(y=y.trim(),"#"===y.charAt(0)?y=t.textures[y.substr(1)]:_.on("beforerender",n(f,a(y)))),_.setParameter(f,y)}if(e.defines&&_.pass)for(var f in e.defines){var y=e.defines[f];_.pass.material.shader.define("fragment",f,y)}}return _},_convertParameter:function(e){var t={};return e?(["type","minFilter","magFilter","wrapS","wrapT","flipY","useMipmap"].forEach(function(n){var i=e[n];null!=i&&("string"==typeof i&&(i=f[i]),t[n]=i)}),["width","height"].forEach(function(n){if(null!=e[n]){var r=e[n];"string"==typeof r?(r=r.trim(),t[n]=i(n,a(r))):t[n]=r}}),null!=e.useMipmap&&(t.useMipmap=e.useMipmap),t):t},_loadShaders:function(e,t){if(!e.shaders)return void t({});var n={},i=0,r=!1,o=this.shaderRootPath||this.rootPath;l.each(e.shaders,function(e,a){var c=_.exec(e);if(c){var u=c[1];u=l.relative2absolute(u,o),i++,s.get({url:u,onload:function(e){n[a]=e,p.import(e),0==--i&&(t(n),r=!0)}})}else n[a]=e,p.import(e)},this),0!==i||r||t(n)},_loadTextures:function(e,t,n){if(!e.textures)return void n({});var i={},r=0,o=!1,a=this.textureRootPath||this.rootPath;l.each(e.textures,function(e,t){var s,c=e.path,u=this._convertParameter(e.parameters);if(c instanceof Array&&6===c.length)c=c.map(function(e){return l.relative2absolute(e,a)}),s=new m(u);else{if("string"!=typeof c)return;c=l.relative2absolute(c,a),s=new g(u)}s.load(c),r++,s.once("success",function(){i[t]=s,0==--r&&(n(i),o=!0)})},this),0!==r||o||n(i)}});e.exports=y},function(e,t,n){"use strict";var i=n(1),r=i.mat2,o=function(){this._array=r.create(),this._dirty=!0};o.prototype={constructor:o,setArray:function(e){for(var t=0;t<this._array.length;t++)this._array[t]=e[t];return this._dirty=!0,this},clone:function(){return(new o).copy(this)},copy:function(e){return r.copy(this._array,e._array),this._dirty=!0,this},adjoint:function(){return r.adjoint(this._array,this._array),this._dirty=!0,this},determinant:function(){return r.determinant(this._array)},identity:function(){return r.identity(this._array),this._dirty=!0,this},invert:function(){return r.invert(this._array,this._array),this._dirty=!0,this},mul:function(e){return r.mul(this._array,this._array,e._array),this._dirty=!0,this},mulLeft:function(e){return r.mul(this._array,e._array,this._array),this._dirty=!0,this},multiply:function(e){return r.multiply(this._array,this._array,e._array),this._dirty=!0,this},multiplyLeft:function(e){return r.multiply(this._array,e._array,this._array),this._dirty=!0,this},rotate:function(e){return r.rotate(this._array,this._array,e),this._dirty=!0,this},scale:function(e){return r.scale(this._array,this._array,e._array),this._dirty=!0,this},transpose:function(){return r.transpose(this._array,this._array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this._array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this._array)}},o.adjoint=function(e,t){return r.adjoint(e._array,t._array),e._dirty=!0,e},o.copy=function(e,t){return r.copy(e._array,t._array),e._dirty=!0,e},o.determinant=function(e){return r.determinant(e._array)},o.identity=function(e){return r.identity(e._array),e._dirty=!0,e},o.invert=function(e,t){return r.invert(e._array,t._array),e._dirty=!0,e},o.mul=function(e,t,n){return r.mul(e._array,t._array,n._array),e._dirty=!0,e},o.multiply=o.mul,o.rotate=function(e,t,n){return r.rotate(e._array,t._array,n),e._dirty=!0,e},o.scale=function(e,t,n){return r.scale(e._array,t._array,n._array),e._dirty=!0,e},o.transpose=function(e,t){return r.transpose(e._array,t._array),e._dirty=!0,e},e.exports=o},function(e,t,n){"use strict";var i=n(1),r=i.mat2d,o=function(){this._array=r.create(),this._dirty=!0};o.prototype={constructor:o,setArray:function(e){for(var t=0;t<this._array.length;t++)this._array[t]=e[t];return this._dirty=!0,this},clone:function(){return(new o).copy(this)},copy:function(e){return r.copy(this._array,e._array),this._dirty=!0,this},determinant:function(){return r.determinant(this._array)},identity:function(){return r.identity(this._array),this._dirty=!0,this},invert:function(){return r.invert(this._array,this._array),this._dirty=!0,this},mul:function(e){return r.mul(this._array,this._array,e._array),this._dirty=!0,this},mulLeft:function(e){return r.mul(this._array,e._array,this._array),this._dirty=!0,this},multiply:function(e){return r.multiply(this._array,this._array,e._array),this._dirty=!0,this},multiplyLeft:function(e){return r.multiply(this._array,e._array,this._array),this._dirty=!0,this},rotate:function(e){return r.rotate(this._array,this._array,e),this._dirty=!0,this},scale:function(e){return r.scale(this._array,this._array,e._array),this._dirty=!0,this},translate:function(e){return r.translate(this._array,this._array,e._array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this._array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this._array)}},o.copy=function(e,t){return r.copy(e._array,t._array),e._dirty=!0,e},o.determinant=function(e){return r.determinant(e._array)},o.identity=function(e){return r.identity(e._array),e._dirty=!0,e},o.invert=function(e,t){return r.invert(e._array,t._array),e._dirty=!0,e},o.mul=function(e,t,n){return r.mul(e._array,t._array,n._array),e._dirty=!0,e},o.multiply=o.mul,o.rotate=function(e,t,n){return r.rotate(e._array,t._array,n),e._dirty=!0,e},o.scale=function(e,t,n){return r.scale(e._array,t._array,n._array),e._dirty=!0,e},o.translate=function(e,t,n){return r.translate(e._array,t._array,n._array),e._dirty=!0,e},e.exports=o},function(e,t,n){"use strict";var i=n(1),r=i.mat3,o=function(){this._array=r.create(),this._dirty=!0};o.prototype={constructor:o,setArray:function(e){for(var t=0;t<this._array.length;t++)this._array[t]=e[t];return this._dirty=!0,this},adjoint:function(){return r.adjoint(this._array,this._array),this._dirty=!0,this},clone:function(){return(new o).copy(this)},copy:function(e){return r.copy(this._array,e._array),this._dirty=!0,this},determinant:function(){return r.determinant(this._array)},fromMat2d:function(e){return r.fromMat2d(this._array,e._array),this._dirty=!0,this},fromMat4:function(e){return r.fromMat4(this._array,e._array),this._dirty=!0,this},fromQuat:function(e){return r.fromQuat(this._array,e._array),this._dirty=!0,this},identity:function(){return r.identity(this._array),this._dirty=!0,this},invert:function(){return r.invert(this._array,this._array),this._dirty=!0,this},mul:function(e){return r.mul(this._array,this._array,e._array),this._dirty=!0,this},mulLeft:function(e){return r.mul(this._array,e._array,this._array),this._dirty=!0,this},multiply:function(e){return r.multiply(this._array,this._array,e._array),this._dirty=!0,this},multiplyLeft:function(e){return r.multiply(this._array,e._array,this._array),this._dirty=!0,this},rotate:function(e){return r.rotate(this._array,this._array,e),this._dirty=!0,this},scale:function(e){return r.scale(this._array,this._array,e._array),this._dirty=!0,this},translate:function(e){return r.translate(this._array,this._array,e._array),this._dirty=!0,this},normalFromMat4:function(e){return r.normalFromMat4(this._array,e._array),this._dirty=!0,this},transpose:function(){return r.transpose(this._array,this._array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this._array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this._array)}},o.adjoint=function(e,t){return r.adjoint(e._array,t._array),e._dirty=!0,e},o.copy=function(e,t){return r.copy(e._array,t._array),e._dirty=!0,e},o.determinant=function(e){return r.determinant(e._array)},o.identity=function(e){return r.identity(e._array),e._dirty=!0,e},o.invert=function(e,t){return r.invert(e._array,t._array),e},o.mul=function(e,t,n){return r.mul(e._array,t._array,n._array),e._dirty=!0,e},o.multiply=o.mul,o.fromMat2d=function(e,t){return r.fromMat2d(e._array,t._array),e._dirty=!0,e},o.fromMat4=function(e,t){return r.fromMat4(e._array,t._array),e._dirty=!0,e},o.fromQuat=function(e,t){return r.fromQuat(e._array,t._array),e._dirty=!0,e},o.normalFromMat4=function(e,t){return r.normalFromMat4(e._array,t._array),e._dirty=!0,e},o.rotate=function(e,t,n){return r.rotate(e._array,t._array,n),e._dirty=!0,e},o.scale=function(e,t,n){return r.scale(e._array,t._array,n._array),e._dirty=!0,e},o.transpose=function(e,t){return r.transpose(e._array,t._array),e._dirty=!0,e},o.translate=function(e,t,n){return r.translate(e._array,t._array,n._array),e._dirty=!0,e},e.exports=o},function(e,t,n){"use strict";var i=n(1),r=i.vec4,o=function(e,t,n,i){e=e||0,t=t||0,n=n||0,i=i||0,this._array=r.fromValues(e,t,n,i),this._dirty=!0};o.prototype={constructor:o,add:function(e){return r.add(this._array,this._array,e._array),this._dirty=!0,this},set:function(e,t,n,i){return this._array[0]=e,this._array[1]=t,this._array[2]=n,this._array[3]=i,this._dirty=!0,this},setArray:function(e){return this._array[0]=e[0],this._array[1]=e[1],this._array[2]=e[2],this._array[3]=e[3],this._dirty=!0,this},clone:function(){return new o(this.x,this.y,this.z,this.w)},copy:function(e){return r.copy(this._array,e._array),this._dirty=!0,this},dist:function(e){return r.dist(this._array,e._array)},distance:function(e){return r.distance(this._array,e._array)},div:function(e){return r.div(this._array,this._array,e._array),this._dirty=!0,this},divide:function(e){return r.divide(this._array,this._array,e._array),this._dirty=!0,this},dot:function(e){return r.dot(this._array,e._array)},len:function(){return r.len(this._array)},length:function(){return r.length(this._array)},lerp:function(e,t,n){return r.lerp(this._array,e._array,t._array,n),this._dirty=!0,this},min:function(e){return r.min(this._array,this._array,e._array),this._dirty=!0,this},max:function(e){return r.max(this._array,this._array,e._array),this._dirty=!0,this},mul:function(e){return r.mul(this._array,this._array,e._array),this._dirty=!0,this},multiply:function(e){return r.multiply(this._array,this._array,e._array),this._dirty=!0,this},negate:function(){return r.negate(this._array,this._array),this._dirty=!0,this},normalize:function(){return r.normalize(this._array,this._array),this._dirty=!0,this},random:function(e){return r.random(this._array,e),this._dirty=!0,this},scale:function(e){return r.scale(this._array,this._array,e),this._dirty=!0,this},scaleAndAdd:function(e,t){return r.scaleAndAdd(this._array,this._array,e._array,t),this._dirty=!0,this},sqrDist:function(e){return r.sqrDist(this._array,e._array)},squaredDistance:function(e){return r.squaredDistance(this._array,e._array)},sqrLen:function(){return r.sqrLen(this._array)},squaredLength:function(){return r.squaredLength(this._array)},sub:function(e){return r.sub(this._array,this._array,e._array),this._dirty=!0,this},subtract:function(e){return r.subtract(this._array,this._array,e._array),this._dirty=!0,this},transformMat4:function(e){return r.transformMat4(this._array,this._array,e._array),this._dirty=!0,this},transformQuat:function(e){return r.transformQuat(this._array,this._array,e._array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this._array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this._array)}};var a=Object.defineProperty;if(a){var s=o.prototype;a(s,"x",{get:function(){return this._array[0]},set:function(e){this._array[0]=e,this._dirty=!0}}),a(s,"y",{get:function(){return this._array[1]},set:function(e){this._array[1]=e,this._dirty=!0}}),a(s,"z",{get:function(){return this._array[2]},set:function(e){this._array[2]=e,this._dirty=!0}}),a(s,"w",{get:function(){return this._array[3]},set:function(e){this._array[3]=e,this._dirty=!0}})}o.add=function(e,t,n){return r.add(e._array,t._array,n._array),e._dirty=!0,e},o.set=function(e,t,n,i,o){r.set(e._array,t,n,i,o),e._dirty=!0},o.copy=function(e,t){return r.copy(e._array,t._array),e._dirty=!0,e},o.dist=function(e,t){return r.distance(e._array,t._array)},o.distance=o.dist,o.div=function(e,t,n){return r.divide(e._array,t._array,n._array),e._dirty=!0,e},o.divide=o.div,o.dot=function(e,t){return r.dot(e._array,t._array)},o.len=function(e){return r.length(e._array)},o.lerp=function(e,t,n,i){return r.lerp(e._array,t._array,n._array,i),e._dirty=!0,e},o.min=function(e,t,n){return r.min(e._array,t._array,n._array),e._dirty=!0,e},o.max=function(e,t,n){return r.max(e._array,t._array,n._array),e._dirty=!0,e},o.mul=function(e,t,n){return r.multiply(e._array,t._array,n._array),e._dirty=!0,e},o.multiply=o.mul,o.negate=function(e,t){return r.negate(e._array,t._array),e._dirty=!0,e},o.normalize=function(e,t){return r.normalize(e._array,t._array),e._dirty=!0,e},o.random=function(e,t){return r.random(e._array,t),e._dirty=!0,e},o.scale=function(e,t,n){return r.scale(e._array,t._array,n),e._dirty=!0,e},o.scaleAndAdd=function(e,t,n,i){return r.scaleAndAdd(e._array,t._array,n._array,i),e._dirty=!0,e},o.sqrDist=function(e,t){return r.sqrDist(e._array,t._array)},o.squaredDistance=o.sqrDist,o.sqrLen=function(e){return r.sqrLen(e._array)},o.squaredLength=o.sqrLen,o.sub=function(e,t,n){return r.subtract(e._array,t._array,n._array),e._dirty=!0,e},o.subtract=o.sub,o.transformMat4=function(e,t,n){return r.transformMat4(e._array,t._array,n._array),e._dirty=!0,e},o.transformQuat=function(e,t,n){return r.transformQuat(e._array,t._array,n._array),e._dirty=!0,e},e.exports=o},function(e,t,n){var i=n(5),r=n(56),o=n(24),a=n(3),s=n(10),l=n(70),c=n(8),u=i.extend({scene:null,camera:null,renderer:null},function(){this._ray=new r,this._ndc=new o},{pick:function(e,t,n){return this.pickAll(e,t,[],n)[0]||null},pickAll:function(e,t,n,i){return this.renderer.screenToNDC(e,t,this._ndc),this.camera.castRay(this._ndc,this._ray),n=n||[],this._intersectNode(this.scene,n,i||!1),n.sort(this._intersectionCompareFunc),n},_intersectNode:function(e,t,n){e instanceof l&&e.isRenderable()&&(e.ignorePicking&&!n||!(e.mode===c.TRIANGLES&&e.geometry.isUseIndices()||e.geometry.pickByRay||e.geometry.pick)||this._intersectRenderable(e,t));for(var i=0;i<e._children.length;i++)this._intersectNode(e._children[i],t,n)},_intersectRenderable:function(){var e=new a,t=new a,n=new a,i=new r,o=new s;return function(r,l){i.copy(this._ray),s.invert(o,r.worldTransform),i.applyTransform(o);var d=r.geometry;if(!d.boundingBox||i.intersectBoundingBox(d.boundingBox)){if(d.pick)return void d.pick(this._ndc.x,this._ndc.y,this.renderer,this.camera,r,l);if(d.pickByRay)return void d.pickByRay(i,r,l);var h,p=r.cullFace===c.BACK&&r.frontFace===c.CCW||r.cullFace===c.FRONT&&r.frontFace===c.CW,f=d.indices,g=d.attributes.position;if(g&&g.value&&f)for(var m=0;m<f.length;m+=3){var v=f[m],_=f[m+1],y=f[m+2];if(g.get(v,e._array),g.get(_,t._array),g.get(y,n._array),h=p?i.intersectTriangle(e,t,n,r.culling):i.intersectTriangle(e,n,t,r.culling)){var x=new a;a.transformMat4(x,h,r.worldTransform),l.push(new u.Intersection(h,x,r,[v,_,y],m/3,a.dist(x,this._ray.origin)))}}}}}(),_intersectionCompareFunc:function(e,t){return e.distance-t.distance}});u.Intersection=function(e,t,n,i,r,o){this.point=e,this.pointWorld=t,this.target=n,this.triangle=i,this.triangleIndex=r,this.distance=o},e.exports=u},function(e,t,n){var r=n(5),o=n(8),a=n(3),s=n(13),l=n(54),c=n(10),u=n(51),d=n(9),h=(n(16),n(29),n(78)),p=n(76),f=n(77),g=(n(81),n(19)),m=n(11),v=n(6),_=n(7),y=n(20),x=n(43),b=n(42),w=n(21),C=n(72),S=n(1),T=S.mat4,A=(S.vec3,["px","nx","py","ny","pz","nz"]);d.import(n(207));var M=r.extend(function(){return{softShadow:M.PCF,shadowBlur:1,lightFrustumBias:2,kernelPCF:new Float32Array([1,0,1,1,-1,1,0,1,-1,0,-1,-1,1,-1,0,-1]),_frameBuffer:new m,_textures:{},_shadowMapNumber:{POINT_LIGHT:0,DIRECTIONAL_LIGHT:0,SPOT_LIGHT:0},_meshMaterials:{},_depthMaterials:{},_depthShaders:{},_distanceMaterials:{},_opaqueCasters:[],_receivers:[],_lightsCastShadow:[],_lightCameras:{},_texturePool:new C}},function(){this._gaussianPassH=new w({fragment:d.source("qtek.compositor.gaussian_blur")}),this._gaussianPassV=new w({fragment:d.source("qtek.compositor.gaussian_blur")}),this._gaussianPassH.setUniform("blurSize",this.shadowBlur),this._gaussianPassH.setUniform("blurDir",0),this._gaussianPassV.setUniform("blurSize",this.shadowBlur),this._gaussianPassV.setUniform("blurDir",1),this._outputDepthPass=new w({fragment:d.source("qtek.sm.debug_depth")})},{render:function(e,t,n,i){this.trigger("beforerender",this,e,t,n),this._renderShadowPass(e,t,n,i),this.trigger("afterrender",this,e,t,n)},renderDebug:function(e,t){e.saveClear();var n=e.viewport,i=0,r=t||n.width/4,o=r;this.softShadow===M.VSM?this._outputDepthPass.material.shader.define("fragment","USE_VSM"):this._outputDepthPass.material.shader.undefine("fragment","USE_VSM");for(var a in this._textures){var s=this._textures[a];e.setViewport(i,0,r*s.width/s.height,o),this._outputDepthPass.setUniform("depthMap",s),this._outputDepthPass.render(e),i+=r*s.width/s.height}e.setViewport(n),e.restoreClear()},_bindDepthMaterial:function(e,t,n){for(var i=0;i<e.length;i++){var r,o,a=e[i],s=a.material.shadowTransparentMap instanceof _,l=a.material.shadowTransparentMap,c=a.joints&&a.joints.length;s?(r=c+"-"+l.__GUID__,o=c+"s"):(r=c,o=c);var u=this._depthMaterials[r],h=this._depthShaders[o];a.material!==u&&(h||(h=new d({vertex:d.source("qtek.sm.depth.vertex"),fragment:d.source("qtek.sm.depth.fragment")}),c>0&&(h.define("vertex","SKINNING"),h.define("vertex","JOINT_COUNT",c)),s&&h.define("both","SHADOW_TRANSPARENT"),this._depthShaders[o]=h),u||(u=new g({shader:h}),this._depthMaterials[r]=u),a.material=u,this.softShadow===M.VSM?h.define("fragment","USE_VSM"):h.undefine("fragment","USE_VSM"),u.setUniform("bias",t),u.setUniform("slopeScale",n),s&&u.set("shadowTransparentMap",l))}},_bindDistanceMaterial:function(e,t){for(var n=t.getWorldPosition()._array,i=0;i<e.length;i++){var r=e[i],o=r.joints&&r.joints.length,a=this._distanceMaterials[o];r.material!==a&&(a||(a=new g({shader:new d({vertex:d.source("qtek.sm.distance.vertex"),fragment:d.source("qtek.sm.distance.fragment")})}),o>0&&(a.shader.define("vertex","SKINNING"),a.shader.define("vertex","JOINT_COUNT",o)),this._distanceMaterials[o]=a),r.material=a,this.softShadow===M.VSM?a.shader.define("fragment","USE_VSM"):a.shader.undefine("fragment","USE_VSM")),a.set("lightPosition",n),a.set("range",t.range)}},saveMaterial:function(e){for(var t=0;t<e.length;t++){var n=e[t];this._meshMaterials[n.__GUID__]=n.material}},restoreMaterial:function(e){for(var t=0;t<e.length;t++){var n=e[t],i=this._meshMaterials[n.__GUID__];i&&(n.material=i)}},_updateCasterAndReceiver:function(e){e.castShadow&&this._opaqueCasters.push(e),e.receiveShadow?(this._receivers.push(e),e.material.set("shadowEnabled",1),e.material.set("pcfKernel",this.kernelPCF)):e.material.set("shadowEnabled",0);var t=e.material.shader;if(this.softShadow===M.VSM)t.define("fragment","USE_VSM"),t.undefine("fragment","PCF_KERNEL_SIZE");else{t.undefine("fragment","USE_VSM");var n=this.kernelPCF;n&&n.length?t.define("fragment","PCF_KERNEL_SIZE",n.length/2):t.undefine("fragment","PCF_KERNEL_SIZE")}},_update:function(e){for(var t=0;t<e.opaqueQueue.length;t++)this._updateCasterAndReceiver(e.opaqueQueue[t]);for(var t=0;t<e.transparentQueue.length;t++)this._updateCasterAndReceiver(e.transparentQueue[t]);for(var t=0;t<e.lights.length;t++){var n=e.lights[t];n.castShadow&&this._lightsCastShadow.push(n)}},_renderShadowPass:function(e,t,n,r){function i(e){return e.height}for(var o in this._shadowMapNumber)this._shadowMapNumber[o]=0;this._lightsCastShadow.length=0,this._opaqueCasters.length=0,this._receivers.length=0;var a=e.gl;if(r||t.update(),this._update(t),this._lightsCastShadow.length){a.enable(a.DEPTH_TEST),a.depthMask(!0),a.disable(a.BLEND),a.clearColor(1,1,1,1);var s=[],l=[],c=[],u=[],d=[],g=[];this.saveMaterial(this._opaqueCasters);for(var m,v=0;v<this._lightsCastShadow.length;v++){var _=this._lightsCastShadow[v];if(_ instanceof p){if(m)continue;if(_.shadowCascade>1&&(m=_,_.shadowCascade>4))continue;this.renderDirectionalLightShadow(e,t,n,_,this._opaqueCasters,d,u,c)}else _ instanceof h?this.renderSpotLightShadow(e,_,this._opaqueCasters,l,s):_ instanceof f&&this.renderPointLightShadow(e,_,this._opaqueCasters,g);this._shadowMapNumber[_.type]++}this.restoreMaterial(this._opaqueCasters);var y=d.slice(),x=d.slice();y.pop(),x.shift(),y.reverse(),x.reverse(),u.reverse();for(var b=s.map(i),w=c.map(i),C={},v=0;v<this._receivers.length;v++){var S=this._receivers[v],T=S.material,A=T.shader;if(!C[A.__GUID__]){var M=!1;for(var E in this._shadowMapNumber){var I=this._shadowMapNumber[E],D=E+"_SHADOWMAP_COUNT";A.fragmentDefines[D]!==I&&I>0&&(A.fragmentDefines[D]=I,M=!0)}M&&A.dirty(),m?A.define("fragment","SHADOW_CASCADE",m.shadowCascade):A.undefine("fragment","SHADOW_CASCADE"),C[A.__GUID__]=!0}s.length>0&&(T.setUniform("spotLightShadowMaps",s),T.setUniform("spotLightMatrices",l),T.setUniform("spotLightShadowMapSizes",b)),c.length>0&&(T.setUniform("directionalLightShadowMaps",c),m&&(T.setUniform("shadowCascadeClipsNear",y),T.setUniform("shadowCascadeClipsFar",x)),T.setUniform("directionalLightMatrices",u),T.setUniform("directionalLightShadowMapSizes",w)),g.length>0&&T.setUniform("pointLightShadowMaps",g)}}},renderDirectionalLightShadow:function(){var e=new l,t=new c,n=new s,i=new c,r=new c,o=new c,a=new c;return function(s,l,d,h,p,f,g,m){var v=h.shadowBias;this._bindDepthMaterial(p,v,h.shadowSlopeScale),p.sort(u.opaqueSortFunc);var _=Math.min(-l.viewBoundingBoxLastFrame.min.z,d.far),y=Math.max(-l.viewBoundingBoxLastFrame.max.z,d.near),x=this._getDirectionalLightCamera(h,l,d),b=o._array;a.copy(x.projectionMatrix),T.invert(r._array,x.worldTransform._array),T.multiply(r._array,r._array,d.worldTransform._array),T.multiply(b,a._array,r._array);for(var w=[],C=d.fov/180*Math.PI,S=d.aspect,A=(d.near+d.far)/(d.near-d.far),E=2*d.near*d.far/(d.near-d.far),I=0;I<=h.shadowCascade;I++){var D=y*Math.pow(_/y,I/h.shadowCascade),k=y+(_-y)*I/h.shadowCascade,L=D*h.cascadeSplitLogFactor+k*(1-h.cascadeSplitLogFactor);w.push(L),f.push(-(-L*A+E)/-L)}var N=this._getTexture(h,h.shadowCascade);m.push(N);var P=s.viewport,O=s.gl;this._frameBuffer.attach(N),this._frameBuffer.bind(s),O.clear(O.COLOR_BUFFER_BIT|O.DEPTH_BUFFER_BIT);for(var I=0;I<h.shadowCascade;I++){var R=w[I],z=w[I+1];T.perspective(t._array,C,S,R,z),e.setFromProjection(t),e.getTransformedBoundingBox(n,r),n.applyProjection(a);var F=n.min._array,B=n.max._array;i.ortho(F[0],B[0],F[1],B[1],1,-1),x.projectionMatrix.multiplyLeft(i);var H=h.shadowResolution||512;s.setViewport((h.shadowCascade-I-1)*H,0,H,H,1);for(var V in this._depthMaterials)this._depthMaterials[V].set("shadowBias",v);s.renderQueue(p,x),this.softShadow===M.VSM&&this._gaussianFilter(s,N,N.width);var W=new c;W.copy(x.worldTransform).invert().multiplyLeft(x.projectionMatrix),g.push(W._array),x.projectionMatrix.copy(a)}this._frameBuffer.unbind(s),s.setViewport(P)}}(),renderSpotLightShadow:function(e,t,n,i,r){this._bindDepthMaterial(n,t.shadowBias,t.shadowSlopeScale),n.sort(u.opaqueSortFunc);var o=this._getTexture(t),a=this._getSpotLightCamera(t),s=e.gl;this._frameBuffer.attach(o),this._frameBuffer.bind(e),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),e.renderQueue(n,a),this._frameBuffer.unbind(e),this.softShadow===M.VSM&&this._gaussianFilter(e,o,o.width);var l=new c;l.copy(a.worldTransform).invert().multiplyLeft(a.projectionMatrix),r.push(o),i.push(l._array)},renderPointLightShadow:function(e,t,n,i){var r=this._getTexture(t),o=e.gl;i.push(r),this._bindDistanceMaterial(n,t);for(var a=0;a<6;a++){var s=A[a],l=this._getPointLightCamera(t,s);this._frameBuffer.attach(r,o.COLOR_ATTACHMENT0,o.TEXTURE_CUBE_MAP_POSITIVE_X+a),this._frameBuffer.bind(e),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),e.renderQueue(n,l)}this._frameBuffer.unbind(e)},_gaussianFilter:function(e,t,n){var i={width:n,height:n,type:v.FLOAT},r=(e.gl,this._texturePool.get(i));this._frameBuffer.attach(r),this._frameBuffer.bind(e),this._gaussianPassH.setUniform("texture",t),this._gaussianPassH.setUniform("textureWidth",n),this._gaussianPassH.render(e),this._frameBuffer.attach(t),this._gaussianPassV.setUniform("texture",r),this._gaussianPassV.setUniform("textureHeight",n),this._gaussianPassV.render(e),this._frameBuffer.unbind(e),this._texturePool.put(r)},_getTexture:function(e,t){var n=e.__GUID__,i=this._textures[n],r=e.shadowResolution||512;return t=t||1,i||(i=e instanceof f?new y:new _,i.width=r*t,i.height=r,this.softShadow===M.VSM?(i.type=v.FLOAT,i.anisotropic=4):(i.minFilter=o.NEAREST,i.magFilter=o.NEAREST,i.useMipmap=!1),this._textures[n]=i),i},_getPointLightCamera:function(e,t){this._lightCameras.point||(this._lightCameras.point={px:new x,nx:new x,py:new x,ny:new x,pz:new x,nz:new x});var n=this._lightCameras.point[t];switch(n.far=e.range,n.fov=90,n.position.set(0,0,0),t){case"px":n.lookAt(a.POSITIVE_X,a.NEGATIVE_Y);break;case"nx":n.lookAt(a.NEGATIVE_X,a.NEGATIVE_Y);break;case"py":n.lookAt(a.POSITIVE_Y,a.POSITIVE_Z);break;case"ny":n.lookAt(a.NEGATIVE_Y,a.NEGATIVE_Z);break;case"pz":n.lookAt(a.POSITIVE_Z,a.NEGATIVE_Y);break;case"nz":n.lookAt(a.NEGATIVE_Z,a.NEGATIVE_Y)}return e.getWorldPosition(n.position),n.update(),n},_getDirectionalLightCamera:function(){var e=new c,t=new s,n=new s;return function(i,r,o){this._lightCameras.directional||(this._lightCameras.directional=new b);var a=this._lightCameras.directional;t.copy(r.viewBoundingBoxLastFrame),t.intersection(o.frustum.boundingBox),a.position.copy(t.min).add(t.max).scale(.5).transformMat4(o.worldTransform),a.rotation.copy(i.rotation),a.scale.copy(i.scale),a.updateLocalTransform(),a.updateWorldTransform(),e.copy(a.worldTransform).invert().multiply(o.worldTransform),n.copy(t).applyTransform(e);var s=n.min._array,l=n.max._array;return a.position.scaleAndAdd(a.worldTransform.z,l[2]+this.lightFrustumBias),a.near=0,a.far=-s[2]+l[2]+this.lightFrustumBias,a.left=s[0]-this.lightFrustumBias,a.right=l[0]+this.lightFrustumBias,a.top=l[1]+this.lightFrustumBias,a.bottom=s[1]-this.lightFrustumBias,a.update(!0),a}}(),_getSpotLightCamera:function(e){this._lightCameras.spot||(this._lightCameras.spot=new x);var t=this._lightCameras.spot;return t.fov=2*e.penumbraAngle,t.far=e.range,t.worldTransform.copy(e.worldTransform),t.updateProjectionMatrix(),T.invert(t.viewMatrix._array,t.worldTransform._array),t},dispose:function(e){var t=e.gl||e;for(var n in this._depthMaterials){var i=this._depthMaterials[n];i.dispose(t)}for(var n in this._distanceMaterials){var i=this._distanceMaterials[n];i.dispose(t)}this._frameBuffer&&this._frameBuffer.dispose(t);for(var r in this._textures)this._textures[r].dispose(t);this._texturePool.clear(e.gl),this._depthMaterials={},this._distanceMaterials={},this._textures={},this._lightCameras={},this._shadowMapNumber={POINT_LIGHT:0,DIRECTIONAL_LIGHT:0,SPOT_LIGHT:0},this._meshMaterials={};for(var o=0;o<this._receivers.length;o++){var a=this._receivers[o];if(a.material&&a.material.shader){var s=a.material,l=s.shader;l.undefine("fragment","POINT_LIGHT_SHADOW_COUNT"),l.undefine("fragment","DIRECTIONAL_LIGHT_SHADOW_COUNT"),l.undefine("fragment","AMBIENT_LIGHT_SHADOW_COUNT"),s.set("shadowEnabled",0)}}this._opaqueCasters=[],this._receivers=[],this._lightsCastShadow=[]}});M.VSM=1,M.PCF=2,e.exports=M},function(e,t){e.exports="@export qtek.basic.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\nuniform vec2 uvRepeat : [1.0, 1.0];\nuniform vec2 uvOffset : [0.0, 0.0];\n\nattribute vec2 texcoord : TEXCOORD_0;\nattribute vec3 position : POSITION;\n\nattribute vec3 barycentric;\n\n#ifdef SKINNING\nattribute vec3 weight : WEIGHT;\nattribute vec4 joint : JOINT;\n\nuniform mat4 skinMatrix[JOINT_COUNT] : SKIN_MATRIX;\n#endif\n\nvarying vec2 v_Texcoord;\nvarying vec3 v_Barycentric;\n\nvoid main()\n{\n    vec3 skinnedPosition = position;\n\n#ifdef SKINNING\n    @import qtek.chunk.skin_matrix\n\n    skinnedPosition = (skinMatrixWS * vec4(position, 1.0)).xyz;\n#endif\n\n    v_Texcoord = texcoord * uvRepeat + uvOffset;\n    v_Barycentric = barycentric;\n\n    gl_Position = worldViewProjection * vec4(skinnedPosition, 1.0);\n}\n\n@end\n\n\n\n\n@export qtek.basic.fragment\n\nvarying vec2 v_Texcoord;\nuniform sampler2D diffuseMap;\nuniform vec3 color : [1.0, 1.0, 1.0];\nuniform vec3 emission : [0.0, 0.0, 0.0];\nuniform float alpha : 1.0;\n\nuniform float lineWidth : 0.0;\nuniform vec3 lineColor : [0.0, 0.0, 0.0];\nvarying vec3 v_Barycentric;\n\n@import qtek.util.edge_factor\n\n@import qtek.util.rgbm\n\n@import qtek.util.srgb\n\nvoid main()\n{\n\n#ifdef RENDER_TEXCOORD\n    gl_FragColor = vec4(v_Texcoord, 1.0, 1.0);\n    return;\n#endif\n\n    gl_FragColor = vec4(color, alpha);\n\n#ifdef DIFFUSEMAP_ENABLED\n    vec4 tex = decodeHDR(texture2D(diffuseMap, v_Texcoord));\n\n#ifdef SRGB_DECODE\n    tex = sRGBToLinear(tex);\n#endif\n\n#if defined(DIFFUSEMAP_ALPHA_ALPHA)\n    gl_FragColor.a = tex.a;\n#endif\n\n    gl_FragColor.rgb *= tex.rgb;\n#endif\n\n    gl_FragColor.rgb += emission;\n    if( lineWidth > 0.01)\n    {\n        gl_FragColor.rgb = gl_FragColor.rgb * mix(lineColor, vec3(1.0), edgeFactor(lineWidth));\n    }\n\n#ifdef GAMMA_ENCODE\n        gl_FragColor.rgb = pow(gl_FragColor.rgb, vec3(1 / 2.2));\n#endif\n\n    gl_FragColor = encodeHDR(gl_FragColor);\n\n}\n\n@end"},function(e,t){e.exports="@export qtek.compositor.blend\n#ifdef TEXTURE1_ENABLED\nuniform sampler2D texture1;\nuniform float weight1 : 1.0;\n#endif\n#ifdef TEXTURE2_ENABLED\nuniform sampler2D texture2;\nuniform float weight2 : 1.0;\n#endif\n#ifdef TEXTURE3_ENABLED\nuniform sampler2D texture3;\nuniform float weight3 : 1.0;\n#endif\n#ifdef TEXTURE4_ENABLED\nuniform sampler2D texture4;\nuniform float weight4 : 1.0;\n#endif\n#ifdef TEXTURE5_ENABLED\nuniform sampler2D texture5;\nuniform float weight5 : 1.0;\n#endif\n#ifdef TEXTURE6_ENABLED\nuniform sampler2D texture6;\nuniform float weight6 : 1.0;\n#endif\n\nvarying vec2 v_Texcoord;\n\n@import qtek.util.rgbm\n\nvoid main()\n{\n    vec4 tex = vec4(0.0);\n#ifdef TEXTURE1_ENABLED\n    tex += decodeHDR(texture2D(texture1, v_Texcoord)) * weight1;\n#endif\n#ifdef TEXTURE2_ENABLED\n    tex += decodeHDR(texture2D(texture2, v_Texcoord)) * weight2;\n#endif\n#ifdef TEXTURE3_ENABLED\n    tex += decodeHDR(texture2D(texture3, v_Texcoord)) * weight3;\n#endif\n#ifdef TEXTURE4_ENABLED\n    tex += decodeHDR(texture2D(texture4, v_Texcoord)) * weight4;\n#endif\n#ifdef TEXTURE5_ENABLED\n    tex += decodeHDR(texture2D(texture5, v_Texcoord)) * weight5;\n#endif\n#ifdef TEXTURE6_ENABLED\n    tex += decodeHDR(texture2D(texture6, v_Texcoord)) * weight6;\n#endif\n\n    gl_FragColor = encodeHDR(tex);\n}\n@end"},function(e,t){e.exports="@export qtek.compositor.kernel.gaussian_9\nfloat gaussianKernel[9];\ngaussianKernel[0] = 0.07;\ngaussianKernel[1] = 0.09;\ngaussianKernel[2] = 0.12;\ngaussianKernel[3] = 0.14;\ngaussianKernel[4] = 0.16;\ngaussianKernel[5] = 0.14;\ngaussianKernel[6] = 0.12;\ngaussianKernel[7] = 0.09;\ngaussianKernel[8] = 0.07;\n@end\n\n@export qtek.compositor.kernel.gaussian_13\n\nfloat gaussianKernel[13];\n\ngaussianKernel[0] = 0.02;\ngaussianKernel[1] = 0.03;\ngaussianKernel[2] = 0.06;\ngaussianKernel[3] = 0.08;\ngaussianKernel[4] = 0.11;\ngaussianKernel[5] = 0.13;\ngaussianKernel[6] = 0.14;\ngaussianKernel[7] = 0.13;\ngaussianKernel[8] = 0.11;\ngaussianKernel[9] = 0.08;\ngaussianKernel[10] = 0.06;\ngaussianKernel[11] = 0.03;\ngaussianKernel[12] = 0.02;\n\n@end\n\n\n@export qtek.compositor.gaussian_blur\n\nuniform sampler2D texture; varying vec2 v_Texcoord;\n\nuniform float blurSize : 2.0;\nuniform vec2 textureSize : [512.0, 512.0];\nuniform float blurDir : 0.0;\n\n@import qtek.util.rgbm\n@import qtek.util.clamp_sample\n\nvoid main (void)\n{\n    @import qtek.compositor.kernel.gaussian_9\n\n    vec2 off = blurSize / textureSize;\n    off *= vec2(1.0 - blurDir, blurDir);\n\n    vec4 sum = vec4(0.0);\n    float weightAll = 0.0;\n\n        for (int i = 0; i < 9; i++) {\n        float w = gaussianKernel[i];\n                sum += decodeHDR(clampSample(texture, v_Texcoord + float(i - 4) * off)) * w;\n        weightAll += w;\n    }\n    gl_FragColor = encodeHDR(sum / weightAll);\n}\n\n@end\n\n@export qtek.compositor.box_blur\n\nuniform sampler2D texture;\nvarying vec2 v_Texcoord;\n\nuniform float blurSize : 3.0;\nuniform vec2 textureSize : [512.0, 512.0];\n\n@import qtek.util.rgbm\n@import qtek.util.clamp_sample\n\nvoid main(void)\n{\n\n    vec4 tex = decodeHDR(texture2D(texture, v_Texcoord));\n    vec2 offset = blurSize / textureSize;\n\n    tex += decodeHDR(clampSample(texture, v_Texcoord + vec2(offset.x, 0.0) ));\n    tex += decodeHDR(clampSample(texture, v_Texcoord + vec2(offset.x, offset.y) ));\n    tex += decodeHDR(clampSample(texture, v_Texcoord + vec2(-offset.x, offset.y) ));\n    tex += decodeHDR(clampSample(texture, v_Texcoord + vec2(0.0, offset.y) ));\n    tex += decodeHDR(clampSample(texture, v_Texcoord + vec2(-offset.x, 0.0) ));\n    tex += decodeHDR(clampSample(texture, v_Texcoord + vec2(-offset.x, -offset.y) ));\n    tex += decodeHDR(clampSample(texture, v_Texcoord + vec2(offset.x, -offset.y) ));\n    tex += decodeHDR(clampSample(texture, v_Texcoord + vec2(0.0, -offset.y) ));\n\n    tex /= 9.0;\n\n    \n    gl_FragColor = encodeHDR(tex);\n}\n\n@end"},function(e,t){e.exports="@export qtek.compositor.bright\n\nuniform sampler2D texture;\n\nuniform float threshold : 1;\nuniform float scale : 1.0;\n\nuniform vec2 textureSize: [512, 512];\n\nvarying vec2 v_Texcoord;\n\nconst vec3 lumWeight = vec3(0.2125, 0.7154, 0.0721);\n\n@import qtek.util.rgbm\n\n\nvec3 median(vec3 a, vec3 b, vec3 c)\n{\n    return a + b + c - min(min(a, b), c) - max(max(a, b), c);\n}\n\nvoid main()\n{\n    vec3 texel = decodeHDR(texture2D(texture, v_Texcoord)).rgb;\n\n#ifdef ANTI_FLICKER\n            vec3 d = 1.0 / textureSize.xyx * vec3(1.0, 1.0, 0.0);\n\n    vec3 s1 = decodeHDR(texture2D(texture, v_Texcoord - d.xz)).rgb;\n    vec3 s2 = decodeHDR(texture2D(texture, v_Texcoord + d.xz)).rgb;\n    vec3 s3 = decodeHDR(texture2D(texture, v_Texcoord - d.zy)).rgb;\n    vec3 s4 = decodeHDR(texture2D(texture, v_Texcoord + d.zy)).rgb;\n    texel = median(median(texel, s1, s2), s3, s4);\n\n#endif\n\n    float lum = dot(texel, lumWeight);\n    vec4 color;\n    if (lum > threshold)\n    {\n        color.rgb = texel * scale;\n    }\n    else\n    {\n        color.rgb = vec3(0.0);\n    }\n    color.a = 1.0;\n\n    gl_FragColor = encodeHDR(color);\n}\n@end\n"},function(e,t){e.exports="@export qtek.compositor.dof.coc\n\nuniform sampler2D depth;\n\nuniform float zNear: 0.1;\nuniform float zFar: 2000;\n\nuniform float focalDist: 3;\nuniform float focalRange: 1;\nuniform float focalLength: 30;\nuniform float fstop: 2.8;\n\nvarying vec2 v_Texcoord;\n\n@import qtek.util.encode_float\n\nvoid main()\n{\n    float z = texture2D(depth, v_Texcoord).r * 2.0 - 1.0;\n\n    float dist = 2.0 * zNear * zFar / (zFar + zNear - z * (zFar - zNear));\n\n    float aperture = focalLength / fstop;\n\n    float coc;\n\n    float uppper = focalDist + focalRange;\n    float lower = focalDist - focalRange;\n    if (dist <= uppper && dist >= lower) {\n                coc = 0.5;\n    }\n    else {\n                float focalAdjusted = dist > uppper ? uppper : lower;\n\n                coc = abs(aperture * (focalLength * (dist - focalAdjusted)) / (dist * (focalAdjusted - focalLength)));\n                                coc = clamp(coc, 0.0, 0.4) / 0.4000001;\n\n                if (dist < lower) {\n            coc = -coc;\n        }\n        coc = coc * 0.5 + 0.5;\n    }\n\n        gl_FragColor = encodeFloat(coc);\n}\n\n@end\n\n@export qtek.compositor.dof.premultiply\n\nuniform sampler2D texture;\nuniform sampler2D coc;\nvarying vec2 v_Texcoord;\n\n@import qtek.util.rgbm\n\n@import qtek.util.decode_float\n\nvoid main() {\n    float fCoc = max(abs(decodeFloat(texture2D(coc, v_Texcoord)) * 2.0 - 1.0), 0.1);\n    gl_FragColor = encodeHDR(\n        vec4(decodeHDR(texture2D(texture, v_Texcoord)).rgb * fCoc, 1.0)\n    );\n}\n@end\n\n\n@export qtek.compositor.dof.min_coc\nuniform sampler2D coc;\nvarying vec2 v_Texcoord;\nuniform vec2 textureSize : [512.0, 512.0];\n\n@import qtek.util.float\n\nvoid main()\n{\n    vec4 d = vec4(-1.0, -1.0, 1.0, 1.0) / textureSize.xyxy;\n\n    float fCoc = decodeFloat(texture2D(coc, v_Texcoord + d.xy));\n    fCoc = min(fCoc, decodeFloat(texture2D(coc, v_Texcoord + d.zy)));\n    fCoc = min(fCoc, decodeFloat(texture2D(coc, v_Texcoord + d.xw)));\n    fCoc = min(fCoc, decodeFloat(texture2D(coc, v_Texcoord + d.zw)));\n\n    gl_FragColor = encodeFloat(fCoc);\n}\n\n@end\n\n\n@export qtek.compositor.dof.max_coc\nuniform sampler2D coc;\nvarying vec2 v_Texcoord;\nuniform vec2 textureSize : [512.0, 512.0];\n\n@import qtek.util.float\n\nvoid main()\n{\n\n    vec4 d = vec4(-1.0, -1.0, 1.0, 1.0) / textureSize.xyxy;\n\n    float fCoc = decodeFloat(texture2D(coc, v_Texcoord + d.xy));\n    fCoc = max(fCoc, decodeFloat(texture2D(coc, v_Texcoord + d.zy)));\n    fCoc = max(fCoc, decodeFloat(texture2D(coc, v_Texcoord + d.xw)));\n    fCoc = max(fCoc, decodeFloat(texture2D(coc, v_Texcoord + d.zw)));\n\n    gl_FragColor = encodeFloat(fCoc);\n}\n\n@end\n\n\n\n\n@export qtek.compositor.dof.coc_upsample\n\n#define HIGH_QUALITY\n\nuniform sampler2D coc;\nuniform vec2 textureSize : [512, 512];\n\nuniform float sampleScale: 0.5;\n\nvarying vec2 v_Texcoord;\n\n@import qtek.util.float\n\nvoid main()\n{\n\n#ifdef HIGH_QUALITY\n        vec4 d = vec4(1.0, 1.0, -1.0, 0.0) / textureSize.xyxy * sampleScale;\n\n    float s;\n    s  = decodeFloat(texture2D(coc, v_Texcoord - d.xy));\n    s += decodeFloat(texture2D(coc, v_Texcoord - d.wy)) * 2.0;\n    s += decodeFloat(texture2D(coc, v_Texcoord - d.zy));\n\n    s += decodeFloat(texture2D(coc, v_Texcoord + d.zw)) * 2.0;\n    s += decodeFloat(texture2D(coc, v_Texcoord       )) * 4.0;\n    s += decodeFloat(texture2D(coc, v_Texcoord + d.xw)) * 2.0;\n\n    s += decodeFloat(texture2D(coc, v_Texcoord + d.zy));\n    s += decodeFloat(texture2D(coc, v_Texcoord + d.wy)) * 2.0;\n    s += decodeFloat(texture2D(coc, v_Texcoord + d.xy));\n\n    gl_FragColor = encodeFloat(s / 16.0);\n#else\n        vec4 d = vec4(-1.0, -1.0, +1.0, +1.0) / textureSize.xyxy;\n\n    float s;\n    s  = decodeFloat(texture2D(coc, v_Texcoord + d.xy));\n    s += decodeFloat(texture2D(coc, v_Texcoord + d.zy));\n    s += decodeFloat(texture2D(coc, v_Texcoord + d.xw));\n    s += decodeFloat(texture2D(coc, v_Texcoord + d.zw));\n\n    gl_FragColor = encodeFloat(s / 4.0);\n#endif\n}\n\n@end\n\n\n\n@export qtek.compositor.dof.upsample\n\n#define HIGH_QUALITY\n\nuniform sampler2D coc;\nuniform sampler2D texture;\nuniform vec2 textureSize : [512, 512];\n\nuniform float sampleScale: 0.5;\n\nvarying vec2 v_Texcoord;\n\n\n@import qtek.util.rgbm\n\n@import qtek.util.decode_float\n\nfloat tap(vec2 uv, inout vec4 color, float baseWeight) {\n    float weight = abs(decodeFloat(texture2D(coc, uv)) * 2.0 - 1.0) * baseWeight;\n    color += decodeHDR(texture2D(texture, uv)) * weight;\n    return weight;\n}\n\nvoid main()\n{\n#ifdef HIGH_QUALITY\n        vec4 d = vec4(1.0, 1.0, -1.0, 0.0) / textureSize.xyxy * sampleScale;\n\n    vec4 color = vec4(0.0);\n    float baseWeight = 1.0 / 16.0;\n    float w  = tap(v_Texcoord - d.xy, color, baseWeight);\n    w += tap(v_Texcoord - d.wy, color, baseWeight * 2.0);\n    w += tap(v_Texcoord - d.zy, color, baseWeight);\n\n    w += tap(v_Texcoord + d.zw, color, baseWeight * 2.0);\n    w += tap(v_Texcoord       , color, baseWeight * 4.0);\n    w += tap(v_Texcoord + d.xw, color, baseWeight * 2.0);\n\n    w += tap(v_Texcoord + d.zy, color, baseWeight);\n    w += tap(v_Texcoord + d.wy, color, baseWeight * 2.0);\n    w += tap(v_Texcoord + d.xy, color, baseWeight);\n\n    gl_FragColor = encodeHDR(color / w);\n#else\n        vec4 d = vec4(-1.0, -1.0, +1.0, +1.0) / textureSize.xyxy;\n\n    vec4 color = vec4(0.0);\n    float baseWeight = 1.0 / 4.0;\n    float w  = tap(v_Texcoord + d.xy, color, baseWeight);\n    w += tap(v_Texcoord + d.zy, color, baseWeight);\n    w += tap(v_Texcoord + d.xw, color, baseWeight);\n    w += tap(v_Texcoord + d.zw, color, baseWeight);\n\n    gl_FragColor = encodeHDR(color / w);\n#endif\n}\n\n@end\n\n\n\n@export qtek.compositor.dof.downsample\n\nuniform sampler2D texture;\nuniform sampler2D coc;\nuniform vec2 textureSize : [512, 512];\n\nvarying vec2 v_Texcoord;\n\n@import qtek.util.rgbm\n\n@import qtek.util.decode_float\n\nfloat tap(vec2 uv, inout vec4 color) {\n    float weight = abs(decodeFloat(texture2D(coc, uv)) * 2.0 - 1.0) * 0.25;\n    color += decodeHDR(texture2D(texture, uv)) * weight;\n    return weight;\n}\n\nvoid main()\n{\n    vec4 d = vec4(-1.0, -1.0, 1.0, 1.0) / textureSize.xyxy;\n\n    vec4 color = vec4(0.0);\n    float weight = tap(v_Texcoord + d.xy, color);\n    weight += tap(v_Texcoord + d.zy, color);\n    weight += tap(v_Texcoord + d.xw, color);\n    weight += tap(v_Texcoord + d.zw, color);\n    color /= weight;\n\n    gl_FragColor = encodeHDR(color);\n}\n\n@end\n\n\n\n@export qtek.compositor.dof.hexagonal_blur_frag\n\n@import qtek.util.float\n\n\nvec4 doBlur(sampler2D targetTexture, vec2 offset) {\n#ifdef BLUR_COC\n    float cocSum = 0.0;\n#else\n    vec4 color = vec4(0.0);\n#endif\n\n    float weightSum = 0.0;\n    float kernelWeight = 1.0 / float(KERNEL_SIZE);\n\n    for (int i = 0; i < KERNEL_SIZE; i++) {\n        vec2 coord = v_Texcoord + offset * float(i);\n\n        float w = kernelWeight;\n#ifdef BLUR_COC\n        float fCoc = decodeFloat(texture2D(targetTexture, coord)) * 2.0 - 1.0;\n                cocSum += clamp(fCoc, -1.0, 0.0) * w;\n#else\n        float fCoc = decodeFloat(texture2D(coc, coord)) * 2.0 - 1.0;\n        vec4 texel = texture2D(targetTexture, coord);\n    #if !defined(BLUR_NEARFIELD)\n        w *= abs(fCoc);\n    #endif\n        color += decodeHDR(texel) * w;\n#endif\n\n        weightSum += w;\n    }\n#ifdef BLUR_COC\n    return encodeFloat(clamp(cocSum / weightSum, -1.0, 0.0) * 0.5 + 0.5);\n#else\n    return color / weightSum;\n#endif\n}\n\n@end\n\n\n@export qtek.compositor.dof.hexagonal_blur_1\n\n#define KERNEL_SIZE 5\n\nuniform sampler2D texture;\nuniform sampler2D coc;\nvarying vec2 v_Texcoord;\n\nuniform float blurSize : 1.0;\n\nuniform vec2 textureSize : [512.0, 512.0];\n\n@import qtek.util.rgbm\n\n@import qtek.compositor.dof.hexagonal_blur_frag\n\nvoid main()\n{\n    vec2 offset = blurSize / textureSize;\n\n#if !defined(BLUR_NEARFIELD) && !defined(BLUR_COC)\n    offset *= abs(decodeFloat(texture2D(coc, v_Texcoord)) * 2.0 - 1.0);\n#endif\n\n        gl_FragColor = doBlur(texture, vec2(0.0, offset.y));\n#if !defined(BLUR_COC)\n    gl_FragColor = encodeHDR(gl_FragColor);\n#endif\n}\n\n@end\n\n@export qtek.compositor.dof.hexagonal_blur_2\n\n#define KERNEL_SIZE 5\n\nuniform sampler2D texture;\nuniform sampler2D coc;\nvarying vec2 v_Texcoord;\n\nuniform float blurSize : 1.0;\n\nuniform vec2 textureSize : [512.0, 512.0];\n\n@import qtek.util.rgbm\n\n@import qtek.compositor.dof.hexagonal_blur_frag\n\nvoid main()\n{\n    vec2 offset = blurSize / textureSize;\n#if !defined(BLUR_NEARFIELD) && !defined(BLUR_COC)\n    offset *= abs(decodeFloat(texture2D(coc, v_Texcoord)) * 2.0 - 1.0);\n#endif\n\n    offset.y /= 2.0;\n\n        gl_FragColor = doBlur(texture, -offset);\n#if !defined(BLUR_COC)\n    gl_FragColor = encodeHDR(gl_FragColor);\n#endif\n}\n@end\n\n@export qtek.compositor.dof.hexagonal_blur_3\n\n#define KERNEL_SIZE 5\n\nuniform sampler2D texture1;\nuniform sampler2D texture2;\nuniform sampler2D coc;\n\nvarying vec2 v_Texcoord;\n\nuniform float blurSize : 1.0;\n\nuniform vec2 textureSize : [512.0, 512.0];\n\n@import qtek.util.rgbm\n\n@import qtek.compositor.dof.hexagonal_blur_frag\n\nvoid main()\n{\n    vec2 offset = blurSize / textureSize;\n\n#if !defined(BLUR_NEARFIELD) && !defined(BLUR_COC)\n    offset *= abs(decodeFloat(texture2D(coc, v_Texcoord)) * 2.0 - 1.0);\n#endif\n\n    offset.y /= 2.0;\n    vec2 vDownRight = vec2(offset.x, -offset.y);\n\n        vec4 texel1 = doBlur(texture1, -offset);\n        vec4 texel2 = doBlur(texture1, vDownRight);\n        vec4 texel3 = doBlur(texture2, vDownRight);\n\n#ifdef BLUR_COC\n    float coc1 = decodeFloat(texel1) * 2.0 - 1.0;\n    float coc2 = decodeFloat(texel2) * 2.0 - 1.0;\n    float coc3 = decodeFloat(texel3) * 2.0 - 1.0;\n    gl_FragColor = encodeFloat(\n        ((coc1 + coc2 + coc3) / 3.0) * 0.5 + 0.5\n    );\n\n#else\n    vec4 color = (texel1 + texel2 + texel3) / 3.0;\n    gl_FragColor = encodeHDR(color);\n#endif\n}\n\n@end\n\n@export qtek.compositor.dof.composite\n\n#define DEBUG 0\n\nuniform sampler2D original;\nuniform sampler2D blurred;\nuniform sampler2D nearfield;\nuniform sampler2D coc;\nuniform sampler2D nearcoc;\nvarying vec2 v_Texcoord;\n\n@import qtek.util.rgbm\n@import qtek.util.float\n\nvoid main()\n{\n    vec4 blurredColor = decodeHDR(texture2D(blurred, v_Texcoord));\n    vec4 originalColor = decodeHDR(texture2D(original, v_Texcoord));\n\n    float fCoc = decodeFloat(texture2D(coc, v_Texcoord));\n\n            fCoc = abs(fCoc * 2.0 - 1.0);\n\n    float weight = smoothstep(0.0, 1.0, fCoc);\n    \n#ifdef NEARFIELD_ENABLED\n    vec4 nearfieldColor = decodeHDR(texture2D(nearfield, v_Texcoord));\n    float fNearCoc = decodeFloat(texture2D(nearcoc, v_Texcoord));\n    fNearCoc = abs(fNearCoc * 2.0 - 1.0);\n\n        gl_FragColor = encodeHDR(\n        mix(\n            nearfieldColor, mix(originalColor, blurredColor, weight),\n                        pow(1.0 - fNearCoc, 4.0)\n        )\n    );\n#else\n    gl_FragColor = encodeHDR(mix(originalColor, blurredColor, weight));\n#endif\n\n#if DEBUG == 1\n        gl_FragColor = vec4(vec3(fCoc), 1.0);\n#elif DEBUG == 2\n        gl_FragColor = vec4(vec3(fNearCoc), 1.0);\n#elif DEBUG == 3\n    gl_FragColor = encodeHDR(blurredColor);\n#elif DEBUG == 4\n        gl_FragColor = encodeHDR(nearfieldColor);\n#endif\n}\n\n@end"},function(e,t){e.exports="@export qtek.compositor.downsample\n\nuniform sampler2D texture;\nuniform vec2 textureSize : [512, 512];\n\nvarying vec2 v_Texcoord;\n\n@import qtek.util.rgbm\nfloat brightness(vec3 c)\n{\n    return max(max(c.r, c.g), c.b);\n}\n\n@import qtek.util.clamp_sample\n\nvoid main()\n{\n    vec4 d = vec4(-1.0, -1.0, 1.0, 1.0) / textureSize.xyxy;\n\n#ifdef ANTI_FLICKER\n            vec3 s1 = decodeHDR(clampSample(texture, v_Texcoord + d.xy)).rgb;\n    vec3 s2 = decodeHDR(clampSample(texture, v_Texcoord + d.zy)).rgb;\n    vec3 s3 = decodeHDR(clampSample(texture, v_Texcoord + d.xw)).rgb;\n    vec3 s4 = decodeHDR(clampSample(texture, v_Texcoord + d.zw)).rgb;\n\n        float s1w = 1.0 / (brightness(s1) + 1.0);\n    float s2w = 1.0 / (brightness(s2) + 1.0);\n    float s3w = 1.0 / (brightness(s3) + 1.0);\n    float s4w = 1.0 / (brightness(s4) + 1.0);\n    float oneDivideSum = 1.0 / (s1w + s2w + s3w + s4w);\n\n    vec4 color = vec4(\n        (s1 * s1w + s2 * s2w + s3 * s3w + s4 * s4w) * oneDivideSum,\n        1.0\n    );\n#else\n    vec4 color = decodeHDR(clampSample(texture, v_Texcoord + d.xy));\n    color += decodeHDR(clampSample(texture, v_Texcoord + d.zy));\n    color += decodeHDR(clampSample(texture, v_Texcoord + d.xw));\n    color += decodeHDR(clampSample(texture, v_Texcoord + d.zw));\n    color *= 0.25;\n#endif\n\n    gl_FragColor = encodeHDR(color);\n}\n\n@end"},function(e,t){e.exports="@export qtek.compositor.fxaa\n\nuniform sampler2D texture;\nuniform vec4 viewport : VIEWPORT;\n\nvarying vec2 v_Texcoord;\n\n#define FXAA_REDUCE_MIN   (1.0/128.0)\n#define FXAA_REDUCE_MUL   (1.0/8.0)\n#define FXAA_SPAN_MAX     8.0\n\n@import qtek.util.rgbm\n\nvoid main()\n{\n    vec2 resolution = 1.0 / viewport.zw;\n    vec3 rgbNW =  decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( -1.0, -1.0 ) ) * resolution ) ).xyz;\n    vec3 rgbNE = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( 1.0, -1.0 ) ) * resolution ) ).xyz;\n    vec3 rgbSW = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( -1.0, 1.0 ) ) * resolution ) ).xyz;\n    vec3 rgbSE = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( 1.0, 1.0 ) ) * resolution ) ).xyz;\n    vec4 rgbaM  = decodeHDR( texture2D( texture,  gl_FragCoord.xy  * resolution ) );\n    vec3 rgbM  = rgbaM.xyz;\n    float opacity  = rgbaM.w;\n\n    vec3 luma = vec3( 0.299, 0.587, 0.114 );\n\n    float lumaNW = dot( rgbNW, luma );\n    float lumaNE = dot( rgbNE, luma );\n    float lumaSW = dot( rgbSW, luma );\n    float lumaSE = dot( rgbSE, luma );\n    float lumaM  = dot( rgbM,  luma );\n    float lumaMin = min( lumaM, min( min( lumaNW, lumaNE ), min( lumaSW, lumaSE ) ) );\n    float lumaMax = max( lumaM, max( max( lumaNW, lumaNE) , max( lumaSW, lumaSE ) ) );\n\n    vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max( ( lumaNW + lumaNE + lumaSW + lumaSE ) * ( 0.25 * FXAA_REDUCE_MUL ), FXAA_REDUCE_MIN );\n\n    float rcpDirMin = 1.0 / ( min( abs( dir.x ), abs( dir.y ) ) + dirReduce );\n    dir = min( vec2( FXAA_SPAN_MAX,  FXAA_SPAN_MAX),\n          max( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                dir * rcpDirMin)) * resolution;\n\n    vec3 rgbA = decodeHDR( texture2D( texture, gl_FragCoord.xy  * resolution + dir * ( 1.0 / 3.0 - 0.5 ) ) ).xyz;\n    rgbA += decodeHDR( texture2D( texture, gl_FragCoord.xy  * resolution + dir * ( 2.0 / 3.0 - 0.5 ) ) ).xyz;\n    rgbA *= 0.5;\n\n    vec3 rgbB = decodeHDR( texture2D( texture, gl_FragCoord.xy  * resolution + dir * -0.5 ) ).xyz;\n    rgbB += decodeHDR( texture2D( texture, gl_FragCoord.xy  * resolution + dir * 0.5 ) ).xyz;\n    rgbB *= 0.25;\n    rgbB += rgbA * 0.5;\n\n    float lumaB = dot( rgbB, luma );\n\n    if ( ( lumaB < lumaMin ) || ( lumaB > lumaMax ) )\n    {\n                gl_FragColor = vec4( rgbA, opacity );\n\n    }\n    else {\n\n        gl_FragColor = vec4( rgbB, opacity );\n\n    }\n}\n\n@end"},function(e,t){e.exports="@export qtek.compositor.hdr.log_lum\n\nvarying vec2 v_Texcoord;\n\nuniform sampler2D texture;\n\nconst vec3 w = vec3(0.2125, 0.7154, 0.0721);\n\n@import qtek.util.rgbm\n\nvoid main()\n{\n    vec4 tex = decodeHDR(texture2D(texture, v_Texcoord));\n    float luminance = dot(tex.rgb, w);\n    luminance = log(luminance + 0.001);\n\n    gl_FragColor = encodeHDR(vec4(vec3(luminance), 1.0));\n}\n\n@end\n\n@export qtek.compositor.hdr.lum_adaption\nvarying vec2 v_Texcoord;\n\nuniform sampler2D adaptedLum;\nuniform sampler2D currentLum;\n\nuniform float frameTime : 0.02;\n\n@import qtek.util.rgbm\n\nvoid main()\n{\n    float fAdaptedLum = decodeHDR(texture2D(adaptedLum, vec2(0.5, 0.5))).r;\n    float fCurrentLum = exp(encodeHDR(texture2D(currentLum, vec2(0.5, 0.5))).r);\n\n    fAdaptedLum += (fCurrentLum - fAdaptedLum) * (1.0 - pow(0.98, 30.0 * frameTime));\n    gl_FragColor = encodeHDR(vec4(vec3(fAdaptedLum), 1.0));\n}\n@end\n\n@export qtek.compositor.hdr.composite\n\nuniform sampler2D texture;\n#ifdef BLOOM_ENABLED\nuniform sampler2D bloom;\n#endif\n#ifdef LENSFLARE_ENABLED\nuniform sampler2D lensflare;\nuniform sampler2D lensdirt;\n#endif\n\n#ifdef LUM_ENABLED\nuniform sampler2D lum;\n#endif\n\n#ifdef LUT_ENABLED\nuniform sampler2D lut;\n#endif\n\n#ifdef COLOR_CORRECTION\nuniform float brightness : 0.0;\nuniform float contrast : 1.0;\nuniform float saturation : 1.0;\n#endif\n\n#ifdef VIGNETTE\nuniform float vignetteDarkness: 1.0;\nuniform float vignetteOffset: 1.0;\n#endif\n\nuniform float exposure : 1.0;\nuniform float bloomIntensity : 0.25;\nuniform float lensflareIntensity : 1;\n\nvarying vec2 v_Texcoord;\n\nconst vec3 whiteScale = vec3(11.2);\n\n@import qtek.util.srgb\n\nvec3 uncharted2ToneMap(vec3 x)\n{\n    const float A = 0.22;       const float B = 0.30;       const float C = 0.10;       const float D = 0.20;       const float E = 0.01;       const float F = 0.30;   \n    return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;\n}\n\nvec3 filmicToneMap(vec3 color)\n{\n    vec3 x = max(vec3(0.0), color - 0.004);\n    return (x*(6.2*x+0.5))/(x*(6.2*x+1.7)+0.06);\n}\n\nvec3 ACESToneMapping(vec3 color)\n{\n    const float A = 2.51;\n    const float B = 0.03;\n    const float C = 2.43;\n    const float D = 0.59;\n    const float E = 0.14;\n    return (color * (A * color + B)) / (color * (C * color + D) + E);\n}\n\nfloat eyeAdaption(float fLum)\n{\n    return mix(0.2, fLum, 0.5);\n}\n\n#ifdef LUT_ENABLED\nvec3 lutTransform(vec3 color) {\n    float blueColor = color.b * 63.0;\n\n    vec2 quad1;\n    quad1.y = floor(floor(blueColor) / 8.0);\n    quad1.x = floor(blueColor) - (quad1.y * 8.0);\n\n    vec2 quad2;\n    quad2.y = floor(ceil(blueColor) / 8.0);\n    quad2.x = ceil(blueColor) - (quad2.y * 8.0);\n\n    vec2 texPos1;\n    texPos1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.r);\n    texPos1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.g);\n\n    vec2 texPos2;\n    texPos2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.r);\n    texPos2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.g);\n\n    vec4 newColor1 = texture2D(lut, texPos1);\n    vec4 newColor2 = texture2D(lut, texPos2);\n\n    vec4 newColor = mix(newColor1, newColor2, fract(blueColor));\n    return newColor.rgb;\n}\n#endif\n\n@import qtek.util.rgbm\n\nvoid main()\n{\n        vec4 texel = vec4(0.0);\n#ifdef TEXTURE_ENABLED\n    texel += decodeHDR(texture2D(texture, v_Texcoord));\n#endif\n\n#ifdef BLOOM_ENABLED\n    texel += decodeHDR(texture2D(bloom, v_Texcoord)) * bloomIntensity;\n#endif\n\n#ifdef LENSFLARE_ENABLED\n    texel += decodeHDR(texture2D(lensflare, v_Texcoord)) * texture2D(lensdirt, v_Texcoord) * lensflareIntensity;\n#endif\n\n#ifdef LUM_ENABLED\n    float fLum = texture2D(lum, vec2(0.5, 0.5)).r;\n    float adaptedLumDest = 3.0 / (max(0.1, 1.0 + 10.0*eyeAdaption(fLum)));\n    float exposureBias = adaptedLumDest * exposure;\n#else\n    float exposureBias = exposure;\n#endif\n    texel.rgb *= exposureBias;\n\n                texel.rgb = ACESToneMapping(texel.rgb);\n    texel = linearTosRGB(texel);\n\n#ifdef LUT_ENABLED\n    texel.rgb = lutTransform(clamp(texel.rgb,vec3(0.0),vec3(1.0)));\n#endif\n\n#ifdef COLOR_CORRECTION\n        texel.rgb = clamp(texel.rgb + vec3(brightness), 0.0, 1.0);\n        texel.rgb = clamp((texel.rgb - vec3(0.5))*contrast+vec3(0.5), 0.0, 1.0);\n        float lum = dot(texel.rgb, vec3(0.2125, 0.7154, 0.0721));\n    texel.rgb = mix(vec3(lum), texel.rgb, saturation);\n#endif\n\n#ifdef VIGNETTE\n    vec2 uv = (v_Texcoord - vec2(0.5)) * vec2(vignetteOffset);\n    texel.rgb = mix(texel.rgb, vec3(1.0 - vignetteDarkness), dot(uv, uv));\n#endif\n\n    gl_FragColor = encodeHDR(texel);\n\n#ifdef DEBUG\n        #if DEBUG == 1\n    gl_FragColor = encodeHDR(decodeHDR(texture2D(texture, v_Texcoord)));\n        #elif DEBUG == 2\n    gl_FragColor = encodeHDR(decodeHDR(texture2D(bloom, v_Texcoord)) * bloomIntensity);\n        #elif DEBUG == 3\n    gl_FragColor = encodeHDR(decodeHDR(texture2D(lensflare, v_Texcoord) * lensflareIntensity));\n    #endif\n#endif\n        #ifdef PREMULTIPLY_ALPHA\n    gl_FragColor.rgb *= gl_FragColor.a;\n#endif\n}\n\n@end"},function(e,t){e.exports="@export qtek.compositor.lensflare\n\n#define SAMPLE_NUMBER 8\n\nuniform sampler2D texture;\nuniform sampler2D lenscolor;\n\nuniform vec2 textureSize : [512, 512];\n\nuniform float dispersal : 0.3;\nuniform float haloWidth : 0.4;\nuniform float distortion : 1.0;\n\nvarying vec2 v_Texcoord;\n\n@import qtek.util.rgbm\n\nvec4 textureDistorted(\n    in vec2 texcoord,\n    in vec2 direction,\n    in vec3 distortion\n) {\n    return vec4(\n        decodeHDR(texture2D(texture, texcoord + direction * distortion.r)).r,\n        decodeHDR(texture2D(texture, texcoord + direction * distortion.g)).g,\n        decodeHDR(texture2D(texture, texcoord + direction * distortion.b)).b,\n        1.0\n    );\n}\n\nvoid main()\n{\n    vec2 texcoord = -v_Texcoord + vec2(1.0);     vec2 textureOffset = 1.0 / textureSize;\n\n    vec2 ghostVec = (vec2(0.5) - texcoord) * dispersal;\n    vec2 haloVec = normalize(ghostVec) * haloWidth;\n\n    vec3 distortion = vec3(-textureOffset.x * distortion, 0.0, textureOffset.x * distortion);\n        vec4 result = vec4(0.0);\n    for (int i = 0; i < SAMPLE_NUMBER; i++)\n    {\n        vec2 offset = fract(texcoord + ghostVec * float(i));\n\n        float weight = length(vec2(0.5) - offset) / length(vec2(0.5));\n        weight = pow(1.0 - weight, 10.0);\n\n        result += textureDistorted(offset, normalize(ghostVec), distortion) * weight;\n    }\n\n    result *= texture2D(lenscolor, vec2(length(vec2(0.5) - texcoord)) / length(vec2(0.5)));\n        float weight = length(vec2(0.5) - fract(texcoord + haloVec)) / length(vec2(0.5));\n    weight = pow(1.0 - weight, 10.0);\n    vec2 offset = fract(texcoord + haloVec);\n    result += textureDistorted(offset, normalize(ghostVec), distortion) * weight;\n\n    gl_FragColor = result;\n}\n@end"},function(e,t){e.exports="\n@export qtek.compositor.lut\n\nvarying vec2 v_Texcoord;\n\nuniform sampler2D texture;\nuniform sampler2D lookup;\n\nvoid main()\n{\n\n    vec4 tex = texture2D(texture, v_Texcoord);\n\n    float blueColor = tex.b * 63.0;\n\n    vec2 quad1;\n    quad1.y = floor(floor(blueColor) / 8.0);\n    quad1.x = floor(blueColor) - (quad1.y * 8.0);\n\n    vec2 quad2;\n    quad2.y = floor(ceil(blueColor) / 8.0);\n    quad2.x = ceil(blueColor) - (quad2.y * 8.0);\n\n    vec2 texPos1;\n    texPos1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.r);\n    texPos1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.g);\n\n    vec2 texPos2;\n    texPos2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.r);\n    texPos2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.g);\n\n    vec4 newColor1 = texture2D(lookup, texPos1);\n    vec4 newColor2 = texture2D(lookup, texPos2);\n\n    vec4 newColor = mix(newColor1, newColor2, fract(blueColor));\n    gl_FragColor = vec4(newColor.rgb, tex.w);\n}\n\n@end"},function(e,t){e.exports="@export qtek.compositor.output\n\n#define OUTPUT_ALPHA\n\nvarying vec2 v_Texcoord;\n\nuniform sampler2D texture;\n\n@import qtek.util.rgbm\n\nvoid main()\n{\n    vec4 tex = decodeHDR(texture2D(texture, v_Texcoord));\n\n    gl_FragColor.rgb = tex.rgb;\n\n#ifdef OUTPUT_ALPHA\n    gl_FragColor.a = tex.a;\n#else\n    gl_FragColor.a = 1.0;\n#endif\n\n    gl_FragColor = encodeHDR(gl_FragColor);\n\n        #ifdef PREMULTIPLY_ALPHA\n    gl_FragColor.rgb *= gl_FragColor.a;\n#endif\n}\n\n@end"},function(e,t){e.exports="\n@export qtek.compositor.upsample\n\n#define HIGH_QUALITY\n\nuniform sampler2D texture;\nuniform vec2 textureSize : [512, 512];\n\nuniform float sampleScale: 0.5;\n\nvarying vec2 v_Texcoord;\n\n@import qtek.util.rgbm\n\n@import qtek.util.clamp_sample\n\nvoid main()\n{\n\n#ifdef HIGH_QUALITY\n        vec4 d = vec4(1.0, 1.0, -1.0, 0.0) / textureSize.xyxy * sampleScale;\n\n    vec4 s;\n    s  = decodeHDR(clampSample(texture, v_Texcoord - d.xy));\n    s += decodeHDR(clampSample(texture, v_Texcoord - d.wy)) * 2.0;\n    s += decodeHDR(clampSample(texture, v_Texcoord - d.zy));\n\n    s += decodeHDR(clampSample(texture, v_Texcoord + d.zw)) * 2.0;\n    s += decodeHDR(clampSample(texture, v_Texcoord       )) * 4.0;\n    s += decodeHDR(clampSample(texture, v_Texcoord + d.xw)) * 2.0;\n\n    s += decodeHDR(clampSample(texture, v_Texcoord + d.zy));\n    s += decodeHDR(clampSample(texture, v_Texcoord + d.wy)) * 2.0;\n    s += decodeHDR(clampSample(texture, v_Texcoord + d.xy));\n\n    gl_FragColor = encodeHDR(s / 16.0);\n#else\n        vec4 d = vec4(-1.0, -1.0, +1.0, +1.0) / textureSize.xyxy;\n\n    vec4 s;\n    s  = decodeHDR(clampSample(texture, v_Texcoord + d.xy));\n    s += decodeHDR(clampSample(texture, v_Texcoord + d.zy));\n    s += decodeHDR(clampSample(texture, v_Texcoord + d.xw));\n    s += decodeHDR(clampSample(texture, v_Texcoord + d.zw));\n\n    gl_FragColor = encodeHDR(s / 4.0);\n#endif\n}\n\n@end"},function(e,t){e.exports="\n@export qtek.compositor.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\nattribute vec3 position : POSITION;\nattribute vec2 texcoord : TEXCOORD_0;\n\nvarying vec2 v_Texcoord;\n\nvoid main()\n{\n    v_Texcoord = texcoord;\n    gl_Position = worldViewProjection * vec4(position, 1.0);\n}\n\n@end"},function(e,t){e.exports="vec3 calcAmbientSHLight(int idx, vec3 N) {\n    int offset = 9 * idx;\n\n        return ambientSHLightCoefficients[0]\n        + ambientSHLightCoefficients[1] * N.x\n        + ambientSHLightCoefficients[2] * N.y\n        + ambientSHLightCoefficients[3] * N.z\n        + ambientSHLightCoefficients[4] * N.x * N.z\n        + ambientSHLightCoefficients[5] * N.z * N.y\n        + ambientSHLightCoefficients[6] * N.y * N.x\n        + ambientSHLightCoefficients[7] * (3.0 * N.z * N.z - 1.0)\n        + ambientSHLightCoefficients[8] * (N.x * N.x - N.y * N.y);\n}"},function(e,t,n){var i=":unconfigurable;";e.exports=["@export qtek.header.directional_light","uniform vec3 directionalLightDirection[DIRECTIONAL_LIGHT_COUNT]"+i,"uniform vec3 directionalLightColor[DIRECTIONAL_LIGHT_COUNT]"+i,"@end","@export qtek.header.ambient_light","uniform vec3 ambientLightColor[AMBIENT_LIGHT_COUNT]"+i,"@end","@export qtek.header.ambient_sh_light","uniform vec3 ambientSHLightColor[AMBIENT_SH_LIGHT_COUNT]"+i,"uniform vec3 ambientSHLightCoefficients[AMBIENT_SH_LIGHT_COUNT * 9]"+i,n(205),"@end","@export qtek.header.ambient_cubemap_light","uniform vec3 ambientCubemapLightColor[AMBIENT_CUBEMAP_LIGHT_COUNT]"+i,"uniform samplerCube ambientCubemapLightCubemap[AMBIENT_CUBEMAP_LIGHT_COUNT]"+i,"uniform sampler2D ambientCubemapLightBRDFLookup[AMBIENT_CUBEMAP_LIGHT_COUNT]"+i,"@end","@export qtek.header.point_light","uniform vec3 pointLightPosition[POINT_LIGHT_COUNT]"+i,"uniform float pointLightRange[POINT_LIGHT_COUNT]"+i,"uniform vec3 pointLightColor[POINT_LIGHT_COUNT]"+i,"@end","@export qtek.header.spot_light","uniform vec3 spotLightPosition[SPOT_LIGHT_COUNT]"+i,"uniform vec3 spotLightDirection[SPOT_LIGHT_COUNT]"+i,"uniform float spotLightRange[SPOT_LIGHT_COUNT]"+i,"uniform float spotLightUmbraAngleCosine[SPOT_LIGHT_COUNT]"+i,"uniform float spotLightPenumbraAngleCosine[SPOT_LIGHT_COUNT]"+i,"uniform float spotLightFalloffFactor[SPOT_LIGHT_COUNT]"+i,"uniform vec3 spotLightColor[SPOT_LIGHT_COUNT]"+i,"@end"].join("\n")},function(e,t){e.exports="@export qtek.sm.depth.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\nattribute vec3 position : POSITION;\n\n#ifdef SHADOW_TRANSPARENT\nattribute vec2 texcoord : TEXCOORD_0;\n#endif\n\n#ifdef SKINNING\nattribute vec3 weight : WEIGHT;\nattribute vec4 joint : JOINT;\n\nuniform mat4 skinMatrix[JOINT_COUNT] : SKIN_MATRIX;\n#endif\n\nvarying vec4 v_ViewPosition;\n\n#ifdef SHADOW_TRANSPARENT\nvarying vec2 v_Texcoord;\n#endif\n\nvoid main(){\n\n    vec3 skinnedPosition = position;\n\n#ifdef SKINNING\n\n    @import qtek.chunk.skin_matrix\n\n    skinnedPosition = (skinMatrixWS * vec4(position, 1.0)).xyz;\n#endif\n\n    v_ViewPosition = worldViewProjection * vec4(skinnedPosition, 1.0);\n    gl_Position = v_ViewPosition;\n\n#ifdef SHADOW_TRANSPARENT\n    v_Texcoord = texcoord;\n#endif\n}\n@end\n\n@export qtek.sm.depth.fragment\n\nvarying vec4 v_ViewPosition;\n\n#ifdef SHADOW_TRANSPARENT\nvarying vec2 v_Texcoord;\n#endif\n\nuniform float bias : 0.001;\nuniform float slopeScale : 1.0;\n\n#ifdef SHADOW_TRANSPARENT\nuniform sampler2D transparentMap;\n#endif\n\n@import qtek.util.encode_float\n\nvoid main(){\n            float depth = v_ViewPosition.z / v_ViewPosition.w;\n    \n#ifdef USE_VSM\n    depth = depth * 0.5 + 0.5;\n    float moment1 = depth;\n    float moment2 = depth * depth;\n\n        float dx = dFdx(depth);\n    float dy = dFdy(depth);\n    moment2 += 0.25*(dx*dx+dy*dy);\n\n    gl_FragColor = vec4(moment1, moment2, 0.0, 1.0);\n#else\n        float dx = dFdx(depth);\n    float dy = dFdy(depth);\n    depth += sqrt(dx*dx + dy*dy) * slopeScale + bias;\n\n#ifdef SHADOW_TRANSPARENT\n    if (texture2D(transparentMap, v_Texcoord).a <= 0.1) {\n                gl_FragColor = encodeFloat(0.9999);\n        return;\n    }\n#endif\n\n    gl_FragColor = encodeFloat(depth * 0.5 + 0.5);\n#endif\n}\n@end\n\n@export qtek.sm.debug_depth\n\nuniform sampler2D depthMap;\nvarying vec2 v_Texcoord;\n\n@import qtek.util.decode_float\n\nvoid main() {\n    vec4 tex = texture2D(depthMap, v_Texcoord);\n#ifdef USE_VSM\n    gl_FragColor = vec4(tex.rgb, 1.0);\n#else\n    float depth = decodeFloat(tex);\n    gl_FragColor = vec4(depth, depth, depth, 1.0);\n#endif\n}\n\n@end\n\n\n@export qtek.sm.distance.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform mat4 world : WORLD;\n\nattribute vec3 position : POSITION;\n\n#ifdef SKINNING\nattribute vec3 boneWeight;\nattribute vec4 boneIndex;\n\nuniform mat4 skinMatrix[JOINT_COUNT] : SKIN_MATRIX;\n#endif\n\nvarying vec3 v_WorldPosition;\n\nvoid main (){\n\n    vec3 skinnedPosition = position;\n#ifdef SKINNING\n    @import qtek.chunk.skin_matrix\n\n    skinnedPosition = (skinMatrixWS * vec4(position, 1.0)).xyz;\n#endif\n\n    gl_Position = worldViewProjection * vec4(skinnedPosition , 1.0);\n    v_WorldPosition = (world * vec4(skinnedPosition, 1.0)).xyz;\n}\n\n@end\n\n@export qtek.sm.distance.fragment\n\nuniform vec3 lightPosition;\nuniform float range : 100;\n\nvarying vec3 v_WorldPosition;\n\n@import qtek.util.encode_float\n\nvoid main(){\n    float dist = distance(lightPosition, v_WorldPosition);\n#ifdef USE_VSM\n    gl_FragColor = vec4(dist, dist * dist, 0.0, 0.0);\n#else\n    dist = dist / range;\n    gl_FragColor = encodeFloat(dist);\n#endif\n}\n@end\n\n@export qtek.plugin.shadow_map_common\n\n@import qtek.util.decode_float\n\nfloat tapShadowMap(sampler2D map, vec2 uv, float z){\n    vec4 tex = texture2D(map, uv);\n            return step(z, decodeFloat(tex) * 2.0 - 1.0);\n}\n\nfloat pcf(sampler2D map, vec2 uv, float z, float textureSize, vec2 scale) {\n\n    float shadowContrib = tapShadowMap(map, uv, z);\n    vec2 offset = vec2(1.0 / textureSize) * scale;\n#ifdef PCF_KERNEL_SIZE\n    for (int _idx_ = 0; _idx_ < PCF_KERNEL_SIZE; _idx_++) {{\n        shadowContrib += tapShadowMap(map, uv + offset * pcfKernel[_idx_], z);\n    }}\n\n    return shadowContrib / float(PCF_KERNEL_SIZE + 1);\n#endif\n    shadowContrib += tapShadowMap(map, uv+vec2(offset.x, 0.0), z);\n    shadowContrib += tapShadowMap(map, uv+vec2(offset.x, offset.y), z);\n    shadowContrib += tapShadowMap(map, uv+vec2(-offset.x, offset.y), z);\n    shadowContrib += tapShadowMap(map, uv+vec2(0.0, offset.y), z);\n    shadowContrib += tapShadowMap(map, uv+vec2(-offset.x, 0.0), z);\n    shadowContrib += tapShadowMap(map, uv+vec2(-offset.x, -offset.y), z);\n    shadowContrib += tapShadowMap(map, uv+vec2(offset.x, -offset.y), z);\n    shadowContrib += tapShadowMap(map, uv+vec2(0.0, -offset.y), z);\n\n    return shadowContrib;\n}\n\nfloat pcf(sampler2D map, vec2 uv, float z, float textureSize) {\n    return pcf(map, uv, z, textureSize, vec2(1.0));\n}\n\nfloat chebyshevUpperBound(vec2 moments, float z){\n    float p = 0.0;\n    z = z * 0.5 + 0.5;\n    if (z <= moments.x) {\n        p = 1.0;\n    }\n    float variance = moments.y - moments.x * moments.x;\n        variance = max(variance, 0.0000001);\n        float mD = moments.x - z;\n    float pMax = variance / (variance + mD * mD);\n            pMax = clamp((pMax-0.4)/(1.0-0.4), 0.0, 1.0);\n    return max(p, pMax);\n}\nfloat computeShadowContrib(\n    sampler2D map, mat4 lightVPM, vec3 position, float textureSize, vec2 scale, vec2 offset\n) {\n\n    vec4 posInLightSpace = lightVPM * vec4(position, 1.0);\n    posInLightSpace.xyz /= posInLightSpace.w;\n    float z = posInLightSpace.z;\n        if(all(greaterThan(posInLightSpace.xyz, vec3(-0.99, -0.99, -1.0))) &&\n        all(lessThan(posInLightSpace.xyz, vec3(0.99, 0.99, 1.0)))){\n                vec2 uv = (posInLightSpace.xy+1.0) / 2.0;\n\n        #ifdef USE_VSM\n            vec2 moments = texture2D(map, uv * scale + offset).xy;\n            return chebyshevUpperBound(moments, z);\n        #else\n            return pcf(map, uv * scale + offset, z, textureSize, scale);\n        #endif\n    }\n    return 1.0;\n}\n\nfloat computeShadowContrib(sampler2D map, mat4 lightVPM, vec3 position, float textureSize) {\n    return computeShadowContrib(map, lightVPM, position, textureSize, vec2(1.0), vec2(0.0));\n}\n\nfloat computeShadowContribOmni(samplerCube map, vec3 direction, float range)\n{\n    float dist = length(direction);\n    vec4 shadowTex = textureCube(map, direction);\n\n#ifdef USE_VSM\n    vec2 moments = shadowTex.xy;\n    float variance = moments.y - moments.x * moments.x;\n    float mD = moments.x - dist;\n    float p = variance / (variance + mD * mD);\n    if(moments.x + 0.001 < dist){\n        return clamp(p, 0.0, 1.0);\n    }else{\n        return 1.0;\n    }\n#else\n    return step(dist, (decodeFloat(shadowTex) + 0.0002) * range);\n#endif\n}\n\n@end\n\n\n\n@export qtek.plugin.compute_shadow_map\n\n#if defined(SPOT_LIGHT_SHADOWMAP_COUNT) || defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT) || defined(POINT_LIGHT_SHADOWMAP_COUNT)\n\n#ifdef SPOT_LIGHT_SHADOWMAP_COUNT\nuniform sampler2D spotLightShadowMaps[SPOT_LIGHT_SHADOWMAP_COUNT];\nuniform mat4 spotLightMatrices[SPOT_LIGHT_SHADOWMAP_COUNT];\nuniform float spotLightShadowMapSizes[SPOT_LIGHT_SHADOWMAP_COUNT];\n#endif\n\n#ifdef DIRECTIONAL_LIGHT_SHADOWMAP_COUNT\n#if defined(SHADOW_CASCADE)\nuniform sampler2D directionalLightShadowMaps[1];\nuniform mat4 directionalLightMatrices[SHADOW_CASCADE];\nuniform float directionalLightShadowMapSizes[1];\nuniform float shadowCascadeClipsNear[SHADOW_CASCADE];\nuniform float shadowCascadeClipsFar[SHADOW_CASCADE];\n#else\nuniform sampler2D directionalLightShadowMaps[DIRECTIONAL_LIGHT_SHADOWMAP_COUNT];\nuniform mat4 directionalLightMatrices[DIRECTIONAL_LIGHT_SHADOWMAP_COUNT];\nuniform float directionalLightShadowMapSizes[DIRECTIONAL_LIGHT_SHADOWMAP_COUNT];\n#endif\n#endif\n\n#ifdef POINT_LIGHT_SHADOWMAP_COUNT\nuniform samplerCube pointLightShadowMaps[POINT_LIGHT_SHADOWMAP_COUNT];\nuniform float pointLightShadowMapSizes[POINT_LIGHT_SHADOWMAP_COUNT];\n#endif\n\nuniform bool shadowEnabled : true;\n\n#ifdef PCF_KERNEL_SIZE\nuniform vec2 pcfKernel[PCF_KERNEL_SIZE];\n#endif\n\n@import qtek.plugin.shadow_map_common\n\n#if defined(SPOT_LIGHT_SHADOWMAP_COUNT)\n\nvoid computeShadowOfSpotLights(vec3 position, inout float shadowContribs[SPOT_LIGHT_COUNT] ) {\n    float shadowContrib;\n    for(int _idx_ = 0; _idx_ < SPOT_LIGHT_SHADOWMAP_COUNT; _idx_++) {{\n        shadowContrib = computeShadowContrib(\n            spotLightShadowMaps[_idx_], spotLightMatrices[_idx_], position,\n            spotLightShadowMapSizes[_idx_]\n        );\n        shadowContribs[_idx_] = shadowContrib;\n    }}\n        for(int _idx_ = SPOT_LIGHT_SHADOWMAP_COUNT; _idx_ < SPOT_LIGHT_COUNT; _idx_++){{\n        shadowContribs[_idx_] = 1.0;\n    }}\n}\n\n#endif\n\n\n#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)\n\n#ifdef SHADOW_CASCADE\n\nvoid computeShadowOfDirectionalLights(vec3 position, inout float shadowContribs[DIRECTIONAL_LIGHT_COUNT]){\n        float depth = (2.0 * gl_FragCoord.z - gl_DepthRange.near - gl_DepthRange.far)\n                    / (gl_DepthRange.far - gl_DepthRange.near);\n\n    float shadowContrib;\n            shadowContribs[0] = 1.0;\n\n    for (int _idx_ = 0; _idx_ < SHADOW_CASCADE; _idx_++) {{\n        if (\n            depth >= shadowCascadeClipsNear[_idx_] &&\n            depth <= shadowCascadeClipsFar[_idx_]\n        ) {\n            shadowContrib = computeShadowContrib(\n                directionalLightShadowMaps[0], directionalLightMatrices[_idx_], position,\n                directionalLightShadowMapSizes[0],\n                vec2(1.0 / float(SHADOW_CASCADE), 1.0),\n                vec2(float(_idx_) / float(SHADOW_CASCADE), 0.0)\n            );\n                        shadowContribs[0] = shadowContrib;\n        }\n    }}\n        for(int _idx_ = DIRECTIONAL_LIGHT_SHADOWMAP_COUNT; _idx_ < DIRECTIONAL_LIGHT_COUNT; _idx_++) {{\n        shadowContribs[_idx_] = 1.0;\n    }}\n}\n\n#else\n\nvoid computeShadowOfDirectionalLights(vec3 position, inout float shadowContribs[DIRECTIONAL_LIGHT_COUNT]){\n    float shadowContrib;\n\n    for(int _idx_ = 0; _idx_ < DIRECTIONAL_LIGHT_SHADOWMAP_COUNT; _idx_++) {{\n        shadowContrib = computeShadowContrib(\n            directionalLightShadowMaps[_idx_], directionalLightMatrices[_idx_], position,\n            directionalLightShadowMapSizes[_idx_]\n        );\n        shadowContribs[_idx_] = shadowContrib;\n    }}\n        for(int _idx_ = DIRECTIONAL_LIGHT_SHADOWMAP_COUNT; _idx_ < DIRECTIONAL_LIGHT_COUNT; _idx_++) {{\n        shadowContribs[_idx_] = 1.0;\n    }}\n}\n#endif\n\n#endif\n\n\n#if defined(POINT_LIGHT_SHADOWMAP_COUNT)\n\nvoid computeShadowOfPointLights(vec3 position, inout float shadowContribs[POINT_LIGHT_COUNT] ){\n    vec3 lightPosition;\n    vec3 direction;\n    for(int _idx_ = 0; _idx_ < POINT_LIGHT_SHADOWMAP_COUNT; _idx_++) {{\n        lightPosition = pointLightPosition[_idx_];\n        direction = position - lightPosition;\n        shadowContribs[_idx_] = computeShadowContribOmni(pointLightShadowMaps[_idx_], direction, pointLightRange[_idx_]);\n    }}\n    for(int _idx_ = POINT_LIGHT_SHADOWMAP_COUNT; _idx_ < POINT_LIGHT_COUNT; _idx_++) {{\n        shadowContribs[_idx_] = 1.0;\n    }}\n}\n\n#endif\n\n#endif\n\n@end"},function(e,t){e.exports="@export qtek.skybox.vertex\n\nuniform mat4 world : WORLD;\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\nattribute vec3 position : POSITION;\n\nvarying vec3 v_WorldPosition;\n\nvoid main()\n{\n    v_WorldPosition = (world * vec4(position, 1.0)).xyz;\n    gl_Position = worldViewProjection * vec4(position, 1.0);\n}\n\n@end\n\n@export qtek.skybox.fragment\n\nuniform mat4 viewInverse : VIEWINVERSE;\nuniform samplerCube environmentMap;\nuniform float lod: 0.0;\n\nvarying vec3 v_WorldPosition;\n\n@import qtek.util.rgbm\n\nvoid main()\n{\n    vec3 eyePos = viewInverse[3].xyz;\n    vec3 viewDirection = normalize(v_WorldPosition - eyePos);\n\n    vec3 tex = decodeHDR(textureCubeLodEXT(environmentMap, viewDirection, lod)).rgb;\n\n#ifdef SRGB_DECODE\n    tex.rgb = pow(tex.rgb, vec3(2.2));\n#endif\n\n    gl_FragColor = encodeHDR(vec4(tex, 1.0));\n}\n@end"},function(e,t){e.exports="\n@export qtek.util.rand\nhighp float rand(vec2 uv) {\n    const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n    highp float dt = dot(uv.xy, vec2(a,b)), sn = mod(dt, 3.141592653589793);\n    return fract(sin(sn) * c);\n}\n@end\n\n@export qtek.util.calculate_attenuation\n\nuniform float attenuationFactor : 5.0;\n\nfloat lightAttenuation(float dist, float range)\n{\n    float attenuation = 1.0;\n    attenuation = dist*dist/(range*range+1.0);\n    float att_s = attenuationFactor;\n    attenuation = 1.0/(attenuation*att_s+1.0);\n    att_s = 1.0/(att_s+1.0);\n    attenuation = attenuation - att_s;\n    attenuation /= 1.0 - att_s;\n    return clamp(attenuation, 0.0, 1.0);\n}\n\n@end\n\n@export qtek.util.edge_factor\n\nfloat edgeFactor(float width)\n{\n    vec3 d = fwidth(v_Barycentric);\n    vec3 a3 = smoothstep(vec3(0.0), d * width, v_Barycentric);\n    return min(min(a3.x, a3.y), a3.z);\n}\n\n@end\n\n@export qtek.util.encode_float\nvec4 encodeFloat(const in float depth)\n{\n            \n            \n    const vec4 bitShifts = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n    const vec4 bit_mask  = vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n    vec4 res = fract(depth * bitShifts);\n    res -= res.xxyz * bit_mask;\n\n    return res;\n}\n@end\n\n@export qtek.util.decode_float\nfloat decodeFloat(const in vec4 color)\n{\n            \n    \n    const vec4 bitShifts = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n    return dot(color, bitShifts);\n}\n@end\n\n\n@export qtek.util.float\n@import qtek.util.encode_float\n@import qtek.util.decode_float\n@end\n\n\n\n@export qtek.util.rgbm_decode\nvec3 RGBMDecode(vec4 rgbm, float range) {\n  return range * rgbm.rgb * rgbm.a;\n    }\n@end\n\n@export qtek.util.rgbm_encode\nvec4 RGBMEncode(vec3 color, float range) {\n    if (dot(color, color) == 0.0) {\n        return vec4(0.0);\n    }\n    vec4 rgbm;\n    color /= range;\n    rgbm.a = clamp(max(max(color.r, color.g), max(color.b, 1e-6)), 0.0, 1.0);\n    rgbm.a = ceil(rgbm.a * 255.0) / 255.0;\n    rgbm.rgb = color / rgbm.a;\n    return rgbm;\n}\n@end\n\n@export qtek.util.rgbm\n@import qtek.util.rgbm_decode\n@import qtek.util.rgbm_encode\n\nvec4 decodeHDR(vec4 color)\n{\n#if defined(RGBM_DECODE) || defined(RGBM)\n    return vec4(RGBMDecode(color, 51.5), 1.0);\n#else\n    return color;\n#endif\n}\n\nvec4 encodeHDR(vec4 color)\n{\n#if defined(RGBM_ENCODE) || defined(RGBM)\n    return RGBMEncode(color.xyz, 51.5);\n#else\n    return color;\n#endif\n}\n\n@end\n\n\n@export qtek.util.srgb\n\nvec4 sRGBToLinear(in vec4 value) {\n    return vec4(mix(pow(value.rgb * 0.9478672986 + vec3(0.0521327014), vec3(2.4)), value.rgb * 0.0773993808, vec3(lessThanEqual(value.rgb, vec3(0.04045)))), value.w);\n}\n\nvec4 linearTosRGB(in vec4 value) {\n    return vec4(mix(pow(value.rgb, vec3(0.41666)) * 1.055 - vec3(0.055), value.rgb * 12.92, vec3(lessThanEqual(value.rgb, vec3(0.0031308)))), value.w);\n}\n@end\n\n\n@export qtek.chunk.skin_matrix\n\nmat4 skinMatrixWS;\nif (joint.x >= 0.0)\n{\n    skinMatrixWS = skinMatrix[int(joint.x)] * weight.x;\n}\nif (joint.y >= 0.0)\n{\n    skinMatrixWS += skinMatrix[int(joint.y)] * weight.y;\n}\nif (joint.z >= 0.0)\n{\n    skinMatrixWS += skinMatrix[int(joint.z)] * weight.z;\n}\nif (joint.w >= 0.0)\n{\n    skinMatrixWS += skinMatrix[int(joint.w)] * (1.0-weight.x-weight.y-weight.z);\n}\n@end\n\n\n\n@export qtek.util.parallax_correct\n\nvec3 parallaxCorrect(in vec3 dir, in vec3 pos, in vec3 boxMin, in vec3 boxMax) {\n            vec3 first = (boxMax - pos) / dir;\n    vec3 second = (boxMin - pos) / dir;\n\n    vec3 further = max(first, second);\n    float dist = min(further.x, min(further.y, further.z));\n\n    vec3 fixedPos = pos + dir * dist;\n    vec3 boxCenter = (boxMax + boxMin) * 0.5;\n\n    return normalize(fixedPos - boxCenter);\n}\n\n@end\n\n\n\n@export qtek.util.clamp_sample\nvec4 clampSample(const in sampler2D texture, const in vec2 coord)\n{\n#ifdef STEREO\n            float eye = step(0.5, coord.x) * 0.5;\n    vec2 coordClamped = clamp(coord, vec2(eye, 0.0), vec2(0.5 + eye, 1.0));\n#else\n    vec2 coordClamped = clamp(coord, vec2(0.0), vec2(1.0));\n#endif\n    return texture2D(texture, coordClamped);\n}\n@end"},function(e,t,n){var i=n(7),r=n(20),o=n(6),a=n(11),s=n(21),l=n(19),c=n(9),u=n(57),d=n(31),h=n(59),p=n(18),f=n(60),g=n(214),m=n(215),v={},_=["px","nx","py","ny","pz","nz"];v.prefilterEnvironmentMap=function(e,t,n,s,g){g&&s||(s=v.generateNormalDistribution(),g=v.integrateBRDF(e,s)),n=n||{};var y=n.width||64,x=n.height||64,b=n.type||t.type,w=new r({width:y,height:x,type:b,flipY:!1,mipmaps:[]});w.isPowerOfTwo();var C=Math.min(y,x),S=Math.log(C)/Math.log(2)+1,T=new l({shader:new c({vertex:c.source("qtek.skybox.vertex"),fragment:m})});T.set("normalDistribution",s),n.encodeRGBM&&T.shader.define("fragment","RGBM_ENCODE"),n.decodeRGBM&&T.shader.define("fragment","RGBM_DECODE");var A,M=new d;if(t instanceof i){var E=new r({width:y,height:x,type:b===o.FLOAT?o.HALF_FLOAT:b});f.panoramaToCubeMap(e,t,E,{encodeRGBM:n.decodeRGBM}),t=E}A=new u({scene:M,material:T}),A.material.set("environmentMap",t);var I=new h({texture:w});n.encodeRGBM&&(b=w.type=o.UNSIGNED_BYTE);for(var D=new i({width:y,height:x,type:b}),k=new a({depthBuffer:!1}),L=p[b===o.UNSIGNED_BYTE?"Uint8Array":"Float32Array"],N=0;N<S;N++){w.mipmaps[N]={pixels:{}},A.material.set("roughness",N/(_.length-1));for(var P=D.width,O=2*Math.atan(P/(P-.5))/Math.PI*180,R=0;R<_.length;R++){var z=new L(D.width*D.height*4);k.attach(D),k.bind(e);var F=I.getCamera(_[R]);F.fov=O,e.render(M,F),e.gl.readPixels(0,0,D.width,D.height,o.RGBA,b,z),k.unbind(e),w.mipmaps[N].pixels[_[R]]=z}D.width/=2,D.height/=2,D.dirty()}return k.dispose(e.gl),D.dispose(e.gl),A.dispose(e.gl),s.dispose(e.gl),{environmentMap:w,brdfLookup:g,normalDistribution:s,maxMipmapLevel:S}},v.integrateBRDF=function(e,t){t=t||v.generateNormalDistribution();var n=new a({depthBuffer:!1}),r=new s({fragment:g}),l=new i({width:512,height:256,type:o.HALF_FLOAT,minFilter:o.NEAREST,magFilter:o.NEAREST,useMipmap:!1});return r.setUniform("normalDistribution",t),r.setUniform("viewportSize",[512,256]),r.attachOutput(l),r.render(e,n),n.dispose(e.gl),l},v.generateNormalDistribution=function(e,t){for(var e=e||256,t=t||1024,n=new i({width:e,height:t,type:o.FLOAT,minFilter:o.NEAREST,magFilter:o.NEAREST,useMipmap:!1}),r=new Float32Array(t*e*4),a=0;a<t;a++){var s=a/t,l=(a<<16|a>>>16)>>>0;l=((1431655765&l)<<1|(2863311530&l)>>>1)>>>0,l=((858993459&l)<<2|(3435973836&l)>>>2)>>>0,l=((252645135&l)<<4|(4042322160&l)>>>4)>>>0,l=(((16711935&l)<<8|(4278255360&l)>>>8)>>>0)/4294967296;for(var c=0;c<e;c++){var u=c/e,d=u*u,h=2*Math.PI*s,p=Math.sqrt((1-l)/(1+(d*d-1)*l)),f=Math.sqrt(1-p*p),g=4*(a*e+c);r[g]=f*Math.cos(h),r[g+1]=f*Math.sin(h),r[g+2]=p,r[g+3]=1}}return n.pixels=r,n},e.exports=v},function(e,t,i){"use strict";function n(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}var r=i(6),o=i(7),a=(i(20),n("DXT1")),s=n("DXT3"),l=n("DXT5"),c={parse:function(e,t){var n=new Int32Array(e,0,31);if(542327876!==n[0])return null;if(4&!n(20))return null;var i,c,u=n(21),d=n[4],h=n[3],p=512&n[28],f=131072&n[2];switch(u){case a:i=8,c=r.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case s:i=16,c=r.COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case l:i=16,c=r.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;default:return null}var g=n[1]+4,m=p?6:1,v=1;f&&(v=Math.max(1,n[7]));for(var _=[],y=0;y<m;y++){var x=d,b=h;_[y]=new o({width:x,height:b,format:c});for(var w=[],C=0;C<v;C++){var S=Math.max(4,x)/4*Math.max(4,b)/4*i,T=new Uint8Array(e,g,S);g+=S,x*=.5,b*=.5,w[C]=T}_[y].pixels=w[0],f&&(_[y].mipmaps=w)}if(!t)return _[0];t.width=_[0].width,t.height=_[0].height,t.format=_[0].format,t.pixels=_[0].pixels,t.mipmaps=_[0].mipmaps}};e.exports=c},function(e,t,r){"use strict";function n(e,t,n,i){if(e[3]>0){var r=Math.pow(2,e[3]-128-8+i);t[n+0]=e[0]*r,t[n+1]=e[1]*r,t[n+2]=e[2]*r}else t[n+0]=0,t[n+1]=0,t[n+2]=0;return t[n+3]=1,t}function i(e,t,n){for(var i="",r=t;r<n;r++)i+=u(e[r]);return i}function a(e,t){t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]}function o(e,t,n,i){for(var r=0,o=0,s=i;s>0;)if(e[o][0]=t[n++],e[o][1]=t[n++],e[o][2]=t[n++],e[o][3]=t[n++],1===e[o][0]&&1===e[o][1]&&1===e[o][2]){for(var l=e[o][3]<<r>>>0;l>0;l--)a(e[o-1],e[o]),o++,s--;r+=8}else o++,s--,r=0;return n}function s(e,t,n,i){if(i<d|i>h)return o(e,t,n,i);var r=t[n++];if(2!=r)return o(e,t,n-1,i);if(e[0][1]=t[n++],e[0][2]=t[n++],r=t[n++],(e[0][2]<<8>>>0|r)>>>0!==i)return null;for(var r=0;r<4;r++)for(var a=0;a<i;){var s=t[n++];if(s>128){s=(127&s)>>>0;for(var l=t[n++];s--;)e[a++][r]=l}else for(;s--;)e[a++][r]=t[n++]}return n}var l=r(6),c=r(7),u=String.fromCharCode,d=8,h=32767,p={parseRGBE:function(e,t,r){null==r&&(r=0);var o=new Uint8Array(e),a=o.length;if("#?"===i(o,0,2)){for(var d=2;d<a&&("\n"!==u(o[d])||"\n"!==u(o[d+1]));d++);if(!(d>=a)){d+=2;for(var h="";d<a;d++){var p=u(o[d]);if("\n"===p)break;h+=p}var f=h.split(" "),g=parseInt(f[1]),m=parseInt(f[3]);if(m&&g){for(var v=d+1,_=[],y=0;y<m;y++){_[y]=[];for(var x=0;x<4;x++)_[y][x]=0}for(var b=new Float32Array(m*g*4),w=0,C=0;C<g;C++){var v=s(_,o,v,m);if(!v)return null;for(var y=0;y<m;y++)n(_[y],b,w,r),w+=4}return t||(t=new c),t.width=m,t.height=g,t.pixels=b,t.type=l.FLOAT,t}}}},parseRGBEFromPNG:function(e){}};e.exports=p},function(e,t,r){function n(e,t){var n=e[0],i=e[1],r=e[2];return 0===t?1:1===t?n:2===t?i:3===t?r:4===t?n*r:5===t?i*r:6===t?n*i:7===t?3*r*r-1:n*n-i*i}function i(e,t,i,r){for(var o=new l.Float32Array(27),a=f.create(),s=f.create(),c=f.create(),u=0;u<9;u++){for(var d=f.create(),h=0;h<m.length;h++){for(var p=t[m[h]],g=f.create(),_=0,y=0,x=v[m[h]],b=0;b<r;b++)for(var w=0;w<i;w++){a[0]=w/(i-1)*2-1,a[1]=b/(r-1)*2-1,a[2]=-1,f.normalize(a,a),c[0]=a[x[0]]*x[3],c[1]=a[x[1]]*x[4],c[2]=a[x[2]]*x[5],s[0]=p[y++]/255,s[1]=p[y++]/255,s[2]=p[y++]/255;var C=p[y++]/255*51.5;s[0]*=C,s[1]*=C,s[2]*=C,f.scaleAndAdd(g,g,s,n(c,u)*-a[2]),_+=-a[2]}f.scaleAndAdd(d,d,g,1/_)}o[3*u]=d[0]/6,o[3*u+1]=d[1]/6,o[3*u+2]=d[2]/6}return o}var o=r(6),a=r(11),s=r(7),l=(r(20),r(60),r(21),r(18)),c=r(57),u=r(58),d=r(59),h=r(31),p=r(1),f=p.vec3,g={},m=(r(216),["px","nx","py","ny","pz","nz"]),v={px:[2,1,0,-1,-1,1],nx:[2,1,0,1,-1,-1],py:[0,2,1,1,-1,-1],ny:[0,2,1,1,1,1],pz:[0,1,2,-1,-1,-1],nz:[0,1,2,1,-1,1]};g.projectEnvironmentMap=function(e,t,n){n=n||{},n.lod=n.lod||0;var r,l=new h,p=64;t instanceof s?r=new u({scene:l,environmentMap:t}):(p=t.image&&t.image.px?t.image.px.width:t.width,r=new c({scene:l,environmentMap:t}));var f=Math.ceil(p/Math.pow(2,n.lod)),g=Math.ceil(p/Math.pow(2,n.lod)),v=new s({width:f,height:g}),_=new a;r.material.shader.define("fragment","RGBM_ENCODE"),n.decodeRGBM&&r.material.shader.define("fragment","RGBM_DECODE"),r.material.set("lod",n.lod);for(var y=new d({texture:v}),x={},b=0;b<m.length;b++){x[m[b]]=new Uint8Array(f*g*4);var w=y.getCamera(m[b]);w.fov=90,_.attach(v),_.bind(e),e.render(l,w),e.gl.readPixels(0,0,f,g,o.RGBA,o.UNSIGNED_BYTE,x[m[b]]),_.unbind(e)}return r.dispose(e.gl),_.dispose(e.gl),v.dispose(e.gl),i(e,x,f,g)},e.exports=g},function(e,t){e.exports="#define SAMPLE_NUMBER 1024\n#define PI 3.14159265358979\n\n\nuniform sampler2D normalDistribution;\n\nuniform vec2 viewportSize : [512, 256];\n\nconst vec3 N = vec3(0.0, 0.0, 1.0);\nconst float fSampleNumber = float(SAMPLE_NUMBER);\n\nvec3 importanceSampleNormal(float i, float roughness, vec3 N) {\n    vec3 H = texture2D(normalDistribution, vec2(roughness, i)).rgb;\n\n    vec3 upVector = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\n    vec3 tangentX = normalize(cross(upVector, N));\n    vec3 tangentY = cross(N, tangentX);\n        return tangentX * H.x + tangentY * H.y + N * H.z;\n}\n\nfloat G_Smith(float roughness, float NoV, float NoL) {\n        float k = roughness * roughness / 2.0;\n    float G1V = NoV / (NoV * (1.0 - k) + k);\n    float G1L = NoL / (NoL * (1.0 - k) + k);\n    return G1L * G1V;\n}\n\nvoid main() {\n    vec2 uv = gl_FragCoord.xy / viewportSize;\n    float NoV = uv.x;\n    float roughness = uv.y;\n\n    vec3 V;\n    V.x = sqrt(1.0 - NoV * NoV);\n    V.y = 0.0;\n    V.z = NoV;\n\n    float A = 0.0;\n    float B = 0.0;\n\n    for (int i = 0; i < SAMPLE_NUMBER; i++) {\n        vec3 H = importanceSampleNormal(float(i) / fSampleNumber, roughness, N);\n        vec3 L = reflect(-V, H);\n        float NoL = clamp(L.z, 0.0, 1.0);\n        float NoH = clamp(H.z, 0.0, 1.0);\n        float VoH = clamp(dot(V, H), 0.0, 1.0);\n\n        if (NoL > 0.0) {\n            float G = G_Smith(roughness, NoV, NoL);\n            float G_Vis = G * VoH / (NoH * NoV);\n            float Fc = pow(1.0 - VoH, 5.0);\n            A += (1.0 - Fc) * G_Vis;\n            B += Fc * G_Vis;\n        }\n    }\n\n    gl_FragColor = vec4(vec2(A, B) / fSampleNumber, 0.0, 1.0);\n}\n"},function(e,t){e.exports="#define SAMPLE_NUMBER 1024\n#define PI 3.14159265358979\n\nuniform mat4 viewInverse : VIEWINVERSE;\nuniform samplerCube environmentMap;\nuniform sampler2D normalDistribution;\n\nuniform float roughness : 0.5;\n\nvarying vec2 v_Texcoord;\nvarying vec3 v_WorldPosition;\n\nconst float fSampleNumber = float(SAMPLE_NUMBER);\n\n@import qtek.util.rgbm\n\nvec3 importanceSampleNormal(float i, float roughness, vec3 N) {\n    vec3 H = texture2D(normalDistribution, vec2(roughness, i)).rgb;\n\n    vec3 upVector = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\n    vec3 tangentX = normalize(cross(upVector, N));\n    vec3 tangentY = cross(N, tangentX);\n        return tangentX * H.x + tangentY * H.y + N * H.z;\n}\n\nvoid main() {\n\n    vec3 eyePos = viewInverse[3].xyz;\n    vec3 V = normalize(v_WorldPosition - eyePos);\n\n    vec3 N = V;\n    vec3 R = V;\n\n    vec3 prefilteredColor = vec3(0.0);\n    float totalWeight = 0.0;\n\n\n    for (int i = 0; i < SAMPLE_NUMBER; i++) {\n        vec3 H = importanceSampleNormal(float(i) / fSampleNumber, roughness, N);\n        vec3 L = reflect(-V, H);\n\n        float NoL = clamp(dot(N, L), 0.0, 1.0);\n        if (NoL > 0.0) {\n            prefilteredColor += decodeHDR(textureCube(environmentMap, L)).rgb * NoL;\n            totalWeight += NoL;\n        }\n    }\n\n    gl_FragColor = encodeHDR(vec4(prefilteredColor / totalWeight, 1.0));\n}\n"},function(e,t){e.exports="uniform samplerCube environmentMap;\n\nvarying vec2 v_Texcoord;\n\n#define TEXTURE_SIZE 16\n\nmat3 front = mat3(\n     1.0,  0.0,  0.0,\n     0.0,  1.0,  0.0,\n     0.0,  0.0,  1.0\n);\n\nmat3 back = mat3(\n    -1.0,  0.0,  0.0,\n     0.0,  1.0,  0.0,\n     0.0,  0.0, -1.0\n);\n\nmat3 left = mat3(\n     0.0,  0.0, -1.0,\n     0.0,  1.0,  0.0,\n     1.0,  0.0,  0.0\n);\n\nmat3 right = mat3(\n     0.0,  0.0,  1.0,\n     0.0,  1.0,  0.0,\n    -1.0,  0.0,  0.0\n);\n\nmat3 up = mat3(\n     1.0,  0.0,  0.0,\n     0.0,  0.0,  1.0,\n     0.0, -1.0,  0.0\n);\n\nmat3 down = mat3(\n     1.0,  0.0,  0.0,\n     0.0,  0.0, -1.0,\n     0.0,  1.0,  0.0\n);\n\n\nfloat harmonics(vec3 normal){\n    int index = int(gl_FragCoord.x);\n\n    float x = normal.x;\n    float y = normal.y;\n    float z = normal.z;\n\n    if(index==0){\n        return 1.0;\n    }\n    else if(index==1){\n        return x;\n    }\n    else if(index==2){\n        return y;\n    }\n    else if(index==3){\n        return z;\n    }\n    else if(index==4){\n        return x*z;\n    }\n    else if(index==5){\n        return y*z;\n    }\n    else if(index==6){\n        return x*y;\n    }\n    else if(index==7){\n        return 3.0*z*z - 1.0;\n    }\n    else{\n        return x*x - y*y;\n    }\n}\n\nvec3 sampleSide(mat3 rot)\n{\n\n    vec3 result = vec3(0.0);\n    float divider = 0.0;\n    for (int i = 0; i < TEXTURE_SIZE * TEXTURE_SIZE; i++) {\n        float x = mod(float(i), float(TEXTURE_SIZE));\n        float y = float(i / TEXTURE_SIZE);\n\n        vec2 sidecoord = ((vec2(x, y) + vec2(0.5, 0.5)) / vec2(TEXTURE_SIZE)) * 2.0 - 1.0;\n        vec3 normal = normalize(vec3(sidecoord, -1.0));\n        vec3 fetchNormal = rot * normal;\n        vec3 texel = textureCube(environmentMap, fetchNormal).rgb;\n\n                result += harmonics(fetchNormal) * texel * -normal.z;\n\n        divider += -normal.z;\n    }\n\n    return result / divider;\n}\n\nvoid main()\n{\n    vec3 result = (\n        sampleSide(front) +\n        sampleSide(back) +\n        sampleSide(left) +\n        sampleSide(right) +\n        sampleSide(up) +\n        sampleSide(down)\n    ) / 6.0;\n    gl_FragColor = vec4(result, 1.0);\n}"},function(e,t){e.exports="0.3.3"},function(e,t,r){function n(e,t){return e[t]}function i(e,t,n){e[t]=n}function a(e,t,n){return(t-e)*n+e}function o(e,t,n){return n>.5?t:e}function s(e,t,n,i,r){var o=e.length;if(1==r)for(var s=0;s<o;s++)i[s]=a(e[s],t[s],n);else for(var l=e[0].length,s=0;s<o;s++)for(var c=0;c<l;c++)i[s][c]=a(e[s][c],t[s][c],n)}function u(e,t,n){var i=e.length,r=t.length;if(i!==r)if(i>r)e.length=r;else for(var o=i;o<r;o++)e.push(1===n?t[o]:y.call(t[o]));for(var a=e[0]&&e[0].length,o=0;o<e.length;o++)if(1===n)isNaN(e[o])&&(e[o]=t[o]);else for(var s=0;s<a;s++)isNaN(e[o][s])&&(e[o][s]=t[o][s])}function l(e,t,n){if(e===t)return!0;var i=e.length;if(i!==t.length)return!1;if(1===n){for(var r=0;r<i;r++)if(e[r]!==t[r])return!1}else for(var o=e[0].length,r=0;r<i;r++)for(var a=0;a<o;a++)if(e[r][a]!==t[r][a])return!1;return!0}function h(e,t,n,i,r,o,a,s,l){var u=e.length;if(1==l)for(var d=0;d<u;d++)s[d]=c(e[d],t[d],n[d],i[d],r,o,a);else for(var h=e[0].length,d=0;d<u;d++)for(var p=0;p<h;p++)s[d][p]=c(e[d][p],t[d][p],n[d][p],i[d][p],r,o,a)}function c(e,t,n,i,r,o,a){var s=.5*(n-e),l=.5*(i-t);return(2*(t-n)+s+l)*a+(-3*(t-n)-2*s-l)*o+s*r+t}function d(e){if(v(e)){var t=e.length;if(v(e[0])){for(var n=[],i=0;i<t;i++)n.push(y.call(e[i]));return n}return y.call(e)}return e}function f(e){return e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.floor(e[2]),"rgba("+e.join(",")+")"}function _(e,t,n,i,r){var d=e._getter,m=e._setter,_="spline"===t,y=i.length;if(y){var x,b=i[0].value,w=v(b),C=!1,S=!1,T=w&&v(b[0])?2:1;i.sort(function(e,t){return e.time-t.time}),x=i[y-1].time;for(var A=[],M=[],E=i[0].value,I=!0,D=0;D<y;D++){A.push(i[D].time/x);var k=i[D].value;if(w&&l(k,E,T)||!w&&k===E||(I=!1),E=k,"string"==typeof k){var L=g.parse(k);L?(k=L,C=!0):S=!0}M.push(k)}if(!I){for(var N=M[y-1],D=0;D<y-1;D++)w?u(M[D],N,T):!isNaN(M[D])||isNaN(N)||S||C||(M[D]=N);w&&u(d(e._target,r),N,T);var P,O,R,z,F,B,H=0,V=0;if(C)var W=[0,0,0,0];var U=function(e,t){var n;if(t<0)n=0;else if(t<V){for(P=Math.min(H+1,y-1),n=P;n>=0&&!(A[n]<=t);n--);n=Math.min(n,y-2)}else{for(n=H;n<y&&!(A[n]>t);n++);n=Math.min(n-1,y-2)}H=n,V=t;var i=A[n+1]-A[n];if(0!==i)if(O=(t-A[n])/i,_)if(z=M[n],R=M[0===n?n:n-1],F=M[n>y-2?y-1:n+1],B=M[n>y-3?y-1:n+2],w)h(R,z,F,B,O,O*O,O*O*O,d(e,r),T);else{var l;if(C)l=h(R,z,F,B,O,O*O,O*O*O,W,1),l=f(W);else{if(S)return o(z,F,O);l=c(R,z,F,B,O,O*O,O*O*O)}m(e,r,l)}else if(w)s(M[n],M[n+1],O,d(e,r),T);else{var l;if(C)s(M[n],M[n+1],O,W,1),l=f(W);else{if(S)return o(M[n],M[n+1],O);l=a(M[n],M[n+1],O)}m(e,r,l)}},$=new p({target:e._target,life:x,loop:e._loop,delay:e._delay,onframe:U,ondestroy:n});return t&&"spline"!==t&&($.easing=t),$}}}var p=r(219),g=r(225),m=r(14),v=m.isArrayLike,y=Array.prototype.slice,x=function(e,t,r,o){this._tracks={},this._target=e,this._loop=t||!1,this._getter=r||n,this._setter=o||i,this._clipCount=0,this._delay=0,this._doneList=[],this._onframeList=[],this._clipList=[]};x.prototype={when:function(e,t){var n=this._tracks;for(var i in t)if(t.hasOwnProperty(i)){if(!n[i]){n[i]=[];var r=this._getter(this._target,i);if(null==r)continue;0!==e&&n[i].push({time:0,value:d(r)})}n[i].push({time:e,value:t[i]})}return this},during:function(e){return this._onframeList.push(e),this},pause:function(){for(var e=0;e<this._clipList.length;e++)this._clipList[e].pause();this._paused=!0},resume:function(){for(var e=0;e<this._clipList.length;e++)this._clipList[e].resume();this._paused=!1},isPaused:function(){return!!this._paused},_doneCallback:function(){this._tracks={},this._clipList.length=0;for(var e=this._doneList,t=e.length,n=0;n<t;n++)e[n].call(this)},start:function(e){var t,n=this,i=0,r=function(){--i||n._doneCallback()};for(var o in this._tracks)if(this._tracks.hasOwnProperty(o)){var a=_(this,e,r,this._tracks[o],o);a&&(this._clipList.push(a),i++,this.animation&&this.animation.addClip(a),t=a)}if(t){var s=t.onframe;t.onframe=function(e,t){s(e,t);for(var i=0;i<n._onframeList.length;i++)n._onframeList[i](e,t)}}return i||this._doneCallback(),this},stop:function(e){for(var t=this._clipList,n=this.animation,i=0;i<t.length;i++){var r=t[i];e&&r.onframe(this._target,1),n&&n.removeClip(r)}t.length=0},delay:function(e){return this._delay=e,this},done:function(e){return e&&this._doneList.push(e),this},getClips:function(){return this._clipList}},e.exports=x},function(e,t,i){function n(e){this._target=e.target,this._life=e.life||1e3,this._delay=e.delay||0,this._initialized=!1,this.loop=null!=e.loop&&e.loop,this.gap=e.gap||0,this.easing=e.easing||"Linear",this.onframe=e.onframe,this.ondestroy=e.ondestroy,this.onrestart=e.onrestart,this._pausedTime=0,this._paused=!1}var r=i(220);n.prototype={constructor:n,step:function(e,t){if(this._initialized||(this._startTime=e+this._delay,this._initialized=!0),this._paused)return void(this._pausedTime+=t);var n=(e-this._startTime-this._pausedTime)/this._life;if(!(n<0)){n=Math.min(n,1);var i=this.easing,o="string"==typeof i?r[i]:i,a="function"==typeof o?o(n):n;return this.fire("frame",a),1==n?this.loop?(this.restart(e),"restart"):(this._needsRemove=!0,"destroy"):null}},restart:function(e){var t=(e-this._startTime-this._pausedTime)%this._life;this._startTime=e-t+this.gap,this._pausedTime=0,this._needsRemove=!1},fire:function(e,t){e="on"+e,this[e]&&this[e](this._target,t)},pause:function(){this._paused=!0},resume:function(){this._paused=!1}},e.exports=n},function(e,t){var n={linear:function(e){return e},quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},quarticIn:function(e){return e*e*e*e},quarticOut:function(e){return 1- --e*e*e*e},quarticInOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},quinticIn:function(e){return e*e*e*e*e},quinticOut:function(e){return--e*e*e*e*e+1},quinticInOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},sinusoidalIn:function(e){return 1-Math.cos(e*Math.PI/2)},sinusoidalOut:function(e){return Math.sin(e*Math.PI/2)},sinusoidalInOut:function(e){return.5*(1-Math.cos(Math.PI*e))},exponentialIn:function(e){return 0===e?0:Math.pow(1024,e-1)},exponentialOut:function(e){return 1===e?1:1-Math.pow(2,-10*e)},exponentialInOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))},circularIn:function(e){return 1-Math.sqrt(1-e*e)},circularOut:function(e){return Math.sqrt(1- --e*e)},circularInOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},elasticIn:function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),-n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4))},elasticOut:function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/.4)+1)},elasticInOut:function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),(e*=2)<1?n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*-.5:n*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*.5+1)},backIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},backOut:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},backInOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)},bounceIn:function(e){return 1-n.bounceOut(1-e)},bounceOut:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},bounceInOut:function(e){return e<.5?.5*n.bounceIn(2*e):.5*n.bounceOut(2*e-1)+.5}};e.exports=n},function(e,t){e.exports={containStroke:function(e,t,n,i,r,o,a){if(0===r)return!1;var s=r,l=0,c=e;if(a>t+s&&a>i+s||a<t-s&&a<i-s||o>e+s&&o>n+s||o<e-s&&o<n-s)return!1;if(e===n)return Math.abs(o-e)<=s/2;l=(t-i)/(e-n),c=(e*i-n*t)/(e-n);var u=l*o-a+c;return u*u/(l*l+1)<=s/2*s/2}}},function(e,t,r){function n(e,t){var n=e+":"+t;if(l[n])return l[n];for(var i=(e+"").split("\n"),r=0,o=0,a=i.length;o<a;o++)r=Math.max(f.measureText(i[o],t).width,r);return c>u&&(c=0,l={}),c++,l[n]=r,r}function i(e,t,i,r){var o=((e||"")+"").split("\n").length,a=n(e,t),s=n("国",t),l=o*s,c=new h(0,0,a,l);switch(c.lineHeight=s,r){case"bottom":case"alphabetic":c.y-=s;break;case"middle":c.y-=s/2}switch(i){case"end":case"right":c.x-=c.width;break;case"center":c.x-=c.width/2}return c}function a(e,t,n,i){var r=t.x,o=t.y,a=t.height,s=t.width,l=n.height,c=n.lineHeight,u=a/2-l/2+c,d="left";switch(e){case"left":r-=i,o+=u,d="right";break;case"right":r+=i+s,o+=u,d="left";break;case"top":r+=s/2,o-=i+l-c,d="center";break;case"bottom":r+=s/2,o+=a+i+c,d="center";break;case"inside":r+=s/2,o+=u,d="center";break;case"insideLeft":r+=i,o+=u,d="left";break;case"insideRight":r+=s-i,o+=u,d="right";break;case"insideTop":r+=s/2,o+=i,d="center";break;case"insideBottom":r+=s/2,o+=a-l-i+c,d="center";break;case"insideTopLeft":r+=i,o+=i,d="left";break;case"insideTopRight":r+=s-i,o+=i,d="right";break;case"insideBottomLeft":r+=i,o+=a-l-i+c;break;case"insideBottomRight":r+=s-i,o+=a-l-i+c,d="right"}return{x:r,y:o,textAlign:d,textBaseline:"alphabetic"}}function o(e,t,i,r,o){if(!t)return"";o=o||{},r=p(r,"...");for(var a=p(o.maxIterations,2),l=p(o.minChar,0),c=n("国",i),u=n("a",i),d=p(o.placeholder,""),h=t=Math.max(0,t-1),f=0;f<l&&h>=u;f++)h-=u;var g=n(r);g>h&&(r="",g=0),h=t-g;for(var m=(e+"").split("\n"),f=0,v=m.length;f<v;f++){var _=m[f],y=n(_,i);if(!(y<=t)){for(var x=0;;x++){if(y<=h||x>=a){_+=r;break}var b=0===x?s(_,h,u,c):y>0?Math.floor(_.length*h/y):0;_=_.substr(0,b),y=n(_,i)}""===_&&(_=d),m[f]=_}}return m.join("\n")}function s(e,t,n,i){for(var r=0,o=0,a=e.length;o<a&&r<t;o++){var s=e.charCodeAt(o);r+=0<=s&&s<=127?n:i}return o}var l={},c=0,u=5e3,d=r(14),h=r(83),p=d.retrieve,f={getWidth:n,getBoundingRect:i,adjustTextPositionOnRect:a,truncateText:o,measureText:function(e,t){var n=d.getContext();return n.font=t||"12px sans-serif",n.measureText(e)}};e.exports=f},function(e,t){var n="undefined"==typeof Float32Array?Array:Float32Array,i={create:function(){var e=new n(6);return i.identity(e),e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},mul:function(e,t,n){var i=t[0]*n[0]+t[2]*n[1],r=t[1]*n[0]+t[3]*n[1],o=t[0]*n[2]+t[2]*n[3],a=t[1]*n[2]+t[3]*n[3],s=t[0]*n[4]+t[2]*n[5]+t[4],l=t[1]*n[4]+t[3]*n[5]+t[5];return e[0]=i,e[1]=r,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e},translate:function(e,t,n){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4]+n[0],e[5]=t[5]+n[1],e},rotate:function(e,t,n){var i=t[0],r=t[2],o=t[4],a=t[1],s=t[3],l=t[5],c=Math.sin(n),u=Math.cos(n);return e[0]=i*u+a*c,e[1]=-i*c+a*u,e[2]=r*u+s*c,e[3]=-r*c+u*s,e[4]=u*o+c*l,e[5]=u*l-c*o,e},scale:function(e,t,n){var i=n[0],r=n[1];return e[0]=t[0]*i,e[1]=t[1]*r,e[2]=t[2]*i,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*r,e},invert:function(e,t){var n=t[0],i=t[2],r=t[4],o=t[1],a=t[3],s=t[5],l=n*a-o*i;return l?(l=1/l,e[0]=a*l,e[1]=-o*l,e[2]=-i*l,e[3]=n*l,e[4]=(i*s-a*r)*l,e[5]=(o*r-n*s)*l,e):null}};e.exports=i},function(e,t){var n="undefined"==typeof Float32Array?Array:Float32Array,i={create:function(e,t){var i=new n(2);return null==e&&(e=0),null==t&&(t=0),i[0]=e,i[1]=t,i},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e},clone:function(e){var t=new n(2);return t[0]=e[0],t[1]=e[1],t},set:function(e,t,n){return e[0]=t,e[1]=n,e},add:function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e},scaleAndAdd:function(e,t,n,i){return e[0]=t[0]+n[0]*i,e[1]=t[1]+n[1]*i,e},sub:function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e},len:function(e){return Math.sqrt(this.lenSquare(e))},lenSquare:function(e){return e[0]*e[0]+e[1]*e[1]},mul:function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e},div:function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]},scale:function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e},normalize:function(e,t){var n=i.len(t);return 0===n?(e[0]=0,e[1]=0):(e[0]=t[0]/n,e[1]=t[1]/n),e},distance:function(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))},distanceSquare:function(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])},negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e},lerp:function(e,t,n,i){return e[0]=t[0]+i*(n[0]-t[0]),e[1]=t[1]+i*(n[1]-t[1]),e},applyTransform:function(e,t,n){var i=t[0],r=t[1];return e[0]=n[0]*i+n[2]*r+n[4],e[1]=n[1]*i+n[3]*r+n[5],e},min:function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e},max:function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e}};i.length=i.len,i.lengthSquare=i.lenSquare,i.dist=i.distance,i.distSquare=i.distanceSquare,e.exports=i},function(e,t,r){function n(e){return e=Math.round(e),e<0?0:e>255?255:e}function i(e){return e=Math.round(e),e<0?0:e>360?360:e}function a(e){return e<0?0:e>1?1:e}function o(e){return n(e.length&&"%"===e.charAt(e.length-1)?parseFloat(e)/100*255:parseInt(e,10))}function s(e){return a(e.length&&"%"===e.charAt(e.length-1)?parseFloat(e)/100:parseFloat(e))}function u(e,t,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?e+(t-e)*n*6:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}function l(e,t,n){return e+(t-e)*n}function h(e,t,n,i,r){return e[0]=t,e[1]=n,e[2]=i,e[3]=r,e}function c(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function d(e,t){A&&c(A,t),A=S.put(e,A||t.slice())}function f(e,t){if(e){t=t||[];var n=S.get(e);if(n)return c(t,n);e+="";var i=e.replace(/ /g,"").toLowerCase();if(i in C)return c(t,C[i]),d(e,t),t;if("#"!==i.charAt(0)){var r=i.indexOf("("),a=i.indexOf(")");if(-1!==r&&a+1===i.length){var l=i.substr(0,r),u=i.substr(r+1,a-(r+1)).split(","),p=1;switch(l){case"rgba":if(4!==u.length)return void h(t,0,0,0,1);p=s(u.pop());case"rgb":return 3!==u.length?void h(t,0,0,0,1):(h(t,o(u[0]),o(u[1]),o(u[2]),p),d(e,t),t);case"hsla":return 4!==u.length?void h(t,0,0,0,1):(u[3]=s(u[3]),_(u,t),d(e,t),t);case"hsl":return 3!==u.length?void h(t,0,0,0,1):(_(u,t),d(e,t),t);default:return}}h(t,0,0,0,1)}else{if(4===i.length){var f=parseInt(i.substr(1),16);return f>=0&&f<=4095?(h(t,(3840&f)>>4|(3840&f)>>8,240&f|(240&f)>>4,15&f|(15&f)<<4,1),d(e,t),t):void h(t,0,0,0,1)}if(7===i.length){var f=parseInt(i.substr(1),16);return f>=0&&f<=16777215?(h(t,(16711680&f)>>16,(65280&f)>>8,255&f,1),d(e,t),t):void h(t,0,0,0,1)}}}}function _(e,t){var i=(parseFloat(e[0])%360+360)%360/360,r=s(e[1]),o=s(e[2]),a=o<=.5?o*(r+1):o+r-o*r,l=2*o-a;return t=t||[],h(t,n(255*u(l,a,i+1/3)),n(255*u(l,a,i)),n(255*u(l,a,i-1/3)),1),4===e.length&&(t[3]=e[3]),t}function p(e){if(e){var t,n,i=e[0]/255,r=e[1]/255,o=e[2]/255,a=Math.min(i,r,o),s=Math.max(i,r,o),l=s-a,c=(s+a)/2;if(0===l)t=0,n=0;else{n=c<.5?l/(s+a):l/(2-s-a);var u=((s-i)/6+l/2)/l,d=((s-r)/6+l/2)/l,h=((s-o)/6+l/2)/l;i===s?t=h-d:r===s?t=1/3+u-h:o===s&&(t=2/3+d-u),t<0&&(t+=1),t>1&&(t-=1)}var p=[360*t,n,c];return null!=e[3]&&p.push(e[3]),p}}function m(e,t){var n=f(e);if(n){for(var i=0;i<3;i++)n[i]=t<0?n[i]*(1-t)|0:(255-n[i])*t+n[i]|0;return b(n,4===n.length?"rgba":"rgb")}}function g(e,t){var n=f(e);if(n)return((1<<24)+(n[0]<<16)+(n[1]<<8)+ +n[2]).toString(16).slice(1)}function v(e,t,i){if(t&&t.length&&e>=0&&e<=1){i=i||[];var r=e*(t.length-1),o=Math.floor(r),s=Math.ceil(r),c=t[o],u=t[s],d=r-o;return i[0]=n(l(c[0],u[0],d)),i[1]=n(l(c[1],u[1],d)),i[2]=n(l(c[2],u[2],d)),i[3]=a(l(c[3],u[3],d)),i}}function y(e,t,i){if(t&&t.length&&e>=0&&e<=1){var r=e*(t.length-1),o=Math.floor(r),s=Math.ceil(r),c=f(t[o]),u=f(t[s]),d=r-o,h=b([n(l(c[0],u[0],d)),n(l(c[1],u[1],d)),n(l(c[2],u[2],d)),a(l(c[3],u[3],d))],"rgba");return i?{color:h,leftIndex:o,rightIndex:s,value:r}:h}}function x(e,t,n,r){if(e=f(e))return e=p(e),null!=t&&(e[0]=i(t)),null!=n&&(e[1]=s(n)),null!=r&&(e[2]=s(r)),b(_(e),"rgba")}function T(e,t){if((e=f(e))&&null!=t)return e[3]=a(t),b(e,"rgba")}function b(e,t){if(e&&e.length){var n=e[0]+","+e[1]+","+e[2];return"rgba"!==t&&"hsva"!==t&&"hsla"!==t||(n+=","+e[3]),t+"("+n+")"}}var w=r(84),C={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]},S=new w(20),A=null;e.exports={parse:f,lift:m,toHex:g,fastMapToColor:v,mapToColor:y,modifyHSL:x,modifyAlpha:T,stringify:b}}])})},function(e,t,n){var i;!function(){function isElement(e){return e instanceof HTMLElement||e instanceof SVGElement}function requireDomNode(e){if(!isElement(e))throw new Error("an HTMLElement or SVGElement is required; got "+e)}function isExternal(e){return e&&0==e.lastIndexOf("http",0)&&-1==e.lastIndexOf(window.location.host)}function inlineImages(e,t){requireDomNode(e);var n=e.querySelectorAll("image"),i=n.length,r=function(){0===i&&t()};r();for(var o=0;o<n.length;o++)!function(e){var t=e.getAttributeNS("http://www.w3.org/1999/xlink","href");if(!t||!isExternal(t.value)){var n=document.createElement("canvas"),o=n.getContext("2d"),a=new Image;a.crossOrigin="anonymous",t=t||e.getAttribute("href"),t?(a.src=t,a.onload=function(){n.width=a.width,n.height=a.height,o.drawImage(a,0,0),e.setAttributeNS("http://www.w3.org/1999/xlink","href",n.toDataURL("image/png")),i--,r()},a.onerror=function(){i--,r()}):(i--,r())}}(n[o])}function styles(e,t,n){function processFontQueue(e){if(e.length>0){var t=e.pop();!function(t){function fontLoaded(){var e=n.response,i=arrayBufferToBase64(e);updateFontStyle(t,i)}function transferFailed(n){o+=t.text+"\n",processFontQueue(e)}function updateFontStyle(t,n){var i='url("data:'+t.format+";base64,"+n+'")';o+=t.text.replace(t.fontUrlRegexp,i)+"\n",setTimeout(function(){processFontQueue(e)},0)}var n=new XMLHttpRequest;n.addEventListener("load",fontLoaded),n.addEventListener("error",transferFailed),n.addEventListener("abort",transferFailed),n.open("GET",t.url),n.responseType="arraybuffer",n.send()}(t)}else n(o)}function arrayBufferToBase64(e){for(var t="",n=new Uint8Array(e),i=n.byteLength,r=0;r<i;r++)t+=String.fromCharCode(n[r]);return window.btoa(t)}for(var i=t.selectorRemap,r=t.modifyStyle,o="",a=[],s=document.styleSheets,l=0;l<s.length;l++){try{var c=s[l].cssRules}catch(e){continue}if(null!=c)for(var u,d=0;d<c.length;d++,u=null){var h=c[d];if(void 0!==h.style){var p;try{p=h.selectorText}catch(e){}try{p&&(u=e.querySelector(p)||e.parentNode.querySelector(p))}catch(e){}if(u){var f=i?i(h.selectorText):h.selectorText,g=r?r(h.style.cssText):h.style.cssText;o+=f+" { "+g+" }\n"}else if(h.cssText.match(/^@font-face/)){var m=/url\(["']?(.+?)["']?\)/,v=h.cssText.match(m),_=v&&v[1]||"",y=_.match(/^data:/);y&&(_=""),"about:blank"===_&&(_=""),_?(_.startsWith("../")?_=s[l].href+"/../"+_:_.startsWith("./")&&(_=s[l].href+"/."+_),a.push({text:h.cssText,fontUrlRegexp:m,format:function(e){for(var t={woff2:"font/woff2",woff:"font/woff",otf:"application/x-font-opentype",ttf:"application/x-font-ttf",eot:"application/vnd.ms-fontobject",sfnt:"application/font-sfnt",svg:"image/svg+xml"},n=Object.keys(t),i=0;i<n.length;++i){var r=n[i];if(e.indexOf("."+r)>0)return t[r]}return"application/octet-stream"}(_),url:_})):o+=h.cssText+"\n"}}}}processFontQueue(a)}function getDimension(e,t,n){var i=e.viewBox&&e.viewBox.baseVal&&e.viewBox.baseVal[n]||null!==t.getAttribute(n)&&!t.getAttribute(n).match(/%$/)&&parseInt(t.getAttribute(n))||e.getBoundingClientRect()[n]||parseInt(t.style[n])||parseInt(window.getComputedStyle(e).getPropertyValue(n));return void 0===i||null===i||isNaN(parseFloat(i))?0:i}function reEncode(e){return e=encodeURIComponent(e),e=e.replace(/%([0-9A-F]{2})/g,function(e,t){var n=String.fromCharCode("0x"+t);return"%"===n?"%25":n}),decodeURIComponent(e)}function uriToBlob(e){for(var t=window.atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(t.length),r=new Uint8Array(i),o=0;o<t.length;o++)r[o]=t.charCodeAt(o);return new Blob([i],{type:n})}var r=void 0!==t&&t||{}||this;r.prepareSvg=function(e,t,n){requireDomNode(e),t=t||{},t.scale=t.scale||1,t.responsive=t.responsive||!1;var i="http://www.w3.org/2000/xmlns/";inlineImages(e,function(){function cssLoadedCallback(e){var t=document.createElement("style");t.setAttribute("type","text/css"),t.innerHTML="<![CDATA[\n"+e+"\n]]>";var i=document.createElement("defs");if(i.appendChild(t),s.insertBefore(i,s.firstChild),n){var l=a.innerHTML;l=l.replace(/NS\d+:href/gi,'xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href'),n(l,r,o)}}var r,o,a=document.createElement("div"),s=e.cloneNode(!0);if("svg"==e.tagName)r=t.width||getDimension(e,s,"width"),o=t.height||getDimension(e,s,"height");else{if(!e.getBBox)return;var l=e.getBBox();r=l.x+l.width,o=l.y+l.height,s.setAttribute("transform",s.getAttribute("transform").replace(/translate\(.*?\)/,""));var c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.appendChild(s),s=c}s.setAttribute("version","1.1"),s.getAttribute("xmlns")||s.setAttributeNS(i,"xmlns","http://www.w3.org/2000/svg"),s.getAttribute("xmlns:xlink")||s.setAttributeNS(i,"xmlns:xlink","http://www.w3.org/1999/xlink"),t.responsive?(s.removeAttribute("width"),s.removeAttribute("height"),s.setAttribute("preserveAspectRatio","xMinYMin meet")):(s.setAttribute("width",r*t.scale),s.setAttribute("height",o*t.scale)),s.setAttribute("viewBox",[t.left||0,t.top||0,r,o].join(" "));for(var u=s.querySelectorAll("foreignObject > *"),d=0;d<u.length;d++)u[d].getAttribute("xmlns")||u[d].setAttributeNS(i,"xmlns","http://www.w3.org/1999/xhtml");a.appendChild(s),styles(e,t,cssLoadedCallback)})},r.svgAsDataUri=function(e,t,n){r.prepareSvg(e,t,function(e){var t="data:image/svg+xml;base64,"+window.btoa(reEncode('<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd" [<!ENTITY nbsp "&#160;">]>'+e));n&&n(t)})},r.svgAsPngUri=function(e,t,n){requireDomNode(e),t=t||{},t.encoderType=t.encoderType||"image/png",t.encoderOptions=t.encoderOptions||.8;var i=function(e,i,r){var o=document.createElement("canvas"),a=o.getContext("2d");o.width=i,o.height=r,t.canvg?t.canvg(o,e):a.drawImage(e,0,0),t.backgroundColor&&(a.globalCompositeOperation="destination-over",a.fillStyle=t.backgroundColor,a.fillRect(0,0,o.width,o.height));var s;try{s=o.toDataURL(t.encoderType,t.encoderOptions)}catch(e){if("undefined"!=typeof SecurityError&&e instanceof SecurityError||"SecurityError"==e.name)return;throw e}n(s)};t.canvg?r.prepareSvg(e,t,i):r.svgAsDataUri(e,t,function(e){var t=new Image;t.onload=function(){i(t,t.width,t.height)},t.onerror=function(){},t.src=e})},r.download=function(e,t){if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(uriToBlob(t),e);else{var n=document.createElement("a");if("download"in n){n.download=e,n.style.display="none",document.body.appendChild(n);try{var i=uriToBlob(t),r=URL.createObjectURL(i);n.href=r,n.onclick=function(){requestAnimationFrame(function(){URL.revokeObjectURL(r)})}}catch(e){n.href=t}n.click(),document.body.removeChild(n)}else window.open(t,"_temp","menubar=no,toolbar=no,status=no")}},r.saveSvg=function(e,t,n){requireDomNode(e),n=n||{},r.svgAsDataUri(e,n,function(e){r.download(t,e)})},r.saveSvgAsPng=function(e,t,n){requireDomNode(e),n=n||{},r.svgAsPngUri(e,n,function(e){r.download(t,e)})},void 0!==(i=function(){return r}.call(t,n,t,e))&&(e.exports=i)}()},function(e,t,n){(function(i){function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r,o;r=[n(6),n(3),n(1),n(7),n(4),n(8),n(105)],void 0!==(o=function(e,t,n,r,o,a,s){var l=function(){function Menu(e,t,n,i){_classCallCheck(this,Menu),this.processManager=e,this.graphManager=t,this.operatorTree=n,this.zaip=i}return Menu.prototype.init=function(t,n,r){var o=this;o.cell=n;var s=o.processManager.getProcessName(),l=n.value.name,c=n.value.type,u=n.value.operatorExecType,v=n.value.isGroup,_=o.processManager.methodProxy.getMethod("runByType");if(t.addItem(i.i18n.prop("ict_oneminer_dialog_title_save_operator"),null,function(){o.openOperatorDialog()},null,"fa fa-save"),!v&&h(n,o.processManager)&&(t.addItem(i.i18n.prop("ict_oneminer_popup_menu_starthere"),null,function(){_(a.EXEC_TYPE_START,l)},null,"fa fa-play"),t.addItem(i.i18n.prop("ict_oneminer_popup_menu_current"),null,function(){_(a.EXEC_TYPE_CURRENT,l)},null,"fa fa-play-circle"),t.addItem(i.i18n.prop("ict_oneminer_popup_menu_stophere"),null,function(){_(a.EXEC_TYPE_STOP,l)},null,"fa fa-step-forward"),d(n)&&t.addItem(i.i18n.prop("ict_oneminer_popup_menu_fix"),null,function(){_(a.EXEC_TYPE_FIX,l)},null,"fa fa-forward")),p(n,o.processManager)&&(f(n,o.processManager)&&t.addItem(i.i18n.prop("ict_oneminer_popup_menu_queueOrder"),null,function(){o.showQueueOrder(s,l)},null,"fa fa-eye"),t.addItem(i.i18n.prop("ict_oneminer_process_toolbar_tooltip_stop"),null,function(){o.processManager.stop(n.value.name)},null,"fa fa-stop")),u===a.ZAIPPREDICTION&&t.addItem(i.i18n.prop("ict_oneminer_popup_menu_showresult"),null,function(){o.openResultInfoDialog(l,n)},null,"fa fa-eye"),g(n)&&(c!==a.OPERATOR_TYPE_GIS&&u!==a.ZAIPPREDICTION&&t.addItem(i.i18n.prop("ict_oneminer_popup_menu_showresult"),null,function(){o.openResultInfoDialog(l,n)},null,"fa fa-eye"),e.contains(a.REPORT_OPERATORS,c)&&t.addItem(i.i18n.prop("ict_oneminer_popup_menu_reportview"),null,function(){var e=o.processManager.getProcessInfo(!0),t=e.operators.filter(function(e){return e.id===n.id})[0],i=e.groups.filter(function(e){return"LoopOperator"===e.type&&e.id===t.parent})[0],r=o.processManager.getProcessInfo().connects.filter(function(e){return e.to_op==n.value.name}),a=r.map(function(e){return e.to_port});o.openReportViewDialog(l,c,t.params,{currentIterationId:m(n),maxIterationId:i&&i.params?parseInt(i.params["max-iterator"]):1,portArr:a})},null,"fa fa-area-chart")),u!==a.OPERATOR_TYPE_SPARK&&u!==a.OPERATOR_TYPE_PYTHON||t.addItem(i.i18n.prop("ict_oneminer_popup_menu_showlog"),null,function(){o.openLogDialog(l)},null,"fa fa-file-text"),n.children&&g(n)){var y=n.children.filter(function(e){var t=e.value;return t.portType===a.PORT_OUTPUT_TYPE&&t.data&&t.data.type===a.METADATA_EXAMPLE_VIEW});if(1===y.length)t.addItem(i.i18n.prop("ict_oneminer_popup_menu_exportresult"),null,function(){o.openExportDialog(l,y[0].value.name)},null,"fa fa-file-text");else if(y.length>1){var x=t.addItem(i.i18n.prop("ict_oneminer_popup_menu_exportresult"),null,null,null,"fa fa-file-text");y.forEach(function(e){t.addItem(e.value.name,null,function(){o.openExportDialog(l,e.value.name)},x)})}}},Menu.prototype.showQueueOrder=function(e,t){var r=this;i.get(n.genApiUrl("process/resourceSeq"),{processName:e,operatorName:t,connectId:r.processManager.getCurrentConnectId()}).done(function(e){var t=i.i18n.prop("ict_oneminer_message_queue_INFO",e),r=new n.Dialog(400,200,t);r.buttons=r.buttons.slice(0,1),i("<div>").dialog(r).dialog("open")}).fail()},Menu.prototype.openOperatorDialog=function(){var e=this,t=this.processManager.getSelectProcessInfo(),r=new n.Dialog;r.title=i.i18n.prop("ict_oneminer_dialog_title_save_operator"),r.position={my:"center",at:"top+330px"},r.open=function(){var e='<form class="form-group" style="margin:15px 20px" onsubmit="return false">\n                                <div class="col-sm-3">\n                                    <label class="name-label control-label" style="float:right;width:100%;text-align:right;">'+i.i18n.prop("ict_oneminer_dialog_operator_name")+'</label>\n                                </div>\n                                <div class="col-sm-8">\n                                    <input id="customOperatorName" name="customOperatorName" class="form-control" type="text" placeholder="'+i.i18n.prop("ict_oneminer_dialog_operator_name_placeholder")+'">\n                                </div>\n                            </form>';i(this).append(e).find("input").focus(),n.handleValidate(i(this).find("form"))},r.setConfirmHandler(function(){if(!i(this).find("form").valid())return i(this).find("input").focus();var n=i("#customOperatorName").val();e.saveCustomOperators(n,t),i(this).dialog("close")}),i("<div></div>").dialog(r).dialog("open")},Menu.prototype.saveCustomOperators=function(e,t){var a=this,s={operatorName:e,connectId:a.processManager.getCurrentConnectId(),content:JSON.stringify(t)};r.put(n.genApiUrl("operator/add"),s,function(){a.operatorTree.init(!0),o.success(i.i18n.prop("ict_oneminer_message_save_success"),"",n.toastrConfig)},v)},Menu.prototype.openZAIPPredictionResult=function(e){e.dialog({maxHeight:i(window).height(),minWidth:600});var t=this.processManager.getProcessName();s.getZAIPPredictionResult(e,e.data("op"),t,this.zaip,this.graphManager),i(".result-dialog").on("change","select",function(){i(".result-dialog").getNiceScroll().resize()}),this.addZaipListener(e.data("op"))},Menu.prototype.addZaipListener=function(e){i("#ZAIPPrediction").hover(function(){s.autoReload(!1)},function(){s.autoReload(!0)});var t=this.processManager.getProcessInfo().params.zaip_id,n=this.processManager.getProcessName();this.delTrain(e,t,n),this.stopTrain(e)},Menu.prototype.stopTrain=function(e,t,n){this.zaip.stopTrain("#ZAIPPrediction .stop-train",t,n,e)},Menu.prototype.delTrain=function(e,t,n){this.zaip.delTrain("#ZAIPPrediction",t,n,e)},Menu.prototype.openResultInfoDialog=function(e,t){var r=this,o=new n.Dialog(950);o.title=i.i18n.prop("ict_oneminer_dialog_title_resultinfo"),o.position={my:"top",at:"top"},o.resizable=!0,o.buttons=[],o.open=function(e){t.value.operatorExecType===a.ZAIPPREDICTION?r.openZAIPPredictionResult(i(e.target)):r.openResult(i(e.target))},o.close=function(e){t.value.operatorExecType===a.ZAIPPREDICTION&&s.autoReload(!1),i(e.target).dialog("destroy")},i('<div id="confirm-dialog" class="result-dialog"></div>').dialog(o).data("op",e).dialog("open")},Menu.prototype.openResult=function(e){e.dialog({maxHeight:i(window).height(),minWidth:610}),s.getDetailContent(e,e.data("op"),this.processManager),i(".result-dialog").on("change","select",function(){i(".result-dialog").getNiceScroll().resize()}),i(".result-dialog").on("click",".ui-accordion-header",function(){setTimeout(function(){i(".result-dialog").getNiceScroll().resize(),i(".result-dialog pre").getNiceScroll().resize()},500)}),i(".result-dialog").on("click",function(e){"A"===e.target.nodeName&&i(".result-dialog").getNiceScroll().resize()})},Menu.prototype.openReportViewDialog=function(e,t,o,a){var l=this.processManager,c=l.getProcessOwner(),u={operatorName:e,processName:l.getProcessName(),owner:c},d=function(r){var u={connectId:l.getCurrentConnectId(),name:e,params:o,results:r||[],type:t,processName:l.getProcessName(),iteration:a},d=new n.Dialog(1200,720);d.title=i.i18n.prop("ict_oneminer_popup_menu_reportview_title"),d.position={my:"top",at:"top",using:function(e){i(this).css({top:45,left:e.left,border:0,"border-radius":"6px"})}},d.resizable=!0,d.buttons=[],d.open=function(){i(this).dialog({maxHeight:i(window).height(),minWidth:1200,minHeight:720}),i(this).append(s.getReportContent(u,c));var e=i(".select-color");i(".chart-dialog").removeClass("widthAndHeightAuto"),e.length&&n.doNiceScroll(e),n.doNiceScroll(".chart-dialog")},d.resizeStop=function(){var e=i(".select-color");e.length&&(e.getNiceScroll().resize(),i(".chart-dialog").addClass("widthAndHeightAuto")),i(".chart-dialog").getNiceScroll().resize()},i("<div id='confirm-dialog' class='chart-dialog'></div>").dialog(d).dialog("open")};r.post(n.genApiUrl("process/operatorresult"),u,d,v)},Menu.prototype.openLogDialog=function(e){var t=this,r=new n.Dialog(950);r.title=i.i18n.prop("ict_oneminer_popup_menu_showlog"),r.position={my:"top",at:"top"},r.resizable=!0,r.buttons=[],r.open=function(r){i(r.target).dialog({maxHeight:i(window).height(),minWidth:450}),t.getLogDetail(e,i(r.target)),n.doNiceScroll("#log-dialog")},i('<div id="log-dialog"></div>').dialog(r).dialog("open")},Menu.prototype.getLogDetail=function(e,t){var o={connectId:this.processManager.getCurrentConnectId(),processName:this.processManager.getProcessName(),operatorName:e,operatorExecType:this.cell.value.operatorExecType,owner:this.processManager.getProcessOwner()},a=function(e){if("string"==typeof e)t.append('<div style="margin:15px;font-size:15px">'+e+"</div>");else{var n="<div id='logSearchDiv'>\n                                        <label style='color:#ffffff;'>"+i.i18n.prop("ict_oneminer_dialog_log_search")+"</label>\n                                        <input type='text' id='logInfoSearch' placeholder='search' class='form-control'/>\n                                    </div>";t.append(n);for(var r='<pre style="border:none;overflow:visible" class="logs-ctx">',o=0,a=e.length;o<a;o++){var s=e[o],l=s.substring(24,29).trim();r+='<p style="color:'+("ERROR"===l?"red":"WARN"===l?"#f79232":"#B6BECA")+'">'+s+"</p>"}r+="</pre>",t.append(r),c()}};r.get(n.genApiUrl("operator/getLog"),o,a,v)},Menu.prototype.openExportDialog=function(e,t){var r=this,o=i.i18n.prop("ict_oneminer_dialog_exportlimit"),a=new n.Dialog(400,200,o);a.title=i.i18n.prop("ict_oneminer_dialog_downloadtip"),a.setConfirmHandler(function(){location.href=n.genApiUrl("operator/exportOutputData?connectId="+r.processManager.getCurrentConnectId()+"&processName="+r.processManager.getProcessName()+"&operatorName="+e+"&outputPortName="+t+"&owner="+r.processManager.getProcessOwner()),i(this).dialog("close")}),i("<div></div>").dialog(a).dialog("open")},Menu}(),c=function(){i("#logInfoSearch").focus();var t=i(".logs-ctx").clone();i("#logInfoSearch").on("keyup",function(n){var i=this;e.throttle(function(){u(i.value,t)},100,{leading:!1})()})},u=function(e,t){if(e){var n=new RegExp(e.replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\[/g,"\\["),"gi"),r=t.clone();r.children().each(function(e,t){n.test(t.innerText)||i(t).addClass("hide"),t.innerHTML=t.innerText.replace(n,function(e){return"<span class='highlight'>"+e+"</span>"})}),i(".logs-ctx")[0].innerHTML=r.html()}else i(".logs-ctx")[0].innerHTML=t.html();i("#log-dialog").getNiceScroll().resize()},d=function(e){return e.value&&e.value.status&&"medium"===e.value.status.type},h=function(t,n){return!n.isRunning()||t.value&&t.value.status&&e.contains([void 0,"stop","failed"],t.value.status.type)},p=function(t,n){return n.isRunning()&&t.value&&t.value.status&&e.contains(["running","wait-resource"],t.value.status.type)},f=function(e,t){return t.isRunning()&&e.value&&e.value.status&&"wait-resource"===e.value.status.type},g=function(e){return e.value&&e.value.status&&("success"===e.value.status.type||m(e)>0)},m=function(e){if(e.value.iterations){var t=e.value.iterations.split(";")[0],n=t?parseInt(t):0;return e.value.status&&(n="running"===e.value.status.type?n-1:n),Math.max(n,0)}},v=function(e){o.info(e,"ajax error",n.toastrConfig)};return l}.apply(t,r))&&(e.exports=o)}).call(t,n(0))},function(e,t,n){var i,r;i=[n(0),n(6),n(3),n(41),n(40),n(54),n(17),n(1)],void 0!==(r=function(e,t,i,r,o,a,s,l){function initChart(t,n){t=t||"1070px",n=n||"570px";var i=e('<div class="chart-content"></div>'),r=e('<div class="chart-chart" style="width:'+t+"; height:"+n+';" />');return i.append(r),{chartContent:i,chart:c.init(r[0],"dark")}}function genVisualReport(n){var n=n,i=arguments[3]?initChart("1070px",570+400*((arguments[3].length>30?30:arguments[3].length)-1)+"px"):arguments[1]?initChart("1000px","570px"):initChart("1070px","570px");return t.isArray(n)&&(n.length>1&&setMoreTreeChart(i,n),n=n[0]),i.chart.setOption(n),i.chart.on("legendselectchanged",function(e){n.legend.selected=e.selected}),arguments[1]&&customColor(n,i),arguments[2]&&typeSelect(n,i,arguments[2]),arguments[3]&&setWeightDiv(n,i,arguments[3]),arguments[1]?(i.chartContent.find(".chart-chart").css("float","left"),e("div.chart-content").addClass("custom-label-flex")):(i.chartContent.find(".chart-chart").css("margin","auto"),e("div.chart-content").removeClass("custom-label-flex")),i.chartContent}function setMoreTreeChart(t,n){for(var i=[void 0],r=[void 0],o=1;o<n.length;o++){var a=570+400*((n[o].series.length>30?30:n[o].series.length)-1)+"px";r[o]=e('<div class="chart-chart" style="width:1070px; height:'+a+';" />'),t.chartContent.append(r[o]),i[o]=c.init(r[o][0],"dark"),i[o].setOption(n[o])}}function setWeightDiv(e,t,n){var i=[],r=n.length%30?parseInt(n.length/30)+1:parseInt(n.length/30);if(n.length>1){for(var o=0;o<n.length;o++){var a=300+o%30*400+"px";i.push('<div style="position:absolute;text-align:center;width:100%;top:'+a+';font-size:16px;font-weight:bold;border-bottom:1px dashed #ccc">Tree '+o+"(weight:"+n[o].weight+")</div>")}for(var s=0;s<r;s++){for(var l="",c=30*s;c<i.slice(30*s,30*s+30).length+30*s;c++)l+=i[c];t.chartContent.find(".chart-chart").eq(s).append(l)}}else{var a="500px",u='<div style="position:absolute;text-align:center;width:100%;top:'+a+';font-size:16px;font-weight:bold">weight:'+n[0].weight+"</div>";t.chartContent.find(".chart-chart").append(u)}}function typeSelect(e,t,n){var i={nameLocation:"middle"},r=n.values,o=n.unit,a=n.column;t.chart.on("magictypechanged",function(n){"bar"==n.currentType?(i.type="category",i.data=r.map(function(e){return e[0]}),i.name=""):"line"==n.currentType&&(i.data="",i.type="value",i.name=isNaN(o)?a+"("+o+")":a,i.formatter=function(e,t){return formatValue(e)}),e.series.forEach(function(e,t){e.type=n.currentType}),e.xAxis=i,t.chart.setOption(e)})}function customColor(t,n){var i=t.legend.selected,r=[];for(var o in i)r.push(i[o]);e(document).off("change",".select-color-input"),e(document).off("click",".color-list label,.legend-color");var a=e('<div class="select-color"></div>'),s=e('<div class="ul-child"></div>').append(e('<div class="clearfix color-box"></div>'));a.append(s);for(var l="",c=0;c<t.series.length;c++)if(t.series[c].name){var u=r[c]?t.series[c].itemStyle.normal.color:"#ccc",d=r[c]?"cur":"";l+='<div class="clearfix color-list '+d+'"><div class="legend-color pull-left" style="background:'+u+'"></div><label class="pull-left" title="'+t.series[c].name+'">'+t.series[c].name+'：</label><div class="pull-left color-btn" title="'+e.i18n.prop("ict_oneminer_select_color")+'"><div class="color-show" style="background:'+t.series[c].itemStyle.normal.color+'"></div><i class="fa fa-caret-down color-icon"></i><input class="select-color-input" type="color"></div></div>'}a.find(".color-box").html(l),n.chartContent.append(a),e(document).on("change",".select-color-input",function(){e(this).parent().find(".color-show").css("background",e(this).val()),e(this).parents(".color-list.cur").find(".legend-color").css("background",e(this).val());var i=e(this).parents(".color-list").index();t.series[i].itemStyle.normal.color=e(this).val(),t.series[i].areaStyle&&(t.series[i].areaStyle.normal.color=e(this).val()),n.chart.setOption(t)}),e(document).on("click",".color-list label,.legend-color",function(i){var r=e(this).parents(".color-list"),o=r.index();if(r.hasClass("cur")){r.removeClass("cur"),r.find(".legend-color").css("background","#ccc");for(var a in t.legend.selected)a==t.series[o].name&&(t.legend.selected[a]=!1)}else{r.addClass("cur"),r.find(".legend-color").css("background",t.series[o].itemStyle.normal.color);for(var a in t.legend.selected)a==t.series[o].name&&(t.legend.selected[a]=!0)}n.chart.setOption(t)})}function getColor(e){var t=["#FFFF00","#FF34B3","#FF0000","#8A2BE2","#BFEFFF","#6B8E23","#ffffff","#E066FF","#40E0D0","#77ADFF"];if(e<10)return t[e];for(var n=parseInt(16777215),i=parseInt(5936351)+1e6*e,r=(i>n?i-n:i).toString(16);r.length<6;)r="0"+r;return"#"+r}function genColors(e){for(var t=[],n=e>1?Math.round(300/(e-1)):0,i=0;i<e;i++)t.push(c.color.modifyHSL("#ff0000",n*i));return t}function chart(n,i,r){var o=i.params,a=i.iteration,s=e("<div/>").html(e.i18n.prop("ict_oneminer_chart_exception_msg"));if(!n||!r||0==t.size(r))return s;switch(n.chartType){case"LineChart":case"ScatterChart":s=genLineScatterChart(n,o,r);break;case"HistogramChart":s=genHistogramChart(n,o,r);break;case"AuRoc":s=genAuRocChart(n,o,r);break;case"ConfusionMatrix":s=genConfusionMatrixChart(n);break;case"RegressionEvaluation":s=genRegressionEvaluationChart(n);break;case"CdfChart":s=genCdfChart(n,o,r);break;case"BoxChart":s=genBoxChart(n,o,r);break;case"PdfChart":s=genPdfChart(n,o,r);break;case"PieChart":s=genPieChart(n,o,r);break;case"HeatMapChart":s=genHeatMapChart(n,o,r);break;case"Scatter3DChart":s=gen3DScatterChart(n,o,r);break;case"QQPlotChart":s=genQQPlotChart(n,o,r);break;case"RadarChart":s=genRadarChart(n,o,r);break;case"MultiScatterChart":s=genMultiScatterChart(n,o,r);break;case"WebGisVisual":s=genWebGisVisual(n,o,r,a);break;case"AnomalyDetectionLineChart":s=genAnomalyDetection(n,o,r);break;case"BarChart":s=genBarChart(n,o,r);break;case"TreeChart":s=genTreeChart(n,o,r);break;case"NormalProbabilityPlotChart":s=g(n,o,r)}return s}function selectShow(e){var t={};return e.forEach(function(e,n){t[e]=n<3}),t}function genTreeChart(e,t,n){for(var i,r=[],n=JSON.parse(n.out.result),o=[],a=[],s=n.length,l=s>1?200:400,c=s%30?parseInt(s/30)+1:parseInt(s/30),u=0;u<s;u++){r=[JSON.parse(n[u].tree)];var d=function(e){var t=[],n=function getNode(e){return e.forEach(function(e,n){e.children.length&&getNode(e.children),t.push(e)}),t}(e),r=n;i=n.length;for(var o=0;o<n.length;o++){var a=n[o].condition;if(""==a)return r[r.length-1].name=isNaN(Number(r[r.length-1].name))?r[r.length-1].name:Number(r[r.length-1].name).toFixed(3)+" ",r[r.length-1];for(var s={id:n[o].id,parentId:n[o].parentId,name:a.length>10?"":a,symbolSize:1e-5,itemStyle:{normal:{color:"rgba(0,0,0,0)",borderWidth:0}},collapsed:!1,label:{normal:{position:"left",rotate:0,color:"#fff"}},children:[{name:isNaN(Number(n[o].name))?n[o].name.length>10?n[o].name.substring(0,10)+"...":n[o].name:Number(n[o].name).toFixed(3)+" ",tip:function(){var e=n[o].tip;return a.length>10&&e.push({key:"condition",value:a}),n[o].name.length>10&&e.unshift({key:"name",value:n[o].name}),e}(),children:n[o].children}]},l=0;l<r.length;l++)n[o].parentId==r[l].id&&r[l].children.forEach(function(e,t){e.id==n[o].id&&(r[l].children[t]=s)})}}(r),h={type:"tree",height:l,top:u%30*400+50+"px",symbolSize:i>20?10:50,label:i>20?{normal:{position:"bottom",rotate:0,verticalAlign:"middle",align:"center",color:"#fff",fontSize:12}}:{},symbol:"emptyCircle",orient:"vertical",itemStyle:{normal:{color:"#4169E1",borderColor:"rgba(0,0,0,0)"}},expandAndCollapse:!0,initialTreeDepth:3,data:[d]};o.push(h)}var p=function(e){var t=e.data.tip,n="";return t.forEach(function(e){var t=e.key+":"+e.value,i=t.replace(/\w/g,function(e,t){return 0!==t&&t%50==0?e+"<br>":e});n+=i+"<br>"}),n};if(1==s)a={title:{text:e.chartType},tooltip:{trigger:"item",formatter:function(e){return p(e)}},series:o};else for(var u=0;u<c;u++){var f={tooltip:{trigger:"item",formatter:function(e){return p(e)}},series:o.slice(30*u,30*u+30)};0==u&&(f.title={text:e.chartType}),a.push(f)}return genVisualReport(a,"","",n)}function genBarChart(e,t,n){for(var i=n.value,r=[],o=[],a=JSON.parse(t.horizonColumns),s=0;s<i.length;s++)r.push(i[s][0]);for(var l=0;l<a.length;l++){var c={itemStyle:{normal:{color:getColor(l)}}};c.name=a[l],c.type="bar";for(var u=[],d=0;d<i.length;d++)u.push(i[d][l+1]);c.data=u,o.push(c)}return option={title:{text:e.chartType,left:"5%"},tooltip:{trigger:"axis"},legend:{show:!1,data:a,selected:selectShow(a)},toolbox:{show:!0,top:"4.5%",right:"4%",feature:{dataZoom:{show:!0,title:{zoom:"Zoom",back:"Zoom back"},iconStyle:{emphasis:{textPosition:"top"}}},magicType:{show:!0,title:{line:"change to line",bar:"change to bar"},type:["line","bar"],iconStyle:{emphasis:{textPosition:"top"}}},saveAsImage:{show:!0,title:"Save As Image",iconStyle:{emphasis:{textPosition:"top"}}}}},dataZoom:[{show:!0,start:0,end:100},{type:"inside",start:0,end:100},{show:!0,yAxisIndex:0,filterMode:"empty",width:20,height:"82%",showDataShadow:!1,left:"95.8%"}],xAxis:[{type:"category",data:r}],grid:{left:"5%",right:"5%",bottom:"4%",containLabel:!0},yAxis:[{type:"value"}],series:o},genVisualReport(option,!0)}function genAnomalyDetection(e,t,n){var i=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n].length;-1==t.indexOf(e[n][i-1])&&t.push(e[n][i-1])}for(var r=0;r<t.length;r++)for(var o=0;o<e.length;o++){var i=e[o].length;e[o][i-1]==t[r]&&e[o].push({color:getColor(r)})}return e}(n.value),r=t.xColumn,o=JSON.parse(t.yColumn),a=t.classField,s=[],l=[],c=[],u=o.length>5?o[0]+"......"+o[o.length-1]:u=o.join("/"),u=u.length>10?u.substring(0,10)+"...":u;xUnit=t.xAxisUnit,yUnit=t.yAxisUnit,yRender=JSON.parse(t.yColumnRender);for(var d=0;d<o.length;d++){var h=r+" V.S "+o[d];s.push(h);var p={itemStyle:{normal:{color:getColor(d)}}};p.name=h,p.type="line",p.symbolSize=10,p.showAllSymbol=!0,p.symbol="circle",p.data=[];for(var f=0;f<i.length;f++){var g=i[f].length,m=-1===yRender.indexOf(o[d])?{}:{itemStyle:{normal:{color:i[f][g-1].color}}};m.value=i[f][d+1],p.data.push(m)}c.push(p)}for(var v=0;v<i.length;v++)l.push(i[v][0]);return option={title:{text:e.chartType,left:"5%"},tooltip:{trigger:"item",formatter:function(e){return r+"："+e.name+"<br>"+o[e.seriesIndex]+"："+e.value+"<br>"+a+"："+i[e.dataIndex][i[e.dataIndex].length-2]}},legend:{show:!1,data:s,selected:selectShow(s)},toolbox:{show:!0,top:"4.5%",right:"4%",feature:{dataZoom:{show:!0,title:{zoom:"Zoom",back:"Zoom back"},iconStyle:{emphasis:{textPosition:"top"}}},saveAsImage:{show:!0,title:"Save As Image",iconStyle:{emphasis:{textPosition:"top"}}}}},dataZoom:[{show:!0,start:0,end:100},{type:"inside",start:0,end:100},{show:!0,yAxisIndex:0,filterMode:"empty",width:20,height:"82%",showDataShadow:!1,left:"95.8%"}],xAxis:{type:"category",boundaryGap:!1,name:isNaN(xUnit)?r+"("+xUnit+")":r,data:l},grid:{left:"5%",right:"5%",bottom:"4%",containLabel:!0},yAxis:{type:"value",name:isNaN(yUnit)?u+"("+yUnit+")":u},series:c},genVisualReport(option,!0)}function genLineScatterChart(t,n,i){var r,o=i.value,a=[],s=[],l=n.xColumn,c=JSON.parse(n.yColumn),u=n.classField,d=n.xAxisUnit,h=n.yAxisUnit,p="LineChart"===t.chartType?"line":"scatter";if(u)r=c[0],e.each(o,function(e,t){a.push(t.name),o[e].type=p,o[e].symbolSize=5,o[e].large=!0,o[e].itemStyle={normal:{color:getColor(e)}}}),s=o;else{Math.round(300/(c.length-1));r=c.length>5?c[0]+"......"+c[c.length-1]:r=c.join("/"),"line"===p&&(r=r.length>10?r.substring(0,10)+"...":r);for(var f=0;f<c.length;f++){var g=l+" V.S "+c[f];a.push(g);var m={itemStyle:{normal:{color:getColor(f)}}};m.name=g,m.type=p,m.large=!0,m.symbolSize=5,m.data=[];for(var v=0;v<o.length;v++)m.data.push([o[v][0],o[v][f+1]]);s.push(m)}}var _={title:{text:t.chartType,left:"line"===p?"5%":""},legend:{show:"line"!==p,data:a,selected:"line"===p?selectShow(a):{}},tooltip:{trigger:"item",formatter:function(e){var t=e.value;return u?l+"："+formatValue(t[0])+"<br>"+r+"："+formatValue(t[1]):l+"："+formatValue(t[0])+"<br>"+e.seriesName.split(" V.S ")[1]+"："+formatValue(t[1])}},grid:{left:"line"===p?"5%":"1%",right:"line"===p?"5%":"20%",bottom:"4%",containLabel:!0},toolbox:{show:!0,top:"4.5%",right:"line"===p?"4%":"19%",feature:{dataZoom:{show:!0,title:{zoom:"Zoom",back:"Zoom back"},iconStyle:{emphasis:{textPosition:"top"}}},saveAsImage:{show:!0,title:"Save As Image",iconStyle:{emphasis:{textPosition:"top"}}}}},dataZoom:[{show:!0,start:0,end:100},{type:"inside",start:0,end:100},{show:!0,yAxisIndex:0,filterMode:"empty",width:20,height:"82%",showDataShadow:!1,left:"line"===p?"95.8%":"80.2%"}],xAxis:{type:s[0].data&&isNaN(Number(s[0].data[0][0]))?"time":"value",nameLocation:"middle",name:isNaN(d)?l+"("+d+")":l,nameGap:20,splitLine:{show:"line"===p}},yAxis:{type:"value",name:isNaN(h)?r+"("+h+")":r,splitLine:{show:"line"===p}},series:s};return"line"===p?genVisualReport(_,!0):genVisualReport(_)}function genHistogramChart(e,n,i){var r,o=i.value,a=n.column,s=[a],l=n.unit,c="categorical"==n.variableType,u={values:o,column:a,unit:l};return!c&&t.isArray(o)&&o.length>1&&(r=o[1][0]-o[0][0]),genVisualReport({legend:{padding:5,itemGap:1,data:s},tooltip:{trigger:"item",formatter:function(e){var t=e.value;return c?a+": "+e.name+"<br>Frequency："+e.value:Number(t[0])?a+": ("+formatValue(t[0])+"~"+formatValue(Number(t[0])+r)+")<br>Frequency："+Number(t[1]):a+": "+t[0]+"<br>Frequency："+Number(t[1])}},calculable:!0,grid:{left:"10%",right:"10%",bottom:"5%",containLabel:!0},toolbox:{show:!0,top:"4.5%",left:"10%",feature:{mark:{show:!0},magicType:{show:!0,title:{line:"Line View",bar:"Bar View"},type:["line","bar"],iconStyle:{emphasis:{textPosition:"top"}}},dataZoom:{show:!0,title:{zoom:"Zoom",back:"Zoom back"},iconStyle:{emphasis:{textPosition:"top"}}},restore:{show:!0,title:"Restore",iconStyle:{emphasis:{textPosition:"top"}}},saveAsImage:{show:!0,title:"Save As Image",iconStyle:{emphasis:{textPosition:"top"}}}}},dataZoom:[{show:!0,start:0,end:100},{type:"inside",start:0,end:100},{show:!0,yAxisIndex:0,filterMode:"filter",width:30,height:"81%",showDataShadow:!1,left:"90.8%"}],xAxis:function(e,t,n,i){var r={nameLocation:"middle"};return t?(r.type="category",r.data=i.map(function(e){return e[0]})):(r.type="value",r.name=isNaN(n)?e+"("+n+")":e,r.formatter=function(e,t){return formatValue(e)}),[r]}(a,c,l,o),yAxis:[{type:"value"}],series:function(e,t,n){var i={name:e};return t?(i.type="bar",i.data=n.map(function(e){return e[1]})):(i.type="line",i.data=n),[i]}(a,c,o)},!1,u)}function genAuRocChart(e,t,n){var i=[{name:"1-specificity",index:0,text:"1-specificity",unit:""},{name:"sensitivity",index:1,text:"sensitivity",unit:""},{name:"threshold",index:2,text:"threshold",unit:""}],r=n.value,o=u(r),a=o.seriesArray,s=o.selectedObj;return genVisualReport({legend:{show:!1,data:a.map(function(e){return e.name}),selected:s},title:{left:"center",text:"AUC"},tooltip:{trigger:"item",formatter:function(e){var t=e.value;return i[2].text+"："+t[2]+"<br>"+i[1].text+"："+t[1]+i[1].unit+"<br>"+i[0].text+"："+t[0]+i[0].unit+"<br>"}},calculable:!0,toolbox:{show:!0,top:"4.5%",right:"9%",feature:{mark:{show:!0},dataZoom:{show:!0,title:{zoom:"Zoom",back:"Zoom back"},iconStyle:{emphasis:{textPosition:"top"}}},restore:{show:!0,title:"Restore",iconStyle:{emphasis:{textPosition:"top"}}},saveAsImage:{show:!0,title:"Save As Image",iconStyle:{emphasis:{textPosition:"top"}}}}},xAxis:[{type:"value",nameLocation:"middle",name:"1-specificity"}],yAxis:[{type:"value",name:"sensitivity"}],series:a.concat([{type:"line",itemStyle:{normal:{lineStyle:{type:"dotted"},color:"white"}},data:[[0,0,0],[1,1,1.01]]}])},!0)}function genConfusionMatrixChart(n){var i=t.map(n.dataList,function(e){return t.map(e,function(e){return parseInt(e)})}),r=sumRowColumn(i),o=t.map(i,function(e,t){return e[t]}),a=n.metaDataList,s=t.map(o,function(e,t){var n=0===r[1][t]?0:parseFloat(e)/r[1][t],i=0===r[0][t]?0:parseFloat(e)/r[0][t],o=n+i===0?0:2*n*i/(n+i);return[formatValue(n),formatValue(i),formatValue(o)]}),l=parseFloat(sumArray(o))/sumArray(r[0]);return'<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/> </head><div class = "abc"><table id = ConfusionMatrixTable  class ="table table-bordered " width="136px" height="120px"><thead><tr class=""> <th rowspan="10" class="chart-a-ca-head-title "><div class="chart-a-ca-ht-div "><table><thead><tr class=""><th width="100px"></th><th text-align:left> '+e.i18n.prop("ict_oneminer_chart_predicted")+'</th></tr><tr class=""><th padding="5px">'+e.i18n.prop("ict_oneminer_chart_actual")+"</th><th></th></tr></thead></table></div></th>"+t.reduce(a,function(e,t){return e+"<th>"+t.name+"</th>"},"")+"</tr></thead><tbody>"+genConfusionTrHtml(i,a)+'</tbody></table><table id = ModelEvaluationTable  class ="table table-bordered " width="200px" height="120px"><thead><tr><th rowspan="10" class="chart-a-ca-head-title "><div class="chart-a-ca-ht-div "><table><thead><tr class=""><th width="100px"></th><th text-align:left>'+e.i18n.prop("ict_oneminer_chart_measure")+'</th></tr><tr class=""><th padding="5px">'+e.i18n.prop("ict_oneminer_chart_label")+"</th><th></th></tr></thead></table></div></th><th>"+e.i18n.prop("ict_oneminer_chart_precision")+"</th><th>"+e.i18n.prop("ict_oneminer_chart_recall")+"</th><th>F1</th></tr></thead><tbody>"+genMeasureTrHtml(s,a)+'</tbody></table><p style="text-align: right"> '+e.i18n.prop("ict_oneminer_chart_overall_precision")+"："+formatValue(l)+"</p>"}function sumRowColumn(e){return[sumEachRow(e),sumEachRow(t.unzip(e))]}function sumEachRow(e){return t.map(e,function(e){return sumArray(e)})}function sumArray(e){return t.reduce(e,function(e,t){return e+t},0)}function genConfusionTrHtml(e,n){return t.map(n,function(n,i){var r='<tr> <td width="136px"><b>'+n.name+"</b> </td>";return r+=t.reduce(e[i],function(e,t){return e+' <td class=" "><b>'+t+"</b> </td> "},""),r+="</tr>"}).join("")}function genMeasureTrHtml(e,n){return t.map(n,function(n,i){var r='<tr> <td width="136px"><b>'+n.name+"</b> </td>";return r+=t.reduce(e[i],function(e,t){return e+' <td class=" "><b>'+t+"</b> </td> "},""),r+="</tr>"}).join("")}function genRegressionEvaluationChart(n){if(!n||!t.isArray(n.dataList))return e.i18n.prop("ict_oneminer_chart_exception_msg");var i=n.dataList[0];return'<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/> </head><div class = "abc"><p style= "text-align:center"> ANOVA table for regression evaluation</p><table id = RegressionModelEvaluationTable  class ="table table-bordered " width="200px" height="120px"><thead><tr><th rowspan="10" class=""><div class=" "><table><thead><tr class=""><th width="100px"></th><th text-align:left></th></tr><tr class=""><th padding="5px"></th><th></th></tr></thead></table></div></th><th>Sum of Square</th><th>DF</th><th>Mean Square</th><th>F-Statistics</th></tr></thead><tbody><tr><td width="136px"><b>Model</b> </td><td ><b>'+i[3]+"</b> </td><td ><b>"+Number(i[8])+"</b> </td><td ><b>"+i[6]+"</b> </td><td ><b>"+i[7]+'</b> </td></tr><tr><td class=" "><b>Error</b> </td><td class=" "><b>'+i[2]+'</b> </td><td class=" "><b>'+Number(i[9])+'</b> </td><td class=" "><b>'+i[4]+'</b> </td><td class=" "><b></b> </td></tr><td class=" "><b>Total</b> </td><td class=" "><b>'+i[10]+'</b> </td><td class=" "><b>'+(Number(i[8])+Number(i[9]))+'</b> </td><td class=" "><b></b> </td><td class=" "><b></b> </td></tr></tbody></table><p style="text-align: left"> R<sup>2</sup>：'+formatValue(i[0])+'</p><p style="text-align: left"> Adjust-R<sup>2</sup>：'+formatValue(i[1])+'</p><p style="text-align: left"> RMSE：'+i[11]+'</p><p style="text-align: left"> MAE：'+i[5]+"</p></div>"}function genCdfChart(n,i,r){var o=[e.i18n.prop("ict_oneminer_chart_num"),e.i18n.prop("ict_oneminer_chart_percent")],a=i.legend?i.legend.split(","):r.name.slice(1);a=t.map(a,function(t,n){return(n%2==0?e.i18n.prop("ict_oneminer_chart_bar"):e.i18n.prop("ict_oneminer_chart_line"))+t});var s=r.value,l=t.unzip(s),c=t.map(l[0],function(e){return e.replace(/Infinity/g,"∞")}),u=t.map(l.slice(1),function(e,n){return n%2==1?t.map(e,function(e){return 100*e}):e});return c.length>=2&&formatValue(c[1]-c[0]),genVisualReport({title:{text:"CDF Chart"},tooltip:{trigger:"axis",formatter:function(e){return e[0].name+t.map(e,function(e,t){return"<br>"+e.seriesName+": "+(t%2==1?Number(e.value).toFixed(2)+"%":Number(e.value).toFixed(0))}).join("")}},toolbox:{show:!0,feature:{dataZoom:{show:!0,title:{zoom:"Zoom",back:"Zoom back",iconStyle:{emphasis:{textPosition:"top"}}}},saveAsImage:{show:!0,title:"Save As Image",iconStyle:{emphasis:{textPosition:"top"}}}}},legend:{data:a},xAxis:{name:"value",data:c,type:"category",boundaryGap:!0,axisLabel:{rotate:30,interval:0}},yAxis:[{name:o[0],type:"value"},{name:o[1],type:"value",axisLabel:{formatter:"{value} %"}}],series:t.map(u,function(e,t){return t%2==0?{name:a[t],type:"bar",animation:!1,data:e,label:{normal:{show:!0,position:"top"}},lineStyle:{normal:{width:1}}}:{name:a[t],type:"line",animation:!1,yAxisIndex:1,lineStyle:{normal:{width:2}},smooth:!0,data:e}})})}function genBoxChart(e,n,i){var r=i.value,o=c.dataTool.prepareBoxplotData(t.unzip(r));return genVisualReport({backgroundColor:"#282131",title:[{text:"Boxplot",textStyle:{color:"#eeeeee"},left:"center"},{text:"UPPER: Q3 + 1.5 * IQR \nLOWER: Q1 - 1.5 * IQR",borderColor:"#666",borderWidth:1,textStyle:{fontSize:14,fontWeight:"normal",color:"#eeeeee"},left:"13%",top:"1%"}],tooltip:{trigger:"item",axisPointer:{type:"shadow"}},grid:{left:"10%",right:"10%",bottom:"20%"},toolbox:{show:!0,top:"5.5%",right:"9%",feature:{mark:{show:!0},dataZoom:{show:!0,title:{zoom:"Zoom",back:"Zoom back"},iconStyle:{emphasis:{textPosition:"top"}}},saveAsImage:{show:!0,title:"Save As Image",iconStyle:{emphasis:{textPosition:"top"}}}}},dataZoom:[{show:!0,start:0,end:100,textStyle:{fontSize:14,fontWeight:"normal",color:"#eeeeee"}},{type:"inside",start:0,end:100,textStyle:{fontSize:14,fontWeight:"normal",color:"#eeeeee"}},{show:!0,yAxisIndex:0,filterMode:"empty",width:20,height:"64%",showDataShadow:!1,left:"93%",textStyle:{fontSize:14,fontWeight:"normal",color:"#eeeeee"}}],xAxis:{type:"category",data:i.name,boundaryGap:!0,nameGap:20,nameLocation:"middle",axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},axisLabel:{show:!0,textStyle:{color:"#eeeeee"}},axisTick:{show:!0,lineStyle:{color:"#eeeeee"}},splitArea:{show:!1},splitLine:{show:!1}},yAxis:{type:"value",name:"value",axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},splitLine:{show:!0,lineStyle:{color:["#666"]}},splitArea:{show:!1}},series:[{name:"boxplot",type:"boxplot",itemStyle:{normal:{color:"#282131"}},data:o.boxData,tooltip:{formatter:function(e){return[e.name+": ","upper: "+e.data[4],"Q3: "+e.data[3],"median: "+e.data[2],"Q1: "+e.data[1],"lower: "+e.data[0]].join("<br/>")}}},{name:"outlier",type:"scatter",data:o.outliers,tooltip:{formatter:function(e){return[e.data[1]]}},symbolSize:3}]})}function genPdfChart(n,i,r){var o=i.legend?i.legend.split(","):r.name.slice(1),a=r.value,s=e.i18n.prop("ict_oneminer_chart_percent"),l=t.unzip(a),c=t.map(l[0],function(e){return e.replace(/Infinity/g,"∞")}),u=t.map(l.slice(1),function(e){return t.map(e,function(e){return 100*e})});return c.length>=2&&formatValue(c[1]-c[0]),genVisualReport({title:{text:"PDF Chart"},tooltip:{trigger:"axis",formatter:function(e){return e[0].name+t.map(e,function(e){return"<br>"+e.seriesName+": "+formatValue(e.value)+"%"}).join("")}},toolbox:{show:!0,feature:{dataZoom:{show:!0,title:{zoom:"Zoom",back:"Zoom back",iconStyle:{emphasis:{textPosition:"top"}}}},saveAsImage:{show:!0,title:"Save As Image",iconStyle:{emphasis:{textPosition:"top"}}}}},legend:{data:o},xAxis:{name:"value",data:c,type:"category",boundaryGap:!0,axisLabel:{rotate:30,interval:0}},yAxis:[{name:s,type:"value",axisLabel:{formatter:"{value} %"}}],series:t.map(u,function(e,t){return{name:o[t],type:"line",smooth:!0,data:e}})})}function genPieChart(e,n,i){var r=t.map(i.value,function(e){return{value:e[1],name:String(e[0])}});return genVisualReport({title:{text:i.name[0],x:"center"},tooltip:{show:!0,trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"vertical",left:"left",data:r.map(function(e){return e.name})},series:[{name:i.name[0],type:"pie",radius:"55%",center:["50%","60%"],data:r,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})}function genHeatMapChart(e,n,i){function genCorrByRow(e,n){return t.map(e,function(t,i){if(i>0)return[n[i-1],e[0],formatValue(t)]})}var r=i.value,o=i.name,a=t.unzip(r)[0],s=t.filter(t.map(o,function(e,t){if(t>0)return e}),function(e){return!t.isUndefined(e)}),l=t.map(r,function(e){return genCorrByRow(e,s)}),c=t.filter(t.reduce(l,function(e,t){return e.concat(t)},[]),function(e){return!t.isUndefined(e)}),u=t.map(c,function(e){return e[2]}),d=t.reduce(u,function(e,n){return t.isNaN(n)||t.isNaN(e[0])?e:[t.min([n,e[0]]),t.max([n,e[1]])]},[void 0,void 0]);d[0],d[1];return genVisualReport({title:{text:"HeatMap",left:"center"},tooltip:{position:"top"},animation:!1,toolbox:{show:!0,top:"5.5%",right:"9%",feature:{mark:{show:!0},dataZoom:{show:!0,title:{zoom:"Zoom",back:"Zoom back"},iconStyle:{emphasis:{textPosition:"top"}}},saveAsImage:{show:!0,title:"Save As Image",iconStyle:{emphasis:{textPosition:"top"}}}}},dataZoom:[{show:!0,start:0,end:100},{type:"inside",start:0,end:100},{show:!0,yAxisIndex:0,filterMode:"filter",width:30,height:"75%",showDataShadow:!1,left:"91.8%"}],grid:{left:"10%",right:"10%",bottom:"15%"},xAxis:{type:"category",data:s,nameLocation:"middle",axisLabel:{show:s.length<=3},splitArea:{show:!0}},yAxis:{type:"category",data:a,axisLabel:{show:a.length<=3},splitArea:{show:!0}},visualMap:{min:-1,max:1,precision:3,inRange:{color:["#313695","#4575b4","#74add1","#abd9e9","#e0f3f8","#ffffbf","#fdae61","#f46d43","#d73027","#a50026"]},calculable:!0,orient:"horizontal",left:"center",bottom:"7%",textStyle:{color:"#666",fontWeight:"bold"}},series:[{name:"Punch Card",type:"heatmap",data:c,label:{normal:{show:s.length<=15&&a.length<=15}},itemStyle:{emphasis:{shadowBlur:5,shadowColor:"rgba(102, 102, 102, 0.6)"}}}]})}function gen3DScatterChart(i,r,o){n(97);var s=o.value,l=o.name,c={group:0},u=t.map(l,function(e,t){return{name:0===t?"group":e,index:t}}),d={xAxis3D:l[1],yAxis3D:l[2],zAxis3D:l[3]},h=u.reduce(function(e,t){return e[t.name]=t.index,e}),p=[];s.forEach(function(e){e.forEach(function(t,n){n!==c.group&&(e[n]=parseFloat(t)||0)}),p=t.union(p,[e[0]])});var f=genColors(p.length),g={tooltip:{trigger:"item",formatter:function(e){var t=e.value;return d.xAxis3D+": "+t[0]+"<br>"+d.yAxis3D+": "+t[1]+"<br>"+d.zAxis3D+": "+t[2]+"<br>group: "+t[3]}},visualMap:[{show:!1,type:"piecewise",categories:p,dimension:3,inRange:{color:f},outOfRange:{color:["#ccc"]},top:20,textStyle:{color:"#fff"},realtime:!1}],xAxis3D:{name:d.xAxis3D,type:"value"},yAxis3D:{name:d.yAxis3D,type:"value"},zAxis3D:{name:d.zAxis3D,type:"value"},grid3D:{axisLine:{lineStyle:{color:"#fff"}},axisPointer:{lineStyle:{color:"#ffbd67"}}},series:[{type:"scatter3D",dimensions:[d.xAxis3D,d.yAxis3D,d.yAxis3D,"group"],data:s.map(function(e,t){return[e[h[d.xAxis3D]],e[h[d.yAxis3D]],e[h[d.zAxis3D]],e[0]]}),symbolSize:5,emphasis:{itemStyle:{color:"#fff"}}}],animationEasingUpdate:"cubicInOut",animationDurationUpdate:2e3},i=initChart("1070px","570px");i.chart.setOption(g);var m=u.map(function(e){return e.name});m=m.slice(1);var v=new a.GUI;["xAxis3D","yAxis3D","zAxis3D"].forEach(function(e){v.add(d,e,m).onChange(function(){s&&i.chart.setOption({xAxis3D:{name:d.xAxis3D},yAxis3D:{name:d.yAxis3D},zAxis3D:{name:d.zAxis3D},series:{dimensions:[d.xAxis3D,d.yAxis3D,d.yAxis3D,"group"],data:s.map(function(e,t){return[e[h[d.xAxis3D]],e[h[d.yAxis3D]],e[h[d.zAxis3D]],e[0]]})}})})}),window.addEventListener("resize",function(){i.chart.resize()});var _=e('<div id="controller" class="chart-gui-controller"></div>');return _.append(v.domElement),i.chartContent.prepend(_),i.chartContent}function genQQPlotChart(e,t,n){var i=n.name,n=n.value,r=i[0],o=i[1],a=t.empiricalType;return genVisualReport({title:{text:"QQplot for "+r+"--"+o,left:"center"},tooltip:{trigger:"axis",showDelay:0,formatter:function(e){var t=e[0].data;return r+"："+formatValue(t[1])+"<br>"+o+"："+formatValue(t[0])},axisPointer:{show:!0,type:"cross",lineStyle:{type:"dashed",width:1}},zlevel:1},toolbox:{show:!0,top:"4.5%",right:"9%",feature:{mark:{show:!0},dataZoom:{show:!0,title:{zoom:"Zoom",back:"Zoom back"},iconStyle:{emphasis:{textPosition:"top"}}},restore:{show:!0,title:"Restore",iconStyle:{emphasis:{textPosition:"top"}}},saveAsImage:{show:!0,title:"Save As Image",iconStyle:{emphasis:{textPosition:"top"}}}}},xAxis:[{type:"value",scale:!0,nameLocation:"middle",name:"poisson"==a||"binomial"==a?r:o}],yAxis:[{type:"value",scale:!0,name:"poisson"==a||"binomial"==a?o:r}],series:[{name:"poisson"==a||"binomial"==a?r+"--"+o:o+"--"+r,type:"scatter",large:!0,symbolSize:3.5,data:"poisson"==a||"binomial"==a?n:n.map(function(e){return e.reverse()})}]})}function genRadarChart(e,n,i){var r=i.value,o=t.initial(i.name),a=t.map(r,t.last),s=t.map(o,function(e,t){return{name:e,max:Number(r[0][t]).toFixed(1)}}),l=t.map(r,function(e,t){return{value:e,name:a[t]}}),c=t.rest(a);return 2==a.length&&"MEDIAN"===a[1]&&(c=[]),genVisualReport({title:{text:"Radar Chart"},tooltip:{},toolbox:{show:!0,feature:{saveAsImage:{show:!0,title:"Save As Image",iconStyle:{emphasis:{textPosition:"top"}}}}},legend:{data:c},radar:{indicator:s},series:[{name:"Radar",type:"radar",data:l}]})}function genMultiScatterChart(n,i,r){function genMsSeriesData(e,t,n,i){return e.map(function(e,r){return[e[t[n]],e[t[i]],e[0],n,i,r]})}function genMsSeries(e,t,n,i,r){var o=n[i],a=n[r],s=i+"-"+r;return{zlevel:1,type:"scatter",name:"data",xAxisId:s,yAxisId:s,symbolSize:4,itemStyle:{emphasis:{color:"#fff"}},animationThreshold:5e3,progressiveThreshold:5e3,data:genMsSeriesData(e,t,o,a)}}function makeAxis(e,t,n,i,r,o){var a=r[t.split("-")[e]];return o[n]=a,{id:t,name:n,nameLocation:i,nameGap:"middle"===i?30:10,gridId:t,splitLine:{show:!0},axisLine:{lineStyle:{color:a}},axisLabel:{textStyle:{color:a}},axisTick:{lineStyle:{color:a}}}}function makeDataZoom(e){return c.util.extend({type:"slider",fillerColor:"rgba(255,255,255,0.1)",borderColor:"#777",handleIcon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4v1.3h1.3v-1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.4h6.6V19.6z",handleSize:"60%",handleStyle:{color:"#aaa"},textStyle:{color:"#aaa"},filterMode:"empty",realtime:!1},e)}var o=r.value.map(function(e,t){return e[0]=String(e[0]).replace(/\./g,"_"),e}),s=r.name,l={group:0},u=t.map(s,function(e,t){return{name:0===t?"group":e,index:t}}),d={xAxisLeft:"#2A8339",xAxisRight:"#367DA6",yAxisTop:"#A68B36",yAxisBottom:"#BD5692"},h={},p={xAxisLeft:s[1],yAxisTop:s[2],xAxisRight:s[3],yAxisBottom:s[4]},f=u.reduce(function(e,t){return e[t.name]=t.index,e}),g=[];o.forEach(function(e){e.forEach(function(t,n){n!==l.group&&(e[n]=parseFloat(t)||0)}),g=t.union(g,[e[0]])});var m=genColors(g.length),v=function(e,t,n,i,r,o,a){return{axisPointer:{show:!0,snap:!0,lineStyle:{type:"dashed"},label:{show:!0,margin:6,backgroundColor:"#556",textStyle:{color:"#fff"}},link:[{xAxisId:["xAxisLeft-yAxisTop","xAxisLeft-yAxisBottom"]},{xAxisId:["xAxisRight-yAxisTop","xAxisRight-yAxisBottom"]},{yAxisId:["xAxisLeft-yAxisTop","xAxisRight-yAxisTop"]},{yAxisId:["xAxisLeft-yAxisBottom","xAxisRight-yAxisBottom"]}]},xAxis:[makeAxis(0,"xAxisLeft-yAxisTop","xAxisLeft","middle",o,a),makeAxis(0,"xAxisLeft-yAxisBottom","xAxisLeft","middle",o,a),makeAxis(0,"xAxisRight-yAxisTop","xAxisRight","middle",o,a),makeAxis(0,"xAxisRight-yAxisBottom","xAxisRight","middle",o,a)],yAxis:[makeAxis(1,"xAxisLeft-yAxisTop","yAxisTop","end",o,a),makeAxis(1,"xAxisLeft-yAxisBottom","yAxisBottom","end",o,a),makeAxis(1,"xAxisRight-yAxisTop","yAxisTop","end",o,a),makeAxis(1,"xAxisRight-yAxisBottom","yAxisBottom","end",o,a)],grid:[{id:"xAxisLeft-yAxisTop",left:80,top:50,width:"35%",height:"35%"},{id:"xAxisLeft-yAxisBottom",left:80,bottom:80,width:"35%",height:"35%"},{id:"xAxisRight-yAxisTop",right:50,top:50,width:"35%",height:"35%"},{id:"xAxisRight-yAxisBottom",right:50,bottom:80,width:"35%",height:"35%"}],dataZoom:[makeDataZoom({width:"35%",height:20,left:80,bottom:10,xAxisIndex:[0,1]}),makeDataZoom({width:"35%",height:20,right:50,bottom:10,xAxisIndex:[2,3]}),makeDataZoom({orient:"vertical",width:20,height:"35%",left:10,top:50,yAxisIndex:[0,2]}),makeDataZoom({orient:"vertical",width:20,height:"35%",left:10,bottom:80,yAxisIndex:[1,3]})],visualMap:[{show:!1,type:"piecewise",categories:n,dimension:2,inRange:{color:r},outOfRange:{color:["#ccc"]},top:20,textStyle:{color:"#fff"},realtime:!1}],series:[genMsSeries(e,t,i,"xAxisLeft","yAxisTop"),genMsSeries(e,t,i,"xAxisLeft","yAxisBottom"),genMsSeries(e,t,i,"xAxisRight","yAxisTop"),genMsSeries(e,t,i,"xAxisRight","yAxisBottom")],animationEasingUpdate:"cubicInOut",animationDurationUpdate:2e3}}(o,f,g,p,m,d,h),n=initChart("1070px","570px");n.chart.getZr().configLayer(1,{motionBlur:.5}),n.chart.setOption(v);var _=u.map(function(e){return e.name});_=_.slice(1);var y=new a.GUI;["xAxisLeft","yAxisTop","xAxisRight","yAxisBottom"].forEach(function(e){y.add(p,e,_).onChange(function(){o&&(h[p.xAxisLeft]=d.xAxisLeft,h[p.xAxisRight]=d.xAxisRight,h[p.yAxisTop]=d.yAxisTop,h[p.yAxisBottom]=d.yAxisBottom,n.chart.setOption({xAxis:[{name:"xAxisLeft"},{name:"xAxisLeft"},{name:"xAxisRight"},{name:"xAxisRight"}],yAxis:[{name:"yAxisTop"},{name:"yAxisBottom"},{name:"yAxisTop"},{name:"yAxisBottom"}],series:t.map([["xAxisLeft","yAxisTop"],["xAxisLeft","yAxisBottom"],["xAxisRight","yAxisTop"],["xAxisRight","yAxisBottom"]],function(e){return{data:genMsSeriesData(o,f,p[e[0]],p[e[1]])}})}))})}),window.addEventListener("resize",function(){n.chart.resize()});var x=e('<div id="controller" class="chart-gui-controller"></div>');return x.append(y.domElement),n.chartContent.prepend(x),n.chartContent}function genWebGisVisual(t,n,i,r){var n=(i.operatorMd5||s.md5(t.processName+"_"+l.getUsername()+"_"+t.name),{params:n,data:i,iteration:r,md5:s}),o=e("<iframe>").attr({id:"gis-frame",width:"100%",height:"630px",style:"border:0",src:function(){return"/gis/static/multi.html?url_params="+encodeURIComponent(JSON.stringify(n))}()}),t=initChart("1070px","570px");return t.chartContent.css({height:"650px"}).addClass("gis-chart"),t.chartContent.html("").append(o),t.chartContent}function formatValue(e){var n=Number(e);return t.isNaN(n)?e:n.toFixed(3)}var c=n(14),u=function(e){var t=[],i={},r=n(18).getInputPortsName();return d(e).forEach(function(e,n){var o=h(e),a=r[n]+": "+o;i[a]=!0,t.push({name:a,type:"line",smooth:!1,itemStyle:{normal:{color:getColor(n)}},data:e})}),{seriesArray:t,selectedObj:i}},d=function(e){for(var t=[],n=e[0]&&e[0].length||0,i=0;i<n;i+=3)t.push(e.map(function(e){return e.slice(i,i+3)}));return t},h=function(e){for(var t=e.map(function(e){return Number(e[0])}),n=e.map(function(e){return Number(e[1])}),i=(e.map(function(e){return Number(e[2])}),0),r=0;r<=100;r++)i+=(t[r+1]-t[r])*((n[r]+n[r+1])/2);return formatValue(i)},p=function(e){var t=e.length,n=f(e)/t,i=e.map(function(e){return Math.pow(e-n,2)}),r=Math.sqrt(f(i)/t);return{avg:n,std:r}},f=function(e){return e.reduce(function(e,t){return e+t})},g=function(e,t,n){var i=n.name,r="Theoretical quantiles",o=i[0],n=n.value,a=n.map(function(e){return[e[1],e[0]]}),s=n.map(function(e){return[e[1],e[2]]}),l=p(n.map(function(e){return Number(e[0])})),c=l.avg,u=l.std;return genVisualReport({title:[{text:"Probability Plot",left:"center"},{text:"AVG: "+c.toFixed(3)+" \nSTD: "+u.toFixed(3),borderColor:"#666",borderWidth:1,textStyle:{fontSize:14,fontWeight:"normal",color:"#eeeeee"},left:"10%",top:"2%"}],tooltip:{trigger:"axis",showDelay:0,formatter:function(e){var t=e[0].data;return r+"："+formatValue(t[0])+"<br>"+o+"："+formatValue(t[1])},axisPointer:{show:!0,type:"cross",lineStyle:{type:"dashed",width:1},label:{backgroundColor:"#242b36"}},zlevel:1},toolbox:{show:!0,top:"4.5%",right:"9%",feature:{mark:{show:!0},dataZoom:{show:!0,title:{zoom:"Zoom",back:"Zoom back"},iconStyle:{emphasis:{textPosition:"top"}}},restore:{show:!0,title:"Restore",iconStyle:{emphasis:{textPosition:"top"}}},saveAsImage:{show:!0,title:"Save As Image",iconStyle:{emphasis:{textPosition:"top"}}}}},xAxis:[{type:"value",scale:!0,nameLocation:"middle",nameGap:25,name:r}],yAxis:[{type:"value",scale:!0,nameLocation:"middle",nameGap:25,nameRotate:0,name:o}],series:[{name:r+"--"+o,type:"scatter",large:!0,symbolSize:3.5,data:a},{name:"xxx",type:"line",itemStyle:{normal:{color:"white"}},data:[s.shift(),s.pop()]}]})};return{chart:chart}}.apply(t,i))&&(e.exports=r)},function(e,t,n){(function(i){function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r,o;r=[n(13),n(1),n(4)],void 0!==(o=function(e,t,n){return function(e){function AuthDialog(t,n,i,r,o){return _classCallCheck(this,AuthDialog),_possibleConstructorReturn(this,e.call(this,t,n,i,r,o))}return _inherits(AuthDialog,e),AuthDialog.prototype.setProperties=function(){this.title=i.i18n.prop("ict_oneminer_dialog_auth_permission"),this.position={my:"center",at:"top+200px"}},AuthDialog.prototype.init=function(){var e=this;i.get(t.genApiUrl("process/permission/list"),{processName:this.data.expName}).done(function(t){e.auths=t||[];var n=e.auths.map(function(e){return e.userId});i(".auth-users").html(e.getUserSectionHtml(n));var r=i(".auth-users>li:first");r.length?r.click():i(".auth-users").click()}),this.registerUserActions()},AuthDialog.prototype.registerUserActions=function(){var e=this;i(".auth-users").on("click",function(t){e.authClick(t)}),i(".auth-types").on("change","input",function(t){e.authChange(t)}),i(".add-user").on("click",function(t){e.addUser(t)}),i(".remove-user").on("click",function(t){e.removeUser(t)})},AuthDialog.prototype.authClick=function(e){var t=e.target;if("LI"===t.nodeName){i(".auth, #auth-all").attr("disabled",!1),i(".remove-user").removeClass("disabled");var n=t.dataset.user,r=this.getAuthByUserName(n);this.showAuth(r),i(t).addClass("li-selected").siblings().removeClass("li-selected")}else i(".li-selected").removeClass("li-selected"),i(".auth, #auth-all").prop("checked",!1).attr("disabled",!0),i(".remove-user").addClass("disabled")},AuthDialog.prototype.authChange=function(e){var t=e.target,n=t.dataset.auth;this.checkAuthRules(n,t),this.setAuth()},AuthDialog.prototype.removeUser=function(e){var t=e.target;if(!i(t).hasClass("disabled")){i(t).addClass("disabled");var n=i(".li-selected").data("user");i(".li-selected").remove(),this.removeAuthByUserName(n);var r=i(".auth-users").children().last();r.length?r.click():i(".auth-users").click()}},AuthDialog.prototype.getUserSectionHtml=function(e){var t="";return e.forEach(function(e){t+='<li data-user="'+e+'">'+e+"</li>"}),t},AuthDialog.prototype.addUser=function(){var e=this,n=new t.Dialog(480,200);n.open=function(){var t=e.getUserDialogHtml();i(this).append(t),e.initAutoComplete(i(this).find("input"))},n.setConfirmHandler(function(){var t=i(this).find("input");if(""===t.val().trim())return t.focus();var n=t.val();e.auths.some(function(e){return e.userId===n})||(e.auths.push({userId:n,change:1,execute:1,read:1}),i(".auth-users").append('<li data-user="'+n+'">'+n+"</li>").children().last().click()),i(this).dialog("close")}),i("<div>").dialog(n).dialog("open")},AuthDialog.prototype.getUserDialogHtml=function(){return'<section style="display:flex;align-items:center;justify-content:center;margin-top:18px;">\n                        <div style="margin-right:20px">\n                            <span class="redStar">*</span>\n                            '+i.i18n.prop("ict_oneminer_dialog_auth_user")+'\n                        </div>\n                        <input class="form-control" maxlength=255 style="width:280px" placeholder="'+i.i18n.prop("ict_oneminer_dialog_auth_user_placeolder")+'">\n                    </section>'},AuthDialog.prototype.setAuth=function(){var e=i(".auth-dialog .li-selected").data("user"),t=["change","execute","read"];this.auths=this.auths.reduce(function(n,r,o){return e===r.userId&&t.forEach(function(e){r[e]=i("#auth-"+e).prop("checked")?1:0}),n.push(r),n},[])},AuthDialog.prototype.removeAuthByUserName=function(e){this.auths=this.auths.reduce(function(t,n,i){return e!==n.userId&&t.push(n),t},[])},AuthDialog.prototype.getAuthByUserName=function(e){return this.auths.filter(function(t){return t.userId===e})[0]},AuthDialog.prototype.showAuth=function(e){["change","execute","read"].forEach(function(t){i("#auth-"+t).prop("checked",e[t])});var t=Array.from(i(".auth")).every(function(e){return e.checked});i("#auth-all").prop("checked",t)},AuthDialog.prototype.checkAuthRules=function(e,t){var n=i(".auth").eq(0)[0],r=i(".auth").eq(1)[0],o=i(".auth").eq(2)[0];switch(e){case"all":i(".auth").prop("checked",t.checked);break;case"change":t.checked&&(r.checked=!0,o.checked=!0);break;case"execute":t.checked?o.checked=!0:n.checked=!1;break;case"read":t.checked||(n.checked=!1,r.checked=!1)}var a=Array.from(i(".auth")).every(function(e){return e.checked});i("#auth-all").prop("checked",a)},AuthDialog.prototype.confirm=function(){var e=this;i.post(t.genApiUrl("process/permission/update"),{processName:this.data.expName,permissionInfo:JSON.stringify(this.auths)}).done(function(t){if("true"===t.result)e._close();else{var r=t.errorUserList.join(",");n.warning(i.i18n.prop("ict_oneminer_message_auth_error",r))}})},AuthDialog.prototype.initAutoComplete=function(e){var n=t.doGet(t.genApiUrl("user/list"))||[];n=n.filter(function(e){return e!==i("#username").text()}),e.autocomplete({minLength:0,source:function(e,t){for(var r=new RegExp(i.ui.autocomplete.escapeRegex(e.term),"i"),o=n,a=[],s=0;s<o.length;s++){var l=o[s];if(!l||e.term&&!r.test(l)||a.push({label:l,value:l}),a.length>100){a.push({label:i.i18n.prop("ict_oneminer_tip_more_items"),value:"maxRepSizeReached"});break}}t(a)},select:function(e,t){if("maxRepSizeReached"==t.item.value)return!1},focus:function(e,t){if("maxRepSizeReached"==t.item.value)return!1}}).click(function(){i(this).autocomplete("search","")})},AuthDialog.prototype.render=function(){return'<article class="auth-dialog">\n                        <section>\n                            <h6>'+i.i18n.prop("ict_oneminer_dialog_auth_user")+'</h6>\n                            <ul class="auth-users"></ul>\n                            <footer class="operate-btn">\n                                <button class="btn btn-primary btn-sm add-user">add</button>\n                                <button class="btn btn-primary btn-sm remove-user">remove</button>\n                            </footer>\n                        </section>\n                        <section>\n                            <h6>'+i.i18n.prop("ict_oneminer_dialog_auth_permission")+'</h6>\n                            <ul class="auth-types">\n                                <li>\n                                    <span>all</span>\n                                    <input type="checkbox" id="auth-all" data-auth="all"><label for="auth-all"></label>\n                                </li>\n                                <li>\n                                    <span>change</span>\n                                    <input type="checkbox" class="auth" id="auth-change" data-auth="change"><label for="auth-change"></label>\n                                </li>\n                                <li>\n                                    <span>execute</span>\n                                    <input type="checkbox" class="auth" id="auth-execute" data-auth="execute"><label for="auth-execute"></label>\n                                </li>\n                                <li>\n                                    <span>read</span>\n                                    <input type="checkbox" class="auth" id="auth-read" data-auth="read"><label for="auth-read"></label>\n                                </li>\n                            </ul>\n                        </section>\n                    </article>'},AuthDialog}(e)}.apply(t,r))&&(e.exports=o)}).call(t,n(0))},function(e,t,n){(function(i){function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r,o;r=[n(46),n(1)],void 0!==(o=function(e,t){return function(e){function SparkConfig(t,n,i,r){return _classCallCheck(this,SparkConfig),_possibleConstructorReturn(this,e.call(this,t,n,i,r))}return _inherits(SparkConfig,e),SparkConfig.prototype.init=function(){var e=this,n=this,r=i(this.el).find("table tbody"),o=t.getValue(this.paramType,this.values);o&&(JSON.parse(o).forEach(function(t){var n,o=(n={},n[e.keyType.key]=t[0],n[e.valueType.key]=t[1],n),a=e.stringcategoryField(null,e.keyType,o,e.cell);a.attr("data-key",!0);var s=e.handleParam(null,e.valueType,o,e.cell);r.append(i("<tr/>").append(i("<td/>").append(a)).append(i("<td/>").append(s)))}),r.children("tr").first().addClass("active")),r.on("click","tr",function(){i(this).addClass("active").siblings().removeClass("active")}).on("input","input",function(){n.checkKeyValue(this)}).on("change","select",function(){n.checkKeyValue(this)})},SparkConfig.prototype.addColumn=function(){var e=i(this.el).find("table tbody"),n=this.stringcategoryField(null,this.keyType,{},this.cell),r=this.handleParam(null,this.valueType,{},this.cell);n.attr("data-key",!0),e.append(i("<tr/>").append(i("<td/>").append(n)).append(i("<td/>").append(r))),e.children("tr.active").length||e.children("tr").first().addClass("active"),t.doNiceScroll(i(this.el))},SparkConfig.prototype.applyColumn=function(){var e=this;if(this.checkValidity()){var t=i(this.el).find("table tbody"),n=Array.from(t.children("tr")).map(function(t){return[e.getElementValue(t,"key"),e.getElementValue(t,"value")]}),r=JSON.stringify(n);r!==this.values[this.paramType.key]&&(this.values[this.paramType.key]=r,e.processManager.methodProxy.getMethod("setSavable")(!0)),this._close()}},SparkConfig.prototype.stringcategoryField=function(e,n,r,o){var a=this,s=i("<div/>",{class:"ui-front",style:"position:relative"}),l=i("<input/>",{class:"form-control",id:n.key});s.append(l),l.val(t.getValue(n,r)),n.isRequired&&""===l.val()&&l.addClass("invalid"),l.autocomplete({minLength:0,source:n.categories,select:function(e,t){i(this).parents("tr").children("td").last().find("input").val(a.keyType.categoryList[t.item.value]).removeClass("invalid"),setTimeout(function(){a.checkKeyValidity()},0)},open:function(){i(this).next().css("z-index",101).parent().css("z-index","auto"),t.doNiceScroll(i(".header-fixed").parent())},close:function(){i(".header-fixed").parent().getNiceScroll().resize()}}).click(function(){i(this).autocomplete("search","")}),l.on({keypress:function(e){13===e.keyCode&&l.blur()},input:function(){var e=i(this).parents("tr").children("td").last().find("input"),t=a.keyType.categoryList[this.value];t&&e.val(t).removeClass("invalid")}});var c=function(){n.isRequired&&""===l.val()?l.addClass("invalid"):l.removeClass("invalid");var t=l.val()||"";t!==r[n.key]&&a.modifyConfirm(e,l,n,r,t,null,null,a.currentOperator)};return l.on("blur",c),s},SparkConfig}(e)}.apply(t,r))&&(e.exports=o)}).call(t,n(0))},function(e,t,n){(function(i){function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r,o;r=[n(6),n(1),n(7),n(13),n(4)],void 0!==(o=function(e,t,n,r,o){var a=function(e){var t=e.existList.join(","),n=e.errorFormatList.join(",");return t&&!n?i.i18n.prop("ict_oneminer_template_existed",t):!t&&n?i.i18n.prop("ict_oneminer_template_illegal",n):t&&n?i.i18n.prop("ict_oneminer_template_existed_and_illegal",t,n):i.i18n.prop("ict_oneminer_message_upload_failed")};return function(e){function Upload(t,n,i){return _classCallCheck(this,Upload),_possibleConstructorReturn(this,e.call(this,t,n,i))}return _inherits(Upload,e),Upload.prototype.setProperties=function(){this.title=i.i18n.prop("ict_oneminer_dialog_title_upload")},Upload.prototype.init=function(){i("#uploadFile").change(function(){"zip"!==i(this).val().split(".").pop().toLowerCase()?(o.error(i.i18n.prop("ict_oneminer_process_title_check_filetype")),i(".file-name, #uploadFile").val("")):i(".file-name").val(this.value.split("\\").pop())}),i(".upload-btn").click(function(){i("#uploadFile").click()})},Upload.prototype.confirm=function(){var e=this,r=new FormData;if(!i("#uploadFile").val().split("\\").pop())return i(".file-name").focus();var s=i("#uploadFile")[0].files[0];r.append("file",s,encodeURI(s.name));var l=function(n){"success"===(n&&n.status)?(o.success(i.i18n.prop("ict_oneminer_message_upload_success"),"",t.toastrConfig),e._close(),i("#home").getNiceScroll().resize()):o.error(a(n)),e.uploadSuccess()};n.upload(this.url,r,l,{})},Upload.prototype.registerUploadConfig=function(e){var t=e.url,n=e.success;this.url=t,this.uploadSuccess=n},Upload.prototype.render=function(){return'<div class="upload-dialog-content">\n                        <span>'+i.i18n.prop("ict_oneminer_process_title_file_name")+'</span><input id="uploadFile" type="file"/>\n                        <input class="form-control file-name" type="text" placeholder=\''+i.i18n.prop("ict_oneminer_process_title_placeholder")+'\' readonly="readonly"/>\n                        <input class="btn btn-primary btn-sm upload-btn" type="button" value=\''+i.i18n.prop("ict_oneminer_process_title_file_select")+"'>\n                    </div>"},Upload}(r)}.apply(t,r))&&(e.exports=o)}).call(t,n(0))},function(e,t,n){var i,r;i=[n(0),n(31),n(5),n(4),n(6),n(18),n(48),n(1),n(8),n(3),n(7),n(50)],void 0!==(r=function(e,t,i,r,o,a,s,l,c,u,d,h){function init(t,i,s,u,d,m,v){if(w.mxClient.isBrowserSupported()){w.mxConstants.MIN_HOTSPOT_SIZE=16,w.mxConstants.DEFAULT_HOTSPOT=1,w.mxGraphHandler.prototype.guidesEnabled=!0,w.mxGraphHandler.prototype.previewColor="#00FF00",w.mxGuide.prototype.isEnabledForEvent=function(e){return!w.mxEvent.isAltDown(e)},w.mxEvent.disableContextMenu(t),f=new w.mxGraphModel,p=new w.mxGraph(t,f),g=p.getDefaultParent(),p.outline=new w.mxOutline(p,i),p.getModel().addListener(w.mxEvent.UNDO,s),p.getView().addListener(w.mxEvent.UNDO,s),p.getView().addListener(w.mxEvent.SCALE_AND_TRANSLATE,s),p.getView().addListener(w.mxEvent.SCALE,s),p.getView().addListener(w.mxEvent.TRANSLATE,s),p.getSelectionModel().addListener(w.mxEvent.CHANGE,function(e,t){var n=t.getProperty("added");n&&n.forEach(function(e){e.value&&e.value.isOperator&&(e.value.selected=!1)});var i=t.getProperty("removed");i&&i.forEach(function(e){e&&e.value&&e.value.isOperator&&(e.value.selected=!0)}),L(),u(),k(),N?setTimeout(function(){p.refresh()},500):p.refresh()});var _="onwheel"in document?"wheel":"onmousewheel"in document?"mousewheel":"DOMMouseScroll";e(t).on(_,function(e){var t=0;e.originalEvent.wheelDelta?t=e.originalEvent.wheelDelta:e.originalEvent.deltaY&&(t=-e.originalEvent.deltaY),t&&(e.preventDefault(),t>0?p.zoomIn():p.zoomOut())}),p.setAllowDanglingEdges(!1),p.setDropEnabled(!0),p.setCellsResizable(!0),p.setSwimlaneNesting(!0),p.setPanning(!0),p.cellsEditable=!0,p.cellsCloneable=!1,p.foldingEnabled=!0,p.setTooltips(!0),p.setHtmlLabels(!0),p.setConnectable(!0),p.keepEdgesInBackground=!1,p.popupMenuHandler.autoExpand=!0,p.getEditingValue=function(e){if(e.value&&e.value.isOperator)return e.value.description||e.value.name};var y=p.cellLabelChanged;p.cellLabelChanged=function(e,t,n){var i=arguments,r=this;if(t=t.replace(/[\r\n]/g,""),e.value&&e.value.isOperator){t=a.getOperatorDescription(t);var o=e.value,s=JSON.parse(JSON.stringify(o));s.description=t,a.setOperatorDescription(e.id,t),t=s,y.apply(r,i)}},p.popupMenuHandler.factoryMethod=function(t,n,i){getExperimentFlag()&&(document.activeElement.blur(),n&&(n.value&&n.value.isOperator&&!n.value.invalid&&d(t,n,i),n.value&&n.value.isPort||t.addItem(e.i18n.prop("ict_oneminer_popup_menu_delete"),null,function(){var e=function(){delZaip(),p.removeCells()};F(n.value.name,e)},null,"fa fa-trash-o")))},p.connectionHandler.targetConnectImage=!0,p.connectionHandler.getConnectImage=function(e){return new w.mxImage(e.style[w.mxConstants.STYLE_IMAGE],16,16)},p.addListener(w.mxEvent.CLICK,function(t,i){var r=t.lastEvent.which;f.filterDescendants(function(e){return f.isEdge(e)}).forEach(function(e){return p.removeCellOverlays(e)});var o=i.getProperty("cell");if(1===r&&(o&&o.isVertex()?m():0===p.getSelectionCells().length?e("#east-panel").is(":hidden")?m():v():m()),o&&o.isEdge()){if(!p.getCellOverlays(o)){var a=new w.mxCellOverlay(new w.mxImage(n(70),16,16),"Delete",null,null,null,"pointer");a.addListener(w.mxEvent.CLICK,function(e,t){var n=function(){p.removeCells()};F(o.target.parent.value.name,n)}),p.addCellOverlay(o,a)}}});new w.mxKeyHandler(p).bindKey(46,function(t){if(p.isEnabled()&&p.getSelectionCell()){var n=function(){delZaip(),p.removeCells()};e("#visual").is(":hidden")?F(p.getSelectionCell().value.name,n):h.delCallBack()}}),p.addListener(w.mxEvent.CELL_CONNECTED,function(e,t){if(!a.getLoadingStatus()){var n=t.getProperty("edge"),i=n.source,o=n.target;if(i&&o){var s=1===o.getEdgeCount();if(s||r.error("one port one edge"),!s||i.value.portType===c.PORT_OUTPUT_TYPE&&o.value.portType===c.PORT_INPUT_TYPE||(s=!1,r.error("edge source must be outport, target be inport")),s&&i.parent.id===o.parent.id&&(s=!1,r.error("target op should not be source op")),s){o.value.data=i.value.data;""===n.value||(a.setModifiedOperators(o.parent.value.name),a.updateData())}else p.removeCells([n]);handleMultiPortOperators(),w.mxEvent.consume(t)}}}),p.isValidDropTarget=function(e,t,n){return this.isSwimlane(e)},p.isValidRoot=function(e){return this.isValidDropTarget(e)},p.isCellSelectable=function(e){return!this.isCellLocked(e)},p.convertValueToString=function(e){return e.value?e.value.operatorExecType===c.ZAIPENTRANCE?getZaipOperatorDiv(e.value):e.value.description?e.value.isGroup?e.value.description:e.value.isOperator?getOperatorDiv(e.value):"":e.value.name?e.value.isGroup?e.value.name:e.value.isOperator?getOperatorDiv(e.value):"":e.value:""},p.getTooltip=function(e,t,n,i){var r=e.cell;if(r.value&&r.value.portType){var o=getTooltipContent(r).get(0),a=new w.mxWindow(null,o,n,i,C,S,!1,!1);x(a,n,i),a.setScrollable(!0),a.setMinimizable(!1),a.destroyOnClose=!0,a.setVisible(!0),l.doNiceScroll(".mxWindowPane");var s={mouseMove:function(e,t){a.destroy()},mouseDown:function(e,t){},mouseUp:function(e,t){}};a.addListener(w.mxEvent.DESTROY,function(){p.removeMouseListener(s)}),p.addMouseListener(s)}};var x=function(t,n,i){var r=e(".mxWindow").height(),o=i-e(".top-side").height()-e(".title-bar").height(),a=e("#graph").height()-o;if(a<r)if(o>a){var s=Math.min(o,r);t.setSize(C,s),t.setLocation(n,i-s)}else t.setSize(C,a)};p.addListener(w.mxEvent.ADD_CELLS,function(e,t){t.getProperty("cells").forEach(function(e){e.isVertex()&&e.value&&e.value.isOperator&&a.addOperator({id:e.id,name:e.value.name,description:e.value.description,type:e.value.type,isGroup:e.value.isGroup,multiPort:!o.isEmpty(e.value.inputs)&&e.value.inputs[0].multi,params:e.value.params||{}})})}),p.addListener(w.mxEvent.REMOVE_CELLS,function(e,t){t.getProperty("cells").forEach(function(e){e.isVertex()&&e.value?removeCellAndChildren(e):e.isEdge()&&(e.target.value.data=null,e.target.value.multi&&handleMultiInputPorts(e.target.parent))}),a.updateData()});new w.mxRubberband(p);configureStylesheet(p),q()}else w.mxUtils.error("browser not support mxGraph！",200,!1)}function delZaip(){p.getSelectionCells().forEach(function(e){if(e&&e.value&&e.value.operatorExecType&&e.value.operatorExecType==c.ZAIPENTRANCE){var t=a.getProcessInfo(!0).params.zaip_id,n=t+a.getProcessName()+e.value.name;h.clearCacheTrain(n)}})}function removeCellAndChildren(e){e.value.isGroup&&!o.isEmpty(e.children)&&e.children.forEach(function(e){removeCellAndChildren(e)}),a.removeOperatorById(e.id)}function getTooltipContent(t){var n=e("<div/>",{class:"container-fluid"});n.append(e("<h4/>").html(t.value.name)),t.value.desc&&n.append(e("<span/>").html(t.value.desc));var i=t.value.data;if(i&&i.type)if(i.type===c.METADATA_EXAMPLE_VIEW){var r=e("<table/>",{class:"table table-striped table-bordered table-hover black-header"});n.append(r);var o=["name","type","role"],a=[];o.forEach(function(e){a.push({title:e,data:e,orderable:!1})}),r.DataTable({dom:"<'row'<'col-sm-12'tr>>",autoWidth:!1,paging:!1,ordering:!1,info:!1,searching:!1,data:JSON.parse(i.result),columns:a})}else i.type===c.METADATA_PLAIN_TEXT?n.append(e("<span/>").html(i.result)):n.append(e("<span/>").html("unsupported metadata type: "+i.type));else n.append(e("<span/>").html("no data"));return n}function createTrainTip(t,n,i){e(".train-tip").remove();var r="";for(var o in t){var a=o.toLowerCase();r+='<div class="train-li">\n                        <span class="status-circle '+a+'"></span>\n                        <span class="train-num">'+t[o]+"</span>\n                        <span>"+e.i18n.prop("Zaip_"+a)+"</span>\n                   </div>"}var s='<div class="train-tip">\n                             '+r+"\n                        </div>";e("body").append(s),e(".train-tip").css({top:n-180,left:i})}function runStatusDiv(t,n){var i="",r=n.runStatus;for(var o in r){var a=o.toLowerCase();"queued"!==a&&"cancelled"!==a&&(i+='<div class="pull-left zaip-status-li">\n                            <span class="status-circle '+a+'"></span>\n                            <span class="status-'+a+'">'+r[o]+"</span>\n                        </div>")}var s=e("<div/>",{class:"pull-left train-more",data:r}).append(e("<i>",{class:"fa fa-ellipsis-h"}));t.append(i).append(s),s.unbind("hover"),s.hover(function(t){createTrainTip(e(this).data(),t.clientY,t.clientX)},function(){e(".train-tip").remove()})}function getSourceByOperatorName(e,t,n,i,r){var o=a.getProcessInfo();if(!o||0===o.operators.length)return"";var s=[],l=getOperatorCellByName(e,t);(l&&l.children||[]).forEach(function(e){e.value.portType===n&&(e.edges||[]).forEach(function(e){s.push(e.source.parent)})});var c=s.filter(function(e){return e.value.operatorExecType===r}),u=c[0]&&c[0].id,d=o.operators.filter(function(e){return e.id==u});return d[0]&&d[0][i]||""}function zaipValidity(e){var t=a.getProcessInfo(),n=t.operators.filter(function(t){return t.name==e})[0].params;if(!n.input_columns||0==JSON.parse(n.input_columns).length)return void r.error("Please set the parameter input columns");if(""==n.output_column)return void r.error("Please set the parameter output columns");var i=t.params.zaip_id,o=getSourceByOperatorName(p,e,c.PORT_INPUT_TYPE,"params",c.ZAIPDATA);if(!o)return void r.error("ZaipData missing");var s=getOperatorCellByName(p,e);h.init(s.value.initName,i,a.getProcessName(),n.input_columns,n.output_column,o,I,s.value.isDrag)}function getZaipOperatorDiv(t){var n=e("<div/>",{class:"frontFontDiv"}).append(e("<i/>",{class:t.icon?t.icon:"fa fa-puzzle-piece"})),i=e("<div/>",{class:"operatorNameDiv",title:t.name}).html(t.name),r=e("<div/>",{class:"backFontDiv "+t.status.type,title:t.status.msg});I&&r.append(e("<i/>",{class:t.status.icon}));var o=e("<div/>",{class:"zaipBox"}),a=e("<div/>",{class:"divTop"}),s=e("<div/>",{class:"divMain"});t.selected&&o.addClass("selected"),t.invalid&&o.addClass("invalid");var l=e("<div/>",{class:"backFontDiv openZaipDiv",title:e.i18n.prop("MAXIMIZE")});l.append(e("<i/>",{class:"fa fa-window-maximize"}));var c=e("<div/>",{class:"runStatus clearfix"});return a.append(l).append(c),runStatusDiv(c,t),s.append(n).append(i).append(r),o.append(a).append(s),l.on("click",function(){zaipValidity(t.name)}),l.hover(function(){N=!0},function(){N=!1}),o[0]}function getOperatorDiv(t){var n=e("<div/>",{class:"frontFontDiv"}).append(e("<i/>",{class:t.icon?t.icon:"fa fa-puzzle-piece"})),i=e("<div/>",{class:"operatorNameDiv",title:t.description||t.name}).html(t.description||t.name),r=e("<div/>",{class:"backFontDiv "+t.status.type,title:t.status.msg});I&&r.append(e("<i/>",{class:t.status.icon}));var o=e("<div/>",{class:"bigBox"});return t.selected&&o.addClass("selected"),t.invalid&&o.addClass("invalid"),o.append(n).append(i).append(r),o[0]}function getGraph(){return p}function insertOperator(e,t){return addOperatorCell(p,null,f.getCell(e.parent),e,t)}function insertConnect(e,t){var n=getPortCell(p,e.from_op,e.from_port,c.PORT_OUTPUT_TYPE),i=getPortCell(p,e.to_op,e.to_port,c.PORT_INPUT_TYPE);if(n&&i){var r=t?"":null;p.insertEdge(p.getDefaultParent(),null,r,n,i),i&&i.value.multi&&handleMultiInputPorts(i.parent)}}function getPortCell(e,t,n,i){var o=null;if(t){var a=getOperatorCellByName(e,t);if(!a)return r.error("failed to get operator: "+t),null;if(!a.children)return null;a.children.some(function(e){if(e.value&&e.value.portType===i&&e.value.name===n&&(i===c.PORT_OUTPUT_TYPE||i===c.PORT_INPUT_TYPE&&0===e.getEdgeCount()))return o=e,!0})}return o}function getOperatorCellByName(e,t){return a.getOperatorAsCell(e,t)}function setModelUpdate(e){e?f.beginUpdate():f.endUpdate()}function getRelativePoint(e,t,n,i){var r=e,o=t,a=n&&n.value&&n.value.isGroup?n:g;if(i&&m&&(x=e-_,b=t-y,m=!1),a===g)return i?{x:r-x,y:o-b}:{x:r,y:o};var s=P(a,e,t,i);return getRelativePoint(s.x,s.y,n.parent,i)}function addOperatorCell(t,n,i,r,o){var s=r.type;l.initPortsCache(a.getCurrentConnectId());var c=l.getPortsById(s);if(c)return e.Deferred().resolve(c).then(function(e){z(t,n,i,r,o,e)}).promise();var u={id:s,connectId:a.getCurrentConnectId()},h=l.genApiUrl("operator/ports");return d.get(h,u,function(e){z(t,n,i,r,o,e)})}function addSidebarIcon(e,t){if(e&&t){var n=function(t,n,i,r,o){addOperatorCell(t,n,i,{x:r,y:o,width:null,height:null,type:e})},i=document.createElement("div");i.style.border="dashed black 1px",i.style.width=T+"px",i.style.height=A+"px";w.mxUtils.makeDraggable(t,p,n,i,0,0,!0,!0).setGuidesEnabled(!0)}}function handleMultiPortOperators(){a.getMultiPortOperators().forEach(function(e){handleMultiInputPorts(e)})}function handleMultiInputPorts(e){if(e){var t=0,n="",i=[],o=!1;if((e.children||[]).forEach(function(e){var a=e.value;if(a&&a.portType===c.PORT_INPUT_TYPE){if(!a.multi)return void r.error("input port without multi flag is unsupported");""===n?n=a.name.substr(0,3):a.name.startsWith(n)?a.name=n+"-"+t:r.error("input ports with multi flag should have same name prefix"),o=!1,0===e.getEdgeCount()?(i.push(e),o=!0):t++}}),i.length>0&&p.removeCells(i.slice(0,i.length-(o?1:0))),!o){var a=p.insertVertex(e,null,{name:n+"-"+t,multi:!0,required:null,isPort:!0,portType:c.PORT_INPUT_TYPE},1,0,M,M,"shape=ellipse;perimeter=ellipsePerimeter;fillColor=#fff;opacity=80;",!0);a.geometry.offset=new w.mxPoint(0,-5),a.setConnectable(!0)}var s=0,l=getPositions(t+1);(e.children||[]).forEach(function(e){var t=e.value;t&&t.portType===c.PORT_INPUT_TYPE&&(e.geometry.x=l[s++])}),p.refresh()}}function getPositions(e){if(e<E.length)return E[e];for(var t=[],n=1,i=e+1;n<i;n++)t.push(n/i);return t}function setMode(e){p.mode=e,"select"===e?(p.panningHandler.useLeftButtonForPanning=!1,p.panningHandler.panningEnabled=!1,p.setConnectable(!1)):"connect"===e?(p.panningHandler.useLeftButtonForPanning=!1,p.setConnectable(!0)):"pan"===e&&(p.panningHandler.useLeftButtonForPanning=!0,p.setConnectable(!1))}function clear(){p.removeCells(p.getDefaultParent().children),p.refresh()}function getSegment(e,t){var n=e.x,i=e.y,r=t.x,o=t.y,a=50;return o>i?a=Math.sqrt(Math.pow(n-r,2)+Math.pow(i-o,2))<50?10:Math.sqrt(Math.pow(n-r,2)+Math.pow(i-o,2))>200?50:4/15*Math.abs(n-r):a}function configureStylesheet(e){var t={};t[w.mxConstants.STYLE_SHAPE]=w.mxConstants.SHAPE_RECTANGLE,t[w.mxConstants.STYLE_PERIMETER]=w.mxPerimeter.RectanglePerimeter,t[w.mxConstants.STYLE_ALIGN]=w.mxConstants.ALIGN_CENTER,t[w.mxConstants.STYLE_VERTICAL_ALIGN]=w.mxConstants.ALIGN_MIDDLE,t[w.mxConstants.STYLE_FILLCOLOR]="#000000",t[w.mxConstants.STYLE_RESIZABLE]=0,t[w.mxConstants.STYLE_FONTCOLOR]="#FFFFFF",t[w.mxConstants.STYLE_FOLDABLE]=0,t[w.mxConstants.STYLE_ROUNDED]=!0,t[w.mxConstants.STYLE_ARCSIZE]="50",t[w.mxConstants.STYLE_OPACITY]="20",w.mxConstants.SELECTION_DASHED=!1,w.mxConstants.VERTEX_SELECTION_STROKEWIDTH=0,w.mxConstants.VERTEX_SELECTION_COLOR="",e.getStylesheet().putDefaultVertexStyle(t);var n=new Object;n[w.mxConstants.STYLE_SHAPE]="swimlane",n[w.mxConstants.STYLE_FILLCOLOR]="#427FB6",n[w.mxConstants.STYLE_STROKECOLOR]="#427FB6",n[w.mxConstants.STYLE_RESIZABLE]=1,n[w.mxConstants.STYLE_FOLDABLE]=1,n[w.mxConstants.STYLE_ROUNDED]=!1,n[w.mxConstants.STYLE_ARCSIZE]="0",n[w.mxConstants.STYLE_OPACITY]="100",n[w.mxConstants.STYLE_STARTSIZE]=A,e.getStylesheet().putCellStyle("swimlanestyle",n);var i=e.getStylesheet().getDefaultEdgeStyle();i[w.mxConstants.STYLE_ROUNDED]=!0,i[w.mxConstants.STYLE_CURVED]=!0,i[w.mxConstants.STYLE_SEGMENT]=50,i[w.mxConstants.STYLE_ENDARROW]="none",w.mxConstants.HANDLE_STROKECOLOR="none",w.mxConstants.HANDLE_FILLCOLOR="none",i[w.mxConstants.STYLE_ELBOW]=w.mxConstants.ELBOW_VERTICAL,i[w.mxConstants.STYLE_EDGE]=w.mxEdgeStyle.MyStyle;var r=JSON.parse(JSON.stringify(t));r[w.mxConstants.STYLE_ARCSIZE]="20",e.getStylesheet().putCellStyle("zaipStyle",r)}function setExperimentFlag(e){a.setExperimentFlag(e),I=e}function getExperimentFlag(e){return I}var p,f,g,m,v,_,y,x,b,w=l.mx,C=300,S=null,T=200,A=30,M=10,E=[[],[.5],[.4,.6],[.3,.5,.7],[.2,.4,.6,.8]],I=!0,D=[],k=function(){var e=p.getSelectionCell();(e&&e.children||[]).forEach(function(e){(e.edges||[]).forEach(function(e){D.push(e),e.setStyle("strokeColor=#00ff00")})})},L=function(){D.forEach(function(e){e.setStyle()}),D=[]},N=!1,P=function(e,t,n,i){var r,o;return i?v?(r=t+x,o=n+b,v=!1):(r=t,o=n):(r=t-e.getGeometry().x,o=n-e.getGeometry().y),{x:r,y:o}},O=function(e){var t=(e.connects||[]).map(function(e){return e.from_op=a.getName(e.from_op),e.to_op=a.getName(e.to_op),e});(e.groups||[]).forEach(function(t){t.name=a.getName(t.name),t.description=a.getOperatorDescription(t.description||t.name),R(t,e)}),(e.operators||[]).forEach(function(e){e.name=a.getName(e.name),e.description=a.getOperatorDescription(e.description||e.name),insertOperator(e,!0)}),t.forEach(function(e){insertConnect(e,!0)}),a.updateData()},R=function handleGroupId(e,t){p.getModel().getCell(e.id)?(t.operators.concat(t.groups||[]).forEach(function(t){t.parent===e.id&&(t.parent+=1)}),e.id+=1,handleGroupId(e,t)):insertOperator(e,!0)},z=function(e,t,n,i,r,s){var u=i.x,d=i.y,p=i.width,x=i.height,b=i.type,C=i.id,S=JSON.parse(JSON.stringify(s));if("Diy Operator"===S.type)return m=!0,_=u,y=d,O(JSON.parse(S.content));if(S.name=i.name||a.getKeyName(),S.description=i.description||a.getOperatorDescription(l.isModel(b)?S.label:l.getOperatorLabel(b)),S.isDrag=!1,S.operatorExecType===c.ZAIPENTRANCE){S.name=i.name||a.getOperatorDescription(l.getOperatorLabel(b)),S.initName=S.name,S.runStatus=a.getLoadingStatus()?l.getZaipRunStatus(a.getProcessName(),S.initName,I):{CANCELLED:0,DONE:0,FAILED:0,QUEUED:0,RUNNING:0};var E=a.getProcessInfo(!0).params.zaip_id+a.getProcessName()+S.name;a.getLoadingStatus()&&h.loadProcessForOut(a.getProcessName(),S.name,E,a.getProcessInfo(!0).params.zaip_id,I)}if(S.type=b,S.params=i.params,S.status={},S.icon=l.getOperatorIcon(b),delete S.id,delete S.label,!a.isExist(S.name)){S.isOperator=!0,S.inputs&&S.outputs&&o.isEmpty(S.inputs)&&o.isEmpty(S.outputs)&&(S.isGroup=!0);var D=null;a.getLoadingStatus()||(S.isDrag=!0,f.beginUpdate());try{var k=n&&n.value&&n.value.isGroup?n:g,L=S.isGroup?"swimlanestyle":"";if(p&&x||(p=S.isGroup?300:T,x=S.isGroup?400:A),S.operatorExecType===c.ZAIPENTRANCE&&(x=80,L="zaipStyle"),a.getLoadingStatus())D=e.insertVertex(k,C,S,u,d,p,x,L);else{v=!0;var N=getRelativePoint(u,d,k,r);D=e.insertVertex(k,C,S,N.x,N.y,p,x,L)}S.isGroup&&(D.geometry.alternateBounds=new w.mxRectangle(0,0,T,A)),D.setConnectable(!1),S.inputs&&(positions=getPositions(S.inputs.length),S.inputs.forEach(function(t,n){var i=e.insertVertex(D,null,{name:t.name,multi:t.multi,isPort:!0,portType:c.PORT_INPUT_TYPE},positions[n],0,M,M,"shape=ellipse;perimeter=ellipsePerimeter;fillColor=#fff;opacity=80;",!0);i.geometry.offset=new w.mxPoint(0,-5),i.setConnectable(!0)})),S.outputs&&(positions=getPositions(S.outputs.length),S.outputs.forEach(function(t,n){var i=e.insertVertex(D,null,{name:t.name,isPort:!0,portType:c.PORT_OUTPUT_TYPE},positions[n],1,M,M,"shape=ellipse;perimeter=ellipsePerimeter;fillColor=#fff;opacity=80;",!0);i.geometry.offset=new w.mxPoint(0,-5),i.setConnectable(!0)}))}finally{a.getLoadingStatus()||f.endUpdate()}a.getLoadingStatus()||r||(e.setSelectionCell(D),a.updateData())}};w.mxEdgeStyle.MyStyle=function(e,t,n,i,r){var o=e.view;o.graph;if(null!=t&&null!=n){var a=t.y+t.height,s=o.getRoutingCenterX(t),l=n.y,c=o.getRoutingCenterX(n),u=getSegment(t,n),d=new w.mxPoint(s,a+u),h=new w.mxPoint(c,l-u);r.push(d),r.push(h)}},w.mxStyleRegistry.putValue("myEdgeStyle",w.mxEdgeStyle.MyStyle);var F=function(e,t){var n={execAll:!1,operatorName:e};s.modifyConfirm({},null,null,null,null,t,n,e)},B=function addOperatorParam(e){e.forEach(function(e){e&&e.value&&e.value.isOperator&&(e.value.isGroup&&addOperatorParam(e.children||[]),H(e),a.addOperator({id:e.id,name:a.getName(e.value.name),description:e.value.description,type:e.value.type,isGroup:e.value.isGroup,multiPort:!o.isEmpty(e.value.inputs)&&e.value.inputs[0].multi,params:e.value.params||{}}))})},H=function(e){e.value=JSON.parse(JSON.stringify(e.value)),e.value.status={},(e.children||[]).forEach(function(e){e.value&&e.value.isPort&&delete e.value.data})},V=function(e){Array.from(e.getElementsByTagName("Object")).filter(function(e){return"1"===e.getAttribute("isOperator")}).forEach(function(e){var t=e.getAttribute("name");e.setAttribute("name",a.getName(t))})},W=function(){textInput.style.position="absolute",textInput.style.left=p.container.scrollLeft+10+"px",textInput.style.top=p.container.scrollTop+10+"px",p.container.appendChild(textInput),restoreFocus=!0,textInput.focus(),textInput.select(),document.execCommand("copy")},U=function(){if(p.isEnabled()){var e=textInput.value;null!=e&&e.length>0&&G(e)}textInput.select(),restoreFocus=!1,p.isEditing()||p.container.focus(),textInput.parentNode&&textInput.parentNode.removeChild(textInput)},$=function(e,t,n){t=null!=t?t:0,n=null!=n?n:0;var i=[];try{var r=w.mxUtils.parseXml(e),o=r.documentElement;if(V(o),null!=o){var s=new w.mxGraphModel;for(var l in w)w.hasOwnProperty(l)&&(window[l]=w[l]);new w.mxCodec(o.ownerDocument).decode(o,s);var c=s.getChildCount(s.getRoot()),u=p.model.getChildCount(p.model.getRoot());p.model.beginUpdate();try{for(var d=0;d<c;d++){var h=s.getChildAt(s.getRoot(),d);if(u>d){var f=1==c?p.getDefaultParent():p.model.getChildAt(p.model.getRoot(),d);if(!p.isCellLocked(f)){var g=s.getChildren(h),m=p.importCells(g,t,n,f);m.forEach(function(e){e&&e.value&&e.value.initName&&(e.value.initName=e.value.name),e&&e.value&&e.value.description&&(e.value.description=a.getOperatorDescription(e.value.description))}),B(m),i=i.concat(m)}}else{h=p.importCells([h],0,0,p.model.getRoot())[0];var g=p.model.getChildren(h);p.moveCells(g,t,n),i=i.concat(g)}}}finally{p.model.endUpdate()}}}catch(e){}return i},G=function(e){var t=w.mxUtils.trim(e);p.container.scrollLeft,p.view.scale,p.view.translate.x,p.container.scrollTop,p.view.scale,p.view.translate.y;t.length>0&&(lastPaste!=t?(lastPaste=t,x=0,b=0):(x+=gs,b+=gs),"<mxGraphModel>"==t.substring(0,14)&&(p.setSelectionCells($(t,x,b)),p.scrollCellToVisible(p.getSelectionCell()),a.updateData()))},q=function(){var t=w.mxUtils,n=w.mxEvent,i=w.mxClipboard;i.cellsToString=function(e){for(var n=new w.mxCodec,i=new w.mxGraphModel,r=i.getChildAt(i.getRoot(),0),o=0;o<e.length;o++)i.add(r,e[o]);return t.getXml(n.encode(i))},textInput=document.createElement("textarea"),t.setOpacity(textInput,0),textInput.style.width="1px",textInput.style.height="1px",restoreFocus=!1,gs=p.gridSize,lastPaste=null,x=0,b=0,textInput.value=" ",n.addListener(document,"keydown",function(e){var t=n.getSource(e);!p.isEnabled()||p.isMouseDown||p.isEditing()||"BODY"!==t.nodeName||(224==e.keyCode||!w.mxClient.IS_MAC&&17==e.keyCode||w.mxClient.IS_MAC&&91==e.keyCode)&&(restoreFocus||(textInput.style.position="absolute",textInput.style.left=p.container.scrollLeft+10+"px",textInput.style.top=p.container.scrollTop+10+"px",p.container.appendChild(textInput),restoreFocus=!0,textInput.focus(),textInput.select()))}),n.addListener(document,"keyup",function(e){!restoreFocus||224!=e.keyCode&&17!=e.keyCode&&91!=e.keyCode||(restoreFocus=!1,p.isEditing()||p.container.focus(),textInput.parentNode.removeChild(textInput))});var r=function(e,t){if(t.length>0){for(var n=e.cloneCells(t),r=0;r<n.length;r++){var o=e.view.getState(t[r]);if(null!=o){var a=e.getCellGeometry(n[r]);null!=a&&a.relative&&(a.relative=!1,a.x=o.x/o.view.scale-o.view.translate.x,a.y=o.y/o.view.scale-o.view.translate.y)}}textInput.value=i.cellsToString(n)}textInput.select(),lastPaste=textInput.value};n.addListener(textInput,"copy",t.bind(this,function(n){p.isEnabled()&&!p.isSelectionEmpty()&&e("#visual").is(":hidden")&&(r(p,t.sortCells(p.model.getTopmostCells(p.getSelectionCells()))),x=0,b=0)})),n.addListener(textInput,"cut",t.bind(this,function(t){p.isEnabled()&&!p.isSelectionEmpty()&&e("#visual").is(":hidden")&&(delZaip(),r(p,p.removeCells()),x=-gs,b=-gs)}));var o=function(e){var n=null;if(null!=e){var i=null!=e.dataTransfer?e.dataTransfer:e.clipboardData;null!=i&&(10==document.documentMode||11==document.documentMode?n=i.getData("Text"):(n=t.indexOf(i.types,"text/html")>=0?i.getData("text/html"):null,t.indexOf(i.types,null==n||0==n.length)&&(n=i.getData("text/plain"))))}return n};n.addListener(textInput,"paste",function(n){if(textInput.value="",p.isEnabled()&&e("#visual").is(":hidden")){var i=o(n);null!=i&&i.length>0?G(i):window.setTimeout(t.bind(this,function(){G(textInput.value)}),0)}textInput.select()})};return{getGraph:getGraph,setModelUpdate:setModelUpdate,init:init,clear:clear,addSidebarIcon:addSidebarIcon,insertConnect:insertConnect,insertOperator:insertOperator,setMode:setMode,getPortCell:getPortCell,getOperatorCellByName:getOperatorCellByName,setExperimentFlag:setExperimentFlag,getExperimentFlag:getExperimentFlag,copy:W,paste:U,getSourceByOperatorName:getSourceByOperatorName,delZaip:delZaip}}.apply(t,i))&&(e.exports=r)},function(e,t,n){var i,r;i=[n(0),n(28),n(6),n(1),n(3),n(100),n(106),n(7),n(8)],void 0!==(r=function(e,t,n,i,r,o,a,s,l){function getDetailContent(t,n,r){var o={operatorName:n,processName:r.getProcessName(),owner:r.getProcessOwner()},a=function(n){var o=e("<div/>");n.forEach(function(t){o.append(e("<h3/>").html("Result of operator: "+t.operatorName+", port: "+t.portName)),o.append(u(t,r))}),o.accordion({collapsible:!0,heightStyle:"content"}),t.append(o),i.doNiceScroll(".result-dialog"),i.doNiceScroll(".result-dialog pre")},l=function(e){toastr.info(e,"ajax error",i.toastrConfig)};s.post(i.genApiUrl("process/operatorresult"),o,a,l)}function getReportContent(t,r){var a=e("<div/>");return n.isEmpty(t.results)&&"WebGisVisual"===t.type&&(t.results=[{portName:"vis",operatorName:t.name,operatorType:t.type,result:"{}"}]),n.filter(t.results,function(e){return!(n.contains(["out","vis2","out2"],e.portName)&&"WebGisVisual"===t.type)}).forEach(function(e){var s="TreeChart"===t.type,l=s?{}:JSON.parse(e.result);if(t){var c="report";n.contains(["LineChart","ScatterChart"],t.type)&&(c="line");var u;if("WebGisVisual"===t.type)u=i.getDataFromServer({processName:t.processName,operatorName:e.operatorName},i.genApiUrl("chart/operator/md5"));else{var d=s?t.name:e.operatorName,h=s?"out":e.portName;s&&(c="treeChart"),u=i.getDataFromServer({connectId:t.connectId,processName:t.processName,operatorName:d,portName:h,params:JSON.stringify(t.params),queryType:c,owner:r},i.genApiUrl("chart/report"))}l.chartType=t.type,l.name=t.name,l.processName=t.processName,a.append(o.chart(l,t,u))}}),a}function getDetailTreeModeContent(t){var n=e("<div/>");return a.rend(t,n[0]),n}function getDetailModeContent(t){var n=e("<div/>"),i=e("<button/>",{class:"btn btn-black",style:"padding:6px 6px; margin-bottom:6px;"}).text(e.i18n.prop("ict_oneminer_button_publish"));return n.append(i),n.append(e("<pre/>").text(t)),i.on("click",function(){publishDialog.data("content",t).dialog("open")}),n}function getDetailMetricContent(t){if(n.isObject(t)){var i=e("<div/>"),r=e("<table/>",{class:"table table-striped table-bordered table-hover gray-header"});i.append(r);var a=[{title:"metric"},{title:"value"}],s=n.pairs(t.performance);return r.DataTable({dom:"<'row'<'col-sm-6'tr>>",autoWidth:!1,paging:!1,ordering:!1,info:!1,searching:!1,data:s,columns:a}),t.confusionMatrix&&!n.isEmpty(t.confusionMatrix)&&(chartContent=o.confusionMatrix(t.confusionMatrix),i.append(chartContent)),i}return"Unknown data format"}function getMiscDataResult(t){var n=e("<div/>");return n.append(e("<pre/>").text(t.modelFile)),n}function getImageBase64DataResult(t,n){var r=e("<div/>"),o=JSON.parse(t),a=o.path,s=new Image(900,640);s.src="data:image/jpg;base64, "+o.base64str;var l='<i class="fa fa-download img-download" title='+e.i18n.prop("ict_oneminer_process_toolbar_tooltip_download")+"></i>";return r.append(l).append(s),r.on("click",".img-download",function(){location.href=i.genApiUrl("file/downloadImage?connectId="+n.getCurrentConnectId()+"&hdfsPath="+a)}),r}function getPlainTextResult(t){var n=e("<div/>");return n.append(e("<pre/>").text(t)),n}function getFormattedStringResult(t){var n=e("<div/>");return n.append(e("<pre/>").text(t)),n}function getDetailDataTable(t){if(t.metaDataList&&t.dataList){var n=e("<div/>",{class:"result-dialog-table"}),r=e("<table/>",{class:"table table-bordered dataTable"});n.append(r);var o=[];return t.metaDataList.forEach(function(e){o.push({title:e.name})}),r.DataTable({language:i.getDatatableLanguage(),dom:'<"search" f>rt<"diyTableBottom" ipl>',autoWidth:!1,deferRender:!0,data:t.dataList,paging:!0,ordering:!1,info:!0,searching:!1,pagingType:"full",columns:o}),n}return"no metaDataList or dataList found"}function getDataQualityContent(t){if(t){var n=e("<div/>",{class:"result-dialog-table"}),r=e("<table/>",{class:"table table-bordered dataTable"});n.append(r);var o=[];o.push({title:"Column Name"}),o.push({title:"Column Type"}),o.push({title:"Missing Value Number"}),o.push({title:"Distinct Values"}),o.push({title:"Max Number"}),o.push({title:"Min Number"}),o.push({title:"Mean Number"}),o.push({title:"Standard Deviation"}),o.push({title:"Categories"}),o.push({title:"HistgramCounts"}),o.push({title:"Operator"});var a=[];return t.forEach(function(e){var t=[],n="",i="";t.push(e.attributeName);var r=e.attributeType;if(1===r?t.push("continuous"):2===r&&t.push("discrete"),t.push(e.nmiss),t.push(e.distinct),1===r){t.push(e.max),t.push(e.min),t.push(e.mean),t.push(e.stddev),t.push("N/A");var o=[],s=e.histgramCounts;s.forEach(function(e){var t=e.typeName,r=e.typeNumber;o.push(t+":"+r),n+=t+"!,",i+=r+"!,"}),t.push(o)}else if(2===r){t.push("N/A"),t.push("N/A"),t.push("N/A"),t.push("N/A");var o=[],s=e.categoryCounts;s.forEach(function(e){var t=e.typeName,r=e.typeNumber;o.push(e.typeName+":"+e.typeNumber),"string"==typeof t&&t.indexOf('"')>-1&&(t=t.substr(1,t.length-2)),"string"==typeof r&&r.indexOf('"')>-1&&(r=r.substr(1,r.length-2)),n+=t+"!,",i+=r+"!,"}),t.push(o),t.push("N/A")}t.push('<button id="'+e.attributeName+'" class="dataQualityButton btn btn-black" value="'+n+"|"+i+'">show</button>'),a.push(t)}),r.DataTable({language:i.getDatatableLanguage(),dom:'<"search" f>rt<"diyTableBottom" ipl>',autoWidth:!1,data:a,paging:!0,ordering:!1,info:!0,searching:!1,pagingType:"full",columns:o}),n}return"no metaDataList or dataList found"}function getTableResult(t){if(t){var n=e("<div/>",{class:"result-dialog-table"}),r=e("<table/>",{class:"table table-bordered dataTable"});n.append(r);for(var o=t[0].title,a=[],s=0;s<o.length;s++)a.push({title:o[s]});var l=t[0].rows,c=[];for(s=0;s<l.length;s++){var u=l[s].split("@+++@");c.push(u)}return r.DataTable({language:i.getDatatableLanguage(),dom:'<"search" f>rt<"diyTableBottom" ipl>',autoWidth:!1,data:c,paging:!0,ordering:!1,info:!0,searching:!1,pagingType:"full",columns:a}),n}return"no metaDataList or dataList found"}function getZAIPPredictionResult(t,n,r,o,a){var s=a.getOperatorCellByName(a.getGraph(),n),l=e("<div/>"),c=e("<table/>",{class:"table table-bordered dataTable",id:"ZAIPPrediction"});l.append(c),t.append(l);var u=i.doGet(i.genApiUrl("task/list?processName="+r+"&opName="+n)),d=[];u&&u.data&&!s.value.isDrag&&u.data.forEach(function(t){var n=['<span class="train-num" train-id='+t.id+" train-instanceid="+t.instanceid+">"+t.name+"</span>",t.createtime,t.starttime,t.runtime,'<span class="train-status">'+e.i18n.prop("Zaip_"+t.status.toLowerCase())+"</span>",o.getProcess(t.status,t.process),t.model,t.gpu,t.batch,o.getBtn(t.status)];d.push(n)});var h=[{title:e.i18n.prop("ict_oneminer_zaip_train_number")},{title:e.i18n.prop("ict_oneminer_zaip_train_createtime")},{title:e.i18n.prop("ict_oneminer_zaip_train_starttime")},{title:e.i18n.prop("ict_oneminer_zaip_train_runtime")},{title:e.i18n.prop("ict_oneminer_table_head_experiment_status")},{title:e.i18n.prop("ict_oneminer_zaip_train_process")},{title:"model id"},{title:"gup num"},{title:"batch size"},{title:e.i18n.prop("ict_oneminer_zaip_train_set")}];c.DataTable({language:i.getDatatableLanguage(),dom:'<"search" f>rt<"diyTableBottom" ipl>',autoWidth:!1,deferRender:!0,data:d,paging:!1,ordering:!1,info:!1,searching:!0,columns:h}),i.doNiceScroll(".result-dialog"),autoReload(!0,r,n,o,s.value.isDrag)}function refreshTable(t,n,r,o){var a=i.genApiUrl("task/list?processName="+n+"&opName="+r),l=function(n){if(n&&n.data){var r=n.data;c=e(t).dataTable(),oSettings=c.fnSettings(),c.fnClearTable(this),r.forEach(function(t){var n=['<span class="train-num" train-id='+t.id+" train-instanceid="+t.instanceid+">"+t.name+"</span>",t.createtime,t.starttime,t.runtime,'<span class="train-status">'+e.i18n.prop("Zaip_"+t.status.toLowerCase())+"</span>",o.getProcess(t.status,t.process),t.model,t.gpu,t.batch,o.getBtn(t.status)];c.oApi._fnAddData(oSettings,n)}),oSettings.aiDisplay=oSettings.aiDisplayMaster.slice(),c.fnDraw(),i.doNiceScroll(".result-dialog")}},u=function(){toastr.info(res,"ajax error",i.toastrConfig),autoReload(!1)};s.get(a,"",l,u)}function autoReload(e,t,n,i,r){if(!r){e?reloadtime=setInterval(function(){refreshTable("#ZAIPPrediction",t,n,i)},l.SETTIMEOUT_TIME):clearInterval(reloadtime)}}var c,u=function(e,t){switch(e.type){case"EXAMPLE_DATA":return getDetailDataTable(JSON.parse(e.result));case"MISC_DATA":return getMiscDataResult(JSON.parse(e.result));case"IMAGE_DATA":return getImageBase64DataResult(e.result,t);case"PLAIN_TEXT":return getPlainTextResult(e.result);case"FORMATTED_STRING":return getFormattedStringResult(e.result);case"PERFORMANCE":return getDetailMetricContent(JSON.parse(e.result));case"DATA_QUALITY":return getDataQualityContent(JSON.parse(e.result));case"CUSTOM_TABLE":return getTableResult(JSON.parse(e.result));case"TREE_VISUAL":return getDetailTreeModeContent(e.result);default:return getDetailModeContent(e.result)}};return{getDetailContent:getDetailContent,getReportContent:getReportContent,getZAIPPredictionResult:getZAIPPredictionResult,autoReload:autoReload}}.apply(t,i))&&(e.exports=r)},function(e,t,n){var i,r;i=[],void 0!==(r=function(){function TreeNodeShape(){}function rend(e,i){var r=[];if(t.mxClient.isBrowserSupported()){t.mxGraph.prototype.collapsedImage=new t.mxImage(n(69),16,16),t.mxGraph.prototype.expandedImage=new t.mxImage(n(71),16,16),t.mxClient.IS_IE&&new t.mxDivResizer(i);var o=new t.mxGraph(i);o.setAllowDanglingEdges(!1),o.cellsEditable=!1,o.keepEdgesInBackground=!0,o.setAutoSizeCells(!0),o.setPanning(!0),o.panningHandler.useLeftButtonForPanning=!0,o.panningHandler.panningEnabled=!0,o.setCellsSelectable(!1);var a=o.getStylesheet().getDefaultVertexStyle();a[t.mxConstants.STYLE_SHAPE]="treenode",a[t.mxConstants.STYLE_GRADIENTCOLOR]="white",a[t.mxConstants.STYLE_SHADOW]=!0,a=o.getStylesheet().getDefaultEdgeStyle(),a[t.mxConstants.STYLE_EDGE]=t.mxEdgeStyle.TopToBottom,a[t.mxConstants.STYLE_ROUNDED]=!0,a[t.mxConstants.STYLE_LABEL_BACKGROUNDCOLOR]="#ffffff";var s=new t.mxCompactTreeLayout(o,!1);s.useBoundingBox=!1,s.edgeRouting=!1,s.levelDistance=50,s.nodeDistance=40;new t.mxLayoutManager(o).getLayout=function(e){if(e.getChildCount()>0)return s},o.isCellFoldable=function(e){return this.model.getOutgoingEdges(e).length>0},o.cellRenderer.getControlBounds=function(e){if(null!=e.control){var n=e.control.scale,i=e.control.bounds.width/n,r=e.control.bounds.height/n,o=e.view.scale;return new t.mxRectangle(e.x+e.width/2-i/2*o,e.y+e.height+TreeNodeShape.prototype.segment*o-r/2*o,i*o,r*o)}return null},o.foldCells=function(e,t,n){this.model.beginUpdate();try{toggleSubtree(this,n[0],!e),this.model.setCollapsed(n[0],e),s.execute(o.getDefaultParent())}finally{this.model.endUpdate()}};var l=o.getDefaultParent(),c=JSON.parse(e).params;if(null!=c&&0!=c.length)for(var u=0;u<c.length;u++){var d=c[u].split("|");"00"==d[1]&&c.splice(u)}o.getModel().beginUpdate();try{c.forEach(function(e){var t=e.split("|"),n=null;n="00"==t[2]?o.insertVertex(l,t[1],t[3],0,20,60,40):o.insertVertex(l,t[1],t[3],0,0,60,40),r.push(new object(t[1],n))}),c.forEach(function(e){var t=e.split("|"),n=null,i=null;r.forEach(function(e){e.name==t[1]&&"00"!=t[2]&&(n=e.value),e.name==t[2]&&(i=e.value)}),"00"!=t[2]&&o.insertEdge(l,null,t[4],i,n)})}finally{o.getModel().endUpdate()}}else t.mxUtils.error("Browser is not supported!",200,!1)}function object(e,t){this.name=e,this.value=t}function toggleSubtree(e,t,n){n=null==n||n;var i=[];e.traverse(t,!0,function(n){return n!=t&&i.push(n),n==t||!e.isCellCollapsed(n)}),e.toggleCells(n,i,!0)}var e=n(56),t=new e;return function(){TreeNodeShape.prototype=new t.mxCylinder,TreeNodeShape.prototype.constructor=TreeNodeShape,TreeNodeShape.prototype.segment=20,TreeNodeShape.prototype.apply=function(e){t.mxCylinder.prototype.apply.apply(this,arguments),this.state=e},TreeNodeShape.prototype.redrawPath=function(e,t,n,i,r,o){var a=this.state.view.graph,s=a.model.getOutgoingEdges(this.state.cell).length>0;o?s&&(e.moveTo(i/2,r+this.segment),e.lineTo(i/2,r),e.end()):(e.moveTo(0,0),e.lineTo(i,0),e.lineTo(i,r),e.lineTo(0,r),e.close())},t.mxCellRenderer.prototype.defaultShapes.treenode=TreeNodeShape,t.mxGraphView.prototype.updateFloatingTerminalPoint=function(e,n,i,r){var o=null;o=r?new t.mxPoint(n.x+n.width/2,n.y+n.height+TreeNodeShape.prototype.segment):new t.mxPoint(n.x+n.width/2,n.y),e.setAbsoluteTerminalPoint(o,r)}}(),{rend:rend}}.apply(t,i))&&(e.exports=r)},function(e,t,n){(function(i){function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r,o;r=[n(3),n(1),n(19)],void 0!==(o=function(e,t,n){return function(e){function ExpTree(t,n,i,r,o,a,s){_classCallCheck(this,ExpTree);var l=_possibleConstructorReturn(this,e.call(this,t,n,i,r,o));return l.colorBtn=a,l.switchExp=s,l}return _inherits(ExpTree,e),ExpTree.prototype.getTreeData=function(){var e=t.doGet(t.genApiUrl("process/list")),n=e.data.map(function(e){return{icon:"fa fa-flask p-"+e.type,id:e.name,label:e.name,processType:e.type,owner:e.userId}});return[{id:1,label:i.i18n.prop("ict_oneminer_home_mylab"),children:n}]},ExpTree.prototype.registerSearchHandler=function(){var e=this;i(this.input).on("input",function(){e.search()}),i(this.colorBtn).off("click"),i(this.colorBtn).on("click",function(){i(this).toggleClass("cur"),e.search()}),i(this.input).trigger("input")},ExpTree.prototype.search=function(){for(var e=i(this.input).val(),n=[],r=i(this.colorBtn+".cur"),o=0;o<r.length;o++)n.push(r.eq(o).index()+1);var a=i("span"+this.tree+"-noMatches");0===e.length&&0===n.length?(i(this.tree+" li").css("display","block"),a.css("display","none")):(i(this.tree+" li").css("display","none"),this.filterTree(this.tree,this.data,e,n)?a.css("display","none"):a.css("display","block")),t.doNiceScroll(this.div)},ExpTree.prototype.filterTree=function(e,t,n,r){for(var o=!1,a=0,s=t.length;a<s;a++)if(t[a].children){var l=this.filterTree(e,t[a].children,n,r);l&&(o=!0,i(e+' li:has(> a[title="'+t[a].label+'"])').css("display","block"))}else 0===r.length?String(t[a].label).toLowerCase().indexOf(n.toLowerCase())>=0&&(o=!0,i(e+' li:has(> a[title="'+t[a].label+'"])').css("display","block")):0===n.length?r.indexOf(t[a].processType)>=0&&(o=!0,i(e+' li:has(> a[title="'+t[a].label+'"])').css("display","block")):r.indexOf(t[a].processType)>=0&&t[a].label.toLowerCase().indexOf(n.toLowerCase())>=0&&(o=!0,i(e+' li:has(> a[title="'+t[a].label+'"])').css("display","block"));return o},ExpTree.prototype.registerTreeHandler=function(){var e=this;i("#experiment-tree>li li:not(:has(ul))").on("click",function(){var t=this,n=i(this);if(e.processManager.getLoadingStatus())return void setTimeout(function(){e.setSelectNode(e.processManager.getProcessName())},0);var r=function(){var i=n.text(),r=t.dataset.owner;e.graphManager.setExperimentFlag(!0),e.processManager.getInitProcess()(i,!0,r)},o=function(){e.setSelectNode(e.processManager.getProcessName())};e.switchExp(r,o)})},ExpTree}(n)}.apply(t,r))&&(e.exports=o)}).call(t,n(0))},function(e,t,n){(function(i){function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r,o;r=[n(3),n(1),n(19),n(11),n(7),n(4)],void 0!==(o=function(e,t,n,r,o,a){var s=function(e){function ModelTree(t,n,i,r,o){return _classCallCheck(this,ModelTree),_possibleConstructorReturn(this,e.call(this,t,n,i,r,o))}return _inherits(ModelTree,e),ModelTree.prototype.getTreeData=function(){var e=this.processManager.getCurrentConnectId(),n=t.doGet(t.genApiUrl("model-repo/query?connectId="+e));return n[0].children.forEach(function(e){e.isParent=!!e.isDir}),n},ModelTree.prototype.registerTreeHandler=function(){for(var e=this.getAllLeafs(this.data),t=i("#model-tree>li li:not(:has(ul))"),n=0,r=e.length;n<r;n++){var o=e[n];this.graphManager.addSidebarIcon(o,t[n])}},ModelTree.prototype.initContextMenu=function(){var e=this;i("#model-tree").contextMenu({selector:".need-menu",zIndex:1e3,build:function(n,r){var s={};return n.hasClass("model-leaf")&&(s.saveas={name:i.i18n.prop("ict_oneminer_button_saveas"),icon:"fa-save",callback:function(t,n){var i=n.$trigger.attr("data-id");e.openSaveDialog(i)}},s.export={name:i.i18n.prop("ict_oneminer_button_export"),icon:"fa-download",callback:function(n,i){var r=i.$trigger.attr("data-id"),s=t.genApiUrl("model-repo/export?connectId="+e.processManager.getCurrentConnectId()+"&modelId="+r);o.get(s,"",function(e){"fail"===e.status&&a.error(e.msg)},function(e){200===e.status&&(location.href=s)})}}),n.hasClass("model-parent")&&n.parents("#model-tree_1").length&&(s.new={name:i.i18n.prop("ict_oneminer_button_newfolder"),icon:"fa-folder-o",callback:function(t,n){e.openAddFolderDialog()}},s.import={name:i.i18n.prop("ict_oneminer_button_import"),icon:"fa-upload",callback:function(t,n){var i=n.$trigger.attr("data-id");e.openImportDialog(i)}}),n.hasClass("model-root")||(s.delete={name:i.i18n.prop("ict_oneminer_button_delete"),icon:"fa-trash-o",callback:function(n,r){var o=r.$trigger.attr("data-id"),s=this.text(),l=i.i18n.prop("ict_oneminer_dialog_delete_confirm",s),c=new t.Dialog(400,"auto",l);c.setConfirmHandler(function(){var n={modelOrDirId:o,connectId:e.processManager.getCurrentConnectId()},r=t.getDataFromServer(n,t.genApiUrl("model-repo/remove"));"success"===r.status?(i(this).dialog("close"),a.success(i.i18n.prop("ict_oneminer_message_delete_success"),"",t.toastrConfig),e.init(),setTimeout(function(){i("#mod-tree-div").getNiceScroll().resize()},1e3)):a.error(i.i18n.prop("ict_oneminer_model_remove_failed",r.msg))}),i("<div></div>").dialog(c).dialog("open")}}),{items:s}}})},ModelTree.prototype.openSaveDialog=function(e){var n=this,r=new t.Dialog(480);r.title=i.i18n.prop("ict_oneminer_button_saveas"),r.open=function(){n.initModelDialog(i(this)),i("#newName").on("input",function(){/[\\\/:*?"<>|]/.test(this.value)?i(this).addClass("invalid-variable"):i(this).removeClass("invalid-variable")})},r.setConfirmHandler(function(){var t=i("#newName").val().trim();if(!t||i("#newName").hasClass("invalid-variable"))return i("#newName").focus();n.saveAsModel(e,t),i(this).dialog("close")}),i("<div></div>").dialog(r).dialog("open")},ModelTree.prototype.initModelDialog=function(e){var n='<ul class="dialog-content">\n                            <li><div class="name-label">'+i.i18n.prop("ict_oneminer_dialog_model_targetfolder")+'</div><ul id="folderTree" class="ztree pageLeft"></ul></li>\n                            <li><span class="redStar" style="float:left">*</span><div class="name-label">'+i.i18n.prop("ict_oneminer_dialog_model_modelname")+'</div><input id="newName" class="form-control" maxlength=255 placeholder="'+i.i18n.prop("ict_oneminer_dialog_model_palceholder")+'"></li>\n                        </ul>';e.append(n);var o=this.data[0];o.children=o.children.filter(function(e){return e.isParent}),o.children.forEach(function(e){return e.children=[]}),i("#folderTree").empty(),r.setting.callback={onExpand:function(){i("#folderTree").getNiceScroll().resize()},onCollapse:function(){i("#folderTree").getNiceScroll().resize()}},i.fn.zTree.init(i("#folderTree"),r.setting,o);var a=i.fn.zTree.getZTreeObj("folderTree");a.selectNode(a.getNodes()[0],!1),a.expandNode(a.getNodes()[0],!0,!1,!0),t.doNiceScroll("#folderTree")},ModelTree.prototype.saveAsModel=function(e,n){var r=this,s=i.fn.zTree.getZTreeObj("folderTree"),l=s.getSelectedNodes()[0].id,c={src:e,destDir:l,newName:n,connectId:r.processManager.getCurrentConnectId()},u=function(e){e&&"success"===e.status?(r.init(),setTimeout(function(){i("#mod-tree-div").getNiceScroll().resize()},1e3)):e&&"fail"===e.status&&e.msg&&a.error(e.msg)};o.post(t.genApiUrl("model-repo/saveAs"),c,u)},ModelTree.prototype.openAddFolderDialog=function(){var e=this,n=new t.Dialog(480,200);n.title=i.i18n.prop("ict_oneminer_button_newfolder"),n.open=function(){var e='<ul class="dialog-content">\n                                <li><div class="name-label">'+i.i18n.prop("ict_oneminer_dialog_model_foldername")+'</div><input id="newDir" class="form-control" maxlength=255 placeholder=\''+i.i18n.prop("ict_oneminer_dialog_folder_palceholder")+"'></li>\n                            </ul>";i(this).append(e),i("#newDir").on("input",function(){/[\\\/:*?"<>|]/.test(this.value)?i(this).addClass("invalid-variable"):i(this).removeClass("invalid-variable")})},n.setConfirmHandler(function(){var t=i("#newDir").val().trim();if(!t||i("#newDir").hasClass("invalid-variable"))return i("#newDir").focus();e.addFolder(t),i(this).dialog("close")}),i("<div></div>").dialog(n).dialog("open")},ModelTree.prototype.addFolder=function(e){var n=this,r={newDir:e,parentId:"/",connectId:n.processManager.getCurrentConnectId()},a=function(e){n.init(),setTimeout(function(){i("#mod-tree-div").getNiceScroll().resize()},1e3)};o.post(t.genApiUrl("model-repo/savedModel/addDir"),r,a,c)},ModelTree.prototype.openImportDialog=function(e){var n=this,r=new t.Dialog(500,250);r.title=i.i18n.prop("ict_oneminer_dialog_import_model"),r.setOpenHandler(l),r.setConfirmHandler(function(){n.importConfirmHandler(i(this))}),i("<div></div>").dialog(r).data("info",{id:e}).dialog("open")},ModelTree.prototype.importConfirmHandler=function(e){var n=this,r=e,s=r.data("info").id,l=new FormData;if(!i("#file").val().split("\\").pop())return void i("#uploadText").focus();var u=i("#file")[0].files[0];l.append("file",u,encodeURI(u.name)),l.append("dirId",s),l.append("connectId",n.processManager.getCurrentConnectId());var d=function(e){"fail"===e.status?a.warning(e.msg):(a.success(i.i18n.prop("ict_oneminer_message_import_success"),"",t.toastrConfig),n.init()),r.dialog("close")};o.upload(t.genApiUrl("model-repo/import"),l,d,c)},ModelTree}(n),l=function(){var e='<div class="upload-dialog"><lable style="margin-left:20px;">'+i.i18n.prop("ict_oneminer_process_title_file_name")+'</lable><input id="file" type="file"/><input id="uploadText" class="form-control" type="text" placeholder="'+i.i18n.prop("ict_oneminer_process_title_placeholder")+'" readonly="readonly" style="margin:auto 5px auto 10px;height:26px;"/><input id="uploadBtn" class="btn btn-primary btn-sm" type="button" value='+i.i18n.prop("ict_oneminer_process_title_file_select")+' style="height:26px;line-height: 12px;"></div>';i(this).append(e),i("#file").change(function(){"zip"!==i(this).val().split(".").pop().toLowerCase()?(a.error(i.i18n.prop("ict_oneminer_process_title_check_filetype")),i("#uploadText, #file").val("")):i("#uploadText").val(i("#file").val().split("\\").pop())}),i("#uploadBtn").click(function(){i("#file").click()})},c=function(e){a.info(e,"ajax error",t.toastrConfig)};return s}.apply(t,r))&&(e.exports=o)}).call(t,n(0))},function(e,t,n){(function(i){function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r,o;r=[n(3),n(1),n(19)],void 0!==(o=function(e,t,n){var r=function handleI18n(e){e.forEach(function(e){e.label=t.getOperatorLabel(e.id),e.children&&"Diy Operator"!==e.id&&handleI18n(e.children)})};return function(e){function OperatorTree(t,n,i,r,o){return _classCallCheck(this,OperatorTree),_possibleConstructorReturn(this,e.call(this,t,n,i,r,o))}return _inherits(OperatorTree,e),OperatorTree.prototype.getTreeData=function(e){var n=this.processManager.getCurrentConnectId();this.operatorCache||(this.operatorCache={}),e&&(this.operatorCache={});var i=this.operatorCache[n]||(this.operatorCache[n]=t.doGet(t.genApiUrl("operator/list?connectId="+n)));return r(i),i},OperatorTree.prototype.registerSearchHandler=function(){var e=this;i(this.input).on("input",function(){e.search(),i.fn.zTree.getZTreeObj(e.tree.substr(1)).expandAll(i(this).val())}),i(this.input).trigger("input")},OperatorTree.prototype.registerTreeHandler=function(){for(var e=this.getAllLeafs(this.data),t=i("#operator-tree>li li:not(:has(ul))"),n=0,r=e.length;n<r;n++){var o=e[n];this.graphManager.addSidebarIcon(o,t[n])}},OperatorTree}(n)}.apply(t,r))&&(e.exports=o)}).call(t,n(0))},function(e,t,n){(function(i){function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r,o;r=[n(3),n(1),n(4),n(6),n(7),n(103),n(45),n(8),n(47),n(101)],void 0!==(o=function(e,t,n,r,o,a,s,l,c,u){var d=function(){function Home(e,t,n){_classCallCheck(this,Home),this.processManager=e,this.graphManager=t,this.zaip=n,this.init()}return Home.prototype.init=function(){this.initExperiment(),this.addExpListeners(),this.initTemplate(),this.addTempListeners(),this.registerResizeHandler()},Home.prototype.initExperiment=function(){var e=this,n=[{targets:[0],width:"6%",orderable:!1},{targets:[1],width:"20%"},{targets:[2],width:"35%",render:function(e){return'<div class="text-ellipsis home-max-width" title="'+e+'">'+e+"</div>"}},{targets:[6],width:"8%",orderable:!1}];o.get(t.genApiUrl("process/list"),"",function(r){e.expsData=r.data||[],e.experiments=(r.data||[]).map(function(e){return e.name});var o=(r.data||[]).map(function(e,n){return['<input type="checkbox" class="check-exp" data-exp="'+e.name+'" id="expCheck'+n+'" style="display:none"/><label for="expCheck'+n+'"></label>','<div class="exp-name text-ellipsis"><a class="link-exp" title="'+e.name+'">'+t.escape(e.name)+"</a></div>",t.escape(e.description),t.escape(e.updatetime),p(e.status),f(e.publish),'<div class="operate-div">\n                        <i class="fa fa-edit edit-exp" title="'+i.i18n.prop("ict_oneminer_table_operate_edit")+'"></i>\n                        <i class="fa fa-hand-o-right auth-exp '+(e.userId!==i("#username").text()?"disabled":"")+'" title="'+i.i18n.prop("ict_oneminer_dialog_auth_permission")+'"></i>\n                        <i class="fa fa-trash-o del-exp" title="'+i.i18n.prop("ict_oneminer_table_operate_del")+'"></i>\n                    </div>',e]});g(i("#expTable"),o,n)},_)},Home.prototype.addExpListeners=function(){var e=this;i("#addLab").on("click",function(){e.addExpHandler()}),i("#importExpBtn").on("click",function(){var n=t.genApiUrl("process/upload"),i=function(){e.initExperiment();var t=e.processManager.getProcessName();e.processManager.methodProxy.getMethod("refreshTree")(t)},r=a.getInstance(500,250);r.registerUploadConfig({url:n,success:i}),r.show()}),i("#refreshExpBtn").on("click",function(){e.initExperiment()}),i("#expTable").on("click",".link-exp",function(t){e.linkExpHandler(t)}),i("#expTable").on("click",".switch",m),i("#expTable").on("click",".edit-exp",function(t){e.editExpHandler(t)}),i("#expTable").on("click",".auth-exp",function(t){e.authExpHandler(t)}),i("#expTable").on("click",".del-exp","expTable",function(t){e.delExpHandler(t)}),i("#expTable").on("change",".check-exp",function(e){i(e.target).parents("tr").toggleClass("checkedBgColor"),h()}),i("#expTable").on("change","#selectAllExp",function(e){var t=i("#selectAllExp")[0].checked;Array.from(i(".check-exp")).forEach(function(e){e.checked=t,t?i(e).parents("tr").addClass("checkedBgColor"):i(e).parents("tr").removeClass("checkedBgColor")})}),i(".download-exp-div").on({mouseenter:function(){return i(".download-exp").toggleClass("show")},mouseleave:function(){return i(".download-exp").toggleClass("show")},click:function(e){var n=Array.from(i(".check-exp"));if(!n.length){var r=i.i18n.prop("ict_oneminer_experiment_export_check"),o=new t.Dialog(400,200,r);return o.buttons=o.buttons.slice(0,1),void i("<div></div>").dialog(o).dialog("open")}var a=n.filter(function(e){return e.checked}),s=a.map(function(e){return e.dataset.exp}),l=e.target.dataset.type;if(l){var c={exp:t.genApiUrl("process/download?processNames="+s),jar:t.genApiUrl("process/downloadJarExecFile?processNames="+s)},u=c[l];if(a.length)location.href=u;else{var r="exp"===l?i.i18n.prop("ict_oneminer_button_export_exp_all"):i.i18n.prop("ict_oneminer_button_export_exp_algorithm_all"),o=new t.Dialog(400,"auto",r);o.setConfirmHandler(function(){location.href=u,i(this).dialog("close")}),i("<div></div>").dialog(o).dialog("open")}}}}),i("#expTable").on("search.dt page.dt",function(){setTimeout(h,0)})},Home.prototype.addExpHandler=function(){var e=this,t=s.getInstance(600,null,this.processManager,this.graphManager,this.zaip);t.data={type:"new"},t.registerHook("afterClose",function(t){e.initExperiment(),e.processManager.methodProxy.getMethod("addExpCallBack")({exp:t},!0,!0)}),t.show()},Home.prototype.linkExpHandler=function(e){var t=i("#expTable").DataTable().row(i(e.target).parents("tr")).data()[7],n=t.name,r=t.userId;this.processManager.methodProxy.getMethod("addExpCallBack")({exp:n,userId:r},!0)},Home.prototype.editExpHandler=function(e){var n=i("#expTable").DataTable().row(i(e.target).parents("tr")),r=new s(600,null,this.processManager,this.graphManager,this.zaip);r.title=i.i18n.prop("ict_oneminer_dialog_title_edit"),r.data={column:n,type:"edit"},r.registerHook("afterClose",function(r){i(e.target).parents("tr").removeClass("checkedBgColor");var o=n.data();o[2]=t.escape(r),n.data(o),h()}),r.show()},Home.prototype.authExpHandler=function(e){var t=i("#expTable").DataTable().row(i(e.target).parents("tr")),n=new u(500,null,this.processManager,this.graphManager,this.zaip);n.data={expName:t.data()[7].name},n.show()},Home.prototype.delExpHandler=function(e){var n=this,r=i("#"+e.data),o=r.DataTable().row(i(e.target).parents("tr")),a=o.data(),s=i(a[1]).text(),l=a[7]&&a[7].userId,c="expTable"===e.data?t.genApiUrl("process/")+s:t.genApiUrl("template/")+s,u=i.i18n.prop("ict_oneminer_dialog_del_confirm").replace("*",s),d=new t.Dialog(400,"auto",u);d.setConfirmHandler(function(){n.delExpConfirmHandler(i(this))}),i("<div></div>").dialog(d).data("info",{url:c,owner:l,callback:function(){"expTable"===e.data?(n.experiments=n.experiments.filter(function(e){return e!==s}),n.zaip.clearCacheTrain()):n.templates=n.templates.filter(function(e){return e!==s}),o.remove().draw(!1),i("#home").getNiceScroll().resize()}}).dialog("open")},Home.prototype.delExpConfirmHandler=function(e){var r=this,a=e,s=e.data("info").url,l=e.data("info").owner,c=function(e){if("true"===e){(0,a.data("info").callback)();var o=r.processManager.getProcessName();r.processManager.methodProxy.getMethod("refreshTree")(o),n.success(i.i18n.prop("ict_oneminer_message_delete_success"),"",t.toastrConfig)}else n.warning(i.i18n.prop("ict_oneminer_message_delete_fail_"+e));a.dialog("close")};o.del(s,{owner:l},c,_)},Home.prototype.initTemplate=function(){var e=this,n=Array.from(i(".temp-type")),r=n.filter(function(e){return e.checked}).map(function(e){return+e.value}),a={type:r.toString()},s=[{targets:[0],width:"6%",orderable:!1},{targets:[1],width:"20%"},{targets:[2],width:"35%",render:function(e){return'<div class="text-ellipsis home-max-width" title="'+e+'">'+e+"</div>"}},{targets:[4],width:"8%",orderable:!1}];o.get(t.genApiUrl("template/list"),a,function(n){e.templates=(n.data||[]).map(function(e){return e.name});var r=n.data||[],o=r.map(function(e,n){return['<input type="checkbox" class="check-temp" data-temp="'+e.name+'" id="tempCheck'+n+'" style="display:none"/><label for="tempCheck'+n+'"></label>','<div class="temp-name text-ellipsis"><a class="link-temp" title="'+e.name+'">'+t.escape(e.name)+"</a></div>",t.escape(e.description),t.escape(e.createtime),'<div class="operate-div">\n                            <i class="fa fa-edit edit-temp" title="'+i.i18n.prop("ict_oneminer_table_operate_edit")+'"></i>\n                            <i class="fa fa-trash-o del-temp" title="'+i.i18n.prop("ict_oneminer_table_operate_del")+'"></i>\n                        </div>']}),a=i("#tempTable");g(a,o,s)},_)},Home.prototype.addTempListeners=function(){var e=this;i("#refreshTempBtn").on("click",function(){e.initTemplate()}),i("#importTempBtn").on("click",function(){e.uploadListener()}),i("#exportTempBtn").on("click",function(){var e=Array.from(i(".check-temp"));if(!e.length){var n=i.i18n.prop("ict_oneminer_template_export_check"),r=new t.Dialog(400,200,n);return r.buttons=r.buttons.slice(0,1),void i("<div></div>").dialog(r).dialog("open")}var o=e.filter(function(e){return e.checked}),a=o.map(function(e){return e.dataset.temp}),s=t.genApiUrl("template/download?templateNames="+a);if(a.length)location.href=s;else{var n=i.i18n.prop("ict_oneminer_button_export_template_all"),r=new t.Dialog(400,"auto",n);r.setConfirmHandler(function(){location.href=s,i(this).dialog("close")}),i("<div>").dialog(r).dialog("open")}}),i(".temp-type").on("change",function(){e.initTemplate()}),i("#tempTable").on("click",".link-temp",function(t){e.linkTempListener(t)}),i("#tempTable").on("change","#selectAllTemp",function(e){var t=i("#selectAllTemp")[0].checked;Array.from(i(".check-temp")).forEach(function(e){e.checked=t,t?i(e).parents("tr").addClass("checkedBgColor"):i(e).parents("tr").removeClass("checkedBgColor")})}),i("#tempTable").on("change",".check-temp",function(e){i(e.target).parents("tr").toggleClass("checkedBgColor"),h()}),i("#tempTable").on("click",".download-temp",function(e){v(e)}),i("#tempTable").on("click",".edit-temp",function(t){e.editTempHandler(t)}),i("#tempTable").on("click",".del-temp","tempTable",function(t){e.delExpHandler(t)}),i("#tempTable").on("search.dt page.dt",function(){setTimeout(h,0)})},Home.prototype.uploadListener=function(){var e=t.genApiUrl("template/upload"),n=this.initTemplate,i=a.getInstance(500,250);i.registerUploadConfig({url:e,success:n}),i.show()},Home.prototype.linkTempListener=function(e){var t=i(e.target).text();this.processManager.methodProxy.getMethod("addExpCallBack")({exp:t},!1)},Home.prototype.editTempHandler=function(e){var n=i("#tempTable").DataTable().row(i(e.target).parents("tr")),r=new c(600,null,this.processManager,this.graphManager,this.zaip);r.title=i.i18n.prop("ict_oneminer_dialog_title_edit"),r.data={column:n,type:"edit"},r.registerHook("afterClose",function(r){i(e.target).parents("tr").removeClass("checkedBgColor");var o=n.data();o[2]=t.escape(r),n.data(o),h()}),r.show()},Home.prototype.registerResizeHandler=function(){i("#home").on("change","select",function(){h(),i("#home").getNiceScroll().resize()}),i("#home").on("click",function(e){"A"===e.target.nodeName&&i("#home").getNiceScroll().resize()}),i(".download-exp").width(i("#downloadExpBtn").outerWidth())},Home}(),h=function(){var e=Array.from(i(".check-exp"));i("#selectAllExp").attr("disabled",!e.length);var t=e.length&&e.every(function(e){return e.checked});i("#selectAllExp")[0].checked=t;var n=Array.from(i(".check-temp"));i("#selectAllTemp").attr("disabled",!n.length);var t=n.length&&n.every(function(e){return e.checked});i("#selectAllTemp")[0].checked=t},p=function(e){switch(e){case"success":return'<i class="fa fa-circle" style="color:#5cb85c;"></i><span style="margin-left:10px;color:white;">'+i.i18n.prop("ict_oneminer_experiment_status_success")+"</span>";case"running":return'<i class="fa fa-circle" style="color:#77adff;"></i><span style="margin-left:10px;color:white;">'+i.i18n.prop("ict_oneminer_experiment_status_running")+"</span>";case"fail":return'<i class="fa fa-circle" style="color:#ff6160;"></i><span style="margin-left:10px;color:white;">'+i.i18n.prop("ict_oneminer_experiment_status_fail")+"</span>";case"aborted":return'<i class="fa fa-circle" style="color:red;"></i><span style="margin-left:10px;color:white;">'+i.i18n.prop("ict_oneminer_experiment_status_aborted")+"</span>";case"stop":return'<i class="fa fa-circle" style="color:#ca7d05;"></i><span style="margin-left:10px;color:white;">'+i.i18n.prop("ict_oneminer_experiment_status_stop")+"</span>";default:return'<i class="fa fa-circle" style="color:#b3b3b3;"></i><span style="margin-left:10px;color:white;">'+i.i18n.prop("ict_oneminer_experiment_status_not_running")+"</span>"}},f=function(e){return 1===e?'<div class="switch" data-status="on"><div class="switch-on"><div class="on-circle">ON</div><div class="on-right"></div></div></div>':'<div class="switch" data-status="off"><div class="switch-off"><div class="off-circle"></div><div class="off-right">OFF</div></div></div>'},g=function(e,n,i){e.dataTable().fnClearTable(),e.dataTable().fnDestroy(),e.dataTable({language:t.getDatatableLanguage(),autoWidth:!1,paging:!0,order:[],info:!0,searching:!0,bLengthChange:!0,pagingType:"full",dom:'<"search" f>rt<"diyTableBottom" ipl>',iDisplayLength:5,lengthMenu:[5,10,25,50],columnDefs:i,data:n}),t.doNiceScroll("#home")},m=function(){var e=i("#expTable").DataTable().row(i(this).parents("tr")),r=e.data(),o=r[7],a="on"===this.dataset.status?0:1,s={name:o.name,owner:o.userId,publish:a};i.post(t.genApiUrl("process/publish"),s).done(function(t){"true"===t?(r[5]=f(a),e.data(r)):"running"===t?n.warning(i.i18n.prop("ict_oneminer_toastr_publish_warning")):n.error(i.i18n.prop("ict_oneminer_toastr_publish_error"))})},v=function(e){var n=i(e.target).parents("tr").children("td").eq(1).text();location.href=t.genApiUrl("template/download?templateNames="+n)},_=function(e){n.info(e,"ajax error",t.toastrConfig)};return d}.apply(t,r))&&(e.exports=o)}).call(t,n(0))},,function(e,t,n){var i,r;i=[n(23),n(1),n(75),n(3)],void 0!==(r=function(e,t,i,r){n(94),n(95),n(25),n(93),n(91),n(24),n(26),n(87),n(92),n(86),n(78),n(80),n(84),n(83),n(81),n(76),n(77),n(79),n(85),n(89),n(90),n(88),r.init(),i.init()}.apply(t,i))&&(e.exports=r)},function(e,t,n){(function(i){var r,o;r=[n(3),n(1),n(4),n(7)],void 0!==(o=function(e,t,n,r){!function(){i(".backup-btn").click(function(){r.post(t.genApiUrl("backup/execute"),null,function(){n.success(i.i18n.prop("ict_oneminer_backup_success"),"",t.toastrConfig)})})}()}.apply(t,r))&&(e.exports=o)}).call(t,n(0))},function(e,t,n){var i,r;i=[n(0),n(42),n(28),n(7),n(1),n(4)],void 0!==(r=function(e,t,n,i,r,o){var a=function(){e(".date-time").datetimepicker({showOtherMonths:!0,showSecond:!0,selectOtherMonths:!0,changeMonth:!1,changeYear:!1,timeFormat:"hh:mm:ss",dateFormat:"yy-mm-dd",timeInput:!0,onSelect:function(){e(".select-time>li").removeClass("time-selected")}}),e("#oneDay").click()},s=function(){var t={userName:e("#user").val(),opName:e("#operate").val(),address:e("#ip").val(),oplevel:e("#level").val(),beginTime:l(e("#startTime").val()),endTime:l(e("#endTime").val())};i.post(r.genApiUrl("operationLog/query"),t,c,u)},l=function(e){return e?new Date(e).getTime():""},c=function(t){var n=t||[],i=n.map(function(t){return[t.opTime,d(t.opLevel),t.userName,'<div class="log-content-div"><div class="ip-div"><span>'+e.i18n.prop("ict_oneminer_table_tr_address")+"</span>   "+t.address+'</div>\n            <div class="log-operate-div text-ellipsis"><span>'+e.i18n.prop("ict_oneminer_table_tr_operate")+'</span>   <span title="'+t.opName+'">'+t.opName+'</span></div>\n            <div class="resulu-div"><span>'+e.i18n.prop("ict_oneminer_table_tr_result")+"</span>   "+t.opResult+'</div>\n            <div class="detail-div"><a id="detailOperate"><i class="fa fa-chevron-right"></i>  <span id="detailWord">'+e.i18n.prop("ict_oneminer_table_show_detail")+'</span></a></div>\n            <div class="log-detail">'+t.detail+"</div></div>"]}),r=e("#logTable");h(r,i)},u=function(t){h(e("#logTable"),[]),o.error(t,"ajax error",r.toastrConfig)},d=function(t){var n=["all","very_important","important","notice","normal"];return e.i18n.prop("ict_oneminer_log_level_"+n[t])},h=function(e,t){e.dataTable().fnClearTable(),e.dataTable().fnDestroy(),e.dataTable({language:r.getDatatableLanguage(),autoWidth:!1,paging:!0,order:[[0,"desc"]],info:!0,searching:!1,bLengthChange:!0,pagingType:"full",dom:'<"search" f>rt<"diyTableBottom" ipl>',iDisplayLength:10,lengthMenu:[10,20,50,100],columnDefs:[{targets:[3],orderable:!1,width:"50%"}],data:t}),r.doNiceScroll("#log")},p=function(){e("#log").getNiceScroll().resize()},f=function(t){var n=new Date,i=n.Format("yyyy-MM-dd hh:mm:ss");e("#endTime").val(i);var r=this.dataset.type;e(this).parent().addClass("time-selected").siblings().removeClass("time-selected");var o={thirtyMinutes:18e5,oneHour:36e5,twoHours:72e5,sixHours:216e5,oneDay:864e5,oneWeek:6048e5},a=new Date(n.getTime()-o[r]).Format("yyyy-MM-dd hh:mm:ss");e("#startTime").val(a)},g=function(){var t=e(this).parents(".log-content-div");t.find("i").toggleClass("icon-rotate");var n=t.find("#detailWord"),i=t.find("i").hasClass("icon-rotate")?e.i18n.prop("ict_oneminer_table_pack_up_detail"):e.i18n.prop("ict_oneminer_table_show_detail");n.text(i),t.find(".log-detail").toggle(),p()},m=function(){var t=e(this).text()===e.i18n.prop("ict_oneminer_log_lable_senior")?e.i18n.prop("ict_oneminer_log_lable_pack_up"):e.i18n.prop("ict_oneminer_log_lable_senior");e(this).text(t),e(".other-options").toggle(),p()},v=function(){a(),s()};return function(){e("#searchLogBtn").on("click",s),e("#log").on("click",function(e){"A"===e.target.nodeName&&p()}),e("#log").on("change","#logTable_length select",p),e("#log").on("keypress","input",function(t){13===t.keyCode&&e("#searchLogBtn").click()}),e("#log").on("click",".select-time-item",f),e("#log").on("click","#detailOperate",g),e("#senior").on("click",m),e(".log-calendar").on("click",function(){e(this).prev().focus()})}(),{init:v}}.apply(t,i))&&(e.exports=r)},function(e,t,n){(function(i){function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r,o;r=[n(4),n(1),n(3),n(7)],void 0!==(o=function(e,t,n,r){var o=function(){function Manage(e){_classCallCheck(this,Manage),this.processManager=e,this.tableListeners()}return Manage.prototype.initOperatorTable=function(){r.get(t.genApiUrl("diyAlgorithm/query"),"",function(e){var n=i("#diyOperatorTable"),r=s(e);n.dataTable().fnClearTable(),n.dataTable().fnDestroy(),n.dataTable({language:t.getDatatableLanguage(),autoWidth:!1,paging:!0,ordering:!0,info:!0,searching:!0,bLengthChange:!0,order:[],pagingType:"full",dom:'<"search" f>rt<"diyTableBottom" ipl>',columnDefs:[{targets:[0,5],orderable:!1},{targets:[1],width:"20%",render:function(e){return'<div class="text-ellipsis co-max-width" title="'+e+'">'+e+"</div>"}},{targets:[2],width:"15%",render:function(e){return'<div class="text-ellipsis co-max-width" title="'+e+'">'+e+"</div>"}}],data:r}),t.doNiceScroll("#manage"),i("#deleteCheck").attr("disabled",0===i(".check-oper").length),n.on("search.dt",function(){setTimeout(l,0)})},c)},Manage.prototype.tableListeners=function(){this.downloadListeners(),this.deleteListeners(),this.tableChangeListeners()},Manage.prototype.downloadListeners=function(){i(".download-div").on({mouseenter:function(){return i(".download-template").toggleClass("show")},mouseleave:function(){return i(".download-template").toggleClass("show")},click:function(e){var n=e.target.dataset.type;n&&(location.href=t.genApiUrl("diyAlgorithm/downloadTemplate?executeFrame="+n))}}),i("#diyOperatorTable").on("click",".para-manage-export",function(e){var n=i(e.target).parents("tr").find("input")[0].dataset.name;location.href=t.genApiUrl("diyAlgorithm/download?algorithmKey="+n)})},Manage.prototype.deleteListeners=function(){var e=this;i("#deleteCheck").on("click",function(e){var t=i(e.target).is(":checked"),n=i(".check-oper");i("#batchDelete").attr("disabled",!t),Array.from(n).forEach(function(e){e.checked=t,t?i(e).parents("tr").addClass("checkedBgColor"):i(e).parents("tr").removeClass("checkedBgColor")})}),i("#diyOperatorTable").on("click",".check-oper",function(e){i(e.target).parents("tr").toggleClass("checkedBgColor"),l()}),i("#manage").on("click",".para-manage-del, #batchDelete",function(n){var r=e,o="",a="batchDelete"===n.target.id;if(a)o=i.i18n.prop("ict_oneminer_dialog_delete_confirm","");else{var s=i(n.target).parents("tr").find("input")[0].dataset.name;o=i.i18n.prop("ict_oneminer_dialog_del_confirm").replace("*",s)}var l=new t.Dialog(400,"auto",o);l.setConfirmHandler(function(){r.deleteOperatorsHandler(i(this))}),a?i("<div></div>").dialog(l).dialog("open"):i("<div></div>").dialog(l).data({info:s}).dialog("open")})},Manage.prototype.tableChangeListeners=function(){var e=this,t=i("#manage");i("#importDiyOperator").on("click",function(){e.uploadListener()}),t.on("change","select",function(){t.getNiceScroll().resize(),l()}),t.on("click",function(e){"A"===e.target.nodeName&&(t.getNiceScroll().resize(),l())})},Manage.prototype.deleteOperatorsHandler=function(e){var t,n=this,r=[];if(e.dialog("close"),e.data("info"))r.push(e.data("info"));else var r=Array.from(i(".check-oper").filter(":checked")).map(function(e){return e.dataset.name});var o=r.map(function(e){return n.deleteOperators(e)});(t=i).when.apply(t,o).done(function(){n.reloadPage()})},Manage.prototype.deleteOperators=function(n){var o={algorithmKey:n};return r.get(t.genApiUrl("diyAlgorithm/delete"),o,function(r){1==r?(t.removeParamById(n),t.removePortsCacheById(n),e.success(i.i18n.prop("ict_oneminer_toastr_content_delete_success"),"",t.toastrConfig)):e.warning(i.i18n.prop("ict_oneminer_toastr_content_delete_failed"))},c)},Manage.prototype.uploadListener=function(){var e=this,n=new t.Dialog(500);n.title=i.i18n.prop("ict_oneminer_button_import_diy_operator"),n.height=250,n.setOpenHandler(a),n.setConfirmHandler(function(){e.uploadConfirmHandler(i(this))}),i("<div></div>").dialog(n).dialog("open")},Manage.prototype.uploadConfirmHandler=function(e){var t,r=this;r.existArray=[];var o=i("#file")[0].files,a=e;if(!o.length)return void i("#uploadText").focus();var s=Array.from(o).map(function(e){return r.filesUpload(e,a)});(t=i).when.apply(t,s).done(function(){n.refetchDiyOperatorI18n(),r.existArray.length?r.overwriteOperators():r.reloadPage()})},Manage.prototype.filesUpload=function(n,o){var a=this,s=new FormData,l=n.name;return s.append("file",n),r.upload(t.genApiUrl("diyAlgorithm/upload"),s,function(n){var r=n.errorMessageKey;r?r&&"has_exists"===r?(a.existArray.push({fileName:l,operator:n.otherMessage}),o[0].classList[0]&&o.dialog("close")):e.error(i.i18n.prop("ict_oneminer_toastr_content_"+r).replace("*",l)):(o[0].classList[0]&&o.dialog("close"),t.removeParamById(n[0]&&n[0].algorithmKey),t.removePortsCacheById(n[0]&&n[0].algorithmKey),e.success(i.i18n.prop("ict_oneminer_message_upload_success"),"",t.toastrConfig))},c,"JSON","false")},Manage.prototype.overwriteOperators=function(){var n=this,o=n.existArray.map(function(e){return t.getOperatorLabel(e.operator)}).join(","),a=o+" "+i.i18n.prop("ict_oneminer_dialog_overwrite_confirm"),s=new t.Dialog(400,200,a);s.setCancelHandler(function(){i(this).dialog("close"),n.reloadPage()}),s.setConfirmHandler(function(){var o,a=n.existArray.forEach(function(n){var o=function(){e.success(i.i18n.prop("ict_oneminer_message_upload_success"),"",t.toastrConfig)};r.post(t.genApiUrl("diyAlgorithm/overwrite"),{file:n.fileName},o,c,"false")});i(this).dialog("close"),(o=i).when.apply(o,a).done(function(){n.reloadPage()})}),i("<div></div>").dialog(s).dialog("open")},Manage.prototype.reloadPage=function(){var e=this;e.initOperatorTable(),e.processManager.methodProxy.getMethod("operatorChangeEvent")(),i("#manage").getNiceScroll().resize()},Manage}(),a=function(){var t='<div class="upload-dialog">\n                        <lable style="margin-left:20px;">'+i.i18n.prop("ict_oneminer_process_title_file_name")+'</lable>\n                        <input id="file" type="file" multiple="multiple"/>\n                        <input id="uploadText" class="form-control" type="text" placeholder="'+i.i18n.prop("ict_oneminer_process_title_placeholder")+'" readonly="readonly" style="margin:auto 5px auto 10px;height:26px;"/>\n                        <input id="uploadBtn" class="btn btn-primary btn-sm" type="button" value="'+i.i18n.prop("ict_oneminer_process_title_file_select")+'" style="height:26px;line-height: 12px;">\n                    </div>';i(this).append(t),i("#file").change(function(){for(var t=i(this)[0].files,n="",r=0;r<t.length;r++){"zip"!==t[r].name.split(".").pop().toLowerCase()?e.error(t[r].name+" "+i.i18n.prop("ict_oneminer_process_title_check_filetype")):n+=t[r].name+", "}var o=n.trim();n=o.substring(0,o.length-1),""!==n?i("#uploadText").val(n).attr("title",n):i("#uploadText, #file").val("")}),i("#uploadBtn").click(function(){i("#file").click()})},s=function(e){var n=[];return(e||[]).forEach(function(e,r){var o=t.getOperatorLabel(e.algorithmKey);n[r]=['<input type="checkbox" class="check-oper" data-name="'+e.algorithmKey+'" id="diyOper'+r+'" style="display:none"/><label for="diyOper'+r+'"></label>',o,e.executeFrame,e.className,e.createTime,'<a class="para-manage-export"  title="'+i.i18n.prop("ict_oneminer_process_toolbar_tooltip_export")+'" data-name="'+o+'"><i class="fa fa-fw fa-download"></i></a>\n                <a class="para-manage-del" style="padding-left: 15px" title="'+i.i18n.prop("ict_oneminer_process_toolbar_tooltip_delete")+'"><i class="fa fa-trash-o"></i></a>']}),n},l=function(){var e=Array.from(i(".check-oper")),t=e.some(function(e){return e.checked});i("#batchDelete").attr("disabled",!t);var n=e.length&&e.every(function(e){return e.checked});i("#deleteCheck").attr("disabled",!e.length),i("#deleteCheck")[0].checked=n},c=function(n){e.info(n,"ajax error",t.toastrConfig)};return o}.apply(t,r))&&(e.exports=o)}).call(t,n(0))},function(e,t,n){var i,r;i=[n(0),n(31),n(5),n(4),n(6),n(29),n(49),n(1),n(8),n(3),n(7)],void 0!==(r=function(e,t,i,r,o,a,s,l,c,u,d){function getGraph(){return h}function clear(){h.removeCells(h.getDefaultParent().children),h.refresh()}function init(t,i,l,u){if(w.mxClient.isBrowserSupported()){w.mxEvent.disableContextMenu(t),p=new w.mxGraphModel,h=new w.mxGraph(t,p),f=h.getDefaultParent(),h.getModel().addListener(w.mxEvent.UNDO,i),h.getView().addListener(w.mxEvent.UNDO,i),h.getView().addListener(w.mxEvent.SCALE_AND_TRANSLATE,i),h.getView().addListener(w.mxEvent.SCALE,i),h.getView().addListener(w.mxEvent.TRANSLATE,i),h.getSelectionModel().addListener(w.mxEvent.CHANGE,function(e,t){var n=t.getProperty("added");n&&n.forEach(function(e){e.value&&e.value.isOperator&&(e.value.selected=!1,A={})});var i=t.getProperty("removed");i&&i.forEach(function(e){e&&e.value&&e.value.isOperator&&(A[e.value.name]={geometry:e.geometry,parent:e.parent,id:e.id},e.value.selected=!0)}),I(),s.selectionChanged(),E(),h.refresh()});var d="onwheel"in document?"wheel":"onmousewheel"in document?"mousewheel":"DOMMouseScroll";e(t).on(d,function(e){var t=0;e.originalEvent.wheelDelta?t=e.originalEvent.wheelDelta:e.originalEvent.deltaY&&(t=-e.originalEvent.deltaY),t&&(e.preventDefault(),t>0?h.zoomIn():h.zoomOut())}),h.setAllowDanglingEdges(!1),h.setDropEnabled(!0),h.setPanning(!0),h.setCellsResizable(!1),h.setSwimlaneNesting(!0),h.cellsEditable=!1,h.setHtmlLabels(!0),h.setConnectable(!0),h.foldingEnabled=!1,h.keepEdgesInBackground=!1,h.popupMenuHandler.autoExpand=!0,h.addListener(w.mxEvent.ADD_CELLS,function(e,t){t.getProperty("cells").forEach(function(e){e.isVertex()&&e.value&&e.value.isOperator&&a.addOperator({id:e.id,name:e.value.name,type:e.value.type,isGroup:e.value.isGroup,multiPort:!o.isEmpty(e.value.inputs)&&e.value.inputs[0].multi,params:e.value.params||{}})})}),h.convertValueToString=function(e){return!e.value||"zaipInput"!=e.value.name&&"zaipOutput"!=e.value.name?e.value?e.value.name?e.value.isGroup?e.value.name:e.value.isOperator?getOperatorDiv(e.value):"":e.value:"":getInputAndOutputDiv(e.value)},h.popupMenuHandler.factoryMethod=function(t,n,i){a.getEditable()&&n&&(n.value&&n.value.isPort||!n.value.name||"zaipInput"===n.value.type||"zaipOutput"===n.value.type||(t.addItem(e.i18n.prop("ict_oneminer_popup_menu_delete"),null,function(){var e=function(){h.removeCells(),addZaipBackground()};k(n.value.name,e)},null,"fa fa-trash-o"),t.addItem(e.i18n.prop("ict_zaip_rename"),null,function(){D(n)},null,"fa fa-exchange")))},h.addListener(w.mxEvent.CLICK,function(t,i){var r=t.lastEvent.which;h.getChildEdges().forEach(function(e){h.removeCellOverlays(e)}),h.clearCellOverlays();var o=i.getProperty("cell");if(1===r)if(o&&o.isVertex()&&"zaipBackground"!=o.value.type)l();else{var s=h.getSelectionCells(),c=s.length;0===c||1===c&&s[0].value&&"zaipBackground"==s[0].value.type?e("#right-item").is(":hidden")?l():u():l()}if(a.getEditable()&&o&&o.isEdge()){if(!h.getCellOverlays(o)){var d=new w.mxCellOverlay(new w.mxImage(n(70),16,16),"Delete",null,null,null,"pointer");d.addListener(w.mxEvent.CLICK,function(e,t){var n=function(){h.removeCells()};k(o.target.parent.value.name,n)}),h.addCellOverlay(o,d)}}}),h.addListener(w.mxEvent.REMOVE_CELLS,function(e,t){t.getProperty("cells").forEach(function(e){e.isVertex()&&e.value?removeCellAndChildren(e):e.isEdge()&&(e.target.value.data=null,e.target.value.multi&&handleMultiInputPorts(e.target.parent))}),a.updateData()}),h.addListener(w.mxEvent.CELL_CONNECTED,function(e,t){if(!a.getLoadingStatus()){var n=t.getProperty("edge"),i=n.source,o=n.target;if(i&&o){var s;if(s=!!o.multiInput||1===o.getEdgeCount(),s||r.error("one port one edge"),s&&!a.getEditable()&&(s=!1,r.error("view mode can not connect everything")),!s||i.value.portType===c.PORT_OUTPUT_TYPE&&o.value.portType===c.PORT_INPUT_TYPE||(s=!1,r.error("edge source must be outport, target be inport")),s&&i.parent.id===o.parent.id&&(s=!1,r.error("target op should not be source op")),s){o.value.data=i.value.data;""===n.value||a.updateData()}else h.removeCells([n]);handleMultiPortOperators(),w.mxEvent.consume(t)}}}),h.dblClick=function(e,t){!t||!t.isVertex()||t.value.isPort||"zaipBackground"==t.value.type||"zaipInput"===t.value.type||"zaipOutput"===t.value.type||D(t)};new w.mxRubberband(h);configureStylesheet(h)}else w.mxUtils.error("browser not support mxGraph！",200,!1)}function handleMultiPortOperators(){a.getMultiPortOperators().forEach(function(e){handleMultiInputPorts(e)})}function removeCellAndChildren(e){e.value.isGroup&&!o.isEmpty(e.children)&&e.children.forEach(function(e){removeCellAndChildren(e)}),a.removeOperatorById(e.id)}function handleMultiInputPorts(e){var t=0,n="",i=[],o=!1;if(e.children.forEach(function(e){var a=e.value;if(a&&a.portType===c.PORT_INPUT_TYPE){if(!a.multi)return void r.error("input port without multi flag is unsupported");""===n?n=a.name.substr(0,3):a.name.startsWith(n)?a.name=n+"-"+t:r.error("input ports with multi flag should have same name prefix"),o=!1,0===e.getEdgeCount()?(i.push(e),o=!0):t++}}),i.length>0&&h.removeCells(i.slice(0,i.length-(o?1:0))),!o){var a=h.insertVertex(e,null,{name:n+"-"+t,multi:!0,required:null,isPort:!0,portType:c.PORT_INPUT_TYPE},1,0,T,T,"shape=ellipse;perimeter=ellipsePerimeter;fillColor=#fff;opacity=80;",!0);a.geometry.offset=new w.mxPoint(0,-5),a.setConnectable(!0)}var s=0,l=getPositions(t+1);e.children.forEach(function(e){var t=e.value;t&&t.portType===c.PORT_INPUT_TYPE&&(e.geometry.x=l[s++])}),h.refresh()}function getInputAndOutputDiv(t){var n=e("<div/>",{class:"outerOperatorName",title:t.name}).html(t.name),i=e("<div/>",{class:"outerOperator"}),r=e("<div/>",{class:"des-op"});t.shape&&r.html(t.shape);var a;return o.isEmpty(t.status)||(a='<div class="backFontDiv warning" title="'+t.status.msg+'" style="margin-top:1px">\n                <i class="fa fa-exclamation-circle"></i>\n                </div>'),i.append(n).append(a).append(r),t.selected&&i.addClass("selected"),t.invalid&&i.addClass("invalid"),i[0]}function getOperatorDiv(t){var n,i=e("<div/>",{class:"frontFontDiv"}).append(e("<i/>",{class:t.icon?t.icon:"fa fa-puzzle-piece"})),r=e("<div/>",{class:"operatorNameDiv",title:t.name}).html(t.name);o.isEmpty(t.status)||(n='<div class="backFontDiv warning" title="'+t.status.msg+'"><i class="fa fa-exclamation-circle"></i></div>');var a=e("<div/>",{class:"bigBox"});t.selected&&a.addClass("selected"),t.invalid&&a.addClass("invalid");var s=e("<div/>",{class:"des-op"});return t.shape&&s.html(t.shape),a.append(i).append(r).append(n).append(s),a[0]}function getRelativePoint(e,t,n,i){var r=e,o=t,a=n&&n.value&&n.value.isGroup?n:f;if(i&&m&&(x=e-_,b=t-y,m=!1),a===f)return i?{x:r-x,y:o-b}:{x:r,y:o};var s=L(a,e,t,i);return getRelativePoint(s.x,s.y,n.parent,i)}function insertOperator(e){addOperatorCell(h,null,p.getCell(e.parent),e.x,e.y,e.width,e.height,e.type,e.id,e.name,e.params)}function addOperatorCell(e,t,n,i,r,o,s,u,d,h,m){var _=l.getPortsDLM(u),y=JSON.parse(JSON.stringify(_));if(y.type=u,y.name=h||a.getName((l.isModel(u)?y.label:l.getOperatorLabel(u))+"_1"),y.params=m||{},y.status={},y.icon=l.getOperatorIcon(u),delete y.id,delete y.label,!a.isExist(y.name)){y.isOperator=!0;var x=null;a.getLoadingStatus()||p.beginUpdate();try{var b=n&&n.value&&n.value.isGroup?n:f;"zaipInput"!=u&&"zaipOutput"!=u||(b=f),"zaipInput"==u&&(y.params=a.getZaipInputServerParams(m));var A="",o=o||C,s=s||S;if("zaipBackground"===y.type&&(y.name="",b=f,A="dashStyle",y.isGroup=!0),a.getLoadingStatus())x=e.insertVertex(b,d,y,i,r,o,s,A),"zaipBackground"===y.type&&(g=x);else{2===a.getProcessInfo(!0).operators.length&&(e.removeCells([g]),b=f,g=f),b=g||f,v=!0;var M=getRelativePoint(i,r,b,!1);x=e.insertVertex(b,d,y,M.x,M.y,o,s,A)}if(x.setConnectable(!1),"zaipBackground"!==y.type){if("zaipInput"!==y.type){var E=e.insertVertex(x,null,{name:y.input,multi:y.multiInput,isPort:!0,portType:c.PORT_INPUT_TYPE},.5,0,T,T,"shape=ellipse;perimeter=ellipsePerimeter;fillColor=#fff;opacity=80;",!0);E.geometry.offset=new w.mxPoint(0,-5),E.setConnectable(!0)}if("zaipOutput"!==y.type){var I=e.insertVertex(x,null,{name:y.output,isPort:!0,portType:c.PORT_OUTPUT_TYPE},.5,1,T,T,"shape=ellipse;perimeter=ellipsePerimeter;fillColor=#fff;opacity=80;",!0);I.geometry.offset=new w.mxPoint(0,-5),I.setConnectable(!0)}}}finally{a.getLoadingStatus()||p.endUpdate()}a.getLoadingStatus()||(e.setSelectionCell(x),a.updateData())}}function setModelUpdate(e){e?p.beginUpdate():p.endUpdate()}function insertConnect(e){var t=getPortCell(h,e.from_op,e.from_port,c.PORT_OUTPUT_TYPE),n=getPortCell(h,e.to_op,e.to_port,c.PORT_INPUT_TYPE);t&&n&&h.insertEdge(h.getDefaultParent(),null,null,t,n)}function getPortCell(e,t,n,i){var o=null;if(t){var a=getOperatorCellByName(e,t);if(!a)return r.error("failed to get operator: "+t),null;if(!a.children)return null;a.children.some(function(e){if(e.value&&e.value.portType===i&&(i===c.PORT_OUTPUT_TYPE||i===c.PORT_INPUT_TYPE))return o=e,!0})}return o}function getOperatorCellByName(e,t){return a.getOperatorAsCell(e,t)}function addZaipBackground(){if(2===a.getProcessInfo(!0).operators.length||g===f){var t=e("#visual-graph").height(),n=e("#visual-graph").width(),i=Math.max(.8*t,300),r=Math.max(.8*n,600),o={name:"",type:"zaipBackground",id:"1",parent:"",x:10,y:50,params:{},width:r,height:i,children:[]};a.setLoadingStatus(!0),setModelUpdate(!0),insertOperator(o),setModelUpdate(!1),a.setLoadingStatus(!1),h.selectCells(),s.selectionChanged(!1)}}function addSidebarIcon(e,t){if(e&&t){var n=function(t,n,i,r,o){a.getEditable()&&addOperatorCell(t,n,i,r,o,null,null,e)},i=document.createElement("div");i.style.border="dashed black 1px",i.style.width=C+"px",i.style.height=S+"px";w.mxUtils.makeDraggable(t,h,n,i,0,0,!0,!0).setGuidesEnabled(!0)}}function configureStylesheet(e){var t={};t[w.mxConstants.STYLE_SHAPE]=w.mxConstants.SHAPE_RECTANGLE,t[w.mxConstants.STYLE_PERIMETER]=w.mxPerimeter.RectanglePerimeter,t[w.mxConstants.STYLE_ALIGN]=w.mxConstants.ALIGN_CENTER,t[w.mxConstants.STYLE_VERTICAL_ALIGN]=w.mxConstants.ALIGN_MIDDLE,t[w.mxConstants.STYLE_FILLCOLOR]="#000000",t[w.mxConstants.STYLE_RESIZABLE]=0,t[w.mxConstants.STYLE_FONTCOLOR]="#FFFFFF",t[w.mxConstants.STYLE_FOLDABLE]=0,t[w.mxConstants.STYLE_ROUNDED]=!0,t[w.mxConstants.STYLE_ARCSIZE]="50",t[w.mxConstants.STYLE_OPACITY]="20",w.mxConstants.SELECTION_DASHED=!1,w.mxConstants.VERTEX_SELECTION_STROKEWIDTH=0,w.mxConstants.VERTEX_SELECTION_COLOR="",e.getStylesheet().putDefaultVertexStyle(t);var n=new Object;n[w.mxConstants.STYLE_SHAPE]="swimlane",n[w.mxConstants.STYLE_FILLCOLOR]="#427FB6",n[w.mxConstants.STYLE_STROKECOLOR]="#427FB6",n[w.mxConstants.STYLE_RESIZABLE]=1,n[w.mxConstants.STYLE_FOLDABLE]=1,n[w.mxConstants.STYLE_ROUNDED]=!1,n[w.mxConstants.STYLE_ARCSIZE]="0",n[w.mxConstants.STYLE_OPACITY]="100",n[w.mxConstants.STYLE_STARTSIZE]=S,e.getStylesheet().putCellStyle("swimlanestyle",n);var i=new Object;i[w.mxConstants.STYLE_SHAPE]=w.mxConstants.SHAPE_RECTANGLE,i[w.mxConstants.STYLE_FILLCOLOR]="#000",i[w.mxConstants.STYLE_STROKECOLOR]="#fff",i[w.mxConstants.STYLE_STROKEWIDTH]="1",i[w.mxConstants.STYLE_ROUNDED]=!1,i[w.mxConstants.STYLE_ARCSIZE]="0",i[w.mxConstants.STYLE_OPACITY]="20",i[w.mxConstants.STYLE_DASHED]=!0,e.getStylesheet().putCellStyle("dashStyle",i);var r=e.getStylesheet().getDefaultEdgeStyle();r[w.mxConstants.STYLE_ROUNDED]=!0,r[w.mxConstants.STYLE_CURVED]=!0,r[w.mxConstants.STYLE_SEGMENT]=50,r[w.mxConstants.STYLE_ENDARROW]="none",w.mxConstants.HANDLE_STROKECOLOR="none",w.mxConstants.HANDLE_FILLCOLOR="none",r[w.mxConstants.STYLE_ELBOW]=w.mxConstants.ELBOW_VERTICAL,r[w.mxConstants.STYLE_EDGE]=w.mxEdgeStyle.MyStyle}var h,p,f,g,m,v,_,y,x,b,w=l.mx,C=200,S=30,T=10,A={},M=[],E=function(){var e=h.getSelectionCell();(e&&e.children||[]).forEach(function(e){(e.edges||[]).forEach(function(e){M.push(e),e.setStyle("strokeColor=#00ff00")})})},I=function(){M.forEach(function(e){e.setStyle()}),M=[]},D=function(t){if(a.getEditable()){var n=t.value.name,i=n.lastIndexOf("_"),r=-1!==i?n.substring(0,i+1):n+"_",o=-1!==i?n.substring(i+1):"",s='<div class="rename-content">\n                            <div class="rename-main clearfix">\n                                <div class="pull-left rename-pre">'+r+'</div>\n                                <div class="rename-input"><input id="rename-later" class="pull-left" value="'+o+'" /></div>\n                            </div>\n                            <div class="rename-rule">'+e.i18n.prop("ict_zaip_rename_rule")+"</div>\n                        </div>",c=new l.Dialog(500,200);c.title=e.i18n.prop("ict_zaip_rename"),c.setOpenHandler(function(){e(this).html(s)}),c.setConfirmHandler(function(){var n=e("#rename-later"),i=e("#rename-later").val(),r=/^[0-9a-zA-Z]+$/,o=e(".rename-pre").html()+i;if(""===i.trim()||!r.test(i)||a.isExist(o)&&o!==t.value.name)return void n.addClass("wrong");var s=function(){t.value.name=o,a.setOperatorName(t.id,o),t.value.status={},a.updateData(),h.refresh()};k(t.value.name,s),e(this).dialog("close")}),e("<div></div>").dialog(c).dialog("open")}},k=function(e,t){var n={execAll:!1,operatorName:e};s.modifyConfirm({},null,null,null,null,t,n)},L=function(e,t,n,i){var r,o;return i?v?(r=t+x,o=n+b,v=!1):(r=t,o=n):(r=t-e.getGeometry().x,o=n-e.getGeometry().y),{x:r,y:o}},N=function(){g=null},P=function(){if(a.getEditable()&&h.isEnabled()){var e=h.getSelectionCells().every(function(e){return!(e.value&&e.value.isPort)&&e.value.name&&"zaipInput"!==e.value.type&&"zaipOutput"!==e.value.type}),t=function(){h.removeCells(),addZaipBackground()};e&&h.getSelectionCell()&&k(h.getSelectionCell().value.name,t)}};return w.mxStyleRegistry.putValue("myEdgeStyle",w.mxEdgeStyle.MyStyle),{init:init,getGraph:getGraph,clear:clear,addSidebarIcon:addSidebarIcon,setModelUpdate:setModelUpdate,insertOperator:insertOperator,insertConnect:insertConnect,clearZaipBackground:N,delCallBack:P}}.apply(t,i))&&(e.exports=r)},function(e,t,n){(function(i){function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r,o;r=[n(3),n(1),n(19)],void 0!==(o=function(e,t,n){var r=function handleI18n(e){e.forEach(function(e){e.label=t.getOperatorLabel(e.id),e.children&&handleI18n(e.children)})};return function(e){function OperatorTree(t,n,i,r,o){return _classCallCheck(this,OperatorTree),_possibleConstructorReturn(this,e.call(this,t,n,i,r,o))}return _inherits(OperatorTree,e),OperatorTree.prototype.getTreeData=function(e){var n=this.processManager.getZaipId();this.operatorCache||(this.operatorCache={}),e&&(this.operatorCache={});var i=this.operatorCache[n]||(this.operatorCache[n]=t.doGet(t.genApiUrl("layer/list?connectId="+n)));return r(i),i},OperatorTree.prototype.registerSearchHandler=function(){var e=this;i(this.input).on("input",function(){e.search(),i.fn.zTree.getZTreeObj(e.tree.substr(1)).expandAll(i(this).val())}),i(this.input).trigger("input")},OperatorTree.prototype.registerTreeHandler=function(){for(var e=this.getAllLeafs(this.data),t=i("#visual-operator-tree>li li:not(:has(ul))"),n=0,r=e.length;n<r;n++){var o=e[n];this.graphManager.addSidebarIcon(o,t[n])}},OperatorTree}(n)}.apply(t,r))&&(e.exports=o)}).call(t,n(0))},function(e,t,n){var i,r;i=[n(0),n(6),n(3),n(41),n(40),n(54),n(17),n(1)],void 0!==(r=function(e,t,i,r,o,a,s,l){function initData(){y=null,h=0,p=0,f=null,d=[]}function createChart(t){t.dialog({maxHeight:e(window).height(),minWidth:900});var n=e("<div/>",{class:"train-echarts clearfix"});t.append(n);n.append('<div class="pull-left train-result-li">\n                        <div id="loss_realtime"  class="chart-sdxx"></div>\n                        <div id="loss_history" class="chart-sdxx"></div>\n                    </div>\n                    <div class="pull-left train-result-li">\n                        <div id="accuracy_realtime"  class="chart-sdxx"></div>\n                        <div id="accuracy_history" class="chart-sdxx"></div>\n                    </div>');var i=g;x[i[0]+"_realtime"]=c.init(document.getElementById(i[0]+"_realtime"),"dark"),x[i[1]+"_realtime"]=c.init(document.getElementById(i[1]+"_realtime"),"dark"),x[i[0]]=c.init(document.getElementById(i[0]+"_history"),"dark"),x[i[1]]=c.init(document.getElementById(i[1]+"_history"),"dark"),l.doNiceScroll(".result-dialog"),e(".result-dialog").on("change","select",function(){e(".result-dialog").getNiceScroll().resize()})}function createDialog(t,n){var i=new l.Dialog(600);i.title=e.i18n.prop("ict_oneminer_dialog_title_resultinfo"),i.position={my:"top",at:"top"},i.resizable=!0,i.buttons=[],i.open=function(i){createChart(e(i.target)),startWS(t,n)},i.close=function(t){e(t.target).dialog("destroy"),closeWS()},e('<div id="confirm-dialog" class="result-dialog"></div>').dialog(i).dialog("open")}function _isEnd(e,t){if("end"===e)return!0;if("checkpoint"!==e){if(t.hasOwnProperty("end")){var n=t.end;if(void 0!==n&&n)return!0}return!1}}function _init_data_in_legends(){var e={};for(var t in m){e[m[t]]=[]}return e}function _makeSeriesArrayData_(e){for(var t=_init_data_in_legends(),n=_init_data_in_legends(),i=0;i<e.length;i++){var r=e[i],o=r.type,a=r.task_info,s=a.current_step,l=a.loss,c=a.accuracy;if(!_isEnd(o,a))if("checkpoint"===o)d.push([s,0]);else{if("train"===o){if(s<h)continue;h=s}if("validate"===o){if(s<p)continue;p=s}var u=[s,l],f=[s,c];t[o].push(u),n[o].push(f)}}for(var g in m){var v=m[g];"checkpoint"===v&&(0===t[v].length&&t[v].push([]),0===n[v].length&&n[v].push([]))}var _=[],y=[];for(var x in m){var b=m[x];_.push(t[b]),y.push(n[b])}var w={};return w.loss=_,w.accuracy=y,w}function _makeSeries(e,t){var n={};return n.name=e,n.type="line",n.smooth=!0,n.data=t,n.showAllSymbol=!0,n}function _makeSeriesArray(e,t){var n=[];for(var i in e){var r=_makeSeries(e[i],t[i]);n.push(r)}return n}function _mkNewOption(e,t,n,i,r){var o={};return o.title={text:t,bottom:"5%",left:"center",textStyle:{fontSize:16}},o.legend={data:i,left:"10%"},o.series=e,_mkTooltip(o,n,r),_mkToolbox(o),o.dataZoom={show:!1,realtime:!0,start:0,end:100},o.xAxis=[{name:"step",type:"value"},{name:"step",type:"value"}],_mkYAxis(o,n),o}function _drawHistoryCheckPoint(e,t){for(var n={symbol:"droplet",symbolSize:5,type:"scatter"},i=[],r=0;r<d.length;r++){var o=d[r];i.push(o)}n.data=i,t.series[2]=n,x[e].setOption(t)}function _isSampled(e,t){if(e<=_)return!0;if(1==t||t==e)return!0;var n=_/(2*e),i=(2*t-1)*n,r=(2*t+1)*n;return Math.ceil(i)<r}function _addDelta(e,t,n){var i=0,r=0,o=t.type,a=t.task_info,s=a.current_step,l=a.loss,c=a.accuracy;if(0===v&&(v=s),"train"===o){if(s<h)return;if(h=s,i=t.total_reports,r=t.current_report,_isSampled(i,r)){var u=e.loss.getOption(),d=e.accuracy.getOption();u.series[0].data.push([s,l]),d.series[0].data.push([s,c]),e.loss.setOption(u),e.accuracy.setOption(d)}var p=e.loss_realtime.getOption(),f=e.accuracy_realtime.getOption();p.series[0].data.push([s,l]),f.series[0].data.push([s,c]),e.loss_realtime.setOption(p),e.accuracy_realtime.setOption(f)}else if("validate"===o){if(i=t.total_reports,r=t.current_report,_isSampled(i,r)){var u=e.loss.getOption(),d=e.accuracy.getOption();u.series[1].data.push([s,l]),d.series[1].data.push([s,c]),e.loss.setOption(u),e.accuracy.setOption(d)}var p=e.loss_realtime.getOption(),f=e.accuracy_realtime.getOption();p.series[1].data.push([s,l]),f.series[1].data.push([s,c]),e.loss_realtime.setOption(p),e.accuracy_realtime.setOption(f)}else if("checkpoint"===o){var u=e.loss.getOption(),d=e.accuracy.getOption();u.series[2].data.push([s,0]),d.series[2].data.push([s,0]),e.loss.setOption(u),e.accuracy.setOption(d)}}function _dealWsResponse(e,t){var n,i=e.history;if(i){var r=_makeSeriesArrayData_(i);for(var o in g){n=g[o];var a=r[n],s=_makeSeriesArray(m,a),l=n,c=_mkNewOption(s,l,n,m,t);x[n].setOption(c),_drawHistoryCheckPoint(n,c)}var u=[],d=_makeSeriesArrayData_(u);for(var h in g){var p=g[h],f=d[p],v=_makeSeriesArray(m,f),_="real-time "+p,y=_mkNewOption(v,_,p,m,t);y.xAxis=[{name:"step",type:"value",scale:!0},{name:"step",type:"value",scale:!0}],x[p+"_realtime"].setOption(y)}}else _addDelta(x,e)}function startWS(e,t){y=new WebSocket(e),y.onopen=function(e){y.send("REG_"+t)},y.onclose=function(e){initData()},y.onmessage=function(e){var n=JSON.parse(e.data);_cache(t,n),_dealWsResponse(n,t)},y.onerror=function(e){y.close()}}function _mkToolbox(e){e.toolbox={show:!0,right:"5%",feature:{dataZoom:{yAxisIndex:"none"},saveAsImage:{show:!0}}}}function _mkTooltip(e,t,n){e.tooltip={trigger:"axis",axisPointer:{show:!0,type:"none"},formatter:function(e){var e=e[0],i=e.seriesName,r=e.value[0],o=i+": step "+e.value[0];"checkpoint"!==i&&(o=o+"<br> "+t+" "+e.value[1]);var a=u[n][i+r],s=a.task_info.used_time;return o+"<br> time : "+b(s)}}}function _mkYAxis(e,t){e.yAxis="accuracy"===t?[{type:"value",max:1.2,min:0,splitNumber:6}]:[{type:"value",max:"dataMax",scale:!0},{type:"value",max:"dataMax",scale:!0}]}function _cache(e,t){var n=t.history;if(null!==n&&void 0!==n){u[e]={};for(var i=0;i<n.length;i++){_putToHistory(e,n[i])}}else u.hasOwnProperty(e)&&_putToHistory(e,t)}function _putToHistory(e,t){var n=t.type,i=t.task_info.current_step,r=n+i;u[e][r]=t}function closeWS(){null!==y&&y.close()}var c=n(14),u={},d=[],h=0,p=0,f=null,g=["loss","accuracy"],m=["train","validate","checkpoint"],v=0,_=50,y=null,x={},b=function(e){var t;if(e>-1){var n=Math.floor(e/3600),i=Math.floor(e/60)%60,r=e%60;t=n<10?"0"+n+":":n+":",i<10&&(t+="0"),t+=i+":",r<10&&(t+="0"),t+=r.toFixed(2)}return t};return{createDialog:createDialog}}.apply(t,i))&&(e.exports=r)},function(e,t,n){n(27);!function(t,i){e.exports=i(n(0),n(27))}(0,function(e,t){function _setHeaders(e,t){if(t)for(var n in t)if(t.hasOwnProperty(n)){if("content-type"===n.toLowerCase())continue;e.setRequestHeader(n,t[n])}}function LongPollingTransport(){var n=new t.LongPollingTransport,i=t.Transport.derive(n);return i.xhrSend=function(t){return e.ajax({url:t.url,async:!0!==t.sync,type:"POST",contentType:"application/json;charset=UTF-8",data:t.body,global:!1,xhrFields:{withCredentials:!0},beforeSend:function(e){return e.withCredentials=!0,_setHeaders(e,t.headers),!0},success:t.onSuccess,error:function(e,n,i){t.onError(n,i)}})},i}function CallbackPollingTransport(){var n=new t.CallbackPollingTransport,i=t.Transport.derive(n);return i.jsonpSend=function(t){e.ajax({url:t.url,async:!0!==t.sync,type:"GET",dataType:"jsonp",jsonp:"jsonp",data:{message:t.body},beforeSend:function(e){return _setHeaders(e,t.headers),!0},success:t.onSuccess,error:function(e,n,i){t.onError(n,i)}})},i}return e.CometD=function(e){var n=new t.CometD(e);return n.unregisterTransports(),window.WebSocket&&n.registerTransport("websocket",new t.WebSocketTransport),n.registerTransport("long-polling",new LongPollingTransport),n.registerTransport("callback-polling",new CallbackPollingTransport),n},e.cometd=new e.CometD,e.cometd})},function(e,t,n){var i,r,o;!function(a){r=[n(0)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){"use strict";function splitAccesskey(e){for(var t,n=e.split(/\s+/),i=[],r=0;t=n[r];r++)t=t.charAt(0).toUpperCase(),i.push(t);return i}function inputLabel(t){return t.id&&e('label[for="'+t.id+'"]').val()||t.name}function menuChildren(t,n,i){return i||(i=0),n.each(function(){var n,r,o=e(this),a=this,s=this.nodeName.toLowerCase();switch("label"===s&&o.find("input, textarea, select").length&&(n=o.text(),o=o.children().first(),a=o.get(0),s=a.nodeName.toLowerCase()),s){case"menu":r={name:o.attr("label"),items:{}},i=menuChildren(r.items,o.children(),i);break;case"a":case"button":r={name:o.text(),disabled:!!o.attr("disabled"),callback:function(){return function(){o.get(0).click()}}()};break;case"menuitem":case"command":switch(o.attr("type")){case void 0:case"command":case"menuitem":r={name:o.attr("label"),disabled:!!o.attr("disabled"),icon:o.attr("icon"),callback:function(){return function(){o.get(0).click()}}()};break;case"checkbox":r={type:"checkbox",disabled:!!o.attr("disabled"),name:o.attr("label"),selected:!!o.attr("checked")};break;case"radio":r={type:"radio",disabled:!!o.attr("disabled"),name:o.attr("label"),radio:o.attr("radiogroup"),value:o.attr("id"),selected:!!o.attr("checked")};break;default:r=void 0}break;case"hr":r="-------";break;case"input":switch(o.attr("type")){case"text":r={type:"text",name:n||inputLabel(a),disabled:!!o.attr("disabled"),value:o.val()};break;case"checkbox":r={type:"checkbox",name:n||inputLabel(a),disabled:!!o.attr("disabled"),selected:!!o.attr("checked")};break;case"radio":r={type:"radio",name:n||inputLabel(a),disabled:!!o.attr("disabled"),radio:!!o.attr("name"),value:o.val(),selected:!!o.attr("checked")};break;default:r=void 0}break;case"select":r={type:"select",name:n||inputLabel(a),disabled:!!o.attr("disabled"),selected:o.val(),options:{}},o.children().each(function(){r.options[this.value]=e(this).text()});break;case"textarea":r={type:"textarea",name:n||inputLabel(a),disabled:!!o.attr("disabled"),value:o.val()};break;case"label":break;default:r={type:"html",html:o.clone(!0)}}r&&(i++,t["key"+i]=r)}),i}e.support.htmlMenuitem="HTMLMenuItemElement"in window,e.support.htmlCommand="HTMLCommandElement"in window,e.support.eventSelectstart="onselectstart"in document.documentElement,e.ui&&e.widget||(e.cleanData=function(t){return function(n){var i,r,o;for(o=0;null!=n[o];o++){r=n[o];try{i=e._data(r,"events"),i&&i.remove&&e(r).triggerHandler("remove")}catch(e){}}t(n)}}(e.cleanData));var t=null,n=!1,i=e(window),r=0,o={},a={},s={},l={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,selectableSubMenu:!1,classNames:{hover:"context-menu-hover",disabled:"context-menu-disabled",visible:"context-menu-visible",notSelectable:"context-menu-not-selectable",icon:"context-menu-icon",iconEdit:"context-menu-icon-edit",iconCut:"context-menu-icon-cut",iconCopy:"context-menu-icon-copy",iconPaste:"context-menu-icon-paste",iconDelete:"context-menu-icon-delete",iconAdd:"context-menu-icon-add",iconQuit:"context-menu-icon-quit",iconLoadingClass:"context-menu-icon-loading"},determinePosition:function(t){if(e.ui&&e.ui.position)t.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");else{var n=this.offset();n.top+=this.outerHeight(),n.left+=this.outerWidth()/2-t.outerWidth()/2,t.css(n)}},position:function(e,t,n){var r;if(!t&&!n)return void e.determinePosition.call(this,e.$menu);if("maintain"===t&&"maintain"===n)r=e.$menu.position();else{var o=e.$menu.offsetParent().offset();r={top:n-o.top,left:t-o.left}}var a=i.scrollTop()+i.height(),s=i.scrollLeft()+i.width(),l=e.$menu.outerHeight(),c=e.$menu.outerWidth();r.top+l>a&&(r.top-=l),r.top<0&&(r.top=0),r.left+c>s&&(r.left-=c),r.left<0&&(r.left=0),e.$menu.css(r)},positionSubmenu:function(t){if(void 0!==t)if(e.ui&&e.ui.position)t.css("display","block").position({my:"left top-5",at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var n={top:-9,left:this.outerWidth()-5};t.css(n)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:e.noop,hide:e.noop},callback:null,items:{}},c={timer:null,pageX:null,pageY:null},u=function(e){for(var t=0,n=e;;)if(t=Math.max(t,parseInt(n.css("z-index"),10)||0),!(n=n.parent())||!n.length||"html body".indexOf(n.prop("nodeName").toLowerCase())>-1)break;return t},d={abortevent:function(e){e.preventDefault(),e.stopImmediatePropagation()},contextmenu:function(n){var i=e(this);if("right"===n.data.trigger&&(n.preventDefault(),n.stopImmediatePropagation()),!("right"!==n.data.trigger&&"demand"!==n.data.trigger&&n.originalEvent||!(void 0===n.mouseButton||!n.data||"left"===n.data.trigger&&0===n.mouseButton||"right"===n.data.trigger&&2===n.mouseButton)||i.hasClass("context-menu-active")||i.hasClass("context-menu-disabled"))){if(t=i,n.data.build){var r=n.data.build(t,n);if(!1===r)return;if(n.data=e.extend(!0,{},l,n.data,r||{}),!n.data.items||e.isEmptyObject(n.data.items))throw window.console&&(console.error||console.log).call(console,"No items specified to show in contextMenu"),new Error("No Items specified");n.data.$trigger=t,h.create(n.data)}var o=!1;for(var a in n.data.items)if(n.data.items.hasOwnProperty(a)){var s;s=e.isFunction(n.data.items[a].visible)?n.data.items[a].visible.call(e(n.currentTarget),a,n.data):void 0===n.data.items[a]||!n.data.items[a].visible||!0===n.data.items[a].visible,s&&(o=!0)}o&&h.show.call(i,n.data,n.pageX,n.pageY)}},click:function(t){t.preventDefault(),t.stopImmediatePropagation(),e(this).trigger(e.Event("contextmenu",{data:t.data,pageX:t.pageX,pageY:t.pageY}))},mousedown:function(n){var i=e(this);t&&t.length&&!t.is(i)&&t.data("contextMenu").$menu.trigger("contextmenu:hide"),2===n.button&&(t=i.data("contextMenuActive",!0))},mouseup:function(n){var i=e(this);i.data("contextMenuActive")&&t&&t.length&&t.is(i)&&!i.hasClass("context-menu-disabled")&&(n.preventDefault(),n.stopImmediatePropagation(),t=i,i.trigger(e.Event("contextmenu",{data:n.data,pageX:n.pageX,pageY:n.pageY}))),i.removeData("contextMenuActive")},mouseenter:function(n){var i=e(this),r=e(n.relatedTarget),o=e(document);r.is(".context-menu-list")||r.closest(".context-menu-list").length||t&&t.length||(c.pageX=n.pageX,c.pageY=n.pageY,c.data=n.data,o.on("mousemove.contextMenuShow",d.mousemove),c.timer=setTimeout(function(){c.timer=null,o.off("mousemove.contextMenuShow"),t=i,i.trigger(e.Event("contextmenu",{data:c.data,pageX:c.pageX,pageY:c.pageY}))},n.data.delay))},mousemove:function(e){c.pageX=e.pageX,c.pageY=e.pageY},mouseleave:function(t){var n=e(t.relatedTarget);if(!n.is(".context-menu-list")&&!n.closest(".context-menu-list").length){try{clearTimeout(c.timer)}catch(t){}c.timer=null}},layerClick:function(t){var n,r,o=e(this),a=o.data("contextMenuRoot"),s=t.button,l=t.pageX,c=t.pageY;t.preventDefault(),setTimeout(function(){var o,u="left"===a.trigger&&0===s||"right"===a.trigger&&2===s;if(document.elementFromPoint&&a.$layer){if(a.$layer.hide(),n=document.elementFromPoint(l-i.scrollLeft(),c-i.scrollTop()),n.isContentEditable){var d=document.createRange(),h=window.getSelection();d.selectNode(n),d.collapse(!0),h.removeAllRanges(),h.addRange(d)}e(n).trigger(t),a.$layer.show()}if(a.reposition&&u)if(document.elementFromPoint){if(a.$trigger.is(n))return void a.position.call(a.$trigger,a,l,c)}else if(r=a.$trigger.offset(),o=e(window),r.top+=o.scrollTop(),r.top<=t.pageY&&(r.left+=o.scrollLeft(),r.left<=t.pageX&&(r.bottom=r.top+a.$trigger.outerHeight(),r.bottom>=t.pageY&&(r.right=r.left+a.$trigger.outerWidth(),r.right>=t.pageX))))return void a.position.call(a.$trigger,a,l,c);n&&u&&a.$trigger.one("contextmenu:hidden",function(){e(n).contextMenu({x:l,y:c,button:s})}),null!==a&&void 0!==a&&null!==a.$menu&&void 0!==a.$menu&&a.$menu.trigger("contextmenu:hide")},50)},keyStop:function(e,t){t.isInput||e.preventDefault(),e.stopPropagation()},key:function(e){var n={};t&&(n=t.data("contextMenu")||{}),void 0===n.zIndex&&(n.zIndex=0);var i=0,r=function(e){""!==e.style.zIndex?i=e.style.zIndex:null!==e.offsetParent&&void 0!==e.offsetParent?r(e.offsetParent):null!==e.parentElement&&void 0!==e.parentElement&&r(e.parentElement)};if(r(e.target),!(n.$menu&&parseInt(i,10)>parseInt(n.$menu.css("zIndex"),10))){switch(e.keyCode){case 9:case 38:if(d.keyStop(e,n),n.isInput){if(9===e.keyCode&&e.shiftKey)return e.preventDefault(),n.$selected&&n.$selected.find("input, textarea, select").blur(),void(null!==n.$menu&&void 0!==n.$menu&&n.$menu.trigger("prevcommand"));if(38===e.keyCode&&"checkbox"===n.$selected.find("input, textarea, select").prop("type"))return void e.preventDefault()}else if(9!==e.keyCode||e.shiftKey)return void(null!==n.$menu&&void 0!==n.$menu&&n.$menu.trigger("prevcommand"));break;case 40:if(d.keyStop(e,n),!n.isInput)return void(null!==n.$menu&&void 0!==n.$menu&&n.$menu.trigger("nextcommand"));if(9===e.keyCode)return e.preventDefault(),n.$selected&&n.$selected.find("input, textarea, select").blur(),void(null!==n.$menu&&void 0!==n.$menu&&n.$menu.trigger("nextcommand"));if(40===e.keyCode&&"checkbox"===n.$selected.find("input, textarea, select").prop("type"))return void e.preventDefault();break;case 37:if(d.keyStop(e,n),n.isInput||!n.$selected||!n.$selected.length)break;if(!n.$selected.parent().hasClass("context-menu-root")){var o=n.$selected.parent().parent();return n.$selected.trigger("contextmenu:blur"),void(n.$selected=o)}break;case 39:if(d.keyStop(e,n),n.isInput||!n.$selected||!n.$selected.length)break;var a=n.$selected.data("contextMenu")||{};if(a.$menu&&n.$selected.hasClass("context-menu-submenu"))return n.$selected=null,a.$selected=null,void a.$menu.trigger("nextcommand");break;case 35:case 36:return n.$selected&&n.$selected.find("input, textarea, select").length?void 0:((n.$selected&&n.$selected.parent()||n.$menu).children(":not(."+n.classNames.disabled+", ."+n.classNames.notSelectable+")")[36===e.keyCode?"first":"last"]().trigger("contextmenu:focus"),void e.preventDefault());case 13:if(d.keyStop(e,n),n.isInput){if(n.$selected&&!n.$selected.is("textarea, select"))return void e.preventDefault();break}return void(void 0!==n.$selected&&null!==n.$selected&&n.$selected.trigger("mouseup"));case 32:case 33:case 34:return void d.keyStop(e,n);case 27:return d.keyStop(e,n),void(null!==n.$menu&&void 0!==n.$menu&&n.$menu.trigger("contextmenu:hide"));default:var s=String.fromCharCode(e.keyCode).toUpperCase();if(n.accesskeys&&n.accesskeys[s])return void n.accesskeys[s].$node.trigger(n.accesskeys[s].$menu?"contextmenu:focus":"mouseup")}e.stopPropagation(),void 0!==n.$selected&&null!==n.$selected&&n.$selected.trigger(e)}},prevItem:function(t){t.stopPropagation();var n=e(this).data("contextMenu")||{},i=e(this).data("contextMenuRoot")||{};if(n.$selected){var r=n.$selected;n=n.$selected.parent().data("contextMenu")||{},n.$selected=r}for(var o=n.$menu.children(),a=n.$selected&&n.$selected.prev().length?n.$selected.prev():o.last(),s=a;a.hasClass(i.classNames.disabled)||a.hasClass(i.classNames.notSelectable)||a.is(":hidden");)if(a=a.prev().length?a.prev():o.last(),a.is(s))return;n.$selected&&d.itemMouseleave.call(n.$selected.get(0),t),d.itemMouseenter.call(a.get(0),t);var l=a.find("input, textarea, select");l.length&&l.focus()},nextItem:function(t){t.stopPropagation();var n=e(this).data("contextMenu")||{},i=e(this).data("contextMenuRoot")||{};if(n.$selected){var r=n.$selected;n=n.$selected.parent().data("contextMenu")||{},n.$selected=r}for(var o=n.$menu.children(),a=n.$selected&&n.$selected.next().length?n.$selected.next():o.first(),s=a;a.hasClass(i.classNames.disabled)||a.hasClass(i.classNames.notSelectable)||a.is(":hidden");)if(a=a.next().length?a.next():o.first(),a.is(s))return;n.$selected&&d.itemMouseleave.call(n.$selected.get(0),t),d.itemMouseenter.call(a.get(0),t);var l=a.find("input, textarea, select");l.length&&l.focus()},focusInput:function(){var t=e(this).closest(".context-menu-item"),n=t.data(),i=n.contextMenu,r=n.contextMenuRoot;r.$selected=i.$selected=t,r.isInput=i.isInput=!0},blurInput:function(){var t=e(this).closest(".context-menu-item"),n=t.data(),i=n.contextMenu;n.contextMenuRoot.isInput=i.isInput=!1},menuMouseenter:function(){e(this).data().contextMenuRoot.hovering=!0},menuMouseleave:function(t){var n=e(this).data().contextMenuRoot;n.$layer&&n.$layer.is(t.relatedTarget)&&(n.hovering=!1)},itemMouseenter:function(t){var n=e(this),i=n.data(),r=i.contextMenu,o=i.contextMenuRoot;if(o.hovering=!0,t&&o.$layer&&o.$layer.is(t.relatedTarget)&&(t.preventDefault(),t.stopImmediatePropagation()),(r.$menu?r:o).$menu.children("."+o.classNames.hover).trigger("contextmenu:blur").children(".hover").trigger("contextmenu:blur"),n.hasClass(o.classNames.disabled)||n.hasClass(o.classNames.notSelectable))return void(r.$selected=null);n.trigger("contextmenu:focus")},itemMouseleave:function(t){var n=e(this),i=n.data(),r=i.contextMenu,o=i.contextMenuRoot;if(o!==r&&o.$layer&&o.$layer.is(t.relatedTarget))return void 0!==o.$selected&&null!==o.$selected&&o.$selected.trigger("contextmenu:blur"),t.preventDefault(),t.stopImmediatePropagation(),void(o.$selected=r.$selected=r.$node);r&&r.$menu&&r.$menu.hasClass("context-menu-visible")||n.trigger("contextmenu:blur")},itemClick:function(t){var n,i=e(this),r=i.data(),o=r.contextMenu,a=r.contextMenuRoot,s=r.contextMenuKey;if(!(!o.items[s]||i.is("."+a.classNames.disabled+", .context-menu-separator, ."+a.classNames.notSelectable)||i.is(".context-menu-submenu")&&!1===a.selectableSubMenu)){if(t.preventDefault(),t.stopImmediatePropagation(),e.isFunction(o.callbacks[s])&&Object.prototype.hasOwnProperty.call(o.callbacks,s))n=o.callbacks[s];else{if(!e.isFunction(a.callback))return;n=a.callback}!1!==n.call(a.$trigger,s,a,t)?a.$menu.trigger("contextmenu:hide"):a.$menu.parent().length&&h.update.call(a.$trigger,a)}},inputClick:function(e){e.stopImmediatePropagation()},hideMenu:function(t,n){var i=e(this).data("contextMenuRoot");h.hide.call(i.$trigger,i,n&&n.force)},focusItem:function(t){t.stopPropagation();var n=e(this),i=n.data(),r=i.contextMenu,o=i.contextMenuRoot;n.hasClass(o.classNames.disabled)||n.hasClass(o.classNames.notSelectable)||(n.addClass([o.classNames.hover,o.classNames.visible].join(" ")).parent().find(".context-menu-item").not(n).removeClass(o.classNames.visible).filter("."+o.classNames.hover).trigger("contextmenu:blur"),r.$selected=o.$selected=n,r&&r.$node&&r.$node.hasClass("context-menu-submenu")&&r.$node.addClass(o.classNames.hover),r.$node&&o.positionSubmenu.call(r.$node,r.$menu))},blurItem:function(t){t.stopPropagation();var n=e(this),i=n.data(),r=i.contextMenu,o=i.contextMenuRoot;r.autoHide&&n.removeClass(o.classNames.visible),n.removeClass(o.classNames.hover),r.$selected=null}},h={show:function(n,i,r){var o=e(this),a={};if(e("#context-menu-layer").trigger("mousedown"),n.$trigger=o,!1===n.events.show.call(o,n))return void(t=null);if(h.update.call(o,n),n.position.call(o,n,i,r),n.zIndex){var s=n.zIndex;"function"==typeof n.zIndex&&(s=n.zIndex.call(o,n)),a.zIndex=u(o)+s}h.layer.call(n.$menu,n,a.zIndex),n.$menu.find("ul").css("zIndex",a.zIndex+1),n.$menu.css(a)[n.animation.show](n.animation.duration,function(){o.trigger("contextmenu:visible")}),o.data("contextMenu",n).addClass("context-menu-active"),e(document).off("keydown.contextMenu").on("keydown.contextMenu",d.key),n.autoHide&&e(document).on("mousemove.contextMenuAutoHide",function(e){var t=o.offset();t.right=t.left+o.outerWidth(),t.bottom=t.top+o.outerHeight(),!n.$layer||n.hovering||e.pageX>=t.left&&e.pageX<=t.right&&e.pageY>=t.top&&e.pageY<=t.bottom||setTimeout(function(){n.hovering||null===n.$menu||void 0===n.$menu||n.$menu.trigger("contextmenu:hide")},50)})},hide:function(n,i){var r=e(this);if(n||(n=r.data("contextMenu")||{}),i||!n.events||!1!==n.events.hide.call(r,n)){if(r.removeData("contextMenu").removeClass("context-menu-active"),n.$layer){setTimeout(function(e){return function(){e.remove()}}(n.$layer),10);try{delete n.$layer}catch(e){n.$layer=null}}t=null,n.$menu.find("."+n.classNames.hover).trigger("contextmenu:blur"),n.$selected=null,n.$menu.find("."+n.classNames.visible).removeClass(n.classNames.visible),e(document).off(".contextMenuAutoHide").off("keydown.contextMenu"),n.$menu&&n.$menu[n.animation.hide](n.animation.duration,function(){n.build&&(n.$menu.remove(),e.each(n,function(e){switch(e){case"ns":case"selector":case"build":case"trigger":return!0;default:n[e]=void 0;try{delete n[e]}catch(e){}return!0}})),setTimeout(function(){r.trigger("contextmenu:hidden")},10)})}},create:function(t,n){function createNameNode(t){var n=e("<span></span>");if(t._accesskey)t._beforeAccesskey&&n.append(document.createTextNode(t._beforeAccesskey)),e("<span></span>").addClass("context-menu-accesskey").text(t._accesskey).appendTo(n),t._afterAccesskey&&n.append(document.createTextNode(t._afterAccesskey));else if(t.isHtmlName){if(void 0!==t.accesskey)throw new Error("accesskeys are not compatible with HTML names and cannot be used together in the same item");n.html(t.name)}else n.text(t.name);return n}void 0===n&&(n=t),t.$menu=e('<ul class="context-menu-list"></ul>').addClass(t.className||"").data({contextMenu:t,contextMenuRoot:n}),e.each(["callbacks","commands","inputs"],function(e,i){t[i]={},n[i]||(n[i]={})}),n.accesskeys||(n.accesskeys={}),e.each(t.items,function(i,r){var o=e('<li class="context-menu-item"></li>').addClass(r.className||""),a=null,l=null;if(o.on("click",e.noop),"string"!=typeof r&&"cm_separator"!==r.type||(r={type:"cm_seperator"}),r.$node=o.data({contextMenu:t,contextMenuRoot:n,contextMenuKey:i}),void 0!==r.accesskey)for(var c,u=splitAccesskey(r.accesskey),p=0;c=u[p];p++)if(!n.accesskeys[c]){n.accesskeys[c]=r;var f=r.name.match(new RegExp("^(.*?)("+c+")(.*)$","i"));f&&(r._beforeAccesskey=f[1],r._accesskey=f[2],r._afterAccesskey=f[3]);break}if(r.type&&s[r.type])s[r.type].call(o,r,t,n),e.each([t,n],function(n,o){o.commands[i]=r,!e.isFunction(r.callback)||void 0!==o.callbacks[i]&&void 0!==t.type||(o.callbacks[i]=r.callback)});else{switch("cm_seperator"===r.type?o.addClass("context-menu-separator "+n.classNames.notSelectable):"html"===r.type?o.addClass("context-menu-html "+n.classNames.notSelectable):"sub"===r.type||(r.type?(a=e("<label></label>").appendTo(o),createNameNode(r).appendTo(a),o.addClass("context-menu-input"),t.hasTypes=!0,e.each([t,n],function(e,t){t.commands[i]=r,t.inputs[i]=r})):r.items&&(r.type="sub")),r.type){case"cm_seperator":break;case"text":l=e('<input type="text" value="1" name="" />').attr("name","context-menu-input-"+i).val(r.value||"").appendTo(a);break;case"textarea":l=e('<textarea name=""></textarea>').attr("name","context-menu-input-"+i).val(r.value||"").appendTo(a),r.height&&l.height(r.height);break;case"checkbox":l=e('<input type="checkbox" value="1" name="" />').attr("name","context-menu-input-"+i).val(r.value||"").prop("checked",!!r.selected).prependTo(a);break;case"radio":l=e('<input type="radio" value="1" name="" />').attr("name","context-menu-input-"+r.radio).val(r.value||"").prop("checked",!!r.selected).prependTo(a);break;case"select":l=e('<select name=""></select>').attr("name","context-menu-input-"+i).appendTo(a),r.options&&(e.each(r.options,function(t,n){e("<option></option>").val(t).text(n).appendTo(l)}),l.val(r.selected));break;case"sub":createNameNode(r).appendTo(o),r.appendTo=r.$node,o.data("contextMenu",r).addClass("context-menu-submenu"),r.callback=null,"function"==typeof r.items.then?h.processPromises(r,n,r.items):h.create(r,n);break;case"html":e(r.html).appendTo(o);break;default:e.each([t,n],function(n,o){o.commands[i]=r,!e.isFunction(r.callback)||void 0!==o.callbacks[i]&&void 0!==t.type||(o.callbacks[i]=r.callback)}),createNameNode(r).appendTo(o)}r.type&&"sub"!==r.type&&"html"!==r.type&&"cm_seperator"!==r.type&&(l.on("focus",d.focusInput).on("blur",d.blurInput),r.events&&l.on(r.events,t)),r.icon&&(e.isFunction(r.icon)?r._icon=r.icon.call(this,this,o,i,r):"string"==typeof r.icon&&"fa-"===r.icon.substring(0,3)?r._icon=n.classNames.icon+" "+n.classNames.icon+"--fa fa "+r.icon:r._icon=n.classNames.icon+" "+n.classNames.icon+"-"+r.icon,o.addClass(r._icon))}r.$input=l,r.$label=a,o.appendTo(t.$menu),!t.hasTypes&&e.support.eventSelectstart&&o.on("selectstart.disableTextSelect",d.abortevent)}),t.$node||t.$menu.css("display","none").addClass("context-menu-root"),t.$menu.appendTo(t.appendTo||document.body)},resize:function(t,n){var i;t.css({position:"absolute",display:"block"}),t.data("width",(i=t.get(0)).getBoundingClientRect?Math.ceil(i.getBoundingClientRect().width):t.outerWidth()+1),t.css({position:"static",minWidth:"0px",maxWidth:"100000px"}),t.find("> li > ul").each(function(){h.resize(e(this),!0)}),n||t.find("ul").addBack().css({position:"",display:"",minWidth:"",maxWidth:""}).outerWidth(function(){return e(this).data("width")})},update:function(t,n){var i=this;void 0===n&&(n=t,h.resize(t.$menu)),t.$menu.children().each(function(){var r,o=e(this),a=o.data("contextMenuKey"),s=t.items[a],l=e.isFunction(s.disabled)&&s.disabled.call(i,a,n)||!0===s.disabled;if(r=e.isFunction(s.visible)?s.visible.call(i,a,n):void 0===s.visible||!0===s.visible,o[r?"show":"hide"](),o[l?"addClass":"removeClass"](n.classNames.disabled),e.isFunction(s.icon)&&(o.removeClass(s._icon),s._icon=s.icon.call(this,i,o,a,s),o.addClass(s._icon)),s.type)switch(o.find("input, select, textarea").prop("disabled",l),s.type){case"text":case"textarea":s.$input.val(s.value||"");break;case"checkbox":case"radio":s.$input.val(s.value||"").prop("checked",!!s.selected);break;case"select":s.$input.val((0===s.selected?"0":s.selected)||"")}s.$menu&&h.update.call(i,s,n)})},layer:function(t,n){var r=t.$layer=e('<div id="context-menu-layer"></div>').css({height:i.height(),width:i.width(),display:"block",position:"fixed","z-index":n,top:0,left:0,opacity:0,filter:"alpha(opacity=0)","background-color":"#000"}).data("contextMenuRoot",t).insertBefore(this).on("contextmenu",d.abortevent).on("mousedown",d.layerClick);return void 0===document.body.style.maxWidth&&r.css({position:"absolute",height:e(document).height()}),r},processPromises:function(e,t,n){function completedPromise(e,t,n){void 0===n&&errorPromise(void 0),finishPromiseProcess(e,t,n)}function errorPromise(e,t,n){void 0===n?(n={error:{name:"No items and no error item",icon:"context-menu-icon context-menu-icon-quit"}},window.console&&(console.error||console.log).call(console,'When you reject a promise, provide an "items" object, equal to normal sub-menu items')):"string"==typeof n&&(n={error:{name:n}}),finishPromiseProcess(e,t,n)}function finishPromiseProcess(e,t,n){void 0!==t.$menu&&t.$menu.is(":visible")&&(e.$node.removeClass(t.classNames.iconLoadingClass),e.items=n,h.create(e,t,!0),h.update(e,t),t.positionSubmenu.call(e.$node,e.$menu))}e.$node.addClass(t.classNames.iconLoadingClass),n.then(completedPromise.bind(this,e,t),errorPromise.bind(this,e,t))}};e.fn.contextMenu=function(t){var n=this,i=t;if(this.length>0)if(void 0===t)this.first().trigger("contextmenu");else if(void 0!==t.x&&void 0!==t.y)this.first().trigger(e.Event("contextmenu",{pageX:t.x,pageY:t.y,mouseButton:t.button}));else if("hide"===t){var r=this.first().data("contextMenu")?this.first().data("contextMenu").$menu:null;r&&r.trigger("contextmenu:hide")}else"destroy"===t?e.contextMenu("destroy",{context:this}):e.isPlainObject(t)?(t.context=this,e.contextMenu("create",t)):t?this.removeClass("context-menu-disabled"):t||this.addClass("context-menu-disabled");else e.each(a,function(){this.selector===n.selector&&(i.data=this,e.extend(i.data,{trigger:"demand"}))}),d.contextmenu.call(i.target,i);return this},e.contextMenu=function(t,i){"string"!=typeof t&&(i=t,t="create"),"string"==typeof i?i={selector:i}:void 0===i&&(i={});var s=e.extend(!0,{},l,i||{}),c=e(document),u=c,p=!1;switch(s.context&&s.context.length?(u=e(s.context).first(),s.context=u.get(0),p=!e(s.context).is(document)):s.context=document,t){case"create":if(!s.selector)throw new Error("No selector specified");if(s.selector.match(/.context-menu-(list|item|input)($|\s)/))throw new Error('Cannot bind to selector "'+s.selector+'" as it contains a reserved className');if(!s.build&&(!s.items||e.isEmptyObject(s.items)))throw new Error("No Items specified");if(r++,s.ns=".contextMenu"+r,p||(o[s.selector]=s.ns),a[s.ns]=s,s.trigger||(s.trigger="right"),!n){var f="click"===s.itemClickEvent?"click.contextMenu":"mouseup.contextMenu",g={"contextmenu:focus.contextMenu":d.focusItem,"contextmenu:blur.contextMenu":d.blurItem,"contextmenu.contextMenu":d.abortevent,"mouseenter.contextMenu":d.itemMouseenter,"mouseleave.contextMenu":d.itemMouseleave};g[f]=d.itemClick,c.on({"contextmenu:hide.contextMenu":d.hideMenu,"prevcommand.contextMenu":d.prevItem,"nextcommand.contextMenu":d.nextItem,"contextmenu.contextMenu":d.abortevent,"mouseenter.contextMenu":d.menuMouseenter,"mouseleave.contextMenu":d.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",d.inputClick).on(g,".context-menu-item"),n=!0}switch(u.on("contextmenu"+s.ns,s.selector,s,d.contextmenu),p&&u.on("remove"+s.ns,function(){e(this).contextMenu("destroy")}),s.trigger){case"hover":u.on("mouseenter"+s.ns,s.selector,s,d.mouseenter).on("mouseleave"+s.ns,s.selector,s,d.mouseleave);break;case"left":u.on("click"+s.ns,s.selector,s,d.click);break;case"touchstart":u.on("touchstart"+s.ns,s.selector,s,d.click)}s.build||h.create(s);break;case"destroy":var m;if(p){var v=s.context;e.each(a,function(t,n){if(!n)return!0;if(!e(v).is(n.selector))return!0;m=e(".context-menu-list").filter(":visible"),m.length&&m.data().contextMenuRoot.$trigger.is(e(n.context).find(n.selector))&&m.trigger("contextmenu:hide",{force:!0});try{a[n.ns].$menu&&a[n.ns].$menu.remove(),delete a[n.ns]}catch(e){a[n.ns]=null}return e(n.context).off(n.ns),!0})}else if(s.selector){if(o[s.selector]){m=e(".context-menu-list").filter(":visible"),m.length&&m.data().contextMenuRoot.$trigger.is(s.selector)&&m.trigger("contextmenu:hide",{force:!0});try{a[o[s.selector]].$menu&&a[o[s.selector]].$menu.remove(),delete a[o[s.selector]]}catch(e){a[o[s.selector]]=null}c.off(o[s.selector])}}else c.off(".contextMenu .contextMenuAutoHide"),e.each(a,function(t,n){e(n.context).off(n.ns)}),o={},a={},r=0,n=!1,e("#context-menu-layer, .context-menu-list").remove();break;case"html5":(!e.support.htmlCommand&&!e.support.htmlMenuitem||"boolean"==typeof i&&i)&&e('menu[type="context"]').each(function(){this.id&&e.contextMenu({selector:"[contextmenu="+this.id+"]",items:e.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw new Error('Unknown operation "'+t+'"')}return this},e.contextMenu.setInputValues=function(t,n){void 0===n&&(n={}),e.each(t.inputs,function(e,t){switch(t.type){case"text":case"textarea":t.value=n[e]||"";break;case"checkbox":t.selected=!!n[e];break;case"radio":t.selected=(n[t.radio]||"")===t.value;break;case"select":t.selected=n[e]||""}})},e.contextMenu.getInputValues=function(t,n){return void 0===n&&(n={}),e.each(t.inputs,function(e,t){switch(t.type){case"text":case"textarea":case"select":n[e]=t.$input.val();break;case"checkbox":n[e]=t.$input.prop("checked");break;case"radio":t.$input.prop("checked")&&(n[t.radio]=t.value)}}),n},e.contextMenu.fromMenu=function(t){var n=e(t),i={};return menuChildren(i,n.children()),i},e.contextMenu.defaults=l,e.contextMenu.types=s,e.contextMenu.handle=d,e.contextMenu.op=h,e.contextMenu.menus=a})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(2)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.fn.extend({disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.on(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.off(".ui-disableSelection")}})})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(123),n(2)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.ui.formResetMixin={_formResetHandler:function(){var t=e(this);setTimeout(function(){var n=t.data("ui-form-reset-instances");e.each(n,function(){this.refresh()})})},_bindFormResetHandler:function(){if(this.form=this.element.form(),this.form.length){var e=this.form.data("ui-form-reset-instances")||[];e.length||this.form.on("reset.ui-form-reset",this._formResetHandler),e.push(this),this.form.data("ui-form-reset-instances",e)}},_unbindFormResetHandler:function(){if(this.form.length){var t=this.form.data("ui-form-reset-instances");t.splice(e.inArray(this,t),1),t.length?this.form.data("ui-form-reset-instances",t):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset")}}}})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(2)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.fn.form=function(){return"string"==typeof this[0].form?this.closest("form"):e(this[0].form)}})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(2),n(34)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.fn.labels=function(){var t,n,i,r,o;return this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(r=this.eq(0).parents("label"),i=this.attr("id"),i&&(t=this.eq(0).parents().last(),o=t.add(t.length?t.siblings():this.siblings()),n="label[for='"+e.ui.escapeSelector(i)+"']",r=r.add(o.find(n).addBack(n))),this.pushStack(r))}})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(2),n(58)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.extend(e.expr[":"],{tabbable:function(t){var n=e.attr(t,"tabindex"),i=null!=n;return(!i||n>=0)&&e.ui.focusable(t,i)}})})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(2),n(10),n(20),n(5)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.widget("ui.accordion",{version:"1.12.1",options:{active:0,animate:{},classes:{"ui-accordion-header":"ui-corner-top","ui-accordion-header-collapsed":"ui-corner-all","ui-accordion-content":"ui-corner-bottom"},collapsible:!1,event:"click",header:"> li > :first-child, > :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this._addClass("ui-accordion","ui-widget ui-helper-reset"),this.element.attr("role","tablist"),t.collapsible||!1!==t.active&&null!=t.active||(t.active=0),this._processPanels(),t.active<0&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e()}},_createIcons:function(){var t,n,i=this.options.icons;i&&(t=e("<span>"),this._addClass(t,"ui-accordion-header-icon","ui-icon "+i.header),t.prependTo(this.headers),n=this.active.children(".ui-accordion-header-icon"),this._removeClass(n,i.header)._addClass(n,null,i.activeHeader)._addClass(this.headers,"ui-accordion-icons"))},_destroyIcons:function(){this._removeClass(this.headers,"ui-accordion-icons"),this.headers.children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeAttr("role"),this.headers.removeAttr("role aria-expanded aria-selected aria-controls tabIndex").removeUniqueId(),this._destroyIcons(),e=this.headers.next().css("display","").removeAttr("role aria-hidden aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){if("active"===e)return void this._activate(t);"event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||!1!==this.options.active||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons())},_setOptionDisabled:function(e){this._super(e),this.element.attr("aria-disabled",e),this._toggleClass(null,"ui-state-disabled",!!e),this._toggleClass(this.headers.add(this.headers.next()),null,"ui-state-disabled",!!e)},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var n=e.ui.keyCode,i=this.headers.length,r=this.headers.index(t.target),o=!1;switch(t.keyCode){case n.RIGHT:case n.DOWN:o=this.headers[(r+1)%i];break;case n.LEFT:case n.UP:o=this.headers[(r-1+i)%i];break;case n.SPACE:case n.ENTER:this._eventHandler(t);break;case n.HOME:o=this.headers[0];break;case n.END:o=this.headers[i-1]}o&&(e(t.target).attr("tabIndex",-1),e(o).attr("tabIndex",0),e(o).trigger("focus"),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().trigger("focus")},refresh:function(){var t=this.options;this._processPanels(),!1===t.active&&!0===t.collapsible||!this.headers.length?(t.active=!1,this.active=e()):!1===t.active?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var e=this.headers,t=this.panels;this.headers=this.element.find(this.options.header),this._addClass(this.headers,"ui-accordion-header ui-accordion-header-collapsed","ui-state-default"),this.panels=this.headers.next().filter(":not(.ui-accordion-content-active)").hide(),this._addClass(this.panels,"ui-accordion-content","ui-helper-reset ui-widget-content"),t&&(this._off(e.not(this.headers)),this._off(t.not(this.panels)))},_refresh:function(){var t,n=this.options,i=n.heightStyle,r=this.element.parent();this.active=this._findActive(n.active),this._addClass(this.active,"ui-accordion-header-active","ui-state-active")._removeClass(this.active,"ui-accordion-header-collapsed"),this._addClass(this.active.next(),"ui-accordion-content-active"),this.active.next().show(),this.headers.attr("role","tab").each(function(){var t=e(this),n=t.uniqueId().attr("id"),i=t.next(),r=i.uniqueId().attr("id");t.attr("aria-controls",r),i.attr("aria-labelledby",n)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(n.event),"fill"===i?(t=r.height(),this.element.siblings(":visible").each(function(){var n=e(this),i=n.css("position");"absolute"!==i&&"fixed"!==i&&(t-=n.outerHeight(!0))}),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===i&&(t=0,this.headers.next().each(function(){var n=e(this).is(":visible");n||e(this).show(),t=Math.max(t,e(this).css("height","").height()),n||e(this).hide()}).height(t))},_activate:function(t){var n=this._findActive(t)[0];n!==this.active[0]&&(n=n||this.active[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var n={keydown:"_keydown"};t&&e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,n),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var n,i,r=this.options,o=this.active,a=e(t.currentTarget),s=a[0]===o[0],l=s&&r.collapsible,c=l?e():a.next(),u=o.next(),d={oldHeader:o,oldPanel:u,newHeader:l?e():a,newPanel:c};t.preventDefault(),s&&!r.collapsible||!1===this._trigger("beforeActivate",t,d)||(r.active=!l&&this.headers.index(a),this.active=s?e():a,this._toggle(d),this._removeClass(o,"ui-accordion-header-active","ui-state-active"),r.icons&&(n=o.children(".ui-accordion-header-icon"),this._removeClass(n,null,r.icons.activeHeader)._addClass(n,null,r.icons.header)),s||(this._removeClass(a,"ui-accordion-header-collapsed")._addClass(a,"ui-accordion-header-active","ui-state-active"),r.icons&&(i=a.children(".ui-accordion-header-icon"),this._removeClass(i,null,r.icons.header)._addClass(i,null,r.icons.activeHeader)),this._addClass(a.next(),"ui-accordion-content-active")))},_toggle:function(t){var n=t.newPanel,i=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=n,this.prevHide=i,this.options.animate?this._animate(n,i,t):(i.hide(),n.show(),this._toggleComplete(t)),i.attr({"aria-hidden":"true"}),i.prev().attr({"aria-selected":"false","aria-expanded":"false"}),n.length&&i.length?i.prev().attr({tabIndex:-1,"aria-expanded":"false"}):n.length&&this.headers.filter(function(){return 0===parseInt(e(this).attr("tabIndex"),10)}).attr("tabIndex",-1),n.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(e,t,n){var i,r,o,a=this,s=0,l=e.css("box-sizing"),c=e.length&&(!t.length||e.index()<t.index()),u=this.options.animate||{},d=c&&u.down||u,h=function(){a._toggleComplete(n)};return"number"==typeof d&&(o=d),"string"==typeof d&&(r=d),r=r||d.easing||u.easing,o=o||d.duration||u.duration,t.length?e.length?(i=e.show().outerHeight(),t.animate(this.hideProps,{duration:o,easing:r,step:function(e,t){t.now=Math.round(e)}}),void e.hide().animate(this.showProps,{duration:o,easing:r,complete:h,step:function(e,n){n.now=Math.round(e),"height"!==n.prop?"content-box"===l&&(s+=n.now):"content"!==a.options.heightStyle&&(n.now=Math.round(i-t.outerHeight()-s),s=0)}})):t.animate(this.hideProps,o,r,h):e.animate(this.showProps,o,r,h)},_toggleComplete:function(e){var t=e.oldPanel,n=t.prev();this._removeClass(t,"ui-accordion-content-active"),this._removeClass(n,"ui-accordion-header-active")._addClass(n,"ui-accordion-header-collapsed"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}})})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(129),n(128),n(10),n(5)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.widget("ui.button",{version:"1.12.1",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:!0},_getCreateOptions:function(){var e,t=this._super()||{};return this.isInput=this.element.is("input"),e=this.element[0].disabled,null!=e&&(t.disabled=e),this.originalLabel=this.isInput?this.element.val():this.element.html(),this.originalLabel&&(t.label=this.originalLabel),t},_create:function(){!this.option.showLabel&!this.options.icon&&(this.options.showLabel=!0),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled||!1),this.hasTitle=!!this.element.attr("title"),this.options.label&&this.options.label!==this.originalLabel&&(this.isInput?this.element.val(this.options.label):this.element.html(this.options.label)),this._addClass("ui-button","ui-widget"),this._setOption("disabled",this.options.disabled),this._enhance(),this.element.is("a")&&this._on({keyup:function(t){t.keyCode===e.ui.keyCode.SPACE&&(t.preventDefault(),this.element[0].click?this.element[0].click():this.element.trigger("click"))}})},_enhance:function(){this.element.is("button")||this.element.attr("role","button"),this.options.icon&&(this._updateIcon("icon",this.options.icon),this._updateTooltip())},_updateTooltip:function(){this.title=this.element.attr("title"),this.options.showLabel||this.title||this.element.attr("title",this.options.label)},_updateIcon:function(t,n){var i="iconPosition"!==t,r=i?this.options.iconPosition:n,o="top"===r||"bottom"===r;this.icon?i&&this._removeClass(this.icon,null,this.options.icon):(this.icon=e("<span>"),this._addClass(this.icon,"ui-button-icon","ui-icon"),this.options.showLabel||this._addClass("ui-button-icon-only")),i&&this._addClass(this.icon,null,n),this._attachIcon(r),o?(this._addClass(this.icon,null,"ui-widget-icon-block"),this.iconSpace&&this.iconSpace.remove()):(this.iconSpace||(this.iconSpace=e("<span> </span>"),this._addClass(this.iconSpace,"ui-button-icon-space")),this._removeClass(this.icon,null,"ui-wiget-icon-block"),this._attachIconSpace(r))},_destroy:function(){this.element.removeAttr("role"),this.icon&&this.icon.remove(),this.iconSpace&&this.iconSpace.remove(),this.hasTitle||this.element.removeAttr("title")},_attachIconSpace:function(e){this.icon[/^(?:end|bottom)/.test(e)?"before":"after"](this.iconSpace)},_attachIcon:function(e){this.element[/^(?:end|bottom)/.test(e)?"append":"prepend"](this.icon)},_setOptions:function(e){var t=void 0===e.showLabel?this.options.showLabel:e.showLabel,n=void 0===e.icon?this.options.icon:e.icon;t||n||(e.showLabel=!0),this._super(e)},_setOption:function(e,t){"icon"===e&&(t?this._updateIcon(e,t):this.icon&&(this.icon.remove(),this.iconSpace&&this.iconSpace.remove())),"iconPosition"===e&&this._updateIcon(e,t),"showLabel"===e&&(this._toggleClass("ui-button-icon-only",null,!t),this._updateTooltip()),"label"===e&&(this.isInput?this.element.val(t):(this.element.html(t),this.icon&&(this._attachIcon(this.options.iconPosition),this._attachIconSpace(this.options.iconPosition)))),this._super(e,t),"disabled"===e&&(this._toggleClass(null,"ui-state-disabled",t),this.element[0].disabled=t,t&&this.element.blur())},refresh:function(){var e=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");e!==this.options.disabled&&this._setOptions({disabled:e}),this._updateTooltip()}}),!1!==e.uiBackCompat&&(e.widget("ui.button",e.ui.button,{options:{text:!0,icons:{primary:null,secondary:null}},_create:function(){this.options.showLabel&&!this.options.text&&(this.options.showLabel=this.options.text),!this.options.showLabel&&this.options.text&&(this.options.text=this.options.showLabel),this.options.icon||!this.options.icons.primary&&!this.options.icons.secondary?this.options.icon&&(this.options.icons.primary=this.options.icon):this.options.icons.primary?this.options.icon=this.options.icons.primary:(this.options.icon=this.options.icons.secondary,this.options.iconPosition="end"),this._super()},_setOption:function(e,t){if("text"===e)return void this._super("showLabel",t);"showLabel"===e&&(this.options.text=t),"icon"===e&&(this.options.icons.primary=t),"icons"===e&&(t.primary?(this._super("icon",t.primary),this._super("iconPosition","beginning")):t.secondary&&(this._super("icon",t.secondary),this._super("iconPosition","end"))),this._superApply(arguments)}}),e.fn.button=function(t){return function(){return!this.length||this.length&&"INPUT"!==this[0].tagName||this.length&&"INPUT"===this[0].tagName&&"checkbox"!==this.attr("type")&&"radio"!==this.attr("type")?t.apply(this,arguments):(e.ui.checkboxradio||e.error("Checkboxradio widget missing"),0===arguments.length?this.checkboxradio({icon:!1}):this.checkboxradio.apply(this,arguments))}}(e.fn.button),e.fn.buttonset=function(){return e.ui.controlgroup||e.error("Controlgroup widget missing"),"option"===arguments[0]&&"items"===arguments[1]&&arguments[2]?this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]]):"option"===arguments[0]&&"items"===arguments[1]?this.controlgroup.apply(this,[arguments[0],"items.button"]):("object"==typeof arguments[0]&&arguments[0].items&&(arguments[0].items={button:arguments[0].items}),this.controlgroup.apply(this,arguments))}),e.ui.button})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(34),n(122),n(124),n(5)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.widget("ui.checkboxradio",[e.ui.formResetMixin,{version:"1.12.1",options:{disabled:null,label:null,icon:!0,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var t,n,i=this,r=this._super()||{};return this._readType(),n=this.element.labels(),this.label=e(n[n.length-1]),this.label.length||e.error("No label found for checkboxradio widget"),this.originalLabel="",this.label.contents().not(this.element[0]).each(function(){i.originalLabel+=3===this.nodeType?e(this).text():this.outerHTML}),this.originalLabel&&(r.label=this.originalLabel),t=this.element[0].disabled,null!=t&&(r.disabled=t),r},_create:function(){var e=this.element[0].checked;this._bindFormResetHandler(),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled),this._setOption("disabled",this.options.disabled),this._addClass("ui-checkboxradio","ui-helper-hidden-accessible"),this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget"),"radio"===this.type&&this._addClass(this.label,"ui-checkboxradio-radio-label"),this.options.label&&this.options.label!==this.originalLabel?this._updateLabel():this.originalLabel&&(this.options.label=this.originalLabel),this._enhance(),e&&(this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active"),this.icon&&this._addClass(this.icon,null,"ui-state-hover")),this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var t=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type,"input"===t&&/radio|checkbox/.test(this.type)||e.error("Can't create checkboxradio on element.nodeName="+t+" and element.type="+this.type)},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var t,n=this.element[0].name,i="input[name='"+e.ui.escapeSelector(n)+"']";return n?(t=this.form.length?e(this.form[0].elements).filter(i):e(i).filter(function(){return 0===e(this).form().length}),t.not(this.element)):e([])},_toggleClasses:function(){var t=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",t),this.options.icon&&"checkbox"===this.type&&this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",t)._toggleClass(this.icon,null,"ui-icon-blank",!t),"radio"===this.type&&this._getRadioGroup().each(function(){var t=e(this).checkboxradio("instance");t&&t._removeClass(t.label,"ui-checkboxradio-checked","ui-state-active")})},_destroy:function(){this._unbindFormResetHandler(),this.icon&&(this.icon.remove(),this.iconSpace.remove())},_setOption:function(e,t){if("label"!==e||t){if(this._super(e,t),"disabled"===e)return this._toggleClass(this.label,null,"ui-state-disabled",t),void(this.element[0].disabled=t);this.refresh()}},_updateIcon:function(t){var n="ui-icon ui-icon-background ";this.options.icon?(this.icon||(this.icon=e("<span>"),this.iconSpace=e("<span> </span>"),this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")),"checkbox"===this.type?(n+=t?"ui-icon-check ui-state-checked":"ui-icon-blank",this._removeClass(this.icon,null,t?"ui-icon-blank":"ui-icon-check")):n+="ui-icon-blank",this._addClass(this.icon,"ui-checkboxradio-icon",n),t||this._removeClass(this.icon,null,"ui-icon-check ui-state-checked"),this.icon.prependTo(this.label).after(this.iconSpace)):void 0!==this.icon&&(this.icon.remove(),this.iconSpace.remove(),delete this.icon)},_updateLabel:function(){var e=this.label.contents().not(this.element[0]);this.icon&&(e=e.not(this.icon[0])),this.iconSpace&&(e=e.not(this.iconSpace[0])),e.remove(),this.label.append(this.options.label)},refresh:function(){var e=this.element[0].checked,t=this.element[0].disabled;this._updateIcon(e),this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",e),null!==this.options.label&&this._updateLabel(),t!==this.options.disabled&&this._setOptions({disabled:t})}}]),e.ui.checkboxradio})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(5)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){var t=/ui-corner-([a-z]){2,6}/g;return e.widget("ui.controlgroup",{version:"1.12.1",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:!0,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar"),this.refresh()},_destroy:function(){this._callChildMethod("destroy"),this.childWidgets.removeData("ui-controlgroup-data"),this.element.removeAttr("role"),this.options.items.controlgroupLabel&&this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()},_initWidgets:function(){var t=this,n=[];e.each(this.options.items,function(i,r){var o,a={};if(r)return"controlgroupLabel"===i?(o=t.element.find(r),o.each(function(){var t=e(this);t.children(".ui-controlgroup-label-contents").length||t.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")}),t._addClass(o,null,"ui-widget ui-widget-content ui-state-default"),void(n=n.concat(o.get()))):void(e.fn[i]&&(a=t["_"+i+"Options"]?t["_"+i+"Options"]("middle"):{classes:{}},t.element.find(r).each(function(){var r=e(this),o=r[i]("instance"),s=e.widget.extend({},a);if("button"!==i||!r.parent(".ui-spinner").length){o||(o=r[i]()[i]("instance")),o&&(s.classes=t._resolveClassesValues(s.classes,o)),r[i](s);var l=r[i]("widget");e.data(l[0],"ui-controlgroup-data",o||r[i]("instance")),n.push(l[0])}})))}),this.childWidgets=e(e.unique(n)),this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(t){this.childWidgets.each(function(){var n=e(this),i=n.data("ui-controlgroup-data");i&&i[t]&&i[t]()})},_updateCornerClass:function(e,t){var n=this._buildSimpleOptions(t,"label").classes.label;this._removeClass(e,null,"ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all"),this._addClass(e,null,n)},_buildSimpleOptions:function(e,t){var n="vertical"===this.options.direction,i={classes:{}};return i.classes[t]={middle:"",first:"ui-corner-"+(n?"top":"left"),last:"ui-corner-"+(n?"bottom":"right"),only:"ui-corner-all"}[e],i},_spinnerOptions:function(e){var t=this._buildSimpleOptions(e,"ui-spinner");return t.classes["ui-spinner-up"]="",t.classes["ui-spinner-down"]="",t},_buttonOptions:function(e){return this._buildSimpleOptions(e,"ui-button")},_checkboxradioOptions:function(e){return this._buildSimpleOptions(e,"ui-checkboxradio-label")},_selectmenuOptions:function(e){var t="vertical"===this.options.direction;return{width:!!t&&"auto",classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(t?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(t?"top":"left")},last:{"ui-selectmenu-button-open":t?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(t?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[e]}},_resolveClassesValues:function(n,i){var r={};return e.each(n,function(o){var a=i.options.classes[o]||"";a=e.trim(a.replace(t,"")),r[o]=(a+" "+n[o]).replace(/\s+/g," ")}),r},_setOption:function(e,t){if("direction"===e&&this._removeClass("ui-controlgroup-"+this.options.direction),this._super(e,t),"disabled"===e)return void this._callChildMethod(t?"disable":"enable");this.refresh()},refresh:function(){var t,n=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction),"horizontal"===this.options.direction&&this._addClass(null,"ui-helper-clearfix"),this._initWidgets(),t=this.childWidgets,this.options.onlyVisible&&(t=t.filter(":visible")),t.length&&(e.each(["first","last"],function(e,i){var r=t[i]().data("ui-controlgroup-data");if(r&&n["_"+r.widgetName+"Options"]){var o=n["_"+r.widgetName+"Options"](1===t.length?"only":i);o.classes=n._resolveClassesValues(o.classes,r),r.element[r.widgetName](o)}else n._updateCornerClass(t[i](),i)}),this._callChildMethod("refresh"))}})})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(10),n(36),n(15),n(20),n(2),n(5)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.widget("ui.menu",{version:"1.12.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(e){e.preventDefault()},"click .ui-menu-item":function(t){var n=e(t.target),i=e(e.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&n.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),n.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&i.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){if(!this.previousFilter){var n=e(t.target).closest(".ui-menu-item"),i=e(t.currentTarget);n[0]===i[0]&&(this._removeClass(i.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(t,i))}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var n=this.active||this.element.find(this.options.items).eq(0);t||this.focus(e,n)},blur:function(t){this._delay(function(){!e.contains(this.element[0],e.ui.safeActiveElement(this.document[0]))&&this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){var t=this.element.find(".ui-menu-item").removeAttr("role aria-disabled"),n=t.children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),n.children().each(function(){var t=e(this);t.data("ui-menu-submenu-caret")&&t.remove()})},_keydown:function(t){var n,i,r,o,a=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:a=!1,i=this.previousFilter||"",o=!1,r=t.keyCode>=96&&t.keyCode<=105?(t.keyCode-96).toString():String.fromCharCode(t.keyCode),clearTimeout(this.filterTimer),r===i?o=!0:r=i+r,n=this._filterMenuItems(r),n=o&&-1!==n.index(this.active.next())?this.active.nextAll(".ui-menu-item"):n,n.length||(r=String.fromCharCode(t.keyCode),n=this._filterMenuItems(r)),n.length?(this.focus(t,n),this.previousFilter=r,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}a&&t.preventDefault()},_activate:function(e){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var t,n,i,r,o,a=this,s=this.options.icons.submenu,l=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),i=l.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),n=t.prev(),i=e("<span>").data("ui-menu-submenu-caret",!0);a._addClass(i,"ui-menu-icon","ui-icon "+s),n.attr("aria-haspopup","true").prepend(i),t.attr("aria-labelledby",n.attr("id"))}),this._addClass(i,"ui-menu","ui-widget ui-widget-content ui-front"),t=l.add(this.element),n=t.find(this.options.items),n.not(".ui-menu-item").each(function(){var t=e(this);a._isDivider(t)&&a._addClass(t,"ui-menu-divider","ui-widget-content")}),r=n.not(".ui-menu-item, .ui-menu-divider"),o=r.children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(r,"ui-menu-item")._addClass(o,"ui-menu-item-wrapper"),n.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){if("icons"===e){var n=this.element.find(".ui-menu-icon");this._removeClass(n,null,this.options.icons.submenu)._addClass(n,null,t.submenu)}this._super(e,t)},_setOptionDisabled:function(e){this._super(e),this.element.attr("aria-disabled",String(e)),this._toggleClass(null,"ui-state-disabled",!!e)},focus:function(e,t){var n,i,r;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),i=this.active.children(".ui-menu-item-wrapper"),this._addClass(i,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",i.attr("id")),r=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(r,null,"ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),n=t.children(".ui-menu"),n.length&&e&&/^mouse/.test(e.type)&&this._startOpening(n),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var n,i,r,o,a,s;this._hasScroll()&&(n=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,i=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,r=t.offset().top-this.activeMenu.offset().top-n-i,o=this.activeMenu.scrollTop(),a=this.activeMenu.height(),s=t.outerHeight(),r<0?this.activeMenu.scrollTop(o+r):r+s>a&&this.activeMenu.scrollTop(o+r-a+s))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",e,{item:this.active}),this.active=null)},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var n=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(n)},collapseAll:function(t,n){clearTimeout(this.timer),this.timer=this._delay(function(){var i=n?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));i.length||(i=this.element),this._close(i),this.blur(t),this._removeClass(i.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=i},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(t){return!e(t.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,n){var i;this.active&&(i="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),i&&i.length&&this.active||(i=this.activeMenu.find(this.options.items)[t]()),this.focus(n,i)},nextPage:function(t){var n,i,r;if(!this.active)return void this.next(t);this.isLastItem()||(this._hasScroll()?(i=this.active.offset().top,r=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return n=e(this),n.offset().top-i-r<0}),this.focus(t,n)):this.focus(t,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))},previousPage:function(t){var n,i,r;if(!this.active)return void this.next(t);this.isFirstItem()||(this._hasScroll()?(i=this.active.offset().top,r=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return n=e(this),n.offset().top-i+r>0}),this.focus(t,n)):this.focus(t,this.activeMenu.find(this.options.items).first()))},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var n={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,n)},_filterMenuItems:function(t){var n=t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),i=new RegExp("^"+n,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return i.test(e.trim(e(this).children(".ui-menu-item-wrapper").text()))})}})})},function(e,t,n){var i,r,o;!function(a){r=[n(0),n(16),n(121),n(60),n(2),n(5)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){return e.widget("ui.resizable",e.ui.mouse,{version:"1.12.1",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseFloat(e)||0},_isNumber:function(e){return!isNaN(parseFloat(e))},_hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var i=n&&"left"===n?"scrollLeft":"scrollTop",r=!1;return t[i]>0||(t[i]=1,r=t[i]>0,t[i]=0,r)},_create:function(){var t,n=this.options,i=this;this._addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!n.aspectRatio,aspectRatio:n.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:n.helper||n.ghost||n.animate?n.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,t={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(t),this.originalElement.css("margin",0),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css(t),this._proportionallyResize()),this._setupHandles(),n.autoHide&&e(this.element).on("mouseenter",function(){n.disabled||(i._removeClass("ui-resizable-autohide"),i._handles.show())}).on("mouseleave",function(){n.disabled||i.resizing||(i._addClass("ui-resizable-autohide"),i._handles.hide())}),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,n=function(t){e(t).removeData("resizable").removeData("ui-resizable").off(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(n(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),n(this.originalElement),this},_setOption:function(e,t){switch(this._super(e,t),e){case"handles":this._removeHandles(),this._setupHandles()}},_setupHandles:function(){var t,n,i,r,o,a=this.options,s=this;if(this.handles=a.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=e(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),i=this.handles.split(","),this.handles={},n=0;n<i.length;n++)t=e.trim(i[n]),r="ui-resizable-"+t,o=e("<div>"),this._addClass(o,"ui-resizable-handle "+r),o.css({zIndex:a.zIndex}),this.handles[t]=".ui-resizable-"+t,this.element.append(o);this._renderAxis=function(t){var n,i,r,o;t=t||this.element;for(n in this.handles)this.handles[n].constructor===String?this.handles[n]=this.element.children(this.handles[n]).first().show():(this.handles[n].jquery||this.handles[n].nodeType)&&(this.handles[n]=e(this.handles[n]),this._on(this.handles[n],{mousedown:s._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(i=e(this.handles[n],this.element),o=/sw|ne|nw|se|n|s/.test(n)?i.outerHeight():i.outerWidth(),r=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join(""),t.css(r,o),this._proportionallyResize()),this._handles=this._handles.add(this.handles[n])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",function(){s.resizing||(this.className&&(o=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),s.axis=o&&o[1]?o[1]:"se")}),a.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._handles.remove()},_mouseCapture:function(t){var n,i,r=!1;for(n in this.handles)((i=e(this.handles[n])[0])===t.target||e.contains(i,t.target))&&(r=!0);return!this.options.disabled&&r},_mouseStart:function(t){var n,i,r,o=this.options,a=this.element;return this.resizing=!0,this._renderProxy(),n=this._num(this.helper.css("left")),i=this._num(this.helper.css("top")),o.containment&&(n+=e(o.containment).scrollLeft()||0,i+=e(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:n,top:i},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:a.width(),height:a.height()},this.originalSize=this._helper?{width:a.outerWidth(),height:a.outerHeight()}:{width:a.width(),height:a.height()},this.sizeDiff={width:a.outerWidth()-a.width(),height:a.outerHeight()-a.height()},this.originalPosition={left:n,top:i},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,r=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===r?this.axis+"-resize":r),this._addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var n,i,r=this.originalMousePosition,o=this.axis,a=t.pageX-r.left||0,s=t.pageY-r.top||0,l=this._change[o];return this._updatePrevProperties(),!!l&&(n=l.apply(this,[t,a,s]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(n=this._updateRatio(n,t)),n=this._respectSize(n,t),this._updateCache(n),this._propagate("resize",t),i=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(i)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges()),!1)},_mouseStop:function(t){this.resizing=!1;var n,i,r,o,a,s,l,c=this.options,u=this;return this._helper&&(n=this._proportionallyResizeElements,i=n.length&&/textarea/i.test(n[0].nodeName),r=i&&this._hasScroll(n[0],"left")?0:u.sizeDiff.height,o=i?0:u.sizeDiff.width,a={width:u.helper.width()-o,height:u.helper.height()-r},s=parseFloat(u.element.css("left"))+(u.position.left-u.originalPosition.left)||null,l=parseFloat(u.element.css("top"))+(u.position.top-u.originalPosition.top)||null,c.animate||this.element.css(e.extend(a,{top:l,left:s})),u.helper.height(u.size.height),u.helper.width(u.size.width),this._helper&&!c.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var e={};return this.position.top!==this.prevPosition.top&&(e.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(e.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(e.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(e.height=this.size.height+"px"),this.helper.css(e),e},_updateVirtualBoundaries:function(e){var t,n,i,r,o,a=this.options;o={minWidth:this._isNumber(a.minWidth)?a.minWidth:0,maxWidth:this._isNumber(a.maxWidth)?a.maxWidth:1/0,minHeight:this._isNumber(a.minHeight)?a.minHeight:0,maxHeight:this._isNumber(a.maxHeight)?a.maxHeight:1/0},(this._aspectRatio||e)&&(t=o.minHeight*this.aspectRatio,i=o.minWidth/this.aspectRatio,n=o.maxHeight*this.aspectRatio,r=o.maxWidth/this.aspectRatio,t>o.minWidth&&(o.minWidth=t),i>o.minHeight&&(o.minHeight=i),n<o.maxWidth&&(o.maxWidth=n),r<o.maxHeight&&(o.maxHeight=r)),this._vBoundaries=o},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,n=this.size,i=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===i&&(e.left=t.left+(n.width-e.width),e.top=null),"nw"===i&&(e.top=t.top+(n.height-e.height),e.left=t.left+(n.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,n=this.axis,i=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,r=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,o=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,a=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,s=this.originalPosition.left+this.originalSize.width,l=this.originalPosition.top+this.originalSize.height,c=/sw|nw|w/.test(n),u=/nw|ne|n/.test(n);return o&&(e.width=t.minWidth),a&&(e.height=t.minHeight),i&&(e.width=t.maxWidth),r&&(e.height=t.maxHeight),o&&c&&(e.left=s-t.minWidth),i&&c&&(e.left=s-t.maxWidth),a&&u&&(e.top=l-t.minHeight),r&&u&&(e.top=l-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_getPaddingPlusBorderDimensions:function(e){for(var t=0,n=[],i=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],r=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];t<4;t++)n[t]=parseFloat(i[t])||0,n[t]+=parseFloat(r[t])||0;return{height:n[0]+n[2],width:n[1]+n[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var e,t=0,n=this.helper||this.element;t<this._proportionallyResizeElements.length;t++)e=this._proportionallyResizeElements[t],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(e)),e.css({height:n.height()-this.outerDimensions.height||0,width:n.width()-this.outerDimensions.width||0})},_renderProxy:function(){var t=this.element,n=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++n.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var n=this.originalSize;return{left:this.originalPosition.left+t,width:n.width-t}},n:function(e,t,n){var i=this.originalSize;return{top:this.originalPosition.top+n,height:i.height-n}},s:function(e,t,n){return{height:this.originalSize.height+n}},se:function(t,n,i){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,n,i]))},sw:function(t,n,i){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,n,i]))},ne:function(t,n,i){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,n,i]))},nw:function(t,n,i){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,n,i]))}},_propagate:function(t,n){e.ui.plugin.call(this,t,[n,this.ui()]),"resize"!==t&&this._trigger(t,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var n=e(this).resizable("instance"),i=n.options,r=n._proportionallyResizeElements,o=r.length&&/textarea/i.test(r[0].nodeName),a=o&&n._hasScroll(r[0],"left")?0:n.sizeDiff.height,s=o?0:n.sizeDiff.width,l={width:n.size.width-s,height:n.size.height-a},c=parseFloat(n.element.css("left"))+(n.position.left-n.originalPosition.left)||null,u=parseFloat(n.element.css("top"))+(n.position.top-n.originalPosition.top)||null;n.element.animate(e.extend(l,u&&c?{top:u,left:c}:{}),{duration:i.animateDuration,easing:i.animateEasing,step:function(){var i={width:parseFloat(n.element.css("width")),height:parseFloat(n.element.css("height")),top:parseFloat(n.element.css("top")),left:parseFloat(n.element.css("left"))};r&&r.length&&e(r[0]).css({width:i.width,height:i.height}),n._updateCache(i),n._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,n,i,r,o,a,s,l=e(this).resizable("instance"),c=l.options,u=l.element,d=c.containment,h=d instanceof e?d.get(0):/parent/.test(d)?u.parent().get(0):d;h&&(l.containerElement=e(h),/document/.test(d)||d===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(h),n=[],e(["Top","Right","Left","Bottom"]).each(function(e,i){n[e]=l._num(t.css("padding"+i))}),l.containerOffset=t.offset(),l.containerPosition=t.position(),l.containerSize={height:t.innerHeight()-n[3],width:t.innerWidth()-n[1]},i=l.containerOffset,r=l.containerSize.height,o=l.containerSize.width,a=l._hasScroll(h,"left")?h.scrollWidth:o,s=l._hasScroll(h)?h.scrollHeight:r,l.parentData={element:h,left:i.left,top:i.top,width:a,height:s}))},resize:function(t){var n,i,r,o,a=e(this).resizable("instance"),s=a.options,l=a.containerOffset,c=a.position,u=a._aspectRatio||t.shiftKey,d={top:0,left:0},h=a.containerElement,p=!0;h[0]!==document&&/static/.test(h.css("position"))&&(d=l),c.left<(a._helper?l.left:0)&&(a.size.width=a.size.width+(a._helper?a.position.left-l.left:a.position.left-d.left),u&&(a.size.height=a.size.width/a.aspectRatio,p=!1),a.position.left=s.helper?l.left:0),c.top<(a._helper?l.top:0)&&(a.size.height=a.size.height+(a._helper?a.position.top-l.top:a.position.top),u&&(a.size.width=a.size.height*a.aspectRatio,p=!1),a.position.top=a._helper?l.top:0),r=a.containerElement.get(0)===a.element.parent().get(0),o=/relative|absolute/.test(a.containerElement.css("position")),r&&o?(a.offset.left=a.parentData.left+a.position.left,a.offset.top=a.parentData.top+a.position.top):(a.offset.left=a.element.offset().left,a.offset.top=a.element.offset().top),n=Math.abs(a.sizeDiff.width+(a._helper?a.offset.left-d.left:a.offset.left-l.left)),i=Math.abs(a.sizeDiff.height+(a._helper?a.offset.top-d.top:a.offset.top-l.top)),n+a.size.width>=a.parentData.width&&(a.size.width=a.parentData.width-n,u&&(a.size.height=a.size.width/a.aspectRatio,p=!1)),i+a.size.height>=a.parentData.height&&(a.size.height=a.parentData.height-i,u&&(a.size.width=a.size.height*a.aspectRatio,p=!1)),p||(a.position.left=a.prevPosition.left,a.position.top=a.prevPosition.top,a.size.width=a.prevSize.width,a.size.height=a.prevSize.height)},stop:function(){var t=e(this).resizable("instance"),n=t.options,i=t.containerOffset,r=t.containerPosition,o=t.containerElement,a=e(t.helper),s=a.offset(),l=a.outerWidth()-t.sizeDiff.width,c=a.outerHeight()-t.sizeDiff.height;t._helper&&!n.animate&&/relative/.test(o.css("position"))&&e(this).css({left:s.left-r.left-i.left,width:l,height:c}),t._helper&&!n.animate&&/static/.test(o.css("position"))&&e(this).css({left:s.left-r.left-i.left,width:l,height:c})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).resizable("instance"),n=t.options;e(n.alsoResize).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseFloat(t.width()),height:parseFloat(t.height()),left:parseFloat(t.css("left")),top:parseFloat(t.css("top"))})})},resize:function(t,n){var i=e(this).resizable("instance"),r=i.options,o=i.originalSize,a=i.originalPosition,s={height:i.size.height-o.height||0,width:i.size.width-o.width||0,top:i.position.top-a.top||0,left:i.position.left-a.left||0};e(r.alsoResize).each(function(){var t=e(this),i=e(this).data("ui-resizable-alsoresize"),r={},o=t.parents(n.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(o,function(e,t){var n=(i[t]||0)+(s[t]||0);n&&n>=0&&(r[t]=n||null)}),t.css(r)})},stop:function(){e(this).removeData("ui-resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).resizable("instance"),n=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:n.height,width:n.width,margin:0,left:0,top:0}),t._addClass(t.ghost,"ui-resizable-ghost"),!1!==e.uiBackCompat&&"string"==typeof t.options.ghost&&t.ghost.addClass(this.options.ghost),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t,n=e(this).resizable("instance"),i=n.options,r=n.size,o=n.originalSize,a=n.originalPosition,s=n.axis,l="number"==typeof i.grid?[i.grid,i.grid]:i.grid,c=l[0]||1,u=l[1]||1,d=Math.round((r.width-o.width)/c)*c,h=Math.round((r.height-o.height)/u)*u,p=o.width+d,f=o.height+h,g=i.maxWidth&&i.maxWidth<p,m=i.maxHeight&&i.maxHeight<f,v=i.minWidth&&i.minWidth>p,_=i.minHeight&&i.minHeight>f;i.grid=l,v&&(p+=c),_&&(f+=u),g&&(p-=c),m&&(f-=u),/^(se|s|e)$/.test(s)?(n.size.width=p,n.size.height=f):/^(ne)$/.test(s)?(n.size.width=p,n.size.height=f,n.position.top=a.top-h):/^(sw)$/.test(s)?(n.size.width=p,n.size.height=f,n.position.left=a.left-d):((f-u<=0||p-c<=0)&&(t=n._getPaddingPlusBorderDimensions(this)),f-u>0?(n.size.height=f,n.position.top=a.top-h):(f=u-t.height,n.size.height=f,n.position.top=a.top+o.height-f),p-c>0?(n.size.width=p,n.position.left=a.left-d):(p=c-t.width,n.size.width=p,n.position.left=a.left+o.width-p))}}),e.ui.resizable})},,function(e,t){e.exports="data:image/gif;base64,R0lGODlhIAAgALMAAP///7Ozs/v7+9bW1uHh4fLy8rq6uoGBgTQ0NAEBARsbG8TExJeXl/39/VRUVAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFBQAAACwAAAAAIAAgAAAE5xDISSlLrOrNp0pKNRCdFhxVolJLEJQUoSgOpSYT4RowNSsvyW1icA16k8MMMRkCBjskBTFDAZyuAEkqCfxIQ2hgQRFvAQEEIjNxVDW6XNE4YagRjuBCwe60smQUDnd4Rz1ZAQZnFAGDd0hihh12CEE9kjAEVlycXIg7BAsMB6SlnJ87paqbSKiKoqusnbMdmDC2tXQlkUhziYtyWTxIfy6BE8WJt5YEvpJivxNaGmLHT0VnOgGYf0dZXS7APdpB309RnHOG5gDqXGLDaC457D1zZ/V/nmOM82XiHQjYKhKP1oZmADdEAAAh+QQFBQAAACwAAAAAGAAXAAAEchDISasKNeuJFKoHs4mUYlJIkmjIV54Soypsa0wmLSnqoTEtBw52mG0AjhYpBxioEqRNy8V0qFzNw+GGwlJki4lBqx1IBgjMkRIghwjrzcDti2/Gh7D9qN774wQGAYOEfwCChIV/gYmDho+QkZKTR3p7EQAh+QQFBQAAACwBAAAAHQAOAAAEchDISWdANesNHHJZwE2DUSEo5SjKKB2HOKGYFLD1CB/DnEoIlkti2PlyuKGEATMBaAACSyGbEDYD4zN1YIEmh0SCQQgYehNmTNNaKsQJXmBuuEYPi9ECAU/UFnNzeUp9VBQEBoFOLmFxWHNoQw6RWEocEQAh+QQFBQAAACwHAAAAGQARAAAEaRDICdZZNOvNDsvfBhBDdpwZgohBgE3nQaki0AYEjEqOGmqDlkEnAzBUjhrA0CoBYhLVSkm4SaAAWkahCFAWTU0A4RxzFWJnzXFWJJWb9pTihRu5dvghl+/7NQmBggo/fYKHCX8AiAmEEQAh+QQFBQAAACwOAAAAEgAYAAAEZXCwAaq9ODAMDOUAI17McYDhWA3mCYpb1RooXBktmsbt944BU6zCQCBQiwPB4jAihiCK86irTB20qvWp7Xq/FYV4TNWNz4oqWoEIgL0HX/eQSLi69boCikTkE2VVDAp5d1p0CW4RACH5BAUFAAAALA4AAAASAB4AAASAkBgCqr3YBIMXvkEIMsxXhcFFpiZqBaTXisBClibgAnd+ijYGq2I4HAamwXBgNHJ8BEbzgPNNjz7LwpnFDLvgLGJMdnw/5DRCrHaE3xbKm6FQwOt1xDnpwCvcJgcJMgEIeCYOCQlrF4YmBIoJVV2CCXZvCooHbwGRcAiKcmFUJhEAIfkEBQUAAAAsDwABABEAHwAABHsQyAkGoRivELInnOFlBjeM1BCiFBdcbMUtKQdTN0CUJru5NJQrYMh5VIFTTKJcOj2HqJQRhEqvqGuU+uw6AwgEwxkOO55lxIihoDjKY8pBoThPxmpAYi+hKzoeewkTdHkZghMIdCOIhIuHfBMOjxiNLR4KCW1ODAlxSxEAIfkEBQUAAAAsCAAOABgAEgAABGwQyEkrCDgbYvvMoOF5ILaNaIoGKroch9hacD3MFMHUBzMHiBtgwJMBFolDB4GoGGBCACKRcAAUWAmzOWJQExysQsJgWj0KqvKalTiYPhp1LBFTtp10Is6mT5gdVFx1bRN8FTsVCAqDOB9+KhEAIfkEBQUAAAAsAgASAB0ADgAABHgQyEmrBePS4bQdQZBdR5IcHmWEgUFQgWKaKbWwwSIhc4LonsXhBSCsQoOSScGQDJiWwOHQnAxWBIYJNXEoFCiEWDI9jCzESey7GwMM5doEwW4jJoypQQ743u1WcTV0CgFzbhJ5XClfHYd/EwZnHoYVDgiOfHKQNREAIfkEBQUAAAAsAAAPABkAEQAABGeQqUQruDjrW3vaYCZ5X2ie6EkcKaooTAsi7ytnTq046BBsNcTvItz4AotMwKZBIC6H6CVAJaCcT0CUBTgaTg5nTCu9GKiDEMPJg5YBBOpwlnVzLwtqyKnZagZWahoMB2M3GgsHSRsRACH5BAUFAAAALAEACAARABgAAARcMKR0gL34npkUyyCAcAmyhBijkGi2UW02VHFt33iu7yiDIDaD4/erEYGDlu/nuBAOJ9Dvc2EcDgFAYIuaXS3bbOh6MIC5IAP5Eh5fk2exC4tpgwZyiyFgvhEMBBEAIfkEBQUAAAAsAAACAA4AHQAABHMQyAnYoViSlFDGXBJ808Ep5KRwV8qEg+pRCOeoioKMwJK0Ekcu54h9AoghKgXIMZgAApQZcCCu2Ax2O6NUud2pmJcyHA4L0uDM/ljYDCnGfGakJQE5YH0wUBYBAUYfBIFkHwaBgxkDgX5lgXpHAXcpBIsRADs="},,,,,,,,,,,,,,,,,function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(module,exports,__webpack_require__){(function(jQuery){!function($){var settings={},roots={},caches={},_consts={className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch",NAME:"node_name"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error",REMOVE:"ztree_remove",SELECTED:"ztree_selected",UNSELECTED:"ztree_unselected"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_setting={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0,txtSelectedEnable:!1},data:{key:{children:"children",name:"name",title:"",url:"url",icon:"icon"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},_initRoot=function(e){var t=data.getRoot(e);t||(t={},data.setRoot(e,t)),t[e.data.key.children]=[],t.expandTriggerFlag=!1,t.curSelectedList=[],t.noSelection=!0,t.createdNodes=[],t.zId=0,t._ver=(new Date).getTime()},_initCache=function(e){var t=data.getCache(e);t||(t={},data.setCache(e,t)),t.nodes=[],t.doms=[]},_bindEvent=function(e){var t=e.treeObj,n=consts.event;t.bind(n.NODECREATED,function(t,n,i){tools.apply(e.callback.onNodeCreated,[t,n,i])}),t.bind(n.CLICK,function(t,n,i,r,o){tools.apply(e.callback.onClick,[n,i,r,o])}),t.bind(n.EXPAND,function(t,n,i){tools.apply(e.callback.onExpand,[t,n,i])}),t.bind(n.COLLAPSE,function(t,n,i){tools.apply(e.callback.onCollapse,[t,n,i])}),t.bind(n.ASYNC_SUCCESS,function(t,n,i,r){tools.apply(e.callback.onAsyncSuccess,[t,n,i,r])}),t.bind(n.ASYNC_ERROR,function(t,n,i,r,o,a){tools.apply(e.callback.onAsyncError,[t,n,i,r,o,a])}),t.bind(n.REMOVE,function(t,n,i){tools.apply(e.callback.onRemove,[t,n,i])}),t.bind(n.SELECTED,function(t,n,i){tools.apply(e.callback.onSelected,[n,i])}),t.bind(n.UNSELECTED,function(t,n,i){tools.apply(e.callback.onUnSelected,[n,i])})},_unbindEvent=function(e){var t=e.treeObj,n=consts.event;t.unbind(n.NODECREATED).unbind(n.CLICK).unbind(n.EXPAND).unbind(n.COLLAPSE).unbind(n.ASYNC_SUCCESS).unbind(n.ASYNC_ERROR).unbind(n.REMOVE).unbind(n.SELECTED).unbind(n.UNSELECTED)},_eventProxy=function(e){var t=e.target,n=data.getSetting(e.data.treeId),i="",r=null,o="",a="",s=null,l=null,c=null;if(tools.eqs(e.type,"mousedown")?a="mousedown":tools.eqs(e.type,"mouseup")?a="mouseup":tools.eqs(e.type,"contextmenu")?a="contextmenu":tools.eqs(e.type,"click")?tools.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+consts.id.SWITCH)?(i=tools.getNodeMainDom(t).id,o="switchNode"):(c=tools.getMDom(n,t,[{tagName:"a",attrName:"treeNode"+consts.id.A}]))&&(i=tools.getNodeMainDom(c).id,o="clickNode"):tools.eqs(e.type,"dblclick")&&(a="dblclick",(c=tools.getMDom(n,t,[{tagName:"a",attrName:"treeNode"+consts.id.A}]))&&(i=tools.getNodeMainDom(c).id,o="switchNode")),a.length>0&&0==i.length&&(c=tools.getMDom(n,t,[{tagName:"a",attrName:"treeNode"+consts.id.A}]))&&(i=tools.getNodeMainDom(c).id),i.length>0)switch(r=data.getNodeCache(n,i),o){case"switchNode":r.isParent&&(tools.eqs(e.type,"click")||tools.eqs(e.type,"dblclick")&&tools.apply(n.view.dblClickExpand,[n.treeId,r],n.view.dblClickExpand))?s=handler.onSwitchNode:o="";break;case"clickNode":s=handler.onClickNode}switch(a){case"mousedown":l=handler.onZTreeMousedown;break;case"mouseup":l=handler.onZTreeMouseup;break;case"dblclick":l=handler.onZTreeDblclick;break;case"contextmenu":l=handler.onZTreeContextmenu}return{stop:!1,node:r,nodeEventType:o,nodeEventCallback:s,treeEventType:a,treeEventCallback:l}},_initNode=function(e,t,n,i,r,o,a){if(n){var s=data.getRoot(e),l=e.data.key.children;n.level=t,n.tId=e.treeId+"_"+ ++s.zId,n.parentTId=i?i.tId:null,n.open="string"==typeof n.open?tools.eqs(n.open,"true"):!!n.open,n[l]&&n[l].length>0?(n.isParent=!0,n.zAsync=!0):(n.isParent="string"==typeof n.isParent?tools.eqs(n.isParent,"true"):!!n.isParent,n.open=!(!n.isParent||e.async.enable)&&n.open,n.zAsync=!n.isParent),n.isFirstNode=r,n.isLastNode=o,n.getParentNode=function(){return data.getNodeCache(e,n.parentTId)},n.getPreNode=function(){return data.getPreNode(e,n)},n.getNextNode=function(){return data.getNextNode(e,n)},n.getIndex=function(){return data.getNodeIndex(e,n)},n.getPath=function(){return data.getNodePath(e,n)},n.isAjaxing=!1,data.fixPIdKeyValue(e,n)}},_init={bind:[_bindEvent],unbind:[_unbindEvent],caches:[_initCache],nodes:[_initNode],proxys:[_eventProxy],roots:[_initRoot],beforeA:[],afterA:[],innerBeforeA:[],innerAfterA:[],zTreeTools:[]},data={addNodeCache:function(e,t){data.getCache(e).nodes[data.getNodeCacheId(t.tId)]=t},getNodeCacheId:function(e){return e.substring(e.lastIndexOf("_")+1)},addAfterA:function(e){_init.afterA.push(e)},addBeforeA:function(e){_init.beforeA.push(e)},addInnerAfterA:function(e){_init.innerAfterA.push(e)},addInnerBeforeA:function(e){_init.innerBeforeA.push(e)},addInitBind:function(e){_init.bind.push(e)},addInitUnBind:function(e){_init.unbind.push(e)},addInitCache:function(e){_init.caches.push(e)},addInitNode:function(e){_init.nodes.push(e)},addInitProxy:function(e,t){t?_init.proxys.splice(0,0,e):_init.proxys.push(e)},addInitRoot:function(e){_init.roots.push(e)},addNodesData:function(e,t,n,i){var r,o=e.data.key.children;t[o]?n>=t[o].length&&(n=-1):(t[o]=[],n=-1),t[o].length>0&&0===n?(t[o][0].isFirstNode=!1,view.setNodeLineIcos(e,t[o][0])):t[o].length>0&&n<0&&(t[o][t[o].length-1].isLastNode=!1,view.setNodeLineIcos(e,t[o][t[o].length-1])),t.isParent=!0,n<0?t[o]=t[o].concat(i):(r=[n,0].concat(i),t[o].splice.apply(t[o],r))},addSelectedNode:function(e,t){var n=data.getRoot(e);data.isSelectedNode(e,t)||n.curSelectedList.push(t)},addCreatedNode:function(e,t){if(e.callback.onNodeCreated||e.view.addDiyDom){data.getRoot(e).createdNodes.push(t)}},addZTreeTools:function(e){_init.zTreeTools.push(e)},exSetting:function(e){$.extend(!0,_setting,e)},fixPIdKeyValue:function(e,t){e.data.simpleData.enable&&(t[e.data.simpleData.pIdKey]=t.parentTId?t.getParentNode()[e.data.simpleData.idKey]:e.data.simpleData.rootPId)},getAfterA:function(e,t,n){for(var i=0,r=_init.afterA.length;i<r;i++)_init.afterA[i].apply(this,arguments)},getBeforeA:function(e,t,n){for(var i=0,r=_init.beforeA.length;i<r;i++)_init.beforeA[i].apply(this,arguments)},getInnerAfterA:function(e,t,n){for(var i=0,r=_init.innerAfterA.length;i<r;i++)_init.innerAfterA[i].apply(this,arguments)},getInnerBeforeA:function(e,t,n){for(var i=0,r=_init.innerBeforeA.length;i<r;i++)_init.innerBeforeA[i].apply(this,arguments)},getCache:function(e){return caches[e.treeId]},getNodeIndex:function(e,t){if(!t)return null;for(var n=e.data.key.children,i=t.parentTId?t.getParentNode():data.getRoot(e),r=0,o=i[n].length-1;r<=o;r++)if(i[n][r]===t)return r;return-1},getNextNode:function(e,t){if(!t)return null;for(var n=e.data.key.children,i=t.parentTId?t.getParentNode():data.getRoot(e),r=0,o=i[n].length-1;r<=o;r++)if(i[n][r]===t)return r==o?null:i[n][r+1];return null},getNodeByParam:function(e,t,n,i){if(!t||!n)return null;for(var r=e.data.key.children,o=0,a=t.length;o<a;o++){if(t[o][n]==i)return t[o];var s=data.getNodeByParam(e,t[o][r],n,i);if(s)return s}return null},getNodeCache:function(e,t){if(!t)return null;var n=caches[e.treeId].nodes[data.getNodeCacheId(t)];return n||null},getNodeName:function(e,t){return""+t[e.data.key.name]},getNodePath:function(e,t){if(!t)return null;var n;return n=t.parentTId?t.getParentNode().getPath():[],n&&n.push(t),n},getNodeTitle:function(e,t){return""+t[""===e.data.key.title?e.data.key.name:e.data.key.title]},getNodes:function(e){return data.getRoot(e)[e.data.key.children]},getNodesByParam:function(e,t,n,i){if(!t||!n)return[];for(var r=e.data.key.children,o=[],a=0,s=t.length;a<s;a++)t[a][n]==i&&o.push(t[a]),o=o.concat(data.getNodesByParam(e,t[a][r],n,i));return o},getNodesByParamFuzzy:function(e,t,n,i){if(!t||!n)return[];var r=e.data.key.children,o=[];i=i.toLowerCase();for(var a=0,s=t.length;a<s;a++)"string"==typeof t[a][n]&&t[a][n].toLowerCase().indexOf(i)>-1&&o.push(t[a]),o=o.concat(data.getNodesByParamFuzzy(e,t[a][r],n,i));return o},getNodesByFilter:function(e,t,n,i,r){if(!t)return i?null:[];for(var o=e.data.key.children,a=i?null:[],s=0,l=t.length;s<l;s++){if(tools.apply(n,[t[s],r],!1)){if(i)return t[s];a.push(t[s])}var c=data.getNodesByFilter(e,t[s][o],n,i,r);if(i&&c)return c;a=i?c:a.concat(c)}return a},getPreNode:function(e,t){if(!t)return null;for(var n=e.data.key.children,i=t.parentTId?t.getParentNode():data.getRoot(e),r=0,o=i[n].length;r<o;r++)if(i[n][r]===t)return 0==r?null:i[n][r-1];return null},getRoot:function(e){return e?roots[e.treeId]:null},getRoots:function(){return roots},getSetting:function(e){return settings[e]},getSettings:function(){return settings},getZTreeTools:function(e){var t=this.getRoot(this.getSetting(e));return t?t.treeTools:null},initCache:function(e){for(var t=0,n=_init.caches.length;t<n;t++)_init.caches[t].apply(this,arguments)},initNode:function(e,t,n,i,r,o){for(var a=0,s=_init.nodes.length;a<s;a++)_init.nodes[a].apply(this,arguments)},initRoot:function(e){for(var t=0,n=_init.roots.length;t<n;t++)_init.roots[t].apply(this,arguments)},isSelectedNode:function(e,t){for(var n=data.getRoot(e),i=0,r=n.curSelectedList.length;i<r;i++)if(t===n.curSelectedList[i])return!0;return!1},removeNodeCache:function(e,t){var n=e.data.key.children;if(t[n])for(var i=0,r=t[n].length;i<r;i++)data.removeNodeCache(e,t[n][i]);data.getCache(e).nodes[data.getNodeCacheId(t.tId)]=null},removeSelectedNode:function(e,t){for(var n=data.getRoot(e),i=0,r=n.curSelectedList.length;i<r;i++)t!==n.curSelectedList[i]&&data.getNodeCache(e,n.curSelectedList[i].tId)||(n.curSelectedList.splice(i,1),e.treeObj.trigger(consts.event.UNSELECTED,[e.treeId,t]),i--,r--)},setCache:function(e,t){caches[e.treeId]=t},setRoot:function(e,t){roots[e.treeId]=t},setZTreeTools:function(e,t){for(var n=0,i=_init.zTreeTools.length;n<i;n++)_init.zTreeTools[n].apply(this,arguments)},transformToArrayFormat:function(e,t){if(!t)return[];var n=e.data.key.children,i=[];if(tools.isArray(t))for(var r=0,o=t.length;r<o;r++)i.push(t[r]),t[r][n]&&(i=i.concat(data.transformToArrayFormat(e,t[r][n])));else i.push(t),t[n]&&(i=i.concat(data.transformToArrayFormat(e,t[n])));return i},transformTozTreeFormat:function(e,t){var n,i,r=e.data.simpleData.idKey,o=e.data.simpleData.pIdKey,a=e.data.key.children;if(!r||""==r||!t)return[];if(tools.isArray(t)){var s=[],l=[];for(n=0,i=t.length;n<i;n++)l[t[n][r]]=t[n];for(n=0,i=t.length;n<i;n++)l[t[n][o]]&&t[n][r]!=t[n][o]?(l[t[n][o]][a]||(l[t[n][o]][a]=[]),l[t[n][o]][a].push(t[n])):s.push(t[n]);return s}return[t]}},event={bindEvent:function(e){for(var t=0,n=_init.bind.length;t<n;t++)_init.bind[t].apply(this,arguments)},unbindEvent:function(e){for(var t=0,n=_init.unbind.length;t<n;t++)_init.unbind[t].apply(this,arguments)},bindTree:function(e){var t={treeId:e.treeId},n=e.treeObj;e.view.txtSelectedEnable||n.bind("selectstart",handler.onSelectStart).css({"-moz-user-select":"-moz-none"}),n.bind("click",t,event.proxy),n.bind("dblclick",t,event.proxy),n.bind("mouseover",t,event.proxy),n.bind("mouseout",t,event.proxy),n.bind("mousedown",t,event.proxy),n.bind("mouseup",t,event.proxy),n.bind("contextmenu",t,event.proxy)},unbindTree:function(e){e.treeObj.unbind("selectstart",handler.onSelectStart).unbind("click",event.proxy).unbind("dblclick",event.proxy).unbind("mouseover",event.proxy).unbind("mouseout",event.proxy).unbind("mousedown",event.proxy).unbind("mouseup",event.proxy).unbind("contextmenu",event.proxy)},doProxy:function(e){for(var t=[],n=0,i=_init.proxys.length;n<i;n++){var r=_init.proxys[n].apply(this,arguments);if(t.push(r),r.stop)break}return t},proxy:function(e){var t=data.getSetting(e.data.treeId);if(!tools.uCanDo(t,e))return!0;for(var n=event.doProxy(e),i=!0,r=0,o=n.length;r<o;r++){var a=n[r];a.nodeEventCallback&&(!0,i=a.nodeEventCallback.apply(a,[e,a.node])&&i),a.treeEventCallback&&(!0,i=a.treeEventCallback.apply(a,[e,a.node])&&i)}return i}},handler={onSwitchNode:function(e,t){var n=data.getSetting(e.data.treeId);if(t.open){if(0==tools.apply(n.callback.beforeCollapse,[n.treeId,t],!0))return!0;data.getRoot(n).expandTriggerFlag=!0,view.switchNode(n,t)}else{if(0==tools.apply(n.callback.beforeExpand,[n.treeId,t],!0))return!0;data.getRoot(n).expandTriggerFlag=!0,view.switchNode(n,t)}return!0},onClickNode:function(e,t){var n=data.getSetting(e.data.treeId),i=n.view.autoCancelSelected&&(e.ctrlKey||e.metaKey)&&data.isSelectedNode(n,t)?0:n.view.autoCancelSelected&&(e.ctrlKey||e.metaKey)&&n.view.selectedMulti?2:1;return 0==tools.apply(n.callback.beforeClick,[n.treeId,t,i],!0)||(0===i?view.cancelPreSelectedNode(n,t):view.selectNode(n,t,2===i),n.treeObj.trigger(consts.event.CLICK,[e,n.treeId,t,i]),!0)},onZTreeMousedown:function(e,t){var n=data.getSetting(e.data.treeId);return tools.apply(n.callback.beforeMouseDown,[n.treeId,t],!0)&&tools.apply(n.callback.onMouseDown,[e,n.treeId,t]),!0},onZTreeMouseup:function(e,t){var n=data.getSetting(e.data.treeId);return tools.apply(n.callback.beforeMouseUp,[n.treeId,t],!0)&&tools.apply(n.callback.onMouseUp,[e,n.treeId,t]),!0},onZTreeDblclick:function(e,t){var n=data.getSetting(e.data.treeId);return tools.apply(n.callback.beforeDblClick,[n.treeId,t],!0)&&tools.apply(n.callback.onDblClick,[e,n.treeId,t]),!0},onZTreeContextmenu:function(e,t){var n=data.getSetting(e.data.treeId);return tools.apply(n.callback.beforeRightClick,[n.treeId,t],!0)&&tools.apply(n.callback.onRightClick,[e,n.treeId,t]),"function"!=typeof n.callback.onRightClick},onSelectStart:function(e){var t=e.originalEvent.srcElement.nodeName.toLowerCase();return"input"===t||"textarea"===t}},tools={apply:function(e,t,n){return"function"==typeof e?e.apply(zt,t||[]):n},canAsync:function(e,t){var n=e.data.key.children;return e.async.enable&&t&&t.isParent&&!(t.zAsync||t[n]&&t[n].length>0)},clone:function(e){if(null===e)return null;var t=tools.isArray(e)?[]:{};for(var n in e)t[n]=e[n]instanceof Date?new Date(e[n].getTime()):"object"==typeof e[n]?tools.clone(e[n]):e[n];return t},eqs:function(e,t){return e.toLowerCase()===t.toLowerCase()},isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},$:function(e,t,n){return t&&"string"!=typeof t&&(n=t,t=""),"string"==typeof e?$(e,n?n.treeObj.get(0).ownerDocument:null):$("#"+e.tId+t,n?n.treeObj:null)},getMDom:function(e,t,n){if(!t)return null;for(;t&&t.id!==e.treeId;){for(var i=0,r=n.length;t.tagName&&i<r;i++)if(tools.eqs(t.tagName,n[i].tagName)&&null!==t.getAttribute(n[i].attrName))return t;t=t.parentNode}return null},getNodeMainDom:function(e){return $(e).parent("li").get(0)||$(e).parentsUntil("li").parent().get(0)},isChildOrSelf:function(e,t){return $(e).closest("#"+t).length>0},uCanDo:function(e,t){return!0}},view={addNodes:function(e,t,n,i,r){if(!e.data.keep.leaf||!t||t.isParent)if(tools.isArray(i)||(i=[i]),e.data.simpleData.enable&&(i=data.transformTozTreeFormat(e,i)),t){var o=$$(t,consts.id.SWITCH,e),a=$$(t,consts.id.ICON,e),s=$$(t,consts.id.UL,e);t.open||(view.replaceSwitchClass(t,o,consts.folder.CLOSE),view.replaceIcoClass(t,a,consts.folder.CLOSE),t.open=!1,s.css({display:"none"})),data.addNodesData(e,t,n,i),view.createNodes(e,t.level+1,i,t,n),r||view.expandCollapseParentNode(e,t,!0)}else data.addNodesData(e,data.getRoot(e),n,i),view.createNodes(e,0,i,null,n)},appendNodes:function(e,t,n,i,r,o,a){if(!n)return[];var s,l,c=[],u=e.data.key.children,d=i||data.getRoot(e),h=d[u];(!h||r>=h.length)&&(r=-1);for(var p=0,f=n.length;p<f;p++){var g=n[p];o&&(s=(0===r||h.length==n.length)&&0==p,l=r<0&&p==n.length-1,data.initNode(e,t,g,i,s,l,a),data.addNodeCache(e,g));var m=[];g[u]&&g[u].length>0&&(m=view.appendNodes(e,t+1,g[u],g,-1,o,a&&g.open)),a&&(view.makeDOMNodeMainBefore(c,e,g),view.makeDOMNodeLine(c,e,g),data.getBeforeA(e,g,c),view.makeDOMNodeNameBefore(c,e,g),data.getInnerBeforeA(e,g,c),view.makeDOMNodeIcon(c,e,g),data.getInnerAfterA(e,g,c),view.makeDOMNodeNameAfter(c,e,g),data.getAfterA(e,g,c),g.isParent&&g.open&&view.makeUlHtml(e,g,c,m.join("")),view.makeDOMNodeMainAfter(c,e,g),data.addCreatedNode(e,g))}return c},appendParentULDom:function(e,t){var n=[],i=$$(t,e);!i.get(0)&&t.parentTId&&(view.appendParentULDom(e,t.getParentNode()),i=$$(t,e));var r=$$(t,consts.id.UL,e);r.get(0)&&r.remove();var o=e.data.key.children,a=view.appendNodes(e,t.level+1,t[o],t,-1,!1,!0);view.makeUlHtml(e,t,n,a.join("")),i.append(n.join(""))},asyncNode:function(setting,node,isSilent,callback){var i,l;if(node&&!node.isParent)return tools.apply(callback),!1;if(node&&node.isAjaxing)return!1;if(0==tools.apply(setting.callback.beforeAsync,[setting.treeId,node],!0))return tools.apply(callback),!1;if(node){node.isAjaxing=!0;var icoObj=$$(node,consts.id.ICON,setting);icoObj.attr({style:"",class:consts.className.BUTTON+" "+consts.className.ICO_LOADING})}var tmpParam={};for(i=0,l=setting.async.autoParam.length;node&&i<l;i++){var pKey=setting.async.autoParam[i].split("="),spKey=pKey;pKey.length>1&&(spKey=pKey[1],pKey=pKey[0]),tmpParam[spKey]=node[pKey]}if(tools.isArray(setting.async.otherParam))for(i=0,l=setting.async.otherParam.length;i<l;i+=2)tmpParam[setting.async.otherParam[i]]=setting.async.otherParam[i+1];else for(var p in setting.async.otherParam)tmpParam[p]=setting.async.otherParam[p];var _tmpV=data.getRoot(setting)._ver;return $.ajax({contentType:setting.async.contentType,cache:!1,type:setting.async.type,url:tools.apply(setting.async.url,[setting.treeId,node],setting.async.url),data:tmpParam,dataType:setting.async.dataType,success:function(msg){if(_tmpV==data.getRoot(setting)._ver){var newNodes=[];try{newNodes=msg&&0!=msg.length?"string"==typeof msg?eval("("+msg+")"):msg:[]}catch(e){newNodes=msg}node&&(node.isAjaxing=null,node.zAsync=!0),view.setNodeLineIcos(setting,node),newNodes&&""!==newNodes?(newNodes=tools.apply(setting.async.dataFilter,[setting.treeId,node,newNodes],newNodes),view.addNodes(setting,node,-1,newNodes?tools.clone(newNodes):[],!!isSilent)):view.addNodes(setting,node,-1,[],!!isSilent),setting.treeObj.trigger(consts.event.ASYNC_SUCCESS,[setting.treeId,node,msg]),tools.apply(callback)}},error:function(e,t,n){_tmpV==data.getRoot(setting)._ver&&(node&&(node.isAjaxing=null),view.setNodeLineIcos(setting,node),setting.treeObj.trigger(consts.event.ASYNC_ERROR,[setting.treeId,node,e,t,n]))}}),!0},cancelPreSelectedNode:function(e,t,n){var i,r,o=data.getRoot(e).curSelectedList;for(i=o.length-1;i>=0;i--)if(r=o[i],t===r||!t&&(!n||n!==r)){if($$(r,consts.id.A,e).removeClass(consts.node.CURSELECTED),t){data.removeSelectedNode(e,t);break}o.splice(i,1),e.treeObj.trigger(consts.event.UNSELECTED,[e.treeId,r])}},createNodeCallback:function(e){if(e.callback.onNodeCreated||e.view.addDiyDom)for(var t=data.getRoot(e);t.createdNodes.length>0;){var n=t.createdNodes.shift();tools.apply(e.view.addDiyDom,[e.treeId,n]),e.callback.onNodeCreated&&e.treeObj.trigger(consts.event.NODECREATED,[e.treeId,n])}},createNodes:function(e,t,n,i,r){if(n&&0!=n.length){var o=data.getRoot(e),a=e.data.key.children,s=!i||i.open||!!$$(i[a][0],e).get(0);o.createdNodes=[];var l,c,u=view.appendNodes(e,t,n,i,r,!0,s);if(i){var d=$$(i,consts.id.UL,e);d.get(0)&&(l=d)}else l=e.treeObj;l&&(r>=0&&(c=l.children()[r]),r>=0&&c?$(c).before(u.join("")):l.append(u.join(""))),view.createNodeCallback(e)}},destroy:function(e){e&&(data.initCache(e),data.initRoot(e),event.unbindTree(e),event.unbindEvent(e),e.treeObj.empty(),delete settings[e.treeId])},expandCollapseNode:function(e,t,n,i,r){var o,a,s=data.getRoot(e),l=e.data.key.children;if(!t)return void tools.apply(r,[]);if(s.expandTriggerFlag&&(a=r,o=function(){a&&a(),t.open?e.treeObj.trigger(consts.event.EXPAND,[e.treeId,t]):e.treeObj.trigger(consts.event.COLLAPSE,[e.treeId,t])},r=o,s.expandTriggerFlag=!1),!t.open&&t.isParent&&(!$$(t,consts.id.UL,e).get(0)||t[l]&&t[l].length>0&&!$$(t[l][0],e).get(0))&&(view.appendParentULDom(e,t),view.createNodeCallback(e)),t.open==n)return void tools.apply(r,[]);var c=$$(t,consts.id.UL,e),u=$$(t,consts.id.SWITCH,e),d=$$(t,consts.id.ICON,e);t.isParent?(t.open=!t.open,t.iconOpen&&t.iconClose&&d.attr("style",view.makeNodeIcoStyle(e,t)),t.open?(view.replaceSwitchClass(t,u,consts.folder.OPEN),view.replaceIcoClass(t,d,consts.folder.OPEN),0==i||""==e.view.expandSpeed?(c.show(),tools.apply(r,[])):t[l]&&t[l].length>0?c.slideDown(e.view.expandSpeed,r):(c.show(),tools.apply(r,[]))):(view.replaceSwitchClass(t,u,consts.folder.CLOSE),view.replaceIcoClass(t,d,consts.folder.CLOSE),0!=i&&""!=e.view.expandSpeed&&t[l]&&t[l].length>0?c.slideUp(e.view.expandSpeed,r):(c.hide(),tools.apply(r,[])))):tools.apply(r,[])},expandCollapseParentNode:function(e,t,n,i,r){if(t){if(!t.parentTId)return void view.expandCollapseNode(e,t,n,i,r);view.expandCollapseNode(e,t,n,i),t.parentTId&&view.expandCollapseParentNode(e,t.getParentNode(),n,i,r)}},expandCollapseSonNode:function(e,t,n,i,r){var o=data.getRoot(e),a=e.data.key.children,s=t?t[a]:o[a],l=!t&&i,c=data.getRoot(e).expandTriggerFlag;if(data.getRoot(e).expandTriggerFlag=!1,s)for(var u=0,d=s.length;u<d;u++)s[u]&&view.expandCollapseSonNode(e,s[u],n,l);data.getRoot(e).expandTriggerFlag=c,view.expandCollapseNode(e,t,n,i,r)},isSelectedNode:function(e,t){if(!t)return!1;var n,i=data.getRoot(e).curSelectedList;for(n=i.length-1;n>=0;n--)if(t===i[n])return!0;return!1},makeDOMNodeIcon:function(e,t,n){var i=data.getNodeName(t,n),r=t.view.nameIsHTML?i:i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");e.push("<span id='",n.tId,consts.id.ICON,"' title='' treeNode",consts.id.ICON," class='",view.makeNodeIcoClass(t,n),"' style='",view.makeNodeIcoStyle(t,n),"'></span><span id='",n.tId,consts.id.SPAN,"' class='",consts.className.NAME,"'>",r,"</span>")},makeDOMNodeLine:function(e,t,n){e.push("<span id='",n.tId,consts.id.SWITCH,"' title='' class='",view.makeNodeLineClass(t,n),"' treeNode",consts.id.SWITCH,"></span>")},makeDOMNodeMainAfter:function(e,t,n){e.push("</li>")},makeDOMNodeMainBefore:function(e,t,n){e.push("<li id='",n.tId,"' class='",consts.className.LEVEL,n.level,"' tabindex='0' hidefocus='true' treenode>")},makeDOMNodeNameAfter:function(e,t,n){e.push("</a>")},makeDOMNodeNameBefore:function(e,t,n){var i=data.getNodeTitle(t,n),r=view.makeNodeUrl(t,n),o=view.makeNodeFontCss(t,n),a=[];for(var s in o)a.push(s,":",o[s],";");e.push("<a id='",n.tId,consts.id.A,"' class='",consts.className.LEVEL,n.level,"' treeNode",consts.id.A,' onclick="',n.click||"",'" ',null!=r&&r.length>0?"href='"+r+"'":""," target='",view.makeNodeTarget(n),"' style='",a.join(""),"'"),tools.apply(t.view.showTitle,[t.treeId,n],t.view.showTitle)&&i&&e.push("title='",i.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'"),e.push(">")},makeNodeFontCss:function(e,t){var n=tools.apply(e.view.fontCss,[e.treeId,t],e.view.fontCss);return n&&"function"!=typeof n?n:{}},makeNodeIcoClass:function(e,t){var n=["ico"];return t.isAjaxing||(n[0]=(t.iconSkin?t.iconSkin+"_":"")+n[0],t.isParent?n.push(t.open?consts.folder.OPEN:consts.folder.CLOSE):n.push(consts.folder.DOCU)),consts.className.BUTTON+" "+n.join("_")},makeNodeIcoStyle:function(e,t){var n=[];if(!t.isAjaxing){var i=t.isParent&&t.iconOpen&&t.iconClose?t.open?t.iconOpen:t.iconClose:t[e.data.key.icon];i&&n.push("background:url(",i,") 0 0 no-repeat;"),0!=e.view.showIcon&&tools.apply(e.view.showIcon,[e.treeId,t],!0)||n.push("width:0px;height:0px;")}return n.join("")},makeNodeLineClass:function(e,t){var n=[];return e.view.showLine?0==t.level&&t.isFirstNode&&t.isLastNode?n.push(consts.line.ROOT):0==t.level&&t.isFirstNode?n.push(consts.line.ROOTS):t.isLastNode?n.push(consts.line.BOTTOM):n.push(consts.line.CENTER):n.push(consts.line.NOLINE),t.isParent?n.push(t.open?consts.folder.OPEN:consts.folder.CLOSE):n.push(consts.folder.DOCU),view.makeNodeLineClassEx(t)+n.join("_")},makeNodeLineClassEx:function(e){return consts.className.BUTTON+" "+consts.className.LEVEL+e.level+" "+consts.className.SWITCH+" "},makeNodeTarget:function(e){return e.target||"_blank"},makeNodeUrl:function(e,t){var n=e.data.key.url;return t[n]?t[n]:null},makeUlHtml:function(e,t,n,i){n.push("<ul id='",t.tId,consts.id.UL,"' class='",consts.className.LEVEL,t.level," ",view.makeUlLineClass(e,t),"' style='display:",t.open?"block":"none","'>"),n.push(i),n.push("</ul>")},makeUlLineClass:function(e,t){return e.view.showLine&&!t.isLastNode?consts.line.LINE:""},removeChildNodes:function(e,t){if(t){var n=e.data.key.children,i=t[n];if(i){for(var r=0,o=i.length;r<o;r++)data.removeNodeCache(e,i[r]);if(data.removeSelectedNode(e),delete t[n],e.data.keep.parent)$$(t,consts.id.UL,e).empty();else{t.isParent=!1,t.open=!1;var a=$$(t,consts.id.SWITCH,e),s=$$(t,consts.id.ICON,e);view.replaceSwitchClass(t,a,consts.folder.DOCU),view.replaceIcoClass(t,s,consts.folder.DOCU),$$(t,consts.id.UL,e).remove()}}}},scrollIntoView:function(e){if(e)if(e.scrollIntoViewIfNeeded)e.scrollIntoViewIfNeeded();else if(e.scrollIntoView)e.scrollIntoView(!1);else try{e.focus().blur()}catch(e){}},setFirstNode:function(e,t){var n=e.data.key.children;t[n].length>0&&(t[n][0].isFirstNode=!0)},setLastNode:function(e,t){var n=e.data.key.children,i=t[n].length;i>0&&(t[n][i-1].isLastNode=!0)},removeNode:function(e,t){var n=data.getRoot(e),i=e.data.key.children,r=t.parentTId?t.getParentNode():n;if(t.isFirstNode=!1,t.isLastNode=!1,t.getPreNode=function(){return null},t.getNextNode=function(){return null},data.getNodeCache(e,t.tId)){$$(t,e).remove(),data.removeNodeCache(e,t),data.removeSelectedNode(e,t);for(var o=0,a=r[i].length;o<a;o++)if(r[i][o].tId==t.tId){r[i].splice(o,1);break}view.setFirstNode(e,r),view.setLastNode(e,r);var s,l,c,u=r[i].length;if(e.data.keep.parent||0!=u){if(e.view.showLine&&u>0){var d=r[i][u-1];if(s=$$(d,consts.id.UL,e),l=$$(d,consts.id.SWITCH,e),c=$$(d,consts.id.ICON,e),r==n)if(1==r[i].length)view.replaceSwitchClass(d,l,consts.line.ROOT);else{var h=$$(r[i][0],consts.id.SWITCH,e);view.replaceSwitchClass(r[i][0],h,consts.line.ROOTS),view.replaceSwitchClass(d,l,consts.line.BOTTOM)}else view.replaceSwitchClass(d,l,consts.line.BOTTOM);s.removeClass(consts.line.LINE)}}else r.isParent=!1,r.open=!1,s=$$(r,consts.id.UL,e),l=$$(r,consts.id.SWITCH,e),c=$$(r,consts.id.ICON,e),view.replaceSwitchClass(r,l,consts.folder.DOCU),view.replaceIcoClass(r,c,consts.folder.DOCU),s.css("display","none")}},replaceIcoClass:function(e,t,n){if(t&&!e.isAjaxing){var i=t.attr("class");if(void 0!=i){var r=i.split("_");switch(n){case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:r[r.length-1]=n}t.attr("class",r.join("_"))}}},replaceSwitchClass:function(e,t,n){if(t){var i=t.attr("class");if(void 0!=i){var r=i.split("_");switch(n){case consts.line.ROOT:case consts.line.ROOTS:case consts.line.CENTER:case consts.line.BOTTOM:case consts.line.NOLINE:r[0]=view.makeNodeLineClassEx(e)+n;break;case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:r[1]=n}t.attr("class",r.join("_")),n!==consts.folder.DOCU?t.removeAttr("disabled"):t.attr("disabled","disabled")}}},selectNode:function(e,t,n){n||view.cancelPreSelectedNode(e,null,t),$$(t,consts.id.A,e).addClass(consts.node.CURSELECTED),data.addSelectedNode(e,t),e.treeObj.trigger(consts.event.SELECTED,[e.treeId,t])},setNodeFontCss:function(e,t){var n=$$(t,consts.id.A,e),i=view.makeNodeFontCss(e,t);i&&n.css(i)},setNodeLineIcos:function(e,t){if(t){var n=$$(t,consts.id.SWITCH,e),i=$$(t,consts.id.UL,e),r=$$(t,consts.id.ICON,e),o=view.makeUlLineClass(e,t);0==o.length?i.removeClass(consts.line.LINE):i.addClass(o),n.attr("class",view.makeNodeLineClass(e,t)),t.isParent?n.removeAttr("disabled"):n.attr("disabled","disabled"),r.removeAttr("style"),r.attr("style",view.makeNodeIcoStyle(e,t)),r.attr("class",view.makeNodeIcoClass(e,t))}},setNodeName:function(e,t){var n=data.getNodeTitle(e,t),i=$$(t,consts.id.SPAN,e);if(i.empty(),e.view.nameIsHTML?i.html(data.getNodeName(e,t)):i.text(data.getNodeName(e,t)),tools.apply(e.view.showTitle,[e.treeId,t],e.view.showTitle)){$$(t,consts.id.A,e).attr("title",n||"")}},setNodeTarget:function(e,t){$$(t,consts.id.A,e).attr("target",view.makeNodeTarget(t))},setNodeUrl:function(e,t){var n=$$(t,consts.id.A,e),i=view.makeNodeUrl(e,t);null==i||0==i.length?n.removeAttr("href"):n.attr("href",i)},switchNode:function(e,t){if(t.open||!tools.canAsync(e,t))view.expandCollapseNode(e,t,!t.open);else if(e.async.enable){if(!view.asyncNode(e,t))return void view.expandCollapseNode(e,t,!t.open)}else t&&view.expandCollapseNode(e,t,!t.open)}};$.fn.zTree={consts:_consts,_z:{tools:tools,view:view,event:event,data:data},getZTreeObj:function(e){var t=data.getZTreeTools(e);return t||null},destroy:function(e){if(e&&e.length>0)view.destroy(data.getSetting(e));else for(var t in settings)view.destroy(settings[t])},init:function(e,t,n){var i=tools.clone(_setting);$.extend(!0,i,t),i.treeId=e.attr("id"),i.treeObj=e,i.treeObj.empty(),settings[i.treeId]=i,void 0===document.body.style.maxHeight&&(i.view.expandSpeed=""),data.initRoot(i);var r=data.getRoot(i),o=i.data.key.children;n=n?tools.clone(tools.isArray(n)?n:[n]):[],i.data.simpleData.enable?r[o]=data.transformTozTreeFormat(i,n):r[o]=n,data.initCache(i),event.unbindTree(i),event.bindTree(i),event.unbindEvent(i),event.bindEvent(i);var a={setting:i,addNodes:function(e,t,n,r){function addCallback(){view.addNodes(i,e,t,a,1==r)}if(e||(e=null),e&&!e.isParent&&i.data.keep.leaf)return null;var o=parseInt(t,10);if(isNaN(o)?(r=!!n,n=t,t=-1):t=o,!n)return null;var a=tools.clone(tools.isArray(n)?n:[n]);return tools.canAsync(i,e)?view.asyncNode(i,e,r,addCallback):addCallback(),a},cancelSelectedNode:function(e){view.cancelPreSelectedNode(i,e)},destroy:function(){view.destroy(i)},expandAll:function(e){return e=!!e,view.expandCollapseSonNode(i,null,e,!0),e},expandNode:function(e,t,n,r,o){function showNodeFocus(){var t=$$(e,i).get(0);t&&!1!==r&&view.scrollIntoView(t)}return e&&e.isParent?(!0!==t&&!1!==t&&(t=!e.open),(o=!!o)&&t&&0==tools.apply(i.callback.beforeExpand,[i.treeId,e],!0)?null:o&&!t&&0==tools.apply(i.callback.beforeCollapse,[i.treeId,e],!0)?null:(t&&e.parentTId&&view.expandCollapseParentNode(i,e.getParentNode(),t,!1),t!==e.open||n?(data.getRoot(i).expandTriggerFlag=o,!tools.canAsync(i,e)&&n?view.expandCollapseSonNode(i,e,t,!0,showNodeFocus):(e.open=!t,view.switchNode(this.setting,e),showNodeFocus()),t):null)):null},getNodes:function(){return data.getNodes(i)},getNodeByParam:function(e,t,n){return e?data.getNodeByParam(i,n?n[i.data.key.children]:data.getNodes(i),e,t):null},getNodeByTId:function(e){return data.getNodeCache(i,e)},getNodesByParam:function(e,t,n){return e?data.getNodesByParam(i,n?n[i.data.key.children]:data.getNodes(i),e,t):null},getNodesByParamFuzzy:function(e,t,n){return e?data.getNodesByParamFuzzy(i,n?n[i.data.key.children]:data.getNodes(i),e,t):null},getNodesByFilter:function(e,t,n,r){return t=!!t,e&&"function"==typeof e?data.getNodesByFilter(i,n?n[i.data.key.children]:data.getNodes(i),e,t,r):t?null:[]},getNodeIndex:function(e){if(!e)return null;for(var t=i.data.key.children,n=e.parentTId?e.getParentNode():data.getRoot(i),r=0,o=n[t].length;r<o;r++)if(n[t][r]==e)return r;return-1},getSelectedNodes:function(){for(var e=[],t=data.getRoot(i).curSelectedList,n=0,r=t.length;n<r;n++)e.push(t[n]);return e},isSelectedNode:function(e){return data.isSelectedNode(i,e)},reAsyncChildNodes:function(e,t,n){if(this.setting.async.enable){var r=!e;if(r&&(e=data.getRoot(i)),"refresh"==t){for(var o=this.setting.data.key.children,a=0,s=e[o]?e[o].length:0;a<s;a++)data.removeNodeCache(i,e[o][a]);if(data.removeSelectedNode(i),e[o]=[],r)this.setting.treeObj.empty();else{$$(e,consts.id.UL,i).empty()}}view.asyncNode(this.setting,r?null:e,!!n)}},refresh:function(){this.setting.treeObj.empty();var e=data.getRoot(i),t=e[i.data.key.children];data.initRoot(i),e[i.data.key.children]=t,data.initCache(i),view.createNodes(i,0,e[i.data.key.children],null,-1)},removeChildNodes:function(e){if(!e)return null;var t=i.data.key.children,n=e[t];return view.removeChildNodes(i,e),n||null},removeNode:function(e,t){e&&((t=!!t)&&0==tools.apply(i.callback.beforeRemove,[i.treeId,e],!0)||(view.removeNode(i,e),t&&this.setting.treeObj.trigger(consts.event.REMOVE,[i.treeId,e])))},selectNode:function(e,t,n){function showNodeFocus(){if(!n){var t=$$(e,i).get(0);view.scrollIntoView(t)}}if(e&&tools.uCanDo(i)){if(t=i.view.selectedMulti&&t,e.parentTId)view.expandCollapseParentNode(i,e.getParentNode(),!0,!1,showNodeFocus);else try{$$(e,i).focus().blur()}catch(e){}view.selectNode(i,e,t)}},transformTozTreeNodes:function(e){return data.transformTozTreeFormat(i,e)},transformToArray:function(e){return data.transformToArrayFormat(i,e)},updateNode:function(e,t){if(e){$$(e,i).get(0)&&tools.uCanDo(i)&&(view.setNodeName(i,e),view.setNodeTarget(i,e),view.setNodeUrl(i,e),view.setNodeLineIcos(i,e),view.setNodeFontCss(i,e))}}};return r.treeTools=a,data.setZTreeTools(i,a),r[o]&&r[o].length>0?view.createNodes(i,0,r[o],null,-1):i.async.enable&&i.async.url&&""!==i.async.url&&view.asyncNode(i),a}};var zt=$.fn.zTree,$$=tools.$,consts=zt.consts}(jQuery),function(e){var t={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},n={check:{enable:!1,autoCheckTrigger:!1,chkStyle:t.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:t.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},i=function(e){b.getRoot(e).radioCheckedList=[]},r=function(e){},o=function(e){var t=e.treeObj,n=y.event;t.bind(n.CHECK,function(t,n,i,r){t.srcEvent=n,_.apply(e.callback.onCheck,[t,i,r])})},a=function(e){var t=e.treeObj,n=y.event;t.unbind(n.CHECK)},s=function(e){var t=e.target,n=b.getSetting(e.data.treeId),i="",r=null,o="",a=null;if(_.eqs(e.type,"mouseover")?n.check.enable&&_.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+y.id.CHECK)&&(i=_.getNodeMainDom(t).id,o="mouseoverCheck"):_.eqs(e.type,"mouseout")?n.check.enable&&_.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+y.id.CHECK)&&(i=_.getNodeMainDom(t).id,o="mouseoutCheck"):_.eqs(e.type,"click")&&n.check.enable&&_.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+y.id.CHECK)&&(i=_.getNodeMainDom(t).id,o="checkNode"),i.length>0)switch(r=b.getNodeCache(n,i),o){case"checkNode":a=p.onCheckNode;break;case"mouseoverCheck":a=p.onMouseoverCheck;break;case"mouseoutCheck":a=p.onMouseoutCheck}return{stop:"checkNode"===o,node:r,nodeEventType:o,nodeEventCallback:a,treeEventType:"",treeEventCallback:null}},l=function(e,t,n,i,r,o,a){if(n){var s=e.data.key.checked;if("string"==typeof n[s]&&(n[s]=_.eqs(n[s],"true")),n[s]=!!n[s],n.checkedOld=n[s],"string"==typeof n.nocheck&&(n.nocheck=_.eqs(n.nocheck,"true")),n.nocheck=!!n.nocheck||e.check.nocheckInherit&&i&&!!i.nocheck,"string"==typeof n.chkDisabled&&(n.chkDisabled=_.eqs(n.chkDisabled,"true")),n.chkDisabled=!!n.chkDisabled||e.check.chkDisabledInherit&&i&&!!i.chkDisabled,"string"==typeof n.halfCheck&&(n.halfCheck=_.eqs(n.halfCheck,"true")),n.halfCheck=!!n.halfCheck,n.check_Child_State=-1,n.check_Focus=!1,n.getCheckStatus=function(){return b.getCheckStatus(e,n)},e.check.chkStyle==y.radio.STYLE&&e.check.radioType==y.radio.TYPE_ALL&&n[s]){b.getRoot(e).radioCheckedList.push(n)}}},c=function(e,t,n){e.data.key.checked;e.check.enable&&(b.makeChkFlag(e,t),n.push("<span ID='",t.tId,y.id.CHECK,"' class='",x.makeChkClass(e,t),"' treeNode",y.id.CHECK,!0===t.nocheck?" style='display:none;'":"","></span>"))},u=function(e,t){t.checkNode=function(e,t,n,i){var r=this.setting.data.key.checked;if(!0!==e.chkDisabled&&(!0!==t&&!1!==t&&(t=!e[r]),i=!!i,(e[r]!==t||n)&&(!i||0!=_.apply(this.setting.callback.beforeCheck,[this.setting.treeId,e],!0))&&_.uCanDo(this.setting)&&this.setting.check.enable&&!0!==e.nocheck)){e[r]=t;var o=w(e,y.id.CHECK,this.setting);(n||this.setting.check.chkStyle===y.radio.STYLE)&&x.checkNodeRelation(this.setting,e),x.setChkClass(this.setting,o,e),x.repairParentChkClassWithSelf(this.setting,e),i&&this.setting.treeObj.trigger(y.event.CHECK,[null,this.setting.treeId,e])}},t.checkAllNodes=function(e){x.repairAllChk(this.setting,!!e)},t.getCheckedNodes=function(e){var t=this.setting.data.key.children;return e=!1!==e,b.getTreeCheckedNodes(this.setting,b.getRoot(this.setting)[t],e)},t.getChangeCheckedNodes=function(){var e=this.setting.data.key.children;return b.getTreeChangeCheckedNodes(this.setting,b.getRoot(this.setting)[e])},t.setChkDisabled=function(e,t,n,i){t=!!t,n=!!n,i=!!i,x.repairSonChkDisabled(this.setting,e,t,i),x.repairParentChkDisabled(this.setting,e.getParentNode(),t,n)};var n=t.updateNode;t.updateNode=function(e,i){if(n&&n.apply(t,arguments),e&&this.setting.check.enable){if(w(e,this.setting).get(0)&&_.uCanDo(this.setting)){var r=w(e,y.id.CHECK,this.setting);1!=i&&this.setting.check.chkStyle!==y.radio.STYLE||x.checkNodeRelation(this.setting,e),x.setChkClass(this.setting,r,e),x.repairParentChkClassWithSelf(this.setting,e)}}}},d={getRadioCheckedList:function(e){for(var t=b.getRoot(e).radioCheckedList,n=0,i=t.length;n<i;n++)b.getNodeCache(e,t[n].tId)||(t.splice(n,1),n--,i--);return t},getCheckStatus:function(e,t){if(!e.check.enable||t.nocheck||t.chkDisabled)return null;var n=e.data.key.checked;return{checked:t[n],half:t.halfCheck?t.halfCheck:e.check.chkStyle==y.radio.STYLE?2===t.check_Child_State:t[n]?t.check_Child_State>-1&&t.check_Child_State<2:t.check_Child_State>0}},getTreeCheckedNodes:function(e,t,n,i){if(!t)return[];var r=e.data.key.children,o=e.data.key.checked,a=n&&e.check.chkStyle==y.radio.STYLE&&e.check.radioType==y.radio.TYPE_ALL;i=i||[];for(var s=0,l=t.length;s<l&&(!0===t[s].nocheck||!0===t[s].chkDisabled||t[s][o]!=n||(i.push(t[s]),!a))&&(b.getTreeCheckedNodes(e,t[s][r],n,i),!(a&&i.length>0));s++);return i},getTreeChangeCheckedNodes:function(e,t,n){if(!t)return[];var i=e.data.key.children,r=e.data.key.checked;n=n||[];for(var o=0,a=t.length;o<a;o++)!0!==t[o].nocheck&&!0!==t[o].chkDisabled&&t[o][r]!=t[o].checkedOld&&n.push(t[o]),b.getTreeChangeCheckedNodes(e,t[o][i],n);return n},makeChkFlag:function(e,t){if(t){var n=e.data.key.children,i=e.data.key.checked,r=-1;if(t[n])for(var o=0,a=t[n].length;o<a;o++){var s=t[n][o],l=-1;if(e.check.chkStyle==y.radio.STYLE){if(2==(l=!0===s.nocheck||!0===s.chkDisabled?s.check_Child_State:!0===s.halfCheck?2:s[i]?2:s.check_Child_State>0?2:0)){r=2;break}0==l&&(r=0)}else if(e.check.chkStyle==y.checkbox.STYLE){if(1===(l=!0===s.nocheck||!0===s.chkDisabled?s.check_Child_State:!0===s.halfCheck?1:s[i]?-1===s.check_Child_State||2===s.check_Child_State?2:1:s.check_Child_State>0?1:0)){r=1;break}if(2===l&&r>-1&&o>0&&l!==r){r=1;break}if(2===r&&l>-1&&l<2){r=1;break}l>-1&&(r=l)}}t.check_Child_State=r}}},h={},p={onCheckNode:function(e,t){if(!0===t.chkDisabled)return!1;var n=b.getSetting(e.data.treeId),i=n.data.key.checked;if(0==_.apply(n.callback.beforeCheck,[n.treeId,t],!0))return!0;t[i]=!t[i],x.checkNodeRelation(n,t);var r=w(t,y.id.CHECK,n);return x.setChkClass(n,r,t),x.repairParentChkClassWithSelf(n,t),n.treeObj.trigger(y.event.CHECK,[e,n.treeId,t]),!0},onMouseoverCheck:function(e,t){if(!0===t.chkDisabled)return!1;var n=b.getSetting(e.data.treeId),i=w(t,y.id.CHECK,n);return t.check_Focus=!0,x.setChkClass(n,i,t),!0},onMouseoutCheck:function(e,t){if(!0===t.chkDisabled)return!1;var n=b.getSetting(e.data.treeId),i=w(t,y.id.CHECK,n);return t.check_Focus=!1,x.setChkClass(n,i,t),!0}},f={},g={checkNodeRelation:function(e,t){var n,i,r,o=e.data.key.children,a=e.data.key.checked,s=y.radio;if(e.check.chkStyle==s.STYLE){var l=b.getRadioCheckedList(e);if(t[a])if(e.check.radioType==s.TYPE_ALL){for(i=l.length-1;i>=0;i--)n=l[i],n[a]&&n!=t&&(n[a]=!1,l.splice(i,1),x.setChkClass(e,w(n,y.id.CHECK,e),n),n.parentTId!=t.parentTId&&x.repairParentChkClassWithSelf(e,n));l.push(t)}else{var c=t.parentTId?t.getParentNode():b.getRoot(e);for(i=0,r=c[o].length;i<r;i++)n=c[o][i],n[a]&&n!=t&&(n[a]=!1,x.setChkClass(e,w(n,y.id.CHECK,e),n))}else if(e.check.radioType==s.TYPE_ALL)for(i=0,r=l.length;i<r;i++)if(t==l[i]){l.splice(i,1);break}}else t[a]&&(!t[o]||0==t[o].length||e.check.chkboxType.Y.indexOf("s")>-1)&&x.setSonNodeCheckBox(e,t,!0),t[a]||t[o]&&0!=t[o].length&&!(e.check.chkboxType.N.indexOf("s")>-1)||x.setSonNodeCheckBox(e,t,!1),t[a]&&e.check.chkboxType.Y.indexOf("p")>-1&&x.setParentNodeCheckBox(e,t,!0),!t[a]&&e.check.chkboxType.N.indexOf("p")>-1&&x.setParentNodeCheckBox(e,t,!1)},makeChkClass:function(e,t){var n=e.data.key.checked,i=y.checkbox,r=y.radio,o="";o=!0===t.chkDisabled?i.DISABLED:t.halfCheck?i.PART:e.check.chkStyle==r.STYLE?t.check_Child_State<1?i.FULL:i.PART:t[n]?2===t.check_Child_State||-1===t.check_Child_State?i.FULL:i.PART:t.check_Child_State<1?i.FULL:i.PART;var a=e.check.chkStyle+"_"+(t[n]?i.TRUE:i.FALSE)+"_"+o;return a=t.check_Focus&&!0!==t.chkDisabled?a+"_"+i.FOCUS:a,y.className.BUTTON+" "+i.DEFAULT+" "+a},repairAllChk:function(e,t){if(e.check.enable&&e.check.chkStyle===y.checkbox.STYLE)for(var n=e.data.key.checked,i=e.data.key.children,r=b.getRoot(e),o=0,a=r[i].length;o<a;o++){var s=r[i][o];!0!==s.nocheck&&!0!==s.chkDisabled&&(s[n]=t),x.setSonNodeCheckBox(e,s,t)}},repairChkClass:function(e,t){if(t&&(b.makeChkFlag(e,t),!0!==t.nocheck)){var n=w(t,y.id.CHECK,e);x.setChkClass(e,n,t)}},repairParentChkClass:function(e,t){if(t&&t.parentTId){var n=t.getParentNode();x.repairChkClass(e,n),x.repairParentChkClass(e,n)}},repairParentChkClassWithSelf:function(e,t){if(t){var n=e.data.key.children;t[n]&&t[n].length>0?x.repairParentChkClass(e,t[n][0]):x.repairParentChkClass(e,t)}},repairSonChkDisabled:function(e,t,n,i){if(t){var r=e.data.key.children;if(t.chkDisabled!=n&&(t.chkDisabled=n),x.repairChkClass(e,t),t[r]&&i)for(var o=0,a=t[r].length;o<a;o++){var s=t[r][o];x.repairSonChkDisabled(e,s,n,i)}}},repairParentChkDisabled:function(e,t,n,i){t&&(t.chkDisabled!=n&&i&&(t.chkDisabled=n),x.repairChkClass(e,t),x.repairParentChkDisabled(e,t.getParentNode(),n,i))},setChkClass:function(e,t,n){t&&(!0===n.nocheck?t.hide():t.show(),t.attr("class",x.makeChkClass(e,n)))},setParentNodeCheckBox:function(e,t,n,i){var r=e.data.key.children,o=e.data.key.checked,a=w(t,y.id.CHECK,e);if(i||(i=t),b.makeChkFlag(e,t),!0!==t.nocheck&&!0!==t.chkDisabled&&(t[o]=n,x.setChkClass(e,a,t),e.check.autoCheckTrigger&&t!=i&&e.treeObj.trigger(y.event.CHECK,[null,e.treeId,t])),t.parentTId){var s=!0;if(!n)for(var l=t.getParentNode()[r],c=0,u=l.length;c<u;c++)if(!0!==l[c].nocheck&&!0!==l[c].chkDisabled&&l[c][o]||(!0===l[c].nocheck||!0===l[c].chkDisabled)&&l[c].check_Child_State>0){s=!1;break}s&&x.setParentNodeCheckBox(e,t.getParentNode(),n,i)}},setSonNodeCheckBox:function(e,t,n,i){if(t){var r=e.data.key.children,o=e.data.key.checked,a=w(t,y.id.CHECK,e);i||(i=t);var s=!1;if(t[r])for(var l=0,c=t[r].length;l<c;l++){var u=t[r][l];x.setSonNodeCheckBox(e,u,n,i),!0===u.chkDisabled&&(s=!0)}t!=b.getRoot(e)&&!0!==t.chkDisabled&&(s&&!0!==t.nocheck&&b.makeChkFlag(e,t),!0!==t.nocheck&&!0!==t.chkDisabled?(t[o]=n,s||(t.check_Child_State=t[r]&&t[r].length>0?n?2:0:-1)):t.check_Child_State=-1,x.setChkClass(e,a,t),e.check.autoCheckTrigger&&t!=i&&!0!==t.nocheck&&!0!==t.chkDisabled&&e.treeObj.trigger(y.event.CHECK,[null,e.treeId,t]))}}},m={tools:f,view:g,event:h,data:d};e.extend(!0,e.fn.zTree.consts,t),e.extend(!0,e.fn.zTree._z,m);var v=e.fn.zTree,_=v._z.tools,y=v.consts,x=v._z.view,b=v._z.data,w=(v._z.event,_.$);b.exSetting(n),b.addInitBind(o),b.addInitUnBind(a),b.addInitCache(r),b.addInitNode(l),b.addInitProxy(s,!0),b.addInitRoot(i),b.addBeforeA(c),b.addZTreeTools(u);var C=x.createNodes;x.createNodes=function(e,t,n,i,r){C&&C.apply(x,arguments),n&&x.repairParentChkClassWithSelf(e,i)};var S=x.removeNode;x.removeNode=function(e,t){var n=t.getParentNode();S&&S.apply(x,arguments),t&&n&&(x.repairChkClass(e,n),x.repairParentChkClass(e,n))};var T=x.appendNodes;x.appendNodes=function(e,t,n,i,r,o,a){var s="";return T&&(s=T.apply(x,arguments)),i&&b.makeChkFlag(e,i),s}}(jQuery),function(e){var t={event:{DRAG:"ztree_drag",DROP:"ztree_drop",RENAME:"ztree_rename",DRAGMOVE:"ztree_dragmove"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},n={edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}},i=function(e){var t=x.getRoot(e),n=x.getRoots();t.curEditNode=null,t.curEditInput=null,t.curHoverNode=null,t.dragFlag=0,t.dragNodeShowBefore=[],t.dragMaskList=new Array,n.showHoverDom=!0},r=function(e){},o=function(e){var t=e.treeObj,n=_.event;t.bind(n.RENAME,function(t,n,i,r){v.apply(e.callback.onRename,[t,n,i,r])}),t.bind(n.DRAG,function(t,n,i,r){v.apply(e.callback.onDrag,[n,i,r])}),t.bind(n.DRAGMOVE,function(t,n,i,r){v.apply(e.callback.onDragMove,[n,i,r])}),t.bind(n.DROP,function(t,n,i,r,o,a,s){v.apply(e.callback.onDrop,[n,i,r,o,a,s])})},a=function(e){var t=e.treeObj,n=_.event;t.unbind(n.RENAME),t.unbind(n.DRAG),t.unbind(n.DRAGMOVE),t.unbind(n.DROP)},s=function(e){var t=e.target,n=x.getSetting(e.data.treeId),i=e.relatedTarget,r="",o=null,a="",s=null,l=null;if(v.eqs(e.type,"mouseover")?(l=v.getMDom(n,t,[{tagName:"a",attrName:"treeNode"+_.id.A}]))&&(r=v.getNodeMainDom(l).id,a="hoverOverNode"):v.eqs(e.type,"mouseout")?(l=v.getMDom(n,i,[{tagName:"a",attrName:"treeNode"+_.id.A}]))||(r="remove",a="hoverOutNode"):v.eqs(e.type,"mousedown")&&(l=v.getMDom(n,t,[{tagName:"a",attrName:"treeNode"+_.id.A}]))&&(r=v.getNodeMainDom(l).id,a="mousedownNode"),r.length>0)switch(o=x.getNodeCache(n,r),a){case"mousedownNode":s=h.onMousedownNode;break;case"hoverOverNode":s=h.onHoverOverNode;break;case"hoverOutNode":s=h.onHoverOutNode}return{stop:!1,node:o,nodeEventType:a,nodeEventCallback:s,treeEventType:"",treeEventCallback:null}},l=function(e,t,n,i,r,o,a){n&&(n.isHover=!1,n.editNameFlag=!1)},c=function(e,t){t.cancelEditName=function(e){x.getRoot(this.setting).curEditNode&&y.cancelCurEditNode(this.setting,e||null,!0)},t.copyNode=function(e,t,n,i){function copyCallback(){y.addNodes(r.setting,e,-1,[o],i)}if(!t)return null;if(e&&!e.isParent&&this.setting.data.keep.leaf&&n===_.move.TYPE_INNER)return null;var r=this,o=v.clone(t);return e||(e=null,n=_.move.TYPE_INNER),n==_.move.TYPE_INNER?v.canAsync(this.setting,e)?y.asyncNode(this.setting,e,i,copyCallback):copyCallback():(y.addNodes(this.setting,e.parentNode,-1,[o],i),y.moveNode(this.setting,e,o,n,!1,i)),o},t.editName=function(e){e&&e.tId&&e===x.getNodeCache(this.setting,e.tId)&&(e.parentTId&&y.expandCollapseParentNode(this.setting,e.getParentNode(),!0),y.editNode(this.setting,e))},t.moveNode=function(e,t,n,i){function moveCallback(){y.moveNode(r.setting,e,t,n,!1,i)}if(!t)return t;if(e&&!e.isParent&&this.setting.data.keep.leaf&&n===_.move.TYPE_INNER)return null;if(e&&(t.parentTId==e.tId&&n==_.move.TYPE_INNER||b(t,this.setting).find("#"+e.tId).length>0))return null;e||(e=null);var r=this;return v.canAsync(this.setting,e)&&n===_.move.TYPE_INNER?y.asyncNode(this.setting,e,i,moveCallback):moveCallback(),t},t.setEditable=function(e){return this.setting.edit.enable=e,this.refresh()}},u={setSonNodeLevel:function(e,t,n){if(n){var i=e.data.key.children;if(n.level=t?t.level+1:0,n[i])for(var r=0,o=n[i].length;r<o;r++)n[i][r]&&x.setSonNodeLevel(e,n,n[i][r])}}},d={},h={onHoverOverNode:function(e,t){var n=x.getSetting(e.data.treeId),i=x.getRoot(n);i.curHoverNode!=t&&h.onHoverOutNode(e),i.curHoverNode=t,y.addHoverDom(n,t)},onHoverOutNode:function(e,t){var n=x.getSetting(e.data.treeId),i=x.getRoot(n);i.curHoverNode&&!x.isSelectedNode(n,i.curHoverNode)&&(y.removeTreeDom(n,i.curHoverNode),i.curHoverNode=null)},onMousedownNode:function(n,i){function _docMouseMove(n){function clearMove(){f=null,I="",D=_.move.TYPE_INNER,p.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null)}if(0==s.dragFlag&&Math.abs(k-n.clientX)<a.edit.drag.minMoveSize&&Math.abs(L-n.clientY)<a.edit.drag.minMoveSize)return!0;var i,r,o,c,u,A=a.data.key.children;if(C.css("cursor","pointer"),0==s.dragFlag){if(0==v.apply(a.callback.beforeDrag,[a.treeId,d],!0))return _docMouseUp(n),!0;for(i=0,r=d.length;i<r;i++)0==i&&(s.dragNodeShowBefore=[]),o=d[i],o.isParent&&o.open?(y.expandCollapseNode(a,o,!o.open),s.dragNodeShowBefore[o.tId]=!0):s.dragNodeShowBefore[o.tId]=!1;s.dragFlag=1,l.showHoverDom=!1,v.showIfameMask(a,!0);var P=!0,O=-1;if(d.length>1){var R=d[0].parentTId?d[0].getParentNode()[A]:x.getNodes(a);for(u=[],i=0,r=R.length;i<r;i++)if(void 0!==s.dragNodeShowBefore[R[i].tId]&&(P&&O>-1&&O+1!==i&&(P=!1),u.push(R[i]),O=i),d.length===u.length){d=u;break}}for(P&&(g=d[0].getPreNode(),m=d[d.length-1].getNextNode()),h=b("<ul class='zTreeDragUL'></ul>",a),i=0,r=d.length;i<r;i++)o=d[i],o.editNameFlag=!1,y.selectNode(a,o,i>0),y.removeTreeDom(a,o),i>a.edit.drag.maxShowNodeNum-1||(c=b("<li id='"+o.tId+"_tmp'></li>",a),c.append(b(o,_.id.A,a).clone()),c.css("padding","0"),c.children("#"+o.tId+_.id.A).removeClass(_.node.CURSELECTED),h.append(c),i==a.edit.drag.maxShowNodeNum-1&&(c=b("<li id='"+o.tId+"_moretmp'><a>  ...  </a></li>",a),h.append(c)));h.attr("id",d[0].tId+_.id.UL+"_tmp"),h.addClass(a.treeObj.attr("class")),h.appendTo(C),p=b("<span class='tmpzTreeMove_arrow'></span>",a),p.attr("id","zTreeMove_arrow_tmp"),p.appendTo(C),a.treeObj.trigger(_.event.DRAG,[n,a.treeId,d])}if(1==s.dragFlag){if(f&&p.attr("id")==n.target.id&&I&&n.clientX+w.scrollLeft()+2>e("#"+I+_.id.A,f).offset().left){var z=e("#"+I+_.id.A,f);n.target=z.length>0?z.get(0):n.target}else f&&(f.removeClass(_.node.TMPTARGET_TREE),I&&e("#"+I+_.id.A,f).removeClass(_.node.TMPTARGET_NODE+"_"+_.move.TYPE_PREV).removeClass(_.node.TMPTARGET_NODE+"_"+t.move.TYPE_NEXT).removeClass(_.node.TMPTARGET_NODE+"_"+t.move.TYPE_INNER));f=null,I=null,S=!1,T=a;var F=x.getSettings();for(var B in F)F[B].treeId&&F[B].edit.enable&&F[B].treeId!=a.treeId&&(n.target.id==F[B].treeId||e(n.target).parents("#"+F[B].treeId).length>0)&&(S=!0,T=F[B]);var H=w.scrollTop(),V=w.scrollLeft(),W=T.treeObj.offset(),U=T.treeObj.get(0).scrollHeight,$=T.treeObj.get(0).scrollWidth,G=n.clientY+H-W.top,q=T.treeObj.height()+W.top-n.clientY-H,j=n.clientX+V-W.left,Y=T.treeObj.width()+W.left-n.clientX-V,X=G<a.edit.drag.borderMax&&G>a.edit.drag.borderMin,Z=q<a.edit.drag.borderMax&&q>a.edit.drag.borderMin,K=j<a.edit.drag.borderMax&&j>a.edit.drag.borderMin,J=Y<a.edit.drag.borderMax&&Y>a.edit.drag.borderMin,Q=G>a.edit.drag.borderMin&&q>a.edit.drag.borderMin&&j>a.edit.drag.borderMin&&Y>a.edit.drag.borderMin,ee=X&&T.treeObj.scrollTop()<=0,te=Z&&T.treeObj.scrollTop()+T.treeObj.height()+10>=U,ne=K&&T.treeObj.scrollLeft()<=0,ie=J&&T.treeObj.scrollLeft()+T.treeObj.width()+10>=$;if(n.target&&v.isChildOrSelf(n.target,T.treeId)){for(var re=n.target;re&&re.tagName&&!v.eqs(re.tagName,"li")&&re.id!=T.treeId;)re=re.parentNode;var oe=!0;for(i=0,r=d.length;i<r;i++){if(o=d[i],re.id===o.tId){oe=!1;break}if(b(o,a).find("#"+re.id).length>0){oe=!1;break}}oe&&n.target&&v.isChildOrSelf(n.target,re.id+_.id.A)&&(f=e(re),I=re.id)}o=d[0],Q&&v.isChildOrSelf(n.target,T.treeId)&&(!f&&(n.target.id==T.treeId||ee||te||ne||ie)&&(S||!S&&o.parentTId)&&(f=T.treeObj),X?T.treeObj.scrollTop(T.treeObj.scrollTop()-10):Z&&T.treeObj.scrollTop(T.treeObj.scrollTop()+10),K?T.treeObj.scrollLeft(T.treeObj.scrollLeft()-10):J&&T.treeObj.scrollLeft(T.treeObj.scrollLeft()+10),f&&f!=T.treeObj&&f.offset().left<T.treeObj.offset().left&&T.treeObj.scrollLeft(T.treeObj.scrollLeft()+f.offset().left-T.treeObj.offset().left)),h.css({top:n.clientY+H+3+"px",left:n.clientX+V+3+"px"});var ae=0,se=0;if(f&&f.attr("id")!=T.treeId){var le=null==I?null:x.getNodeCache(T,I),ce=(n.ctrlKey||n.metaKey)&&a.edit.drag.isMove&&a.edit.drag.isCopy||!a.edit.drag.isMove&&a.edit.drag.isCopy,ue=!(!g||I!==g.tId),de=!(!m||I!==m.tId),he=o.parentTId&&o.parentTId==I,pe=(ce||!de)&&v.apply(T.edit.drag.prev,[T.treeId,d,le],!!T.edit.drag.prev),fe=(ce||!ue)&&v.apply(T.edit.drag.next,[T.treeId,d,le],!!T.edit.drag.next),ge=(ce||!he)&&!(T.data.keep.leaf&&!le.isParent)&&v.apply(T.edit.drag.inner,[T.treeId,d,le],!!T.edit.drag.inner);if(pe||fe||ge){var me=e("#"+I+_.id.A,f),ve=le.isLastNode?null:e("#"+le.getNextNode().tId+_.id.A,f.next()),_e=me.offset().top,ye=me.offset().left,xe=pe?ge?.25:fe?.5:1:-1,be=fe?ge?.75:pe?.5:0:-1,we=(n.clientY+H-_e)/me.height();if((1==xe||we<=xe&&we>=-.2)&&pe?(ae=1-p.width(),se=_e-p.height()/2,D=_.move.TYPE_PREV):(0==be||we>=be&&we<=1.2)&&fe?(ae=1-p.width(),se=null==ve||le.isParent&&le.open?_e+me.height()-p.height()/2:ve.offset().top-p.height()/2,D=_.move.TYPE_NEXT):ge?(ae=5-p.width(),se=_e,D=_.move.TYPE_INNER):clearMove(),f&&(p.css({display:"block",top:se+"px",left:ye+ae+"px"}),me.addClass(_.node.TMPTARGET_NODE+"_"+D),M==I&&E==D||(N=(new Date).getTime()),le&&le.isParent&&D==_.move.TYPE_INNER)){var Ce=!0;window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==le.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===le.tId&&(Ce=!1),Ce&&(window.zTreeMoveTimer=setTimeout(function(){D==_.move.TYPE_INNER&&le&&le.isParent&&!le.open&&(new Date).getTime()-N>T.edit.drag.autoOpenTime&&v.apply(T.callback.beforeDragOpen,[T.treeId,le],!0)&&(y.switchNode(T,le),T.edit.drag.autoExpandTrigger&&T.treeObj.trigger(_.event.EXPAND,[T.treeId,le]))},T.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=le.tId)}}else clearMove()}else D=_.move.TYPE_INNER,f&&v.apply(T.edit.drag.inner,[T.treeId,d,null],!!T.edit.drag.inner)?f.addClass(_.node.TMPTARGET_TREE):f=null,p.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null);M=I,E=D,a.treeObj.trigger(_.event.DRAGMOVE,[n,a.treeId,d])}return!1}function _docMouseUp(n){function dropCallback(){if(S){if(!c)for(var e=0,t=d.length;e<t;e++)y.removeNode(a,d[e]);D==_.move.TYPE_INNER?y.addNodes(T,u,-1,g):y.addNodes(T,u.getParentNode(),D==_.move.TYPE_PREV?u.getIndex():u.getIndex()+1,g)}else if(c&&D==_.move.TYPE_INNER)y.addNodes(T,u,-1,g);else if(c)y.addNodes(T,u.getParentNode(),D==_.move.TYPE_PREV?u.getIndex():u.getIndex()+1,g);else if(D!=_.move.TYPE_NEXT)for(e=0,t=g.length;e<t;e++)y.moveNode(T,u,g[e],D,!1);else for(e=-1,t=g.length-1;e<t;t--)y.moveNode(T,u,g[t],D,!1);y.selectNodes(T,g);var i=b(g[0],a).get(0);y.scrollIntoView(i),a.treeObj.trigger(_.event.DROP,[n,T.treeId,g,u,D,c])}if(window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null),M=null,E=null,w.unbind("mousemove",_docMouseMove),w.unbind("mouseup",_docMouseUp),w.unbind("selectstart",_docSelect),C.css("cursor","auto"),f&&(f.removeClass(_.node.TMPTARGET_TREE),I&&e("#"+I+_.id.A,f).removeClass(_.node.TMPTARGET_NODE+"_"+_.move.TYPE_PREV).removeClass(_.node.TMPTARGET_NODE+"_"+t.move.TYPE_NEXT).removeClass(_.node.TMPTARGET_NODE+"_"+t.move.TYPE_INNER)),v.showIfameMask(a,!1),l.showHoverDom=!0,0!=s.dragFlag){s.dragFlag=0;var i,r,o;for(i=0,r=d.length;i<r;i++)o=d[i],o.isParent&&s.dragNodeShowBefore[o.tId]&&!o.open&&(y.expandCollapseNode(a,o,!o.open),delete s.dragNodeShowBefore[o.tId]);h&&h.remove(),p&&p.remove();var c=(n.ctrlKey||n.metaKey)&&a.edit.drag.isMove&&a.edit.drag.isCopy||!a.edit.drag.isMove&&a.edit.drag.isCopy;if(!c&&f&&I&&d[0].parentTId&&I==d[0].parentTId&&D==_.move.TYPE_INNER&&(f=null),f){var u=null==I?null:x.getNodeCache(T,I);if(0==v.apply(a.callback.beforeDrop,[T.treeId,d,u,D,c],!0))return void y.selectNodes(A,d);var g=c?v.clone(d):d;D==_.move.TYPE_INNER&&v.canAsync(T,u)?y.asyncNode(T,u,!1,dropCallback):dropCallback()}else y.selectNodes(A,d),a.treeObj.trigger(_.event.DROP,[n,a.treeId,d,null,null,null])}}function _docSelect(){return!1}var r,o,a=x.getSetting(n.data.treeId),s=x.getRoot(a),l=x.getRoots();if(2==n.button||!a.edit.enable||!a.edit.drag.isCopy&&!a.edit.drag.isMove)return!0;var c=n.target,u=x.getRoot(a).curSelectedList,d=[];if(x.isSelectedNode(a,i))for(r=0,o=u.length;r<o;r++){if(u[r].editNameFlag&&v.eqs(c.tagName,"input")&&null!==c.getAttribute("treeNode"+_.id.INPUT))return!0;if(d.push(u[r]),d[0].parentTId!==u[r].parentTId){d=[i];break}}else d=[i];y.editNodeBlur=!0,y.cancelCurEditNode(a);var h,p,f,g,m,w=e(a.treeObj.get(0).ownerDocument),C=e(a.treeObj.get(0).ownerDocument.body),S=!1,T=a,A=a,M=null,E=null,I=null,D=_.move.TYPE_INNER,k=n.clientX,L=n.clientY,N=(new Date).getTime();return v.uCanDo(a)&&w.bind("mousemove",_docMouseMove),w.bind("mouseup",_docMouseUp),w.bind("selectstart",_docSelect),n.preventDefault&&n.preventDefault(),!0}},p={getAbs:function(e){var t=e.getBoundingClientRect(),n=document.body.scrollTop+document.documentElement.scrollTop,i=document.body.scrollLeft+document.documentElement.scrollLeft;return[t.left+i,t.top+n]},inputFocus:function(e){e.get(0)&&(e.focus(),v.setCursorPosition(e.get(0),e.val().length))},inputSelect:function(e){e.get(0)&&(e.focus(),e.select())},setCursorPosition:function(e,t){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,t);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",t),n.select()}},showIfameMask:function(e,t){for(var n=x.getRoot(e);n.dragMaskList.length>0;)n.dragMaskList[0].remove(),n.dragMaskList.shift();if(t)for(var i=b("iframe",e),r=0,o=i.length;r<o;r++){var a=i.get(r),s=v.getAbs(a),l=b("<div id='zTreeMask_"+r+"' class='zTreeMask' style='top:"+s[1]+"px; left:"+s[0]+"px; width:"+a.offsetWidth+"px; height:"+a.offsetHeight+"px;'></div>",e);l.appendTo(b("body",e)),n.dragMaskList.push(l)}}},f={addEditBtn:function(e,t){if(!(t.editNameFlag||b(t,_.id.EDIT,e).length>0)&&v.apply(e.edit.showRenameBtn,[e.treeId,t],e.edit.showRenameBtn)){var n=b(t,_.id.A,e),i="<span class='"+_.className.BUTTON+" edit' id='"+t.tId+_.id.EDIT+"' title='"+v.apply(e.edit.renameTitle,[e.treeId,t],e.edit.renameTitle)+"' treeNode"+_.id.EDIT+" style='display:none;'></span>";n.append(i),b(t,_.id.EDIT,e).bind("click",function(){return!(!v.uCanDo(e)||0==v.apply(e.callback.beforeEditName,[e.treeId,t],!0))&&(y.editNode(e,t),!1)}).show()}},addRemoveBtn:function(e,t){if(!(t.editNameFlag||b(t,_.id.REMOVE,e).length>0)&&v.apply(e.edit.showRemoveBtn,[e.treeId,t],e.edit.showRemoveBtn)){var n=b(t,_.id.A,e),i="<span class='"+_.className.BUTTON+" remove' id='"+t.tId+_.id.REMOVE+"' title='"+v.apply(e.edit.removeTitle,[e.treeId,t],e.edit.removeTitle)+"' treeNode"+_.id.REMOVE+" style='display:none;'></span>";n.append(i),b(t,_.id.REMOVE,e).bind("click",function(){return!(!v.uCanDo(e)||0==v.apply(e.callback.beforeRemove,[e.treeId,t],!0))&&(y.removeNode(e,t),e.treeObj.trigger(_.event.REMOVE,[e.treeId,t]),!1)}).bind("mousedown",function(e){return!0}).show()}},addHoverDom:function(e,t){x.getRoots().showHoverDom&&(t.isHover=!0,e.edit.enable&&(y.addEditBtn(e,t),y.addRemoveBtn(e,t)),v.apply(e.view.addHoverDom,[e.treeId,t]))},cancelCurEditNode:function(e,t,n){var i=x.getRoot(e),r=e.data.key.name,o=i.curEditNode;if(o){var a=i.curEditInput,s=t||(n?o[r]:a.val());if(!1===v.apply(e.callback.beforeRename,[e.treeId,o,s,n],!0))return!1;o[r]=s;b(o,_.id.A,e).removeClass(_.node.CURSELECTED_EDIT),a.unbind(),y.setNodeName(e,o),o.editNameFlag=!1,i.curEditNode=null,i.curEditInput=null,y.selectNode(e,o,!1),e.treeObj.trigger(_.event.RENAME,[e.treeId,o,n])}return i.noSelection=!0,!0},editNode:function(e,t){var n=x.getRoot(e);if(y.editNodeBlur=!1,x.isSelectedNode(e,t)&&n.curEditNode==t&&t.editNameFlag)return void setTimeout(function(){v.inputFocus(n.curEditInput)},0);var i=e.data.key.name;t.editNameFlag=!0,y.removeTreeDom(e,t),y.cancelCurEditNode(e),y.selectNode(e,t,!1),b(t,_.id.SPAN,e).html("<input type=text class='rename' id='"+t.tId+_.id.INPUT+"' treeNode"+_.id.INPUT+" >");var r=b(t,_.id.INPUT,e);r.attr("value",t[i]),e.edit.editNameSelectAll?v.inputSelect(r):v.inputFocus(r),r.bind("blur",function(t){y.editNodeBlur||y.cancelCurEditNode(e)}).bind("keydown",function(t){"13"==t.keyCode?(y.editNodeBlur=!0,y.cancelCurEditNode(e)):"27"==t.keyCode&&y.cancelCurEditNode(e,null,!0)}).bind("click",function(e){return!1}).bind("dblclick",function(e){return!1}),b(t,_.id.A,e).addClass(_.node.CURSELECTED_EDIT),n.curEditInput=r,n.noSelection=!1,n.curEditNode=t},moveNode:function(e,t,n,i,r,o){var a=x.getRoot(e),s=e.data.key.children;if(t!=n&&(!e.data.keep.leaf||!t||t.isParent||i!=_.move.TYPE_INNER)){var l=n.parentTId?n.getParentNode():a,c=null===t||t==a;c&&null===t&&(t=a),c&&(i=_.move.TYPE_INNER);var u=t.parentTId?t.getParentNode():a;i!=_.move.TYPE_PREV&&i!=_.move.TYPE_NEXT&&(i=_.move.TYPE_INNER),i==_.move.TYPE_INNER&&(c?n.parentTId=null:(t.isParent||(t.isParent=!0,t.open=!!t.open,y.setNodeLineIcos(e,t)),n.parentTId=t.tId));var d,h;if(c)d=e.treeObj,h=d;else{if(o||i!=_.move.TYPE_INNER?o||y.expandCollapseNode(e,t.getParentNode(),!0,!1):y.expandCollapseNode(e,t,!0,!1),d=b(t,e),h=b(t,_.id.UL,e),d.get(0)&&!h.get(0)){var p=[];y.makeUlHtml(e,t,p,""),d.append(p.join(""))}h=b(t,_.id.UL,e)}var f=b(n,e);f.get(0)?d.get(0)||f.remove():f=y.appendNodes(e,n.level,[n],null,-1,!1,!0).join(""),h.get(0)&&i==_.move.TYPE_INNER?h.append(f):d.get(0)&&i==_.move.TYPE_PREV?d.before(f):d.get(0)&&i==_.move.TYPE_NEXT&&d.after(f);var g,m,v=-1,w=0,C=null,S=null,T=n.level;if(n.isFirstNode)v=0,l[s].length>1&&(C=l[s][1],C.isFirstNode=!0);else if(n.isLastNode)v=l[s].length-1,C=l[s][v-1],C.isLastNode=!0;else for(g=0,m=l[s].length;g<m;g++)if(l[s][g].tId==n.tId){v=g;break}if(v>=0&&l[s].splice(v,1),i!=_.move.TYPE_INNER)for(g=0,m=u[s].length;g<m;g++)u[s][g].tId==t.tId&&(w=g);if(i==_.move.TYPE_INNER?(t[s]||(t[s]=new Array),t[s].length>0&&(S=t[s][t[s].length-1],S.isLastNode=!1),t[s].splice(t[s].length,0,n),n.isLastNode=!0,n.isFirstNode=1==t[s].length):t.isFirstNode&&i==_.move.TYPE_PREV?(u[s].splice(w,0,n),S=t,S.isFirstNode=!1,n.parentTId=t.parentTId,n.isFirstNode=!0,n.isLastNode=!1):t.isLastNode&&i==_.move.TYPE_NEXT?(u[s].splice(w+1,0,n),S=t,S.isLastNode=!1,n.parentTId=t.parentTId,n.isFirstNode=!1,n.isLastNode=!0):(i==_.move.TYPE_PREV?u[s].splice(w,0,n):u[s].splice(w+1,0,n),n.parentTId=t.parentTId,n.isFirstNode=!1,n.isLastNode=!1),x.fixPIdKeyValue(e,n),x.setSonNodeLevel(e,n.getParentNode(),n),y.setNodeLineIcos(e,n),y.repairNodeLevelClass(e,n,T),!e.data.keep.parent&&l[s].length<1){l.isParent=!1,l.open=!1;var A=b(l,_.id.UL,e),M=b(l,_.id.SWITCH,e),E=b(l,_.id.ICON,e);y.replaceSwitchClass(l,M,_.folder.DOCU),y.replaceIcoClass(l,E,_.folder.DOCU),A.css("display","none")}else C&&y.setNodeLineIcos(e,C);S&&y.setNodeLineIcos(e,S),e.check&&e.check.enable&&y.repairChkClass&&(y.repairChkClass(e,l),y.repairParentChkClassWithSelf(e,l),l!=n.parent&&y.repairParentChkClassWithSelf(e,n)),o||y.expandCollapseParentNode(e,n.getParentNode(),!0,r)}},removeEditBtn:function(e,t){b(t,_.id.EDIT,e).unbind().remove()},removeRemoveBtn:function(e,t){b(t,_.id.REMOVE,e).unbind().remove()},removeTreeDom:function(e,t){t.isHover=!1,y.removeEditBtn(e,t),y.removeRemoveBtn(e,t),v.apply(e.view.removeHoverDom,[e.treeId,t])},repairNodeLevelClass:function(e,t,n){if(n!==t.level){var i=b(t,e),r=b(t,_.id.A,e),o=b(t,_.id.UL,e),a=_.className.LEVEL+n,s=_.className.LEVEL+t.level;i.removeClass(a),i.addClass(s),r.removeClass(a),r.addClass(s),o.removeClass(a),o.addClass(s)}},selectNodes:function(e,t){for(var n=0,i=t.length;n<i;n++)y.selectNode(e,t[n],n>0)}},g={tools:p,view:f,event:d,data:u};e.extend(!0,e.fn.zTree.consts,t),e.extend(!0,e.fn.zTree._z,g);var m=e.fn.zTree,v=m._z.tools,_=m.consts,y=m._z.view,x=m._z.data,b=(m._z.event,v.$);x.exSetting(n),x.addInitBind(o),x.addInitUnBind(a),x.addInitCache(r),x.addInitNode(l),x.addInitProxy(s),x.addInitRoot(i),x.addZTreeTools(c);var w=y.cancelPreSelectedNode;y.cancelPreSelectedNode=function(e,t){for(var n=x.getRoot(e).curSelectedList,i=0,r=n.length;i<r&&(t&&t!==n[i]||(y.removeTreeDom(e,n[i]),!t));i++);w&&w.apply(y,arguments)};var C=y.createNodes;y.createNodes=function(e,t,n,i,r){C&&C.apply(y,arguments),n&&y.repairParentChkClassWithSelf&&y.repairParentChkClassWithSelf(e,i)};var S=y.makeNodeUrl;y.makeNodeUrl=function(e,t){return e.edit.enable?null:S.apply(y,arguments)};var T=y.removeNode;y.removeNode=function(e,t){var n=x.getRoot(e);n.curEditNode===t&&(n.curEditNode=null),T&&T.apply(y,arguments)};var A=y.selectNode;y.selectNode=function(e,t,n){var i=x.getRoot(e);return(!x.isSelectedNode(e,t)||i.curEditNode!=t||!t.editNameFlag)&&(A&&A.apply(y,arguments),y.addHoverDom(e,t),!0)};var M=v.uCanDo;v.uCanDo=function(e,t){var n=x.getRoot(e);return!(!t||!(v.eqs(t.type,"mouseover")||v.eqs(t.type,"mouseout")||v.eqs(t.type,"mousedown")||v.eqs(t.type,"mouseup")))||(n.curEditNode&&(y.editNodeBlur=!1,n.curEditInput.focus()),!n.curEditNode&&(!M||M.apply(y,arguments)))}}(jQuery)}).call(exports,__webpack_require__(0))}],[112]);